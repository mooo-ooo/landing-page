var Ae=e=>{throw TypeError(e)};var Fe=(e,t,n)=>t.has(e)||Ae("Cannot "+n);var pe=(e,t,n)=>(Fe(e,t,"read from private field"),n?n.call(e):t.get(e)),He=(e,t,n)=>t.has(e)?Ae("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Oe=(e,t,n,r)=>(Fe(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);import{f as De,j as o,r as m,aB as Ft,aC as te,ai as ae,N as ie,x as P,aD as Ht,A as ht,a5 as Ot,T as k,Y as Te,am as Bt,aE as _t,aF as Ut,y as Vt,z as Xt,C as Be,ae as qt,E as Yt,D as Jt,aG as Kt,aq as E,aH as be,aI as ke,aJ as Me,ab as Zt,ac as Qt,R as _e,U as Ue,V as Ve,W as Xe,aK as re,ay as en,aL as xt,G as gt,aM as tn,aN as qe,af as he,at as nn,aO as rn,P as on}from"./index-A-wFfTgn.js";const sn=De(o.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),an=De(o.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),ln=De(o.jsx("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47M6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47m1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93"}));function R(e,t="Assertion error"){if(!e)throw Error(t)}function le({group:e}){const{orientation:t,panels:n}=e;return n.reduce((r,a)=>(r+=t==="horizontal"?a.element.offsetWidth:a.element.offsetHeight,r),0)}function Ie(e,t){return t.sort(e==="horizontal"?cn:un)}function cn(e,t){const n=e.element.offsetLeft-t.element.offsetLeft;return n!==0?n:e.element.offsetWidth-t.element.offsetWidth}function un(e,t){const n=e.element.offsetTop-t.element.offsetTop;return n!==0?n:e.element.offsetHeight-t.element.offsetHeight}function mt(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function yt(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function dn({orientation:e,rects:t,targetRect:n}){const r={x:n.x+n.width/2,y:n.y+n.height/2};let a,u=Number.MAX_VALUE;for(const s of t){const{x:l,y:i}=yt(r,s),d=e==="horizontal"?l:i;d<u&&(u=d,a=s)}return R(a,"No rect found"),a}function bt(e){const{element:t,orientation:n,panels:r,separators:a}=e,u=Ie(n,Array.from(t.children).filter(mt).map(h=>({element:h}))).map(({element:h})=>h),s=[];let l=!1,i,d=[];for(const h of u)if(h.hasAttribute("data-panel")){const y=r.find(v=>v.element===h);if(y){if(i){const v=i.element.getBoundingClientRect(),x=h.getBoundingClientRect();let c;if(l){const f=n==="horizontal"?new DOMRect(v.right,v.top,0,v.height):new DOMRect(v.left,v.bottom,v.width,0),g=n==="horizontal"?new DOMRect(x.left,x.top,0,x.height):new DOMRect(x.left,x.top,x.width,0);switch(d.length){case 0:{c=[f,g];break}case 1:{const p=d[0],j=dn({orientation:n,rects:[v,x],targetRect:p.element.getBoundingClientRect()});c=[p,j===v?g:f];break}default:{c=d;break}}}else d.length?c=d:c=[n==="horizontal"?new DOMRect(v.right,x.top,x.left-v.right,x.height):new DOMRect(x.left,v.bottom,x.width,x.top-v.bottom)];for(const f of c)s.push({group:e,groupSize:le({group:e}),panels:[i,y],separator:"width"in f?void 0:f,rect:"width"in f?f:f.element.getBoundingClientRect()})}l=!1,i=y,d=[]}}else if(h.hasAttribute("data-separator")){const y=a.find(v=>v.element===h);y?d.push(y):(i=void 0,d=[])}else l=!0;return s}function fn(e,t){const n=getComputedStyle(e),r=parseFloat(n.fontSize);return t*r}function pn(e,t){const n=getComputedStyle(e.ownerDocument.body),r=parseFloat(n.fontSize);return t*r}function hn(e){return e/100*window.innerHeight}function xn(e){return e/100*window.innerWidth}function gn(e){switch(typeof e){case"number":return[e,"px"];case"string":{const t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}function ve({groupSize:e,panelElement:t,styleProp:n}){let r;const[a,u]=gn(n);switch(u){case"%":{r=a/100*e;break}case"px":{r=a;break}case"rem":{r=pn(t,a);break}case"em":{r=fn(t,a);break}case"vh":{r=hn(a);break}case"vw":{r=xn(a);break}}return r}function J(e){return parseFloat(e.toFixed(3))}function Ye(e){const{panels:t}=e,n=le({group:e});return n===0?t.map(r=>({collapsedSize:0,collapsible:r.panelConstraints.collapsible===!0,defaultSize:void 0,minSize:0,maxSize:100,panelId:r.id})):t.map(r=>{const{element:a,panelConstraints:u}=r;let s=0;if(u.collapsedSize){const h=ve({groupSize:n,panelElement:a,styleProp:u.collapsedSize});s=J(h/n*100)}let l;if(u.defaultSize){const h=ve({groupSize:n,panelElement:a,styleProp:u.defaultSize});l=J(h/n*100)}let i=0;if(u.minSize){const h=ve({groupSize:n,panelElement:a,styleProp:u.minSize});i=J(h/n*100)}let d=100;if(u.maxSize){const h=ve({groupSize:n,panelElement:a,styleProp:u.maxSize});d=J(h/n*100)}return{collapsedSize:s,collapsible:u.collapsible===!0,defaultSize:l,minSize:i,maxSize:d,panelId:r.id}})}var ee;class mn{constructor(){He(this,ee,{})}addListener(t,n){const r=pe(this,ee)[t];return r===void 0?pe(this,ee)[t]=[n]:r.includes(n)||r.push(n),()=>{this.removeListener(t,n)}}emit(t,n){const r=pe(this,ee)[t];if(r!==void 0)if(r.length===1)r[0].call(null,n);else{let a=!1,u=null;const s=Array.from(r);for(let l=0;l<s.length;l++){const i=s[l];try{i.call(null,n)}catch(d){u===null&&(a=!0,u=d)}}if(a)throw u}}removeAllListeners(){Oe(this,ee,{})}removeListener(t,n){const r=pe(this,ee)[t];if(r!==void 0){const a=r.indexOf(n);a>=0&&r.splice(a,1)}}}ee=new WeakMap;function A(e,t,n=0){return Math.abs(J(e)-J(t))<=n}let V={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const xe=new mn;function K(){return V}function X(e){const t=typeof e=="function"?e(V):e;if(V===t)return V;const n=V;return V={...V,...t},t.cursorFlags!==void 0&&xe.emit("cursorFlagsChange",V.cursorFlags),t.interactionState!==void 0&&xe.emit("interactionStateChange",V.interactionState),t.mountedGroups!==void 0&&(V.mountedGroups.forEach((r,a)=>{r.derivedPanelConstraints.forEach(u=>{if(u.collapsible){const{layout:s}=n.mountedGroups.get(a)??{};if(s){const l=A(u.collapsedSize,r.layout[u.panelId]),i=A(u.collapsedSize,s[u.panelId]);l&&!i&&(a.inMemoryLastExpandedPanelSizes[u.panelId]=s[u.panelId])}}})}),xe.emit("mountedGroupsChange",V.mountedGroups)),V}function yn(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ge(e,t){return A(e,t)?0:e>t?1:-1}function se({panelConstraints:e,size:t}){const{collapsedSize:n=0,collapsible:r,maxSize:a=100,minSize:u=0}=e;if(ge(t,u)<0)if(r){const s=(n+u)/2;ge(t,s)<0?t=n:t=u}else t=u;return t=Math.min(a,t),t=J(t),t}function $e({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:a,trigger:u}){if(A(e,0))return t;const s=Object.values(t),l=Object.values(a),i=[...s],[d,h]=r;R(d!=null,"Invalid first pivot index"),R(h!=null,"Invalid second pivot index");let y=0;if(u==="keyboard"){{const c=e<0?h:d,f=n[c];R(f,`Panel constraints not found for index ${c}`);const{collapsedSize:g=0,collapsible:p,minSize:j=0}=f;if(p){const S=s[c];if(R(S!=null,`Previous layout not found for panel index ${c}`),A(S,g)){const w=j-S;ge(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}{const c=e<0?d:h,f=n[c];R(f,`No panel constraints found for index ${c}`);const{collapsedSize:g=0,collapsible:p,minSize:j=0}=f;if(p){const S=s[c];if(R(S!=null,`Previous layout not found for panel index ${c}`),A(S,j)){const w=S-g;ge(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}}{const c=e<0?1:-1;let f=e<0?h:d,g=0;for(;;){const j=s[f];R(j!=null,`Previous layout not found for panel index ${f}`);const S=se({panelConstraints:n[f],size:100})-j;if(g+=S,f+=c,f<0||f>=n.length)break}const p=Math.min(Math.abs(e),Math.abs(g));e=e<0?0-p:p}{let c=e<0?d:h;for(;c>=0&&c<n.length;){const f=Math.abs(e)-Math.abs(y),g=s[c];R(g!=null,`Previous layout not found for panel index ${c}`);const p=g-f,j=se({panelConstraints:n[c],size:p});if(!A(g,j)&&(y+=g-j,i[c]=j,y.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?c--:c++}}if(yn(l,i))return a;{const c=e<0?h:d,f=s[c];R(f!=null,`Previous layout not found for panel index ${c}`);const g=f+y,p=se({panelConstraints:n[c],size:g});if(i[c]=p,!A(p,g)){let j=g-p,S=e<0?h:d;for(;S>=0&&S<n.length;){const w=i[S];R(w!=null,`Previous layout not found for panel index ${S}`);const b=w+j,z=se({panelConstraints:n[S],size:b});if(A(w,z)||(j-=z-w,i[S]=z),A(j,0))break;e>0?S--:S++}}}const v=Object.values(i).reduce((c,f)=>f+c,0);if(!A(v,100,.1))return a;const x=Object.keys(a);return i.reduce((c,f,g)=>(c[x[g]]=f,c),{})}function Ce(e){const t=e.parentElement;R(t,"Parent group element not found");const{mountedGroups:n}=K();for(const[r]of n)if(r.element===t)return r;throw Error("Could not find parent Group for separator element")}function ce(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(t[n]===void 0||ge(e[n],t[n])!==0)return!1;return!0}function me({layout:e,panelConstraints:t}){const n=[...Object.values(e)],r=n.reduce((s,l)=>s+l,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!A(r,100)&&n.length>0)for(let s=0;s<t.length;s++){const l=n[s];R(l!=null,`No layout data found for index ${s}`);const i=100/r*l;n[s]=i}let a=0;for(let s=0;s<t.length;s++){const l=n[s];R(l!=null,`No layout data found for index ${s}`);const i=se({panelConstraints:t[s],size:l});l!=i&&(a+=l-i,n[s]=i)}if(!A(a,0))for(let s=0;s<t.length;s++){const l=n[s];R(l!=null,`No layout data found for index ${s}`);const i=l+a,d=se({panelConstraints:t[s],size:i});if(l!==d&&(a-=d-l,n[s]=d,A(a,0)))break}const u=Object.keys(e);return n.reduce((s,l,i)=>(s[u[i]]=l,s),{})}function vt({groupId:e}){const t=()=>{const{mountedGroups:n}=K();for(const[r,a]of n)if(r.id===e)return{group:r,...a};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:n,layout:r}=t();return n?{}:r},setLayout(n){const{defaultLayoutDeferred:r,derivedPanelConstraints:a,group:u,layout:s,separatorToPanels:l}=t(),i=me({layout:n,panelConstraints:a});return r?s:(ce(s,i)||X(d=>({mountedGroups:new Map(d.mountedGroups).set(u,{defaultLayoutDeferred:r,derivedPanelConstraints:a,layout:i,separatorToPanels:l})})),i)}}}function St(e){const{mountedGroups:t}=K(),n=t.get(e);return R(n,`Mounted Group ${e.id} not found`),n}function ne(e,t){const n=Ce(e),r=St(n),a=n.separators.find(h=>h.element===e);R(a,"Matching separator not found");const u=r.separatorToPanels.get(a);R(u,"Matching panels not found");const s=u.map(h=>n.panels.indexOf(h)),l=vt({groupId:n.id}).getLayout(),i=$e({delta:t,initialLayout:l,panelConstraints:r.derivedPanelConstraints,pivotIndices:s,prevLayout:l,trigger:"keyboard"}),d=me({layout:i,panelConstraints:r.derivedPanelConstraints});ce(l,d)||X(h=>({mountedGroups:new Map(h.mountedGroups).set(n,{defaultLayoutDeferred:r.defaultLayoutDeferred,derivedPanelConstraints:r.derivedPanelConstraints,layout:d,separatorToPanels:r.separatorToPanels})}))}function Je(e){if(e.defaultPrevented)return;const t=e.currentTarget,n=Ce(t);if(!n.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),n.orientation==="vertical"&&ne(t,5);break}case"ArrowLeft":{e.preventDefault(),n.orientation==="horizontal"&&ne(t,-5);break}case"ArrowRight":{e.preventDefault(),n.orientation==="horizontal"&&ne(t,5);break}case"ArrowUp":{e.preventDefault(),n.orientation==="vertical"&&ne(t,-5);break}case"End":{e.preventDefault(),ne(t,100);break}case"Enter":{e.preventDefault();const r=Ce(t),{derivedPanelConstraints:a,layout:u,separatorToPanels:s}=St(r),l=r.separators.find(y=>y.element===t);R(l,"Matching separator not found");const i=s.get(l);R(i,"Matching panels not found");const d=i[0],h=a.find(y=>y.panelId===d.id);if(R(h,"Panel metadata not found"),h.collapsible){const y=u[d.id],v=h.collapsedSize===y?r.inMemoryLastExpandedPanelSizes[d.id]??h.minSize:h.collapsedSize;ne(t,v-y)}break}case"F6":{e.preventDefault();const r=Ce(t).separators.map(s=>s.element),a=Array.from(r).findIndex(s=>s===e.currentTarget);R(a!==null,"Index not found");const u=e.shiftKey?a>0?a-1:r.length-1:a+1<r.length?a+1:0;r[u].focus();break}case"Home":{e.preventDefault(),ne(t,-100);break}}}const bn=e=>e,Le=()=>{},jt=1,wt=2,zt=4,Ct=8,Ke={coarse:10,precise:5};function vn(e,t,n){let r,a={x:1/0,y:1/0};for(const u of t){const s=yt(n,u.rect);switch(e){case"horizontal":{s.x<=a.x&&(r=u,a=s);break}case"vertical":{s.y<=a.y&&(r=u,a=s);break}}}return r?{distance:a,hitRegion:r}:void 0}let Se;function Sn(){return Se===void 0&&(typeof matchMedia=="function"?Se=!!matchMedia("(pointer:coarse)").matches:Se=!1),Se}function jn(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function wn(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:et(e),b:et(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;R(r,"Stacking order can only be calculated for elements with a common ancestor");const a={a:Qe(Ze(n.a)),b:Qe(Ze(n.b))};if(a.a===a.b){const u=r.childNodes,s={a:n.a.at(-1),b:n.b.at(-1)};let l=u.length;for(;l--;){const i=u[l];if(i===s.a)return 1;if(i===s.b)return-1}}return Math.sign(a.a-a.b)}const zn=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Cn(e){const t=getComputedStyle(Et(e)??e).display;return t==="flex"||t==="inline-flex"}function En(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||Cn(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||zn.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function Ze(e){let t=e.length;for(;t--;){const n=e[t];if(R(n,"Missing node"),En(n))return n}return null}function Qe(e){return e&&Number(getComputedStyle(e).zIndex)||0}function et(e){const t=[];for(;e;)t.push(e),e=Et(e);return t}function Et(e){const{parentNode:t}=e;return jn(t)?t.host:t}function kn(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Ln({groupElement:e,hitRegion:t,pointerEventTarget:n}){if(!mt(n)||n.contains(e)||e.contains(n))return!0;if(wn(n,e)>0){let r=n;for(;r;){if(r.contains(e))return!0;if(kn(r.getBoundingClientRect(),t))return!1;r=r.parentElement}}return!0}function kt(e,t){const n=[];return t.forEach((r,a)=>{if(a.disabled)return;const u=Sn()?Ke.coarse:Ke.precise,s=bt(a),l=vn(a.orientation,s,{x:e.clientX,y:e.clientY});l&&l.distance.x<=u&&l.distance.y<=u&&Ln({groupElement:a.element,hitRegion:l.hitRegion.rect,pointerEventTarget:e.target})&&n.push(l.hitRegion)}),n}function tt(e){if(e.defaultPrevented)return;const{mountedGroups:t}=K(),n=kt(e,t),r=new Set,a=new Set,u=new Set,s=new Map;let l=!1;n.forEach(i=>{r.add(i.group),i.panels.forEach(h=>{a.add(h)}),i.separator&&(u.add(i.separator),l||(l=!0,i.separator.element.focus()));const d=t.get(i.group);d&&s.set(i.group,d.layout)}),X({interactionState:{hitRegions:n,initialLayoutMap:s,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),n.length&&e.preventDefault()}function Rn({cursorFlags:e,groups:t,state:n}){let r=0,a=0;switch(n){case"active":case"hover":t.forEach(u=>{if(!u.disableCursor)switch(u.orientation){case"horizontal":{r++;break}case"vertical":{a++;break}}})}if(r===0&&a===0)return null;switch(n){case"active":{const u=(e&jt)!==0,s=(e&wt)!==0,l=(e&zt)!==0,i=(e&Ct)!==0;if(e){if(u)return l?"se-resize":i?"ne-resize":"e-resize";if(s)return l?"sw-resize":i?"nw-resize":"w-resize";if(l)return"s-resize";if(i)return"n-resize"}break}}return r>0&&a>0?"move":r>0?"ew-resize":"ns-resize"}const nt=new WeakMap;function Ge(e){if(e.defaultView===null)return;let{prevStyle:t,styleSheet:n}=nt.get(e)??{};n===void 0&&(n=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets=[n]);const{cursorFlags:r,interactionState:a}=K();switch(a.state){case"active":case"hover":{const u=Rn({cursorFlags:r,groups:a.hitRegions.map(l=>l.group),state:a.state}),s=`*{cursor: ${u} !important; ${a.state==="active"?"touch-action: none;":""} }`;if(t===s)return;t=s,u?n.cssRules.length===0?n.insertRule(s):n.replaceSync(s):n.cssRules.length===1&&n.deleteRule(0);break}case"inactive":{t=void 0,n.cssRules.length===1&&n.deleteRule(0);break}}nt.set(e,{prevStyle:t,styleSheet:n})}function Lt({document:e,event:t,hitRegions:n,initialLayoutMap:r,mountedGroups:a,pointerDownAtPoint:u}){let s=0;const l=new Map(a);n.forEach(i=>{const{group:d,groupSize:h}=i,{disableCursor:y,orientation:v,panels:x}=d;let c=0;u?v==="horizontal"?c=(t.clientX-u.x)/h*100:c=(t.clientY-u.y)/h*100:v==="horizontal"?c=t.clientX<0?-100:100:c=t.clientY<0?-100:100;const f=r.get(d),{defaultLayoutDeferred:g,derivedPanelConstraints:p,layout:j,separatorToPanels:S}=a.get(d)??{defaultLayoutDeferred:!1};if(p&&f&&j&&S){const w=$e({delta:c,initialLayout:f,panelConstraints:p,pivotIndices:i.panels.map(b=>x.indexOf(b)),prevLayout:j,trigger:"mouse-or-touch"});if(ce(w,j)){if(c!==0&&!y)switch(v){case"horizontal":{s|=c<0?jt:wt;break}case"vertical":{s|=c<0?zt:Ct;break}}}else{l.set(i.group,{defaultLayoutDeferred:g,derivedPanelConstraints:p,layout:w,separatorToPanels:S});const b=i.group.panels.map(({id:z})=>z).join(",");i.group.inMemoryLayouts[b]=w}}}),X({cursorFlags:s,mountedGroups:l}),Ge(e)}function rt(e){const{interactionState:t,mountedGroups:n}=K();switch(t.state){case"active":Lt({document:e.currentTarget,event:e,hitRegions:t.hitRegions,initialLayoutMap:t.initialLayoutMap,mountedGroups:n})}}function ot(e){if(e.defaultPrevented)return;const{interactionState:t,mountedGroups:n}=K();switch(t.state){case"active":{if(e.buttons===0){X(r=>r.interactionState.state==="inactive"?r:{cursorFlags:0,interactionState:{state:"inactive"}});return}Lt({document:e.currentTarget,event:e,hitRegions:t.hitRegions,initialLayoutMap:t.initialLayoutMap,mountedGroups:n,pointerDownAtPoint:t.pointerDownAtPoint});break}default:{const r=kt(e,n);r.length===0?t.state!=="inactive"&&X({interactionState:{state:"inactive"}}):X({interactionState:{hitRegions:r,state:"hover"}}),Ge(e.currentTarget);break}}}function st(e){if(e.defaultPrevented)return;e.preventDefault();const{interactionState:t}=K();switch(t.state){case"active":X({cursorFlags:0,interactionState:{state:"inactive"}}),Ge(e.currentTarget)}}function at(e){let t=0,n=0;const r={};for(const u of e)if(u.defaultSize!==void 0){t++;const s=J(u.defaultSize);n+=s,r[u.panelId]=s}else r[u.panelId]=void 0;const a=e.length-t;if(a!==0){const u=J((100-n)/a);for(const s of e)s.defaultSize===void 0&&(r[s.panelId]=u)}return r}function Pn(e,t,n){const r=n[0];if(!r)return;const a=e.panels.find(s=>s.element===t);if(!a||!a.onResize)return;const u=le({group:e});a.onResize({asPercentage:J(r.inlineSize/u*100),inPixels:r.inlineSize},a.id)}function Mn(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function In(e,t){const n=e.map(a=>a.id),r=Object.keys(t);if(n.length!==r.length)return!1;for(const a of n)if(!r.includes(a))return!1;return!0}const oe=new Map;function Dn(e){let t=!0;R(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const n=e.element.ownerDocument.defaultView.ResizeObserver,r=new Set,a=new Set,u=new n(c=>{for(const f of c){const{borderBoxSize:g,target:p}=f;if(p===e.element){if(t){if(le({group:e})===0)return;X(j=>{const S=j.mountedGroups.get(e);if(S){const w=Ye(e),b=S.defaultLayoutDeferred?at(w):S.layout,z=me({layout:b,panelConstraints:w});return!S.defaultLayoutDeferred&&ce(b,z)&&Mn(S.derivedPanelConstraints,w)?j:{mountedGroups:new Map(j.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:w,layout:z,separatorToPanels:S.separatorToPanels})}}return j})}}else Pn(e,p,g)}});u.observe(e.element),e.panels.forEach(c=>{R(!r.has(c.id),`Panel ids must be unique; id "${c.id}" was used more than once`),r.add(c.id),c.onResize&&u.observe(c.element)});const s=le({group:e}),l=Ye(e),i=e.panels.map(({id:c})=>c).join(",");let d=e.defaultLayout;d&&(In(e.panels,d)||(d=void 0));const h=e.inMemoryLayouts[i]??d??at(l),y=me({layout:h,panelConstraints:l}),v=bt(e),x=e.element.ownerDocument;return X(c=>{const f=new Map;return oe.set(x,(oe.get(x)??0)+1),v.forEach(g=>{g.separator&&f.set(g.separator,g.panels)}),{mountedGroups:new Map(c.mountedGroups).set(e,{defaultLayoutDeferred:s===0,derivedPanelConstraints:l,layout:y,separatorToPanels:f})}}),e.separators.forEach(c=>{R(!a.has(c.id),`Separator ids must be unique; id "${c.id}" was used more than once`),a.add(c.id),c.element.addEventListener("keydown",Je)}),oe.get(x)===1&&(x.addEventListener("pointerdown",tt),x.addEventListener("pointerleave",rt),x.addEventListener("pointermove",ot),x.addEventListener("pointerup",st)),function(){t=!1,oe.set(x,Math.max(0,(oe.get(x)??0)-1)),X(c=>{const f=new Map(c.mountedGroups);return f.delete(e),{mountedGroups:f}}),e.separators.forEach(c=>{c.element.removeEventListener("keydown",Je)}),oe.get(x)||(x.removeEventListener("pointerdown",tt),x.removeEventListener("pointerleave",rt),x.removeEventListener("pointermove",ot),x.removeEventListener("pointerup",st)),u.disconnect()}}function Rt(e){const t=m.useId();return`${e??t}`}const ue=typeof window<"u"?m.useLayoutEffect:m.useEffect;function Ne(e){const t=m.useRef(e);return ue(()=>{t.current=e},[e]),m.useCallback(n=>{var r;return(r=t.current)==null?void 0:r.call(t,n)},[t])}function Pt(...e){return Ne(t=>{e.forEach(n=>{if(n)switch(typeof n){case"function":{n(t);break}case"object":{n.current=t;break}}})})}function Tn(e){const t=m.useRef({...e});return ue(()=>{for(const n in e)t.current[n]=e[n]},[e]),t.current}const Mt="--react-resizable-panels--panel--pointer-events";function It(e,t){const n=e.replace(/[^a-zA-Z0-9\-_]/g,""),r=t.replace(/[^a-zA-Z0-9\-_]/g,"");return`--react-resizable-panels--${n}--${r}`}const Dt=m.createContext(null);function $n(e,t){const n=m.useRef({getLayout:()=>({}),setLayout:bn});m.useImperativeHandle(t,()=>n.current,[]),ue(()=>{Object.assign(n.current,vt({groupId:e}))})}function Gn({children:e,className:t,defaultLayout:n,disableCursor:r,disabled:a,elementRef:u,groupRef:s,id:l,onLayoutChange:i,orientation:d="horizontal",style:h,...y}){const v=m.useRef({}),x=Ne(L=>{ce(v.current,L)||(v.current=L,i==null||i(L))}),c=Rt(l),[f,g]=m.useState(!1),[p,j]=m.useState(null),[S,w]=m.useState(n??{}),[b,z]=m.useState([]),[M,F]=m.useState([]),B=m.useRef({lastExpandedPanelSizes:{},layouts:{}}),_=Pt(j,u);$n(c,s);const H=m.useMemo(()=>({id:c,orientation:d,registerPanel:L=>(z(I=>Ie(d,[...I,L])),()=>{z(I=>I.filter(D=>D!==L))}),registerSeparator:L=>(F(I=>Ie(d,[...I,L])),()=>{F(I=>I.filter(D=>D!==L))})}),[c,d]),G=Tn({defaultLayout:n,disableCursor:r}),W=m.useRef(null);ue(()=>{if(p===null)return;const L={defaultLayout:G.defaultLayout,disableCursor:!!G.disableCursor,disabled:!!a,element:p,id:c,inMemoryLastExpandedPanelSizes:B.current.lastExpandedPanelSizes,inMemoryLayouts:B.current.layouts,orientation:d,panels:b,separators:M};W.current=L;const I=Dn(L),D=K().mountedGroups.get(L);if(D){const{defaultLayoutDeferred:Y,derivedPanelConstraints:U,layout:O}=D;!Y&&U.length>0&&(w(O),x==null||x(O))}const Z=xe.addListener("interactionStateChange",Y=>{switch(Y.state){case"active":{g(Y.hitRegions.some(U=>U.group===L));break}default:{g(!1);break}}}),de=xe.addListener("mountedGroupsChange",Y=>{const U=Y.get(L);if(U){const{defaultLayoutDeferred:O,derivedPanelConstraints:C,layout:N}=U;if(O||C.length===0)return;w(N),x==null||x(N)}});return()=>{W.current=null,I(),Z(),de()}},[a,p,c,x,d,b,M,G]),m.useEffect(()=>{const L=W.current;L&&(L.defaultLayout=n,L.disableCursor=!!r)});const q={[Mt]:f?"none":void 0};for(const L in S){const I=It(c,L),D=S[L];q[I]=D}return o.jsx(Dt.Provider,{value:H,children:o.jsx("div",{...y,"aria-orientation":d,className:t,"data-group":!0,"data-testid":c,id:c,ref:_,style:{...h,...q,display:"flex",flexDirection:d==="horizontal"?"row":"column",flexWrap:"nowrap"},children:e})})}function Tt(){const e=m.useContext(Dt);return R(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function Nn({groupId:e,panelId:t}){const n=()=>{const{mountedGroups:l}=K();for(const[i,{defaultLayoutDeferred:d,derivedPanelConstraints:h,layout:y,separatorToPanels:v}]of l)if(i.id===e)return{defaultLayoutDeferred:d,derivedPanelConstraints:h,group:i,layout:y,separatorToPanels:v};throw Error(`Group ${e} not found`)},r=()=>{const l=n().derivedPanelConstraints.find(i=>i.panelId===t);if(l!==void 0)return l;throw Error(`Panel constraints not found for Panel ${t}`)},a=()=>{const l=n().group.panels.find(i=>i.id===t);if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},u=()=>{const l=n().layout[t];if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},s=l=>{const i=u();if(l===i)return;const{defaultLayoutDeferred:d,derivedPanelConstraints:h,group:y,layout:v,separatorToPanels:x}=n(),c=y.panels.findIndex(j=>j.id===t),f=c===y.panels.length-1,g=$e({delta:f?i-l:l-i,initialLayout:v,panelConstraints:h,pivotIndices:f?[c-1,c]:[c,c+1],prevLayout:v,trigger:"imperative-api"}),p=me({layout:g,panelConstraints:h});ce(v,p)||X(j=>({mountedGroups:new Map(j.mountedGroups).set(y,{defaultLayoutDeferred:d,derivedPanelConstraints:h,layout:p,separatorToPanels:x})}))};return{collapse:()=>{const{collapsible:l,collapsedSize:i}=r(),d=u();l&&d!==i&&s(i)},expand:()=>{const{collapsible:l,collapsedSize:i,minSize:d}=r(),h=u();l&&h===i&&s(d)},getSize:()=>{const{group:l}=n(),i=u(),{element:d}=a(),h=l.orientation==="horizontal"?d.offsetWidth:d.offsetHeight;return{asPercentage:i,inPixels:h}},isCollapsed:()=>{const{collapsible:l,collapsedSize:i}=r(),d=u();return l&&A(i,d)},resize:l=>{if(u()!==l){let i;switch(typeof l){case"number":{const{group:d}=n(),h=le({group:d});i=J(l/h*100);break}case"string":{i=parseFloat(l);break}}s(i)}}}}function Wn(e,t){const{id:n}=Tt(),r=m.useRef({collapse:Le,expand:Le,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:Le});m.useImperativeHandle(t,()=>r.current,[]),ue(()=>{Object.assign(r.current,Nn({groupId:n,panelId:e}))})}function it({children:e,className:t,collapsedSize:n="0%",collapsible:r=!1,defaultSize:a,elementRef:u,id:s,maxSize:l="100%",minSize:i="0%",onResize:d,panelRef:h,style:y,...v}){const x=!!s,c=Rt(s),[f,g]=m.useState(null),p=Pt(g,u),{id:j,registerPanel:S}=Tt(),w=d!==null,b=Ne(M=>{d==null||d(M,s)});ue(()=>{if(f!==null)return S({element:f,id:c,idIsStable:x,onResize:w?b:void 0,panelConstraints:{collapsedSize:n,collapsible:r,defaultSize:a,maxSize:l,minSize:i}})},[n,r,a,f,w,c,x,l,i,b,S]),Wn(c,h);const z=It(j,c);return o.jsx("div",{...v,"data-panel":!0,"data-testid":c,id:c,ref:p,style:{...An,flexBasis:0,flexGrow:`var(${z}, 1)`,flexShrink:1,overflow:"hidden",pointerEvents:`var(${Mt})`},children:o.jsx("div",{className:t,style:{width:"100%",height:"100%",...y},children:e})})}const An={minHeight:"unset",maxHeight:"unset",height:"unset",minWidth:"unset",maxWidth:"unset",width:"unset",flex:"unset",flexBasis:"unset",flexShrink:"unset",flexGrow:"unset",border:"unset",borderWidth:"unset",padding:"unset",margin:"unset"},lt=["huobi","coinex","binance","bybit","okx","bitget","gate"],ct="SIGNAL_EXCHANGES",Fn="SIGNAL_WEEKS",Hn=({baseToken:e,setStatistic:t,exchanges:n})=>{const[r,a]=m.useState(!1),[u,s]=m.useState(null),[l]=m.useState(()=>Number(localStorage.getItem(Fn))||2),[i,d]=m.useState([]);m.useEffect(()=>{a(!0);const c=new Ft;return c.postMessage({type:"FUNDING_HISTORY",token:e,exchanges:n,weeks:l}),c.onmessage=f=>{f.data.status==="success"?d(f.data.data):s(f.data.errorMessage||"Failed to fetch data"),a(!1),c.terminate()},()=>c.terminate()},[l,e,n]);const h=m.useMemo(()=>Array.from(new Set(i.map(c=>c.exchange))),[i]),y=m.useMemo(()=>{const c={};return i.forEach(f=>{f.history.forEach(g=>{const p=te(g.fundingTime).format("MM-DD HH:mm");c[p]||(c[p]={}),c[p][f.exchange]=g.fundingRate})}),Object.keys(c).sort((f,g)=>te(g,"MM-DD HH:mm").isAfter(te(f,"MM-DD HH:mm"))?1:-1).map(f=>({time:f,rates:c[f]}))},[i]),v=m.useMemo(()=>{if(i.length<2)return{};const c=[...i].sort((S,w)=>w.accumulatedFunding-S.accumulatedFunding),f=c[0],g=c[c.length-1],p=[],j=[];return f.history.forEach(S=>{const w=g.history.find(b=>te(b.fundingTime).isSame(S.fundingTime));if(w){const b=S.fundingRate-w.fundingRate;p.push(te(S.fundingTime).format("HH:mm")),j.push({y:b,color:b>=0?ae:ie})}}),p.reverse(),j.reverse(),{chart:{type:"column",backgroundColor:"transparent",height:350,style:{fontFamily:"monospace"}},title:{text:`${f.exchange} vs ${g.exchange} (${l}W)`,style:{color:"#fff",fontSize:"14px"},align:"left"},xAxis:{categories:p,crosshair:!1,tickInterval:2,labels:{style:{color:"#888"},rotation:0},gridLineWidth:0,lineColor:"#333"},yAxis:{title:{text:""},gridLineColor:"#222",labels:{style:{color:"#888"}},plotLines:[{value:0,color:"#444",width:1}]},series:[{name:"Spread",data:j,borderRadius:2,borderWidth:0}],plotOptions:{column:{pointPadding:.1,groupPadding:.1,pointWidth:5}},legend:{enabled:!1},credits:{enabled:!1},tooltip:{backgroundColor:"#1a1a1a",style:{color:"#fff"},formatter:function(){return`<b>${this.category}</b><br/>Spread: ${this.y.toFixed(2)}%`}}}},[i,l]),x=m.useMemo(()=>i.length===0?[]:[{label:"7 Days",weeks:1},{label:"2 Weeks",weeks:2}].map(f=>{const g=te().subtract(f.weeks,"week"),j=[...i.map(M=>{const B=M.history.filter(_=>te(_.fundingTime).isAfter(g)).reduce((_,H)=>_+H.fundingRate,0);return{exchange:M.exchange,accumulated:B}})].sort((M,F)=>F.accumulated-M.accumulated),S=j[0],w=j[j.length-1],b=S.accumulated-w.accumulated,z=b/2/(f.weeks*7)*365;return{label:f.label,accumulated:b,apr:z,sellEx:S.exchange,buyEx:w.exchange}}),[i]);return m.useEffect(()=>{t(x)},[x,t]),r?o.jsx(P,{sx:{display:"flex",justifyContent:"center",p:5},children:o.jsx(Ht,{})}):o.jsxs(P,{children:[u?o.jsxs(ht,{severity:"error",variant:"filled",action:o.jsx(Te,{"aria-label":"close",color:"inherit",size:"small",children:o.jsx(Bt,{fontSize:"inherit"})}),sx:{width:"100%",boxShadow:c=>c.shadows[6],borderRadius:2},children:[o.jsx(Ot,{sx:{fontWeight:800},children:"Data Fetching Error"}),o.jsx(k,{variant:"body2",children:u})]}):null,o.jsx(P,{borderRadius:1,sx:{border:"1px solid rgba(255, 255, 255, 0.12)",py:2,px:0,my:2},children:o.jsx(_t,{highcharts:Ut,options:v})}),o.jsxs(Vt,{size:"small",sx:{border:"1px solid rgba(255, 255, 255, 0.12)"},children:[o.jsx(Xt,{children:o.jsxs(Be,{children:[o.jsxs(je,{children:[" ",o.jsx(k,{color:"text.secondary",children:"Time"})]}),h.map(c=>o.jsx(je,{align:"right",children:o.jsx(k,{color:"text.secondary",children:c.toUpperCase()})},c))]})}),o.jsx(Yt,{children:y.map(c=>o.jsxs(Be,{hover:!0,children:[o.jsx(je,{sx:{color:"gray"},children:c.time}),h.map(f=>{const g=c.rates[f];return o.jsx(je,{align:"right",children:o.jsx(k,{variant:"body2",sx:{color:g>0?ae:g<0?ie:"inherit"},children:g!==void 0?`${g.toFixed(3)}%`:"â€”"})},f)})]},c.time))})]})]})},je=qt(Jt)({padding:"8px 16px"});function On({data:e}){return o.jsx(Kt,{variant:"outlined",sx:{p:2,borderRadius:2,bgcolor:"background.paper",borderStyle:"dashed",mb:2},children:o.jsxs(P,{sx:{mb:1},children:[o.jsx(k,{mb:2,component:"h6",variant:"h6",fontWeight:"600",children:"Best performance over the recent period"}),o.jsxs(E,{container:!0,spacing:2,children:[o.jsx(E,{size:4,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Period"})}),o.jsx(E,{size:4,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Apr"})}),o.jsx(E,{size:4,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Exchanges"})})]}),e.map((t,n)=>o.jsxs(E,{container:!0,spacing:2,sx:{mt:1},children:[o.jsx(E,{size:4,children:o.jsxs(k,{variant:"body2",color:"white",sx:{display:"inline-flex"},children:[o.jsx("span",{children:t.label})," ",o.jsxs("span",{children:["(",t.accumulated.toFixed(3),"%)"]})]})}),o.jsx(E,{size:4,children:o.jsxs(k,{variant:"body2",color:"white",children:[t.apr.toFixed(3),"%"]})}),o.jsx(E,{size:4,children:o.jsxs(k,{variant:"body2",sx:{display:"inline-flex"},children:[o.jsx("span",{style:{color:ie},children:t.sellEx}),o.jsx("span",{style:{color:"gray"},children:" / "}),o.jsx("span",{style:{color:ae},children:t.buyEx})]})})]},n))]})})}var Re,ut;function Bn(){if(ut)return Re;ut=1;var e="Expected a function",t=NaN,n="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,i=typeof be=="object"&&be&&be.Object===Object&&be,d=typeof self=="object"&&self&&self.Object===Object&&self,h=i||d||Function("return this")(),y=Object.prototype,v=y.toString,x=Math.max,c=Math.min,f=function(){return h.Date.now()};function g(b,z,M){var F,B,_,H,G,W,q=0,L=!1,I=!1,D=!0;if(typeof b!="function")throw new TypeError(e);z=w(z)||0,p(M)&&(L=!!M.leading,I="maxWait"in M,_=I?x(w(M.maxWait)||0,z):_,D="trailing"in M?!!M.trailing:D);function Z($){var Q=F,fe=B;return F=B=void 0,q=$,H=b.apply(fe,Q),H}function de($){return q=$,G=setTimeout(O,z),L?Z($):H}function Y($){var Q=$-W,fe=$-q,We=z-Q;return I?c(We,_-fe):We}function U($){var Q=$-W,fe=$-q;return W===void 0||Q>=z||Q<0||I&&fe>=_}function O(){var $=f();if(U($))return C($);G=setTimeout(O,Y($))}function C($){return G=void 0,D&&F?Z($):(F=B=void 0,H)}function N(){G!==void 0&&clearTimeout(G),q=0,F=W=B=G=void 0}function ye(){return G===void 0?H:C(f())}function T(){var $=f(),Q=U($);if(F=arguments,B=this,W=$,Q){if(G===void 0)return de(W);if(I)return G=setTimeout(O,z),Z(W)}return G===void 0&&(G=setTimeout(O,z)),H}return T.cancel=N,T.flush=ye,T}function p(b){var z=typeof b;return!!b&&(z=="object"||z=="function")}function j(b){return!!b&&typeof b=="object"}function S(b){return typeof b=="symbol"||j(b)&&v.call(b)==n}function w(b){if(typeof b=="number")return b;if(S(b))return t;if(p(b)){var z=typeof b.valueOf=="function"?b.valueOf():b;b=p(z)?z+"":z}if(typeof b!="string")return b===0?b:+b;b=b.replace(r,"");var M=u.test(b);return M||s.test(b)?l(b.slice(2),M?2:8):a.test(b)?t:+b}return Re=g,Re}Bn();var _n=typeof window<"u"?m.useLayoutEffect:m.useEffect;function Un(e,t){const n=m.useRef(e);_n(()=>{n.current=e},[e]),m.useEffect(()=>{const r=setInterval(()=>{n.current()},t);return()=>{clearInterval(r)}},[t])}const dt=async(e,t)=>{var r,a,u;const n="USDT";try{switch(e){case"okx":{const{data:s}=await ke.get(`https://www.okx.com/api/v5/public/instruments?instId=${t}-${n}-SWAP&instType=SWAP`),l=(a=(r=s==null?void 0:s.data)==null?void 0:r[0])==null?void 0:a.ctVal;return l?Number(l):0}case"gate":{const{data:s}=await ke.get(`${Me}/https://api.gateio.ws/api/v4/futures/usdt/contracts/${t}_${n}`);return s!=null&&s.quanto_multiplier?Number(s.quanto_multiplier):0}case"huobi":{const{data:s}=await ke.get(`${Me}/https://api.hbdm.com/linear-swap-api/v1/swap_contract_info?contract_code=${t}-${n}`),l=(u=s==null?void 0:s.data)==null?void 0:u[0];return l!=null&&l.contract_size?Number(l.contract_size):0}case"bitget":case"coinex":case"bybit":return 1;default:return console.warn(`No contract size fetcher defined for exchange: ${e}`),1}}catch(s){return console.error(`Error fetching contract size for ${e} ${t}:`,s),0}};function Vn(e,t){var n=m.useRef(null),r=m.useRef(null);r.current=t;var a=m.useRef(null);m.useEffect(function(){u()});var u=m.useCallback(function(){var s=a.current,l=r.current,i=s||(l?l instanceof Element?l:l.current:null);n.current&&n.current.element===i&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:i,subscriber:e,cleanup:i?e(i):void 0})},[e]);return m.useEffect(function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}},[]),m.useCallback(function(s){a.current=s,u()},[u])}function ft(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:t==="contentBoxSize"?e.contentRect[n==="inlineSize"?"width":"height"]:void 0}function Xn(e){e===void 0&&(e={});var t=e.onResize,n=m.useRef(void 0);n.current=t;var r=e.round||Math.round,a=m.useRef(),u=m.useState({width:void 0,height:void 0}),s=u[0],l=u[1],i=m.useRef(!1);m.useEffect(function(){return i.current=!1,function(){i.current=!0}},[]);var d=m.useRef({width:void 0,height:void 0}),h=Vn(m.useCallback(function(y){return(!a.current||a.current.box!==e.box||a.current.round!==r)&&(a.current={box:e.box,round:r,instance:new ResizeObserver(function(v){var x=v[0],c=e.box==="border-box"?"borderBoxSize":e.box==="device-pixel-content-box"?"devicePixelContentBoxSize":"contentBoxSize",f=ft(x,c,"inlineSize"),g=ft(x,c,"blockSize"),p=f?r(f):void 0,j=g?r(g):void 0;if(d.current.width!==p||d.current.height!==j){var S={width:p,height:j};d.current.width=p,d.current.height=j,n.current?n.current(S):i.current||l(S)}})}),a.current.instance.observe(y,{box:e.box}),function(){a.current&&a.current.instance.unobserve(y)}},[e.box,r]),e.ref);return m.useMemo(function(){return{ref:h,width:s.width,height:s.height}},[h,s.width,s.height])}const qn=new ccxt.pro.binance({}),$t=new ccxt.pro.mexc({}),Gt=new ccxt.pro.gate({}),Yn=new ccxt.pro.bitget({}),Nt=new ccxt.pro.kucoin({}),Jn=new ccxt.pro.okx({}),Kn=new ccxt.pro.bybit({}),Wt=new ccxt.pro.huobi({has:{fetchCurrencies:!1,fetchMarkets:!1,fetchDepositWithdrawFees:!1}}),At=new ccxt.pro.coinex({has:{fetchCurrencies:!1,fetchMarkets:!1}}),Ee=`${Me}/`;At.proxyUrl=Ee;$t.proxyUrl=Ee;Gt.proxyUrl=Ee;Nt.proxyUrl=Ee;Wt.proxyUrl="http://178.128.110.139:8080/";const Pe={binance:qn,mexc:$t,gate:Gt,bitget:Yn,okx:Jn,bybit:Kn,huobi:Wt,kucoin:Nt,coinex:At},Zn="disablesExchanges",Qn=JSON.parse(localStorage.getItem(Zn)||"[]"),we=e=>`${e}/USDT:USDT`.toUpperCase();function er({baseToken:e,depth:t=2,id:n,buyExchange:r,sellExchange:a,removeOrderbook:u}){const{ref:s,width:l=1}=Xn(),i=l<450,[d,h]=m.useState(),[y,v]=m.useState(),[x,c]=m.useState(),[f,g]=m.useState(),[p,j]=m.useState(),[S,w]=m.useState(we(e)),[b,z]=m.useState(we(e)),[M,F]=m.useState(r),[B,_]=m.useState(a),[H,G]=m.useState(r||"okx"),[W,q]=m.useState(a||"bybit"),L=async()=>{const C=await Promise.all([qe(a,e),qe(r,e)]);g({sell:C[0].rate,buy:C[1].rate})},I=async()=>{const C=await Promise.all([dt(a,e),dt(r,e)]);j({sell:C[0],buy:C[1]})};m.useEffect(()=>{q(a),G(r),L(),I()},[a,r]);const[D,Z]=m.useState({buySymbol:S,sellSymbol:b,longExName:H,shortExName:W});m.useEffect(()=>{if(e.length){const C=`${e}/USDT:USDT`;Z(N=>({...N,buySymbol:C,sellSymbol:C}))}},[e]),m.useEffect(()=>{_(Pe[W]),F(Pe[H])},[W,H]),Un(async()=>{const C=await M.watchOrderBook(`${S}`).catch(T=>h(T==null?void 0:T.message)),N=await B.watchOrderBook(`${b}`).catch(T=>h(T==null?void 0:T.message)),ye=T=>({...T,bids:T.bids.slice(0,t),asks:T.asks.slice(0,t)});(C==null?void 0:C.symbol)===S&&v(T=>({...T,...ye(C)})),(N==null?void 0:N.symbol)===b&&c(T=>({...T,...ye(N)}))},200),m.useEffect(()=>{L(),I(),z(we(e)),w(we(e))},[e]);const de=()=>{q(D.shortExName),G(D.longExName),z(D.sellSymbol),w(D.buySymbol),c(void 0),v(void 0)},Y=(C,N)=>{N!=="clickaway"&&h(void 0)},U=Object.keys(Pe).filter(C=>!Qn.includes(C)),O=f!=null&&f.sell&&(f!=null&&f.buy)?(f==null?void 0:f.sell)-(f==null?void 0:f.buy):0;return o.jsxs(P,{ref:s,display:"flex",flexDirection:"column",gap:"12px",children:[o.jsx(Zt,{sx:{border:"1px solid rgba(255, 255, 255, 0.12)",borderRadius:1,background:"none"},children:o.jsx(Qt,{sx:{padding:"0px","&:last-child":{paddingBottom:1}},children:o.jsxs(E,{container:!0,spacing:i?1:2,children:[o.jsxs(E,{p:"16px",size:i?12:4,children:[o.jsxs(P,{display:"flex",gap:"16px",mb:"16px",children:[o.jsxs(_e,{variant:"standard",sx:{minWidth:100},children:[o.jsx(Ue,{children:"Sell Exchange"}),o.jsx(Ve,{value:D.shortExName,label:"Short Exchange",onChange:C=>{Z(N=>({...N,shortExName:C.target.value}))},children:U.map(C=>o.jsx(Xe,{value:C,children:C},C))})]}),o.jsx(P,{flexGrow:1,children:o.jsx(k,{variant:"body2",color:"text.secondary",textAlign:"right",children:b})})]}),x?o.jsx(pt,{bids:x.bids,asks:x.asks,contractSize:(p==null?void 0:p.buy)||0}):o.jsxs(P,{sx:{width:"90%"},children:[o.jsx(re,{}),o.jsx(re,{animation:"wave"}),o.jsx(re,{animation:!1})]})]}),o.jsxs(E,{size:i?12:4,sx:{padding:"16px",borderLeft:i?"none":"1px solid rgba(255, 255, 255, 0.12)",borderTop:i?"1px solid rgba(255, 255, 255, 0.12)":"none"},children:[o.jsxs(P,{display:"flex",gap:"16px",mb:"16px",children:[o.jsxs(_e,{variant:"standard",sx:{minWidth:100},children:[o.jsx(Ue,{children:"Buy Exchange"}),o.jsx(Ve,{value:D.longExName,label:"Long Exchange",onChange:C=>{Z(N=>({...N,longExName:C.target.value}))},children:U.map(C=>o.jsx(Xe,{value:C,children:C},C))})]}),o.jsx(P,{flexGrow:1,children:o.jsx(k,{variant:"body2",color:"text.secondary",textAlign:"right",children:S})})]}),y?o.jsx(pt,{bids:y.bids,asks:y.asks,contractSize:(p==null?void 0:p.buy)||0}):o.jsxs(P,{sx:{width:"90%"},children:[o.jsx(re,{}),o.jsx(re,{animation:"wave"}),o.jsx(re,{animation:!1})]})]}),o.jsx(E,{size:i?12:4,sx:{padding:"16px",borderLeft:i?"none":"1px solid rgba(255, 255, 255, 0.12)",borderTop:i?"1px solid rgba(255, 255, 255, 0.12)":"none",position:"relative"},children:o.jsxs(P,{children:[o.jsx(P,{display:"flex",gap:1,justifyContent:"space-between",mb:2,children:o.jsxs(P,{display:"flex",width:"100%",flexDirection:"row",justifyContent:"space-between",gap:1,children:[o.jsx(k,{color:"text.secondarty",variant:"caption",children:"Net funding:"}),o.jsxs(k,{sx:{fontWeight:"bold",color:O>0?ae:O<0?ie:"inherit"},variant:"body1",children:[(O*100).toFixed(3),"%"]})]})}),o.jsx(en,{}),o.jsxs(P,{mt:2,children:[o.jsxs(E,{container:!0,children:[o.jsx(E,{size:3}),o.jsx(E,{size:9,mb:1,children:o.jsxs(E,{container:!0,children:[o.jsx(E,{size:6,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Spread"})}),o.jsx(E,{size:6,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},textAlign:"right",display:"block",children:"Volume $"})})]})})]}),o.jsxs(E,{container:!0,mb:2,children:[o.jsx(E,{size:3,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Open:"})}),o.jsxs(E,{size:9,children:[o.jsx(ze,{sellOrder:x==null?void 0:x.bids[0],buyOrder:y==null?void 0:y.asks[0],sellContractSize:p==null?void 0:p.sell,buyContractSize:p==null?void 0:p.buy}),o.jsx(ze,{isSecondary:!0,sellOrder:x==null?void 0:x.bids[1],buyOrder:y==null?void 0:y.asks[1],sellContractSize:p==null?void 0:p.sell,buyContractSize:p==null?void 0:p.buy})]})]}),o.jsxs(E,{container:!0,children:[o.jsx(E,{size:3,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Close:"})}),o.jsxs(E,{size:9,children:[o.jsx(ze,{sellOrder:y==null?void 0:y.bids[0],buyOrder:x==null?void 0:x.asks[0],sellContractSize:p==null?void 0:p.sell,buyContractSize:p==null?void 0:p.buy}),o.jsx(ze,{isSecondary:!0,sellOrder:y==null?void 0:y.bids[1],buyOrder:x==null?void 0:x.asks[1],sellContractSize:p==null?void 0:p.sell,buyContractSize:p==null?void 0:p.buy})]})]})]}),o.jsxs(xt,{direction:"row",mt:3,spacing:1,justifyContent:"space-between",children:[o.jsx(gt,{color:"info",variant:"outlined",onClick:de,startIcon:o.jsx(ln,{}),children:"Watch"}),o.jsx(Te,{onClick:()=>u(n),color:"error",children:o.jsx(an,{})})]})]})})]})})}),o.jsx(tn,{open:!!(d!=null&&d.length),autoHideDuration:6e3,onClose:Y,children:o.jsx(ht,{onClose:Y,severity:"error",variant:"filled",sx:{width:"100%"},children:d})})]})}const ze=({sellOrder:e,buyOrder:t,sellContractSize:n=0,buyContractSize:r=0,isSecondary:a=!1})=>{const u=e&&t?tr(e[0]||0,t[0]||0):0,s=((e==null?void 0:e[0])||0)*((e==null?void 0:e[1])||0)*n,l=((t==null?void 0:t[0])||0)*((t==null?void 0:t[1])||0)*r,i=Math.min(s,l);return o.jsxs(E,{spacing:1,container:!0,sx:{opacity:a?.4:1,alignItems:"center"},children:[o.jsx(E,{size:6,children:o.jsxs(k,{variant:"body1",sx:{fontWeight:"bold",fontFamily:"monospace",textAlign:"left"},color:u>0?ae:ie,children:[e&&t?he(u).format("0.00"):"0.00","%"]})}),o.jsx(E,{size:6,children:o.jsx(k,{variant:"body2",sx:{fontFamily:"monospace",textAlign:"right",display:"block"},children:he(i).format("0,0")})})]})},pt=({bids:e,asks:t,contractSize:n})=>{var l,i;const r=(d,h=!1)=>{const y=d.map(([v=0,x=0])=>({price:v,amount:x,cost:v*x*n}));return h?[...y].reverse():y},a=r(e,!1),u=r(t,!0),s=(d,h,y)=>o.jsx(o.Fragment,{children:d.map(({price:v,cost:x})=>o.jsxs(E,{container:!0,children:[o.jsx(E,{size:6,children:o.jsx(k,{color:h,variant:"body1",gutterBottom:!0,sx:{fontFamily:"monospace"},children:he(v).format("0,0.0[000000]")})}),o.jsx(E,{size:6,children:o.jsx(k,{variant:"body1",gutterBottom:!0,sx:{fontFamily:"monospace"},children:he(x).format("0,0")})})]},`${y}-${v}`))});return o.jsxs(P,{children:[o.jsxs(E,{container:!0,sx:{mb:1},children:[o.jsx(E,{size:6,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Price"})}),o.jsx(E,{size:6,children:o.jsx(k,{variant:"caption",color:"gray",sx:{fontWeight:"bold"},children:"Volume ($)"})})]}),s(u,ie,"ask"),o.jsx(P,{py:"8px",sx:{textAlign:"left",my:1,borderY:"1px solid rgba(255, 255, 255, 0.12)"},children:o.jsxs(k,{variant:"caption",color:"gray",children:["Spread:"," ",(l=t==null?void 0:t[0])!=null&&l[0]&&((i=e==null?void 0:e[0])!=null&&i[0])?he((t[0][0]-e[0][0])/t[0][0]*100).format("0.000"):"0.000","%"]})}),s(a,ae,"bid")]})},tr=(e,t)=>(Number(e)-Number(t))/e*100,nr=new Date().getTime();function sr(){const[e,t]=nn(),n=e.get("token")||"BTC",[r,a]=m.useState(n),[u,s]=m.useState(n),l=()=>{s(r.toUpperCase()),t({token:r.toUpperCase()})},[i,d]=m.useState(()=>JSON.parse(localStorage.getItem(ct)||JSON.stringify(lt))),[h,y]=m.useState([]),[v,x]=m.useState([{id:nr}]),c=()=>{x(g=>[...g,{id:new Date().getTime()}])},f=g=>{x(p=>p.map(j=>g===j.id?{id:g,disabled:!0}:j))};return o.jsxs(P,{display:"flex",flexDirection:"column",gap:"12px",py:"32px",children:[o.jsx(k,{component:"h1",variant:"h3",fontWeight:"800",children:"Cross-Exchange Orderbook & Funding Analysis"}),o.jsx(k,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Analyze real-time funding history and aggregate orderbook depth across multiple exchanges. Compare buy/sell liquidity for any base token to identify arbitrage opportunities or market trends."}),o.jsxs(Gn,{children:[o.jsx(it,{minSize:350,children:o.jsxs(P,{sx:{borderRight:"2px dashed rgba(255, 255, 255, 0.13)",p:2},children:[o.jsxs(P,{gap:2,display:"flex",borderRadius:1,sx:{border:"1px solid rgba(255, 255, 255, 0.12)",p:2},alignItems:"flex-start",children:[o.jsx(rn,{options:lt,value:i,onChange:g=>{localStorage.setItem(ct,JSON.stringify(g)),d(g)},getOptionLabel:g=>g}),o.jsxs(xt,{direction:"row",spacing:1,alignItems:"flex-end",justifyContent:"space-between",flexGrow:1,children:[o.jsxs(P,{children:[o.jsx(k,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Base Token"}),o.jsx(on,{label:"",variant:"outlined",size:"small",value:r,onChange:g=>a(g.target.value),onKeyDown:g=>g.key==="Enter"&&l(),sx:{flexGrow:1}})]}),o.jsx(gt,{variant:"outlined",onClick:l,children:"Check"})]})]}),o.jsx(Hn,{baseToken:u,exchanges:i,setStatistic:y})]})}),o.jsx(it,{minSize:350,children:o.jsxs(P,{sx:{p:2},display:"flex",flexDirection:"column",gap:"12px",children:[o.jsx(On,{data:h}),v.map(({id:g,disabled:p})=>!p&&h[0]?o.jsx(er,{buyExchange:h[0].buyEx,sellExchange:h[0].sellEx,baseToken:u,id:g,removeOrderbook:f},g):null),o.jsx(P,{display:"flex",justifyContent:"flex-end",children:o.jsx(Te,{size:"large",onClick:c,color:"info",children:o.jsx(sn,{fontSize:"large"})})})]})})]})]})}export{sr as default};
