(()=>{var t,e,i={17(t,e,i){"use strict";i.d(e,{F9:()=>a,sb:()=>n,um:()=>o});var s=i(7525),r=i(9806);i(1838),i(3726),i(8846),i(7648),i(3200),i(5425);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const a={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.order&&s.pH.encode(t.order,e.uint32(10).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={order:void 0};for(;i.pos<r;){const t=i.uint32();if(t>>>3==1)a.order=s.pH.decode(i,i.uint32());else i.skipType(7&t)}return a},fromPartial(t){const e={order:void 0};return e.order=void 0!==t.order&&null!==t.order?s.pH.fromPartial(t.order):void 0,e}};const n={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.orderId&&s.e3.encode(t.orderId,e.uint32(10).fork()).ldelim(),void 0!==t.goodTilBlock&&e.uint32(16).uint32(t.goodTilBlock),void 0!==t.goodTilBlockTime&&e.uint32(29).fixed32(t.goodTilBlockTime),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={orderId:void 0,goodTilBlock:void 0,goodTilBlockTime:void 0};for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.orderId=s.e3.decode(i,i.uint32());break;case 2:a.goodTilBlock=i.uint32();break;case 3:a.goodTilBlockTime=i.fixed32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={orderId:void 0,goodTilBlock:void 0,goodTilBlockTime:void 0};return e.orderId=void 0!==t.orderId&&null!==t.orderId?s.e3.fromPartial(t.orderId):void 0,e.goodTilBlock=t.goodTilBlock??void 0,e.goodTilBlockTime=t.goodTilBlockTime??void 0,e}};const o={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.subaccountId&&r.D.encode(t.subaccountId,e.uint32(10).fork()).ldelim();for(const i of t.shortTermCancels)d.encode(i,e.uint32(18).fork()).ldelim();return 0!==t.goodTilBlock&&e.uint32(24).uint32(t.goodTilBlock),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a={subaccountId:void 0,shortTermCancels:[],goodTilBlock:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.subaccountId=r.D.decode(i,i.uint32());break;case 2:a.shortTermCancels.push(d.decode(i,i.uint32()));break;case 3:a.goodTilBlock=i.uint32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={subaccountId:void 0,shortTermCancels:[],goodTilBlock:0};return e.subaccountId=void 0!==t.subaccountId&&null!==t.subaccountId?r.D.fromPartial(t.subaccountId):void 0,e.shortTermCancels=t.shortTermCancels?.map(t=>d.fromPartial(t))||[],e.goodTilBlock=t.goodTilBlock??0,e}};const d={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){0!==t.clobPairId&&e.uint32(8).uint32(t.clobPairId),e.uint32(18).fork();for(const i of t.clientIds)e.uint32(i);return e.ldelim(),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={clobPairId:0,clientIds:[]};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.clobPairId=i.uint32();break;case 2:if(2==(7&t)){const t=i.uint32()+i.pos;for(;i.pos<t;)r.clientIds.push(i.uint32())}else r.clientIds.push(i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={clobPairId:0,clientIds:[]};return e.clobPairId=t.clobPairId??0,e.clientIds=t.clientIds?.map(t=>t)||[],e}}},39(t,e,i){"use strict";i.d(e,{c:()=>y});var s=i(1064),r=i(987),a=i(712),n=i(2435),o=i(4852),d=i(7481),c=i(1094),h=i(4710);
/*! scure-bip32 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */
const l=r.bI.ProjectivePoint;function u(t){(0,c.DO)(t);const e=0===t.length?"0":(0,c.My)(t);return BigInt("0x"+e)}const p=(0,c.AI)("Bitcoin seed"),f={private:76066276,public:76067358},m=2147483648,g=t=>{if(!Number.isSafeInteger(t)||t<0||t>2**32-1)throw new Error("invalid number, should be from 0 to 2**32-1, got "+t);const e=new Uint8Array(4);return(0,c.O8)(e).setUint32(0,t,!1),e};class y{constructor(t){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!t||"object"!=typeof t)throw new Error("HDKey.constructor must not be called directly");if(this.versions=t.versions||f,this.depth=t.depth||0,this.chainCode=t.chainCode||null,this.index=t.index||0,this.parentFingerprint=t.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(t.publicKey&&t.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(t.privateKey){if(!r.bI.utils.isValidPrivateKey(t.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof t.privateKey?t.privateKey:u(t.privateKey),this.privKeyBytes=function(t){if("bigint"!=typeof t)throw new Error("bigint expected");return(0,c.aT)(t.toString(16).padStart(64,"0"))}(this.privKey),this.pubKey=r.bI.getPublicKey(t.privateKey,!0)}else{if(!t.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=l.fromHex(t.publicKey).toRawBytes(!0)}var e;this.pubHash=(e=this.pubKey,(0,n.H)((0,o.s)(e)))}get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return t=this.pubHash,(0,c.O8)(t).getUint32(0,!1);var t}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const t=this.privateKey;if(!t)throw new Error("No private key");return h.tw.encode(this.serialize(this.versions.private,(0,c.Id)(new Uint8Array([0]),t)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return h.tw.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(t,e=f){if((0,c.DO)(t),8*t.length<128||8*t.length>512)throw new Error("HDKey: seed length must be between 128 and 512 bits; 256 bits is advised, got "+t.length);const i=(0,a.w)(d.Zf,p,t);return new y({versions:e,chainCode:i.slice(32),privateKey:i.slice(0,32)})}static fromExtendedKey(t,e=f){const i=h.tw.decode(t),s=(0,c.O8)(i),r=s.getUint32(0,!1),a={versions:e,depth:i[4],parentFingerprint:s.getUint32(5,!1),index:s.getUint32(9,!1),chainCode:i.slice(13,45)},n=i.slice(45),o=0===n[0];if(r!==e[o?"private":"public"])throw new Error("Version mismatch");return new y(o?{...a,privateKey:n.slice(1)}:{...a,publicKey:n})}static fromJSON(t){return y.fromExtendedKey(t.xpriv)}derive(t){if(!/^[mM]'?/.test(t))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(t))return this;const e=t.replace(/^[mM]'?\//,"").split("/");let i=this;for(const t of e){const e=/^(\d+)('?)$/.exec(t),s=e&&e[1];if(!e||3!==e.length||"string"!=typeof s)throw new Error("invalid child index: "+t);let r=+s;if(!Number.isSafeInteger(r)||r>=m)throw new Error("Invalid index");"'"===e[2]&&(r+=m),i=i.deriveChild(r)}return i}deriveChild(t){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let e=g(t);if(t>=m){const t=this.privateKey;if(!t)throw new Error("Could not derive hardened child key");e=(0,c.Id)(new Uint8Array([0]),t,e)}else e=(0,c.Id)(this.pubKey,e);const i=(0,a.w)(d.Zf,this.chainCode,e),n=u(i.slice(0,32)),o=i.slice(32);if(!r.bI.utils.isValidPrivateKey(n))throw new Error("Tweak bigger than curve order");const h={versions:this.versions,chainCode:o,depth:this.depth+1,parentFingerprint:this.fingerprint,index:t};try{if(this.privateKey){const t=(0,s.zi)(this.privKey+n,r.bI.CURVE.n);if(!r.bI.utils.isValidPrivateKey(t))throw new Error("The tweak was out of range or the resulted private key is invalid");h.privateKey=t}else{const t=l.fromHex(this.pubKey).add(l.fromPrivateKey(n));if(t.equals(l.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");h.publicKey=t.toRawBytes(!0)}return new y(h)}catch(e){return this.deriveChild(t+1)}}sign(t){if(!this.privateKey)throw new Error("No privateKey set!");return(0,c.DO)(t),r.bI.sign(t,this.privKey).toCompactRawBytes()}verify(t,e){if((0,c.DO)(t),(0,c.DO)(e),!this.publicKey)throw new Error("No publicKey set!");let i;try{i=r.bI.Signature.fromCompact(e)}catch(t){return!1}return r.bI.verify(i,t,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(t,e){if(!this.chainCode)throw new Error("No chainCode set");return(0,c.DO)(e),(0,c.Id)(g(t),new Uint8Array([this.depth]),g(this.parentFingerprint),g(this.index),this.chainCode,e)}}},40(t,e,i){"use strict";var s,r,a;i.d(e,{Fg:()=>r,fE:()=>s,uS:()=>a}),function(t){t.DEPLOY="DEPLOY",t.CALL="CALL",t.INVOKE="INVOKE"}(s||(s={})),function(t){t.u8="core::integer::u8",t.u16="core::integer::u16",t.u32="core::integer::u32",t.u64="core::integer::u64",t.u128="core::integer::u128",t.u256="core::integer::u256",t.u512="core::integer::u512"}(r||(r={})),function(t){t.ClassHash="core::starknet::class_hash::ClassHash",t.ContractAddress="core::starknet::contract_address::ContractAddress",t.Secp256k1Point="core::starknet::secp256k1::Secp256k1Point"}(a||(a={}))},63(t,e,i){"use strict";i.d(e,{A:()=>r});var s=i(9946);class r extends s.A{describe(){return this.deepExtend(super.describe(),{id:"huobi",alias:!0})}}},162(t,e,i){"use strict";i.d(e,{K:()=>s});const s={Active:"1",Legacy:"0"}},178(t,e,i){"use strict";i.d(e,{VO:()=>a,ow:()=>r,yw:()=>s});function s(t){return(new TextEncoder).encode(t)}function r(t){return t.replace(/^0x/i,"")}function a(t){return`0x${r(t)}`}},191(t,e,i){"use strict";i.d(e,{AI:()=>v,IV:()=>f,Id:()=>g,My:()=>o,OG:()=>b,Ph:()=>h,Q5:()=>T,aT:()=>c,ex:()=>y,fg:()=>k,lX:()=>l,lq:()=>u,qj:()=>m,z:()=>p});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
BigInt(0);const s=BigInt(1),r=BigInt(2),a=t=>t instanceof Uint8Array,n=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function o(t){if(!a(t))throw new Error("Uint8Array expected");let e="";for(let i=0;i<t.length;i++)e+=n[t[i]];return e}function d(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function c(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);const e=new Uint8Array(t.length/2);for(let i=0;i<e.length;i++){const s=2*i,r=t.slice(s,s+2),a=Number.parseInt(r,16);if(Number.isNaN(a)||a<0)throw new Error("invalid byte sequence");e[i]=a}return e}function h(t){return d(o(t))}function l(t){if(!a(t))throw new Error("Uint8Array expected");return d(o(Uint8Array.from(t).reverse()))}const u=(t,e)=>c(t.toString(16).padStart(2*e,"0")),p=(t,e)=>u(t,e).reverse(),f=t=>c(function(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}(t));function m(t,e,i){let s;if("string"==typeof e)try{s=c(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else{if(!a(e))throw new Error(`${t} must be hex string or Uint8Array`);s=Uint8Array.from(e)}const r=s.length;if("number"==typeof i&&r!==i)throw new Error(`${t} expected ${i} bytes, got ${r}`);return s}function g(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let i=0;return t.forEach(t=>{if(!a(t))throw new Error("Uint8Array expected");e.set(t,i),i+=t.length}),e}function y(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function v(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}const b=t=>(r<<BigInt(t-1))-s,w=t=>new Uint8Array(t),S=t=>Uint8Array.from(t);function k(t,e,i){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof i)throw new Error("hmacFn must be a function");let s=w(t),r=w(t),a=0;const n=()=>{s.fill(1),r.fill(0),a=0},o=(...t)=>i(r,s,...t),d=(t=w())=>{r=o(S([0]),t),s=o(),0!==t.length&&(r=o(S([1]),t),s=o())},c=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const i=[];for(;t<e;){s=o();const e=s.slice();i.push(e),t+=s.length}return g(...i)};return(t,e)=>{let i;for(n(),d(t);!(i=e(c()));)d();return n(),i}}const O={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function T(t,e,i={}){const s=(e,i,s)=>{const r=O[i];if("function"!=typeof r)throw new Error(`Invalid validator "${i}", expected function`);const a=t[e];if(!(s&&void 0===a||r(a,t)))throw new Error(`Invalid param ${String(e)}=${a} (${typeof a}), expected ${i}`)};for(const[t,i]of Object.entries(e))s(t,i,!1);for(const[t,e]of Object.entries(i))s(t,e,!0);return t}},205(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(7757),r=i(2079),a=i(5147),n=i(2931),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,createOrderWs:!1,editOrderWs:!1,fetchOpenOrdersWs:!1,fetchOrderWs:!1,cancelOrderWs:!1,cancelOrdersWs:!1,cancelAllOrdersWs:!1,watchBalance:!0,watchMyTrades:!0,watchOHLCV:!0,watchOHLCVForSymbols:!1,watchOrderBook:!0,watchOrderBookForSymbols:!0,watchOrders:!0,watchTicker:!0,watchTickers:!0,watchBidsAsks:!0,watchTrades:!0,watchTradesForSymbols:!0,watchPositions:!0},urls:{api:{ws:{public:"wss://ws.bitget.com/v2/ws/public",private:"wss://ws.bitget.com/v2/ws/private",utaPublic:"wss://ws.bitget.com/v3/ws/public",utaPrivate:"wss://ws.bitget.com/v3/ws/private"},demo:{public:"wss://wspap.bitget.com/v2/ws/public",private:"wss://wspap.bitget.com/v2/ws/private",utaPublic:"wss://wspap.bitget.com/v3/ws/public",utaPrivate:"wss://wspap.bitget.com/v3/ws/private"}}},options:{tradesLimit:1e3,OHLCVLimit:1e3,timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1H","4h":"4H","6h":"6H","12h":"12H","1d":"1D","1w":"1W"},watchOrderBook:{checksum:!0},watchTrades:{ignoreDuplicates:!0}},streaming:{ping:this.ping},exceptions:{ws:{exact:{30001:r.BadRequest,30002:r.AuthenticationError,30003:r.BadRequest,30004:r.AuthenticationError,30005:r.AuthenticationError,30006:r.RateLimitExceeded,30007:r.RateLimitExceeded,30011:r.AuthenticationError,30012:r.AuthenticationError,30013:r.AuthenticationError,30014:r.BadRequest,30015:r.AuthenticationError,30016:r.BadRequest},broad:{}}}})}getInstType(t,e=!1,i={}){let s,r;return void 0!==e&&e||([e,i]=this.handleOptionAndParams(i,"getInstType","uta",!1)),void 0===t?[s,i]=this.handleProductTypeAndParams(void 0,i):t.swap||t.future?[s,i]=this.handleProductTypeAndParams(t,i):s="SPOT",[r,i]=this.handleOptionAndParams(i,"getInstType","instType",s),s=r,e&&(s=s.toLowerCase()),[s,i]}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s="ticker:"+(t=i.symbol);let r,a;[a,e]=this.handleOptionAndParams(e,"watchTicker","uta",!1),[r,e]=this.getInstType(i,a,e);const n={instType:r},o=a?"symbol":"instId";return n[a?"topic":"channel"]="ticker",n[o]=i.id,await this.watchPublic(s,n,e)}async unWatchTicker(t,e={}){return await this.loadMarkets(),await this.unWatchChannel(t,"ticker","ticker",e)}async watchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=this.market(t[0]);let s,r;[r,e]=this.handleOptionAndParams(e,"watchTickers","uta",!1),[s,e]=this.getInstType(i,r,e);const a=[],n=[];for(let e=0;e<t.length;e++){const i=t[e],o=this.market(i),d={instType:s},c=r?"symbol":"instId";d[r?"topic":"channel"]="ticker",d[c]=o.id,a.push(d),n.push("ticker:"+i)}const o=await this.watchPublicMultiple(n,a,e);if(this.newUpdates){const t={};return t[o.symbol]=o,t}return this.filterByArray(this.tickers,"symbol",t)}handleTicker(t,e){this.handleBidAsk(t,e);const i=this.parseWsTicker(e),s=i.symbol;this.tickers[s]=i;const r="ticker:"+s;t.resolve(i,r)}parseWsTicker(t,e=void 0){const i=this.safeValue(t,"arg",{}),s=this.safeValue(t,"data",[]),r=this.safeValue(s,0,{}),n=this.safeInteger(t,"ts"),o=this.safeInteger(r,"ts",n),d="spot"===this.safeStringLower(i,"instType")?"spot":"contract",c=this.safeString(i,"symbol"),h=this.safeString(r,"instId",c);e=this.safeMarket(h,e,void 0,d);const l=this.safeString2(r,"lastPr","lastPrice"),u=this.safeString(r,"change24h",""),p=this.safeString(r,"price24hPcnt",a.Y.stringMul(u,"100"));return this.safeTicker({symbol:e.symbol,timestamp:o,datetime:this.iso8601(o),high:this.safeString2(r,"high24h","highPrice24h"),low:this.safeString2(r,"low24h","lowPrice24h"),bid:this.safeString2(r,"bidPr","bid1Price"),bidVolume:this.safeString2(r,"bidSz","bid1Size"),ask:this.safeString2(r,"askPr","ask1Price"),askVolume:this.safeString2(r,"askSz","ask1Size"),vwap:void 0,open:this.safeString2(r,"open24h","openPrice24h"),close:l,last:l,previousClose:void 0,change:void 0,percentage:p,average:void 0,baseVolume:this.safeString2(r,"baseVolume","volume24h"),quoteVolume:this.safeString2(r,"quoteVolume","turnover24h"),info:r},e)}async watchBidsAsks(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=this.market(t[0]);let s,r;[r,e]=this.handleOptionAndParams(e,"watchBidsAsks","uta",!1),[s,e]=this.getInstType(i,r,e);const a=[],n=[];for(let e=0;e<t.length;e++){const i=t[e],o=this.market(i),d={instType:s},c=r?"symbol":"instId";d[r?"topic":"channel"]="ticker",d[c]=o.id,a.push(d),n.push("bidask:"+i)}const o=await this.watchPublicMultiple(n,a,e);if(this.newUpdates){const t={};return t[o.symbol]=o,t}return this.filterByArray(this.bidsasks,"symbol",t)}handleBidAsk(t,e){const i=this.parseWsBidAsk(e),s=i.symbol;this.bidsasks[s]=i;const r="bidask:"+s;t.resolve(i,r)}parseWsBidAsk(t,e=void 0){const i=this.safeValue(t,"arg",{}),s=this.safeValue(t,"data",[]),r=this.safeValue(s,0,{}),a=this.safeInteger(t,"ts"),n=this.safeInteger(r,"ts",a),o="spot"===this.safeStringLower(i,"instType")?"spot":"contract",d=this.safeString(i,"symbol"),c=this.safeString(r,"instId",d);return e=this.safeMarket(c,e,void 0,o),this.safeTicker({symbol:e.symbol,timestamp:n,datetime:this.iso8601(n),ask:this.safeString2(r,"askPr","ask1Price"),askVolume:this.safeString2(r,"askSz","ask1Size"),bid:this.safeString2(r,"bidPr","bid1Price"),bidVolume:this.safeString2(r,"bidSz","bid1Size"),info:r},e)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);t=a.symbol;const n=this.safeValue(this.options,"timeframes"),o=this.safeString(n,e);let d,c,h;[h,r]=this.handleOptionAndParams(r,"watchOHLCV","uta",!1),[c,r]=this.getInstType(a,h,r);const l={instType:c};h?(l.topic="kline",l.symbol=a.id,l.interval=o,r=this.extend(r,{uta:!0}),d="kline:"+t):(l.channel="candle"+o,l.instId=a.id,d="candles:"+e+":"+t);const u=await this.watchPublic(d,l,r);return this.newUpdates&&(s=u.getLimit(t,s)),this.filterBySinceLimit(u,i,s,0,!0)}async unWatchOHLCV(t,e="1m",i={}){await this.loadMarkets();const s=this.safeDict(this.options,"timeframes"),r=this.safeString(s,e);let a,n,o,d,c;void 0!==t&&(n=this.market(t)),[c,i]=this.handleOptionAndParams(i,"unWatchOHLCV","uta",!1),[o,i]=this.getInstType(n,c,i);const h={instType:o};return c?(a="kline",h.topic=a,h.symbol=n.id,h.interval=r,(i=this.extend(i,{uta:!0})).interval=r,d=a+t):(a="candle"+r,h.channel=a,h.instId=n.id,d="candles:"+r),await this.unWatchChannel(t,a,d,i)}handleOHLCV(t,e){const i=this.safeValue(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",r=this.safeString2(i,"instId","symbol"),a=this.safeMarket(r,void 0,void 0,s),o=a.symbol;this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});const d=this.safeString2(i,"channel","topic");let c,h=this.safeString(i,"interval");void 0===h?(c=!1,h=d.replace("candle","")):c=!0;const l=this.safeValue(this.options,"timeframes"),u=this.findTimeframe(h,l);let p=this.safeValue(this.ohlcvs[o],u);if(void 0===p){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);p=new n.TG(t),this.ohlcvs[o][u]=p}const f=this.safeValue(e,"data",[]);for(let t=0;t<f.length;t++){const e=this.parseWsOHLCV(f[t],a);p.append(e)}let m;m=c?"kline:"+o:"candles:"+u+":"+o,t.resolve(p,m)}parseWsOHLCV(t,e=void 0){const i=e.inverse?6:5;return[this.safeInteger2(t,"start",0),this.safeNumber2(t,"open",1),this.safeNumber2(t,"high",2),this.safeNumber2(t,"low",3),this.safeNumber2(t,"close",4),this.safeNumber2(t,"volume",i)]}async watchOrderBook(t,e=void 0,i={}){return await this.watchOrderBookForSymbols([t],e,i)}async unWatchOrderBook(t,e={}){await this.loadMarkets();let i="books";const s=this.safeInteger(e,"limit");return 1!==s&&5!==s&&15!==s&&50!==s||(e=this.omit(e,"limit"),i+=s.toString()),await this.unWatchChannel(t,i,"orderbook",e)}async unWatchChannel(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a="unsubscribe:"+i+":"+r.symbol;let n,o;[o,s]=this.handleOptionAndParams(s,"unWatchChannel","uta",!1),[n,s]=this.getInstType(r,o,s);const d={instType:n};return o?(d.topic=e,d.symbol=r.id,d.interval=this.safeString(s,"interval","1m"),s=this.extend(s,{uta:!0}),s=this.omit(s,"interval")):(d.channel=e,d.instId=r.id),await this.unWatchPublic(a,d,s)}async watchOrderBookForSymbols(t,e=void 0,i={}){await this.loadMarkets(),t=this.marketSymbols(t);let s="books",r=!0;1!==e&&5!==e&&15!==e&&50!==e||(s+=e.toString(),r=!1);const a=[],n=[];let o;[o,i]=this.handleOptionAndParams(i,"watchOrderBookForSymbols","uta",!1);for(let e=0;e<t.length;e++){const r=t[e],d=this.market(r);let c;[c,i]=this.getInstType(d,o,i);const h={instType:c},l=o?"symbol":"instId";h[o?"topic":"channel"]=s,h[l]=d.id,a.push(h),n.push("orderbook:"+r)}o&&(i.uta=!0);const d=await this.watchPublicMultiple(n,a,i);return r?d.limit():d}handleOrderBook(t,e){const i=this.safeValue(e,"arg"),s=this.safeString2(i,"channel","topic"),r="spot"===this.safeStringLower(i,"instType")?"spot":"contract",a=this.safeString2(i,"instId","symbol"),n=this.safeMarket(a,void 0,void 0,r).symbol,o="orderbook:"+n,d=this.safeValue(e,"data"),c=this.safeValue(d,0),h=this.safeInteger(c,"ts");if("books"===s){if(!(n in this.orderbooks)){const t=this.countedOrderBook({});t.symbol=n,this.orderbooks[n]=t}const i=this.orderbooks[n],s=this.safeList2(c,"asks","a",[]),r=this.safeList2(c,"bids","b",[]);this.handleDeltas(i.asks,s),this.handleDeltas(i.bids,r),i.timestamp=h,i.datetime=this.iso8601(h);const a=this.handleOption("watchOrderBook","checksum",!0);if(!("snapshot"===this.safeString(e,"action"))&&a){const e=i.asks,s=i.bids,r=e.length,a=s.length,d=[];for(let t=0;t<25;t++)t<a&&(d.push(s[t][2][0]),d.push(s[t][2][1])),t<r&&(d.push(e[t][2][0]),d.push(e[t][2][1]));const h=d.join(":");if(this.crc32(h,!0)!==this.safeInteger(c,"checksum"))return void this.spawn(this.handleCheckSumError,t,n,o)}}else{const t=this.orderBook({}),e=this.parseOrderBook(c,n,h);t.reset(e),this.orderbooks[n]=t}t.resolve(this.orderbooks[n],o)}async handleCheckSumError(t,e,i){await this.unWatchOrderBook(e);const s=new r.ChecksumError(this.id+" "+this.orderbookChecksumMessage(e));t.reject(s,i)}handleDelta(t,e){const i=this.parseBidAsk(e,0,1);i.push(e),t.storeArray(i)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}async watchTrades(t,e=void 0,i=void 0,s={}){return await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){if(0===t.length)throw new r.ArgumentsRequired(this.id+" watchTradesForSymbols() requires a non-empty array of symbols");let a;await this.loadMarkets(),t=this.marketSymbols(t),[a,s]=this.handleOptionAndParams(s,"watchTradesForSymbols","uta",!1);const n=[],o=[];for(let e=0;e<t.length;e++){const i=t[e],r=this.market(i);let d;[d,s]=this.getInstType(r,a,s);const c={instType:d},h=a?"symbol":"instId";c[a?"topic":"channel"]=a?"publicTrade":"trade",c[h]=r.id,n.push(c),o.push("trade:"+i)}a&&(s=this.extend(s,{uta:!0}));const d=await this.watchPublicMultiple(o,n,s);if(this.newUpdates){const t=this.safeValue(d,0),e=this.safeString(t,"symbol");i=d.getLimit(e,i)}const c=this.filterBySinceLimit(d,e,i,"timestamp",!0);if(this.handleOption("watchTrades","ignoreDuplicates",!0)){let t=this.removeRepeatedTradesFromArray(c);return t=this.sortBy(t,"timestamp"),t}return c}async unWatchTrades(t,e={}){let i;[i,e]=this.handleOptionAndParams(e,"unWatchTrades","uta",!1);const s=i?"publicTrade":"trade";return await this.unWatchChannel(t,s,"trade",e)}handleTrades(t,e){const i=this.safeValue(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",r=this.safeString2(i,"instId","symbol"),a=this.safeMarket(r,void 0,void 0,s),o=a.symbol;let d=this.safeValue(this.trades,o);if(void 0===d){const t=this.safeInteger(this.options,"tradesLimit",1e3);d=new n.I3(t),this.trades[o]=d}const c=this.safeList(e,"data",[]),h=c.length;for(let t=0;t<h;t++){const e=c[h-t-1],i=this.parseWsTrade(e,a);d.append(i)}const l="trade:"+o;t.resolve(d,l)}parseWsTrade(t,e=void 0){const i=this.safeString2(t,"symbol","instId"),s=this.safeString(t,"posMode"),r=this.safeString(t,"category");let n;n=void 0!==r?"SPOT"!==r?"contract":"spot":void 0!==s?"contract":"spot",void 0===e&&(e=this.safeMarket(i,void 0,void 0,n));const o=this.safeIntegerN(t,["uTime","cTime","ts","T","execTime"]),d=this.safeList(t,"feeDetail",[]),c=this.safeDict(d,0);let h;if(void 0!==c){const t=this.safeString(c,"feeCoin"),e=this.safeCurrencyCode(t);h={cost:a.Y.stringAbs(this.safeString2(c,"totalFee","fee")),currency:e}}return this.safeTrade({info:t,id:this.safeStringN(t,["tradeId","i","execId"]),order:this.safeString2(t,"orderId","L"),timestamp:o,datetime:this.iso8601(o),symbol:e.symbol,type:this.safeString(t,"orderType"),side:this.safeString2(t,"side","S"),takerOrMaker:this.safeString(t,"tradeScope"),price:this.safeStringN(t,["priceAvg","price","execPrice","P"]),amount:this.safeStringN(t,["size","baseVolume","execQty","v"]),cost:this.safeStringN(t,["amount","quoteVolume","execValue"]),fee:h},e)}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();let a="";let n,o="USDT-FUTURES";[n,s]=this.handleOptionAndParams(s,"watchPositions","uta",!1),t=this.marketSymbols(t),this.isEmpty(t)||(r=this.getMarketFromSymbols(t),[o,s]=this.getInstType(r,n,s)),n&&(o="UTA"),a=o+":positions"+a;const d={instType:o},c=n?"position":"positions";d[n?"topic":"channel"]=c,n?s=this.extend(s,{uta:!0}):d.instId="default";const h=await this.watchPrivate(a,"positions",d,s);return this.newUpdates?h:this.filterBySymbolsSinceLimit(h,t,e,i,!0)}handlePositions(t,e){const i=this.safeDict(e,"arg",{}),s=this.safeString(i,"instType","");void 0===this.positions&&(this.positions={});const r=this.safeString(e,"action");s in this.positions&&"snapshot"!==r||(this.positions[s]=new n.Hk);const a=this.positions[s],o=this.safeList(e,"data",[]),d=[];for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString2(e,"instId","symbol"),s=this.safeMarket(i,void 0,void 0,"contract"),r=this.parseWsPosition(e,s);d.push(r),a.append(r)}const c=this.findMessageHashes(t,s+":positions::");for(let e=0;e<c.length;e++){const i=c[e],s=i.split("::")[1].split(","),r=this.filterByArray(d,"symbol",s,!1);this.isEmpty(r)||t.resolve(r,i)}t.resolve(d,s+":positions")}parseWsPosition(t,e=void 0){const i=this.safeString2(t,"instId","symbol"),s=this.safeString(t,"marginMode"),r=this.getSupportedMapping(s,{crossed:"cross",isolated:"isolated"}),n="hedge_mode"===this.safeString2(t,"posMode","holdMode"),o=this.safeIntegerN(t,["updatedTime","uTime","cTime","createdTime"]),d=this.safeString2(t,"unrealizedPLR","profitRate"),c=a.Y.stringMul(d,"100");let h;return void 0!==e&&(h=e.contractSize),this.safePosition({info:t,id:this.safeString(t,"posId"),symbol:this.safeSymbol(i,e,void 0,"contract"),notional:void 0,marginMode:r,liquidationPrice:this.safeNumber2(t,"liquidationPrice","liqPrice"),entryPrice:this.safeNumber2(t,"openPriceAvg","avgPrice"),unrealizedPnl:this.safeNumber2(t,"unrealizedPL","unrealisedPnl"),percentage:this.parseNumber(c),contracts:this.safeNumber2(t,"total","size"),contractSize:h,markPrice:this.safeNumber(t,"markPrice"),side:this.safeString2(t,"holdSide","posSide"),hedged:n,timestamp:o,datetime:this.iso8601(o),maintenanceMargin:void 0,maintenanceMarginPercentage:this.safeNumber2(t,"keepMarginRate","mmr"),collateral:this.safeNumber(t,"available"),initialMargin:this.safeNumber(t,"marginSize"),initialMarginPercentage:void 0,leverage:this.safeNumber(t,"leverage"),marginRatio:this.safeNumber(t,"marginRate")})}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){let r,a,n;await this.loadMarkets(),[n,s]=this.isTriggerOrder(s);let o,d=n?"triggerOrder":"order",c="order:trades";void 0!==t&&(r=this.market(t),t=r.symbol,a=r.id,d=d+":"+t),[o,s]=this.handleOptionAndParams(s,"watchOrders","uta",!1);const h=this.safeString(s,"productType");let l,u,p;[l,s]=this.handleMarketTypeAndParams("watchOrders",r,s),[u,s]=this.handleSubTypeAndParams("watchOrders",r,s,"linear"),"spot"!==l&&"margin"!==l||void 0!==t||(a="default"),void 0===h&&"spot"!==l&&void 0===t?d=d+":"+u:"USDT-FUTURES"===h?d+=":linear":"COIN-FUTURES"===h?d+=":inverse":"USDC-FUTURES"===h&&(d+=":usdcfutures"),void 0===r&&"spot"===l?p="SPOT":[p,s]=this.getInstType(r,o,s),"spot"===l&&void 0!==t&&(c=c+":"+t),n&&(c+=":stop");const f="spot"===l||"margin"===l?a:"default";let m,g=n?"orders-algo":"orders";[m,s]=this.handleMarginModeAndParams("watchOrders",s),void 0!==m&&(p="MARGIN",d=d+":"+m,g="isolated"===m?"orders-isolated":"orders-crossed"),o&&(p="UTA",g="order"),c=c+":"+p;const y={instType:p};y[o?"topic":"channel"]=g,o?s=this.extend(s,{uta:!0}):y.instId=f;const v=await this.watchPrivate(d,c,y,s);return this.newUpdates&&(i=v.getLimit(t,i)),this.filterBySymbolSinceLimit(v,t,e,i,!0)}handleOrder(t,e){const i=this.safeDict(e,"arg",{}),s=this.safeString2(i,"channel","topic"),r=this.safeStringLower(i,"instType"),a=this.safeString(i,"instId");let o;o="spot"===r||"margin"===r?"spot":"contract";const d=this.safeList(e,"data",[]),c=this.safeDict(d,0,{}),h=this.safeStringLower(c,"category",r),l="usdt-futures"===h,u="coin-futures"===h,p="usdc-futures"===h;if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new n.Pt(t),this.triggerOrders=new n.Pt(t)}const f="orders-algo"===s||"ordersAlgo"===s,m=f?this.triggerOrders:this.orders,g=f?"triggerOrder":"order",y={};for(let t=0;t<d.length;t++){const e=d[t],i=this.safeString2(e,"instId","symbol",a),s=this.safeMarket(i,void 0,void 0,o),r=this.parseWsOrder(e,s);m.append(r);y[r.symbol]=!0}const v=Object.keys(y);for(let e=0;e<v.length;e++){let i=g+":"+v[e];"orders-crossed"===s?i+=":cross":"orders-isolated"===s&&(i+=":isolated"),t.resolve(m,i)}t.resolve(m,g),l&&t.resolve(m,"order:linear"),u&&t.resolve(m,"order:inverse"),p&&t.resolve(m,"order:usdcfutures")}parseWsOrder(t,e=void 0){let i=!("posMode"in t),s="loanType"in t;const r=this.safeStringLower(t,"category");"spot"===r&&(i=!0),"margin"===r&&(s=!0);const n=this.safeString2(t,"instId","symbol");e=this.safeMarket(n,e);const o=this.safeInteger2(t,"cTime","createdTime"),d=e.symbol,c=this.safeString2(t,"status","orderStatus"),h=this.safeValue(t,"feeDetail",[]),l=this.safeValue(h,0),u=this.safeString(l,"fee");let p;if(void 0!==u){const t=this.safeString(l,"feeCoin");p={cost:this.parseNumber(a.Y.stringAbs(u)),currency:this.safeCurrencyCode(t)}}const f=this.safeNumber(t,"triggerPrice"),m=void 0!==f;let g;m?i&&m&&(g=this.safeNumber(t,"executePrice")):g=this.safeNumber(t,"price");const y=this.omitZero(this.safeStringLowerN(t,["priceAvg","fillPrice","avgPrice"])),v=this.safeString(t,"side"),b=this.safeString(t,"orderType"),w=this.omitZero(this.safeString2(t,"accBaseVolume","cumExecQty")),S=this.omitZero(this.safeString2(t,"newSize","cumExecValue")),k="market"===b,O="buy"===v;let T,P,_,A,I=this.safeString2(t,"accBaseVolume","cumExecQty");if(i)if(s)T=this.safeString2(t,"baseSize","qty"),I=this.safeString2(t,"baseVolume","cumExecQty"),_=this.safeString2(t,"fillTotalAmount","cumExecValue");else{const e=this.safeString(t,"baseVolume");P=void 0!==e?e:I,k?O?(T=w,_=S):T=S:T=this.safeString2(t,"newSize","qty")}else P=this.safeString2(t,"baseVolume","cumExecQty"),T=this.safeString2(t,"size","qty"),_=this.safeString2(t,"fillNotionalUsd","cumExecValue");return A=a.Y.stringSub(T,I),this.safeOrder({info:t,symbol:d,id:this.safeString(t,"orderId"),clientOrderId:this.safeString(t,"clientOid"),timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:this.safeInteger2(t,"uTime","updatedTime"),type:b,timeInForce:this.safeStringUpper2(t,"force","timeInForce"),postOnly:void 0,side:v,price:g,triggerPrice:f,amount:T,cost:_,average:y,filled:P,remaining:A,status:this.parseWsOrderStatus(c),fee:p,trades:void 0},e)}parseWsOrderStatus(t){return this.safeString({live:"open",partially_filled:"open",filled:"closed",cancelled:"canceled",not_trigger:"open"},t,t)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();let a,n,o,d="myTrades";void 0!==t&&(r=this.market(t),d=d+":"+(t=r.symbol)),[a,s]=this.handleMarketTypeAndParams("watchMyTrades",r,s),[o,s]=this.handleOptionAndParams(s,"watchMyTrades","uta",!1),void 0===r&&"spot"===a?n="SPOT":[n,s]=this.getInstType(r,o,s),o&&(n="UTA");const c="fill:"+n,h={instType:n};h[o?"topic":"channel"]="fill",o?s=this.extend(s,{uta:!0}):h.instId="default";const l=await this.watchPrivate(d,c,h,s);return this.newUpdates&&(i=l.getLimit(t,i)),this.filterBySymbolSinceLimit(l,t,e,i,!0)}handleMyTrades(t,e){if(void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new n.I3(t)}const i=this.myTrades,s=this.safeList(e,"data",[]),r=s.length;for(let e=0;e<r;e++){const r=s[e],a=this.parseWsTrade(r);i.append(a);const n="myTrades:"+a.symbol;t.resolve(i,n)}t.resolve(i,"myTrades")}async watchBalance(t={}){let e,i,s,r;[e,t]=this.handleOptionAndParams(t,"watchBalance","uta",!1),[i,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t),[s,t]=this.handleMarginModeAndParams("watchBalance",t);let a="account";"swap"===i||"future"===i?r="USDT-FUTURES":void 0!==s?(r="MARGIN",e||(a="isolated"===s?"account-isolated":"account-crossed")):e||(r="SPOT"),[r,t]=this.handleOptionAndParams(t,"watchBalance","instType",r),e&&(r="UTA");const n={instType:r};n[e?"topic":"channel"]=a,e?t=this.extend(t,{uta:!0}):n.coin="default";const o="balance:"+r.toLowerCase();return await this.watchPrivate(o,o,n,t)}handleBalance(t,e){const i=this.safeDict(e,"arg",{}),s=this.safeStringLower(i,"instType"),r=this.safeValue(e,"data",[]);for(let t=0;t<r.length;t++){const e=r[t];if("uta"===s){const t=this.safeList(e,"coin",[]);for(let e=0;e<t.length;e++){const i=t[e],s=this.safeString(i,"coin"),r=this.safeCurrencyCode(s),n=r in this.balance?this.balance[r]:this.account(),o=this.safeString(i,"borrow"),d=this.safeString(i,"debts");void 0===o&&void 0===d||(n.debt=a.Y.stringAdd(o,d)),n.free=this.safeString(i,"available"),n.used=this.safeString(i,"locked"),n.total=this.safeString(i,"balance"),this.balance[r]=n}}else{const t=this.safeString2(e,"coin","marginCoin"),i=this.safeCurrencyCode(t),s=i in this.balance?this.balance[i]:this.account(),r=this.safeString(e,"borrow");if(void 0!==r){const t=this.safeString(e,"interest");s.debt=a.Y.stringAdd(r,t)}const n="maxTransferOut"in e?"maxTransferOut":"available";s.free=this.safeString(e,n),s.total=this.safeString(e,"equity"),s.used=this.safeString(e,"frozen"),this.balance[i]=s}}this.balance=this.safeBalance(this.balance);const n="balance:"+s;t.resolve(this.balance,n)}async watchPublic(t,e,i={}){let s,r;[s,i]=this.handleOptionAndParams(i,"watchPublic","uta",!1),r=s?this.urls.api.ws.utaPublic:this.urls.api.ws.public;if(this.safeBool2(this.options,"sandboxMode","sandbox",!1)){const t=this.safeString(e,"instType");"SCOIN-FUTURES"!==t&&"SUSDT-FUTURES"!==t&&"SUSDC-FUTURES"!==t&&(r=s?this.urls.api.demo.utaPublic:this.urls.api.demo.public)}const a={op:"subscribe",args:[e]},n=this.extend(a,i);return await this.watch(r,t,n,t)}async unWatchPublic(t,e,i={}){let s,r;[s,i]=this.handleOptionAndParams(i,"unWatchPublic","uta",!1),r=s?this.urls.api.ws.utaPublic:this.urls.api.ws.public;if(this.safeBool2(this.options,"sandboxMode","sandbox",!1)){const t=this.safeString(e,"instType");"SCOIN-FUTURES"!==t&&"SUSDT-FUTURES"!==t&&"SUSDC-FUTURES"!==t&&(r=s?this.urls.api.demo.utaPublic:this.urls.api.demo.public)}const a={op:"unsubscribe",args:[e]},n=this.extend(a,i);return await this.watch(r,t,n,t)}async watchPublicMultiple(t,e,i={}){let s,r;[s,i]=this.handleOptionAndParams(i,"watchPublicMultiple","uta",!1),r=s?this.urls.api.ws.utaPublic:this.urls.api.ws.public;if(this.safeBool2(this.options,"sandboxMode","sandbox",!1)){const t=this.safeDict(e,0,{}),i=this.safeString(t,"instType");"SCOIN-FUTURES"!==i&&"SUSDT-FUTURES"!==i&&"SUSDC-FUTURES"!==i&&(r=s?this.urls.api.demo.utaPublic:this.urls.api.demo.public)}const a={op:"subscribe",args:e},n=this.extend(a,i);return await this.watchMultiple(r,t,n,t)}async authenticate(t={}){this.checkRequiredCredentials();const e=this.safeString(t,"url"),i=this.client(e),s="authenticated",r=i.reusableFuture(s);if(void 0===this.safeValue(i.subscriptions,s)){const i=this.seconds().toString(),r=i+"GET/user/verify",a=this.hmac(this.encode(r),this.encode(this.secret),o.s,"base64"),n={op:"login",args:[{apiKey:this.apiKey,passphrase:this.password,timestamp:i,sign:a}]},d=this.extend(n,t);this.watch(e,s,d,s)}return await r}async watchPrivate(t,e,i,s={}){let r,a;[r,s]=this.handleOptionAndParams(s,"watchPrivate","uta",!1),a=r?this.urls.api.ws.utaPrivate:this.urls.api.ws.private;if(this.safeBool2(this.options,"sandboxMode","sandbox",!1)){const t=this.safeString(i,"instType");"SCOIN-FUTURES"!==t&&"SUSDT-FUTURES"!==t&&"SUSDC-FUTURES"!==t&&(a=r?this.urls.api.demo.utaPrivate:this.urls.api.demo.private)}await this.authenticate({url:a});const n={op:"subscribe",args:[i]},o=this.extend(n,s);return await this.watch(a,t,o,e)}handleAuthenticate(t,e){this.safeValue(t.futures,"authenticated").resolve(!0)}handleErrorMessage(t,e){const i=this.safeString(e,"event");try{if("error"===i){const t=this.safeString(e,"code"),i=this.id+" "+this.json(e);this.throwExactlyMatchedException(this.exceptions.ws.exact,t,i);const s=this.safeString(e,"msg","");throw this.throwBroadlyMatchedException(this.exceptions.ws.broad,s,i),new r.ExchangeError(i)}return!1}catch(e){if(e instanceof r.AuthenticationError){const i="authenticated";t.reject(e,i),i in t.subscriptions&&delete t.subscriptions[i]}else t.reject(e);return!0}}handleMessage(t,e){if(this.handleErrorMessage(t,e))return;if("pong"===this.safeString(e,"message"))return void this.handlePong(t,e);if("pong"===e)return void this.handlePong(t,e);const i=this.safeString(e,"event");if("login"===i)return void this.handleAuthenticate(t,e);if("subscribe"===i)return void this.handleSubscriptionStatus(t,e);if("unsubscribe"===i)return void this.handleUnSubscriptionStatus(t,e);const s={ticker:this.handleTicker,trade:this.handleTrades,publicTrade:this.handleTrades,fill:this.handleMyTrades,order:this.handleOrder,orders:this.handleOrder,ordersAlgo:this.handleOrder,"orders-algo":this.handleOrder,"orders-crossed":this.handleOrder,"orders-isolated":this.handleOrder,account:this.handleBalance,position:this.handlePositions,positions:this.handlePositions,"account-isolated":this.handleBalance,"account-crossed":this.handleBalance,kline:this.handleOHLCV},r=this.safeValue(e,"arg",{}),a=this.safeValue2(r,"channel","topic",""),n=this.safeValue(s,a);void 0!==n&&n.call(this,t,e),a.indexOf("candle")>=0&&this.handleOHLCV(t,e),a.indexOf("books")>=0&&this.handleOrderBook(t,e)}ping(t){return"ping"}handlePong(t,e){return t.lastPong=this.milliseconds(),e}handleSubscriptionStatus(t,e){return e}handleOrderBookUnSubscription(t,e){const i=this.safeDict(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",a=this.safeString(i,"instId"),n=this.safeMarket(a,void 0,void 0,s),o=n.symbol,d="unsubscribe:orderbook:"+n.symbol,c="orderbook:"+o;o in this.orderbooks&&delete this.orderbooks[o],c in t.subscriptions&&delete t.subscriptions[c],d in t.subscriptions&&delete t.subscriptions[d];const h=new r.UnsubscribeError(this.id+" orderbook "+o);c in t.futures&&t.reject(h,c),t.resolve(!0,d)}handleTradesUnSubscription(t,e){const i=this.safeDict(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",a=this.safeString2(i,"instId","symbol"),n=this.safeMarket(a,void 0,void 0,s),o=n.symbol,d="unsubscribe:trade:"+n.symbol,c="trade:"+o;o in this.trades&&delete this.trades[o],c in t.subscriptions&&delete t.subscriptions[c],d in t.subscriptions&&delete t.subscriptions[d];const h=new r.UnsubscribeError(this.id+" trades "+o);c in t.futures&&t.reject(h,c),t.resolve(!0,d)}handleTickerUnSubscription(t,e){const i=this.safeDict(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",a=this.safeString2(i,"instId","symbol"),n=this.safeMarket(a,void 0,void 0,s),o=n.symbol,d="unsubscribe:ticker:"+n.symbol,c="ticker:"+o;o in this.tickers&&delete this.tickers[o],c in t.subscriptions&&delete t.subscriptions[c],d in t.subscriptions&&delete t.subscriptions[d];const h=new r.UnsubscribeError(this.id+" ticker "+o);c in t.futures&&t.reject(h,c),t.resolve(!0,d)}handleOHLCVUnSubscription(t,e){const i=this.safeDict(e,"arg",{}),s="spot"===this.safeStringLower(i,"instType")?"spot":"contract",r=this.safeString2(i,"instId","symbol"),a=this.safeString2(i,"channel","topic");let n,o=this.safeString(i,"interval");void 0===o?(n=!1,o=a.replace("candle","")):n=!0;const d=this.safeValue(this.options,"timeframes"),c=this.findTimeframe(o,d),h=this.safeMarket(r,void 0,void 0,s).symbol;let l,u;n?(l="unsubscribe:kline:"+h,u="kline:"+h):(l="unsubscribe:candles:"+c+":"+h,u="candles:"+c+":"+h),h in this.ohlcvs&&c in this.ohlcvs[h]&&delete this.ohlcvs[h][c],this.cleanUnsubscription(t,u,l)}handleUnSubscriptionStatus(t,e){let i=this.safeList(e,"args");void 0===i&&(i=[this.safeDict(e,"arg",{})]);for(let s=0;s<i.length;s++){const r=i[s],a=this.safeString2(r,"channel","topic");"books"===a?this.handleOrderBookUnSubscription(t,e):"trade"===a||"publicTrade"===a?this.handleTradesUnSubscription(t,e):"ticker"===a?this.handleTickerUnSubscription(t,e):(a.startsWith("candle")||a.startsWith("kline"))&&this.handleOHLCVUnSubscription(t,e)}return e}}},230(t,e,i){"use strict";i.d(e,{D:()=>a});var s=i(9024),r=i(1094);class a extends r.Vw{constructor(t,e,i,s){super(),this.blockLen=t,this.outputLen=e,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,r.O8)(this.buffer)}update(t){s.Ay.exists(this);const{view:e,buffer:i,blockLen:a}=this,n=(t=(0,r.ZJ)(t)).length;for(let s=0;s<n;){const o=Math.min(a-this.pos,n-s);if(o===a){const e=(0,r.O8)(t);for(;a<=n-s;s+=a)this.process(e,s);continue}i.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===a&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){s.Ay.exists(this),s.Ay.output(t,this),this.finished=!0;const{buffer:e,view:i,blockLen:a,isLE:n}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>a-o&&(this.process(i,0),o=0);for(let t=o;t<a;t++)e[t]=0;!function(t,e,i,s){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,i,s);const r=BigInt(32),a=BigInt(4294967295),n=Number(i>>r&a),o=Number(i&a),d=s?4:0,c=s?0:4;t.setUint32(e+d,n,s),t.setUint32(e+c,o,s)}(i,a-8,BigInt(8*this.length),n),this.process(i,0);const d=(0,r.O8)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,l=this.get();if(h>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)d.setUint32(4*t,l[t],n)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const i=t.slice(0,e);return this.destroy(),i}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:e,buffer:i,length:s,finished:r,destroyed:a,pos:n}=this;return t.length=s,t.pos=n,t.finished=r,t.destroyed=a,s%e&&t.buffer.set(i),t}}},232(t,e,i){"use strict";i.d(e,{KX:()=>a}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var s=i(1291),r=i.n(s);const a={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){e.uint32(10).fork();for(const i of t.selectedAuthenticators)e.uint64(i);return e.ldelim(),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={selectedAuthenticators:[]};for(;i.pos<s;){const t=i.uint32();if(t>>>3==1)if(2==(7&t)){const t=i.uint32()+i.pos;for(;i.pos<t;)r.selectedAuthenticators.push(i.uint64())}else r.selectedAuthenticators.push(i.uint64());else i.skipType(7&t)}return r},fromPartial(t){const e={selectedAuthenticators:[]};return e.selectedAuthenticators=t.selectedAuthenticators?.map(t=>r().fromValue(t))||[],e}}},274(t,e,i){"use strict";i.d(e,{Ns:()=>o});var s=i(178),r=i(4921),a=i(3283);const n=(1n<<512n)-1n;class o{constructor(...t){if("object"==typeof t[0]&&1===t.length&&"limb0"in t[0]&&"limb1"in t[0]&&"limb2"in t[0]&&"limb3"in t[0]){const e=o.validateProps(t[0].limb0,t[0].limb1,t[0].limb2,t[0].limb3);this.limb0=e.limb0,this.limb1=e.limb1,this.limb2=e.limb2,this.limb3=e.limb3}else if(1===t.length){const e=o.validate(t[0]);this.limb0=e&a.wO,this.limb1=(e&a.wO<<128n)>>128n,this.limb2=(e&a.wO<<256n)>>256n,this.limb3=e>>384n}else{if(4!==t.length)throw Error("Incorrect Uint512 constructor parameters");{const e=o.validateProps(t[0],t[1],t[2],t[3]);this.limb0=e.limb0,this.limb1=e.limb1,this.limb2=e.limb2,this.limb3=e.limb3}}}static validate(t){const e=BigInt(t);if(e<0n)throw Error("bigNumberish is smaller than UINT_512_MIN.");if(e>n)throw Error("bigNumberish is bigger than UINT_512_MAX.");return e}static validateProps(t,e,i,s){const r=BigInt(t),n=BigInt(e),o=BigInt(i),d=BigInt(s);return[r,n,o,d].forEach((t,e)=>{if(t<0n||t>a.wO)throw Error(`limb${e} is not in the range of a u128 number`)}),{limb0:r,limb1:n,limb2:o,limb3:d}}static is(t){try{o.validate(t)}catch(t){return!1}return!0}static isAbiType(t){return t===o.abiSelector}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:(0,s.VO)(this.limb0.toString(16)),limb1:(0,s.VO)(this.limb1.toString(16)),limb2:(0,s.VO)(this.limb2.toString(16)),limb3:(0,s.VO)(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[(0,r.e)(this.limb0),(0,r.e)(this.limb1),(0,r.e)(this.limb2),(0,r.e)(this.limb3)]}}o.abiSelector="core::integer::u512"},300(t,e,i){"use strict";i.d(e,{J:()=>o});var s=i(3867),r=i(9654),a=i(9073),n=i(4176);class o extends n.Ue{constructor(t,e){let i="bytes"+String(t);super(i,i,e,!1),(0,r.n)(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let i=(0,s.Lm)(a.V.dereference(e,this.type));return i.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(i)}decode(t){return(0,s.c$)(t.readBytes(this.size))}}},335(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},447(t,e,i){"use strict";i.d(e,{D:()=>c});var s=i(9898);let r,a,n=null;if(null==n){let t;if(n=[],a=0,"undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const e=new Uint32Array(256);for(window.crypto.getRandomValues(e),t=0;t<e.length;++t)n[a++]=255&e[t]}var o=0;const e=function(t){if((o=o||0)>=256||a>=s.me)window.removeEventListener?window.removeEventListener("mousemove",e,!1):window.detachEvent&&window.detachEvent("onmousemove",e);else try{const e=t.x+t.y;n[a++]=255&e,o+=1}catch(t){}};"undefined"!=typeof window&&(window.addEventListener?window.addEventListener("mousemove",e,!1):window.attachEvent&&window.attachEvent("onmousemove",e))}function d(){if(null==r){for(r=(0,s.YS)();a<s.me;){const t=Math.floor(65536*Math.random());n[a++]=255&t}for(r.init(n),a=0;a<n.length;++a)n[a]=0;a=0}return r.next()}class c{nextBytes(t){for(let e=0;e<t.length;++e)t[e]=d()}}},497(t,e,i){"use strict";i.d(e,{s:()=>r}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());function s(){return{extraBitsStored:0,elems:new Uint8Array}}const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.extraBitsStored&&e.uint32(8).uint32(t.extraBitsStored),0!==t.elems.length&&e.uint32(18).bytes(t.elems),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=s();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.extraBitsStored=i.uint32();break;case 2:a.elems=i.bytes();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=s();return e.extraBitsStored=t.extraBitsStored??0,e.elems=t.elems??new Uint8Array,e}}},568(t,e,i){"use strict";i.d(e,{V:()=>r});var s=i(5307);class r{constructor(t){this.abi=t}methodInputsLength(t){return t.inputs.reduce((t,e)=>(0,s.ct)(e.name)?t:t+1,0)}getMethod(t){return this.abi.find(e=>e.name===t)}getLegacyFormat(){return this.abi}}},591(t,e,i){"use strict";i.d(e,{CO:()=>o,k:()=>n});var s=i(5307),r=i(568),a=i(7799);function n(t){const e=function(t){return t.find(t=>"interface"===t.type)?2:(0,s.cl)(t)?1:0}(t);if(0===e||1===e)return new r.V(t);if(2===e)return new a.O(t);throw Error(`Unsupported ABI version ${e}`)}function o(t,e,i){return"constructor"===t&&!i&&!e.length}},700(t,e,i){"use strict";i.d(e,{D4:()=>o,Pe:()=>l,gd:()=>h,h1:()=>n,kg:()=>u,lF:()=>d,oE:()=>c});var s=Object.prototype.hasOwnProperty,r=Array.isArray,a=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),n=function t(e,i,a){if(!i)return e;if("object"!=typeof i){if(r(e))e.push(i);else{if(!e||"object"!=typeof e)return[e,i];(a&&(a.plainObjects||a.allowPrototypes)||!s.call(Object.prototype,i))&&(e[i]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(i);var n=e;return r(e)&&!r(i)&&(n=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},s=0;s<t.length;++s)void 0!==t[s]&&(i[s]=t[s]);return i}(e,a)),r(e)&&r(i)?(i.forEach(function(i,r){if(s.call(e,r)){var n=e[r];n&&"object"==typeof n&&i&&"object"==typeof i?e[r]=t(n,i,a):e.push(i)}else e[r]=i}),e):Object.keys(i).reduce(function(e,r){var n=i[r];return s.call(e,r)?e[r]=t(e[r],n,a):e[r]=n,e},n)},o=function(t,e,i){var s=t.replace(/\+/g," ");if("iso-8859-1"===i)return s.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(s)}catch(t){return s}},d=function(t,e,i){if(0===t.length)return t;var s="string"==typeof t?t:String(t);if("iso-8859-1"===i)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var r="",n=0;n<s.length;++n){var o=s.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?r+=s.charAt(n):o<128?r+=a[o]:o<2048?r+=a[192|o>>6]+a[128|63&o]:o<55296||o>=57344?r+=a[224|o>>12]+a[128|o>>6&63]+a[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&s.charCodeAt(n)),r+=a[240|o>>18]+a[128|o>>12&63]+a[128|o>>6&63]+a[128|63&o])}return r},c=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],s=0;s<e.length;++s)for(var a=e[s],n=a.obj[a.prop],o=Object.keys(n),d=0;d<o.length;++d){var c=o[d],h=n[c];"object"==typeof h&&null!==h&&-1===i.indexOf(h)&&(e.push({obj:n,prop:c}),i.push(h))}return function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(r(i)){for(var s=[],a=0;a<i.length;++a)void 0!==i[a]&&s.push(i[a]);e.obj[e.prop]=s}}}(e),t},h=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},l=function(t){return!(!t||"object"!=typeof t)&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},u=function(t,e){return[].concat(t,e)}},712(t,e,i){"use strict";i.d(e,{w:()=>n});var s=i(9024),r=i(1094);class a extends r.Vw{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,s.Ay.hash(t);const i=(0,r.ZJ)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,n=new Uint8Array(a);n.set(i.length>a?t.create().update(i).digest():i);for(let t=0;t<n.length;t++)n[t]^=54;this.iHash.update(n),this.oHash=t.create();for(let t=0;t<n.length;t++)n[t]^=106;this.oHash.update(n),n.fill(0)}update(t){return s.Ay.exists(this),this.iHash.update(t),this}digestInto(t){s.Ay.exists(this),s.Ay.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:e,iHash:i,finished:s,destroyed:r,blockLen:a,outputLen:n}=this;return t.finished=s,t.destroyed=r,t.blockLen=a,t.outputLen=n,t.oHash=e._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const n=(t,e,i)=>new a(t,e).update(i).digest();n.create=(t,e)=>new a(t,e)},806(t,e,i){"use strict";i.d(e,{E:()=>s});const s="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},890(t,e,i){"use strict";i.d(e,{Ge:()=>d});var s=i(8483);const r=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,a=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function n(t,e){return t.length>e&&(t=t.substring(0,e)+""),t}class o{constructor(t,e){this.hexDigits="0123456789ABCDEF",t instanceof o?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=e)}get(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw new Error(`Requesting byte offset ${t} on a stream of length ${this.enc.length}`);return"string"==typeof this.enc?this.enc.charCodeAt(t):this.enc[t]}hexByte(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)}hexDump(t,e,i){let s="";for(let r=t;r<e;++r)if(s+=this.hexByte(this.get(r)),!0!==i)switch(15&r){case 7:s+="  ";break;case 15:s+="\n";break;default:s+=" "}return s}isASCII(t,e){for(let i=t;i<e;++i){const t=this.get(i);if(t<32||t>176)return!1}return!0}parseStringISO(t,e){let i="";for(let s=t;s<e;++s)i+=String.fromCharCode(this.get(s));return i}parseStringUTF(t,e){let i="";for(let s=t;s<e;){const t=this.get(s++);i+=t<128?String.fromCharCode(t):t>191&&t<224?String.fromCharCode((31&t)<<6|63&this.get(s++)):String.fromCharCode((15&t)<<12|(63&this.get(s++))<<6|63&this.get(s++))}return i}parseStringBMP(t,e){let i,s,r="";for(let a=t;a<e;)i=this.get(a++),s=this.get(a++),r+=String.fromCharCode(i<<8|s);return r}parseTime(t,e,i){let s=this.parseStringISO(t,e);const n=(i?r:a).exec(s);return n?(i&&(n[1]=+n[1],n[1]+=+n[1]<70?2e3:1900),s=n[1]+"-"+n[2]+"-"+n[3]+" "+n[4],n[5]&&(s+=":"+n[5],n[6]&&(s+=":"+n[6],n[7]&&(s+="."+n[7]))),n[8]&&(s+=" UTC","Z"!=n[8]&&(s+=n[8],n[9]&&(s+=":"+n[9]))),s):"Unrecognized time: "+s}parseInteger(t,e){let i=this.get(t);const r=i>127,a=r?255:0;let n,o="";for(;i==a&&++t<e;)i=this.get(t);if(n=e-t,0===n)return r?-1:0;if(n>4){for(o=i,n<<=3;!(128&(+o^a));)o=+o<<1,--n;o="("+n+" bit)\n"}r&&(i-=256);const d=new s.V(i);for(let i=t+1;i<e;++i)d.mulAdd(256,this.get(i));return o+d.toString()}parseBitString(t,e,i){const s=this.get(t),r="("+((e-t-1<<3)-s)+" bit)\n";let a="";for(let o=t+1;o<e;++o){const t=this.get(o),d=o==e-1?s:0;for(let e=7;e>=d;--e)a+=t>>e&1?"1":"0";if(a.length>i)return r+n(a,i)}return r+a}parseOctetString(t,e,i){if(this.isASCII(t,e))return n(this.parseStringISO(t,e),i);const s=e-t;let r="("+s+" byte)\n";s>(i/=2)&&(e=t+i);for(let i=t;i<e;++i)r+=this.hexByte(this.get(i));return s>i&&(r+=""),r}parseOID(t,e,i){let r="",a=new s.V,o=0;for(let d=t;d<e;++d){const t=this.get(d);if(a.mulAdd(128,127&t),o+=7,!(128&t)){if(""===r)if(a=a.simplify(),a instanceof s.V)a.sub(80),r="2."+a.toString();else{const t=a<80?a<40?0:1:2;r=t+"."+(a-40*t)}else r+="."+a.toString();if(r.length>i)return n(r,i);a=new s.V,o=0}}return o>0&&(r+=".incomplete"),r}}class d{constructor(t,e,i,s,r){if(!(s instanceof c))throw new Error("Invalid tag value.");this.stream=t,this.header=e,this.length=i,this.tag=s,this.sub=r}typeName(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}}content(t){if(void 0===this.tag)return null;void 0===t&&(t=1/0);const e=this.posContent(),i=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+i,t);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(e)?"false":"true";case 2:return this.stream.parseInteger(e,e+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+i,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+i,t);case 6:return this.stream.parseOID(e,e+i,t);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return n(this.stream.parseStringUTF(e,e+i),t);case 18:case 19:case 20:case 21:case 22:case 26:return n(this.stream.parseStringISO(e,e+i),t);case 30:return n(this.stream.parseStringBMP(e,e+i),t);case 23:case 24:return this.stream.parseTime(e,e+i,23==this.tag.tagNumber)}return null}toString(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"}toPrettyString(t){void 0===t&&(t="");let e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,this.tag.tagConstructed?e+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(e+=" (encapsulates)"),e+="\n",null!==this.sub){t+="  ";for(let i=0,s=this.sub.length;i<s;++i)e+=this.sub[i].toPrettyString(t)}return e}posStart(){return this.stream.pos}posContent(){return this.stream.pos+this.header}posEnd(){return this.stream.pos+this.header+Math.abs(this.length)}toHexString(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)}static decodeLength(t){let e=t.get();const i=127&e;if(i==e)return i;if(i>6)throw new Error("Length over 48 bits not supported at position "+(t.pos-1));if(0===i)return null;e=0;for(let s=0;s<i;++s)e=256*e+t.get();return e}getHexStringValue(){const t=this.toHexString(),e=2*this.header,i=2*this.length;return t.substr(e,i)}static decode(t){let e;e=t instanceof o?t:new o(t,0);const i=new o(e),s=new c(e);let r=d.decodeLength(e);const a=e.pos,n=a-i.pos;let h=null;const l=function(){const t=[];if(null!==r){const i=a+r;for(;e.pos<i;)t[t.length]=d.decode(e);if(e.pos!=i)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){const i=d.decode(e);if(i.tag.isEOC())break;t[t.length]=i}r=a-e.pos}catch(t){throw new Error("Exception while decoding undefined length content: "+t)}return t};if(s.tagConstructed)h=l();else if(s.isUniversal()&&(3==s.tagNumber||4==s.tagNumber))try{if(3==s.tagNumber&&0!=e.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");h=l();for(let t=0;t<h.length;++t)if(h[t].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(t){h=null}if(null===h){if(null===r)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);e.pos=a+Math.abs(r)}return new d(i,n,r,s,h)}}class c{constructor(t){let e=t.get();if(this.tagClass=e>>6,this.tagConstructed=!!(32&e),this.tagNumber=31&e,31==this.tagNumber){const i=new s.V;do{e=t.get(),i.mulAdd(128,127&e)}while(128&e);this.tagNumber=i.simplify()}}isUniversal(){return 0===this.tagClass}isEOC(){return 0===this.tagClass&&0===this.tagNumber}}},916(t,e,i){"use strict";i.d(e,{A:()=>l});var s=i(3283),r=i(274),a=i(5307),n=i(6863),o=i(9620),d=i(1668),c=i(7593),h=i(7925);function l(t,e,i,l){const u=(t,e)=>{if((0,a.G$)(e))return function(t,e){const i=(0,a.CS)(e);if((0,h.Kg)(t))return t;return t.map(t=>u(t,i))}(t,e);if((0,a.iO)(e,l)){const i=l[e];return f(t,i)}if((0,a.Zm)(e))return function(t,e){const i=(0,c.A)(e).reduce((e,i,s)=>{const r=Object.keys(t),a=i=>Object.defineProperty(e,s.toString(),{enumerable:!0,value:i??t[r[s]]}),n=i?.type?i.type:i;return a(u(t[r[s]],n)),e},{});return i}(t,e);if((0,a.GY)(e))return t;if((0,a.ak)(e))return t;if((0,a.Z$)(e))return t;if(s.is.isAbiType(e)){const i=t;if("object"!=typeof i)return i;if(!("low"in i)||!("high"in i))throw Error(`Your object includes the property : ${e}, containing an Uint256 object without the 'low' and 'high' keys.`);return{low:i.low,high:i.high}}if(r.Ns.isAbiType(e)){const i=t;if("object"!=typeof i)return i;if(!["limb0","limb1","limb2","limb3"].every(t=>t in i))throw function(t){return Error(`Your object includes the property : ${t}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`)}(e);return{limb0:i.limb0,limb1:i.limb1,limb2:i.limb2,limb3:i.limb3}}if((0,a.wJ)(e,i)){const s=i[e].members;return p(t,s)}return t},p=(t,e)=>e.reduce((e,i)=>{if("undefined"===t[i.name]&&((0,a.s8)(i.type)||!(0,a.ct)(i.name)))throw Error(`Your object needs a property with key : ${i.name} .`);var s;return s=u(t[i.name],i.type),Object.defineProperty(e,i.name,{enumerable:!0,value:s??t[i.name]}),e},{});const f=(t,e)=>{if((0,a.u)(e.name)){const i=t,s=e.name.substring(e.name.indexOf("<")+1,e.name.lastIndexOf(",")),r=e.name.substring(e.name.indexOf(",")+1,e.name.lastIndexOf(">"));return i.isOk()?new d.G(d.B.Ok,u(t.unwrap(),s)):new d.G(d.B.Err,u(t.unwrap(),r))}if((0,a.e4)(e.name)){const i=t,s=e.name.substring(e.name.indexOf("<")+1,e.name.lastIndexOf(">"));return i.isSome()?new o.c(o.R.Some,u(i.unwrap(),s)):new o.c(o.R.None,{})}const i=t,s=Object.entries(i.variant).map(t=>{if(void 0===t[1])return t;const s=e.type.substring(e.type.lastIndexOf("<")+1,e.type.lastIndexOf(">"));return"()"===s?t:[t[0],u(i.unwrap(),s)]});return new n.b(Object.fromEntries(s))};return e.reduce((e,i)=>{return(0,a.ct)(i.name)&&!(0,a.s8)(i.type)||(s=u(t[i.name],i.type),Object.defineProperty(e,i.name,{enumerable:!0,value:s})),e;var s},{})}},917(t,e,i){"use strict";function s(t,e){if(e&&e.multiple&&!Array.isArray(t))throw new Error("Invalid argument type: Expected an Array to serialize multiple values.");const i=4294967296;let s,r,a=new Uint8Array(128),n=0;if(e&&e.multiple)for(let e=0;e<t.length;e++)o(t[e]);else o(t);return a.subarray(0,n);function o(t,a){switch(typeof t){case"undefined":d(t);break;case"boolean":!function(t){h(t?195:194)}(t);break;case"number":!function(t){if(isFinite(t)&&Math.floor(t)===t)if(t>=0&&t<=127)h(t);else if(t<0&&t>=-32)h(t);else if(t>0&&t<=255)l([204,t]);else if(t>=-128&&t<=127)l([208,t]);else if(t>0&&t<=65535)l([205,t>>>8,t]);else if(t>=-32768&&t<=32767)l([209,t>>>8,t]);else if(t>0&&t<=4294967295)l([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)l([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0x10000000000000000){let e=t/i,s=t%i;l([207,e>>>24,e>>>16,e>>>8,e,s>>>24,s>>>16,s>>>8,s])}else t>=-0x8000000000000000&&t<=0x8000000000000000?(h(211),u(t)):l(t<0?[211,128,0,0,0,0,0,0,0]:[207,255,255,255,255,255,255,255,255]);else r||(s=new ArrayBuffer(8),r=new DataView(s)),r.setFloat64(0,t),h(203),l(new Uint8Array(s))}(t);break;case"string":!function(t){let e=function(t){let e=!0,i=t.length;for(let s=0;s<i;s++)if(t.charCodeAt(s)>127){e=!1;break}let s=0,r=new Uint8Array(t.length*(e?1:4));for(let e=0;e!==i;e++){let a=t.charCodeAt(e);if(a<128)r[s++]=a;else{if(a<2048)r[s++]=a>>6|192;else{if(a>55295&&a<56320){if(++e>=i)throw new Error("UTF-8 encode: incomplete surrogate pair");let n=t.charCodeAt(e);if(n<56320||n>57343)throw new Error("UTF-8 encode: second surrogate character 0x"+n.toString(16)+" at index "+e+" out of range");a=65536+((1023&a)<<10)+(1023&n),r[s++]=a>>18|240,r[s++]=a>>12&63|128}else r[s++]=a>>12|224;r[s++]=a>>6&63|128}r[s++]=63&a|128}}return e?r:r.subarray(0,s)}(t),i=e.length;i<=31?h(160+i):l(i<=255?[217,i]:i<=65535?[218,i>>>8,i]:[219,i>>>24,i>>>16,i>>>8,i]);l(e)}(t);break;case"object":null===t?d(t):t instanceof Date?function(t){let e=t.getTime()/1e3;if(0===t.getMilliseconds()&&e>=0&&e<4294967296)l([214,255,e>>>24,e>>>16,e>>>8,e]);else if(e>=0&&e<17179869184){let s=1e6*t.getMilliseconds();l([215,255,s>>>22,s>>>14,s>>>6,s<<2>>>0|e/i,e>>>24,e>>>16,e>>>8,e])}else{let i=1e6*t.getMilliseconds();l([199,12,255,i>>>24,i>>>16,i>>>8,i]),u(e)}}(t):Array.isArray(t)?c(t):t instanceof Uint8Array||t instanceof Uint8ClampedArray?function(t){let e=t.length;l(e<=15?[196,e]:e<=65535?[197,e>>>8,e]:[198,e>>>24,e>>>16,e>>>8,e]);l(t)}(t):t instanceof Int8Array||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?c(t):function(t){let e=0;for(let i in t)void 0!==t[i]&&e++;e<=15?h(128+e):l(e<=65535?[222,e>>>8,e]:[223,e>>>24,e>>>16,e>>>8,e]);for(let e in t){let i=t[e];void 0!==i&&(o(e),o(i))}}(t);break;default:if(a||!e||!e.invalidTypeReplacement)throw new Error("Invalid argument type: The type '"+typeof t+"' cannot be serialized.");"function"==typeof e.invalidTypeReplacement?o(e.invalidTypeReplacement(t),!0):o(e.invalidTypeReplacement,!0)}}function d(t){h(192)}function c(t){let e=t.length;e<=15?h(144+e):l(e<=65535?[220,e>>>8,e]:[221,e>>>24,e>>>16,e>>>8,e]);for(let i=0;i<e;i++)o(t[i])}function h(t){if(a.length<n+1){let t=2*a.length;for(;t<n+1;)t*=2;let e=new Uint8Array(t);e.set(a),a=e}a[n]=t,n++}function l(t){if(a.length<n+t.length){let e=2*a.length;for(;e<n+t.length;)e*=2;let i=new Uint8Array(e);i.set(a),a=i}a.set(t,n),n+=t.length}function u(t){let e,s;t>=0?(e=t/i,s=t%i):(t++,e=Math.abs(t)/i,s=Math.abs(t)%i,e=~e,s=~s),l([e>>>24,e>>>16,e>>>8,e,s>>>24,s>>>16,s>>>8,s])}}i.d(e,{l:()=>s})},934(t,e,i){"use strict";i.d(e,{A:()=>l});var s=i(2079),r=i(4350),a=i(3206),n=i(7597),o=i(7437),d=i(9560),c=i(8403),h=i(4710);class l{constructor(t,e,i,s,r,n={}){this.verbose=!1,this.decompressBinary=!0;const d={url:t,onMessageCallback:e,onErrorCallback:i,onCloseCallback:s,onConnectedCallback:r,verbose:!1,protocols:void 0,options:void 0,futures:{},subscriptions:{},rejections:{},connected:void 0,error:void 0,connectionStarted:void 0,connectionEstablished:void 0,isConnected:!1,connectionTimer:void 0,connectionTimeout:1e4,pingInterval:void 0,ping:void 0,keepAlive:3e4,maxPingPongMisses:2,connection:void 0,startedConnecting:!1,gunzip:!1,inflate:!1};Object.assign(this,(0,o.zw)(d,n)),this.connected=(0,a.K)()}reusableFuture(t){return this.future(t)}future(t){t in this.futures||(this.futures[t]=(0,a.K)());const e=this.futures[t];return t in this.rejections&&(e.reject(this.rejections[t]),delete this.rejections[t]),e}resolve(t,e){if(this.verbose&&void 0===e&&this.log(new Date,"resolve received undefined messageHash"),void 0!==e&&e in this.futures){this.futures[e].resolve(t),delete this.futures[e]}return t}reject(t,e=void 0){if(e)if(e in this.futures){this.futures[e].reject(t),delete this.futures[e]}else this.rejections[e]=t;else{const e=Object.keys(this.futures);for(let i=0;i<e.length;i++)this.reject(t,e[i])}return t}log(...t){console.log(...t)}connect(t=0){throw new s.NotSupported("connect() not implemented yet")}isOpen(){throw new s.NotSupported("isOpen() not implemented yet")}reset(t){this.clearConnectionTimeout(),this.clearPingInterval(),this.reject(t)}onConnectionTimeout(){if(!this.isOpen()){const t=new s.RequestTimeout("Connection to "+this.url+" failed due to a connection timeout");this.onError(t),this.connection.close(1006)}}setConnectionTimeout(){if(this.connectionTimeout){const t=this.onConnectionTimeout.bind(this);this.connectionTimer=setTimeout(t,this.connectionTimeout)}}clearConnectionTimeout(){this.connectionTimer&&(this.connectionTimer=clearTimeout(this.connectionTimer))}setPingInterval(){if(this.keepAlive){const t=this.onPingInterval.bind(this);this.pingInterval=setInterval(t,this.keepAlive)}}clearPingInterval(){this.pingInterval&&(this.pingInterval=clearInterval(this.pingInterval))}onPingInterval(){if(this.keepAlive&&this.isOpen()){const t=(0,c.Rz)();if(this.lastPong=this.lastPong||t,this.lastPong+this.keepAlive*this.maxPingPongMisses<t)this.onError(new s.RequestTimeout("Connection to "+this.url+" timed out due to a ping-pong keepalive missing on time"));else{let e;this.ping&&(e=this.ping(this)),this.verbose&&this.log(new Date,"onPingInterval","|",this.url),e?this.send(e).catch(t=>{this.onError(t)}):n.Ll?this.connection.ping():this.lastPong=t}}}onOpen(){this.verbose&&this.log(new Date,"onOpen","|",this.url),this.connectionEstablished=(0,c.Rz)(),this.isConnected=!0,this.connected.resolve(this.url),this.clearConnectionTimeout(),this.setPingInterval(),this.onConnectedCallback(this)}onPing(){this.verbose&&this.log(new Date,"onPing","|",this.url)}onPong(){this.lastPong=(0,c.Rz)(),this.verbose&&this.log(new Date,"onPong","|",this.url)}onError(t){this.verbose&&this.log(new Date,"onError",t.message,"|",this.url),t instanceof s.BaseError||(t=new s.NetworkError(t.message)),this.error=t,this.reset(this.error),this.onErrorCallback(this,this.error)}onClose(t){this.verbose&&this.log(new Date,"onClose",t,"|",this.url),this.error||this.reset(new s.NetworkError("connection closed by remote server, closing code "+String(t.code))),this.error instanceof s.ExchangeClosedByUser&&this.reset(this.error),void 0!==this.disconnected&&this.disconnected.resolve(!0),this.onCloseCallback(this,t)}onUpgrade(t){this.verbose&&this.log(new Date,"onUpgrade","|",this.url)}async send(t){this.verbose&&this.log(new Date,"sending",t),t="string"==typeof t?t:JSON.stringify(t);const e=(0,a.K)();if(n.Ll){function i(t){t?e.reject(t):e.resolve(null)}this.connection.send(t,{},i)}else this.connection.send(t),e.resolve(null);return e}close(){throw new s.NotSupported("close() not implemented yet")}async onMessage(t){let e=t.data;if("string"!=typeof e)if(this.gunzip||this.inflate){const t=await e.arrayBuffer();let i=new Uint8Array(t);this.gunzip?i=(0,r.Wt)(i):this.inflate&&(i=(0,r.HM)(i)),e=h.As.encode(i)}else this.decompressBinary&&(e=e.toString());try{(0,d.mC)(e)&&(e=e.toString(),e=JSON.parse(e.replace(/:(\d{15,}),/g,':"$1",'))),this.verbose&&this.log(new Date,"onMessage",e)}catch(t){this.log(new Date,"onMessage JSON.parse",t,"|",this.url)}try{this.onMessageCallback(this,e)}catch(t){this.reject(t)}}}},975(t,e,i){"use strict";function s(t,e){let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>>1;t[r]-e<0?i=r+1:s=r-1}return i}i.d(e,{$w:()=>d,PB:()=>c,eB:()=>p,f_:()=>h,jR:()=>l,o5:()=>u});const r=new Float64Array(new Array(1024).fill(Number.MAX_VALUE));class a extends Array{constructor(t=[],e=void 0){super(),Object.defineProperty(this,"index",{__proto__:null,value:new Float64Array(r),writable:!0}),Object.defineProperty(this,"depth",{__proto__:null,value:e||Number.MAX_SAFE_INTEGER,writable:!0}),this.length=0;for(let e=0;e<t.length;e++)this.storeArray(t[e].slice())}storeArray(t){const e=t[0],i=t[1],r=this.side?-e:e,a=s(this.index,r);if(i){if(this.index[a]===r)this[a][1]=i;else if(this.length++,this.index.copyWithin(a+1,a,this.index.length),this.index[a]=r,this.copyWithin(a+1,a,this.length),this[a]=t,this.length>this.index.length-1){const t=Array.from(this.index);t.length=2*this.length,t.fill(Number.MAX_VALUE,this.index.length),this.index=new Float64Array(t)}}else this.index[a]===r&&(this.index.copyWithin(a,a+1,this.index.length),this.index[this.length-1]=Number.MAX_VALUE,this.copyWithin(a,a+1,this.length),this.length--)}store(t,e){this.storeArray([t,e])}limit(){if(this.length>this.depth){for(let t=this.depth;t<this.length;t++)this.index[t]=Number.MAX_VALUE;this.length=this.depth}}}class n extends a{store(t,e){throw new Error("CountedOrderBookSide.store() is not supported, use storeArray([price, size, count]) instead")}storeArray(t){const e=t[0],i=t[1],r=t[2],a=this.side?-e:e,n=s(this.index,a);if(i&&r){if(this.index[n]===a){const t=this[n];t[1]=i,t[2]=r}else if(this.length++,this.index.copyWithin(n+1,n,this.index.length),this.index[n]=a,this.copyWithin(n+1,n,this.length),this[n]=t,this.length>this.index.length-1){const t=Array.from(this.index);t.length=2*this.length,t.fill(Number.MAX_VALUE,this.index.length),this.index=new Float64Array(t)}}else this.index[n]===a&&(this.index.copyWithin(n,n+1,this.index.length),this.index[this.length-1]=Number.MAX_VALUE,this.copyWithin(n,n+1,this.length),this.length--)}}class o extends Array{constructor(t=[],e=Number.MAX_SAFE_INTEGER){super(t.length),Object.defineProperty(this,"hashmap",{__proto__:null,value:new Map,writable:!0}),Object.defineProperty(this,"index",{__proto__:null,value:new Float64Array(r),writable:!0}),Object.defineProperty(this,"depth",{__proto__:null,value:e||Number.MAX_SAFE_INTEGER,writable:!0});for(let e=0;e<t.length;e++)this.length=e,this.storeArray(t[e].slice())}store(t,e){throw new Error("IndexedOrderBook.store() is not supported, use storeArray([price, size, id]) instead")}storeArray(t){const e=t[0],i=t[1],r=t[2];let a;if(a=void 0!==e?this.side?-e:e:void 0,i){if(this.hashmap.has(r)){const e=this.hashmap.get(r);if(a=a||e,t[0]=Math.abs(a),a===e){let e=s(this.index,a);for(;this[e][2]!==r;)e++;return this.index[e]=a,void(this[e]=t)}{let t=s(this.index,e);for(;this[t][2]!==r;)t++;this.index.copyWithin(t,t+1,this.index.length),this.index[this.length-1]=Number.MAX_VALUE,this.copyWithin(t,t+1,this.length),this.length--}}this.hashmap.set(r,a);let e=s(this.index,a);for(;e<this.length&&this.index[e]===a&&this[e][2]<r;)e++;if(this.length++,this.index.copyWithin(e+1,e,this.index.length),this.index[e]=a,this.copyWithin(e+1,e,this.length),this[e]=t,this.length>this.index.length-1){const t=Array.from(this.index);t.length=2*this.length,t.fill(Number.MAX_VALUE,this.index.length),this.index=new Float64Array(t)}}else if(this.hashmap.has(r)){const t=this.hashmap.get(r);let e=s(this.index,t);for(;this[e][2]!==r;)e++;this.index.copyWithin(e,e+1,this.index.length),this.index[this.length-1]=Number.MAX_VALUE,this.copyWithin(e,e+1,this.length),this.length--,this.hashmap.delete(r)}}limit(){if(this.length>this.depth){for(let t=this.depth;t<this.length;t++)this.hashmap.delete(this.index[t]),this.index[t]=Number.MAX_VALUE;this.length=this.depth}}}class d extends a{get side(){return!1}}class c extends a{get side(){return!0}}class h extends n{get side(){return!1}}class l extends n{get side(){return!0}}class u extends o{get side(){return!1}}class p extends o{get side(){return!0}}},987(t,e,i){"use strict";i.d(e,{bI:()=>g});var s=i(4852),r=(i(1094),i(1064)),a=i(2442),n=i(191),o=i(4506),d=i(1999);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const c=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),h=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),l=BigInt(1),u=BigInt(2),p=(t,e)=>(t+e/u)/e;function f(t){const e=c,i=BigInt(3),s=BigInt(6),a=BigInt(11),n=BigInt(22),o=BigInt(23),d=BigInt(44),h=BigInt(88),l=t*t*t%e,p=l*l*t%e,f=(0,r.zH)(p,i,e)*p%e,g=(0,r.zH)(f,i,e)*p%e,y=(0,r.zH)(g,u,e)*l%e,v=(0,r.zH)(y,a,e)*y%e,b=(0,r.zH)(v,n,e)*v%e,w=(0,r.zH)(b,d,e)*b%e,S=(0,r.zH)(w,h,e)*w%e,k=(0,r.zH)(S,d,e)*b%e,O=(0,r.zH)(k,i,e)*p%e,T=(0,r.zH)(O,o,e)*v%e,P=(0,r.zH)(T,s,e)*l%e,_=(0,r.zH)(P,u,e);if(!m.eql(m.sqr(_),t))throw new Error("Cannot find square root");return _}const m=(0,r.Fp)(c,void 0,void 0,{sqrt:f}),g=(0,d.s)({a:BigInt(0),b:BigInt(7),Fp:m,n:h,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=h,i=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),s=-l*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=i,o=BigInt("0x100000000000000000000000000000000"),d=p(n*t,e),c=p(-s*t,e);let u=(0,r.zi)(t-d*i-c*a,e),f=(0,r.zi)(-d*s-c*n,e);const m=u>o,g=f>o;if(m&&(u=e-u),g&&(f=e-f),u>o||f>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:m,k1:u,k2neg:g,k2:f}}}},s.s),y=BigInt(0),v=t=>"bigint"==typeof t&&y<t&&t<c,b={};function w(t,...e){let i=b[t];if(void 0===i){const e=(0,s.s)(Uint8Array.from(t,t=>t.charCodeAt(0)));i=(0,n.Id)(e,e),b[t]=i}return(0,s.s)((0,n.Id)(i,...e))}const S=t=>t.toRawBytes(!0).slice(1),k=t=>(0,r.zi)(t,c),O=g.ProjectivePoint;function T(t){if(!v(t))throw new Error("bad x: need 0 < x < p");const e=k(t*t);let i=f(k(e*t+BigInt(7)));i%2n!=0n&&(i=k(-i));const s=new O(t,i,l);return s.assertValidity(),s}g.utils.randomPrivateKey,n.lq,n.Ph,r.zi;const P=o.FL(m,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(t=>BigInt(t)))),_=(0,a.Is)(m,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:m.create(BigInt("-11"))}),{hashToCurve:A,encodeToCurve:I}=o.qj(g.ProjectivePoint,t=>{const{x:e,y:i}=_(m.create(t[0]));return P(e,i)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:m.ORDER,m:1,k:128,expand:"xmd",hash:s.s})},1064(t,e,i){"use strict";i.d(e,{B8:()=>f,Fp:()=>S,LH:()=>w,PA:()=>O,Tv:()=>k,dQ:()=>g,f4:()=>b,jr:()=>v,n7:()=>u,zH:()=>p,zi:()=>l});var s=i(191);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const r=BigInt(0),a=BigInt(1),n=BigInt(2),o=BigInt(3),d=BigInt(4),c=BigInt(5),h=BigInt(8);BigInt(9),BigInt(16);function l(t,e){const i=t%e;return i>=r?i:e+i}function u(t,e,i){if(i<=r||e<r)throw new Error("Expected power/modulo > 0");if(i===a)return r;let s=a;for(;e>r;)e&a&&(s=s*t%i),t=t*t%i,e>>=a;return s}function p(t,e,i){let s=t;for(;e-- >r;)s*=s,s%=i;return s}function f(t,e){if(t===r||e<=r)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let i=l(t,e),s=e,n=r,o=a,d=a,c=r;for(;i!==r;){const t=s/i,e=s%i,r=n-d*t,a=o-c*t;s=i,i=e,n=d,o=c,d=r,c=a}if(s!==a)throw new Error("invert: does not exist");return l(n,e)}function m(t){if(t%d===o){const e=(t+a)/d;return function(t,i){const s=t.pow(i,e);if(!t.eql(t.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%h===c){const e=(t-c)/h;return function(t,i){const s=t.mul(i,n),r=t.pow(s,e),a=t.mul(i,r),o=t.mul(t.mul(a,n),r),d=t.mul(a,t.sub(o,t.ONE));if(!t.eql(t.sqr(d),i))throw new Error("Cannot find square root");return d}}return function(t){const e=(t-a)/n;let i,s,o;for(i=t-a,s=0;i%n===r;i/=n,s++);for(o=n;o<t&&u(o,e,t)!==t-a;o++);if(1===s){const e=(t+a)/d;return function(t,i){const s=t.pow(i,e);if(!t.eql(t.sqr(s),i))throw new Error("Cannot find square root");return s}}const c=(i+a)/n;return function(t,r){if(t.pow(r,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let n=s,d=t.pow(t.mul(t.ONE,o),i),h=t.pow(r,c),l=t.pow(r,i);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=1;for(let i=t.sqr(l);e<n&&!t.eql(i,t.ONE);e++)i=t.sqr(i);const i=t.pow(d,a<<BigInt(n-e-1));d=t.sqr(i),h=t.mul(h,i),l=t.mul(l,d),n=e}return h}}(t)}const g=(t,e)=>(l(t,e)&a)===a,y=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function v(t){const e=y.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,s.Q5)(t,e)}function b(t,e,i){if(i<r)throw new Error("Expected power > 0");if(i===r)return t.ONE;if(i===a)return e;let s=t.ONE,n=e;for(;i>r;)i&a&&(s=t.mul(s,n)),n=t.sqr(n),i>>=1n;return s}function w(t,e){const i=void 0!==e?e:t.toString(2).length;return{nBitLength:i,nByteLength:Math.ceil(i/8)}}function S(t,e,i=!1,n={}){if(t<=r)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:d}=w(t,e);if(d>2048)throw new Error("Field lengths over 2048 bytes are not supported");const c=m(t),h=Object.freeze({ORDER:t,BITS:o,BYTES:d,MASK:(0,s.OG)(o),ZERO:r,ONE:a,create:e=>l(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return r<=e&&e<t},is0:t=>t===r,isOdd:t=>(t&a)===a,neg:e=>l(-e,t),eql:(t,e)=>t===e,sqr:e=>l(e*e,t),add:(e,i)=>l(e+i,t),sub:(e,i)=>l(e-i,t),mul:(e,i)=>l(e*i,t),pow:(t,e)=>b(h,t,e),div:(e,i)=>l(e*f(i,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>f(e,t),sqrt:n.sqrt||(t=>c(h,t)),invertBatch:t=>function(t,e){const i=new Array(e.length),s=e.reduce((e,s,r)=>t.is0(s)?e:(i[r]=e,t.mul(e,s)),t.ONE),r=t.inv(s);return e.reduceRight((e,s,r)=>t.is0(s)?e:(i[r]=t.mul(e,i[r]),t.mul(e,s)),r),i}(h,t),cmov:(t,e,i)=>i?e:t,toBytes:t=>i?(0,s.z)(t,d):(0,s.lq)(t,d),fromBytes:t=>{if(t.length!==d)throw new Error(`Fp.fromBytes: expected ${d}, got ${t.length}`);return i?(0,s.lX)(t):(0,s.Ph)(t)}});return Object.freeze(h)}function k(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const i=t.sqrt(e);return t.isOdd(i)?t.neg(i):i}function O(t,e,i=!1){const r=(t=(0,s.qj)("privateHash",t)).length,n=w(e).nByteLength+8;if(n<24||r<n||r>1024)throw new Error(`hashToPrivateScalar: expected ${n}-1024 bytes of input, got ${r}`);return l(i?(0,s.lX)(t):(0,s.Ph)(t),e-a)+a}},1094(t,e,i){"use strict";i.d(e,{AI:()=>h,DH:()=>r,DO:()=>v,Id:()=>u,My:()=>d,O8:()=>a,Ow:()=>n,Vw:()=>p,ZJ:()=>l,aT:()=>c,ld:()=>m,po:()=>y,t6:()=>g,tY:()=>f});var s=i(806);
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const r=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),a=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),n=(t,e)=>t<<32-e|t>>>e;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function d(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let i=0;i<t.length;i++)e+=o[t[i]];return e}function c(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let i=0;i<e.length;i++){const s=2*i,r=t.slice(s,s+2),a=Number.parseInt(r,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[i]=a}return e}function h(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}function l(t){if("string"==typeof t&&(t=h(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}function u(...t){if(!t.every(t=>t instanceof Uint8Array))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce((t,e)=>t+e.length,0),i=new Uint8Array(e);for(let e=0,s=0;e<t.length;e++){const r=t[e];i.set(r,s),s+=r.length}return i}class p{clone(){return this._cloneInto()}}function f(t,e){if(void 0!==e&&("object"!=typeof e||(i=e,"[object Object]"!==Object.prototype.toString.call(i)||i.constructor!==Object)))throw new TypeError("Options should be object or undefined");var i;return Object.assign(t,e)}function m(t){const e=e=>t().update(l(e)).digest(),i=t();return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=()=>t(),e}function g(t){const e=(e,i)=>t(i).update(l(e)).digest(),i=t({});return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=e=>t(e),e}function y(t=32){if(s.E&&"function"==typeof s.E.getRandomValues)return s.E.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}const v=t=>{if(!(t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected")}},1170(t,e,i){"use strict";let s;i.d(e,{_:()=>r});const r={decode(t){let e;if(void 0===s){let t="0123456789ABCDEF";const i=" \f\n\r\t\u2028\u2029";for(s={},e=0;e<16;++e)s[t.charAt(e)]=e;for(t=t.toLowerCase(),e=10;e<16;++e)s[t.charAt(e)]=e;for(e=0;e<i.length;++e)s[i.charAt(e)]=-1}const i=[];let r=0,a=0;for(e=0;e<t.length;++e){let n=t.charAt(e);if("="==n)break;if(n=s[n],-1!=n){if(void 0===n)throw new Error("Illegal character at offset "+e);r|=n,++a>=2?(i[i.length]=r,r=0,a=0):r<<=4}}if(a)throw new Error("Hex encoding incomplete: 4 bits missing");return i}}},1173(t,e,i){"use strict";i.r(e),i.d(e,{encodeAsAny:()=>h,registry:()=>c});var s=i(8854),r=i(232),a=i(17),n=i(9332),o=i(2755),d=i(8166);const c={"/dydxprotocol.clob.MsgPlaceOrder":a.F9,"/dydxprotocol.clob.MsgCancelOrder":a.sb,"/dydxprotocol.clob.MsgBatchCancel":a.um,"/dydxprotocol.sending.MsgCreateTransfer":o.bX,"/dydxprotocol.sending.MsgWithdrawFromSubaccount":n.bT,"/dydxprotocol.sending.MsgDepositToSubaccount":n.wD,"/dydxprotocol.accountplus.TxExtension":r.KX,"/cosmos.crypto.secp256k1.PubKey":s.r};function h(t){const{typeUrl:e,value:i}=t,s=c[e];if(!s)throw new Error(`Unsupport type url: ${e}`);const r=s.encode(s.fromPartial(i)).finish();return d.F.fromPartial({typeUrl:e,value:r})}},1265(t,e,i){"use strict";i.d(e,{k:()=>n});var s=i(1291),r=i.n(s);function a(){return{assetId:0,quantums:new Uint8Array,index:r().UZERO}}Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const n={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.assetId&&e.uint32(8).uint32(t.assetId),0!==t.quantums.length&&e.uint32(18).bytes(t.quantums),t.index.isZero()||e.uint32(24).uint64(t.index),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=a();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.assetId=i.uint32();break;case 2:r.quantums=i.bytes();break;case 3:r.index=i.uint64();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=a();return e.assetId=t.assetId??0,e.quantums=t.quantums??new Uint8Array,e.index=void 0!==t.index&&null!==t.index?r().fromValue(t.index):r().UZERO,e}}},1279(t,e,i){"use strict";i.d(e,{Bv:()=>p,EB:()=>u,jZ:()=>o});var s=i(2628);let r;const a=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],n=(1<<26)/a[a.length-1];class o{constructor(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}toString(t){if(this.s<0)return"-"+this.negate().toString(t);let e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}const i=(1<<e)-1;let r,a=!1,n="",o=this.t,d=this.DB-o*this.DB%e;if(o-- >0)for(d<this.DB&&(r=this[o]>>d)>0&&(a=!0,n=(0,s.W4)(r));o>=0;)d<e?(r=(this[o]&(1<<d)-1)<<e-d,r|=this[--o]>>(d+=this.DB-e)):(r=this[o]>>(d-=e)&i,d<=0&&(d+=this.DB,--o)),r>0&&(a=!0),a&&(n+=(0,s.W4)(r));return a?n:"0"}negate(){const t=u();return o.ZERO.subTo(this,t),t}abs(){return this.s<0?this.negate():this}compareTo(t){let e=this.s-t.s;if(0!=e)return e;let i=this.t;if(e=i-t.t,0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}bitLength(){return this.t<=0?0:this.DB*(this.t-1)+w(this[this.t-1]^this.s&this.DM)}mod(t){const e=u();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(o.ZERO)>0&&t.subTo(e,e),e}modPowInt(t,e){let i;return i=t<256||e.isEven()?new c(e):new h(e),this.exp(t,i)}clone(){const t=u();return this.copyTo(t),t}intValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}byteValue(){return 0==this.t?this.s:this[0]<<24>>24}shortValue(){return 0==this.t?this.s:this[0]<<16>>16}signum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}toByteArray(){let t=this.t;const e=[];e[0]=this.s;let i,s=this.DB-t*this.DB%8,r=0;if(t-- >0)for(s<this.DB&&(i=this[t]>>s)!=(this.s&this.DM)>>s&&(e[r++]=i|this.s<<this.DB-s);t>=0;)s<8?(i=(this[t]&(1<<s)-1)<<8-s,i|=this[--t]>>(s+=this.DB-8)):(i=this[t]>>(s-=8)&255,s<=0&&(s+=this.DB,--t)),128&i&&(i|=-256),0==r&&(128&this.s)!=(128&i)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e}equals(t){return 0==this.compareTo(t)}min(t){return this.compareTo(t)<0?this:t}max(t){return this.compareTo(t)>0?this:t}and(t){const e=u();return this.bitwiseTo(t,s.Ir,e),e}or(t){const e=u();return this.bitwiseTo(t,s.cO,e),e}xor(t){const e=u();return this.bitwiseTo(t,s.AR,e),e}andNot(t){const e=u();return this.bitwiseTo(t,s.$r,e),e}not(){const t=u();for(let e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}shiftLeft(t){const e=u();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}shiftRight(t){const e=u();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}getLowestSetBit(){for(let t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+(0,s.OF)(this[t]);return this.s<0?this.t*this.DB:-1}bitCount(){let t=0;const e=this.s&this.DM;for(let i=0;i<this.t;++i)t+=(0,s.XP)(this[i]^e);return t}testBit(t){const e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:!!(this[e]&1<<t%this.DB)}setBit(t){return this.changeBit(t,s.cO)}clearBit(t){return this.changeBit(t,s.$r)}flipBit(t){return this.changeBit(t,s.AR)}add(t){const e=u();return this.addTo(t,e),e}subtract(t){const e=u();return this.subTo(t,e),e}multiply(t){const e=u();return this.multiplyTo(t,e),e}divide(t){const e=u();return this.divRemTo(t,e,null),e}remainder(t){const e=u();return this.divRemTo(t,null,e),e}divideAndRemainder(t){const e=u(),i=u();return this.divRemTo(t,e,i),[e,i]}modPow(t,e){let i,s,r=t.bitLength(),a=b(1);if(r<=0)return a;i=r<18?1:r<48?3:r<144?4:r<768?5:6,s=r<8?new c(e):e.isEven()?new l(e):new h(e);const n=[];let o=3;const d=i-1,p=(1<<i)-1;if(n[1]=s.convert(this),i>1){const t=u();for(s.sqrTo(n[1],t);o<=p;)n[o]=u(),s.mulTo(t,n[o-2],n[o]),o+=2}let f,m,g=t.t-1,y=!0,v=u();for(r=w(t[g])-1;g>=0;){for(r>=d?f=t[g]>>r-d&p:(f=(t[g]&(1<<r+1)-1)<<d-r,g>0&&(f|=t[g-1]>>this.DB+r-d)),o=i;!(1&f);)f>>=1,--o;if((r-=o)<0&&(r+=this.DB,--g),y)n[f].copyTo(a),y=!1;else{for(;o>1;)s.sqrTo(a,v),s.sqrTo(v,a),o-=2;o>0?s.sqrTo(a,v):(m=a,a=v,v=m),s.mulTo(v,n[f],a)}for(;g>=0&&!(t[g]&1<<r);)s.sqrTo(a,v),m=a,a=v,v=m,--r<0&&(r=this.DB-1,--g)}return s.revert(a)}modInverse(t){const e=t.isEven();if(this.isEven()&&e||0==t.signum())return o.ZERO;const i=t.clone(),s=this.clone(),r=b(1),a=b(0),n=b(0),d=b(1);for(;0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(r.isEven()&&a.isEven()||(r.addTo(this,r),a.subTo(t,a)),r.rShiftTo(1,r)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;s.isEven();)s.rShiftTo(1,s),e?(n.isEven()&&d.isEven()||(n.addTo(this,n),d.subTo(t,d)),n.rShiftTo(1,n)):d.isEven()||d.subTo(t,d),d.rShiftTo(1,d);i.compareTo(s)>=0?(i.subTo(s,i),e&&r.subTo(n,r),a.subTo(d,a)):(s.subTo(i,s),e&&n.subTo(r,n),d.subTo(a,d))}return 0!=s.compareTo(o.ONE)?o.ZERO:d.compareTo(t)>=0?d.subtract(t):d.signum()<0?(d.addTo(t,d),d.signum()<0?d.add(t):d):d}pow(t){return this.exp(t,new d)}gcd(t){let e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){const t=e;e=i,i=t}let s=e.getLowestSetBit(),r=i.getLowestSetBit();if(r<0)return e;for(s<r&&(r=s),r>0&&(e.rShiftTo(r,e),i.rShiftTo(r,i));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return r>0&&i.lShiftTo(r,i),i}isProbablePrime(t){let e;const i=this.abs();if(1==i.t&&i[0]<=a[a.length-1]){for(e=0;e<a.length;++e)if(i[0]==a[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<a.length;){let t=a[e],s=e+1;for(;s<a.length&&t<n;)t*=a[s++];for(t=i.modInt(t);e<s;)if(t%a[e++]==0)return!1}return i.millerRabin(t)}copyTo(t){for(let e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}fromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}fromString(t,e){let i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;let s=t.length,r=!1,a=0;for(;--s>=0;){const e=8==i?255&+t[s]:v(t,s);e<0?"-"==t.charAt(s)&&(r=!0):(r=!1,0==a?this[this.t++]=e:a+i>this.DB?(this[this.t-1]|=(e&(1<<this.DB-a)-1)<<a,this[this.t++]=e>>this.DB-a):this[this.t-1]|=e<<a,a+=i,a>=this.DB&&(a-=this.DB))}8==i&&128&+t[0]&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),r&&o.ZERO.subTo(this,this)}clamp(){const t=this.s&this.DM;for(;this.t>0&&this[this.t-1]==t;)--this.t}dlShiftTo(t,e){let i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}drShiftTo(t,e){for(let i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}lShiftTo(t,e){const i=t%this.DB,s=this.DB-i,r=(1<<s)-1,a=Math.floor(t/this.DB);let n=this.s<<i&this.DM;for(let t=this.t-1;t>=0;--t)e[t+a+1]=this[t]>>s|n,n=(this[t]&r)<<i;for(let t=a-1;t>=0;--t)e[t]=0;e[a]=n,e.t=this.t+a+1,e.s=this.s,e.clamp()}rShiftTo(t,e){e.s=this.s;const i=Math.floor(t/this.DB);if(i>=this.t)return void(e.t=0);const s=t%this.DB,r=this.DB-s,a=(1<<s)-1;e[0]=this[i]>>s;for(let t=i+1;t<this.t;++t)e[t-i-1]|=(this[t]&a)<<r,e[t-i]=this[t]>>s;s>0&&(e[this.t-i-1]|=(this.s&a)<<r),e.t=this.t-i,e.clamp()}subTo(t,e){let i=0,s=0;const r=Math.min(t.t,this.t);for(;i<r;)s+=this[i]-t[i],e[i++]=s&this.DM,s>>=this.DB;if(t.t<this.t){for(s-=t.s;i<this.t;)s+=this[i],e[i++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;i<t.t;)s-=t[i],e[i++]=s&this.DM,s>>=this.DB;s-=t.s}e.s=s<0?-1:0,s<-1?e[i++]=this.DV+s:s>0&&(e[i++]=s),e.t=i,e.clamp()}multiplyTo(t,e){const i=this.abs(),s=t.abs();let r=i.t;for(e.t=r+s.t;--r>=0;)e[r]=0;for(r=0;r<s.t;++r)e[r+i.t]=i.am(0,s[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&o.ZERO.subTo(e,e)}squareTo(t){const e=this.abs();let i=t.t=2*e.t;for(;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){const s=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,s,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}divRemTo(t,e,i){const s=t.abs();if(s.t<=0)return;const r=this.abs();if(r.t<s.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=u());const a=u(),n=this.s,d=t.s,c=this.DB-w(s[s.t-1]);c>0?(s.lShiftTo(c,a),r.lShiftTo(c,i)):(s.copyTo(a),r.copyTo(i));const h=a.t,l=a[h-1];if(0==l)return;const p=l*(1<<this.F1)+(h>1?a[h-2]>>this.F2:0),f=this.FV/p,m=(1<<this.F1)/p,g=1<<this.F2;let y=i.t,v=y-h;const b=null==e?u():e;for(a.dlShiftTo(v,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),o.ONE.dlShiftTo(h,b),b.subTo(a,a);a.t<h;)a[a.t++]=0;for(;--v>=0;){let t=i[--y]==l?this.DM:Math.floor(i[y]*f+(i[y-1]+g)*m);if((i[y]+=a.am(0,t,i,v,0,h))<t)for(a.dlShiftTo(v,b),i.subTo(b,i);i[y]<--t;)i.subTo(b,i)}null!=e&&(i.drShiftTo(h,e),n!=d&&o.ZERO.subTo(e,e)),i.t=h,i.clamp(),c>0&&i.rShiftTo(c,i),n<0&&o.ZERO.subTo(i,i)}invDigit(){if(this.t<1)return 0;const t=this[0];if(!(1&t))return 0;let e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}isEven(){return 0==(this.t>0?1&this[0]:this.s)}exp(t,e){if(t>4294967295||t<1)return o.ONE;let i=u(),s=u();const r=e.convert(this);let a=w(t)-1;for(r.copyTo(i);--a>=0;)if(e.sqrTo(i,s),(t&1<<a)>0)e.mulTo(s,r,i);else{const t=i;i=s,s=t}return e.revert(i)}chunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}toRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";const e=this.chunkSize(t),i=Math.pow(t,e),s=b(i),r=u(),a=u();let n="";for(this.divRemTo(s,r,a);r.signum()>0;)n=(i+a.intValue()).toString(t).substr(1)+n,r.divRemTo(s,r,a);return a.intValue().toString(t)+n}fromRadix(t,e){this.fromInt(0),null==e&&(e=10);const i=this.chunkSize(e),s=Math.pow(e,i);let r=!1,a=0,n=0;for(let o=0;o<t.length;++o){const d=v(t,o);d<0?"-"==t.charAt(o)&&0==this.signum()&&(r=!0):(n=e*n+d,++a>=i&&(this.dMultiply(s),this.dAddOffset(n,0),a=0,n=0))}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(n,0)),r&&o.ZERO.subTo(this,this)}fromNumber(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(o.ONE.shiftLeft(t-1),s.cO,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(o.ONE.shiftLeft(t-1),this);else{const i=[],s=7&t;i.length=1+(t>>3),e.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}bitwiseTo(t,e,i){let s,r;const a=Math.min(t.t,this.t);for(s=0;s<a;++s)i[s]=e(this[s],t[s]);if(t.t<this.t){for(r=t.s&this.DM,s=a;s<this.t;++s)i[s]=e(this[s],r);i.t=this.t}else{for(r=this.s&this.DM,s=a;s<t.t;++s)i[s]=e(r,t[s]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}changeBit(t,e){const i=o.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}addTo(t,e){let i=0,s=0;const r=Math.min(t.t,this.t);for(;i<r;)s+=this[i]+t[i],e[i++]=s&this.DM,s>>=this.DB;if(t.t<this.t){for(s+=t.s;i<this.t;)s+=this[i],e[i++]=s&this.DM,s>>=this.DB;s+=this.s}else{for(s+=this.s;i<t.t;)s+=t[i],e[i++]=s&this.DM,s>>=this.DB;s+=t.s}e.s=s<0?-1:0,s>0?e[i++]=s:s<-1&&(e[i++]=this.DV+s),e.t=i,e.clamp()}dMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}dAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}multiplyLowerTo(t,e,i){let s=Math.min(this.t+t.t,e);for(i.s=0,i.t=s;s>0;)i[--s]=0;for(const e=i.t-this.t;s<e;++s)i[s+this.t]=this.am(0,t[s],i,s,0,this.t);for(const r=Math.min(t.t,e);s<r;++s)this.am(0,t[s],i,s,0,e-s);i.clamp()}multiplyUpperTo(t,e,i){--e;let s=i.t=this.t+t.t-e;for(i.s=0;--s>=0;)i[s]=0;for(s=Math.max(e-this.t,0);s<t.t;++s)i[this.t+s-e]=this.am(e-s,t[s],i,0,0,this.t+s-e);i.clamp(),i.drShiftTo(1,i)}modInt(t){if(t<=0)return 0;const e=this.DV%t;let i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(let s=this.t-1;s>=0;--s)i=(e*i+this[s])%t;return i}millerRabin(t){const e=this.subtract(o.ONE),i=e.getLowestSetBit();if(i<=0)return!1;const s=e.shiftRight(i);(t=t+1>>1)>a.length&&(t=a.length);const r=u();for(let n=0;n<t;++n){r.fromInt(a[Math.floor(Math.random()*a.length)]);let t=r.modPow(s,this);if(0!=t.compareTo(o.ONE)&&0!=t.compareTo(e)){let s=1;for(;s++<i&&0!=t.compareTo(e);)if(t=t.modPowInt(2,this),0==t.compareTo(o.ONE))return!1;if(0!=t.compareTo(e))return!1}}return!0}square(){const t=u();return this.squareTo(t),t}gcda(t,e){let i=this.s<0?this.negate():this.clone(),s=t.s<0?t.negate():t.clone();if(i.compareTo(s)<0){const t=i;i=s,s=t}let r=i.getLowestSetBit(),a=s.getLowestSetBit();if(a<0)return void e(i);r<a&&(a=r),a>0&&(i.rShiftTo(a,i),s.rShiftTo(a,s));const n=function(){(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i),(r=s.getLowestSetBit())>0&&s.rShiftTo(r,s),i.compareTo(s)>=0?(i.subTo(s,i),i.rShiftTo(1,i)):(s.subTo(i,s),s.rShiftTo(1,s)),i.signum()>0?setTimeout(n,0):(a>0&&s.lShiftTo(a,s),setTimeout(function(){e(s)},0))};setTimeout(n,10)}fromNumberAsync(t,e,i,r){if("number"==typeof e)if(t<2)this.fromInt(1);else{this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(o.ONE.shiftLeft(t-1),s.cO,this),this.isEven()&&this.dAddOffset(1,0);const a=this,n=function(){a.dAddOffset(2,0),a.bitLength()>t&&a.subTo(o.ONE.shiftLeft(t-1),a),a.isProbablePrime(e)?setTimeout(function(){r()},0):setTimeout(n,0)};setTimeout(n,0)}else{const i=[],s=7&t;i.length=1+(t>>3),e.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}}class d{constructor(){}convert(t){return t}revert(t){return t}mulTo(t,e,i){t.multiplyTo(e,i)}sqrTo(t,e){t.squareTo(e)}}class c{constructor(t){this.m=t}convert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}revert(t){return t}reduce(t){t.divRemTo(this.m,null,t)}mulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}}class h{constructor(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}convert(t){const e=u();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(o.ZERO)>0&&this.m.subTo(e,e),e}revert(t){const e=u();return t.copyTo(e),this.reduce(e),e}reduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(let e=0;e<this.m.t;++e){let i=32767&t[e];const s=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,s,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}mulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}}class l{constructor(t){this.m=t,this.r2=u(),this.q3=u(),o.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t)}convert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;{const e=u();return t.copyTo(e),this.reduce(e),e}}revert(t){return t}reduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}mulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}}function u(){return new o(null)}function p(t,e){return new o(t,e)}const f="undefined"!=typeof navigator;f&&"Microsoft Internet Explorer"==navigator.appName?(o.prototype.am=function(t,e,i,s,r,a){const n=32767&e,o=e>>15;for(;--a>=0;){let e=32767&this[t];const a=this[t++]>>15,d=o*e+a*n;e=n*e+((32767&d)<<15)+i[s]+(1073741823&r),r=(e>>>30)+(d>>>15)+o*a+(r>>>30),i[s++]=1073741823&e}return r},r=30):f&&"Netscape"!=navigator.appName?(o.prototype.am=function(t,e,i,s,r,a){for(;--a>=0;){const a=e*this[t++]+i[s]+r;r=Math.floor(a/67108864),i[s++]=67108863&a}return r},r=26):(o.prototype.am=function(t,e,i,s,r,a){const n=16383&e,o=e>>14;for(;--a>=0;){let e=16383&this[t];const a=this[t++]>>14,d=o*e+a*n;e=n*e+((16383&d)<<14)+i[s]+r,r=(e>>28)+(d>>14)+o*a,i[s++]=268435455&e}return r},r=28),o.prototype.DB=r,o.prototype.DM=(1<<r)-1,o.prototype.DV=1<<r;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-r,o.prototype.F2=2*r-52;const m=[];let g,y;for(g="0".charCodeAt(0),y=0;y<=9;++y)m[g++]=y;for(g="a".charCodeAt(0),y=10;y<36;++y)m[g++]=y;for(g="A".charCodeAt(0),y=10;y<36;++y)m[g++]=y;function v(t,e){const i=m[t.charCodeAt(e)];return null==i?-1:i}function b(t){const e=u();return e.fromInt(t),e}function w(t){let e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}o.ZERO=b(0),o.ONE=b(1)},1291(t,e){var i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=function(){var t={};return function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;
/**
     * @license
     * Copyright 2009 The Closure Library Authors
     * Copyright 2020 Daniel Wirtz / The long.js Authors.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     *
     * SPDX-License-Identifier: Apache-2.0
     */
var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function i(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function s(t){return!0===(t&&t.__isLong__)}function r(t){var e=Math.clz32(t&-t);return t?31-e:e}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=s;var a={},n={};function o(t,e){var i,s,r;return e?(r=0<=(t>>>=0)&&t<256)&&(s=n[t])?s:(i=c(t,0,!0),r&&(n[t]=i),i):(r=-128<=(t|=0)&&t<128)&&(s=a[t])?s:(i=c(t,t<0?-1:0,!1),r&&(a[t]=i),i)}function d(t,e){if(isNaN(t))return e?b:v;if(e){if(t<0)return b;if(t>=m)return T}else{if(t<=-g)return P;if(t+1>=g)return O}return t<0?d(-t,e).neg():c(t%f|0,t/f|0,e)}function c(t,e,s){return new i(t,e,s)}i.fromInt=o,i.fromNumber=d,i.fromBits=c;var h=Math.pow;function l(t,e,i){if(0===t.length)throw Error("empty string");if("number"==typeof e?(i=e,e=!1):e=!!e,"NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e?b:v;if((i=i||10)<2||36<i)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===s)return l(t.substring(1),e,i).neg();for(var r=d(h(i,8)),a=v,n=0;n<t.length;n+=8){var o=Math.min(8,t.length-n),c=parseInt(t.substring(n,n+o),i);if(o<8){var u=d(h(i,o));a=a.mul(u).add(d(c))}else a=(a=a.mul(r)).add(d(c))}return a.unsigned=e,a}function u(t,e){return"number"==typeof t?d(t,e):"string"==typeof t?l(t,e):c(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}i.fromString=l,i.fromValue=u;var p=65536,f=p*p,m=f*f,g=m/2,y=o(1<<24),v=o(0);i.ZERO=v;var b=o(0,!0);i.UZERO=b;var w=o(1);i.ONE=w;var S=o(1,!0);i.UONE=S;var k=o(-1);i.NEG_ONE=k;var O=c(-1,2147483647,!1);i.MAX_VALUE=O;var T=c(-1,-1,!0);i.MAX_UNSIGNED_VALUE=T;var P=c(0,-2147483648,!1);i.MIN_VALUE=P;var _=i.prototype;_.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},_.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(P)){var e=d(t),i=this.div(e),s=i.mul(e).sub(this);return i.toString(t)+s.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=d(h(t,6),this.unsigned),a=this,n="";;){var o=a.div(r),c=(a.sub(o.mul(r)).toInt()>>>0).toString(t);if((a=o).isZero())return c+n;for(;c.length<6;)c="0"+c;n=""+c+n}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(P)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},_.isSafeInteger=function(){var t=this.high>>21;return!t||!this.unsigned&&-1===t&&!(0===this.low&&-2097152===this.high)},_.isZero=function(){return 0===this.high&&0===this.low},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return!(1&~this.low)},_.isEven=function(){return!(1&this.low)},_.equals=function(t){return s(t)||(t=u(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},_.eq=_.equals,_.notEquals=function(t){return!this.eq(t)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(t){return this.comp(t)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(t){return this.comp(t)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(t){return this.comp(t)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(t){return this.comp(t)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(t){if(s(t)||(t=u(t)),this.eq(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(P)?P:this.not().add(w)},_.neg=_.negate,_.add=function(t){s(t)||(t=u(t));var e=this.high>>>16,i=65535&this.high,r=this.low>>>16,a=65535&this.low,n=t.high>>>16,o=65535&t.high,d=t.low>>>16,h=0,l=0,p=0,f=0;return p+=(f+=a+(65535&t.low))>>>16,l+=(p+=r+d)>>>16,h+=(l+=i+o)>>>16,h+=e+n,c((p&=65535)<<16|(f&=65535),(h&=65535)<<16|(l&=65535),this.unsigned)},_.subtract=function(t){return s(t)||(t=u(t)),this.add(t.neg())},_.sub=_.subtract,_.multiply=function(t){if(this.isZero())return this;if(s(t)||(t=u(t)),e)return c(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return this.unsigned?b:v;if(this.eq(P))return t.isOdd()?P:v;if(t.eq(P))return this.isOdd()?P:v;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(y)&&t.lt(y))return d(this.toNumber()*t.toNumber(),this.unsigned);var i=this.high>>>16,r=65535&this.high,a=this.low>>>16,n=65535&this.low,o=t.high>>>16,h=65535&t.high,l=t.low>>>16,p=65535&t.low,f=0,m=0,g=0,w=0;return g+=(w+=n*p)>>>16,m+=(g+=a*p)>>>16,g&=65535,m+=(g+=n*l)>>>16,f+=(m+=r*p)>>>16,m&=65535,f+=(m+=a*l)>>>16,m&=65535,f+=(m+=n*h)>>>16,f+=i*p+r*l+a*h+n*o,c((g&=65535)<<16|(w&=65535),(f&=65535)<<16|(m&=65535),this.unsigned)},_.mul=_.multiply,_.divide=function(t){if(s(t)||(t=u(t)),t.isZero())throw Error("division by zero");var i,r,a;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:v;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return b;if(t.gt(this.shru(1)))return S;a=b}else{if(this.eq(P))return t.eq(w)||t.eq(k)?P:t.eq(P)?w:(i=this.shr(1).div(t).shl(1)).eq(v)?t.isNegative()?w:k:(r=this.sub(t.mul(i)),a=i.add(r.div(t)));if(t.eq(P))return this.unsigned?b:v;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=v}for(r=this;r.gte(t);){i=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var n=Math.ceil(Math.log(i)/Math.LN2),o=n<=48?1:h(2,n-48),l=d(i),p=l.mul(t);p.isNegative()||p.gt(r);)p=(l=d(i-=o,this.unsigned)).mul(t);l.isZero()&&(l=w),a=a.add(l),r=r.sub(p)}return a},_.div=_.divide,_.modulo=function(t){return s(t)||(t=u(t)),e?c((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return c(~this.low,~this.high,this.unsigned)},_.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},_.clz=_.countLeadingZeros,_.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},_.ctz=_.countTrailingZeros,_.and=function(t){return s(t)||(t=u(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},_.or=function(t){return s(t)||(t=u(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},_.xor=function(t){return s(t)||(t=u(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},_.shiftLeft=function(t){return s(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(t){return s(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(t){return s(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):c(32===t?this.high:this.high>>>t-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.rotateLeft=function(t){var e;return s(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?c(this.high,this.low,this.unsigned):t<32?(e=32-t,c(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(e=32-(t-=32),c(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},_.rotl=_.rotateLeft,_.rotateRight=function(t){var e;return s(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?c(this.high,this.low,this.unsigned):t<32?(e=32-t,c(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(e=32-(t-=32),c(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},_.rotr=_.rotateRight,_.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},_.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},_.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},i.fromBytes=function(t,e,s){return s?i.fromBytesLE(t,e):i.fromBytesBE(t,e)},i.fromBytesLE=function(t,e){return new i(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},i.fromBytesBE=function(t,e){return new i(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)},"function"==typeof BigInt&&(i.fromBigInt=function(t,e){return c(Number(BigInt.asIntN(32,t)),Number(BigInt.asIntN(32,t>>BigInt(32))),e)},i.fromValue=function(t,e){return"bigint"==typeof t?i.fromBigInt(t,e):u(t,e)},_.toBigInt=function(){var t=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|t}),t.default=i}(t),function(t){return t.default||t}(t)}.apply(e,[]),void 0===i||(t.exports=i)},1293(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},1357(t,e,i){"use strict";i.d(e,{sN:()=>r});var s=i(1064);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function r(t){const{t:e,Fp:i,rounds:r,sboxFn:a,reversePartialPowIdx:n}=function(t){const{Fp:e}=t;(0,s.jr)(e);for(const e of["t","roundsFull","roundsPartial"])if("number"!=typeof t[e]||!Number.isSafeInteger(t[e]))throw new Error(`Poseidon: invalid param ${e}=${t[e]} (${typeof t[e]})`);if(void 0!==t.reversePartialPowIdx&&"boolean"!=typeof t.reversePartialPowIdx)throw new Error(`Poseidon: invalid param reversePartialPowIdx=${t.reversePartialPowIdx}`);let i=t.sboxPower;if(void 0===i&&(i=5),"number"!=typeof i||!Number.isSafeInteger(i))throw new Error(`Poseidon wrong sboxPower=${i}`);const r=BigInt(i);let a=t=>(0,s.f4)(e,t,r);if(3===i?a=t=>e.mul(e.sqrN(t),t):5===i&&(a=t=>e.mul(e.sqrN(e.sqrN(t)),t)),t.roundsFull%2!=0)throw new Error(`Poseidon roundsFull is not even: ${t.roundsFull}`);const n=t.roundsFull+t.roundsPartial;if(!Array.isArray(t.roundConstants)||t.roundConstants.length!==n)throw new Error("Poseidon: wrong round constants");const o=t.roundConstants.map(i=>{if(!Array.isArray(i)||i.length!==t.t)throw new Error(`Poseidon wrong round constants: ${i}`);return i.map(t=>{if("bigint"!=typeof t||!e.isValid(t))throw new Error(`Poseidon wrong round constant=${t}`);return e.create(t)})});if(!Array.isArray(t.mds)||t.mds.length!==t.t)throw new Error("Poseidon: wrong MDS matrix");const d=t.mds.map(i=>{if(!Array.isArray(i)||i.length!==t.t)throw new Error(`Poseidon MDS matrix row: ${i}`);return i.map(t=>{if("bigint"!=typeof t)throw new Error(`Poseidon MDS matrix value=${t}`);return e.create(t)})});return Object.freeze({...t,rounds:n,sboxFn:a,roundConstants:o,mds:d})}(t),o=Math.floor(t.roundsFull/2),d=n?e-1:0,c=(e,s,r)=>(e=e.map((e,s)=>i.add(e,t.roundConstants[r][s])),s?e=e.map(t=>a(t)):e[d]=a(e[d]),e=t.mds.map(t=>t.reduce((t,s,r)=>i.add(t,i.mulN(s,e[r])),i.ZERO))),h=function(s){if(!Array.isArray(s)||s.length!==e)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${e})`);s=s.map(t=>{if("bigint"!=typeof t)throw new Error(`Poseidon: wrong value=${t} (${typeof t})`);return i.create(t)});let a=0;for(let t=0;t<o;t++)s=c(s,!0,a++);for(let e=0;e<t.roundsPartial;e++)s=c(s,!1,a++);for(let t=0;t<o;t++)s=c(s,!0,a++);if(a!==r)throw new Error(`Poseidon: wrong number of rounds: last round=${a}, total=${r}`);return s};return h.roundConstants=t.roundConstants,h}},1397(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(3548),r=i(2079),a=i(5147),n=i(1579),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"kucoin",name:"KuCoin",countries:["SC"],rateLimit:10,version:"v2",certified:!0,pro:!0,comment:"Platform 2.0",quoteJsonNumbers:!1,has:{CORS:void 0,spot:!0,margin:!0,swap:!1,future:!1,option:!1,borrowCrossMargin:!0,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelOrder:!0,closeAllPositions:!1,closePosition:!1,createDepositAddress:!0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!0,createMarketSellOrderWithCost:!0,createOrder:!0,createOrders:!0,createPostOnlyOrder:!0,createStopLimitOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTriggerOrder:!0,editOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!0,fetchBorrowRateHistory:!0,fetchClosedOrders:!0,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositWithdrawFee:!0,fetchDepositWithdrawFees:!0,fetchFundingHistory:!1,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!1,fetchIndexOHLCV:!1,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchL3OrderBook:!0,fetchLedger:!0,fetchLeverageTiers:!1,fetchMarginAdjustmentHistory:!1,fetchMarginMode:!1,fetchMarketLeverageTiers:!1,fetchMarkets:!0,fetchMarkOHLCV:!1,fetchMarkPrice:!0,fetchMarkPrices:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!1,fetchOpenInterestHistory:!1,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrdersByStatus:!0,fetchOrderTrades:!0,fetchPositionHistory:!1,fetchPositionMode:!1,fetchPositionsHistory:!1,fetchPremiumIndexOHLCV:!1,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!1,fetchTransactionFee:!0,fetchTransfers:!1,fetchWithdrawals:!0,repayCrossMargin:!0,repayIsolatedMargin:!0,setLeverage:!0,setMarginMode:!1,setPositionMode:!1,signIn:!1,transfer:!0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/51840849/87295558-132aaf80-c50e-11ea-9801-a2fb0c57c799.jpg",referral:"https://www.kucoin.com/ucenter/signup?rcode=E5wkqe",api:{public:"https://api.kucoin.com",private:"https://api.kucoin.com",futuresPrivate:"https://api-futures.kucoin.com",futuresPublic:"https://api-futures.kucoin.com",webExchange:"https://kucoin.com/_api",broker:"https://api-broker.kucoin.com",earn:"https://api.kucoin.com",uta:"https://api.kucoin.com"},www:"https://www.kucoin.com",doc:["https://docs.kucoin.com"]},requiredCredentials:{apiKey:!0,secret:!0,password:!0},api:{public:{get:{currencies:4.5,"currencies/{currency}":4.5,symbols:6,"market/orderbook/level1":3,"market/allTickers":22.5,"market/stats":22.5,markets:4.5,"market/orderbook/level{level}_{limit}":6,"market/orderbook/level2_20":3,"market/orderbook/level2_100":6,"market/histories":4.5,"market/candles":4.5,prices:4.5,timestamp:4.5,status:4.5,"mark-price/{symbol}/current":3,"mark-price/all-symbols":3,"margin/config":25,announcements:20,"margin/collateralRatio":10,"convert/symbol":5,"convert/currencies":5},post:{"bullet-public":15}},private:{get:{"user-info":30,accounts:7.5,"accounts/{accountId}":7.5,"accounts/ledgers":3,"hf/accounts/ledgers":2,"hf/margin/account/ledgers":2,"transaction-history":3,"sub/user":30,"sub-accounts/{subUserId}":22.5,"sub-accounts":30,"sub/api-key":30,"margin/account":40,"margin/accounts":15,"isolated/accounts":15,"deposit-addresses":7.5,deposits:7.5,"hist-deposits":7.5,withdrawals:30,"hist-withdrawals":30,"withdrawals/quotas":30,"accounts/transferable":30,"transfer-list":30,"base-fee":3,"trade-fees":3,"market/orderbook/level{level}":3,"market/orderbook/level2":3,"market/orderbook/level3":3,"hf/accounts/opened":2,"hf/orders/active":2,"hf/orders/active/symbols":2,"hf/margin/order/active/symbols":2,"hf/orders/done":2,"hf/orders/{orderId}":2,"hf/orders/client-order/{clientOid}":2,"hf/orders/dead-cancel-all/query":2,"hf/fills":2,orders:2,"limit/orders":3,"orders/{orderId}":2,"order/client-order/{clientOid}":3,fills:10,"limit/fills":20,"stop-order":8,"stop-order/{orderId}":3,"stop-order/queryOrderByClientOid":3,"oco/order/{orderId}":2,"oco/order/details/{orderId}":2,"oco/client-order/{clientOid}":2,"oco/orders":2,"hf/margin/orders/active":4,"hf/margin/orders/done":10,"hf/margin/orders/{orderId}":4,"hf/margin/orders/client-order/{clientOid}":5,"hf/margin/fills":5,"etf/info":25,"margin/currencies":20,"risk/limit/strategy":20,"isolated/symbols":20,"margin/symbols":5,"isolated/account/{symbol}":50,"margin/borrow":15,"margin/repay":15,"margin/interest":20,"project/list":10,"project/marketInterestRate":7.5,"redeem/orders":10,"purchase/orders":10,"broker/api/rebase/download":3,"broker/queryMyCommission":3,"broker/queryUser":3,"broker/queryDetailByUid":3,"migrate/user/account/status":3,"convert/quote":20,"convert/order/detail":5,"convert/order/history":5,"convert/limit/quote":20,"convert/limit/order/detail":5,"convert/limit/orders":5,"affiliate/inviter/statistics":30},post:{"sub/user/created":22.5,"sub/api-key":30,"sub/api-key/update":45,"deposit-addresses":30,withdrawals:7.5,"accounts/universal-transfer":6,"accounts/sub-transfer":45,"accounts/inner-transfer":15,"transfer-out":30,"transfer-in":30,"hf/orders":1,"hf/orders/test":1,"hf/orders/sync":1,"hf/orders/multi":1,"hf/orders/multi/sync":1,"hf/orders/alter":3,"hf/orders/dead-cancel-all":2,orders:2,"orders/test":2,"orders/multi":3,"stop-order":2,"oco/order":2,"hf/margin/order":5,"hf/margin/order/test":5,"margin/order":5,"margin/order/test":5,"margin/borrow":15,"margin/repay":10,purchase:15,redeem:15,"lend/purchase/update":10,"convert/order":20,"convert/limit/order":20,"bullet-private":10,"position/update-user-leverage":5,"deposit-address/create":20},delete:{"sub/api-key":45,"withdrawals/{withdrawalId}":30,"hf/orders/{orderId}":1,"hf/orders/sync/{orderId}":1,"hf/orders/client-order/{clientOid}":1,"hf/orders/sync/client-order/{clientOid}":1,"hf/orders/cancel/{orderId}":2,"hf/orders":2,"hf/orders/cancelAll":30,"orders/{orderId}":3,"order/client-order/{clientOid}":5,orders:20,"stop-order/{orderId}":3,"stop-order/cancelOrderByClientOid":5,"stop-order/cancel":3,"oco/order/{orderId}":3,"oco/client-order/{clientOid}":3,"oco/orders":3,"hf/margin/orders/{orderId}":5,"hf/margin/orders/client-order/{clientOid}":5,"hf/margin/orders":10,"convert/limit/order/cancel":5}},futuresPublic:{get:{"contracts/active":4.5,"contracts/{symbol}":4.5,ticker:3,"level2/snapshot":4.5,"level2/depth20":7.5,"level2/depth100":15,"trade/history":7.5,"kline/query":4.5,"interest/query":7.5,"index/query":3,"mark-price/{symbol}/current":4.5,"premium/query":4.5,"trade-statistics":4.5,"funding-rate/{symbol}/current":3,"contract/funding-rates":7.5,timestamp:3,status:6,"level2/message/query":1.3953},post:{"bullet-public":15}},futuresPrivate:{get:{"transaction-history":3,"account-overview":7.5,"account-overview-all":9,"transfer-list":30,orders:3,stopOrders:9,recentDoneOrders:7.5,"orders/{orderId}":7.5,"orders/byClientOid":7.5,fills:7.5,recentFills:4.5,openOrderStatistics:15,position:3,positions:3,"margin/maxWithdrawMargin":15,"contracts/risk-limit/{symbol}":7.5,"funding-history":7.5,"copy-trade/futures/get-max-open-size":6,"copy-trade/futures/position/margin/max-withdraw-margin":15},post:{"transfer-out":30,"transfer-in":30,orders:3,"orders/test":3,"orders/multi":4.5,"position/margin/auto-deposit-status":6,"margin/withdrawMargin":15,"position/margin/deposit-margin":6,"position/risk-limit-level/change":6,"copy-trade/futures/orders":3,"copy-trade/futures/orders/test":3,"copy-trade/futures/st-orders":3,"copy-trade/futures/position/margin/deposit-margin":6,"copy-trade/futures/position/margin/withdraw-margin":15,"copy-trade/futures/position/risk-limit-level/change":3,"copy-trade/futures/position/margin/auto-deposit-status":6,"copy-trade/futures/position/changeMarginMode":3,"copy-trade/futures/position/changeCrossUserLeverage":3,"copy-trade/getCrossModeMarginRequirement":4.5,"copy-trade/position/switchPositionMode":3,"bullet-private":15},delete:{"orders/{orderId}":1.5,"orders/client-order/{clientOid}":1.5,orders:45,stopOrders:22.5,"copy-trade/futures/orders":1.5,"copy-trade/futures/orders/client-order":1.5}},webExchange:{get:{"currency/currency/chain-info":1}},broker:{get:{"broker/nd/info":2,"broker/nd/account":2,"broker/nd/account/apikey":2,"broker/nd/rebase/download":3,"asset/ndbroker/deposit/list":1,"broker/nd/transfer/detail":1,"broker/nd/deposit/detail":1,"broker/nd/withdraw/detail":1},post:{"broker/nd/transfer":1,"broker/nd/account":3,"broker/nd/account/apikey":3,"broker/nd/account/update-apikey":3},delete:{"broker/nd/account/apikey":3}},earn:{get:{"otc-loan/discount-rate-configs":10,"otc-loan/loan":1,"otc-loan/accounts":1,"earn/redeem-preview":7.5,"earn/saving/products":7.5,"earn/hold-assets":7.5,"earn/promotion/products":7.5,"earn/kcs-staking/products":7.5,"earn/staking/products":7.5,"earn/eth-staking/products":7.5,"struct-earn/dual/products":4.5,"struct-earn/orders":7.5},post:{"earn/orders":7.5,"struct-earn/orders":7.5},delete:{"earn/orders":7.5}},uta:{get:{"market/announcement":20,"market/currency":3,"market/instrument":4,"market/ticker":15,"market/orderbook":3,"market/trade":3,"market/kline":3,"market/funding-rate":2,"market/funding-rate-history":5,"market/cross-config":25,"server/status":3}}},timeframes:{"1m":"1min","3m":"3min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","8h":"8hour","12h":"12hour","1d":"1day","1w":"1week","1M":"1month"},precisionMode:n.kb,exceptions:{exact:{"Order not exist or not allow to be cancelled":r.OrderNotFound,"The order does not exist.":r.OrderNotFound,"order not exist":r.OrderNotFound,"order not exist.":r.OrderNotFound,order_not_exist:r.OrderNotFound,order_not_exist_or_not_allow_to_cancel:r.InvalidOrder,"Order size below the minimum requirement.":r.InvalidOrder,"Order size increment invalid.":r.InvalidOrder,"The withdrawal amount is below the minimum requirement.":r.ExchangeError,"Unsuccessful! Exceeded the max. funds out-transfer limit":r.InsufficientFunds,"The amount increment is invalid.":r.BadRequest,"The quantity is below the minimum requirement.":r.InvalidOrder,400:r.BadRequest,401:r.AuthenticationError,403:r.NotSupported,404:r.NotSupported,405:r.NotSupported,415:r.NotSupported,429:r.RateLimitExceeded,500:r.ExchangeNotAvailable,503:r.ExchangeNotAvailable,101030:r.PermissionDenied,103e3:r.InvalidOrder,130101:r.BadRequest,130102:r.ExchangeError,130103:r.OrderNotFound,130104:r.ExchangeError,130105:r.InsufficientFunds,130106:r.NotSupported,130107:r.ExchangeError,130108:r.OrderNotFound,130201:r.PermissionDenied,130202:r.ExchangeError,130203:r.InsufficientFunds,130204:r.BadRequest,130301:r.InsufficientFunds,130302:r.PermissionDenied,130303:r.NotSupported,130304:r.NotSupported,130305:r.NotSupported,130306:r.NotSupported,130307:r.NotSupported,130308:r.InvalidOrder,130309:r.InvalidOrder,130310:r.ExchangeError,130311:r.InvalidOrder,130312:r.InvalidOrder,130313:r.InvalidOrder,130314:r.InvalidOrder,130315:r.NotSupported,126e3:r.ExchangeError,126001:r.NotSupported,126002:r.ExchangeError,126003:r.InvalidOrder,126004:r.ExchangeError,126005:r.PermissionDenied,126006:r.ExchangeError,126007:r.ExchangeError,126009:r.ExchangeError,126010:r.ExchangeError,126011:r.ExchangeError,126013:r.InsufficientFunds,126015:r.ExchangeError,126021:r.NotSupported,126022:r.InvalidOrder,126027:r.InvalidOrder,126028:r.InvalidOrder,126029:r.InvalidOrder,126030:r.InvalidOrder,126033:r.InvalidOrder,126034:r.InvalidOrder,126036:r.InvalidOrder,126037:r.ExchangeError,126038:r.ExchangeError,126039:r.ExchangeError,126041:r.ExchangeError,126042:r.ExchangeError,126043:r.OrderNotFound,126044:r.InvalidOrder,126045:r.NotSupported,126046:r.NotSupported,126047:r.PermissionDenied,126048:r.PermissionDenied,135005:r.ExchangeError,135018:r.ExchangeError,200004:r.InsufficientFunds,210014:r.InvalidOrder,210021:r.InsufficientFunds,230003:r.InsufficientFunds,26e4:r.InvalidAddress,260100:r.InsufficientFunds,3e5:r.InvalidOrder,4e5:r.BadSymbol,400001:r.AuthenticationError,400002:r.InvalidNonce,400003:r.AuthenticationError,400004:r.AuthenticationError,400005:r.AuthenticationError,400006:r.AuthenticationError,400007:r.AuthenticationError,400008:r.NotSupported,400100:r.InsufficientFunds,400200:r.InvalidOrder,400330:r.InvalidOrder,400350:r.InvalidOrder,400370:r.InvalidOrder,400400:r.BadRequest,400401:r.AuthenticationError,400500:r.InvalidOrder,400600:r.BadSymbol,400760:r.InvalidOrder,401e3:r.BadRequest,408e3:r.BadRequest,411100:r.AccountSuspended,415e3:r.BadRequest,400303:r.PermissionDenied,5e5:r.ExchangeNotAvailable,260220:r.InvalidAddress,600100:r.InsufficientFunds,600101:r.InvalidOrder,900014:r.BadRequest},broad:{"Exceeded the access frequency":r.RateLimitExceeded,"require more permission":r.PermissionDenied}},fees:{trading:{tierBased:!0,percentage:!0,taker:this.parseNumber("0.001"),maker:this.parseNumber("0.001"),tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.001")],[this.parseNumber("50"),this.parseNumber("0.001")],[this.parseNumber("200"),this.parseNumber("0.0009")],[this.parseNumber("500"),this.parseNumber("0.0008")],[this.parseNumber("1000"),this.parseNumber("0.0007")],[this.parseNumber("2000"),this.parseNumber("0.0007")],[this.parseNumber("4000"),this.parseNumber("0.0006")],[this.parseNumber("8000"),this.parseNumber("0.0005")],[this.parseNumber("15000"),this.parseNumber("0.00045")],[this.parseNumber("25000"),this.parseNumber("0.0004")],[this.parseNumber("40000"),this.parseNumber("0.00035")],[this.parseNumber("60000"),this.parseNumber("0.0003")],[this.parseNumber("80000"),this.parseNumber("0.00025")]],maker:[[this.parseNumber("0"),this.parseNumber("0.001")],[this.parseNumber("50"),this.parseNumber("0.0009")],[this.parseNumber("200"),this.parseNumber("0.0007")],[this.parseNumber("500"),this.parseNumber("0.0005")],[this.parseNumber("1000"),this.parseNumber("0.0003")],[this.parseNumber("2000"),this.parseNumber("0")],[this.parseNumber("4000"),this.parseNumber("0")],[this.parseNumber("8000"),this.parseNumber("0")],[this.parseNumber("15000"),this.parseNumber("-0.00005")],[this.parseNumber("25000"),this.parseNumber("-0.00005")],[this.parseNumber("40000"),this.parseNumber("-0.00005")],[this.parseNumber("60000"),this.parseNumber("-0.00005")],[this.parseNumber("80000"),this.parseNumber("-0.00005")]]}},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}},commonCurrencies:{BIFI:"BIFIF",VAI:"VAIOT",WAX:"WAXP",ALT:"APTOSLAUNCHTOKEN",KALT:"ALT",FUD:"FTX Users' Debt"},options:{hf:void 0,version:"v1",symbolSeparator:"-",fetchMyTradesMethod:"private_get_fills",timeDifference:0,adjustForTimeDifference:!1,fetchCurrencies:{webApiEnable:!0,webApiRetries:1,webApiMuteFailure:!0},fetchMarkets:{fetchTickersFees:!0},withdraw:{includeFee:!1},versions:{public:{GET:{currencies:"v3","currencies/{currency}":"v3",symbols:"v2","mark-price/all-symbols":"v3",announcements:"v3"}},private:{GET:{"user-info":"v2","hf/margin/account/ledgers":"v3","sub/user":"v2","sub-accounts":"v2","margin/accounts":"v3","isolated/accounts":"v3","deposit-addresses":"v1","market/orderbook/level2":"v3","market/orderbook/level3":"v3","market/orderbook/level{level}":"v3","oco/order/{orderId}":"v3","oco/order/details/{orderId}":"v3","oco/client-order/{clientOid}":"v3","oco/orders":"v3","hf/margin/orders/active":"v3","hf/margin/order/active/symbols":"v3","hf/margin/orders/done":"v3","hf/margin/orders/{orderId}":"v3","hf/margin/orders/client-order/{clientOid}":"v3","hf/margin/fills":"v3","etf/info":"v3","margin/currencies":"v3","margin/borrow":"v3","margin/repay":"v3","margin/interest":"v3","project/list":"v3","project/marketInterestRate":"v3","redeem/orders":"v3","purchase/orders":"v3","migrate/user/account/status":"v3","margin/symbols":"v3","affiliate/inviter/statistics":"v2","asset/ndbroker/deposit/list":"v1"},POST:{"sub/user/created":"v2","accounts/universal-transfer":"v3","accounts/sub-transfer":"v2","accounts/inner-transfer":"v2","transfer-out":"v3","deposit-address/create":"v3","oco/order":"v3","hf/margin/order":"v3","hf/margin/order/test":"v3","margin/borrow":"v3","margin/repay":"v3",purchase:"v3",redeem:"v3","lend/purchase/update":"v3","position/update-user-leverage":"v3",withdrawals:"v3"},DELETE:{"hf/margin/orders/{orderId}":"v3","hf/margin/orders/client-order/{clientOid}":"v3","hf/margin/orders":"v3","oco/order/{orderId}":"v3","oco/client-order/{clientOid}":"v3","oco/orders":"v3"}},futuresPrivate:{POST:{"transfer-out":"v3"}}},partner:{spot:{id:"ccxt",key:"9e58cc35-5b5e-4133-92ec-166e3f077cb8"},future:{id:"ccxtfutures",key:"1b327198-f30c-4f14-a0ac-918871282f15"}},accountsByType:{spot:"trade",margin:"margin",cross:"margin",isolated:"isolated",main:"main",funding:"main",future:"contract",swap:"contract",mining:"pool",hf:"trade_hf"},networks:{BRC20:"btc",BTCNATIVESEGWIT:"bech32",ERC20:"eth",TRC20:"trx",HRC20:"heco",MATIC:"matic",KCC:"kcc",SOL:"sol",ALGO:"algo",EOS:"eos",BEP20:"bsc",BEP2:"bnb",ARBONE:"arbitrum",AVAXX:"avax",AVAXC:"avaxc",TLOS:"tlos",CFX:"cfx",ACA:"aca",OPTIMISM:"optimism",ONT:"ont",GLMR:"glmr",CSPR:"cspr",KLAY:"klay",XRD:"xrd",RVN:"rvn",NEAR:"near",APT:"aptos",ETHW:"ethw",TON:"ton",BCH:"bch",BSV:"bchsv",BCHA:"bchabc",OSMO:"osmo",NANO:"nano",XLM:"xlm",VET:"vet",IOST:"iost",ZIL:"zil",XRP:"xrp",TOMO:"tomo",XMR:"xmr",COTI:"coti",XTZ:"xtz",ADA:"ada",WAX:"waxp",THETA:"theta",ONE:"one",IOTEX:"iotx",NULS:"nuls",KSM:"ksm",LTC:"ltc",WAVES:"waves",DOT:"dot",STEEM:"steem",QTUM:"qtum",DOGE:"doge",FIL:"fil",XYM:"xym",FLUX:"flux",ATOM:"atom",XDC:"xdc",KDA:"kda",ICP:"icp",CELO:"celo",LSK:"lsk",VSYS:"vsys",KAR:"kar",XCH:"xch",FLOW:"flow",BAND:"band",EGLD:"egld",HBAR:"hbar",XPR:"xpr",AR:"ar",FTM:"ftm",KAVA:"kava",KMA:"kma",XEC:"xec",IOTA:"iota",HNT:"hnt",ASTR:"astr",PDEX:"pdex",METIS:"metis",ZEC:"zec",POKT:"pokt",OASYS:"oas",OASIS:"oasis",ETC:"etc",AKT:"akt",FSN:"fsn",SCRT:"scrt",CFG:"cfg",ICX:"icx",KMD:"kmd",NEM:"NEM",STX:"stx",DGB:"dgb",DCR:"dcr",CKB:"ckb",ELA:"ela",HYDRA:"hydra",BTM:"btm",KARDIA:"kai",SXP:"sxp",NEBL:"nebl",ZEN:"zen",SDN:"sdn",LTO:"lto",WEMIX:"wemix",EVER:"ever",BNC:"bnc",BNCDOT:"bncdot",AION:"aion",GRIN:"grin",LOKI:"loki",QKC:"qkc",TT:"TT",PIVX:"pivx",SERO:"sero",METER:"meter",STATEMINE:"statemine",DVPN:"dvpn",XPRT:"xprt",MOVR:"movr",ERGO:"ergo",ABBC:"abbc",DIVI:"divi",PURA:"pura",DFI:"dfi",NEON3:"neon3",DOCK:"dock",TRUE:"true",CS:"cs",ORAI:"orai",BASE:"base",TARA:"tara"},marginModes:{cross:"MARGIN_TRADE",isolated:"MARGIN_ISOLATED_TRADE",spot:"TRADE"}},features:{spot:{sandbox:!1,createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:void 0,triggerDirection:!1,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!0},hedged:!1,trailing:!1,leverage:!1,marketBuyByCost:!0,marketBuyRequiresPrice:!1,selfTradePrevention:!0,iceberg:!0},createOrders:{max:5},fetchMyTrades:{marginMode:!0,limit:void 0,daysBack:void 0,untilDays:7,symbolRequired:!0},fetchOrder:{marginMode:!1,trigger:!0,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:500,trigger:!0,trailing:!1,symbolRequired:!0},fetchOrders:void 0,fetchClosedOrders:{marginMode:!0,limit:500,daysBack:void 0,daysBackCanceled:void 0,untilDays:7,trigger:!0,trailing:!1,symbolRequired:!0},fetchOHLCV:{limit:1500}},swap:{linear:void 0,inverse:void 0},future:{linear:void 0,inverse:void 0}}})}nonce(){return this.milliseconds()-this.options.timeDifference}async fetchTime(t={}){const e=await this.publicGetTimestamp(t);return this.safeInteger(e,"data")}async fetchStatus(t={}){let e,i;if([e,t]=this.handleOptionAndParams(t,"fetchStatus","uta",!1),e){const e="spot"===this.safeString(this.options,"defaultType","spot")?"SPOT":"FUTURES",s={tradeType:this.safeStringUpper(t,"tradeType",e)};i=await this.utaGetServerStatus(this.extend(s,t))}else i=await this.publicGetStatus(t);const s=this.safeDict(i,"data",{});return{status:"open"===this.safeString2(s,"status","serverStatus")?"ok":"maintenance",updated:void 0,eta:void 0,url:void 0,info:i}}async fetchMarkets(t={}){let e,i;if([e,t]=this.handleOptionAndParams(t,"fetchMarkets","fetchTickersFees",!0),[i,t]=this.handleOptionAndParams(t,"fetchMarkets","uta",!1),i)return await this.fetchUtaMarkets(t);const s=[];s.push(this.publicGetSymbols(t));const r=this.checkRequiredCredentials(!1),n=r&&this.safeBool(t,"marginables",!0);n&&(s.push(this.privateGetMarginSymbols(t)),s.push(this.privateGetIsolatedSymbols(t))),e&&s.push(this.publicGetMarketAllTickers(t)),r&&s.push(this.loadMigrationStatus());const o=await Promise.all(s),d=this.safeList(o[0],"data"),c=n?this.safeDict(o[1],"data",{}):{},h=this.safeList(c,"items",[]),l=this.indexBy(h,"symbol"),u=n?o[2]:{},p=this.safeList(u,"data",[]),f=this.indexBy(p,"symbol"),m=n?3:1,g=this.safeDict(o,m,{}),y=this.safeList(this.safeDict(g,"data",{}),"ticker",[]),v=this.indexBy(y,"symbol"),b=[];for(let t=0;t<d.length;t++){const e=d[t],i=this.safeString(e,"symbol"),[s,r]=i.split("-"),n=this.safeCurrencyCode(s),o=this.safeCurrencyCode(r),c=this.safeDict(v,i,{}),h=this.safeString(c,"makerFeeRate"),u=this.safeString(c,"takerFeeRate"),p=this.safeString(c,"makerCoefficient"),m=this.safeString(c,"takerCoefficient"),g=i in l,y=i in f,w=this.safeBool(e,"isMarginEnabled",!1)||g||y;b.push({id:i,symbol:n+"/"+o,base:n,quote:o,settle:void 0,baseId:s,quoteId:r,settleId:void 0,type:"spot",spot:!0,margin:w,marginModes:{cross:g,isolated:y},swap:!1,future:!1,option:!1,active:this.safeBool(e,"enableTrading"),contract:!1,linear:void 0,inverse:void 0,taker:this.parseNumber(a.Y.stringMul(u,m)),maker:this.parseNumber(a.Y.stringMul(h,p)),contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(e,"baseIncrement"),price:this.safeNumber(e,"priceIncrement")},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(e,"baseMinSize"),max:this.safeNumber(e,"baseMaxSize")},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(e,"quoteMinSize"),max:this.safeNumber(e,"quoteMaxSize")}},created:void 0,info:e})}return this.options.adjustForTimeDifference&&await this.loadTimeDifference(),b}async fetchUtaMarkets(t={}){const e=[];e.push(this.utaGetMarketInstrument(this.extend(t,{tradeType:"SPOT"}))),e.push(this.utaGetMarketInstrument(this.extend(t,{tradeType:"FUTURES"})));const i=await Promise.all(e),s=this.safeDict(i[0],"data",{}),r=this.safeDict(i[1],"data",{}),a=this.safeList(s,"list",[]),n=this.safeList(r,"list",[]),o=this.arrayConcat(a,n),d=[];for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString(e,"symbol"),s=this.safeString(e,"baseCurrency"),r=this.safeString(e,"quoteCurrency"),a=this.safeString(e,"settlementCurrency"),n=this.safeCurrencyCode(s),c=this.safeCurrencyCode(r),h=this.safeCurrencyCode(a),l="1"===this.safeString(e,"marginMode");let u=n+"/"+c;void 0!==h&&(u+=":"+h);const p=this.safeString(e,"contractType"),f=this.safeInteger(e,"expiryTime"),m=this.safeString(e,"tradingStatus");let g,y=!1,v=!1,b=!1,w=!1,S=!1,k=!1;void 0!==p?(w=!0,c===h?S=!0:k=!0,"0"===p?(g="swap",v=!0):(g="future",b=!0)):(g="spot",y=!0),d.push({id:i,symbol:u,base:n,quote:c,settle:h,baseId:s,quoteId:r,settleId:a,type:g,spot:y,margin:l,swap:v,future:b,option:!1,active:"1"===m,contract:w,linear:S,inverse:k,taker:this.safeNumber(e,"makerFeeRate"),maker:this.safeNumber(e,"takerFeeRate"),contractSize:this.safeNumber(e,"unitSize"),expiry:f,expiryDatetime:this.iso8601(f),strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(e,"lotSize"),price:this.safeNumber(e,"tickSize")},limits:{leverage:{min:void 0,max:this.safeInteger(e,"maxLeverage")},amount:{min:this.safeNumber(e,"minBaseOrderSize"),max:this.safeNumber(e,"maxBaseOrderSize")},price:{min:void 0,max:this.safeNumber(e,"maxPrice")},cost:{min:this.safeNumber(e,"minQuoteOrderSize"),max:this.safeNumber(e,"maxQuoteOrderSize")}},created:this.safeInteger(e,"launchTime"),info:e})}return this.options.adjustForTimeDifference&&await this.loadTimeDifference(),d}async loadMigrationStatus(t=!1){if(!("hf"in this.options)||void 0===this.options.hf||t){const t=await this.privateGetHfAccountsOpened();this.options.hf=this.safeBool(t,"data")}return!0}handleHfAndParams(t={}){const e=this.safeBool(this.options,"hf",!1);let i;void 0!==e&&(i=!!e);return[this.safeBool(t,"hf",i),t=this.omit(t,"hf")]}async fetchCurrencies(t={}){const e=await this.publicGetCurrencies(t),i=this.safeList(e,"data",[]),s=this.safeList(this.options,"brokenCurrencies",["00","OPEN_ERROR","HUF","BDT"]),r={};for(let t=0;t<i.length;t++){const e=i[t],a=this.safeString(e,"currency");if(this.inArray(a,s))continue;const n=this.safeCurrencyCode(a),o={},d=this.safeList(e,"chains",[]),c=d.length;for(let t=0;t<c;t++){const e=d[t],i=this.safeString(e,"chainId"),s=this.networkIdToCode(i,n);o[s]={info:e,id:i,name:this.safeString(e,"chainName"),code:s,active:void 0,fee:this.safeNumber(e,"withdrawalMinFee"),deposit:this.safeBool(e,"isDepositEnabled"),withdraw:this.safeBool(e,"isWithdrawEnabled"),precision:this.parseNumber(this.parsePrecision(this.safeString(e,"withdrawPrecision"))),limits:{withdraw:{min:this.safeNumber(e,"withdrawalMinSize"),max:this.safeNumber(e,"maxWithdraw")},deposit:{min:this.safeNumber(e,"depositMinSize"),max:this.safeNumber(e,"maxDeposit")}}}}const h=this.safeString(e,"precision"),l=this.parseNumber(this.parsePrecision(h)),u=0===c;r[n]=this.safeCurrencyStructure({id:a,name:this.safeString(e,"fullName"),code:n,type:u?"fiat":"crypto",precision:l,info:e,networks:o,deposit:void 0,withdraw:void 0,active:void 0,fee:void 0,limits:void 0})}return r}async fetchAccounts(t={}){const e=await this.privateGetAccounts(t),i=this.safeList(e,"data",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"id"),a=this.safeString(e,"currency"),n=this.safeCurrencyCode(a),o=this.safeString(e,"type");s.push({id:r,type:o,currency:n,code:n,info:e})}return s}async fetchTransactionFee(t,e={}){await this.loadMarkets();const i={currency:this.currency(t).id};let s;[s,e]=this.handleNetworkCodeAndParams(e),void 0!==s&&(i.chain=this.networkCodeToId(s).toLowerCase());const r=await this.privateGetWithdrawalsQuotas(this.extend(i,e)),a=this.safeDict(r,"data",{}),n={};return n[t]=this.safeNumber(a,"withdrawMinFee"),{info:r,withdraw:n,deposit:{}}}async fetchDepositWithdrawFee(t,e={}){await this.loadMarkets();const i=this.currency(t),s={currency:i.id};let r;[r,e]=this.handleNetworkCodeAndParams(e),void 0!==r&&(s.chain=this.networkCodeToId(r).toLowerCase());const a=await this.privateGetWithdrawalsQuotas(this.extend(s,e)),n=this.safeDict(a,"data");return this.parseDepositWithdrawFee(n,i)}parseDepositWithdrawFee(t,e=void 0){if("chains"in t){const i={info:t,withdraw:{fee:void 0,percentage:!1},deposit:{fee:void 0,percentage:void 0},networks:{}},s=this.safeList(t,"chains",[]);for(let t=0;t<s.length;t++){const r=s[t],a=this.networkIdToCode(this.safeString(r,"chainId"),this.safeString(e,"code"));i.networks[a]={withdraw:{fee:this.safeNumber2(r,"withdrawalMinFee","withdrawMinFee"),percentage:!1},deposit:{fee:void 0,percentage:void 0}}}return i}const i=this.safeNumber(t,"withdrawMinFee"),s={info:t,withdraw:{fee:i,percentage:!1},deposit:{fee:void 0,percentage:void 0},networks:{}},r=this.safeString(t,"chain"),a=this.networkIdToCode(r,this.safeString(e,"code"));return s.networks[a]={withdraw:i,deposit:{fee:void 0,percentage:void 0}},s}isFuturesMethod(t,e){const i=this.safeString2(this.options,t,"defaultType","trade"),s=this.safeString(e,"type",i),a=this.safeDict(this.options,"accountsByType"),n=this.safeString(a,s);if(void 0===n){const t=Object.keys(a);throw new r.ExchangeError(this.id+" isFuturesMethod() type must be one of "+t.join(", "))}return e=this.omit(e,"type"),"contract"===n||"future"===n||"futures"===n}parseTicker(t,e=void 0){let i=this.safeString(t,"changeRate");void 0!==i&&(i=a.Y.stringMul(i,"100"));let s=this.safeStringN(t,["last","lastTradedPrice","lastPrice"]);s=this.safeString(t,"price",s);const r=this.safeString(t,"symbol"),n=(e=this.safeMarket(r,e,"-")).symbol,o=this.safeString2(t,"vol","baseVolume"),d=this.safeString2(t,"volValue","quoteVolume"),c=this.safeIntegerN(t,["time","datetime","timePoint"]);return this.safeTicker({symbol:n,timestamp:c,datetime:this.iso8601(c),high:this.safeString(t,"high"),low:this.safeString(t,"low"),bid:this.safeStringN(t,["buy","bestBid","bestBidPrice"]),bidVolume:this.safeString(t,"bestBidSize"),ask:this.safeStringN(t,["sell","bestAsk","bestAskPrice"]),askVolume:this.safeString(t,"bestAskSize"),vwap:void 0,open:this.safeString(t,"open"),close:s,last:s,previousClose:void 0,change:this.safeString(t,"changePrice"),percentage:i,average:this.safeString(t,"averagePrice"),baseVolume:o,quoteVolume:d,markPrice:this.safeString(t,"value"),info:t},e)}async fetchTickers(t=void 0,e={}){await this.loadMarkets();const i={};let s,a;if(t=this.marketSymbols(t),[s,e]=this.handleOptionAndParams(e,"fetchTickers","uta",!1),s){if(void 0!==t){const s=this.safeString(t,0),r=this.market(s);let a;[a,e]=this.handleMarketTypeAndParams("fetchTickers",r,e),i.tradeType="spot"===a?"SPOT":"FUTURES"}else{const t=this.safeStringUpper(e,"tradeType");if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchTickers() requires a tradeType parameter for uta, either SPOT or FUTURES");i.tradeType=t,e=this.omit(e,"tradeType")}a=await this.utaGetMarketTicker(this.extend(i,e))}else a=await this.publicGetMarketAllTickers(e);const n=this.safeDict(a,"data",{}),o=this.safeList2(n,"ticker","list",[]),d=this.safeInteger2(n,"time","ts"),c={};for(let t=0;t<o.length;t++){o[t].time=d;const e=this.parseTicker(o[t]),i=this.safeString(e,"symbol");void 0!==i&&(c[i]=e)}return this.filterByArrayTickers(c,"symbol",t)}async fetchMarkPrices(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=await this.publicGetMarkPriceAllSymbols(e),s=this.safeList(i,"data",[]);return this.parseTickers(s)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r,a,n;if([r,e]=this.handleOptionAndParams(e,"fetchTicker","uta",!1),r){let t;[t,e]=this.handleMarketTypeAndParams("fetchTicker",i,e),s.tradeType="spot"===t?"SPOT":"FUTURES",a=await this.utaGetMarketTicker(this.extend(s,e));const r=this.safeDict(a,"data",{}),o=this.safeList(r,"list",[]);n=this.safeDict(o,0,{})}else a=await this.publicGetMarketStats(this.extend(s,e)),n=this.safeDict(a,"data",{});return this.parseTicker(n,i)}async fetchMarkPrice(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.publicGetMarkPriceSymbolCurrent(this.extend(s,e)),a=this.safeDict(r,"data",{});return this.parseTicker(a,i)}parseOHLCV(t,e=void 0){return[this.safeTimestamp(t,0),this.safeNumber(t,1),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,2),this.safeNumber(t,5)]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();let a=!1;if([a,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate"),a)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,1500);const n=this.market(t),o={symbol:n.id},d=1e3*this.parseTimeframe(e);let c,h,l,u=this.milliseconds();if(void 0!==i?(o.startAt=this.parseToInt(Math.floor(i/1e3)),void 0===s&&(s=this.safeInteger(this.options,"fetchOHLCVLimit",1500)),u=this.sum(i,s*d)):void 0!==s&&(i=u-s*d,o.startAt=this.parseToInt(Math.floor(i/1e3))),o.endAt=this.parseToInt(Math.floor(u/1e3)),[c,r]=this.handleOptionAndParams(r,"fetchOHLCV","uta",!1),c){let t;[t,r]=this.handleMarketTypeAndParams("fetchOHLCV",n,r),o.tradeType="spot"===t?"SPOT":"FUTURES",o.interval=this.safeString(this.timeframes,e,e),h=await this.utaGetMarketKline(this.extend(o,r));const i=this.safeDict(h,"data",{});l=this.safeList(i,"list",[])}else o.type=this.safeString(this.timeframes,e,e),h=await this.publicGetMarketCandles(this.extend(o,r)),l=this.safeList(h,"data",[]);return this.parseOHLCVs(l,n,e,i,s)}async createDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s={currency:i.id};let r;[r,e]=this.handleNetworkCodeAndParams(e),void 0!==r&&(s.chain=this.networkCodeToId(r));const a=await this.privatePostDepositAddressCreate(this.extend(s,e)),n=this.safeDict(a,"data",{});return this.parseDepositAddress(n,i)}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s={currency:i.id};let a;[a,e]=this.handleNetworkCodeAndParams(e),void 0!==a&&(s.chain=this.networkCodeToId(a).toLowerCase());const n=this.options.versions.private.GET["deposit-addresses"];this.options.versions.private.GET["deposit-addresses"]="v1";const o=await this.privateGetDepositAddresses(this.extend(s,e));this.options.versions.private.GET["deposit-addresses"]=n;const d=this.safeValue(o,"data");if(void 0===d)throw new r.ExchangeError(this.id+" fetchDepositAddress() returned an empty response, you might try to run createDepositAddress() first and try again");return this.parseDepositAddress(d,i)}parseDepositAddress(t,e=void 0){let i,s=this.safeString(t,"address");return void 0!==s&&(s=s.replace("bitcoincash:","")),void 0!==e&&(i=this.safeCurrencyCode(e.id),"NIM"!==i&&this.checkAddress(s)),{info:t,currency:i,network:this.networkIdToCode(this.safeString(t,"chainId")),address:s,tag:this.safeString(t,"memo")}}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();const i=this.currency(t),s={currency:i.id},r=this.options.versions.private.GET["deposit-addresses"];this.options.versions.private.GET["deposit-addresses"]="v2";const a=await this.privateGetDepositAddresses(this.extend(s,e));this.options.versions.private.GET["deposit-addresses"]=r;const n=this.safeList(a,"data",[]),o=this.parseDepositAddresses(n,[i.code],!1,{currency:i.code});return this.indexBy(o,"network")}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),a=this.safeInteger(i,"level",2),n={symbol:s.id},o=this.checkRequiredCredentials(!1);let d,c;if([d,i]=this.handleOptionAndParams(i,"fetchOrderBook","uta",!1),d){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrderBook() requires a limit argument for uta, either 20, 50, 100 or FULL");let t;n.limit=e,n.symbol=s.id,[t,i]=this.handleMarketTypeAndParams("fetchOrderBook",s,i),n.tradeType="spot"===t?"SPOT":"FUTURES",c=await this.utaGetMarketOrderbook(this.extend(n,i))}else if(o&&void 0===e)c=await this.privateGetMarketOrderbookLevel2(this.extend(n,i));else{if(2===a){if(n.level=a,void 0!==e){if(20!==e&&100!==e)throw new r.ExchangeError(this.id+" fetchOrderBook() limit argument must be 20 or 100");n.limit=e}n.limit=e||100}c=await this.publicGetMarketOrderbookLevelLevelLimit(this.extend(n,i))}const h=this.safeDict(c,"data",{}),l=this.safeInteger(h,"time"),u=this.parseOrderBook(h,s.symbol,l,"bids","asks",a-2,a-1);return u.nonce=this.safeInteger(h,"sequence"),u}handleTriggerPrices(t){const e=this.safeValue2(t,"triggerPrice","stopPrice"),i=this.safeValue(t,"stopLossPrice"),s=this.safeValue(t,"takeProfitPrice"),a=void 0!==s;if(void 0!==i&&a||e&&i||e&&a)throw new r.ExchangeError(this.id+" createOrder() - you should use either triggerPrice or stopLossPrice or takeProfitPrice");return[e,i,s]}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=this.safeBool(a,"test",!1);let d;a=this.omit(a,"test"),[d,a]=this.handleHfAndParams(a);let c=!1;[c,a]=this.handleOptionAndParams(a,"createOrder","sync",!1);const[h,l,u]=this.handleTriggerPrices(a),p=this.safeString(a,"tradeType"),f=h||l||u,m=this.handleMarginModeAndParams("createOrder",a),g=this.safeString(m,0),y="MARGIN_TRADE"===p||void 0!==g,v=this.createOrderRequest(t,e,i,s,r,a);let b;b=o?y?await this.privatePostMarginOrderTest(v):d?await this.privatePostHfOrdersTest(v):await this.privatePostOrdersTest(v):f?await this.privatePostStopOrder(v):y?await this.privatePostMarginOrder(v):c?await this.privatePostHfOrdersSync(v):d?await this.privatePostHfOrders(v):await this.privatePostOrders(v);const w=this.safeDict(b,"data",{});return this.parseOrder(w,n)}async createMarketOrderWithCost(t,e,i,s={}){await this.loadMarkets();const r={cost:i};return await this.createOrder(t,"market",e,i,void 0,this.extend(r,s))}async createMarketBuyOrderWithCost(t,e,i={}){return await this.loadMarkets(),await this.createMarketOrderWithCost(t,"buy",e,i)}async createMarketSellOrderWithCost(t,e,i={}){return await this.loadMarkets(),await this.createMarketOrderWithCost(t,"sell",e,i)}async createOrders(t,e={}){await this.loadMarkets();const i=[];let s;for(let e=0;e<t.length;e++){const a=t[e],n=this.safeString(a,"symbol");if(void 0===s)s=n;else if(s!==n)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const o=this.safeString(a,"type");if("limit"!==o)throw new r.BadRequest(this.id+" createOrders() only supports limit orders");const d=this.safeString(a,"side"),c=this.safeValue(a,"amount"),h=this.safeValue(a,"price"),l=this.safeValue(a,"params",{}),u=this.createOrderRequest(n,o,d,c,h,l);i.push(u)}const a={symbol:this.market(s).id,orderList:i};let n;[n,e]=this.handleHfAndParams(e);let o,d=!1;[d,e]=this.handleOptionAndParams(e,"createOrders","sync",!1),o=d?await this.privatePostHfOrdersMultiSync(this.extend(a,e)):n?await this.privatePostHfOrdersMulti(this.extend(a,e)):await this.privatePostOrdersMulti(this.extend(a,e));let c=this.safeDict(o,"data",{});return c=this.safeList(c,"data",[]),this.parseOrders(c)}marketOrderAmountToPrecision(t,e){const i=this.market(t),s=this.decimalToPrecision(e,n.R3,i.info.quoteIncrement,this.precisionMode,this.paddingMode);if("0"===s)throw new r.InvalidOrder(this.id+" amount of "+i.symbol+" must be greater than minimum amount precision of "+this.numberToString(i.precision.amount));return s}createOrderRequest(t,e,i,s,a=void 0,n={}){const o=this.market(t),d=this.safeString2(n,"clientOid","clientOrderId",this.uuid());n=this.omit(n,["clientOid","clientOrderId"]);const c={clientOid:d,side:i,symbol:o.id,type:e},h=this.safeNumber2(n,"cost","funds");let l,u,p;[p,n]=this.handleMarginModeAndParams("createOrder",n),"market"===e?void 0!==h?(n=this.omit(n,["cost","funds"]),u=this.marketOrderAmountToPrecision(t,h),c.funds=u):(l=this.amountToPrecision(t,s),c.size=this.amountToPrecision(t,s)):(l=this.amountToPrecision(t,s),c.size=l,c.price=this.priceToPrecision(t,a));const f=this.safeString(n,"tradeType"),[m,g,y]=this.handleTriggerPrices(n),v=m||g||y,b="MARGIN_TRADE"===f||void 0!==p;if(n=this.omit(n,["stopLossPrice","takeProfitPrice","triggerPrice","stopPrice"]),v){if(m?c.stopPrice=this.priceToPrecision(t,m):(g||y)&&(g?(c.stop="buy"===i?"entry":"loss",c.stopPrice=this.priceToPrecision(t,g)):(c.stop="buy"===i?"loss":"entry",c.stopPrice=this.priceToPrecision(t,y))),"isolated"===p)throw new r.BadRequest(this.id+" createOrder does not support isolated margin for stop orders");"cross"===p&&(c.tradeType=this.options.marginModes[p])}else b&&"isolated"===p&&(c.marginModel="isolated");let w;return[w,n]=this.handlePostOnly("market"===e,!1,n),w&&(c.postOnly=!0),this.extend(c,n)}async editOrder(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.market(e),d={symbol:o.id},c=this.safeString2(n,"clientOid","clientOrderId");void 0!==c?d.clientOid=c:d.orderId=t,void 0!==r&&(d.newSize=this.amountToPrecision(e,r)),void 0!==a&&(d.newPrice=this.priceToPrecision(e,a));const h=await this.privatePostHfOrdersAlter(this.extend(d,n)),l=this.safeDict(h,"data",{});return this.parseOrder(l,o)}async cancelOrder(t,e=void 0,i={}){await this.loadMarkets();const s={},a=this.safeString2(i,"clientOid","clientOrderId"),n=this.safeBool2(i,"stop","trigger",!1);let o;[o,i]=this.handleHfAndParams(i);let d,c=!1;if([c,i]=this.handleOptionAndParams(i,"cancelOrder","sync",!1),o||c){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol parameter for hf orders");const t=this.market(e);s.symbol=t.id}if(i=this.omit(i,["clientOid","clientOrderId","stop","trigger"]),void 0!==a)return s.clientOid=a,d=n?await this.privateDeleteStopOrderCancelOrderByClientOid(this.extend(s,i)):c?await this.privateDeleteHfOrdersSyncClientOrderClientOid(this.extend(s,i)):o?await this.privateDeleteHfOrdersClientOrderClientOid(this.extend(s,i)):await this.privateDeleteOrderClientOrderClientOid(this.extend(s,i)),d=this.safeDict(d,"data"),this.parseOrder(d);{if(s.orderId=t,n)d=await this.privateDeleteStopOrderOrderId(this.extend(s,i));else if(c)d=await this.privateDeleteHfOrdersSyncOrderId(this.extend(s,i));else{if(o)return d=await this.privateDeleteHfOrdersOrderId(this.extend(s,i)),d=this.safeDict(d,"data"),this.parseOrder(d);d=await this.privateDeleteOrdersOrderId(this.extend(s,i))}const e=this.safeDict(d,"data"),r=this.safeList(e,"cancelledOrderIds",[]),a=this.safeString(r,0);return this.safeOrder({info:e,id:a})}}async cancelAllOrders(t=void 0,e={}){await this.loadMarkets();const i={},s=this.safeBool2(e,"trigger","stop",!1);let a;[a,e]=this.handleHfAndParams(e),e=this.omit(e,"stop");const[n,o]=this.handleMarginModeAndParams("cancelAllOrders",e);if(void 0!==t&&(i.symbol=this.marketId(t)),void 0!==n&&(i.tradeType=this.options.marginModes[n],"isolated"===n&&s))throw new r.BadRequest(this.id+" cancelAllOrders does not support isolated margin for stop orders");let d;return d=s?await this.privateDeleteStopOrderCancel(this.extend(i,o)):a?void 0===t?await this.privateDeleteHfOrdersCancelAll(this.extend(i,o)):await this.privateDeleteHfOrders(this.extend(i,o)):await this.privateDeleteOrders(this.extend(i,o)),[this.safeOrder({info:d})]}async fetchOrdersByStatus(t,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();let n=t.toLowerCase();const o=this.safeInteger(a,"until"),d=this.safeBool2(a,"stop","trigger",!1);let c;if([c,a]=this.handleHfAndParams(a),c&&void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrdersByStatus() requires a symbol parameter for hf orders");a=this.omit(a,["stop","trigger","till","until"]);const[h,l]=this.handleMarginModeAndParams("fetchOrdersByStatus",a);"open"===n?n="active":"closed"===n&&(n="done");const u={status:n};let p,f;void 0!==e&&(p=this.market(e),u.symbol=p.id),void 0!==i&&(u.startAt=i),void 0!==s&&(u.pageSize=s),o&&(u.endAt=o),u.tradeType=this.safeString(this.options.marginModes,h,"TRADE"),d?f=await this.privateGetStopOrder(this.extend(u,l)):c?"active"===n?f=await this.privateGetHfOrdersActive(this.extend(u,l)):"done"===n&&(f=await this.privateGetHfOrdersDone(this.extend(u,l))):f=await this.privateGetOrders(this.extend(u,l));const m=this.safeList(f,"data");if(void 0!==m)return this.parseOrders(m,p,i,s);const g=this.safeDict(f,"data",{}),y=this.safeList(g,"items",[]);return this.parseOrders(y,p,i,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;return[r,s]=this.handleOptionAndParams(s,"fetchClosedOrders","paginate"),r?await this.fetchPaginatedCallDynamic("fetchClosedOrders",t,e,i,s):await this.fetchOrdersByStatus("done",t,e,i,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;return[r,s]=this.handleOptionAndParams(s,"fetchOpenOrders","paginate"),r?await this.fetchPaginatedCallDynamic("fetchOpenOrders",t,e,i,s):await this.fetchOrdersByStatus("active",t,e,i,s)}async fetchOrder(t,e=void 0,i={}){await this.loadMarkets();const s={},a=this.safeString2(i,"clientOid","clientOrderId"),n=this.safeBool2(i,"stop","trigger",!1);let o,d,c;if([o,i]=this.handleHfAndParams(i),void 0!==e&&(d=this.market(e)),o){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol parameter for hf orders");s.symbol=d.id}if(i=this.omit(i,["stop","clientOid","clientOrderId","trigger"]),void 0!==a)s.clientOid=a,n?(void 0!==e&&(s.symbol=d.id),c=await this.privateGetStopOrderQueryOrderByClientOid(this.extend(s,i))):c=o?await this.privateGetHfOrdersClientOrderClientOid(this.extend(s,i)):await this.privateGetOrderClientOrderClientOid(this.extend(s,i));else{if(void 0===t)throw new r.InvalidOrder(this.id+" fetchOrder() requires an order id");s.orderId=t,c=n?await this.privateGetStopOrderOrderId(this.extend(s,i)):o?await this.privateGetHfOrdersOrderId(this.extend(s,i)):await this.privateGetOrdersOrderId(this.extend(s,i))}let h=this.safeDict(c,"data",{});return Array.isArray(h)&&(h=this.safeValue(h,0)),this.parseOrder(h,d)}parseOrder(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeInteger(t,"createdAt"),r=this.safeString(t,"feeCurrency"),a=this.safeBool(t,"cancelExist",!1),n=void 0!==this.safeString(t,"stop"),o=this.safeBool(t,"stopTriggered",!1),d=this.safeBool2(t,"isActive","active"),c=this.safeString(t,"status");let h;return void 0!==d&&(h=!0===d?"open":"closed"),n&&("NEW"===c?h="open":d||o||(h="cancelled")),a&&(h="canceled"),"fail"===c&&(h="rejected"),this.safeOrder({info:t,id:this.safeStringN(t,["id","orderId","newOrderId","cancelledOrderId"]),clientOrderId:this.safeString(t,"clientOid"),symbol:this.safeSymbol(i,e,"-"),type:this.safeString(t,"type"),timeInForce:this.safeString(t,"timeInForce"),postOnly:this.safeBool(t,"postOnly"),side:this.safeString(t,"side"),amount:this.safeString(t,"size"),price:this.safeString(t,"price"),triggerPrice:this.safeNumber(t,"stopPrice"),cost:this.safeString(t,"dealFunds"),filled:this.safeString(t,"dealSize"),remaining:void 0,timestamp:s,datetime:this.iso8601(s),fee:{currency:this.safeCurrencyCode(r),cost:this.safeNumber(t,"fee")},status:h,lastTradeTimestamp:void 0,average:this.safeString(t,"avgDealPrice"),trades:void 0},e)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){const a={orderId:t};return await this.fetchMyTrades(e,i,s,this.extend(a,r))}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),a)return await this.fetchPaginatedCallDynamic("fetchMyTrades",t,e,i,s);let n,o,d={};if([n,s]=this.handleHfAndParams(s),n&&void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol parameter for hf orders");void 0!==t&&(o=this.market(t),d.symbol=o.id);const c=this.options.fetchMyTradesMethod;let h,l=!1;if([d,s]=this.handleUntilOption("endAt",d,s),n)void 0!==i&&(d.limit=i),void 0!==e&&(d.startAt=e),h=await this.privateGetHfFills(this.extend(d,s));else if("private_get_fills"===c)void 0!==e&&(d.startAt=e),h=await this.privateGetFills(this.extend(d,s));else{if("private_get_limit_fills"!==c)throw new r.ExchangeError(this.id+" fetchMyTradesMethod() invalid method");l=!0,h=await this.privateGetLimitFills(this.extend(d,s))}const u=this.safeDict(h,"data",{});let p;return p=l?u:this.safeList(u,"items",[]),this.parseTrades(p,o,e,i)}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),a={symbol:r.id};let n,o,d;if([n,s]=this.handleOptionAndParams(s,"fetchTrades","uta",!1),n){let t;[t,s]=this.handleMarketTypeAndParams("fetchTrades",r,s),a.tradeType="spot"===t?"SPOT":"FUTURES",o=await this.utaGetMarketTrade(this.extend(a,s));const e=this.safeDict(o,"data",{});d=this.safeList(e,"list",[])}else o=await this.publicGetMarketHistories(this.extend(a,s)),d=this.safeList(o,"data",[]);return this.parseTrades(d,r,e,i)}parseTrade(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e,"-");const s=this.safeString2(t,"tradeId","id"),r=this.safeString(t,"orderId"),a=this.safeString(t,"liquidity");let n=this.safeInteger2(t,"time","ts");void 0!==n?n=this.parseToInt(n/1e6):(n=this.safeInteger(t,"createdAt"),"dealValue"in t&&void 0!==n&&(n*=1e3));const o=this.safeString2(t,"price","dealPrice"),d=this.safeString2(t,"size","amount"),c=this.safeString(t,"side");let h;const l=this.safeString(t,"fee");if(void 0!==l){const i=this.safeString(t,"feeCurrency");let s=this.safeCurrencyCode(i);void 0===s&&(s="sell"===c?e.quote:e.base),h={cost:l,currency:s,rate:this.safeString(t,"feeRate")}}let u=this.safeString(t,"type");"match"===u&&(u=void 0);const p=this.safeString2(t,"funds","dealValue");return this.safeTrade({info:t,id:s,order:r,timestamp:n,datetime:this.iso8601(n),symbol:e.symbol,type:u,takerOrMaker:a,side:c,price:o,amount:d,cost:p,fee:h},e)}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbols:i.id},r=await this.privateGetTradeFees(this.extend(s,e)),a=this.safeList(r,"data",[]),n=this.safeDict(a,0),o=this.safeString(n,"symbol");return{info:r,symbol:this.safeSymbol(o,i),maker:this.safeNumber(n,"makerFeeRate"),taker:this.safeNumber(n,"takerFeeRate"),percentage:!0,tierBased:!0}}async withdraw(t,e,i,s=void 0,r={}){[s,r]=this.handleWithdrawTagAndParams(s,r),await this.loadMarkets(),this.checkAddress(i);const a=this.currency(t),n={currency:a.id,toAddress:i,withdrawType:"ADDRESS"};let o,d;void 0!==s&&(n.memo=s),[o,r]=this.handleNetworkCodeAndParams(r),void 0!==o&&(n.chain=this.networkCodeToId(o).toLowerCase()),n.amount=parseFloat(this.currencyToPrecision(t,e,o)),[d,r]=this.handleOptionAndParams(r,"withdraw","includeFee",!1),d&&(n.feeDeductType="INTERNAL");const c=await this.privatePostWithdrawals(this.extend(n,r)),h=this.safeDict(c,"data",{});return this.parseTransaction(h,a)}parseTransactionStatus(t){return this.safeString({SUCCESS:"ok",PROCESSING:"pending",WALLET_PROCESSING:"pending",FAILURE:"failed"},t,t)}parseTransaction(t,e=void 0){const i=this.safeString(t,"currency"),s=this.safeCurrencyCode(i,e);let r=this.safeString(t,"address");const n=this.safeString(t,"amount");let o=this.safeString(t,"walletTxId");if(void 0!==o){const t=o.split("@");t.length>1&&void 0===r&&t[1].length>1&&(r=t[1]),o=t[0]}let d=void 0===o?"withdrawal":"deposit";const c=this.safeString(t,"status");let h;const l=this.safeString(t,"fee");if(void 0!==l){let t;void 0!==n&&(t=a.Y.stringDiv(l,n)),h={cost:this.parseNumber(l),rate:this.parseNumber(t),currency:s}}let u=this.safeInteger2(t,"createdAt","createAt"),p=this.safeInteger(t,"updatedAt");!("createdAt"in t)&&(d="address"in t?"withdrawal":"deposit",void 0!==u&&(u*=1e3),void 0!==p&&(p*=1e3));const f=this.safeBool(t,"isInner"),m=this.safeString(t,"memo");return{info:t,id:this.safeString2(t,"id","withdrawalId"),timestamp:u,datetime:this.iso8601(u),network:this.networkIdToCode(this.safeString(t,"chain")),address:r,addressTo:r,addressFrom:void 0,tag:m,tagTo:m,tagFrom:void 0,currency:s,amount:this.parseNumber(n),txid:o,type:d,status:this.parseTransactionStatus(c),comment:this.safeString(t,"remark"),internal:f,fee:h,updated:p}}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchDeposits",t,e,i,s);let a,n,o={};void 0!==t&&(a=this.currency(t),o.currency=a.id),void 0!==i&&(o.pageSize=i),[o,s]=this.handleUntilOption("endAt",o,s),void 0!==e&&e<1550448e6?(o.startAt=this.parseToInt(e/1e3),n=await this.privateGetHistDeposits(this.extend(o,s))):(void 0!==e&&(o.startAt=e),n=await this.privateGetDeposits(this.extend(o,s)));const d=this.safeDict(n,"data",{}),c=this.safeList(d,"items",[]);return this.parseTransactions(c,a,e,i,{type:"deposit"})}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchWithdrawals",t,e,i,s);let a,n,o={};void 0!==t&&(a=this.currency(t),o.currency=a.id),void 0!==i&&(o.pageSize=i),[o,s]=this.handleUntilOption("endAt",o,s),void 0!==e&&e<1550448e6?(o.startAt=this.parseToInt(e/1e3),n=await this.privateGetHistWithdrawals(this.extend(o,s))):(void 0!==e&&(o.startAt=e),n=await this.privateGetWithdrawals(this.extend(o,s)));const d=this.safeDict(n,"data",{}),c=this.safeList(d,"items",[]);return this.parseTransactions(c,a,e,i,{type:"withdrawal"})}parseBalanceHelper(t){const e=this.account();e.used=this.safeString2(t,"holdBalance","hold"),e.free=this.safeString2(t,"availableBalance","available"),e.total=this.safeString2(t,"totalBalance","total");const i=this.safeString(t,"liability"),s=this.safeString(t,"interest");return e.debt=a.Y.stringAdd(i,s),e}async fetchBalance(t={}){await this.loadMarkets();const e=this.safeString(t,"code");let i;void 0!==e&&(i=this.currency(e));const s=this.safeString2(this.options,"fetchBalance","defaultType","spot"),r=this.safeString(t,"type",s),a=this.safeDict(this.options,"accountsByType");let n,o=this.safeString(a,r,r);t=this.omit(t,"type"),[n,t]=this.handleHfAndParams(t),n&&"main"!==o&&(o="trade_hf");const[d,c]=this.handleMarginModeAndParams("fetchBalance",t);let h;const l={},u="isolated"===d||"isolated"===o,p="cross"===d||"margin"===o;let f;u?(void 0!==i&&(l.balanceCurrency=i.id),h=await this.privateGetIsolatedAccounts(this.extend(l,c))):p?h=await this.privateGetMarginAccount(this.extend(l,c)):(void 0!==i&&(l.currency=i.id),l.type=o,h=await this.privateGetAccounts(this.extend(l,c)));const m={info:h,timestamp:void 0,datetime:void 0};if(u){f=this.safeDict(h,"data",{});const t=this.safeValue(f,"assets",f);for(let e=0;e<t.length;e++){const i=t[e],s=this.safeString(i,"symbol"),r=this.safeSymbol(s,void 0,"_"),a=this.safeDict(i,"baseAsset",{}),n=this.safeDict(i,"quoteAsset",{}),o=this.safeCurrencyCode(this.safeString(a,"currency")),d=this.safeCurrencyCode(this.safeString(n,"currency")),c={};c[o]=this.parseBalanceHelper(a),c[d]=this.parseBalanceHelper(n),m[r]=this.safeBalance(c)}}else if(p){f=this.safeDict(h,"data",{});const t=this.safeList(f,"accounts",[]);for(let e=0;e<t.length;e++){const i=t[e],s=this.safeString(i,"currency");m[this.safeCurrencyCode(s)]=this.parseBalanceHelper(i)}}else{f=this.safeList(h,"data",[]);for(let t=0;t<f.length;t++){const e=f[t];if(this.safeString(e,"type")===o){const t=this.safeString(e,"currency"),i=this.safeCurrencyCode(t),s=this.account();s.total=this.safeString(e,"balance"),s.free=this.safeString(e,"available"),s.used=this.safeString(e,"holds"),m[i]=s}}}let g=m;return u||(g=this.safeBalance(m)),g}async transfer(t,e,i,s,a={}){await this.loadMarkets();const n=this.currency(t),o=this.currencyToPrecision(t,e);let d=this.convertTypeToAccount(i),c=this.convertTypeToAccount(s);const h=this.inArray(d,this.ids),l=this.inArray(c,this.ids);if("contract"===d){if("main"!==c)throw new r.ExchangeError(this.id+" transfer() only supports transferring from futures account to main account");const t={currency:n.id,amount:o};"bizNo"in a||(t.bizNo=this.uuid22());const e=await this.futuresPrivatePostTransferOut(this.extend(t,a)),i=this.safeDict(e,"data");return this.parseTransfer(i,n)}{const t={currency:n.id,amount:o};(h||l)&&(this.inArray(d,this.ids)&&(t.fromTag=d,d="isolated"),this.inArray(c,this.ids)&&(t.toTag=c,c="isolated")),t.from=d,t.to=c,"clientOid"in a||(t.clientOid=this.uuid());const e=await this.privatePostAccountsInnerTransfer(this.extend(t,a)),i=this.safeDict(e,"data");return this.parseTransfer(i,n)}}parseTransfer(t,e=void 0){const i=this.safeInteger(t,"createdAt"),s=this.safeString(t,"currency"),r=this.safeString(t,"status"),a=this.safeStringLower(t,"payAccountType"),n=this.safeStringLower(t,"recAccountType"),o=this.safeDict(this.options,"accountsByType"),d=this.safeString(o,a,a),c=this.safeString(o,n,n);return{id:this.safeString2(t,"applyId","orderId"),currency:this.safeCurrencyCode(s,e),timestamp:i,datetime:this.iso8601(i),amount:this.safeNumber(t,"amount"),fromAccount:d,toAccount:c,status:this.parseTransferStatus(r),info:t}}parseTransferStatus(t){return this.safeString({PROCESSING:"pending"},t,t)}parseLedgerEntryType(t){return this.safeString({"Assets Transferred in After Upgrading":"transfer",Deposit:"transaction",Withdrawal:"transaction",Transfer:"transfer",Trade_Exchange:"trade","KuCoin Bonus":"bonus","Referral Bonus":"referral",Rewards:"bonus","Airdrop/Fork":"airdrop","Other rewards":"bonus","Fee Rebate":"rebate","Buy Crypto":"trade","Sell Crypto":"sell","Public Offering Purchase":"trade","Refunded Fees":"fee","KCS Pay Fees":"fee","Margin Trade":"trade",Loans:"Loans","Instant Exchange":"trade","Sub-account transfer":"transfer","Liquidation Fees":"fee"},t,t)}parseLedgerEntry(t,e=void 0){const i=this.safeString(t,"id"),s=this.safeString(t,"currency"),r=this.safeCurrencyCode(s,e);e=this.safeCurrency(s,e);const a=this.safeNumber(t,"amount"),n=this.safeString(t,"bizType"),o=this.parseLedgerEntryType(n),d=this.safeString(t,"direction"),c=this.safeInteger(t,"createdAt"),h=this.iso8601(c),l=this.safeString(t,"accountType"),u=this.safeString(t,"context");let p,f;if(void 0!==u&&""!==u)try{const t=JSON.parse(u),e=this.safeString(t,"orderId"),i=this.safeString(t,"tradeId");p=void 0!==i?i:e}catch(t){p=u}const m=this.safeString(t,"fee");let g;return"0"!==m&&(g=r,f={cost:this.parseNumber(m),currency:g}),this.safeLedgerEntry({info:t,id:i,direction:d,account:l,referenceId:p,referenceAccount:l,type:o,currency:r,amount:a,timestamp:c,datetime:h,before:void 0,after:undefined,status:void 0,fee:f},e)}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets(),await this.loadAccounts();let r,a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),[r,s]=this.handleHfAndParams(s),a)return await this.fetchPaginatedCallDynamic("fetchLedger",t,e,i,s);let n,o,d,c={};void 0!==e&&(c.startAt=e),void 0!==t&&(n=this.currency(t),c.currency=n.id),[c,s]=this.handleUntilOption("endAt",c,s),[o,s]=this.handleMarginModeAndParams("fetchLedger",s),d=r?void 0!==o?await this.privateGetHfMarginAccountLedgers(this.extend(c,s)):await this.privateGetHfAccountsLedgers(this.extend(c,s)):await this.privateGetAccountsLedgers(this.extend(c,s));const h=this.safeList(d,"data");if(void 0!==h)return this.parseLedger(h,n,e,i);const l=this.safeDict(d,"data"),u=this.safeList(l,"items",[]);return this.parseLedger(u,n,e,i)}calculateRateLimiterCost(t,e,i,s,r={}){const a=this.safeDict(this.options,"versions",{}),n=this.safeDict(a,t,{}),o=this.safeDict(n,e,{}),d=this.safeString(o,i,this.options.version),c=this.safeString(s,"version",d);return"v3"===c&&"v3"in r?r.v3:"v2"===c&&"v2"in r?r.v2:"v1"===c&&"v1"in r?r.v1:this.safeValue(r,"cost",1)}parseBorrowRate(t,e=void 0){const i=this.safeString2(t,"createdAt","timestamp"),s=this.parseToInt(i.slice(0,13)),r=this.safeString(t,"currency");return{currency:this.safeCurrencyCode(r,e),rate:this.safeNumber2(t,"dailyIntRate","dayRatio"),period:864e5,timestamp:s,datetime:this.iso8601(s),info:t}}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),[a,r]=this.handleMarginModeAndParams("fetchBorrowInterest",r,"cross");const n={};let o,d,c;void 0!==t&&(o=this.currency(t),"isolated"===a?n.balanceCurrency=o.id:n.quoteCurrency=o.id),void 0!==e&&(d=this.market(e)),c="isolated"===a?await this.privateGetIsolatedAccounts(this.extend(n,r)):await this.privateGetMarginAccounts(this.extend(n,r));const h=this.safeDict(c,"data",{}),l="isolated"===a?this.safeList(h,"assets",[]):this.safeList(h,"accounts",[]),u=this.parseBorrowInterests(l,d),p=this.filterByCurrencySinceLimit(u,t,i,s);return this.filterBySymbolSinceLimit(p,e,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"symbol"),s=void 0===i?"cross":"isolated";e=this.safeMarket(i,e);const r=this.safeString(e,"symbol"),a=this.safeInteger(t,"createdAt"),n=this.safeDict(t,"baseAsset",{});let o,d,c;return"isolated"===s?(o=this.safeNumber(n,"liability"),d=this.safeNumber(n,"interest"),c=this.safeString(n,"currency")):(o=this.safeNumber(t,"liability"),d=this.safeNumber(t,"accruedInterest"),c=this.safeString(t,"currency")),{info:t,symbol:r,currency:this.safeCurrencyCode(c),interest:d,interestRate:this.safeNumber(t,"dailyIntRate"),amountBorrowed:o,marginMode:s,timestamp:a,datetime:this.iso8601(a)}}async fetchBorrowRateHistories(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.handleMarginModeAndParams("fetchBorrowRateHistories",s);let a={isIsolated:"isolated"===this.safeString(r,0,"cross")};void 0!==e&&(a.startTime=e),[a,s]=this.handleUntilOption("endTime",a,s),void 0!==i&&(a.pageSize=i);const n=await this.privateGetMarginInterest(this.extend(a,s)),o=this.safeDict(n,"data"),d=this.safeList(o,"items",[]);return this.parseBorrowRateHistories(d,t,e,i)}async fetchBorrowRateHistory(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.handleMarginModeAndParams("fetchBorrowRateHistories",s);let a={isIsolated:"isolated"===this.safeString(r,0,"cross"),currency:this.currency(t).id};void 0!==e&&(a.startTime=e),[a,s]=this.handleUntilOption("endTime",a,s),void 0!==i&&(a.pageSize=i);const n=await this.privateGetMarginInterest(this.extend(a,s)),o=this.safeDict(n,"data"),d=this.safeList(o,"items",[]);return this.parseBorrowRateHistory(d,t,e,i)}parseBorrowRateHistories(t,e,i,s){const r={};for(let i=0;i<t.length;i++){const s=t[i],a=this.safeCurrencyCode(this.safeString(s,"currency"));if(void 0===e||this.inArray(a,e)){a in r||(r[a]=[]);const t=this.parseBorrowRate(s);r[a].push(t)}}const a=Object.keys(r);for(let t=0;t<a.length;t++){const e=a[t];r[e]=this.filterByCurrencySinceLimit(r[e],e,i,s)}return r}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={currency:s.id,size:this.currencyToPrecision(t,e),timeInForce:"FOK"},a=await this.privatePostMarginBorrow(this.extend(r,i)),n=this.safeDict(a,"data",{});return this.parseMarginLoan(n,s)}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a=this.currency(e),n={currency:a.id,size:this.currencyToPrecision(e,i),symbol:r.id,timeInForce:"FOK",isIsolated:!0},o=await this.privatePostMarginBorrow(this.extend(n,s)),d=this.safeDict(o,"data",{});return this.parseMarginLoan(d,a)}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={currency:s.id,size:this.currencyToPrecision(t,e)},a=await this.privatePostMarginRepay(this.extend(r,i)),n=this.safeDict(a,"data",{});return this.parseMarginLoan(n,s)}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a=this.currency(e),n={currency:a.id,size:this.currencyToPrecision(e,i),symbol:r.id,isIsolated:!0},o=await this.privatePostMarginRepay(this.extend(n,s)),d=this.safeDict(o,"data",{});return this.parseMarginLoan(d,a)}parseMarginLoan(t,e=void 0){const i=this.milliseconds(),s=this.safeString(t,"currency");return{id:this.safeString(t,"orderNo"),currency:this.safeCurrencyCode(s,e),amount:this.safeNumber(t,"actualSize"),symbol:void 0,timestamp:i,datetime:this.iso8601(i),info:t}}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.publicGetCurrencies(e),s=this.safeList(i,"data",[]);return this.parseDepositWithdrawFees(s,t,"currency")}async setLeverage(t,e=void 0,i={}){let s,a,n;if(await this.loadMarkets(),[a,i]=this.handleMarketTypeAndParams("setLeverage",void 0,i),(void 0!==e||"spot"!==a)&&(s=this.market(e),s.contract))throw new r.NotSupported(this.id+" setLeverage currently supports only spot margin");if([n,i]=this.handleMarginModeAndParams("setLeverage",i),void 0===n)throw new r.ArgumentsRequired(this.id+" setLeverage requires a marginMode parameter");const o={};if("isolated"===n&&void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage requires a symbol parameter for isolated margin");return void 0!==e&&(o.symbol=s.id),o.leverage=t.toString(),o.isIsolated="isolated"===n,await this.privatePostPositionUpdateUserLeverage(this.extend(o,i))}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.utaGetMarketFundingRate(this.extend(s,e)),a=this.safeDict(r,"data",{});return this.parseFundingRate(a,i)}parseFundingRate(t,e=void 0){const i=this.safeInteger(t,"fundingTime"),s=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(s,e,void 0,"contract"),markPrice:void 0,indexPrice:void 0,interestRate:void 0,estimatedSettlePrice:void 0,timestamp:void 0,datetime:void 0,fundingRate:this.safeNumber(t,"nextFundingRate"),fundingTimestamp:i,fundingDatetime:this.iso8601(i),nextFundingRate:void 0,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:void 0}}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a since argument");await this.loadMarkets();const a=this.market(t),n={symbol:a.id},o=this.safeInteger(s,"until");s=this.omit(s,"until"),void 0!==e&&(n.startAt=e,void 0===o&&(n.endAt=this.milliseconds())),void 0!==o&&(n.endAt=o);const d=await this.utaGetMarketFundingRateHistory(this.extend(n,s)),c=this.safeDict(d,"data",{}),h=this.safeList(c,"list",[]);return this.parseFundingRateHistories(h,a,e,i)}parseFundingRateHistory(t,e=void 0){const i=this.safeInteger(t,"ts");return{info:t,symbol:this.safeSymbol(void 0,e),fundingRate:this.safeNumber(t,"fundingRate"),timestamp:i,datetime:this.iso8601(i)}}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){const n=this.safeDict(this.options,"versions",{}),d=this.safeDict(n,e,{}),c=this.safeDict(d,i,{}),h=this.safeString(c,t,this.options.version),l=this.safeString(s,"version",h);s=this.omit(s,"version");let u="/api/"+l+"/"+this.implodeParams(t,s);"webExchange"===e&&(u="/"+this.implodeParams(t,s)),"earn"===e&&(u="/api/v1/"+this.implodeParams(t,s));let p=!1;"uta"===e&&(u="/api/ua/v1/"+this.implodeParams(t,s),"market/orderbook"===t&&(p=!0));const f=this.omit(s,this.extractParams(t));let m="";r=void 0!==r?r:{};let g=this.urls.api[e];this.isEmpty(f)||("GET"!==i&&"DELETE"!==i||"orders/multi-cancel"===t?(m=a=this.json(f),r["Content-Type"]="application/json"):u+="?"+this.rawencode(f)),g+=u;const y="futuresPrivate"===e,v="broker"===e;if("private"===e||y||v||"earn"===e||p){this.checkRequiredCredentials();const t=this.nonce().toString();r=this.extend({"KC-API-KEY-VERSION":"2","KC-API-KEY":this.apiKey,"KC-API-TIMESTAMP":t},r);if("2"===this.safeString(r,"KC-API-KEY-VERSION")){const t=this.hmac(this.encode(this.password),this.encode(this.secret),o.s,"base64");r["KC-API-PASSPHRASE"]=t}else r["KC-API-PASSPHRASE"]=this.password;const e=t+i+u+m,s=this.hmac(this.encode(e),this.encode(this.secret),o.s,"base64");r["KC-API-SIGN"]=s;let a=this.safeDict(this.options,"partner",{});a=y?this.safeValue(a,"future",a):this.safeValue(a,"spot",a);const n=this.safeString(a,"id"),d=this.safeString2(a,"secret","key");if(void 0!==n&&void 0!==d){const e=t+n+this.apiKey,i=this.hmac(this.encode(e),this.encode(d),o.s,"base64");r["KC-API-PARTNER-SIGN"]=i,r["KC-API-PARTNER"]=n,r["KC-API-PARTNER-VERIFY"]="true"}if(v){const t=this.safeString(a,"name");void 0!==t&&(r["KC-BROKER-NAME"]=t)}}return{url:g,method:i,body:a,headers:r}}handleErrors(t,e,i,s,a,n,o,d,c){if(!o)return void this.throwBroadlyMatchedException(this.exceptions.broad,n,n);const h=this.safeString(o,"code"),l=this.safeString2(o,"msg","data",""),u=this.id+" "+n;if(this.throwExactlyMatchedException(this.exceptions.exact,l,u),this.throwExactlyMatchedException(this.exceptions.exact,h,u),this.throwBroadlyMatchedException(this.exceptions.broad,n,u),"200000"!==h&&"200"!==h)throw new r.ExchangeError(u)}}},1417(t,e,i){"use strict";i.d(e,{Ay:()=>d,MV:()=>o,_J:()=>a,j1:()=>n});var s=String.prototype.replace,r=/%20/g,a={RFC1738:function(t){return s.call(t,r,"+")},RFC3986:function(t){return t}},n="RFC1738",o="RFC3986";const d="RFC3986"},1420(t,e,i){"use strict";i.d(e,{MR:()=>o,SP:()=>h,bJ:()=>a,dd:()=>d,gk:()=>l,vA:()=>n});var s=i(9654);function r(t){if(null==t)return"null";if(Array.isArray(t))return"[ "+t.map(r).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let i="0x";for(let s=0;s<t.length;s++)i+=e[t[s]>>4],i+=e[15&t[s]];return i}if("object"==typeof t&&"function"==typeof t.toJSON)return r(t.toJSON());switch(typeof t){case"boolean":case"symbol":case"number":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const e=Object.keys(t);return e.sort(),"{ "+e.map(e=>`${r(e)}: ${r(t[e])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function a(t,e){return t&&t.code===e}function n(t,e,i,a){if(!t)throw function(t,e,i){let a,n=t;{const s=[];if(i){if("message"in i||"code"in i||"name"in i)throw new Error(`value will overwrite populated values: ${r(i)}`);for(const t in i){if("shortMessage"===t)continue;const e=i[t];s.push(t+"="+r(e))}}s.push(`code=${e}`),s.length&&(t+=" ("+s.join(", ")+")")}switch(e){case"INVALID_ARGUMENT":a=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":a=new RangeError(t);break;default:a=new Error(t)}return(0,s.n)(a,{code:e}),i&&Object.assign(a,i),null==a.shortMessage&&(0,s.n)(a,{shortMessage:n}),a}(e,i,a)}function o(t,e,i,s){n(t,e,"INVALID_ARGUMENT",{argument:i,value:s})}function d(t,e,i){null==i&&(i=""),i&&(i=": "+i),n(t>=e,"missing arguemnt"+i,"MISSING_ARGUMENT",{count:t,expectedCount:e}),n(t<=e,"too many arguemnts"+i,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}const c=["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){const t=String.fromCharCode(233).normalize("NFD");if(t!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(t){}return t},[]);function h(t){n(c.indexOf(t)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:t}})}function l(t,e,i){if(null==i&&(i=""),t!==e){let t=i,e="new";i&&(t+=".",e+=" "+i),n(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}},1475(t,e,i){"use strict";i.d(e,{p:()=>h});var s=i(1768),r=i(9654),a=i(9073),n=i(4176);const o=BigInt(0),d=BigInt(1),c=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class h extends n.Ue{constructor(t,e,i){const s=(e?"int":"uint")+8*t;super(s,s,i,!1),(0,r.n)(this,{size:t,signed:e},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let i=(0,s.Ab)(a.V.dereference(e,this.type)),r=(0,s.dK)(c,8*n.Yx);if(this.signed){let t=(0,s.dK)(r,8*this.size-1);(i>t||i<-(t+d))&&this._throwError("value out-of-bounds",e),i=(0,s.JJ)(i,8*n.Yx)}else(i<o||i>(0,s.dK)(r,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(i)}decode(t){let e=(0,s.dK)(t.readValue(),8*this.size);return this.signed&&(e=(0,s.ST)(e,8*this.size)),e}}},1579(t,e,i){"use strict";i.d(e,{D_:()=>r,Iu:()=>v,NZ:()=>g,R3:()=>s,S2:()=>u,Tz:()=>a,Ye:()=>S,_g:()=>n,ex:()=>l,fq:()=>b,fv:()=>o,kb:()=>c,um:()=>f,v:()=>d,w1:()=>h,xv:()=>y});const s=0,r=1,a=2,n=3,o=2,d=3,c=4,h=5,l=6,u={ROUND:r,TRUNCATE:s,ROUND_UP:a,ROUND_DOWN:n,DECIMAL_PLACES:o,SIGNIFICANT_DIGITS:d,TICK_SIZE:c,NO_PADDING:h,PAD_WITH_ZERO:l},p=(t,e)=>{if(!t)throw new Error(e||"assertion failed")};function f(t){if(void 0===t)return;if("number"!=typeof t)return t.toString();const e=t.toString();if(Math.abs(t)<1){const i=e.split("e-"),s=i[0].replace(".",""),r=parseInt(i[1]),a="-"===e[0];if(r)return t=(a?"-":"")+"0."+new Array(r).join("0")+s.substring(a)}else{const t=e.split("e");if(t[1]){let e=parseInt(t[1]);const i=t[0].split(".");let s="";return i[1]&&(e-=i[1].length,s=i[1]),i[0]+s+new Array(e+1).join("0")}}return e}const m=[],g=(t,e=0)=>{if(t=f(t),e>0){const i=m[e]||(m[e]=new RegExp("([-]*\\d+\\.\\d{"+e+"})(\\d)")),[,s]=t.toString().match(i)||[null,t];return s.toString()}return parseInt(t).toString()},y=(t,e=0)=>parseFloat(g(t,e));function v(t){if(t.indexOf("e")>-1||t.indexOf("E")>-1){const e=t.replace(/\d\.?\d*[eE]/,"");return-1*parseInt(e)}const e=t.replace(/0+$/g,"").split(".");return e.length>1?e[1].length:0}const b=(t,e,i,s=o,r=h)=>w(t,e,i,s,r),w=(t,e,i,a=o,n=h)=>{if(p(void 0!==i,"numPrecisionDigits should not be undefined"),"string"==typeof i&&(i=parseFloat(i)),p(Number.isFinite(i),"numPrecisionDigits has an invalid number"),a===c?p(i>0,"negative or zero numPrecisionDigits can not be used with TICK_SIZE precisionMode"):p(Number.isInteger(i),"numPrecisionDigits must be an integer with DECIMAL_PLACES or SIGNIFICANT_DIGITS precisionMode"),p(e===r||e===s,"invalid roundingMode provided"),p(a===o||a===d||a===c,"invalid countingMode provided"),p(n===h||n===l,"invalid paddingMode provided"),i<0){const o=Math.pow(10,-i);if(e===r)return(o*w(t/o,e,0,a,n)).toString();if(e===s)return(t-t%o).toString()}if(a===c){const a=v(w(i,r,22,o,h));if(e===s){const e=f(t),s=g(e,Math.max(0,a)),d=Number(s),c=Math.pow(10,a),l=Math.round(d*c),u=Math.round(i*c);return t=Math.trunc(l/u)*u/c,n===h?String(Number(t.toFixed(a))):w(t,r,a,o,n)}let d=t%i;d=Number(w(d,r,8,o,h));return 0!==v(w(d/i,r,Math.max(a,8),o,h))&&e===r&&(t>0?d>=i/2?t=t-d+i:t-=d:t=d>=i/2?Number(t)-d:Number(t)-d-i),w(t,r,a,o,n)}const u=f(t),m="-"===u[0],y=m?1:0,b=u.length;for(var S=0;S<b&&"."!==u[S];S++);const k=S<u.length,O=48,T=new Uint8Array(b-y+(k?0:1));T[0]=O;let P=T.length,_=-1,A=-1;for(var I=1,x=y;x<b;x++,I++){const t=u.charCodeAt(x);if(46===t)P=I--;else{if(t<O||t>57)throw new Error(`${u}: invalid number (contains an illegal character '${u[I-1]}')`);T[I]=t,t!==O&&_<0&&(_=I)}}_<0&&(_=1);let E=a===o?P:_,M=E+i;A=-1;let C=!0,B=m;for(let t=T.length-1,s=0;t>=0;t--){let a=T[t];if(0!==t){if(a+=s,t>=E+i){a=e===r&&a>=53&&!(53===a&&s)?58:O}a>57?(a=O,s=1):s=0}else s&&(a=49);T[t]=a,a!==O&&(C=!1,_=t,A=A<0?t+1:A)}a===d&&(E=_,M=E+i),C&&(B=!1);const N=_>=P||C?P-1:_,R=A<P?P:A,L=B?1:0,D=L+(P-N),q=Math.max(R-P,0),F=R-N,V=n===h?F:M-N,U=Math.max(V-F,0),j=D+1+q,G=j+U,H=q+U===0,W=new Uint8Array(D+(H?0:1)+q+U);for(B&&(W[0]=45),I=L,x=N;I<D;I++,x++)W[I]=T[x];for(H||(W[D]=46),I=D+1,x=P;I<j;I++,x++)W[I]=T[x];for(I=j;I<G;I++)W[I]=O;return String.fromCharCode(...W)};function S(t){try{if(void 0===t||""===t)return;if(0===parseFloat(t))return;return t}catch(e){return t}}},1591(t){"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},1668(t,e,i){"use strict";var s;i.d(e,{B:()=>s,G:()=>r}),function(t){t[t.Ok=0]="Ok",t[t.Err=1]="Err"}(s||(s={}));class r{constructor(t,e){if(!(t in s))throw new Error("Wrong variant : should be CairoResultVariant.Ok or .Err.");t===s.Ok?(this.Ok=e,this.Err=void 0):(this.Ok=void 0,this.Err=e)}unwrap(){if(void 0!==this.Ok)return this.Ok;if(void 0!==this.Err)return this.Err;throw new Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return!(void 0===this.Ok)}isErr(){return!(void 0===this.Err)}}},1677(t,e,i){"use strict";i.d(e,{j:()=>r});var s=i(4176);class r extends s.Ue{constructor(t){super(t.name,t.type,"_",t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}},1686(t,e,i){"use strict";i.d(e,{A6:()=>d,Dg:()=>a,Et:()=>c,Lm:()=>h,nj:()=>o,qv:()=>r,sI:()=>n});var s=i(178);function r(t){return/^0x[0-9a-f]*$/i.test(t)}function a(t){return BigInt(t)}function n(t){return"bigint"==typeof t}function o(t){return(0,s.VO)(a(t).toString(16))}const d=t=>/^\d+$/.test(t);function c(t){return"number"==typeof t}function h(t){return"boolean"==typeof t}},1768(t,e,i){"use strict";i.d(e,{Ab:()=>l,Dg:()=>f,JJ:()=>c,Ro:()=>g,ST:()=>d,WZ:()=>m,c4:()=>v,dK:()=>h,nD:()=>b,up:()=>y});var s=i(3867),r=i(1420);const a=BigInt(0),n=BigInt(1),o=9007199254740991;function d(t,e){const i=u(t,"value"),s=BigInt(m(e,"width"));if((0,r.vA)(i>>s===a,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),i>>s-n){return-((~i&(n<<s)-n)+n)}return i}function c(t,e){let i=l(t,"value");const s=BigInt(m(e,"width")),o=n<<s-n;if(i<a){i=-i,(0,r.vA)(i<=o,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return(~i&(n<<s)-n)+n}return(0,r.vA)(i<o,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),i}function h(t,e){const i=u(t,"value"),s=BigInt(m(e,"bits"));return i&(n<<s)-n}function l(t,e){switch(typeof t){case"bigint":return t;case"number":return(0,r.MR)(Number.isInteger(t),"underflow",e||"value",t),(0,r.MR)(t>=-o&&t<=o,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(i){(0,r.MR)(!1,`invalid BigNumberish string: ${i.message}`,e||"value",t)}}(0,r.MR)(!1,"invalid BigNumberish value",e||"value",t)}function u(t,e){const i=l(t,e);return(0,r.vA)(i>=a,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),i}const p="0123456789abcdef";function f(t){if(t instanceof Uint8Array){let e="0x0";for(const i of t)e+=p[i>>4],e+=p[15&i];return BigInt(e)}return l(t)}function m(t,e){switch(typeof t){case"bigint":return(0,r.MR)(t>=-o&&t<=o,"overflow",e||"value",t),Number(t);case"number":return(0,r.MR)(Number.isInteger(t),"underflow",e||"value",t),(0,r.MR)(t>=-o&&t<=o,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return m(BigInt(t),e)}catch(i){(0,r.MR)(!1,`invalid numeric string: ${i.message}`,e||"value",t)}}(0,r.MR)(!1,"invalid numeric value",e||"value",t)}function g(t){return m(f(t))}function y(t,e){let i=u(t,"value").toString(16);if(null==e)i.length%2&&(i="0"+i);else{const s=m(e,"width");for((0,r.vA)(2*s>=i.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});i.length<2*s;)i="0"+i}return"0x"+i}function v(t){const e=u(t,"value");if(e===a)return new Uint8Array([]);let i=e.toString(16);i.length%2&&(i="0"+i);const s=new Uint8Array(i.length/2);for(let t=0;t<s.length;t++){const e=2*t;s[t]=parseInt(i.substring(e,e+2),16)}return s}function b(t){let e=(0,s.c$)((0,s.f)(t)?t:v(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return""===e&&(e="0"),"0x"+e}},1838(t,e,i){"use strict";i.d(e,{Jt:()=>c}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var s,r=i(1291),a=i.n(r);!function(t){t[t.STATUS_UNSPECIFIED=0]="STATUS_UNSPECIFIED",t[t.STATUS_ACTIVE=1]="STATUS_ACTIVE",t[t.STATUS_PAUSED=2]="STATUS_PAUSED",t[t.STATUS_CANCEL_ONLY=3]="STATUS_CANCEL_ONLY",t[t.STATUS_POST_ONLY=4]="STATUS_POST_ONLY",t[t.STATUS_INITIALIZING=5]="STATUS_INITIALIZING",t[t.STATUS_FINAL_SETTLEMENT=6]="STATUS_FINAL_SETTLEMENT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(s||(s={}));const n={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.perpetualId&&e.uint32(8).uint32(t.perpetualId),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={perpetualId:0};for(;i.pos<s;){const t=i.uint32();if(t>>>3==1)r.perpetualId=i.uint32();else i.skipType(7&t)}return r},fromPartial(t){const e={perpetualId:0};return e.perpetualId=t.perpetualId??0,e}};const o={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.baseAssetId&&e.uint32(8).uint32(t.baseAssetId),0!==t.quoteAssetId&&e.uint32(16).uint32(t.quoteAssetId),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={baseAssetId:0,quoteAssetId:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.baseAssetId=i.uint32();break;case 2:r.quoteAssetId=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={baseAssetId:0,quoteAssetId:0};return e.baseAssetId=t.baseAssetId??0,e.quoteAssetId=t.quoteAssetId??0,e}};function d(){return{id:0,perpetualClobMetadata:void 0,spotClobMetadata:void 0,stepBaseQuantums:a().UZERO,subticksPerTick:0,quantumConversionExponent:0,status:0}}const c={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.id&&e.uint32(8).uint32(t.id),void 0!==t.perpetualClobMetadata&&n.encode(t.perpetualClobMetadata,e.uint32(18).fork()).ldelim(),void 0!==t.spotClobMetadata&&o.encode(t.spotClobMetadata,e.uint32(26).fork()).ldelim(),t.stepBaseQuantums.isZero()||e.uint32(32).uint64(t.stepBaseQuantums),0!==t.subticksPerTick&&e.uint32(40).uint32(t.subticksPerTick),0!==t.quantumConversionExponent&&e.uint32(48).sint32(t.quantumConversionExponent),0!==t.status&&e.uint32(56).int32(t.status),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=d();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.id=i.uint32();break;case 2:r.perpetualClobMetadata=n.decode(i,i.uint32());break;case 3:r.spotClobMetadata=o.decode(i,i.uint32());break;case 4:r.stepBaseQuantums=i.uint64();break;case 5:r.subticksPerTick=i.uint32();break;case 6:r.quantumConversionExponent=i.sint32();break;case 7:r.status=i.int32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=d();return e.id=t.id??0,e.perpetualClobMetadata=void 0!==t.perpetualClobMetadata&&null!==t.perpetualClobMetadata?n.fromPartial(t.perpetualClobMetadata):void 0,e.spotClobMetadata=void 0!==t.spotClobMetadata&&null!==t.spotClobMetadata?o.fromPartial(t.spotClobMetadata):void 0,e.stepBaseQuantums=void 0!==t.stepBaseQuantums&&null!==t.stepBaseQuantums?a().fromValue(t.stepBaseQuantums):a().UZERO,e.subticksPerTick=t.subticksPerTick??0,e.quantumConversionExponent=t.quantumConversionExponent??0,e.status=t.status??0,e}}},1878(t,e,i){"use strict";i.d(e,{E:()=>k});var s=i(8325),r=i(162),a=i(9550),n=i(2256),o=i(9793),d=i(9491),c=i(8354),h=i(1686),l=i(7925);const u={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},p={[r.K.Active]:{domain:"StarknetDomain",hashMethod:d.dl,hashMerkleMethod:d.h$,escapeTypeString:t=>`"${t}"`,presetTypes:u},[r.K.Legacy]:{domain:"StarkNetDomain",hashMethod:d.ez,hashMerkleMethod:d.CL,escapeTypeString:t=>t,presetTypes:{}}};function f(t,e,{min:i,max:s}){const r=BigInt(t);(0,a.A)(r>=i&&r<=s,`${r} (${e}) is out of bounds [${i}, ${s}]`)}function m({types:t,domain:e}){return p[r.K.Active].domain in t&&e.revision===r.K.Active?r.K.Active:p[r.K.Legacy].domain in t&&(e.revision??r.K.Legacy)===r.K.Legacy?r.K.Legacy:void 0}function g(t){try{return(0,h.nj)(t)}catch(e){if((0,l.Kg)(t))return(0,h.nj)((0,l.Mu)(t));throw new Error(`Invalid BigNumberish: ${t}`)}}function y(t,e,i=[],s="",a=r.K.Legacy){return"*"===e[e.length-1]?e=e.slice(0,-1):a===r.K.Active&&("enum"===e?e=s:e.match(/^\(.*\)$/)&&(e=e.slice(1,-1))),i.includes(e)||!t[e]?i:[e,...t[e].reduce((e,i)=>[...e,...y(t,i.type,e,i.contains,a).filter(t=>!e.includes(t))],[])]}function v(t,e,i=r.K.Legacy){const s=i===r.K.Active?{...t,...p[i].presetTypes}:t,[a,...n]=y(s,e,void 0,void 0,i),o=a?[a,...n.sort()]:[],d=p[i].escapeTypeString;return o.map(t=>{const e=s[t].map(t=>{const e="enum"===t.type&&i===r.K.Active?t.contains:t.type,s=e.match(/^\(.*\)$/)?`(${e.slice(1,-1).split(",").map(t=>t?d(t):t).join(",")})`:d(e);return`${d(t.name)}:${s}`});return`${d(t)}(${e})`}).join("")}function b(t,e,i=r.K.Legacy){return(0,o.BK)(v(t,e,i))}function w(t,e,i,d={},l=r.K.Legacy){if(t[e])return[e,S(t,e,i,l)];if(p[l].presetTypes[e])return[e,S(p[l].presetTypes,e,i,l)];if(e.endsWith("*")){const s=i.map(i=>w(t,e.slice(0,-1),i,void 0,l)[1]);return[e,p[l].hashMethod(s)]}switch(e){case"enum":if(l===r.K.Active){const[s,r]=Object.entries(i)[0],a=t[d.parent][0],n=t[a.contains],o=n.find(t=>t.name===s),c=n.indexOf(o),h=o.type.slice(1,-1).split(",").map((e,i)=>{if(!e)return e;const s=r[i];return w(t,e,s,void 0,l)[1]});return[e,p[l].hashMethod([c,...h])]}return[e,g(i)];case"merkletree":{const e=function(t,e){if(e.parent&&e.key){const i=t[e.parent].find(t=>t.name===e.key);if("merkletree"!==i.type)throw new Error(`${e.key} is not a merkle tree`);if(i.contains.endsWith("*"))throw new Error(`Merkle tree contain property must not be an array but was given ${e.key}`);return i.contains}return"raw"}(t,d),s=i.map(i=>w(t,e,i,void 0,l)[1]),{root:r}=new c.v(s,p[l].hashMerkleMethod);return["felt",r]}case"selector":return["felt",(u=i,(0,h.qv)(u)?u:(0,o.BK)(u))];case"string":if(l===r.K.Active){const t=(0,n.p)(i),s=[t.data.length,...t.data,t.pending_word,t.pending_word_len];return[e,p[l].hashMethod(s)]}return[e,g(i)];case"i128":if(l===r.K.Active){const t=BigInt(i);return f(t,e,s.He),[e,g(t<0n?s.s9+t:t)]}return[e,g(i)];case"timestamp":case"u128":return l===r.K.Active&&f(i,e,s.bE),[e,g(i)];case"felt":case"shortstring":return l===r.K.Active&&f(g(i),e,s.Kp),[e,g(i)];case"ClassHash":case"ContractAddress":return l===r.K.Active&&f(i,e,s.Kp),[e,g(i)];case"bool":return l===r.K.Active&&(0,a.A)("boolean"==typeof i,`Type mismatch for ${e} ${i}`),[e,g(i)];default:if(l===r.K.Active)throw new Error(`Unsupported type: ${e}`);return[e,g(i)]}var u}function S(t,e,i,s=r.K.Legacy){return p[s].hashMethod(function(t,e,i,s=r.K.Legacy){const a=t[e]??p[s].presetTypes[e],[n,o]=a.reduce(([r,a],n)=>{if(void 0===i[n.name]||null===i[n.name]&&"enum"!==n.type)throw new Error(`Cannot encode data: missing data for '${n.name}'`);const o=i[n.name],d={parent:e,key:n.name},[c,h]=w(t,n.type,o,d,s);return[[...r,c],[...a,h]]},[["felt"],[b(t,e,s)]]);return[n,o]}(t,e,i,s)[1])}function k(t,e){if(!function(t){const e=t;return Boolean(e.message&&e.primaryType&&e.types&&m(e))}(t))throw new Error("Typed data does not match JSON schema");const i=m(t),{domain:s,hashMethod:r}=p[i];return r([(0,l.Mu)("StarkNet Message"),S(t.types,s,t.domain,i),e,S(t.types,t.primaryType,t.message,i)])}},1999(t,e,i){"use strict";i.d(e,{Z:()=>n,s:()=>o});var s=i(712),r=i(1094),a=i(2442);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function n(t){return{hash:t,hmac:(e,...i)=>(0,s.w)(t,e,(0,r.Id)(...i)),randomBytes:r.po}}function o(t,e){const i=e=>(0,a.x3)({...t,...n(e)});return Object.freeze({...i(e),create:i})}},2014(t,e,i){"use strict";i.d(e,{b:()=>l});var s=i(8432),r=i(1420);const a=BigInt(0),n=BigInt(36);function o(t){const e=(t=t.toLowerCase()).substring(2).split(""),i=new Uint8Array(40);for(let t=0;t<40;t++)i[t]=e[t].charCodeAt(0);const r=(0,s.lY)(i);for(let t=0;t<40;t+=2)r[t>>1]>>4>=8&&(e[t]=e[t].toUpperCase()),(15&r[t>>1])>=8&&(e[t+1]=e[t+1].toUpperCase());return"0x"+e.join("")}const d={};for(let t=0;t<10;t++)d[String(t)]=String(t);for(let t=0;t<26;t++)d[String.fromCharCode(65+t)]=String(10+t);function c(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map(t=>d[t]).join("");for(;e.length>=15;){let t=e.substring(0,15);e=parseInt(t,10)%97+e.substring(t.length)}let i=String(98-parseInt(e,10)%97);for(;i.length<2;)i="0"+i;return i}const h=function(){const t={};for(let e=0;e<36;e++){t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e)}return t}();function l(t){if((0,r.MR)("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=o(t);return(0,r.MR)(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){(0,r.MR)(t.substring(2,4)===c(t),"bad icap checksum","address",t);let e=function(t){t=t.toLowerCase();let e=a;for(let i=0;i<t.length;i++)e=e*n+h[t[i]];return e}(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return o("0x"+e)}(0,r.MR)(!1,"invalid address","address",t)}},2079(t,e,i){"use strict";i.r(e),i.d(e,{AccountNotEnabled:()=>o,AccountSuspended:()=>d,AddressPending:()=>w,ArgumentsRequired:()=>c,AuthenticationError:()=>a,BadRequest:()=>h,BadResponse:()=>V,BadSymbol:()=>l,BaseError:()=>s,CancelPending:()=>j,ChecksumError:()=>q,ContractUnavailable:()=>A,DDoSProtection:()=>B,DuplicateOrderId:()=>_,ExchangeClosedByUser:()=>E,ExchangeError:()=>r,ExchangeNotAvailable:()=>R,InsufficientFunds:()=>v,InvalidAddress:()=>b,InvalidNonce:()=>D,InvalidOrder:()=>S,InvalidProxySettings:()=>x,ManualInteractionNeeded:()=>g,MarginModeAlreadySet:()=>f,MarketClosed:()=>m,NetworkError:()=>C,NoChange:()=>p,NotSupported:()=>I,NullResponse:()=>U,OnMaintenance:()=>L,OperationFailed:()=>M,OperationRejected:()=>u,OrderImmediatelyFillable:()=>T,OrderNotCached:()=>O,OrderNotFillable:()=>P,OrderNotFound:()=>k,PermissionDenied:()=>n,RateLimitExceeded:()=>N,RequestTimeout:()=>F,RestrictedLocation:()=>y,UnsubscribeError:()=>G,default:()=>H});class s extends Error{constructor(t){super(t),this.name="BaseError"}}class r extends s{constructor(t){super(t),this.name="ExchangeError"}}class a extends r{constructor(t){super(t),this.name="AuthenticationError"}}class n extends a{constructor(t){super(t),this.name="PermissionDenied"}}class o extends n{constructor(t){super(t),this.name="AccountNotEnabled"}}class d extends a{constructor(t){super(t),this.name="AccountSuspended"}}class c extends r{constructor(t){super(t),this.name="ArgumentsRequired"}}class h extends r{constructor(t){super(t),this.name="BadRequest"}}class l extends h{constructor(t){super(t),this.name="BadSymbol"}}class u extends r{constructor(t){super(t),this.name="OperationRejected"}}class p extends u{constructor(t){super(t),this.name="NoChange"}}class f extends p{constructor(t){super(t),this.name="MarginModeAlreadySet"}}class m extends u{constructor(t){super(t),this.name="MarketClosed"}}class g extends u{constructor(t){super(t),this.name="ManualInteractionNeeded"}}class y extends u{constructor(t){super(t),this.name="RestrictedLocation"}}class v extends r{constructor(t){super(t),this.name="InsufficientFunds"}}class b extends r{constructor(t){super(t),this.name="InvalidAddress"}}class w extends b{constructor(t){super(t),this.name="AddressPending"}}class S extends r{constructor(t){super(t),this.name="InvalidOrder"}}class k extends S{constructor(t){super(t),this.name="OrderNotFound"}}class O extends S{constructor(t){super(t),this.name="OrderNotCached"}}class T extends S{constructor(t){super(t),this.name="OrderImmediatelyFillable"}}class P extends S{constructor(t){super(t),this.name="OrderNotFillable"}}class _ extends S{constructor(t){super(t),this.name="DuplicateOrderId"}}class A extends S{constructor(t){super(t),this.name="ContractUnavailable"}}class I extends r{constructor(t){super(t),this.name="NotSupported"}}class x extends r{constructor(t){super(t),this.name="InvalidProxySettings"}}class E extends r{constructor(t){super(t),this.name="ExchangeClosedByUser"}}class M extends s{constructor(t){super(t),this.name="OperationFailed"}}class C extends M{constructor(t){super(t),this.name="NetworkError"}}class B extends C{constructor(t){super(t),this.name="DDoSProtection"}}class N extends C{constructor(t){super(t),this.name="RateLimitExceeded"}}class R extends C{constructor(t){super(t),this.name="ExchangeNotAvailable"}}class L extends R{constructor(t){super(t),this.name="OnMaintenance"}}class D extends C{constructor(t){super(t),this.name="InvalidNonce"}}class q extends D{constructor(t){super(t),this.name="ChecksumError"}}class F extends C{constructor(t){super(t),this.name="RequestTimeout"}}class V extends M{constructor(t){super(t),this.name="BadResponse"}}class U extends V{constructor(t){super(t),this.name="NullResponse"}}class j extends M{constructor(t){super(t),this.name="CancelPending"}}class G extends s{constructor(t){super(t),this.name="UnsubscribeError"}}const H={BaseError:s,ExchangeError:r,AuthenticationError:a,PermissionDenied:n,AccountNotEnabled:o,AccountSuspended:d,ArgumentsRequired:c,BadRequest:h,BadSymbol:l,OperationRejected:u,NoChange:p,MarginModeAlreadySet:f,MarketClosed:m,ManualInteractionNeeded:g,RestrictedLocation:y,InsufficientFunds:v,InvalidAddress:b,AddressPending:w,InvalidOrder:S,OrderNotFound:k,OrderNotCached:O,OrderImmediatelyFillable:T,OrderNotFillable:P,DuplicateOrderId:_,ContractUnavailable:A,NotSupported:I,InvalidProxySettings:x,ExchangeClosedByUser:E,OperationFailed:M,NetworkError:C,DDoSProtection:B,RateLimitExceeded:N,ExchangeNotAvailable:R,OnMaintenance:L,InvalidNonce:D,ChecksumError:q,RequestTimeout:F,BadResponse:V,NullResponse:U,CancelPending:j,UnsubscribeError:G}},2256(t,e,i){"use strict";i.d(e,{f:()=>a,p:()=>n});var s=i(1686),r=i(7925);function a(t){const e=0n===BigInt(t.pending_word)?"":(0,r.Wb)((0,s.nj)(t.pending_word));return t.data.reduce((t,e)=>t+(0n===BigInt(e)?"":(0,r.Wb)((0,s.nj)(e))),"")+e}function n(t){const e=(0,r.mE)(t),i=e[e.length-1],s=e.map(r.Mu),[a,n]=void 0===i||31===i.length?["0x00",0]:[s.pop(),i.length];return{data:0===s.length?[]:s,pending_word:a,pending_word_len:n}}},2373(t,e,i){"use strict";var s=i(Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal'");throw t.code="MODULE_NOT_FOUND",t}())),r=s.Reader,a=s.Writer,n=s.util,o=s.roots.default||(s.roots.default={});o.PrivateAccountV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.vcoinName="",t.prototype.coinId="",t.prototype.balanceAmount="",t.prototype.balanceAmountChange="",t.prototype.frozenAmount="",t.prototype.frozenAmountChange="",t.prototype.type="",t.prototype.time=n.Long?n.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.vcoinName&&Object.hasOwnProperty.call(t,"vcoinName")&&e.uint32(10).string(t.vcoinName),null!=t.coinId&&Object.hasOwnProperty.call(t,"coinId")&&e.uint32(18).string(t.coinId),null!=t.balanceAmount&&Object.hasOwnProperty.call(t,"balanceAmount")&&e.uint32(26).string(t.balanceAmount),null!=t.balanceAmountChange&&Object.hasOwnProperty.call(t,"balanceAmountChange")&&e.uint32(34).string(t.balanceAmountChange),null!=t.frozenAmount&&Object.hasOwnProperty.call(t,"frozenAmount")&&e.uint32(42).string(t.frozenAmount),null!=t.frozenAmountChange&&Object.hasOwnProperty.call(t,"frozenAmountChange")&&e.uint32(50).string(t.frozenAmountChange),null!=t.type&&Object.hasOwnProperty.call(t,"type")&&e.uint32(58).string(t.type),null!=t.time&&Object.hasOwnProperty.call(t,"time")&&e.uint32(64).int64(t.time),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PrivateAccountV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.vcoinName=t.string();break;case 2:a.coinId=t.string();break;case 3:a.balanceAmount=t.string();break;case 4:a.balanceAmountChange=t.string();break;case 5:a.frozenAmount=t.string();break;case 6:a.frozenAmountChange=t.string();break;case 7:a.type=t.string();break;case 8:a.time=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.vcoinName&&t.hasOwnProperty("vcoinName")&&!n.isString(t.vcoinName)?"vcoinName: string expected":null!=t.coinId&&t.hasOwnProperty("coinId")&&!n.isString(t.coinId)?"coinId: string expected":null!=t.balanceAmount&&t.hasOwnProperty("balanceAmount")&&!n.isString(t.balanceAmount)?"balanceAmount: string expected":null!=t.balanceAmountChange&&t.hasOwnProperty("balanceAmountChange")&&!n.isString(t.balanceAmountChange)?"balanceAmountChange: string expected":null!=t.frozenAmount&&t.hasOwnProperty("frozenAmount")&&!n.isString(t.frozenAmount)?"frozenAmount: string expected":null!=t.frozenAmountChange&&t.hasOwnProperty("frozenAmountChange")&&!n.isString(t.frozenAmountChange)?"frozenAmountChange: string expected":null!=t.type&&t.hasOwnProperty("type")&&!n.isString(t.type)?"type: string expected":null!=t.time&&t.hasOwnProperty("time")&&!(n.isInteger(t.time)||t.time&&n.isInteger(t.time.low)&&n.isInteger(t.time.high))?"time: integer|Long expected":null},t.fromObject=function(t){if(t instanceof o.PrivateAccountV3Api)return t;var e=new o.PrivateAccountV3Api;return null!=t.vcoinName&&(e.vcoinName=String(t.vcoinName)),null!=t.coinId&&(e.coinId=String(t.coinId)),null!=t.balanceAmount&&(e.balanceAmount=String(t.balanceAmount)),null!=t.balanceAmountChange&&(e.balanceAmountChange=String(t.balanceAmountChange)),null!=t.frozenAmount&&(e.frozenAmount=String(t.frozenAmount)),null!=t.frozenAmountChange&&(e.frozenAmountChange=String(t.frozenAmountChange)),null!=t.type&&(e.type=String(t.type)),null!=t.time&&(n.Long?(e.time=n.Long.fromValue(t.time)).unsigned=!1:"string"==typeof t.time?e.time=parseInt(t.time,10):"number"==typeof t.time?e.time=t.time:"object"==typeof t.time&&(e.time=new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults)if(i.vcoinName="",i.coinId="",i.balanceAmount="",i.balanceAmountChange="",i.frozenAmount="",i.frozenAmountChange="",i.type="",n.Long){var s=new n.Long(0,0,!1);i.time=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.time=e.longs===String?"0":0;return null!=t.vcoinName&&t.hasOwnProperty("vcoinName")&&(i.vcoinName=t.vcoinName),null!=t.coinId&&t.hasOwnProperty("coinId")&&(i.coinId=t.coinId),null!=t.balanceAmount&&t.hasOwnProperty("balanceAmount")&&(i.balanceAmount=t.balanceAmount),null!=t.balanceAmountChange&&t.hasOwnProperty("balanceAmountChange")&&(i.balanceAmountChange=t.balanceAmountChange),null!=t.frozenAmount&&t.hasOwnProperty("frozenAmount")&&(i.frozenAmount=t.frozenAmount),null!=t.frozenAmountChange&&t.hasOwnProperty("frozenAmountChange")&&(i.frozenAmountChange=t.frozenAmountChange),null!=t.type&&t.hasOwnProperty("type")&&(i.type=t.type),null!=t.time&&t.hasOwnProperty("time")&&("number"==typeof t.time?i.time=e.longs===String?String(t.time):t.time:i.time=e.longs===String?n.Long.prototype.toString.call(t.time):e.longs===Number?new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber():t.time),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PrivateAccountV3Api"},t}(),o.PrivateDealsV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.prototype.amount="",t.prototype.tradeType=0,t.prototype.isMaker=!1,t.prototype.isSelfTrade=!1,t.prototype.tradeId="",t.prototype.clientOrderId="",t.prototype.orderId="",t.prototype.feeAmount="",t.prototype.feeCurrency="",t.prototype.time=n.Long?n.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),null!=t.amount&&Object.hasOwnProperty.call(t,"amount")&&e.uint32(26).string(t.amount),null!=t.tradeType&&Object.hasOwnProperty.call(t,"tradeType")&&e.uint32(32).int32(t.tradeType),null!=t.isMaker&&Object.hasOwnProperty.call(t,"isMaker")&&e.uint32(40).bool(t.isMaker),null!=t.isSelfTrade&&Object.hasOwnProperty.call(t,"isSelfTrade")&&e.uint32(48).bool(t.isSelfTrade),null!=t.tradeId&&Object.hasOwnProperty.call(t,"tradeId")&&e.uint32(58).string(t.tradeId),null!=t.clientOrderId&&Object.hasOwnProperty.call(t,"clientOrderId")&&e.uint32(66).string(t.clientOrderId),null!=t.orderId&&Object.hasOwnProperty.call(t,"orderId")&&e.uint32(74).string(t.orderId),null!=t.feeAmount&&Object.hasOwnProperty.call(t,"feeAmount")&&e.uint32(82).string(t.feeAmount),null!=t.feeCurrency&&Object.hasOwnProperty.call(t,"feeCurrency")&&e.uint32(90).string(t.feeCurrency),null!=t.time&&Object.hasOwnProperty.call(t,"time")&&e.uint32(96).int64(t.time),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PrivateDealsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;case 3:a.amount=t.string();break;case 4:a.tradeType=t.int32();break;case 5:a.isMaker=t.bool();break;case 6:a.isSelfTrade=t.bool();break;case 7:a.tradeId=t.string();break;case 8:a.clientOrderId=t.string();break;case 9:a.orderId=t.string();break;case 10:a.feeAmount=t.string();break;case 11:a.feeCurrency=t.string();break;case 12:a.time=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null!=t.amount&&t.hasOwnProperty("amount")&&!n.isString(t.amount)?"amount: string expected":null!=t.tradeType&&t.hasOwnProperty("tradeType")&&!n.isInteger(t.tradeType)?"tradeType: integer expected":null!=t.isMaker&&t.hasOwnProperty("isMaker")&&"boolean"!=typeof t.isMaker?"isMaker: boolean expected":null!=t.isSelfTrade&&t.hasOwnProperty("isSelfTrade")&&"boolean"!=typeof t.isSelfTrade?"isSelfTrade: boolean expected":null!=t.tradeId&&t.hasOwnProperty("tradeId")&&!n.isString(t.tradeId)?"tradeId: string expected":null!=t.clientOrderId&&t.hasOwnProperty("clientOrderId")&&!n.isString(t.clientOrderId)?"clientOrderId: string expected":null!=t.orderId&&t.hasOwnProperty("orderId")&&!n.isString(t.orderId)?"orderId: string expected":null!=t.feeAmount&&t.hasOwnProperty("feeAmount")&&!n.isString(t.feeAmount)?"feeAmount: string expected":null!=t.feeCurrency&&t.hasOwnProperty("feeCurrency")&&!n.isString(t.feeCurrency)?"feeCurrency: string expected":null!=t.time&&t.hasOwnProperty("time")&&!(n.isInteger(t.time)||t.time&&n.isInteger(t.time.low)&&n.isInteger(t.time.high))?"time: integer|Long expected":null},t.fromObject=function(t){if(t instanceof o.PrivateDealsV3Api)return t;var e=new o.PrivateDealsV3Api;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),null!=t.amount&&(e.amount=String(t.amount)),null!=t.tradeType&&(e.tradeType=0|t.tradeType),null!=t.isMaker&&(e.isMaker=Boolean(t.isMaker)),null!=t.isSelfTrade&&(e.isSelfTrade=Boolean(t.isSelfTrade)),null!=t.tradeId&&(e.tradeId=String(t.tradeId)),null!=t.clientOrderId&&(e.clientOrderId=String(t.clientOrderId)),null!=t.orderId&&(e.orderId=String(t.orderId)),null!=t.feeAmount&&(e.feeAmount=String(t.feeAmount)),null!=t.feeCurrency&&(e.feeCurrency=String(t.feeCurrency)),null!=t.time&&(n.Long?(e.time=n.Long.fromValue(t.time)).unsigned=!1:"string"==typeof t.time?e.time=parseInt(t.time,10):"number"==typeof t.time?e.time=t.time:"object"==typeof t.time&&(e.time=new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults)if(i.price="",i.quantity="",i.amount="",i.tradeType=0,i.isMaker=!1,i.isSelfTrade=!1,i.tradeId="",i.clientOrderId="",i.orderId="",i.feeAmount="",i.feeCurrency="",n.Long){var s=new n.Long(0,0,!1);i.time=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.time=e.longs===String?"0":0;return null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),null!=t.amount&&t.hasOwnProperty("amount")&&(i.amount=t.amount),null!=t.tradeType&&t.hasOwnProperty("tradeType")&&(i.tradeType=t.tradeType),null!=t.isMaker&&t.hasOwnProperty("isMaker")&&(i.isMaker=t.isMaker),null!=t.isSelfTrade&&t.hasOwnProperty("isSelfTrade")&&(i.isSelfTrade=t.isSelfTrade),null!=t.tradeId&&t.hasOwnProperty("tradeId")&&(i.tradeId=t.tradeId),null!=t.clientOrderId&&t.hasOwnProperty("clientOrderId")&&(i.clientOrderId=t.clientOrderId),null!=t.orderId&&t.hasOwnProperty("orderId")&&(i.orderId=t.orderId),null!=t.feeAmount&&t.hasOwnProperty("feeAmount")&&(i.feeAmount=t.feeAmount),null!=t.feeCurrency&&t.hasOwnProperty("feeCurrency")&&(i.feeCurrency=t.feeCurrency),null!=t.time&&t.hasOwnProperty("time")&&("number"==typeof t.time?i.time=e.longs===String?String(t.time):t.time:i.time=e.longs===String?n.Long.prototype.toString.call(t.time):e.longs===Number?new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber():t.time),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PrivateDealsV3Api"},t}(),o.PrivateOrdersV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}var e;return t.prototype.id="",t.prototype.clientId="",t.prototype.price="",t.prototype.quantity="",t.prototype.amount="",t.prototype.avgPrice="",t.prototype.orderType=0,t.prototype.tradeType=0,t.prototype.isMaker=!1,t.prototype.remainAmount="",t.prototype.remainQuantity="",t.prototype.lastDealQuantity=null,t.prototype.cumulativeQuantity="",t.prototype.cumulativeAmount="",t.prototype.status=0,t.prototype.createTime=n.Long?n.Long.fromBits(0,0,!1):0,t.prototype.market=null,t.prototype.triggerType=null,t.prototype.triggerPrice=null,t.prototype.state=null,t.prototype.ocoId=null,t.prototype.routeFactor=null,t.prototype.symbolId=null,t.prototype.marketId=null,t.prototype.marketCurrencyId=null,t.prototype.currencyId=null,Object.defineProperty(t.prototype,"_lastDealQuantity",{get:n.oneOfGetter(e=["lastDealQuantity"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_market",{get:n.oneOfGetter(e=["market"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_triggerType",{get:n.oneOfGetter(e=["triggerType"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_triggerPrice",{get:n.oneOfGetter(e=["triggerPrice"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_state",{get:n.oneOfGetter(e=["state"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_ocoId",{get:n.oneOfGetter(e=["ocoId"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_routeFactor",{get:n.oneOfGetter(e=["routeFactor"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_symbolId",{get:n.oneOfGetter(e=["symbolId"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_marketId",{get:n.oneOfGetter(e=["marketId"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_marketCurrencyId",{get:n.oneOfGetter(e=["marketCurrencyId"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_currencyId",{get:n.oneOfGetter(e=["currencyId"]),set:n.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.id&&Object.hasOwnProperty.call(t,"id")&&e.uint32(10).string(t.id),null!=t.clientId&&Object.hasOwnProperty.call(t,"clientId")&&e.uint32(18).string(t.clientId),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(26).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(34).string(t.quantity),null!=t.amount&&Object.hasOwnProperty.call(t,"amount")&&e.uint32(42).string(t.amount),null!=t.avgPrice&&Object.hasOwnProperty.call(t,"avgPrice")&&e.uint32(50).string(t.avgPrice),null!=t.orderType&&Object.hasOwnProperty.call(t,"orderType")&&e.uint32(56).int32(t.orderType),null!=t.tradeType&&Object.hasOwnProperty.call(t,"tradeType")&&e.uint32(64).int32(t.tradeType),null!=t.isMaker&&Object.hasOwnProperty.call(t,"isMaker")&&e.uint32(72).bool(t.isMaker),null!=t.remainAmount&&Object.hasOwnProperty.call(t,"remainAmount")&&e.uint32(82).string(t.remainAmount),null!=t.remainQuantity&&Object.hasOwnProperty.call(t,"remainQuantity")&&e.uint32(90).string(t.remainQuantity),null!=t.lastDealQuantity&&Object.hasOwnProperty.call(t,"lastDealQuantity")&&e.uint32(98).string(t.lastDealQuantity),null!=t.cumulativeQuantity&&Object.hasOwnProperty.call(t,"cumulativeQuantity")&&e.uint32(106).string(t.cumulativeQuantity),null!=t.cumulativeAmount&&Object.hasOwnProperty.call(t,"cumulativeAmount")&&e.uint32(114).string(t.cumulativeAmount),null!=t.status&&Object.hasOwnProperty.call(t,"status")&&e.uint32(120).int32(t.status),null!=t.createTime&&Object.hasOwnProperty.call(t,"createTime")&&e.uint32(128).int64(t.createTime),null!=t.market&&Object.hasOwnProperty.call(t,"market")&&e.uint32(138).string(t.market),null!=t.triggerType&&Object.hasOwnProperty.call(t,"triggerType")&&e.uint32(144).int32(t.triggerType),null!=t.triggerPrice&&Object.hasOwnProperty.call(t,"triggerPrice")&&e.uint32(154).string(t.triggerPrice),null!=t.state&&Object.hasOwnProperty.call(t,"state")&&e.uint32(160).int32(t.state),null!=t.ocoId&&Object.hasOwnProperty.call(t,"ocoId")&&e.uint32(170).string(t.ocoId),null!=t.routeFactor&&Object.hasOwnProperty.call(t,"routeFactor")&&e.uint32(178).string(t.routeFactor),null!=t.symbolId&&Object.hasOwnProperty.call(t,"symbolId")&&e.uint32(186).string(t.symbolId),null!=t.marketId&&Object.hasOwnProperty.call(t,"marketId")&&e.uint32(194).string(t.marketId),null!=t.marketCurrencyId&&Object.hasOwnProperty.call(t,"marketCurrencyId")&&e.uint32(202).string(t.marketCurrencyId),null!=t.currencyId&&Object.hasOwnProperty.call(t,"currencyId")&&e.uint32(210).string(t.currencyId),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PrivateOrdersV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.id=t.string();break;case 2:a.clientId=t.string();break;case 3:a.price=t.string();break;case 4:a.quantity=t.string();break;case 5:a.amount=t.string();break;case 6:a.avgPrice=t.string();break;case 7:a.orderType=t.int32();break;case 8:a.tradeType=t.int32();break;case 9:a.isMaker=t.bool();break;case 10:a.remainAmount=t.string();break;case 11:a.remainQuantity=t.string();break;case 12:a.lastDealQuantity=t.string();break;case 13:a.cumulativeQuantity=t.string();break;case 14:a.cumulativeAmount=t.string();break;case 15:a.status=t.int32();break;case 16:a.createTime=t.int64();break;case 17:a.market=t.string();break;case 18:a.triggerType=t.int32();break;case 19:a.triggerPrice=t.string();break;case 20:a.state=t.int32();break;case 21:a.ocoId=t.string();break;case 22:a.routeFactor=t.string();break;case 23:a.symbolId=t.string();break;case 24:a.marketId=t.string();break;case 25:a.marketCurrencyId=t.string();break;case 26:a.currencyId=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};return null!=t.id&&t.hasOwnProperty("id")&&!n.isString(t.id)?"id: string expected":null!=t.clientId&&t.hasOwnProperty("clientId")&&!n.isString(t.clientId)?"clientId: string expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null!=t.amount&&t.hasOwnProperty("amount")&&!n.isString(t.amount)?"amount: string expected":null!=t.avgPrice&&t.hasOwnProperty("avgPrice")&&!n.isString(t.avgPrice)?"avgPrice: string expected":null!=t.orderType&&t.hasOwnProperty("orderType")&&!n.isInteger(t.orderType)?"orderType: integer expected":null!=t.tradeType&&t.hasOwnProperty("tradeType")&&!n.isInteger(t.tradeType)?"tradeType: integer expected":null!=t.isMaker&&t.hasOwnProperty("isMaker")&&"boolean"!=typeof t.isMaker?"isMaker: boolean expected":null!=t.remainAmount&&t.hasOwnProperty("remainAmount")&&!n.isString(t.remainAmount)?"remainAmount: string expected":null!=t.remainQuantity&&t.hasOwnProperty("remainQuantity")&&!n.isString(t.remainQuantity)?"remainQuantity: string expected":null!=t.lastDealQuantity&&t.hasOwnProperty("lastDealQuantity")&&(e._lastDealQuantity=1,!n.isString(t.lastDealQuantity))?"lastDealQuantity: string expected":null!=t.cumulativeQuantity&&t.hasOwnProperty("cumulativeQuantity")&&!n.isString(t.cumulativeQuantity)?"cumulativeQuantity: string expected":null!=t.cumulativeAmount&&t.hasOwnProperty("cumulativeAmount")&&!n.isString(t.cumulativeAmount)?"cumulativeAmount: string expected":null!=t.status&&t.hasOwnProperty("status")&&!n.isInteger(t.status)?"status: integer expected":null!=t.createTime&&t.hasOwnProperty("createTime")&&!(n.isInteger(t.createTime)||t.createTime&&n.isInteger(t.createTime.low)&&n.isInteger(t.createTime.high))?"createTime: integer|Long expected":null!=t.market&&t.hasOwnProperty("market")&&(e._market=1,!n.isString(t.market))?"market: string expected":null!=t.triggerType&&t.hasOwnProperty("triggerType")&&(e._triggerType=1,!n.isInteger(t.triggerType))?"triggerType: integer expected":null!=t.triggerPrice&&t.hasOwnProperty("triggerPrice")&&(e._triggerPrice=1,!n.isString(t.triggerPrice))?"triggerPrice: string expected":null!=t.state&&t.hasOwnProperty("state")&&(e._state=1,!n.isInteger(t.state))?"state: integer expected":null!=t.ocoId&&t.hasOwnProperty("ocoId")&&(e._ocoId=1,!n.isString(t.ocoId))?"ocoId: string expected":null!=t.routeFactor&&t.hasOwnProperty("routeFactor")&&(e._routeFactor=1,!n.isString(t.routeFactor))?"routeFactor: string expected":null!=t.symbolId&&t.hasOwnProperty("symbolId")&&(e._symbolId=1,!n.isString(t.symbolId))?"symbolId: string expected":null!=t.marketId&&t.hasOwnProperty("marketId")&&(e._marketId=1,!n.isString(t.marketId))?"marketId: string expected":null!=t.marketCurrencyId&&t.hasOwnProperty("marketCurrencyId")&&(e._marketCurrencyId=1,!n.isString(t.marketCurrencyId))?"marketCurrencyId: string expected":null!=t.currencyId&&t.hasOwnProperty("currencyId")&&(e._currencyId=1,!n.isString(t.currencyId))?"currencyId: string expected":null},t.fromObject=function(t){if(t instanceof o.PrivateOrdersV3Api)return t;var e=new o.PrivateOrdersV3Api;return null!=t.id&&(e.id=String(t.id)),null!=t.clientId&&(e.clientId=String(t.clientId)),null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),null!=t.amount&&(e.amount=String(t.amount)),null!=t.avgPrice&&(e.avgPrice=String(t.avgPrice)),null!=t.orderType&&(e.orderType=0|t.orderType),null!=t.tradeType&&(e.tradeType=0|t.tradeType),null!=t.isMaker&&(e.isMaker=Boolean(t.isMaker)),null!=t.remainAmount&&(e.remainAmount=String(t.remainAmount)),null!=t.remainQuantity&&(e.remainQuantity=String(t.remainQuantity)),null!=t.lastDealQuantity&&(e.lastDealQuantity=String(t.lastDealQuantity)),null!=t.cumulativeQuantity&&(e.cumulativeQuantity=String(t.cumulativeQuantity)),null!=t.cumulativeAmount&&(e.cumulativeAmount=String(t.cumulativeAmount)),null!=t.status&&(e.status=0|t.status),null!=t.createTime&&(n.Long?(e.createTime=n.Long.fromValue(t.createTime)).unsigned=!1:"string"==typeof t.createTime?e.createTime=parseInt(t.createTime,10):"number"==typeof t.createTime?e.createTime=t.createTime:"object"==typeof t.createTime&&(e.createTime=new n.LongBits(t.createTime.low>>>0,t.createTime.high>>>0).toNumber())),null!=t.market&&(e.market=String(t.market)),null!=t.triggerType&&(e.triggerType=0|t.triggerType),null!=t.triggerPrice&&(e.triggerPrice=String(t.triggerPrice)),null!=t.state&&(e.state=0|t.state),null!=t.ocoId&&(e.ocoId=String(t.ocoId)),null!=t.routeFactor&&(e.routeFactor=String(t.routeFactor)),null!=t.symbolId&&(e.symbolId=String(t.symbolId)),null!=t.marketId&&(e.marketId=String(t.marketId)),null!=t.marketCurrencyId&&(e.marketCurrencyId=String(t.marketCurrencyId)),null!=t.currencyId&&(e.currencyId=String(t.currencyId)),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults)if(i.id="",i.clientId="",i.price="",i.quantity="",i.amount="",i.avgPrice="",i.orderType=0,i.tradeType=0,i.isMaker=!1,i.remainAmount="",i.remainQuantity="",i.cumulativeQuantity="",i.cumulativeAmount="",i.status=0,n.Long){var s=new n.Long(0,0,!1);i.createTime=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.createTime=e.longs===String?"0":0;return null!=t.id&&t.hasOwnProperty("id")&&(i.id=t.id),null!=t.clientId&&t.hasOwnProperty("clientId")&&(i.clientId=t.clientId),null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),null!=t.amount&&t.hasOwnProperty("amount")&&(i.amount=t.amount),null!=t.avgPrice&&t.hasOwnProperty("avgPrice")&&(i.avgPrice=t.avgPrice),null!=t.orderType&&t.hasOwnProperty("orderType")&&(i.orderType=t.orderType),null!=t.tradeType&&t.hasOwnProperty("tradeType")&&(i.tradeType=t.tradeType),null!=t.isMaker&&t.hasOwnProperty("isMaker")&&(i.isMaker=t.isMaker),null!=t.remainAmount&&t.hasOwnProperty("remainAmount")&&(i.remainAmount=t.remainAmount),null!=t.remainQuantity&&t.hasOwnProperty("remainQuantity")&&(i.remainQuantity=t.remainQuantity),null!=t.lastDealQuantity&&t.hasOwnProperty("lastDealQuantity")&&(i.lastDealQuantity=t.lastDealQuantity,e.oneofs&&(i._lastDealQuantity="lastDealQuantity")),null!=t.cumulativeQuantity&&t.hasOwnProperty("cumulativeQuantity")&&(i.cumulativeQuantity=t.cumulativeQuantity),null!=t.cumulativeAmount&&t.hasOwnProperty("cumulativeAmount")&&(i.cumulativeAmount=t.cumulativeAmount),null!=t.status&&t.hasOwnProperty("status")&&(i.status=t.status),null!=t.createTime&&t.hasOwnProperty("createTime")&&("number"==typeof t.createTime?i.createTime=e.longs===String?String(t.createTime):t.createTime:i.createTime=e.longs===String?n.Long.prototype.toString.call(t.createTime):e.longs===Number?new n.LongBits(t.createTime.low>>>0,t.createTime.high>>>0).toNumber():t.createTime),null!=t.market&&t.hasOwnProperty("market")&&(i.market=t.market,e.oneofs&&(i._market="market")),null!=t.triggerType&&t.hasOwnProperty("triggerType")&&(i.triggerType=t.triggerType,e.oneofs&&(i._triggerType="triggerType")),null!=t.triggerPrice&&t.hasOwnProperty("triggerPrice")&&(i.triggerPrice=t.triggerPrice,e.oneofs&&(i._triggerPrice="triggerPrice")),null!=t.state&&t.hasOwnProperty("state")&&(i.state=t.state,e.oneofs&&(i._state="state")),null!=t.ocoId&&t.hasOwnProperty("ocoId")&&(i.ocoId=t.ocoId,e.oneofs&&(i._ocoId="ocoId")),null!=t.routeFactor&&t.hasOwnProperty("routeFactor")&&(i.routeFactor=t.routeFactor,e.oneofs&&(i._routeFactor="routeFactor")),null!=t.symbolId&&t.hasOwnProperty("symbolId")&&(i.symbolId=t.symbolId,e.oneofs&&(i._symbolId="symbolId")),null!=t.marketId&&t.hasOwnProperty("marketId")&&(i.marketId=t.marketId,e.oneofs&&(i._marketId="marketId")),null!=t.marketCurrencyId&&t.hasOwnProperty("marketCurrencyId")&&(i.marketCurrencyId=t.marketCurrencyId,e.oneofs&&(i._marketCurrencyId="marketCurrencyId")),null!=t.currencyId&&t.hasOwnProperty("currencyId")&&(i.currencyId=t.currencyId,e.oneofs&&(i._currencyId="currencyId")),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PrivateOrdersV3Api"},t}(),o.PublicAggreBookTickerV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.bidPrice="",t.prototype.bidQuantity="",t.prototype.askPrice="",t.prototype.askQuantity="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.bidPrice&&Object.hasOwnProperty.call(t,"bidPrice")&&e.uint32(10).string(t.bidPrice),null!=t.bidQuantity&&Object.hasOwnProperty.call(t,"bidQuantity")&&e.uint32(18).string(t.bidQuantity),null!=t.askPrice&&Object.hasOwnProperty.call(t,"askPrice")&&e.uint32(26).string(t.askPrice),null!=t.askQuantity&&Object.hasOwnProperty.call(t,"askQuantity")&&e.uint32(34).string(t.askQuantity),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicAggreBookTickerV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.bidPrice=t.string();break;case 2:a.bidQuantity=t.string();break;case 3:a.askPrice=t.string();break;case 4:a.askQuantity=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.bidPrice&&t.hasOwnProperty("bidPrice")&&!n.isString(t.bidPrice)?"bidPrice: string expected":null!=t.bidQuantity&&t.hasOwnProperty("bidQuantity")&&!n.isString(t.bidQuantity)?"bidQuantity: string expected":null!=t.askPrice&&t.hasOwnProperty("askPrice")&&!n.isString(t.askPrice)?"askPrice: string expected":null!=t.askQuantity&&t.hasOwnProperty("askQuantity")&&!n.isString(t.askQuantity)?"askQuantity: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicAggreBookTickerV3Api)return t;var e=new o.PublicAggreBookTickerV3Api;return null!=t.bidPrice&&(e.bidPrice=String(t.bidPrice)),null!=t.bidQuantity&&(e.bidQuantity=String(t.bidQuantity)),null!=t.askPrice&&(e.askPrice=String(t.askPrice)),null!=t.askQuantity&&(e.askQuantity=String(t.askQuantity)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.bidPrice="",i.bidQuantity="",i.askPrice="",i.askQuantity=""),null!=t.bidPrice&&t.hasOwnProperty("bidPrice")&&(i.bidPrice=t.bidPrice),null!=t.bidQuantity&&t.hasOwnProperty("bidQuantity")&&(i.bidQuantity=t.bidQuantity),null!=t.askPrice&&t.hasOwnProperty("askPrice")&&(i.askPrice=t.askPrice),null!=t.askQuantity&&t.hasOwnProperty("askQuantity")&&(i.askQuantity=t.askQuantity),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicAggreBookTickerV3Api"},t}(),o.PublicAggreDealsV3Api=function(){function t(t){if(this.deals=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.deals=n.emptyArray,t.prototype.eventType="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.deals&&t.deals.length)for(var i=0;i<t.deals.length;++i)o.PublicAggreDealsV3ApiItem.encode(t.deals[i],e.uint32(10).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(18).string(t.eventType),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicAggreDealsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.deals&&a.deals.length||(a.deals=[]),a.deals.push(o.PublicAggreDealsV3ApiItem.decode(t,t.uint32()));break;case 2:a.eventType=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.deals&&t.hasOwnProperty("deals")){if(!Array.isArray(t.deals))return"deals: array expected";for(var e=0;e<t.deals.length;++e){var i=o.PublicAggreDealsV3ApiItem.verify(t.deals[e]);if(i)return"deals."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicAggreDealsV3Api)return t;var e=new o.PublicAggreDealsV3Api;if(t.deals){if(!Array.isArray(t.deals))throw TypeError(".PublicAggreDealsV3Api.deals: array expected");e.deals=[];for(var i=0;i<t.deals.length;++i){if("object"!=typeof t.deals[i])throw TypeError(".PublicAggreDealsV3Api.deals: object expected");e.deals[i]=o.PublicAggreDealsV3ApiItem.fromObject(t.deals[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.deals=[]),e.defaults&&(i.eventType=""),t.deals&&t.deals.length){i.deals=[];for(var s=0;s<t.deals.length;++s)i.deals[s]=o.PublicAggreDealsV3ApiItem.toObject(t.deals[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicAggreDealsV3Api"},t}(),o.PublicAggreDealsV3ApiItem=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.prototype.tradeType=0,t.prototype.time=n.Long?n.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),null!=t.tradeType&&Object.hasOwnProperty.call(t,"tradeType")&&e.uint32(24).int32(t.tradeType),null!=t.time&&Object.hasOwnProperty.call(t,"time")&&e.uint32(32).int64(t.time),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicAggreDealsV3ApiItem;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;case 3:a.tradeType=t.int32();break;case 4:a.time=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null!=t.tradeType&&t.hasOwnProperty("tradeType")&&!n.isInteger(t.tradeType)?"tradeType: integer expected":null!=t.time&&t.hasOwnProperty("time")&&!(n.isInteger(t.time)||t.time&&n.isInteger(t.time.low)&&n.isInteger(t.time.high))?"time: integer|Long expected":null},t.fromObject=function(t){if(t instanceof o.PublicAggreDealsV3ApiItem)return t;var e=new o.PublicAggreDealsV3ApiItem;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),null!=t.tradeType&&(e.tradeType=0|t.tradeType),null!=t.time&&(n.Long?(e.time=n.Long.fromValue(t.time)).unsigned=!1:"string"==typeof t.time?e.time=parseInt(t.time,10):"number"==typeof t.time?e.time=t.time:"object"==typeof t.time&&(e.time=new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults)if(i.price="",i.quantity="",i.tradeType=0,n.Long){var s=new n.Long(0,0,!1);i.time=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.time=e.longs===String?"0":0;return null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),null!=t.tradeType&&t.hasOwnProperty("tradeType")&&(i.tradeType=t.tradeType),null!=t.time&&t.hasOwnProperty("time")&&("number"==typeof t.time?i.time=e.longs===String?String(t.time):t.time:i.time=e.longs===String?n.Long.prototype.toString.call(t.time):e.longs===Number?new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber():t.time),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicAggreDealsV3ApiItem"},t}(),o.PublicAggreDepthsV3Api=function(){function t(t){if(this.asks=[],this.bids=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.asks=n.emptyArray,t.prototype.bids=n.emptyArray,t.prototype.eventType="",t.prototype.fromVersion="",t.prototype.toVersion="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.asks&&t.asks.length)for(var i=0;i<t.asks.length;++i)o.PublicAggreDepthV3ApiItem.encode(t.asks[i],e.uint32(10).fork()).ldelim();if(null!=t.bids&&t.bids.length)for(i=0;i<t.bids.length;++i)o.PublicAggreDepthV3ApiItem.encode(t.bids[i],e.uint32(18).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(26).string(t.eventType),null!=t.fromVersion&&Object.hasOwnProperty.call(t,"fromVersion")&&e.uint32(34).string(t.fromVersion),null!=t.toVersion&&Object.hasOwnProperty.call(t,"toVersion")&&e.uint32(42).string(t.toVersion),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicAggreDepthsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.asks&&a.asks.length||(a.asks=[]),a.asks.push(o.PublicAggreDepthV3ApiItem.decode(t,t.uint32()));break;case 2:a.bids&&a.bids.length||(a.bids=[]),a.bids.push(o.PublicAggreDepthV3ApiItem.decode(t,t.uint32()));break;case 3:a.eventType=t.string();break;case 4:a.fromVersion=t.string();break;case 5:a.toVersion=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.asks&&t.hasOwnProperty("asks")){if(!Array.isArray(t.asks))return"asks: array expected";for(var e=0;e<t.asks.length;++e){if(i=o.PublicAggreDepthV3ApiItem.verify(t.asks[e]))return"asks."+i}}if(null!=t.bids&&t.hasOwnProperty("bids")){if(!Array.isArray(t.bids))return"bids: array expected";for(e=0;e<t.bids.length;++e){var i;if(i=o.PublicAggreDepthV3ApiItem.verify(t.bids[e]))return"bids."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null!=t.fromVersion&&t.hasOwnProperty("fromVersion")&&!n.isString(t.fromVersion)?"fromVersion: string expected":null!=t.toVersion&&t.hasOwnProperty("toVersion")&&!n.isString(t.toVersion)?"toVersion: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicAggreDepthsV3Api)return t;var e=new o.PublicAggreDepthsV3Api;if(t.asks){if(!Array.isArray(t.asks))throw TypeError(".PublicAggreDepthsV3Api.asks: array expected");e.asks=[];for(var i=0;i<t.asks.length;++i){if("object"!=typeof t.asks[i])throw TypeError(".PublicAggreDepthsV3Api.asks: object expected");e.asks[i]=o.PublicAggreDepthV3ApiItem.fromObject(t.asks[i])}}if(t.bids){if(!Array.isArray(t.bids))throw TypeError(".PublicAggreDepthsV3Api.bids: array expected");e.bids=[];for(i=0;i<t.bids.length;++i){if("object"!=typeof t.bids[i])throw TypeError(".PublicAggreDepthsV3Api.bids: object expected");e.bids[i]=o.PublicAggreDepthV3ApiItem.fromObject(t.bids[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),null!=t.fromVersion&&(e.fromVersion=String(t.fromVersion)),null!=t.toVersion&&(e.toVersion=String(t.toVersion)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.asks=[],i.bids=[]),e.defaults&&(i.eventType="",i.fromVersion="",i.toVersion=""),t.asks&&t.asks.length){i.asks=[];for(var s=0;s<t.asks.length;++s)i.asks[s]=o.PublicAggreDepthV3ApiItem.toObject(t.asks[s],e)}if(t.bids&&t.bids.length){i.bids=[];for(s=0;s<t.bids.length;++s)i.bids[s]=o.PublicAggreDepthV3ApiItem.toObject(t.bids[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),null!=t.fromVersion&&t.hasOwnProperty("fromVersion")&&(i.fromVersion=t.fromVersion),null!=t.toVersion&&t.hasOwnProperty("toVersion")&&(i.toVersion=t.toVersion),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicAggreDepthsV3Api"},t}(),o.PublicAggreDepthV3ApiItem=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicAggreDepthV3ApiItem;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicAggreDepthV3ApiItem)return t;var e=new o.PublicAggreDepthV3ApiItem;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.price="",i.quantity=""),null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicAggreDepthV3ApiItem"},t}(),o.PublicBookTickerBatchV3Api=function(){function t(t){if(this.items=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.items=n.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.items&&t.items.length)for(var i=0;i<t.items.length;++i)o.PublicBookTickerV3Api.encode(t.items[i],e.uint32(10).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicBookTickerBatchV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;if(n>>>3==1)a.items&&a.items.length||(a.items=[]),a.items.push(o.PublicBookTickerV3Api.decode(t,t.uint32()));else t.skipType(7&n)}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.items&&t.hasOwnProperty("items")){if(!Array.isArray(t.items))return"items: array expected";for(var e=0;e<t.items.length;++e){var i=o.PublicBookTickerV3Api.verify(t.items[e]);if(i)return"items."+i}}return null},t.fromObject=function(t){if(t instanceof o.PublicBookTickerBatchV3Api)return t;var e=new o.PublicBookTickerBatchV3Api;if(t.items){if(!Array.isArray(t.items))throw TypeError(".PublicBookTickerBatchV3Api.items: array expected");e.items=[];for(var i=0;i<t.items.length;++i){if("object"!=typeof t.items[i])throw TypeError(".PublicBookTickerBatchV3Api.items: object expected");e.items[i]=o.PublicBookTickerV3Api.fromObject(t.items[i])}}return e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.items=[]),t.items&&t.items.length){i.items=[];for(var s=0;s<t.items.length;++s)i.items[s]=o.PublicBookTickerV3Api.toObject(t.items[s],e)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicBookTickerBatchV3Api"},t}(),o.PublicBookTickerV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.bidPrice="",t.prototype.bidQuantity="",t.prototype.askPrice="",t.prototype.askQuantity="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.bidPrice&&Object.hasOwnProperty.call(t,"bidPrice")&&e.uint32(10).string(t.bidPrice),null!=t.bidQuantity&&Object.hasOwnProperty.call(t,"bidQuantity")&&e.uint32(18).string(t.bidQuantity),null!=t.askPrice&&Object.hasOwnProperty.call(t,"askPrice")&&e.uint32(26).string(t.askPrice),null!=t.askQuantity&&Object.hasOwnProperty.call(t,"askQuantity")&&e.uint32(34).string(t.askQuantity),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicBookTickerV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.bidPrice=t.string();break;case 2:a.bidQuantity=t.string();break;case 3:a.askPrice=t.string();break;case 4:a.askQuantity=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.bidPrice&&t.hasOwnProperty("bidPrice")&&!n.isString(t.bidPrice)?"bidPrice: string expected":null!=t.bidQuantity&&t.hasOwnProperty("bidQuantity")&&!n.isString(t.bidQuantity)?"bidQuantity: string expected":null!=t.askPrice&&t.hasOwnProperty("askPrice")&&!n.isString(t.askPrice)?"askPrice: string expected":null!=t.askQuantity&&t.hasOwnProperty("askQuantity")&&!n.isString(t.askQuantity)?"askQuantity: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicBookTickerV3Api)return t;var e=new o.PublicBookTickerV3Api;return null!=t.bidPrice&&(e.bidPrice=String(t.bidPrice)),null!=t.bidQuantity&&(e.bidQuantity=String(t.bidQuantity)),null!=t.askPrice&&(e.askPrice=String(t.askPrice)),null!=t.askQuantity&&(e.askQuantity=String(t.askQuantity)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.bidPrice="",i.bidQuantity="",i.askPrice="",i.askQuantity=""),null!=t.bidPrice&&t.hasOwnProperty("bidPrice")&&(i.bidPrice=t.bidPrice),null!=t.bidQuantity&&t.hasOwnProperty("bidQuantity")&&(i.bidQuantity=t.bidQuantity),null!=t.askPrice&&t.hasOwnProperty("askPrice")&&(i.askPrice=t.askPrice),null!=t.askQuantity&&t.hasOwnProperty("askQuantity")&&(i.askQuantity=t.askQuantity),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicBookTickerV3Api"},t}(),o.PublicDealsV3Api=function(){function t(t){if(this.deals=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.deals=n.emptyArray,t.prototype.eventType="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.deals&&t.deals.length)for(var i=0;i<t.deals.length;++i)o.PublicDealsV3ApiItem.encode(t.deals[i],e.uint32(10).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(18).string(t.eventType),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicDealsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.deals&&a.deals.length||(a.deals=[]),a.deals.push(o.PublicDealsV3ApiItem.decode(t,t.uint32()));break;case 2:a.eventType=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.deals&&t.hasOwnProperty("deals")){if(!Array.isArray(t.deals))return"deals: array expected";for(var e=0;e<t.deals.length;++e){var i=o.PublicDealsV3ApiItem.verify(t.deals[e]);if(i)return"deals."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicDealsV3Api)return t;var e=new o.PublicDealsV3Api;if(t.deals){if(!Array.isArray(t.deals))throw TypeError(".PublicDealsV3Api.deals: array expected");e.deals=[];for(var i=0;i<t.deals.length;++i){if("object"!=typeof t.deals[i])throw TypeError(".PublicDealsV3Api.deals: object expected");e.deals[i]=o.PublicDealsV3ApiItem.fromObject(t.deals[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.deals=[]),e.defaults&&(i.eventType=""),t.deals&&t.deals.length){i.deals=[];for(var s=0;s<t.deals.length;++s)i.deals[s]=o.PublicDealsV3ApiItem.toObject(t.deals[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicDealsV3Api"},t}(),o.PublicDealsV3ApiItem=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.prototype.tradeType=0,t.prototype.time=n.Long?n.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),null!=t.tradeType&&Object.hasOwnProperty.call(t,"tradeType")&&e.uint32(24).int32(t.tradeType),null!=t.time&&Object.hasOwnProperty.call(t,"time")&&e.uint32(32).int64(t.time),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicDealsV3ApiItem;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;case 3:a.tradeType=t.int32();break;case 4:a.time=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null!=t.tradeType&&t.hasOwnProperty("tradeType")&&!n.isInteger(t.tradeType)?"tradeType: integer expected":null!=t.time&&t.hasOwnProperty("time")&&!(n.isInteger(t.time)||t.time&&n.isInteger(t.time.low)&&n.isInteger(t.time.high))?"time: integer|Long expected":null},t.fromObject=function(t){if(t instanceof o.PublicDealsV3ApiItem)return t;var e=new o.PublicDealsV3ApiItem;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),null!=t.tradeType&&(e.tradeType=0|t.tradeType),null!=t.time&&(n.Long?(e.time=n.Long.fromValue(t.time)).unsigned=!1:"string"==typeof t.time?e.time=parseInt(t.time,10):"number"==typeof t.time?e.time=t.time:"object"==typeof t.time&&(e.time=new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults)if(i.price="",i.quantity="",i.tradeType=0,n.Long){var s=new n.Long(0,0,!1);i.time=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.time=e.longs===String?"0":0;return null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),null!=t.tradeType&&t.hasOwnProperty("tradeType")&&(i.tradeType=t.tradeType),null!=t.time&&t.hasOwnProperty("time")&&("number"==typeof t.time?i.time=e.longs===String?String(t.time):t.time:i.time=e.longs===String?n.Long.prototype.toString.call(t.time):e.longs===Number?new n.LongBits(t.time.low>>>0,t.time.high>>>0).toNumber():t.time),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicDealsV3ApiItem"},t}(),o.PublicIncreaseDepthsBatchV3Api=function(){function t(t){if(this.items=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.items=n.emptyArray,t.prototype.eventType="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.items&&t.items.length)for(var i=0;i<t.items.length;++i)o.PublicIncreaseDepthsV3Api.encode(t.items[i],e.uint32(10).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(18).string(t.eventType),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicIncreaseDepthsBatchV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.items&&a.items.length||(a.items=[]),a.items.push(o.PublicIncreaseDepthsV3Api.decode(t,t.uint32()));break;case 2:a.eventType=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.items&&t.hasOwnProperty("items")){if(!Array.isArray(t.items))return"items: array expected";for(var e=0;e<t.items.length;++e){var i=o.PublicIncreaseDepthsV3Api.verify(t.items[e]);if(i)return"items."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicIncreaseDepthsBatchV3Api)return t;var e=new o.PublicIncreaseDepthsBatchV3Api;if(t.items){if(!Array.isArray(t.items))throw TypeError(".PublicIncreaseDepthsBatchV3Api.items: array expected");e.items=[];for(var i=0;i<t.items.length;++i){if("object"!=typeof t.items[i])throw TypeError(".PublicIncreaseDepthsBatchV3Api.items: object expected");e.items[i]=o.PublicIncreaseDepthsV3Api.fromObject(t.items[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.items=[]),e.defaults&&(i.eventType=""),t.items&&t.items.length){i.items=[];for(var s=0;s<t.items.length;++s)i.items[s]=o.PublicIncreaseDepthsV3Api.toObject(t.items[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicIncreaseDepthsBatchV3Api"},t}(),o.PublicIncreaseDepthsV3Api=function(){function t(t){if(this.asks=[],this.bids=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.asks=n.emptyArray,t.prototype.bids=n.emptyArray,t.prototype.eventType="",t.prototype.version="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.asks&&t.asks.length)for(var i=0;i<t.asks.length;++i)o.PublicIncreaseDepthV3ApiItem.encode(t.asks[i],e.uint32(10).fork()).ldelim();if(null!=t.bids&&t.bids.length)for(i=0;i<t.bids.length;++i)o.PublicIncreaseDepthV3ApiItem.encode(t.bids[i],e.uint32(18).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(26).string(t.eventType),null!=t.version&&Object.hasOwnProperty.call(t,"version")&&e.uint32(34).string(t.version),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicIncreaseDepthsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.asks&&a.asks.length||(a.asks=[]),a.asks.push(o.PublicIncreaseDepthV3ApiItem.decode(t,t.uint32()));break;case 2:a.bids&&a.bids.length||(a.bids=[]),a.bids.push(o.PublicIncreaseDepthV3ApiItem.decode(t,t.uint32()));break;case 3:a.eventType=t.string();break;case 4:a.version=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.asks&&t.hasOwnProperty("asks")){if(!Array.isArray(t.asks))return"asks: array expected";for(var e=0;e<t.asks.length;++e){if(i=o.PublicIncreaseDepthV3ApiItem.verify(t.asks[e]))return"asks."+i}}if(null!=t.bids&&t.hasOwnProperty("bids")){if(!Array.isArray(t.bids))return"bids: array expected";for(e=0;e<t.bids.length;++e){var i;if(i=o.PublicIncreaseDepthV3ApiItem.verify(t.bids[e]))return"bids."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null!=t.version&&t.hasOwnProperty("version")&&!n.isString(t.version)?"version: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicIncreaseDepthsV3Api)return t;var e=new o.PublicIncreaseDepthsV3Api;if(t.asks){if(!Array.isArray(t.asks))throw TypeError(".PublicIncreaseDepthsV3Api.asks: array expected");e.asks=[];for(var i=0;i<t.asks.length;++i){if("object"!=typeof t.asks[i])throw TypeError(".PublicIncreaseDepthsV3Api.asks: object expected");e.asks[i]=o.PublicIncreaseDepthV3ApiItem.fromObject(t.asks[i])}}if(t.bids){if(!Array.isArray(t.bids))throw TypeError(".PublicIncreaseDepthsV3Api.bids: array expected");e.bids=[];for(i=0;i<t.bids.length;++i){if("object"!=typeof t.bids[i])throw TypeError(".PublicIncreaseDepthsV3Api.bids: object expected");e.bids[i]=o.PublicIncreaseDepthV3ApiItem.fromObject(t.bids[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),null!=t.version&&(e.version=String(t.version)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.asks=[],i.bids=[]),e.defaults&&(i.eventType="",i.version=""),t.asks&&t.asks.length){i.asks=[];for(var s=0;s<t.asks.length;++s)i.asks[s]=o.PublicIncreaseDepthV3ApiItem.toObject(t.asks[s],e)}if(t.bids&&t.bids.length){i.bids=[];for(s=0;s<t.bids.length;++s)i.bids[s]=o.PublicIncreaseDepthV3ApiItem.toObject(t.bids[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),null!=t.version&&t.hasOwnProperty("version")&&(i.version=t.version),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicIncreaseDepthsV3Api"},t}(),o.PublicIncreaseDepthV3ApiItem=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicIncreaseDepthV3ApiItem;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicIncreaseDepthV3ApiItem)return t;var e=new o.PublicIncreaseDepthV3ApiItem;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.price="",i.quantity=""),null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicIncreaseDepthV3ApiItem"},t}(),o.PublicLimitDepthsV3Api=function(){function t(t){if(this.asks=[],this.bids=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.asks=n.emptyArray,t.prototype.bids=n.emptyArray,t.prototype.eventType="",t.prototype.version="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.asks&&t.asks.length)for(var i=0;i<t.asks.length;++i)o.PublicLimitDepthV3ApiItem.encode(t.asks[i],e.uint32(10).fork()).ldelim();if(null!=t.bids&&t.bids.length)for(i=0;i<t.bids.length;++i)o.PublicLimitDepthV3ApiItem.encode(t.bids[i],e.uint32(18).fork()).ldelim();return null!=t.eventType&&Object.hasOwnProperty.call(t,"eventType")&&e.uint32(26).string(t.eventType),null!=t.version&&Object.hasOwnProperty.call(t,"version")&&e.uint32(34).string(t.version),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicLimitDepthsV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.asks&&a.asks.length||(a.asks=[]),a.asks.push(o.PublicLimitDepthV3ApiItem.decode(t,t.uint32()));break;case 2:a.bids&&a.bids.length||(a.bids=[]),a.bids.push(o.PublicLimitDepthV3ApiItem.decode(t,t.uint32()));break;case 3:a.eventType=t.string();break;case 4:a.version=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.asks&&t.hasOwnProperty("asks")){if(!Array.isArray(t.asks))return"asks: array expected";for(var e=0;e<t.asks.length;++e){if(i=o.PublicLimitDepthV3ApiItem.verify(t.asks[e]))return"asks."+i}}if(null!=t.bids&&t.hasOwnProperty("bids")){if(!Array.isArray(t.bids))return"bids: array expected";for(e=0;e<t.bids.length;++e){var i;if(i=o.PublicLimitDepthV3ApiItem.verify(t.bids[e]))return"bids."+i}}return null!=t.eventType&&t.hasOwnProperty("eventType")&&!n.isString(t.eventType)?"eventType: string expected":null!=t.version&&t.hasOwnProperty("version")&&!n.isString(t.version)?"version: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicLimitDepthsV3Api)return t;var e=new o.PublicLimitDepthsV3Api;if(t.asks){if(!Array.isArray(t.asks))throw TypeError(".PublicLimitDepthsV3Api.asks: array expected");e.asks=[];for(var i=0;i<t.asks.length;++i){if("object"!=typeof t.asks[i])throw TypeError(".PublicLimitDepthsV3Api.asks: object expected");e.asks[i]=o.PublicLimitDepthV3ApiItem.fromObject(t.asks[i])}}if(t.bids){if(!Array.isArray(t.bids))throw TypeError(".PublicLimitDepthsV3Api.bids: array expected");e.bids=[];for(i=0;i<t.bids.length;++i){if("object"!=typeof t.bids[i])throw TypeError(".PublicLimitDepthsV3Api.bids: object expected");e.bids[i]=o.PublicLimitDepthV3ApiItem.fromObject(t.bids[i])}}return null!=t.eventType&&(e.eventType=String(t.eventType)),null!=t.version&&(e.version=String(t.version)),e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.asks=[],i.bids=[]),e.defaults&&(i.eventType="",i.version=""),t.asks&&t.asks.length){i.asks=[];for(var s=0;s<t.asks.length;++s)i.asks[s]=o.PublicLimitDepthV3ApiItem.toObject(t.asks[s],e)}if(t.bids&&t.bids.length){i.bids=[];for(s=0;s<t.bids.length;++s)i.bids[s]=o.PublicLimitDepthV3ApiItem.toObject(t.bids[s],e)}return null!=t.eventType&&t.hasOwnProperty("eventType")&&(i.eventType=t.eventType),null!=t.version&&t.hasOwnProperty("version")&&(i.version=t.version),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicLimitDepthsV3Api"},t}(),o.PublicLimitDepthV3ApiItem=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.price="",t.prototype.quantity="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(10).string(t.price),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(18).string(t.quantity),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicLimitDepthV3ApiItem;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.price=t.string();break;case 2:a.quantity=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicLimitDepthV3ApiItem)return t;var e=new o.PublicLimitDepthV3ApiItem;return null!=t.price&&(e.price=String(t.price)),null!=t.quantity&&(e.quantity=String(t.quantity)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.price="",i.quantity=""),null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicLimitDepthV3ApiItem"},t}(),o.PublicMiniTickerV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.symbol="",t.prototype.price="",t.prototype.rate="",t.prototype.zonedRate="",t.prototype.high="",t.prototype.low="",t.prototype.volume="",t.prototype.quantity="",t.prototype.lastCloseRate="",t.prototype.lastCloseZonedRate="",t.prototype.lastCloseHigh="",t.prototype.lastCloseLow="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.symbol&&Object.hasOwnProperty.call(t,"symbol")&&e.uint32(10).string(t.symbol),null!=t.price&&Object.hasOwnProperty.call(t,"price")&&e.uint32(18).string(t.price),null!=t.rate&&Object.hasOwnProperty.call(t,"rate")&&e.uint32(26).string(t.rate),null!=t.zonedRate&&Object.hasOwnProperty.call(t,"zonedRate")&&e.uint32(34).string(t.zonedRate),null!=t.high&&Object.hasOwnProperty.call(t,"high")&&e.uint32(42).string(t.high),null!=t.low&&Object.hasOwnProperty.call(t,"low")&&e.uint32(50).string(t.low),null!=t.volume&&Object.hasOwnProperty.call(t,"volume")&&e.uint32(58).string(t.volume),null!=t.quantity&&Object.hasOwnProperty.call(t,"quantity")&&e.uint32(66).string(t.quantity),null!=t.lastCloseRate&&Object.hasOwnProperty.call(t,"lastCloseRate")&&e.uint32(74).string(t.lastCloseRate),null!=t.lastCloseZonedRate&&Object.hasOwnProperty.call(t,"lastCloseZonedRate")&&e.uint32(82).string(t.lastCloseZonedRate),null!=t.lastCloseHigh&&Object.hasOwnProperty.call(t,"lastCloseHigh")&&e.uint32(90).string(t.lastCloseHigh),null!=t.lastCloseLow&&Object.hasOwnProperty.call(t,"lastCloseLow")&&e.uint32(98).string(t.lastCloseLow),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicMiniTickerV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.symbol=t.string();break;case 2:a.price=t.string();break;case 3:a.rate=t.string();break;case 4:a.zonedRate=t.string();break;case 5:a.high=t.string();break;case 6:a.low=t.string();break;case 7:a.volume=t.string();break;case 8:a.quantity=t.string();break;case 9:a.lastCloseRate=t.string();break;case 10:a.lastCloseZonedRate=t.string();break;case 11:a.lastCloseHigh=t.string();break;case 12:a.lastCloseLow=t.string();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.symbol&&t.hasOwnProperty("symbol")&&!n.isString(t.symbol)?"symbol: string expected":null!=t.price&&t.hasOwnProperty("price")&&!n.isString(t.price)?"price: string expected":null!=t.rate&&t.hasOwnProperty("rate")&&!n.isString(t.rate)?"rate: string expected":null!=t.zonedRate&&t.hasOwnProperty("zonedRate")&&!n.isString(t.zonedRate)?"zonedRate: string expected":null!=t.high&&t.hasOwnProperty("high")&&!n.isString(t.high)?"high: string expected":null!=t.low&&t.hasOwnProperty("low")&&!n.isString(t.low)?"low: string expected":null!=t.volume&&t.hasOwnProperty("volume")&&!n.isString(t.volume)?"volume: string expected":null!=t.quantity&&t.hasOwnProperty("quantity")&&!n.isString(t.quantity)?"quantity: string expected":null!=t.lastCloseRate&&t.hasOwnProperty("lastCloseRate")&&!n.isString(t.lastCloseRate)?"lastCloseRate: string expected":null!=t.lastCloseZonedRate&&t.hasOwnProperty("lastCloseZonedRate")&&!n.isString(t.lastCloseZonedRate)?"lastCloseZonedRate: string expected":null!=t.lastCloseHigh&&t.hasOwnProperty("lastCloseHigh")&&!n.isString(t.lastCloseHigh)?"lastCloseHigh: string expected":null!=t.lastCloseLow&&t.hasOwnProperty("lastCloseLow")&&!n.isString(t.lastCloseLow)?"lastCloseLow: string expected":null},t.fromObject=function(t){if(t instanceof o.PublicMiniTickerV3Api)return t;var e=new o.PublicMiniTickerV3Api;return null!=t.symbol&&(e.symbol=String(t.symbol)),null!=t.price&&(e.price=String(t.price)),null!=t.rate&&(e.rate=String(t.rate)),null!=t.zonedRate&&(e.zonedRate=String(t.zonedRate)),null!=t.high&&(e.high=String(t.high)),null!=t.low&&(e.low=String(t.low)),null!=t.volume&&(e.volume=String(t.volume)),null!=t.quantity&&(e.quantity=String(t.quantity)),null!=t.lastCloseRate&&(e.lastCloseRate=String(t.lastCloseRate)),null!=t.lastCloseZonedRate&&(e.lastCloseZonedRate=String(t.lastCloseZonedRate)),null!=t.lastCloseHigh&&(e.lastCloseHigh=String(t.lastCloseHigh)),null!=t.lastCloseLow&&(e.lastCloseLow=String(t.lastCloseLow)),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.symbol="",i.price="",i.rate="",i.zonedRate="",i.high="",i.low="",i.volume="",i.quantity="",i.lastCloseRate="",i.lastCloseZonedRate="",i.lastCloseHigh="",i.lastCloseLow=""),null!=t.symbol&&t.hasOwnProperty("symbol")&&(i.symbol=t.symbol),null!=t.price&&t.hasOwnProperty("price")&&(i.price=t.price),null!=t.rate&&t.hasOwnProperty("rate")&&(i.rate=t.rate),null!=t.zonedRate&&t.hasOwnProperty("zonedRate")&&(i.zonedRate=t.zonedRate),null!=t.high&&t.hasOwnProperty("high")&&(i.high=t.high),null!=t.low&&t.hasOwnProperty("low")&&(i.low=t.low),null!=t.volume&&t.hasOwnProperty("volume")&&(i.volume=t.volume),null!=t.quantity&&t.hasOwnProperty("quantity")&&(i.quantity=t.quantity),null!=t.lastCloseRate&&t.hasOwnProperty("lastCloseRate")&&(i.lastCloseRate=t.lastCloseRate),null!=t.lastCloseZonedRate&&t.hasOwnProperty("lastCloseZonedRate")&&(i.lastCloseZonedRate=t.lastCloseZonedRate),null!=t.lastCloseHigh&&t.hasOwnProperty("lastCloseHigh")&&(i.lastCloseHigh=t.lastCloseHigh),null!=t.lastCloseLow&&t.hasOwnProperty("lastCloseLow")&&(i.lastCloseLow=t.lastCloseLow),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicMiniTickerV3Api"},t}(),o.PublicMiniTickersV3Api=function(){function t(t){if(this.items=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.items=n.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.items&&t.items.length)for(var i=0;i<t.items.length;++i)o.PublicMiniTickerV3Api.encode(t.items[i],e.uint32(10).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicMiniTickersV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;if(n>>>3==1)a.items&&a.items.length||(a.items=[]),a.items.push(o.PublicMiniTickerV3Api.decode(t,t.uint32()));else t.skipType(7&n)}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.items&&t.hasOwnProperty("items")){if(!Array.isArray(t.items))return"items: array expected";for(var e=0;e<t.items.length;++e){var i=o.PublicMiniTickerV3Api.verify(t.items[e]);if(i)return"items."+i}}return null},t.fromObject=function(t){if(t instanceof o.PublicMiniTickersV3Api)return t;var e=new o.PublicMiniTickersV3Api;if(t.items){if(!Array.isArray(t.items))throw TypeError(".PublicMiniTickersV3Api.items: array expected");e.items=[];for(var i=0;i<t.items.length;++i){if("object"!=typeof t.items[i])throw TypeError(".PublicMiniTickersV3Api.items: object expected");e.items[i]=o.PublicMiniTickerV3Api.fromObject(t.items[i])}}return e},t.toObject=function(t,e){e||(e={});var i={};if((e.arrays||e.defaults)&&(i.items=[]),t.items&&t.items.length){i.items=[];for(var s=0;s<t.items.length;++s)i.items[s]=o.PublicMiniTickerV3Api.toObject(t.items[s],e)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicMiniTickersV3Api"},t}(),o.PublicSpotKlineV3Api=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}return t.prototype.interval="",t.prototype.windowStart=n.Long?n.Long.fromBits(0,0,!1):0,t.prototype.openingPrice="",t.prototype.closingPrice="",t.prototype.highestPrice="",t.prototype.lowestPrice="",t.prototype.volume="",t.prototype.amount="",t.prototype.windowEnd=n.Long?n.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.interval&&Object.hasOwnProperty.call(t,"interval")&&e.uint32(10).string(t.interval),null!=t.windowStart&&Object.hasOwnProperty.call(t,"windowStart")&&e.uint32(16).int64(t.windowStart),null!=t.openingPrice&&Object.hasOwnProperty.call(t,"openingPrice")&&e.uint32(26).string(t.openingPrice),null!=t.closingPrice&&Object.hasOwnProperty.call(t,"closingPrice")&&e.uint32(34).string(t.closingPrice),null!=t.highestPrice&&Object.hasOwnProperty.call(t,"highestPrice")&&e.uint32(42).string(t.highestPrice),null!=t.lowestPrice&&Object.hasOwnProperty.call(t,"lowestPrice")&&e.uint32(50).string(t.lowestPrice),null!=t.volume&&Object.hasOwnProperty.call(t,"volume")&&e.uint32(58).string(t.volume),null!=t.amount&&Object.hasOwnProperty.call(t,"amount")&&e.uint32(66).string(t.amount),null!=t.windowEnd&&Object.hasOwnProperty.call(t,"windowEnd")&&e.uint32(72).int64(t.windowEnd),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PublicSpotKlineV3Api;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.interval=t.string();break;case 2:a.windowStart=t.int64();break;case 3:a.openingPrice=t.string();break;case 4:a.closingPrice=t.string();break;case 5:a.highestPrice=t.string();break;case 6:a.lowestPrice=t.string();break;case 7:a.volume=t.string();break;case 8:a.amount=t.string();break;case 9:a.windowEnd=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.interval&&t.hasOwnProperty("interval")&&!n.isString(t.interval)?"interval: string expected":null!=t.windowStart&&t.hasOwnProperty("windowStart")&&!(n.isInteger(t.windowStart)||t.windowStart&&n.isInteger(t.windowStart.low)&&n.isInteger(t.windowStart.high))?"windowStart: integer|Long expected":null!=t.openingPrice&&t.hasOwnProperty("openingPrice")&&!n.isString(t.openingPrice)?"openingPrice: string expected":null!=t.closingPrice&&t.hasOwnProperty("closingPrice")&&!n.isString(t.closingPrice)?"closingPrice: string expected":null!=t.highestPrice&&t.hasOwnProperty("highestPrice")&&!n.isString(t.highestPrice)?"highestPrice: string expected":null!=t.lowestPrice&&t.hasOwnProperty("lowestPrice")&&!n.isString(t.lowestPrice)?"lowestPrice: string expected":null!=t.volume&&t.hasOwnProperty("volume")&&!n.isString(t.volume)?"volume: string expected":null!=t.amount&&t.hasOwnProperty("amount")&&!n.isString(t.amount)?"amount: string expected":null!=t.windowEnd&&t.hasOwnProperty("windowEnd")&&!(n.isInteger(t.windowEnd)||t.windowEnd&&n.isInteger(t.windowEnd.low)&&n.isInteger(t.windowEnd.high))?"windowEnd: integer|Long expected":null},t.fromObject=function(t){if(t instanceof o.PublicSpotKlineV3Api)return t;var e=new o.PublicSpotKlineV3Api;return null!=t.interval&&(e.interval=String(t.interval)),null!=t.windowStart&&(n.Long?(e.windowStart=n.Long.fromValue(t.windowStart)).unsigned=!1:"string"==typeof t.windowStart?e.windowStart=parseInt(t.windowStart,10):"number"==typeof t.windowStart?e.windowStart=t.windowStart:"object"==typeof t.windowStart&&(e.windowStart=new n.LongBits(t.windowStart.low>>>0,t.windowStart.high>>>0).toNumber())),null!=t.openingPrice&&(e.openingPrice=String(t.openingPrice)),null!=t.closingPrice&&(e.closingPrice=String(t.closingPrice)),null!=t.highestPrice&&(e.highestPrice=String(t.highestPrice)),null!=t.lowestPrice&&(e.lowestPrice=String(t.lowestPrice)),null!=t.volume&&(e.volume=String(t.volume)),null!=t.amount&&(e.amount=String(t.amount)),null!=t.windowEnd&&(n.Long?(e.windowEnd=n.Long.fromValue(t.windowEnd)).unsigned=!1:"string"==typeof t.windowEnd?e.windowEnd=parseInt(t.windowEnd,10):"number"==typeof t.windowEnd?e.windowEnd=t.windowEnd:"object"==typeof t.windowEnd&&(e.windowEnd=new n.LongBits(t.windowEnd.low>>>0,t.windowEnd.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};if(e.defaults){if(i.interval="",n.Long){var s=new n.Long(0,0,!1);i.windowStart=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.windowStart=e.longs===String?"0":0;if(i.openingPrice="",i.closingPrice="",i.highestPrice="",i.lowestPrice="",i.volume="",i.amount="",n.Long){s=new n.Long(0,0,!1);i.windowEnd=e.longs===String?s.toString():e.longs===Number?s.toNumber():s}else i.windowEnd=e.longs===String?"0":0}return null!=t.interval&&t.hasOwnProperty("interval")&&(i.interval=t.interval),null!=t.windowStart&&t.hasOwnProperty("windowStart")&&("number"==typeof t.windowStart?i.windowStart=e.longs===String?String(t.windowStart):t.windowStart:i.windowStart=e.longs===String?n.Long.prototype.toString.call(t.windowStart):e.longs===Number?new n.LongBits(t.windowStart.low>>>0,t.windowStart.high>>>0).toNumber():t.windowStart),null!=t.openingPrice&&t.hasOwnProperty("openingPrice")&&(i.openingPrice=t.openingPrice),null!=t.closingPrice&&t.hasOwnProperty("closingPrice")&&(i.closingPrice=t.closingPrice),null!=t.highestPrice&&t.hasOwnProperty("highestPrice")&&(i.highestPrice=t.highestPrice),null!=t.lowestPrice&&t.hasOwnProperty("lowestPrice")&&(i.lowestPrice=t.lowestPrice),null!=t.volume&&t.hasOwnProperty("volume")&&(i.volume=t.volume),null!=t.amount&&t.hasOwnProperty("amount")&&(i.amount=t.amount),null!=t.windowEnd&&t.hasOwnProperty("windowEnd")&&("number"==typeof t.windowEnd?i.windowEnd=e.longs===String?String(t.windowEnd):t.windowEnd:i.windowEnd=e.longs===String?n.Long.prototype.toString.call(t.windowEnd):e.longs===Number?new n.LongBits(t.windowEnd.low>>>0,t.windowEnd.high>>>0).toNumber():t.windowEnd),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PublicSpotKlineV3Api"},t}(),o.PushDataV3ApiWrapper=function(){function t(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)null!=t[e[i]]&&(this[e[i]]=t[e[i]])}var e;return t.prototype.channel="",t.prototype.publicDeals=null,t.prototype.publicIncreaseDepths=null,t.prototype.publicLimitDepths=null,t.prototype.privateOrders=null,t.prototype.publicBookTicker=null,t.prototype.privateDeals=null,t.prototype.privateAccount=null,t.prototype.publicSpotKline=null,t.prototype.publicMiniTicker=null,t.prototype.publicMiniTickers=null,t.prototype.publicBookTickerBatch=null,t.prototype.publicIncreaseDepthsBatch=null,t.prototype.publicAggreDepths=null,t.prototype.publicAggreDeals=null,t.prototype.publicAggreBookTicker=null,t.prototype.symbol=null,t.prototype.symbolId=null,t.prototype.createTime=null,t.prototype.sendTime=null,Object.defineProperty(t.prototype,"body",{get:n.oneOfGetter(e=["publicDeals","publicIncreaseDepths","publicLimitDepths","privateOrders","publicBookTicker","privateDeals","privateAccount","publicSpotKline","publicMiniTicker","publicMiniTickers","publicBookTickerBatch","publicIncreaseDepthsBatch","publicAggreDepths","publicAggreDeals","publicAggreBookTicker"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_symbol",{get:n.oneOfGetter(e=["symbol"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_symbolId",{get:n.oneOfGetter(e=["symbolId"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_createTime",{get:n.oneOfGetter(e=["createTime"]),set:n.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_sendTime",{get:n.oneOfGetter(e=["sendTime"]),set:n.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.channel&&Object.hasOwnProperty.call(t,"channel")&&e.uint32(10).string(t.channel),null!=t.symbol&&Object.hasOwnProperty.call(t,"symbol")&&e.uint32(26).string(t.symbol),null!=t.symbolId&&Object.hasOwnProperty.call(t,"symbolId")&&e.uint32(34).string(t.symbolId),null!=t.createTime&&Object.hasOwnProperty.call(t,"createTime")&&e.uint32(40).int64(t.createTime),null!=t.sendTime&&Object.hasOwnProperty.call(t,"sendTime")&&e.uint32(48).int64(t.sendTime),null!=t.publicDeals&&Object.hasOwnProperty.call(t,"publicDeals")&&o.PublicDealsV3Api.encode(t.publicDeals,e.uint32(2410).fork()).ldelim(),null!=t.publicIncreaseDepths&&Object.hasOwnProperty.call(t,"publicIncreaseDepths")&&o.PublicIncreaseDepthsV3Api.encode(t.publicIncreaseDepths,e.uint32(2418).fork()).ldelim(),null!=t.publicLimitDepths&&Object.hasOwnProperty.call(t,"publicLimitDepths")&&o.PublicLimitDepthsV3Api.encode(t.publicLimitDepths,e.uint32(2426).fork()).ldelim(),null!=t.privateOrders&&Object.hasOwnProperty.call(t,"privateOrders")&&o.PrivateOrdersV3Api.encode(t.privateOrders,e.uint32(2434).fork()).ldelim(),null!=t.publicBookTicker&&Object.hasOwnProperty.call(t,"publicBookTicker")&&o.PublicBookTickerV3Api.encode(t.publicBookTicker,e.uint32(2442).fork()).ldelim(),null!=t.privateDeals&&Object.hasOwnProperty.call(t,"privateDeals")&&o.PrivateDealsV3Api.encode(t.privateDeals,e.uint32(2450).fork()).ldelim(),null!=t.privateAccount&&Object.hasOwnProperty.call(t,"privateAccount")&&o.PrivateAccountV3Api.encode(t.privateAccount,e.uint32(2458).fork()).ldelim(),null!=t.publicSpotKline&&Object.hasOwnProperty.call(t,"publicSpotKline")&&o.PublicSpotKlineV3Api.encode(t.publicSpotKline,e.uint32(2466).fork()).ldelim(),null!=t.publicMiniTicker&&Object.hasOwnProperty.call(t,"publicMiniTicker")&&o.PublicMiniTickerV3Api.encode(t.publicMiniTicker,e.uint32(2474).fork()).ldelim(),null!=t.publicMiniTickers&&Object.hasOwnProperty.call(t,"publicMiniTickers")&&o.PublicMiniTickersV3Api.encode(t.publicMiniTickers,e.uint32(2482).fork()).ldelim(),null!=t.publicBookTickerBatch&&Object.hasOwnProperty.call(t,"publicBookTickerBatch")&&o.PublicBookTickerBatchV3Api.encode(t.publicBookTickerBatch,e.uint32(2490).fork()).ldelim(),null!=t.publicIncreaseDepthsBatch&&Object.hasOwnProperty.call(t,"publicIncreaseDepthsBatch")&&o.PublicIncreaseDepthsBatchV3Api.encode(t.publicIncreaseDepthsBatch,e.uint32(2498).fork()).ldelim(),null!=t.publicAggreDepths&&Object.hasOwnProperty.call(t,"publicAggreDepths")&&o.PublicAggreDepthsV3Api.encode(t.publicAggreDepths,e.uint32(2506).fork()).ldelim(),null!=t.publicAggreDeals&&Object.hasOwnProperty.call(t,"publicAggreDeals")&&o.PublicAggreDealsV3Api.encode(t.publicAggreDeals,e.uint32(2514).fork()).ldelim(),null!=t.publicAggreBookTicker&&Object.hasOwnProperty.call(t,"publicAggreBookTicker")&&o.PublicAggreBookTickerV3Api.encode(t.publicAggreBookTicker,e.uint32(2522).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e,i){t instanceof r||(t=r.create(t));for(var s=void 0===e?t.len:t.pos+e,a=new o.PushDataV3ApiWrapper;t.pos<s;){var n=t.uint32();if(n===i)break;switch(n>>>3){case 1:a.channel=t.string();break;case 301:a.publicDeals=o.PublicDealsV3Api.decode(t,t.uint32());break;case 302:a.publicIncreaseDepths=o.PublicIncreaseDepthsV3Api.decode(t,t.uint32());break;case 303:a.publicLimitDepths=o.PublicLimitDepthsV3Api.decode(t,t.uint32());break;case 304:a.privateOrders=o.PrivateOrdersV3Api.decode(t,t.uint32());break;case 305:a.publicBookTicker=o.PublicBookTickerV3Api.decode(t,t.uint32());break;case 306:a.privateDeals=o.PrivateDealsV3Api.decode(t,t.uint32());break;case 307:a.privateAccount=o.PrivateAccountV3Api.decode(t,t.uint32());break;case 308:a.publicSpotKline=o.PublicSpotKlineV3Api.decode(t,t.uint32());break;case 309:a.publicMiniTicker=o.PublicMiniTickerV3Api.decode(t,t.uint32());break;case 310:a.publicMiniTickers=o.PublicMiniTickersV3Api.decode(t,t.uint32());break;case 311:a.publicBookTickerBatch=o.PublicBookTickerBatchV3Api.decode(t,t.uint32());break;case 312:a.publicIncreaseDepthsBatch=o.PublicIncreaseDepthsBatchV3Api.decode(t,t.uint32());break;case 313:a.publicAggreDepths=o.PublicAggreDepthsV3Api.decode(t,t.uint32());break;case 314:a.publicAggreDeals=o.PublicAggreDealsV3Api.decode(t,t.uint32());break;case 315:a.publicAggreBookTicker=o.PublicAggreBookTickerV3Api.decode(t,t.uint32());break;case 3:a.symbol=t.string();break;case 4:a.symbolId=t.string();break;case 5:a.createTime=t.int64();break;case 6:a.sendTime=t.int64();break;default:t.skipType(7&n)}}return a},t.decodeDelimited=function(t){return t instanceof r||(t=new r(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.channel&&t.hasOwnProperty("channel")&&!n.isString(t.channel))return"channel: string expected";if(null!=t.publicDeals&&t.hasOwnProperty("publicDeals")&&(e.body=1,i=o.PublicDealsV3Api.verify(t.publicDeals)))return"publicDeals."+i;if(null!=t.publicIncreaseDepths&&t.hasOwnProperty("publicIncreaseDepths")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicIncreaseDepthsV3Api.verify(t.publicIncreaseDepths))return"publicIncreaseDepths."+i}if(null!=t.publicLimitDepths&&t.hasOwnProperty("publicLimitDepths")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicLimitDepthsV3Api.verify(t.publicLimitDepths))return"publicLimitDepths."+i}if(null!=t.privateOrders&&t.hasOwnProperty("privateOrders")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PrivateOrdersV3Api.verify(t.privateOrders))return"privateOrders."+i}if(null!=t.publicBookTicker&&t.hasOwnProperty("publicBookTicker")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicBookTickerV3Api.verify(t.publicBookTicker))return"publicBookTicker."+i}if(null!=t.privateDeals&&t.hasOwnProperty("privateDeals")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PrivateDealsV3Api.verify(t.privateDeals))return"privateDeals."+i}if(null!=t.privateAccount&&t.hasOwnProperty("privateAccount")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PrivateAccountV3Api.verify(t.privateAccount))return"privateAccount."+i}if(null!=t.publicSpotKline&&t.hasOwnProperty("publicSpotKline")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicSpotKlineV3Api.verify(t.publicSpotKline))return"publicSpotKline."+i}if(null!=t.publicMiniTicker&&t.hasOwnProperty("publicMiniTicker")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicMiniTickerV3Api.verify(t.publicMiniTicker))return"publicMiniTicker."+i}if(null!=t.publicMiniTickers&&t.hasOwnProperty("publicMiniTickers")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicMiniTickersV3Api.verify(t.publicMiniTickers))return"publicMiniTickers."+i}if(null!=t.publicBookTickerBatch&&t.hasOwnProperty("publicBookTickerBatch")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicBookTickerBatchV3Api.verify(t.publicBookTickerBatch))return"publicBookTickerBatch."+i}if(null!=t.publicIncreaseDepthsBatch&&t.hasOwnProperty("publicIncreaseDepthsBatch")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicIncreaseDepthsBatchV3Api.verify(t.publicIncreaseDepthsBatch))return"publicIncreaseDepthsBatch."+i}if(null!=t.publicAggreDepths&&t.hasOwnProperty("publicAggreDepths")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicAggreDepthsV3Api.verify(t.publicAggreDepths))return"publicAggreDepths."+i}if(null!=t.publicAggreDeals&&t.hasOwnProperty("publicAggreDeals")){if(1===e.body)return"body: multiple values";if(e.body=1,i=o.PublicAggreDealsV3Api.verify(t.publicAggreDeals))return"publicAggreDeals."+i}if(null!=t.publicAggreBookTicker&&t.hasOwnProperty("publicAggreBookTicker")){if(1===e.body)return"body: multiple values";var i;if(e.body=1,i=o.PublicAggreBookTickerV3Api.verify(t.publicAggreBookTicker))return"publicAggreBookTicker."+i}return null!=t.symbol&&t.hasOwnProperty("symbol")&&(e._symbol=1,!n.isString(t.symbol))?"symbol: string expected":null!=t.symbolId&&t.hasOwnProperty("symbolId")&&(e._symbolId=1,!n.isString(t.symbolId))?"symbolId: string expected":null==t.createTime||!t.hasOwnProperty("createTime")||(e._createTime=1,n.isInteger(t.createTime)||t.createTime&&n.isInteger(t.createTime.low)&&n.isInteger(t.createTime.high))?null==t.sendTime||!t.hasOwnProperty("sendTime")||(e._sendTime=1,n.isInteger(t.sendTime)||t.sendTime&&n.isInteger(t.sendTime.low)&&n.isInteger(t.sendTime.high))?null:"sendTime: integer|Long expected":"createTime: integer|Long expected"},t.fromObject=function(t){if(t instanceof o.PushDataV3ApiWrapper)return t;var e=new o.PushDataV3ApiWrapper;if(null!=t.channel&&(e.channel=String(t.channel)),null!=t.publicDeals){if("object"!=typeof t.publicDeals)throw TypeError(".PushDataV3ApiWrapper.publicDeals: object expected");e.publicDeals=o.PublicDealsV3Api.fromObject(t.publicDeals)}if(null!=t.publicIncreaseDepths){if("object"!=typeof t.publicIncreaseDepths)throw TypeError(".PushDataV3ApiWrapper.publicIncreaseDepths: object expected");e.publicIncreaseDepths=o.PublicIncreaseDepthsV3Api.fromObject(t.publicIncreaseDepths)}if(null!=t.publicLimitDepths){if("object"!=typeof t.publicLimitDepths)throw TypeError(".PushDataV3ApiWrapper.publicLimitDepths: object expected");e.publicLimitDepths=o.PublicLimitDepthsV3Api.fromObject(t.publicLimitDepths)}if(null!=t.privateOrders){if("object"!=typeof t.privateOrders)throw TypeError(".PushDataV3ApiWrapper.privateOrders: object expected");e.privateOrders=o.PrivateOrdersV3Api.fromObject(t.privateOrders)}if(null!=t.publicBookTicker){if("object"!=typeof t.publicBookTicker)throw TypeError(".PushDataV3ApiWrapper.publicBookTicker: object expected");e.publicBookTicker=o.PublicBookTickerV3Api.fromObject(t.publicBookTicker)}if(null!=t.privateDeals){if("object"!=typeof t.privateDeals)throw TypeError(".PushDataV3ApiWrapper.privateDeals: object expected");e.privateDeals=o.PrivateDealsV3Api.fromObject(t.privateDeals)}if(null!=t.privateAccount){if("object"!=typeof t.privateAccount)throw TypeError(".PushDataV3ApiWrapper.privateAccount: object expected");e.privateAccount=o.PrivateAccountV3Api.fromObject(t.privateAccount)}if(null!=t.publicSpotKline){if("object"!=typeof t.publicSpotKline)throw TypeError(".PushDataV3ApiWrapper.publicSpotKline: object expected");e.publicSpotKline=o.PublicSpotKlineV3Api.fromObject(t.publicSpotKline)}if(null!=t.publicMiniTicker){if("object"!=typeof t.publicMiniTicker)throw TypeError(".PushDataV3ApiWrapper.publicMiniTicker: object expected");e.publicMiniTicker=o.PublicMiniTickerV3Api.fromObject(t.publicMiniTicker)}if(null!=t.publicMiniTickers){if("object"!=typeof t.publicMiniTickers)throw TypeError(".PushDataV3ApiWrapper.publicMiniTickers: object expected");e.publicMiniTickers=o.PublicMiniTickersV3Api.fromObject(t.publicMiniTickers)}if(null!=t.publicBookTickerBatch){if("object"!=typeof t.publicBookTickerBatch)throw TypeError(".PushDataV3ApiWrapper.publicBookTickerBatch: object expected");e.publicBookTickerBatch=o.PublicBookTickerBatchV3Api.fromObject(t.publicBookTickerBatch)}if(null!=t.publicIncreaseDepthsBatch){if("object"!=typeof t.publicIncreaseDepthsBatch)throw TypeError(".PushDataV3ApiWrapper.publicIncreaseDepthsBatch: object expected");e.publicIncreaseDepthsBatch=o.PublicIncreaseDepthsBatchV3Api.fromObject(t.publicIncreaseDepthsBatch)}if(null!=t.publicAggreDepths){if("object"!=typeof t.publicAggreDepths)throw TypeError(".PushDataV3ApiWrapper.publicAggreDepths: object expected");e.publicAggreDepths=o.PublicAggreDepthsV3Api.fromObject(t.publicAggreDepths)}if(null!=t.publicAggreDeals){if("object"!=typeof t.publicAggreDeals)throw TypeError(".PushDataV3ApiWrapper.publicAggreDeals: object expected");e.publicAggreDeals=o.PublicAggreDealsV3Api.fromObject(t.publicAggreDeals)}if(null!=t.publicAggreBookTicker){if("object"!=typeof t.publicAggreBookTicker)throw TypeError(".PushDataV3ApiWrapper.publicAggreBookTicker: object expected");e.publicAggreBookTicker=o.PublicAggreBookTickerV3Api.fromObject(t.publicAggreBookTicker)}return null!=t.symbol&&(e.symbol=String(t.symbol)),null!=t.symbolId&&(e.symbolId=String(t.symbolId)),null!=t.createTime&&(n.Long?(e.createTime=n.Long.fromValue(t.createTime)).unsigned=!1:"string"==typeof t.createTime?e.createTime=parseInt(t.createTime,10):"number"==typeof t.createTime?e.createTime=t.createTime:"object"==typeof t.createTime&&(e.createTime=new n.LongBits(t.createTime.low>>>0,t.createTime.high>>>0).toNumber())),null!=t.sendTime&&(n.Long?(e.sendTime=n.Long.fromValue(t.sendTime)).unsigned=!1:"string"==typeof t.sendTime?e.sendTime=parseInt(t.sendTime,10):"number"==typeof t.sendTime?e.sendTime=t.sendTime:"object"==typeof t.sendTime&&(e.sendTime=new n.LongBits(t.sendTime.low>>>0,t.sendTime.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var i={};return e.defaults&&(i.channel=""),null!=t.channel&&t.hasOwnProperty("channel")&&(i.channel=t.channel),null!=t.symbol&&t.hasOwnProperty("symbol")&&(i.symbol=t.symbol,e.oneofs&&(i._symbol="symbol")),null!=t.symbolId&&t.hasOwnProperty("symbolId")&&(i.symbolId=t.symbolId,e.oneofs&&(i._symbolId="symbolId")),null!=t.createTime&&t.hasOwnProperty("createTime")&&("number"==typeof t.createTime?i.createTime=e.longs===String?String(t.createTime):t.createTime:i.createTime=e.longs===String?n.Long.prototype.toString.call(t.createTime):e.longs===Number?new n.LongBits(t.createTime.low>>>0,t.createTime.high>>>0).toNumber():t.createTime,e.oneofs&&(i._createTime="createTime")),null!=t.sendTime&&t.hasOwnProperty("sendTime")&&("number"==typeof t.sendTime?i.sendTime=e.longs===String?String(t.sendTime):t.sendTime:i.sendTime=e.longs===String?n.Long.prototype.toString.call(t.sendTime):e.longs===Number?new n.LongBits(t.sendTime.low>>>0,t.sendTime.high>>>0).toNumber():t.sendTime,e.oneofs&&(i._sendTime="sendTime")),null!=t.publicDeals&&t.hasOwnProperty("publicDeals")&&(i.publicDeals=o.PublicDealsV3Api.toObject(t.publicDeals,e),e.oneofs&&(i.body="publicDeals")),null!=t.publicIncreaseDepths&&t.hasOwnProperty("publicIncreaseDepths")&&(i.publicIncreaseDepths=o.PublicIncreaseDepthsV3Api.toObject(t.publicIncreaseDepths,e),e.oneofs&&(i.body="publicIncreaseDepths")),null!=t.publicLimitDepths&&t.hasOwnProperty("publicLimitDepths")&&(i.publicLimitDepths=o.PublicLimitDepthsV3Api.toObject(t.publicLimitDepths,e),e.oneofs&&(i.body="publicLimitDepths")),null!=t.privateOrders&&t.hasOwnProperty("privateOrders")&&(i.privateOrders=o.PrivateOrdersV3Api.toObject(t.privateOrders,e),e.oneofs&&(i.body="privateOrders")),null!=t.publicBookTicker&&t.hasOwnProperty("publicBookTicker")&&(i.publicBookTicker=o.PublicBookTickerV3Api.toObject(t.publicBookTicker,e),e.oneofs&&(i.body="publicBookTicker")),null!=t.privateDeals&&t.hasOwnProperty("privateDeals")&&(i.privateDeals=o.PrivateDealsV3Api.toObject(t.privateDeals,e),e.oneofs&&(i.body="privateDeals")),null!=t.privateAccount&&t.hasOwnProperty("privateAccount")&&(i.privateAccount=o.PrivateAccountV3Api.toObject(t.privateAccount,e),e.oneofs&&(i.body="privateAccount")),null!=t.publicSpotKline&&t.hasOwnProperty("publicSpotKline")&&(i.publicSpotKline=o.PublicSpotKlineV3Api.toObject(t.publicSpotKline,e),e.oneofs&&(i.body="publicSpotKline")),null!=t.publicMiniTicker&&t.hasOwnProperty("publicMiniTicker")&&(i.publicMiniTicker=o.PublicMiniTickerV3Api.toObject(t.publicMiniTicker,e),e.oneofs&&(i.body="publicMiniTicker")),null!=t.publicMiniTickers&&t.hasOwnProperty("publicMiniTickers")&&(i.publicMiniTickers=o.PublicMiniTickersV3Api.toObject(t.publicMiniTickers,e),e.oneofs&&(i.body="publicMiniTickers")),null!=t.publicBookTickerBatch&&t.hasOwnProperty("publicBookTickerBatch")&&(i.publicBookTickerBatch=o.PublicBookTickerBatchV3Api.toObject(t.publicBookTickerBatch,e),e.oneofs&&(i.body="publicBookTickerBatch")),null!=t.publicIncreaseDepthsBatch&&t.hasOwnProperty("publicIncreaseDepthsBatch")&&(i.publicIncreaseDepthsBatch=o.PublicIncreaseDepthsBatchV3Api.toObject(t.publicIncreaseDepthsBatch,e),e.oneofs&&(i.body="publicIncreaseDepthsBatch")),null!=t.publicAggreDepths&&t.hasOwnProperty("publicAggreDepths")&&(i.publicAggreDepths=o.PublicAggreDepthsV3Api.toObject(t.publicAggreDepths,e),e.oneofs&&(i.body="publicAggreDepths")),null!=t.publicAggreDeals&&t.hasOwnProperty("publicAggreDeals")&&(i.publicAggreDeals=o.PublicAggreDealsV3Api.toObject(t.publicAggreDeals,e),e.oneofs&&(i.body="publicAggreDeals")),null!=t.publicAggreBookTicker&&t.hasOwnProperty("publicAggreBookTicker")&&(i.publicAggreBookTicker=o.PublicAggreBookTickerV3Api.toObject(t.publicAggreBookTicker,e),e.oneofs&&(i.body="publicAggreBookTicker")),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/PushDataV3ApiWrapper"},t}(),t.exports=o},2403(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(9174),r=i(2079),a=i(1579),n=i(5147),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"mexc",name:"MEXC Global",countries:["SC"],rateLimit:50,version:"v3",certified:!0,pro:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!1,option:!1,addMargin:!0,borrowCrossMargin:!1,borrowIsolatedMargin:!1,borrowMargin:!1,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:void 0,closeAllPositions:!1,closePosition:!1,createDepositAddress:!0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!0,createMarketSellOrderWithCost:!0,createOrder:!0,createOrders:!0,createPostOnlyOrder:!0,createReduceOnlyOrder:!0,createStopLimitOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTriggerOrder:!0,deposit:void 0,editOrder:void 0,fetchAccounts:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchBorrowInterest:!1,fetchBorrowRate:!1,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchBorrowRates:!1,fetchBorrowRatesPerSymbol:!1,fetchCanceledOrders:!0,fetchClosedOrder:void 0,fetchClosedOrders:!0,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:void 0,fetchDepositAddress:!0,fetchDepositAddresses:void 0,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingInterval:!0,fetchFundingIntervals:!1,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!1,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchIsolatedPositions:!1,fetchL2OrderBook:!0,fetchLedger:void 0,fetchLedgerEntry:void 0,fetchLeverage:!0,fetchLeverages:!1,fetchLeverageTiers:!0,fetchMarginAdjustmentHistory:!1,fetchMarginMode:!1,fetchMarketLeverageTiers:"emulated",fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!1,fetchOpenInterestHistory:!1,fetchOpenOrder:void 0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:void 0,fetchOrders:!0,fetchOrderTrades:!0,fetchPosition:"emulated",fetchPositionHistory:"emulated",fetchPositionMode:!0,fetchPositions:!0,fetchPositionsHistory:!0,fetchPositionsRisk:void 0,fetchPremiumIndexOHLCV:!1,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!1,fetchTradingLimits:void 0,fetchTransactionFee:"emulated",fetchTransactionFees:!0,fetchTransactions:void 0,fetchTransfer:!0,fetchTransfers:!0,fetchWithdrawal:void 0,fetchWithdrawals:!0,reduceMargin:!0,repayCrossMargin:!1,repayIsolatedMargin:!1,setLeverage:!0,setMarginMode:!0,setPositionMode:!0,signIn:void 0,transfer:void 0,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/137283979-8b2a818d-8633-461b-bfca-de89e8c446b2.jpg",api:{spot:{public:"https://api.mexc.com",private:"https://api.mexc.com"},spot2:{public:"https://www.mexc.com/open/api/v2",private:"https://www.mexc.com/open/api/v2"},contract:{public:"https://contract.mexc.com/api/v1/contract",private:"https://contract.mexc.com/api/v1/private"},broker:{private:"https://api.mexc.com/api/v3/broker"}},www:"https://www.mexc.com/",doc:["https://mexcdevelop.github.io/apidocs/"],fees:["https://www.mexc.com/fee"],referral:"https://www.mexc.com/register?inviteCode=mexc-1FQ1GNu1"},api:{spot:{public:{get:{ping:1,time:1,defaultSymbols:1,exchangeInfo:10,depth:1,trades:5,historicalTrades:1,aggTrades:1,klines:1,avgPrice:1,"ticker/24hr":1,"ticker/price":1,"ticker/bookTicker":1,"etf/info":1}},private:{get:{"kyc/status":1,uid:1,order:2,openOrders:3,allOrders:10,account:10,myTrades:10,"strategy/group":20,"strategy/group/uid":20,tradeFee:10,"sub-account/list":1,"sub-account/apiKey":1,"sub-account/asset":1,"capital/config/getall":10,"capital/deposit/hisrec":1,"capital/withdraw/history":1,"capital/withdraw/address":10,"capital/deposit/address":10,"capital/transfer":1,"capital/transfer/tranId":1,"capital/transfer/internal":1,"capital/sub-account/universalTransfer":1,"capital/convert":1,"capital/convert/list":1,"margin/loan":1,"margin/allOrders":1,"margin/myTrades":1,"margin/openOrders":1,"margin/maxTransferable":1,"margin/priceIndex":1,"margin/order":1,"margin/isolated/account":1,"margin/maxBorrowable":1,"margin/repay":1,"margin/isolated/pair":1,"margin/forceLiquidationRec":1,"margin/isolatedMarginData":1,"margin/isolatedMarginTier":1,"rebate/taxQuery":1,"rebate/detail":1,"rebate/detail/kickback":1,"rebate/referCode":1,"rebate/affiliate/commission":1,"rebate/affiliate/withdraw":1,"rebate/affiliate/commission/detail":1,"mxDeduct/enable":1,userDataStream:1,selfSymbols:1,"asset/internal/transfer/record":10},post:{order:1,"order/test":1,"sub-account/virtualSubAccount":1,"sub-account/apiKey":1,"sub-account/futures":1,"sub-account/margin":1,batchOrders:10,"strategy/group":20,"capital/withdraw/apply":1,"capital/withdraw":1,"capital/transfer":1,"capital/transfer/internal":1,"capital/deposit/address":1,"capital/sub-account/universalTransfer":1,"capital/convert":10,"mxDeduct/enable":1,userDataStream:1},put:{userDataStream:1},delete:{order:1,openOrders:1,"sub-account/apiKey":1,"margin/order":1,"margin/openOrders":1,userDataStream:1,"capital/withdraw":1}}},contract:{public:{get:{ping:2,detail:100,support_currencies:2,"depth/{symbol}":2,"depth_commits/{symbol}/{limit}":2,"index_price/{symbol}":2,"fair_price/{symbol}":2,"funding_rate/{symbol}":2,"kline/{symbol}":2,"kline/index_price/{symbol}":2,"kline/fair_price/{symbol}":2,"deals/{symbol}":2,ticker:2,risk_reverse:2,"risk_reverse/history":2,"funding_rate/history":2}},private:{get:{"account/assets":2,"account/asset/{currency}":2,"account/transfer_record":2,"position/list/history_positions":2,"position/open_positions":2,"position/funding_records":2,"position/position_mode":2,"order/list/open_orders/{symbol}":2,"order/list/history_orders":2,"order/external/{symbol}/{external_oid}":2,"order/get/{order_id}":2,"order/batch_query":8,"order/deal_details/{order_id}":2,"order/list/order_deals":2,"planorder/list/orders":2,"stoporder/list/orders":2,"stoporder/order_details/{stop_order_id}":2,"account/risk_limit":2,"account/tiered_fee_rate":2,"position/leverage":2},post:{"position/change_margin":2,"position/change_leverage":2,"position/change_position_mode":2,"order/submit":2,"order/submit_batch":40,"order/cancel":2,"order/cancel_with_external":2,"order/cancel_all":2,"account/change_risk_level":2,"planorder/place":2,"planorder/cancel":2,"planorder/cancel_all":2,"stoporder/cancel":2,"stoporder/cancel_all":2,"stoporder/change_price":2,"stoporder/change_plan_price":2}}},spot2:{public:{get:{"market/symbols":1,"market/coin/list":2,"common/timestamp":1,"common/ping":2,"market/ticker":1,"market/depth":1,"market/deals":1,"market/kline":1,"market/api_default_symbols":2}},private:{get:{"account/info":1,"order/open_orders":1,"order/list":1,"order/query":1,"order/deals":1,"order/deal_detail":1,"asset/deposit/address/list":2,"asset/deposit/list":2,"asset/address/list":2,"asset/withdraw/list":2,"asset/internal/transfer/record":10,"account/balance":10,"asset/internal/transfer/info":10,"market/api_symbols":2},post:{"order/place":1,"order/place_batch":1,"order/advanced/place_batch":1,"asset/withdraw":2,"asset/internal/transfer":10},delete:{"order/cancel":1,"order/cancel_by_symbol":1,"asset/withdraw":2}}},broker:{private:{get:{"sub-account/universalTransfer":1,"sub-account/list":1,"sub-account/apiKey":1,"capital/deposit/subAddress":1,"capital/deposit/subHisrec":1,"capital/deposit/subHisrec/getall":1},post:{"sub-account/virtualSubAccount":1,"sub-account/apiKey":1,"capital/deposit/subAddress":1,"capital/withdraw/apply":1,"sub-account/universalTransfer":1,"sub-account/futures":1},delete:{"sub-account/apiKey":1}}}},precisionMode:a.kb,timeframes:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","4h":"4h","8h":"8h","1d":"1d","1w":"1w","1M":"1M"},fees:{trading:{tierBased:!1,percentage:!0,maker:this.parseNumber("0.002"),taker:this.parseNumber("0.002")}},options:{adjustForTimeDifference:!1,timeDifference:0,unavailableContracts:{"BTC/USDT:USDT":!0,"LTC/USDT:USDT":!0,"ETH/USDT:USDT":!0},fetchMarkets:{types:{spot:!0,swap:{linear:!0,inverse:!1}}},useCcxtTradeId:!0,timeframes:{spot:{"1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"60m","4h":"4h","1d":"1d","1w":"1W","1M":"1M"},swap:{"1m":"Min1","5m":"Min5","15m":"Min15","30m":"Min30","1h":"Min60","4h":"Hour4","8h":"Hour8","1d":"Day1","1w":"Week1","1M":"Month1"}},defaultType:"spot",defaultNetwork:"ETH",defaultNetworks:{ETH:"ETH",USDT:"ERC20",USDC:"ERC20",BTC:"BTC",LTC:"LTC"},networks:{ZKSYNC:"ZKSYNCERA",TRC20:"TRX",TON:"TONCOIN",ARBITRUM:"ARB",STX:"STACKS",LUNC:"LUNA",STARK:"STARKNET",APT:"APTOS",PEAQ:"PEAQEVM",AVAXC:"AVAX_CCHAIN",ERC20:"ETH",ACA:"ACALA",BEP20:"BSC",OPTIMISM:"OP",ASTR:"ASTAR",BTM:"BTM2",CRC20:"CRONOS",DOT:"DOTASSETHUB",ETHF:"ETF",HRC20:"HECO",OASIS:"ROSE",OKC:"OKT",RSK:"RBTC"},networksById:{"BNB Smart Chain(BEP20-RACAV1)":"BSC","BNB Smart Chain(BEP20-RACAV2)":"BSC","BNB Smart Chain(BEP20)":"BSC","Ethereum(ERC20)":"ERC20"},recvWindow:5e3,maxTimeTillEnd:7775999999,broker:"CCXT"},features:{default:{sandbox:!1,createOrder:{marginMode:!0,triggerPrice:!1,triggerDirection:!1,triggerPriceType:{last:!1,mark:!1,index:!1},stopLossPrice:!1,takeProfitPrice:!1,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!0,trailing:!1,leverage:!0,marketBuyByCost:!0,marketBuyRequiresPrice:!1,selfTradePrevention:!1,iceberg:!1},createOrders:{max:20},fetchMyTrades:{marginMode:!1,limit:100,daysBack:30,untilDays:void 0,symbolRequired:!0},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:void 0,trigger:!1,trailing:!1,symbolRequired:!0},fetchOrders:{marginMode:!0,limit:1e3,daysBack:7,untilDays:7,trigger:!1,trailing:!1,symbolRequired:!0},fetchClosedOrders:{marginMode:!0,limit:1e3,daysBack:7,daysBackCanceled:7,untilDays:7,trigger:!1,trailing:!1,symbolRequired:!0},fetchOHLCV:{limit:1e3}},spot:{extends:"default",fetchCurrencies:{private:!0}},forDerivs:{extends:"default",createOrder:{triggerPrice:!0,triggerPriceType:{last:!0,mark:!0,index:!0},triggerDirection:!0,stopLossPrice:!1,takeProfitPrice:!1,hedged:!0,leverage:!0,marketBuyByCost:!1},createOrders:void 0,fetchMyTrades:{marginMode:!1,limit:100,daysBack:90,untilDays:90},fetchOrder:{marginMode:!1},fetchOpenOrders:{marginMode:!1,limit:100,trigger:!0,trailing:!1},fetchOrders:{marginMode:!1,limit:100,daysBack:90,untilDays:90,trigger:!0,trailing:!1},fetchClosedOrders:{marginMode:!1,limit:100,daysBack:90,daysBackCanceled:void 0,untilDays:90,trigger:!0,trailing:!1},fetchOHLCV:{limit:2e3}},swap:{linear:{extends:"forDerivs"},inverse:{extends:"forDerivs"}},future:{linear:void 0,inverse:void 0}},commonCurrencies:{BEYONDPROTOCOL:"BEYOND",BIFI:"BIFIF",BYN:"BEYONDFI",COFI:"COFIX",DFI:"DFISTARTER",DFT:"DFUTURE",DRK:"DRK",EGC:"EGORASCREDIT",FLUX1:"FLUX",FLUX:"FLUX1",FREE:"FREEROSSDAO",GAS:"GASDAO",GASNEO:"GAS",GMT:"GMTTOKEN",STEPN:"GMT",HERO:"STEPHERO",MIMO:"MIMOSA",PROS:"PROSFINANCE",SIN:"SINCITYTOKEN",SOUL:"SOULSWAP",XBT:"XBT"},exceptions:{exact:{"-1128":r.BadRequest,"-2011":r.BadRequest,"-1121":r.BadSymbol,10101:r.InsufficientFunds,2009:r.InvalidOrder,2011:r.BadRequest,30004:r.InsufficientFunds,33333:r.BadRequest,44444:r.BadRequest,1002:r.InvalidOrder,30019:r.BadRequest,30005:r.InvalidOrder,2003:r.InvalidOrder,2005:r.InsufficientFunds,400:r.BadRequest,600:r.BadRequest,70011:r.PermissionDenied,88004:r.InsufficientFunds,88009:r.ExchangeError,88013:r.InvalidOrder,88015:r.InsufficientFunds,700003:r.InvalidNonce,26:r.ExchangeError,602:r.AuthenticationError,10001:r.AuthenticationError,10007:r.BadSymbol,10015:r.BadRequest,10072:r.BadRequest,10073:r.BadRequest,10095:r.InvalidOrder,10096:r.InvalidOrder,10097:r.InvalidOrder,10098:r.InvalidOrder,10099:r.BadRequest,10100:r.BadRequest,10102:r.InvalidOrder,10103:r.ExchangeError,10200:r.BadRequest,10201:r.BadRequest,10202:r.BadRequest,10206:r.BadRequest,10211:r.BadRequest,10212:r.BadRequest,10216:r.ExchangeError,10219:r.ExchangeError,10222:r.BadRequest,10232:r.BadRequest,10259:r.ExchangeError,10265:r.ExchangeError,10268:r.BadRequest,20001:r.ExchangeError,20002:r.ExchangeError,22222:r.BadRequest,3e4:r.ExchangeError,30001:r.InvalidOrder,30002:r.InvalidOrder,30003:r.InvalidOrder,30010:r.InvalidOrder,30014:r.InvalidOrder,30016:r.InvalidOrder,30018:r.AccountSuspended,30020:r.AuthenticationError,30021:r.BadRequest,30025:r.InvalidOrder,30026:r.BadRequest,30027:r.InvalidOrder,30028:r.InvalidOrder,30029:r.InvalidOrder,30032:r.InvalidOrder,30041:r.InvalidOrder,30087:r.InvalidOrder,60005:r.ExchangeError,700001:r.AuthenticationError,700002:r.AuthenticationError,700004:r.BadRequest,700005:r.InvalidNonce,700006:r.BadRequest,700007:r.AuthenticationError,700008:r.BadRequest,700013:r.AuthenticationError,730001:r.BadRequest,730002:r.BadRequest,73e4:r.ExchangeError,730003:r.ExchangeError,730100:r.ExchangeError,730600:r.BadRequest,730601:r.BadRequest,730602:r.BadRequest,730700:r.BadRequest,730701:r.BadRequest,730702:r.BadRequest,730703:r.BadRequest,730704:r.BadRequest,730705:r.BadRequest,730706:r.BadRequest,730707:r.BadRequest,730101:r.BadRequest,140001:r.BadRequest,140002:r.AuthenticationError},broad:{"Order quantity error, please try to modify.":r.BadRequest,"Combination of optional parameters invalid":r.BadRequest,"api market order is disabled":r.BadRequest,"Contract not allow place order!":r.InvalidOrder,Oversold:r.InsufficientFunds,"Insufficient position":r.InsufficientFunds,"Insufficient balance!":r.InsufficientFunds,"Bid price is great than max allow price":r.InvalidOrder,"Invalid symbol.":r.BadSymbol,"Param error!":r.BadRequest,maintenance:r.OnMaintenance}}})}async fetchStatus(t={}){const[e,i]=this.handleMarketTypeAndParams("fetchStatus",void 0,t);let s,r,a;if("spot"===e){s=await this.spotPublicGetPing(i);r=Object.keys(s).length?this.json(s):"ok"}else"swap"===e&&(s=await this.contractPublicGetPing(i),r=this.safeValue(s,"success")?"ok":this.json(s),a=this.safeInteger(s,"data"));return{status:r,updated:a,url:void 0,eta:void 0,info:s}}async fetchTime(t={}){const[e,i]=this.handleMarketTypeAndParams("fetchTime",void 0,t);let s;return"spot"===e?(s=await this.spotPublicGetTime(i),this.safeInteger(s,"serverTime")):"swap"===e?(s=await this.contractPublicGetPing(i),this.safeInteger(s,"data")):void 0}async fetchCurrencies(t={}){if(!this.checkRequiredCredentials(!1))return{};const e=await this.spotPrivateGetCapitalConfigGetall(t),i={};for(let t=0;t<e.length;t++){const s=e[t],r=this.safeString(s,"coin"),a=this.safeCurrencyCode(r),n={},o=this.safeValue(s,"networkList",[]);for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString2(e,"netWork","network"),s=this.networkIdToCode(i);n[s]={info:e,id:i,network:s,active:void 0,deposit:this.safeBool(e,"depositEnable",!1),withdraw:this.safeBool(e,"withdrawEnable",!1),fee:this.safeNumber(e,"withdrawFee"),precision:void 0,limits:{withdraw:{min:this.safeString(e,"withdrawMin"),max:this.safeString(e,"withdrawMax")}},contract:this.safeString(e,"contract")}}i[a]=this.safeCurrencyStructure({info:s,id:r,code:a,name:this.safeString(s,"name"),active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0}},type:"crypto",networks:n})}return i}async fetchMarkets(t={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference();const e=this.fetchSpotMarkets(t),i=this.fetchSwapMarkets(t),[s,r]=await Promise.all([e,i]);return this.arrayConcat(s,r)}async fetchSpotMarkets(t={}){const e=await this.spotPublicGetExchangeInfo(t),i=this.safeValue(e,"symbols",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"symbol"),a=this.safeString(e,"baseAsset"),n=this.safeString(e,"quoteAsset"),o=this.safeCurrencyCode(a),d=this.safeCurrencyCode(n),c=this.safeString(e,"status"),h=this.safeValue(e,"isSpotTradingAllowed");let l=!1;"1"===c&&h&&(l=!0);const u=this.safeValue(e,"isMarginTradingAllowed"),p=this.safeNumber(e,"makerCommission"),f=this.safeNumber(e,"takerCommission"),m=this.safeNumber(e,"maxQuoteAmount");s.push({id:r,symbol:o+"/"+d,base:o,quote:d,settle:void 0,baseId:a,quoteId:n,settleId:void 0,type:"spot",spot:!0,margin:u,swap:!1,future:!1,option:!1,active:l,contract:!1,linear:void 0,inverse:void 0,taker:f,maker:p,contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.parseNumber(this.parsePrecision(this.safeString(e,"baseAssetPrecision"))),price:this.parseNumber(this.parsePrecision(this.safeString(e,"quoteAssetPrecision")))},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(e,"baseSizePrecision"),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(e,"quoteAmountPrecision"),max:m}},created:void 0,info:e})}return s}async fetchSwapMarkets(t={}){const e=this.rateLimit;this.setProperty(this,"rateLimit",10);const i=await this.contractPublicGetDetail(t);this.setProperty(this,"rateLimit",e);const s=this.safeValue(i,"data",[]),r=[];for(let t=0;t<s.length;t++){const e=s[t],i=this.safeString(e,"symbol"),a=this.safeString(e,"baseCoin"),n=this.safeString(e,"quoteCoin"),o=this.safeString(e,"settleCoin"),d=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),h=this.safeCurrencyCode(o),l=this.safeString(e,"state"),u=c===h;r.push({id:i,symbol:d+"/"+c+":"+h,base:d,quote:c,settle:h,baseId:a,quoteId:n,settleId:o,type:"swap",spot:!1,margin:!1,swap:!0,future:!1,option:!1,active:"0"===l,contract:!0,linear:u,inverse:!u,taker:this.safeNumber(e,"takerFeeRate"),maker:this.safeNumber(e,"makerFeeRate"),contractSize:this.safeNumber(e,"contractSize"),expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(e,"volUnit"),price:this.safeNumber(e,"priceUnit")},limits:{leverage:{min:this.safeNumber(e,"minLeverage"),max:this.safeNumber(e,"maxLeverage")},amount:{min:this.safeNumber(e,"minVol"),max:this.safeNumber(e,"maxVol")},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},created:void 0,info:e})}return r}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r={symbol:s.id};let a;if(void 0!==e&&(r.limit=e),s.spot){const e=await this.spotPublicGetDepth(this.extend(r,i)),s=this.safeInteger(e,"timestamp");a=this.parseOrderBook(e,t,s),a.nonce=this.safeInteger(e,"lastUpdateId")}else if(s.swap){const e=await this.contractPublicGetDepthSymbol(this.extend(r,i)),s=this.safeValue(e,"data"),n=this.safeInteger(s,"timestamp");a=this.parseOrderBook(s,t,n),a.nonce=this.safeInteger(s,"version")}return a}parseBidAsk(t,e=0,i=1,s=2){const r=this.safeNumber(t,e),a=this.safeNumber(t,i),n=this.safeNumber(t,2);return void 0!==n?[r,a,n]:[r,a]}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=this.market(t),n={symbol:a.id};let o;if(void 0!==i&&(n.limit=i),a.spot){const t=this.safeIntegerN(s,["endTime","until"]);if(void 0!==e&&(n.startTime=e,void 0===t))throw new r.ArgumentsRequired(this.id+" fetchTrades() requires an until parameter when since is provided");if(void 0!==t){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchTrades() requires a since parameter when until is provided");n.endTime=t}let i=this.safeString(this.options,"fetchTradesMethod","spotPublicGetAggTrades");if(i=this.safeString(s,"method",i),s=this.omit(s,["method"]),"spotPublicGetAggTrades"===i)o=await this.spotPublicGetAggTrades(this.extend(n,s));else if("spotPublicGetHistoricalTrades"===i)o=await this.spotPublicGetHistoricalTrades(this.extend(n,s));else{if("spotPublicGetTrades"!==i)throw new r.NotSupported(this.id+" fetchTrades() not support this method");o=await this.spotPublicGetTrades(this.extend(n,s))}}else if(a.swap){const t=await this.contractPublicGetDealsSymbol(this.extend(n,s));o=this.safeValue(t,"data")}return this.parseTrades(o,a,e,i)}parseTrade(t,e=void 0){let i,s,r,a,n;let o,d,c,h,l;if("v"in t)s=this.safeInteger(t,"t"),a=(e=this.safeMarket(void 0,e)).symbol,c=this.safeString(t,"p"),h=this.safeString(t,"v"),o=this.parseOrderSide(this.safeString(t,"T")),d="taker";else{const u=this.safeString(t,"symbol");if(a=(e=this.safeMarket(u,e)).symbol,i=this.safeString2(t,"id","a"),c=this.safeString2(t,"price","p"),r=this.safeString(t,"orderId"),"positionMode"in t)s=this.safeInteger(t,"timestamp"),h=this.safeString(t,"vol"),o=this.parseOrderSide(this.safeString(t,"side")),n={cost:this.safeString(t,"fee"),currency:this.safeCurrencyCode(this.safeString(t,"feeCurrency"))},d=this.safeValue(t,"taker")?"taker":"maker";else{s=this.safeInteger2(t,"time","T"),h=this.safeString2(t,"qty","q"),l=this.safeString(t,"quoteQty");const e=this.safeValue(t,"isBuyer"),i=this.safeValue(t,"isMaker"),r=this.safeValue2(t,"isBuyerMaker","m");void 0!==i&&(d=i?"maker":"taker"),void 0!==e&&(o=e?"buy":"sell"),void 0!==r&&(o=r?"sell":"buy",d="taker");const a=this.safeString(t,"commissionAsset");void 0!==a&&(n={cost:this.safeString(t,"commission"),currency:this.safeCurrencyCode(a)})}}return void 0===i&&this.safeBool(this.options,"useCcxtTradeId",!0)&&(i=this.createCcxtTradeId(s,o,h,c,d)),this.safeTrade({id:i,order:r,timestamp:s,datetime:this.iso8601(s),symbol:a,type:undefined,side:o,takerOrMaker:d,price:c,amount:h,cost:l,fee:n,info:t},e)}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=n.spot?500:2e3;let d=!1;if([d,a]=this.handleOptionAndParams(a,"fetchOHLCV","paginate",!1),d)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,a,o);const c=this.safeValue(this.options,"timeframes",{}),h=this.safeValue(c,n.type,{}),l=this.safeString(h,e),u=1e3*this.parseTimeframe(e),p={symbol:n.id,interval:l};let f;const m=this.safeIntegerN(a,["until","endTime"]);let g=i;if(void 0!==m&&void 0===i){a=this.omit(a,["until"]);g=m-(s||o)*u}if(n.spot){if(void 0!==g&&(p.startTime=g,void 0===m)){const t=this.sum(i,o*u),e=this.milliseconds();p.endTime=Math.min(t,e)}void 0!==s&&(p.limit=s),void 0!==m&&(p.endTime=m+1);f=await this.spotPublicGetKlines(this.extend(p,a))}else if(n.swap){void 0!==i&&(p.start=this.parseToInt(i/1e3)),void 0!==m&&(p.end=this.parseToInt(m/1e3),void 0===i&&(p.start=this.parseToInt(g/1e3)));const t=this.safeString(a,"price","default");let e;if(a=this.omit(a,"price"),"default"===t)e=await this.contractPublicGetKlineSymbol(this.extend(p,a));else if("index"===t)e=await this.contractPublicGetKlineIndexPriceSymbol(this.extend(p,a));else{if("mark"!==t)throw new r.NotSupported(this.id+" fetchOHLCV() not support this price type, [default, index, mark]");e=await this.contractPublicGetKlineFairPriceSymbol(this.extend(p,a))}const s=this.safeValue(e,"data");f=this.convertTradingViewToOHLCV(s,"time","open","high","low","close","vol")}return this.parseOHLCVs(f,n,e,i,s)}parseOHLCV(t,e=void 0){return[this.safeInteger(t,0),this.safeNumber(t,1),this.safeNumber(t,2),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,5)]}async fetchTickers(t=void 0,e={}){await this.loadMarkets();const i={};let s,r=!1;if(void 0!==t){r=1===t.length;const e=this.safeString(t,0);s=this.market(e)}const[a,n]=this.handleMarketTypeAndParams("fetchTickers",s,e);let o;if(r&&(i.symbol=s.id),"spot"===a)o=await this.spotPublicGetTicker24hr(this.extend(i,n));else if("swap"===a){const t=await this.contractPublicGetTicker(this.extend(i,n));o=this.safeValue(t,"data",[])}return r&&(o=[o]),this.parseTickers(o,t)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),[s,r]=this.handleMarketTypeAndParams("fetchTicker",i,e);let a;const n={symbol:i.id};if("spot"===s)a=await this.spotPublicGetTicker24hr(this.extend(n,r));else if("swap"===s){const t=await this.contractPublicGetTicker(this.extend(n,r));a=this.safeValue(t,"data",{})}return this.parseTicker(a,i)}parseTicker(t,e=void 0){const i=this.safeString(t,"symbol");let s,r,a,o,d,c,h,l,u,p,f,m,g;e=this.safeMarket(i,e);return this.safeValue(e,"swap")||"timestamp"in t?(s=this.safeInteger(t,"timestamp"),r=this.safeString(t,"bid1"),a=this.safeString(t,"ask1"),c=this.safeString(t,"volume24"),h=this.safeString(t,"amount24"),u=this.safeString(t,"high24Price"),p=this.safeString(t,"lower24Price"),m=this.safeString(t,"riseFallValue"),f=this.safeString(t,"riseFallRate"),f=n.Y.stringMul(f,"100")):(s=this.safeInteger(t,"closeTime"),r=this.safeString(t,"bidPrice"),a=this.safeString(t,"askPrice"),o=this.safeString(t,"bidQty"),d=this.safeString(t,"askQty"),n.Y.stringEq(o,"0")&&(o=void 0),n.Y.stringEq(d,"0")&&(d=void 0),c=this.safeString(t,"volume"),h=this.safeString(t,"quoteVolume"),l=this.safeString(t,"openPrice"),u=this.safeString(t,"highPrice"),p=this.safeString(t,"lowPrice"),g=this.safeString(t,"prevClosePrice"),m=this.safeString(t,"priceChange"),f=this.safeString(t,"priceChangePercent"),f=n.Y.stringMul(f,"100")),this.safeTicker({symbol:e.symbol,timestamp:s,datetime:this.iso8601(s),open:l,high:u,low:p,close:this.safeString(t,"lastPrice"),bid:r,bidVolume:o,ask:a,askVolume:d,vwap:void 0,previousClose:g,change:m,percentage:f,average:void 0,baseVolume:c,quoteVolume:h,info:t},e)}async fetchBidsAsks(t=void 0,e={}){let i;await this.loadMarkets();let s=!1;if(void 0!==t){s=1===t.length,i=this.market(t[0])}const[a,n]=this.handleMarketTypeAndParams("fetchBidsAsks",i,e);let o;if("spot"===a)o=await this.spotPublicGetTickerBookTicker(n);else if("swap"===a)throw new r.NotSupported(this.id+" fetchBidsAsks() is not available for "+a+" markets");return s&&(o=[o]),this.parseTickers(o,t)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");const s={cost:e};return await this.createOrder(t,"market","buy",0,void 0,this.extend(s,i))}async createMarketSellOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");const s={cost:e};return await this.createOrder(t,"market","sell",0,void 0,this.extend(s,i))}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),[o,d]=this.handleMarginModeAndParams("createOrder",a);return n.spot?await this.createSpotOrder(n,e,i,s,r,o,d):await this.createSwapOrder(n,e,i,s,r,o,d)}createSpotOrderRequest(t,e,i,s,a=void 0,o=void 0,d={}){const c=t.symbol,h=i.toUpperCase(),l={symbol:t.id,side:h,type:e.toUpperCase()};if("market"===e){const t=this.safeNumber2(d,"cost","quoteOrderQty");if(d=this.omit(d,"cost"),void 0!==t)s=t,l.quoteOrderQty=this.costToPrecision(c,s);else if(void 0===a)l.quantity=this.amountToPrecision(c,s);else{const t=this.numberToString(s),e=this.numberToString(a);s=n.Y.stringMul(t,e),l.quoteOrderQty=this.costToPrecision(c,s)}}else l.quantity=this.amountToPrecision(c,s);void 0!==a&&(l.price=this.priceToPrecision(c,a));const u=this.safeString(d,"clientOrderId");if(void 0!==u&&(l.newClientOrderId=u,d=this.omit(d,["type","clientOrderId"])),void 0!==o&&"isolated"!==o)throw new r.BadRequest(this.id+" createOrder() does not support marginMode "+o+" for spot-margin trading");let p;[p,d]=this.handlePostOnly("market"===e,"LIMIT_MAKER"===e,d),p&&(l.type="LIMIT_MAKER");const f=this.safeString(d,"timeInForce");return void 0!==f&&(d=this.omit(d,"timeInForce"),"IOC"===f?l.type="IMMEDIATE_OR_CANCEL":"FOK"===f&&(l.type="FILL_OR_KILL")),this.extend(l,d)}async createSpotOrder(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.safeBool(n,"test",!1);n=this.omit(n,"test");const d=this.createSpotOrderRequest(t,e,i,s,r,a,n);let c;c=o?await this.spotPrivatePostOrderTest(d):await this.spotPrivatePostOrder(d);const h=this.parseOrder(c,t);return h.side=i,h.type=e,void 0===this.safeString(h,"price")&&(h.price=r),void 0===this.safeString(h,"amount")&&(h.amount=s),h}async createSwapOrder(t,e,i,s,a=void 0,n=void 0,o={}){await this.loadMarkets();const d=t.symbol,c=this.safeValue(this.options,"unavailableContracts",{});if(this.safeBool(c,d,!1))throw new r.NotSupported(this.id+" createSwapOrder() does not support yet this symbol:"+d);let h,l;if(void 0!==n)if("cross"===n)h=2;else{if("isolated"!==n)throw new r.ArgumentsRequired(this.id+' createSwapOrder() marginMode parameter should be either "cross" or "isolated"');h=1}else h=this.safeInteger(o,"openType",2);if("limit"!==e&&"market"!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e&&6!==e)throw new r.InvalidOrder(this.id+" createSwapOrder() order type must either limit, market, or 1 for limit orders, 2 for post-only orders, 3 for IOC orders, 4 for FOK orders, 5 for market orders or 6 to convert market price to current price");[l,o]=this.handlePostOnly("market"===e,2===e,o),l?e=2:"limit"===e?e=1:"market"===e&&(e=6);const u={symbol:t.id,vol:parseFloat(this.amountToPrecision(d,s)),type:e,openType:h};if(5!==e&&6!==e&&"market"!==e&&(u.price=parseFloat(this.priceToPrecision(d,a))),1===h){if(void 0===this.safeInteger(o,"leverage"))throw new r.ArgumentsRequired(this.id+" createSwapOrder() requires a leverage parameter for isolated margin orders")}const p=this.safeBool(o,"reduceOnly",!1);let f;this.safeBool(o,"hedged",!1)?(p&&(o=this.omit(o,"reduceOnly"),i="buy"===i?"sell":"buy"),f="buy"===i?1:3,u.positionMode=1):f=p?"buy"===i?2:4:"buy"===i?1:3,u.side=f;const m=this.safeString2(o,"clientOrderId","externalOid");void 0!==m&&(u.externalOid=m);const g=this.safeNumber2(o,"triggerPrice","stopPrice");let y;o=this.omit(o,["clientOrderId","externalOid","postOnly","stopPrice","triggerPrice","hedged"]),g?(u.triggerPrice=this.priceToPrecision(d,g),u.triggerType=this.safeInteger(o,"triggerType",1),u.executeCycle=this.safeInteger(o,"executeCycle",1),u.trend=this.safeInteger(o,"trend",1),u.orderType=this.safeInteger(o,"orderType",1),y=await this.contractPrivatePostPlanorderPlace(this.extend(u,o))):y=await this.contractPrivatePostOrderSubmit(this.extend(u,o));const v=this.safeString(y,"data");return this.safeOrder({id:v},t)}async createOrders(t,e={}){await this.loadMarkets();const i=[];let s;for(let a=0;a<t.length;a++){const n=t[a],o=this.safeString(n,"symbol"),d=this.market(o);if(!d.spot)throw new r.NotSupported(this.id+" createOrders() is only supported for spot markets");if(void 0===s)s=o;else if(s!==o)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const c=this.safeString(n,"type"),h=this.safeString(n,"side"),l=this.safeValue(n,"amount"),u=this.safeValue(n,"price"),p=this.safeValue(n,"params",{});let f;[f,e]=this.handleMarginModeAndParams("createOrder",e);const m=this.createSpotOrderRequest(d,c,h,l,u,f,p);i.push(m)}const a={batchOrders:this.json(i)},n=await this.spotPrivatePostBatchOrders(a);return this.parseOrders(n)}async fetchOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={symbol:s.id};let n;if(s.spot){const e=this.safeString(i,"clientOrderId");void 0!==e?(i=this.omit(i,"clientOrderId"),a.origClientOrderId=e):a.orderId=t;const[s,o]=this.handleMarginModeAndParams("fetchOrder",i);if(void 0!==s){if("isolated"!==s)throw new r.BadRequest(this.id+" fetchOrder() does not support marginMode "+s+" for spot-margin trading");n=await this.spotPrivateGetMarginOrder(this.extend(a,o))}else n=await this.spotPrivateGetOrder(this.extend(a,o))}else if(s.swap){a.order_id=t;const e=await this.contractPrivateGetOrderGetOrderId(this.extend(a,i));n=this.safeValue(e,"data")}return this.parseOrder(n,s)}async fetchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n;void 0!==t&&(n=this.market(t),a.symbol=n.id);const o=this.safeInteger(s,"until");s=this.omit(s,"until");const[d,c]=this.handleMarketTypeAndParams("fetchOrders",n,s);if("spot"===d){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchOrders() requires a symbol argument for spot market");const[d,c]=this.handleMarginModeAndParams("fetchOrders",s);let h;if(void 0!==e&&(a.startTime=e),void 0!==o&&(a.endTime=o),void 0!==i&&(a.limit=i),void 0!==d){if("isolated"!==d)throw new r.BadRequest(this.id+" fetchOrders() does not support marginMode "+d+" for spot-margin trading");h=await this.spotPrivateGetMarginAllOrders(this.extend(a,c))}else h=await this.spotPrivateGetAllOrders(this.extend(a,c));return this.parseOrders(h,n,e,i)}{if(void 0!==e){a.start_time=e;const t=this.safeInteger(s,"end_time",o);if(void 0===t)a.end_time=this.sum(e,this.options.maxTimeTillEnd);else{if(t-e>this.options.maxTimeTillEnd)throw new r.BadRequest(this.id+" end is invalid, i.e. exceeds allowed 90 days.");a.end_time=o}}else void 0!==o&&(a.start_time=this.sum(o,-1*this.options.maxTimeTillEnd),a.end_time=o);void 0!==i&&(a.page_size=i);let t=this.safeString(this.options,"fetchOrders","contractPrivateGetOrderListHistoryOrders");t=this.safeString(c,"method",t);let d=[],h=[];if("contractPrivateGetOrderListHistoryOrders"===t){const t=await this.contractPrivateGetOrderListHistoryOrders(this.extend(a,c));d=this.safeValue(t,"data")}else{const t=await this.contractPrivateGetPlanorderListOrders(this.extend(a,c));h=this.safeValue(t,"data")}const l=this.arrayConcat(h,d);return this.parseOrders(l,n,e,i,s)}}async fetchOrdersByIds(t,e=void 0,i={}){await this.loadMarkets();const s={};let a;void 0!==e&&(a=this.market(e),s.symbol=a.id);const[n,o]=this.handleMarketTypeAndParams("fetchOrdersByIds",a,i);if("spot"===n)throw new r.BadRequest(this.id+" fetchOrdersByIds() is not supported for "+n);{s.order_ids=t.join(",");const e=await this.contractPrivateGetOrderBatchQuery(this.extend(s,o)),i=this.safeList(e,"data");return this.parseOrders(i,a)}}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n,o;if(void 0!==t&&(n=this.market(t)),[o,s]=this.handleMarketTypeAndParams("fetchOpenOrders",n,s),"spot"===o){void 0!==t&&(a.symbol=n.id);const[o,d]=this.handleMarginModeAndParams("fetchOpenOrders",s);let c;if(void 0!==o){if("isolated"!==o)throw new r.BadRequest(this.id+" fetchOpenOrders() does not support marginMode "+o+" for spot-margin trading");c=await this.spotPrivateGetMarginOpenOrders(this.extend(a,d))}else c=await this.spotPrivateGetOpenOrders(this.extend(a,d));return this.parseOrders(c,n,e,i)}return await this.fetchOrdersByState(2,t,e,i,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByState(3,t,e,i,s)}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByState(4,t,e,i,s)}async fetchOrdersByState(t,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();const n={};let o;void 0!==e&&(o=this.market(e));const[d]=this.handleMarketTypeAndParams("fetchOrdersByState",o,a);if("spot"===d)throw new r.NotSupported(this.id+" fetchOrdersByState() is not supported for "+d);return n.states=t,await this.fetchOrders(e,i,s,this.extend(n,a))}async cancelOrder(t,e=void 0,i={}){await this.loadMarkets();const s={};let a,n;void 0!==e&&(a=this.market(e),s.symbol=a.id),[n,i]=this.handleMarketTypeAndParams("cancelOrder",a,i);const[o,d]=this.handleMarginModeAndParams("cancelOrder",i);let c;if("spot"===n){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");const s={symbol:a.id},n=this.safeString(i,"clientOrderId");if(void 0!==n?(i=this.omit(d,"clientOrderId"),s.origClientOrderId=n):s.orderId=t,void 0!==o){if("isolated"!==o)throw new r.BadRequest(this.id+" cancelOrder() does not support marginMode "+o+" for spot-margin trading");c=await this.spotPrivateDeleteMarginOrder(this.extend(s,d))}else c=await this.spotPrivateDeleteOrder(this.extend(s,d))}else{let e,i=this.safeString(this.options,"cancelOrder","contractPrivatePostOrderCancel");if(i=this.safeString(d,"method",i),"contractPrivatePostOrderCancel"===i)e=await this.contractPrivatePostOrderCancel([t]);else{if("contractPrivatePostPlanorderCancel"!==i)throw new r.NotSupported(this.id+" cancelOrder() not support this method");e=await this.contractPrivatePostPlanorderCancel([t])}c=this.safeValue(e,"data");const s=this.safeValue(c,0),a=this.safeValue(s,"errorMsg","");if("success"!==a)throw new r.InvalidOrder(this.id+" cancelOrder() the order with id "+t+" cannot be cancelled: "+a)}return this.parseOrder(c,a)}async cancelOrders(t,e=void 0,i={}){await this.loadMarkets();const s=void 0!==e?this.market(e):void 0,[a]=this.handleMarketTypeAndParams("cancelOrders",s,i);if("spot"===a)throw new r.BadRequest(this.id+" cancelOrders() is not supported for "+a);{const e=await this.contractPrivatePostOrderCancel(t),i=this.safeList(e,"data");return this.parseOrders(i,s)}}async cancelAllOrders(t=void 0,e={}){await this.loadMarkets();const i=void 0!==t?this.market(t):void 0,s={};let a;[a,e]=this.handleMarketTypeAndParams("cancelAllOrders",i,e);const[n,o]=this.handleMarginModeAndParams("cancelAllOrders",e);if("spot"===a){if(void 0===t)throw new r.ArgumentsRequired(this.id+" cancelAllOrders() requires a symbol argument on spot");let e;if(s.symbol=i.id,void 0!==n){if("isolated"!==n)throw new r.BadRequest(this.id+" cancelAllOrders() does not support marginMode "+n+" for spot-margin trading");e=await this.spotPrivateDeleteMarginOpenOrders(this.extend(s,o))}else e=await this.spotPrivateDeleteOpenOrders(this.extend(s,o));return this.parseOrders(e,i)}{void 0!==t&&(s.symbol=i.id);let e,r=this.safeString(this.options,"cancelAllOrders","contractPrivatePostOrderCancelAll");r=this.safeString(o,"method",r),"contractPrivatePostOrderCancelAll"===r?e=await this.contractPrivatePostOrderCancelAll(this.extend(s,o)):"contractPrivatePostPlanorderCancelAll"===r&&(e=await this.contractPrivatePostPlanorderCancelAll(this.extend(s,o)));const a=this.safeList(e,"data",[]);return this.parseOrders(a,i)}}parseOrder(t,e=void 0){if(void 0!==this.safeInteger(t,"code"))return this.safeOrder({info:t,status:"rejected",clientOrderId:this.safeString(t,"newClientOrderId")});let i;i="string"==typeof t?t:this.safeString2(t,"orderId","id");let s=this.parseOrderTimeInForce(this.safeString(t,"timeInForce"));const r=this.safeString(t,"type");void 0===s&&(s=this.getTifFromRawOrderType(r));const a=this.safeString(t,"symbol");e=this.safeMarket(a,e);const o=this.safeIntegerN(t,["time","createTime","transactTime"]);let d;const c=this.safeString(t,"feeCurrency");if(void 0!==c){const e=this.safeString(t,"takerFee"),i=this.safeString(t,"makerFee"),s=n.Y.stringAdd(e,i);d={currency:c,cost:this.parseNumber(s)}}return this.safeOrder({id:i,clientOrderId:this.safeString(t,"clientOrderId"),timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:void 0,lastUpdateTimestamp:this.safeInteger(t,"updateTime"),status:this.parseOrderStatus(this.safeString2(t,"status","state")),symbol:e.symbol,type:this.parseOrderType(r),timeInForce:s,side:this.parseOrderSide(this.safeString(t,"side")),price:this.safeNumber(t,"price"),triggerPrice:this.safeNumber2(t,"stopPrice","triggerPrice"),average:this.safeNumber(t,"dealAvgPrice"),amount:this.safeNumber2(t,"origQty","vol"),cost:this.safeNumber(t,"cummulativeQuoteQty"),filled:this.safeNumber2(t,"executedQty","dealVol"),remaining:void 0,fee:d,trades:void 0,info:t},e)}parseOrderSide(t){return this.safeString({BUY:"buy",SELL:"sell",1:"buy",2:"sell"},t,t)}parseOrderType(t){return this.safeString({MARKET:"market",LIMIT:"limit",LIMIT_MAKER:"limit",IMMEDIATE_OR_CANCEL:"limit",FILL_OR_KILL:"limit"},t,t)}parseOrderStatus(t){return this.safeString({NEW:"open",FILLED:"closed",CANCELED:"canceled",PARTIALLY_FILLED:"open",PARTIALLY_CANCELED:"canceled",2:"open",3:"closed",4:"canceled"},t,t)}parseOrderTimeInForce(t){return this.safeString({GTC:"GTC",FOK:"FOK",IOC:"IOC"},t,t)}getTifFromRawOrderType(t=void 0){return this.safeString({LIMIT:"GTC",LIMIT_MAKER:"POST_ONLY",IMMEDIATE_OR_CANCEL:"IOC",FILL_OR_KILL:"FOK",MARKET:"IOC"},t,t)}async fetchAccountHelper(t,e){if("spot"===t)return await this.spotPrivateGetAccount(e);if("swap"===t){const t=await this.contractPrivateGetAccountAssets(e);return this.safeValue(t,"data")}}async fetchAccounts(t={}){const[e,i]=this.handleMarketTypeAndParams("fetchAccounts",void 0,t);await this.loadMarkets();const s=await this.fetchAccountHelper(e,i),r=this.safeValue(s,"balances",[]),a=[];for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString2(e,"asset","currency"),s=this.safeCurrencyCode(i);a.push({id:this.safeString(e,"id"),type:this.safeString(e,"type"),code:s,info:e})}return a}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.spot)throw new r.BadRequest(this.id+" fetchTradingFee() supports spot markets only");const s={symbol:i.id},a=await this.spotPrivateGetTradeFee(this.extend(s,e)),n=this.safeDict(a,"data",{});return{info:n,symbol:t,maker:this.safeNumber(n,"makerCommission"),taker:this.safeNumber(n,"takerCommission"),percentage:void 0,tierBased:void 0}}customParseBalance(t,e){let i;i="margin"===e?this.safeValue(t,"assets",[]):"swap"===e?this.safeValue(t,"data",[]):this.safeValue(t,"balances",[]);const s={info:t};if("margin"===e){for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"symbol"),a=this.safeSymbol(r,void 0),n=this.safeValue(e,"baseAsset",{}),o=this.safeValue(e,"quoteAsset",{}),d=this.safeCurrencyCode(this.safeString(n,"asset")),c=this.safeCurrencyCode(this.safeString(o,"asset")),h={};h[d]=this.parseBalanceHelper(n),h[c]=this.parseBalanceHelper(o),s[a]=this.safeBalance(h)}return s}if("swap"===e){for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(e,"availableBalance"),n.used=this.safeString(e,"frozenBalance"),s[a]=n}return this.safeBalance(s)}for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"asset"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(e,"free"),n.used=this.safeString(e,"locked"),s[a]=n}return this.safeBalance(s)}parseBalanceHelper(t){const e=this.account();e.used=this.safeString(t,"locked"),e.free=this.safeString(t,"free"),e.total=this.safeString(t,"totalAsset");const i=this.safeString(t,"borrowed"),s=this.safeString(t,"interest");return e.debt=n.Y.stringAdd(i,s),e}async fetchBalance(t={}){let e;await this.loadMarkets();const i={};[e,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t);const s=this.safeString(t,"marginMode"),a=this.safeBool(t,"margin",!1);let n;if(t=this.omit(t,["margin","marginMode"]),void 0!==s||a||"margin"===e){let s;const r=this.safeString(t,"symbol");if(void 0===r){const e=this.safeValue(t,"symbols");void 0!==e&&(s=this.marketIds(e).join(","))}else{s=this.market(r).id}this.checkRequiredArgument("fetchBalance",s,"symbol or symbols"),e="margin",i.symbols=s,t=this.omit(t,["symbol","symbols"]),n=await this.spotPrivateGetMarginIsolatedAccount(this.extend(i,t))}else if("spot"===e)n=await this.spotPrivateGetAccount(this.extend(i,t));else{if("swap"!==e)throw new r.NotSupported(this.id+" fetchBalance() not support this method");n=await this.contractPrivateGetAccountAssets(this.extend(i,t))}return this.customParseBalance(n,e)}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n;[n,s]=this.handleMarketTypeAndParams("fetchMyTrades",a,s);const o={symbol:a.id};let d;if("spot"===n){void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i);const t=this.safeInteger(s,"until");void 0!==t&&(s=this.omit(s,"until"),o.endTime=t),d=await this.spotPrivateGetMyTrades(this.extend(o,s))}else{if(void 0!==e){o.start_time=e;void 0===this.safeInteger(s,"end_time")&&(o.end_time=this.sum(e,this.options.maxTimeTillEnd))}void 0!==i&&(o.page_size=i);const t=await this.contractPrivateGetOrderListOrderDeals(this.extend(o,s));d=this.safeValue(t,"data")}return this.parseTrades(d,a,e,i)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();const n={};let o;void 0!==e&&(o=this.market(e));const[d,c]=this.handleMarketTypeAndParams("fetchOrderTrades",o,a);let h;if("spot"===d){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrderTrades() requires a symbol argument");n.symbol=o.id,n.orderId=t,h=await this.spotPrivateGetMyTrades(this.extend(n,c))}else{n.order_id=t;const e=await this.contractPrivateGetOrderDealDetailsOrderId(this.extend(n,c));h=this.safeValue(e,"data")}return this.parseTrades(h,o,i,s,c)}async modifyMarginHelper(t,e,i,s={}){const a=this.safeInteger(s,"positionId");if(void 0===a)throw new r.ArgumentsRequired(this.id+" modifyMarginHelper() requires a positionId parameter");await this.loadMarkets();const n={positionId:a,amount:e,type:i};return await this.contractPrivatePostPositionChangeMargin(this.extend(n,s))}async reduceMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"SUB",i)}async addMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"ADD",i)}async setLeverage(t,e=void 0,i={}){await this.loadMarkets();const s={leverage:t},a=this.safeInteger(i,"positionId");if(void 0===a){const t=this.safeNumber(i,"openType"),a=this.safeNumber(i,"positionType"),n=void 0!==e?this.market(e):void 0;if(void 0===t||void 0===a||void 0===n)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a positionId parameter or a symbol argument with openType and positionType parameters, use openType 1 or 2 for isolated or cross margin respectively, use positionType 1 or 2 for long or short positions");s.openType=t,s.symbol=n.id,s.positionType=a}else s.positionId=a;return await this.contractPrivatePostPositionChangeLeverage(this.extend(s,i))}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();const a={};void 0!==t&&(r=this.market(t),a.symbol=r.id),void 0!==i&&(a.page_size=i);const n=await this.contractPrivateGetPositionFundingRecords(this.extend(a,s)),o=this.safeValue(n,"data",{}),d=this.safeValue(o,"resultList",[]),c=[];for(let e=0;e<d.length;e++){const i=d[e],s=this.safeInteger(i,"settleTime");c.push({info:i,symbol:t,code:void 0,timestamp:s,datetime:this.iso8601(s),id:this.safeNumber(i,"id"),amount:this.safeNumber(i,"funding")})}return c}parseFundingRate(t,e=void 0){const i=this.safeNumber(t,"fundingRate"),s=this.safeInteger(t,"nextSettleTime"),r=this.safeString(t,"symbol"),a=this.safeSymbol(r,e,void 0,"contract"),n=this.safeInteger(t,"timestamp"),o=this.safeString(t,"collectCycle");let d;return void 0!==o&&(d=o+"h"),{info:t,symbol:a,markPrice:void 0,indexPrice:void 0,interestRate:void 0,estimatedSettlePrice:void 0,timestamp:n,datetime:this.iso8601(n),fundingRate:i,fundingTimestamp:s,fundingDatetime:this.iso8601(s),nextFundingRate:void 0,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:d}}async fetchFundingInterval(t,e={}){return await this.fetchFundingRate(t,e)}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.contractPublicGetFundingRateSymbol(this.extend(s,e)),a=this.safeValue(r,"data",{});return this.parseFundingRate(a,i)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();const a=this.market(t),n={symbol:a.id};void 0!==i&&(n.page_size=i);const o=await this.contractPublicGetFundingRateHistory(this.extend(n,s)),d=this.safeValue(o,"data"),c=this.safeValue(d,"resultList",[]),h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeString(e,"symbol"),s=this.safeSymbol(i),r=this.safeInteger(e,"settleTime");h.push({info:e,symbol:s,fundingRate:this.safeNumber(e,"fundingRate"),timestamp:r,datetime:this.iso8601(r)})}const l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,a.symbol,e,i)}async fetchLeverageTiers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,"swap",!0,!0);const i=await this.contractPublicGetDetail(e),s=this.safeList(i,"data");return this.parseLeverageTiers(s,t,"symbol")}parseMarketLeverageTiers(t,e=void 0){const i=this.safeString(t,"symbol");let s=this.safeString(t,"maintenanceMarginRate"),r=this.safeString(t,"initialMarginRate");const a=this.safeString(t,"maxVol"),o=this.safeString(t,"riskIncrVol"),d=this.safeString(t,"riskIncrMmr"),c=this.safeString(t,"riskIncrImr");let h="0";const l=[],u=this.safeString(t,"quoteCoin");if("0"===o)return[{tier:0,symbol:this.safeSymbol(i,e,void 0,"contract"),currency:this.safeCurrencyCode(u),minNotional:void 0,maxNotional:void 0,maintenanceMarginRate:void 0,maxLeverage:this.safeNumber(t,"maxLeverage"),info:t}];for(;n.Y.stringLt(h,a);){const a=n.Y.stringAdd(h,o);l.push({tier:this.parseNumber(n.Y.stringDiv(a,o)),symbol:this.safeSymbol(i,e,void 0,"contract"),currency:this.safeCurrencyCode(u),minNotional:this.parseNumber(h),maxNotional:this.parseNumber(a),maintenanceMarginRate:this.parseNumber(s),maxLeverage:this.parseNumber(n.Y.stringDiv("1",r)),info:t}),r=n.Y.stringAdd(r,c),s=n.Y.stringAdd(s,d),h=a}return l}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"address"),s=this.safeString(t,"coin"),r=this.safeString(t,"netWork");return this.checkAddress(i),{info:t,currency:this.safeCurrencyCode(s,e),network:this.networkIdToCode(r,s),address:i,tag:this.safeString(t,"memo")}}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();const i=this.currency(t),s={coin:i.id},r=this.safeString(e,"network");let a;if(void 0!==r){const e=this.networkIdToCode(r,t),s=this.safeDict(i,"networks",{});if(e in s){const t=this.safeDict(s,e,{}),i=this.safeValue(t,"info",{});a=this.safeString(i,"network")}else a=this.networkCodeToId(r,t)}void 0!==a&&(s.network=a),e=this.omit(e,"network");const n=await this.spotPrivateGetCapitalDepositAddress(this.extend(s,e)),o=this.parseDepositAddresses(n,void 0,!1);return this.indexBy(o,"network")}async createDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s={coin:i.id},a=this.safeString(e,"network");if(void 0===a)throw new r.ArgumentsRequired(this.id+" createDepositAddress requires a `network` parameter");let n;const o=this.networkIdToCode(a,t),d=this.safeDict(i,"networks",{});if(o in d){const t=this.safeDict(d,o,{}),e=this.safeValue(t,"info",{});n=this.safeString(e,"network")}else n=this.networkCodeToId(a,t);void 0!==n&&(s.network=n),e=this.omit(e,"network");const c=await this.spotPrivatePostCapitalDepositAddress(this.extend(s,e));return this.parseDepositAddress(c,i)}async fetchDepositAddress(t,e={}){const i=this.safeString(e,"network"),s=await this.fetchDepositAddressesByNetwork(t,e);let a;if(void 0!==i)a=this.safeDict(s,this.networkIdToCode(i,t));else{const e=this.safeDict(this.options,"defaultNetworks"),i=this.safeString(e,t);if(void 0!==i)a=this.safeDict(s,i);else{const t=Object.keys(s),e=this.safeString(t,0);a=this.safeDict(s,e)}}if(void 0===a)throw new r.InvalidAddress(this.id+" fetchDepositAddress() cannot find a deposit address for "+t+", and network"+i+"consider creating one using .createDepositAddress() method or in MEXC website");return a}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n;if(void 0!==t){n=this.currency(t),a.coin=n.id;const e=this.safeString(s,"network");void 0!==e&&(s=this.omit(s,"network"),a.coin=a.coin+"-"+e)}if(void 0!==e&&(a.startTime=e),void 0!==i){if(i>1e3)throw new r.ExchangeError("This exchange supports a maximum limit of 1000");a.limit=i}const o=await this.spotPrivateGetCapitalDepositHisrec(this.extend(a,s));return this.parseTransactions(o,n,e,i)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n;if(void 0!==t&&(n=this.currency(t),a.coin=n.id),void 0!==e&&(a.startTime=e),void 0!==i){if(i>1e3)throw new r.ExchangeError("This exchange supports a maximum limit of 1000");a.limit=i}const o=await this.spotPrivateGetCapitalWithdrawHistory(this.extend(a,s));return this.parseTransactions(o,n,e,i)}parseTransaction(t,e=void 0){const i=this.safeString2(t,"id","tranId"),s=void 0===i?"deposit":"withdrawal",r=this.safeInteger2(t,"insertTime","applyTime"),a=this.safeInteger(t,"updateTime");let o;const d=this.safeString(t,"coin");let c;void 0!==d&&(o=d.split("-")[0]);const h=this.safeString(t,"network");void 0!==h&&(c=this.networkIdToCode(h));const l=this.safeCurrencyCode(o,e),u=this.parseTransactionStatusByType(this.safeString(t,"status"),s);let p=this.safeString(t,"amount");const f=this.safeString(t,"address"),m=this.safeString2(t,"transHash","txId");let g;const y=this.safeString(t,"transactionFee");return void 0!==y&&(g={cost:this.parseNumber(y),currency:l}),"withdrawal"===s&&(p=n.Y.stringSub(p,y)),{info:t,id:i,txid:m,timestamp:r,datetime:this.iso8601(r),network:c,address:f,addressTo:f,addressFrom:void 0,tag:this.safeString(t,"memo"),tagTo:void 0,tagFrom:void 0,type:s,amount:this.parseNumber(p),currency:l,status:u,updated:a,comment:this.safeString(t,"remark"),internal:void 0,fee:g}}parseTransactionStatusByType(t,e=void 0){const i=this.safeValue({deposit:{1:"failed",2:"pending",3:"pending",4:"pending",5:"ok",6:"pending",7:"failed"},withdrawal:{1:"pending",2:"pending",3:"pending",4:"pending",5:"pending",6:"pending",7:"ok",8:"failed",9:"canceled",10:"pending"}},e,{});return this.safeString(i,t,t)}async fetchPosition(t,e={}){await this.loadMarkets();const i={symbol:this.market(t).id},s=await this.fetchPositions(void 0,this.extend(i,e));return this.safeValue(s,0)}async fetchPositions(t=void 0,e={}){await this.loadMarkets();const i=await this.contractPrivateGetPositionOpenPositions(e),s=this.safeList(i,"data",[]);return this.parsePositions(s,t)}parsePosition(t,e=void 0){const i=(e=this.safeMarket(this.safeString(t,"symbol"),e,void 0,"swap")).symbol,s=this.safeString(t,"holdVol"),r=this.safeNumber(t,"openAvgPrice"),a=this.safeString(t,"im"),n="1"===this.safeString(t,"positionType")?"long":"short",o="1"===this.safeString(t,"margin_mode")?"isolated":"cross",d=this.safeNumber(t,"leverage"),c=this.safeNumber(t,"liquidatePrice"),h=this.safeInteger(t,"updateTime");return this.safePosition({info:t,id:void 0,symbol:i,contracts:this.parseNumber(s),contractSize:void 0,entryPrice:r,collateral:void 0,side:n,unrealizedPnl:void 0,leverage:this.parseNumber(d),percentage:void 0,marginMode:o,notional:void 0,markPrice:void 0,lastPrice:void 0,liquidationPrice:c,initialMargin:this.parseNumber(a),initialMarginPercentage:void 0,maintenanceMargin:void 0,maintenanceMarginPercentage:void 0,marginRatio:void 0,timestamp:h,datetime:this.iso8601(h),hedged:void 0,stopLossPrice:void 0,takeProfitPrice:void 0,lastUpdateTimestamp:void 0})}async fetchTransfer(t,e=void 0,i={}){const[s,a]=this.handleMarketTypeAndParams("fetchTransfer",void 0,i);if(await this.loadMarkets(),"spot"===s){const e={transact_id:t},i=await this.spotPrivateGetAssetInternalTransferRecord(this.extend(e,a)),s=this.safeDict(i,"data",{});return this.parseTransfer(s)}if("swap"===s)throw new r.BadRequest(this.id+" fetchTransfer() is not supported for "+s)}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){let a;[a,s]=this.handleMarketTypeAndParams("fetchTransfers",void 0,s),await this.loadMarkets();const n={};let o,d;void 0!==t&&(o=this.currency(t)),[d,s]=this.handleOptionAndParams(s,"fetchTransfers","fromAccountType");const c={spot:"SPOT",swap:"FUTURES",futures:"FUTURES",future:"FUTURES",margin:"SPOT"};if(void 0===d)throw new r.ArgumentsRequired(this.id+' fetchTransfers() requires a fromAccountType parameter, one of "SPOT", "FUTURES"');let h;if(n.fromAccountType=this.safeString(c,d,d),[h,s]=this.handleOptionAndParams(s,"fetchTransfers","toAccountType"),void 0===h)throw new r.ArgumentsRequired(this.id+' fetchTransfers() requires a toAccountType parameter, one of "SPOT", "FUTURES"');n.toAccountType=this.safeString(c,h,h);let l=[];if("spot"===a){if(void 0!==e&&(n.startTime=e),void 0!==i){if(i>100)throw new r.ExchangeError("This exchange supports a maximum limit of 50");n.size=i}const t=await this.spotPrivateGetCapitalTransfer(this.extend(n,s));l=this.safeList(t,"rows",[])}else if("swap"===a){void 0!==i&&(n.page_size=i);const t=await this.contractPrivateGetAccountTransferRecord(this.extend(n,s)),e=this.safeValue(t,"data");l=this.safeValue(e,"resultList")}return this.parseTransfers(l,o,e,i)}async transfer(t,e,i,s,a={}){await this.loadMarkets();const n=this.currency(t),o={spot:"SPOT",swap:"FUTURES",future:"FUTURES"},d=this.safeString(o,i,i),c=this.safeString(o,s,s);if(void 0===d){const t=Object.keys(o);throw new r.ExchangeError(this.id+" fromAccount must be one of "+t.join(", "))}if(void 0===c){const t=Object.keys(o);throw new r.ExchangeError(this.id+" toAccount must be one of "+t.join(", "))}const h={asset:n.id,amount:e,fromAccountType:d,toAccountType:c};if("ISOLATED_MARGIN"===d||"ISOLATED_MARGIN"===c){const t=this.safeString(a,"symbol");if(a=this.omit(a,"symbol"),void 0===t)throw new r.ArgumentsRequired(this.id+" transfer() requires a symbol argument for isolated margin");const e=this.market(t);h.symbol=e.id}const l=await this.spotPrivatePostCapitalTransfer(this.extend(h,a)),u=this.parseTransfer(l,n);return this.extend(u,{amount:e,fromAccount:i,toAccount:s})}parseTransfer(t,e=void 0){const i=this.safeString2(t,"currency","asset"),s=this.safeStringN(t,["transact_id","txid","tranId"]),r=this.safeInteger2(t,"createTime","timestamp"),a=void 0!==r?this.iso8601(r):void 0,n=this.safeString(t,"type");let o,d;const c=this.safeString(t,"fromAccountType"),h=this.safeString(t,"toAccountType");return void 0!==c&&void 0!==h?(o=c,d=h):void 0!==n?(o="IN"===n?"MAIN":"CONTRACT",d="IN"===n?"CONTRACT":"MAIN"):(o=this.safeString(t,"from"),d=this.safeString(t,"to")),{info:t,id:s,timestamp:r,datetime:a,currency:this.safeCurrencyCode(i,e),amount:this.safeNumber(t,"amount"),fromAccount:this.parseAccountId(o),toAccount:this.parseAccountId(d),status:this.parseTransferStatus(this.safeStringN(t,["transact_state","state","status"]))}}parseAccountId(t){return this.safeString({SPOT:"spot",FUTURES:"swap",MAIN:"spot",CONTRACT:"swap"},t,t)}parseTransferStatus(t){return this.safeString({SUCCESS:"ok",FAILED:"failed",WAIT:"pending"},t,t)}async withdraw(t,e,i,s=void 0,a={}){await this.loadMarkets();const n=this.currency(t);[s,a]=this.handleWithdrawTagAndParams(s,a);if(this.safeBool(a,"internal",!1)){a=this.omit(a,"internal");const t={asset:n.id,amount:e,toAccount:i};if(void 0===this.safeString(a,"toAccountType"))throw new r.ArgumentsRequired(this.id+" withdraw() requires a toAccountType parameter for internal transfer to be of: EMAIL | UID | MOBILE");const s=await this.spotPrivatePostCapitalTransferInternal(this.extend(t,a));return this.parseTransaction(s,n)}const o=this.safeDict(this.options,"networks",{});let d=this.safeString2(a,"network","netWork");d=this.safeString(o,d,d),d=this.networkCodeToId(d,n.code),this.checkAddress(i);const c={coin:n.id,address:i,amount:e};void 0!==s&&(c.memo=s),void 0!==d&&(c.netWork=d,a=this.omit(a,["network","netWork"]));const h=await this.spotPrivatePostCapitalWithdraw(this.extend(c,a));return this.parseTransaction(h,n)}async setPositionMode(t,e=void 0,i={}){const s={positionMode:t?1:2};return await this.contractPrivatePostPositionChangePositionMode(this.extend(s,i))}async fetchPositionMode(t=void 0,e={}){const i=await this.contractPrivateGetPositionPositionMode(e);return{info:i,hedged:1===this.safeInteger(i,"data")}}async fetchTransactionFees(t=void 0,e={}){await this.loadMarkets();const i=await this.spotPrivateGetCapitalConfigGetall(e);return this.parseTransactionFees(i,t)}parseTransactionFees(t,e=void 0){const i={};for(let s=0;s<t.length;s++){const r=t[s],a=this.safeString(r,"coin"),n=this.safeCurrency(a),o=this.safeString(n,"code");(void 0===e||this.inArray(o,e))&&(i[o]=this.parseTransactionFee(r,n))}return{withdraw:i,deposit:{},info:t}}parseTransactionFee(t,e=void 0){const i=this.safeValue(t,"networkList",[]),s={};for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"network"),a=this.safeString(this.options.networks,r,r),n=this.safeNumber(e,"withdrawFee");s[a]=n}return s}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.spotPrivateGetCapitalConfigGetall(e);return this.parseDepositWithdrawFees(i,t,"coin")}parseDepositWithdrawFee(t,e=void 0){const i=this.safeValue(t,"networkList",[]),s=this.depositWithdrawFee(t);for(let t=0;t<i.length;t++){const r=i[t],a=this.safeString(r,"network"),n=this.networkIdToCode(a,this.safeString(e,"code"));s.networks[n]={withdraw:{fee:this.safeNumber(r,"withdrawFee"),percentage:void 0},deposit:{fee:void 0,percentage:void 0}}}return this.assignDefaultDepositWithdrawFees(s)}async fetchLeverage(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.contractPrivateGetPositionLeverage(this.extend(s,e)),a=this.safeList(r,"data",[]);return this.parseLeverage(a,i)}parseLeverage(t,e=void 0){let i,s,r;for(let e=0;e<t.length;e++){const a=t[e],n=this.safeInteger(a,"openType"),o=this.safeInteger(a,"positionType");1===o?s=this.safeInteger(a,"leverage"):2===o&&(r=this.safeInteger(a,"leverage")),i=1===n?"isolated":"cross"}return{info:t,symbol:e.symbol,marginMode:i,longLeverage:s,shortLeverage:r}}handleMarginModeAndParams(t,e={},i=void 0){const s=this.safeString(this.options,"defaultType"),r=this.safeBool(e,"margin",!1);let a;return[a,e]=super.handleMarginModeAndParams(t,e,i),"margin"!==s&&!0!==r||(a="isolated"),[a,e]}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};if(void 0!==t){if(1===t.length){const e=this.market(t[0]);r.symbol=e.id}}void 0!==i&&(r.page_size=i);const a=await this.contractPrivateGetPositionListHistoryPositions(this.extend(r,s)),n=this.safeList(a,"data"),o=this.parsePositions(n,t,s);return this.filterBySinceLimit(o,e,i)}async setMarginMode(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(e);if(s.spot)throw new r.BadSymbol(this.id+" setMarginMode() supports contract markets only");if("isolated"!==(t=t.toLowerCase())&&"cross"!==t)throw new r.BadRequest(this.id+" setMarginMode() marginMode argument should be isolated or cross");const a=this.safeInteger(i,"leverage");if(void 0===a)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a leverage parameter");const n=this.safeStringLower2(i,"direction","positionId"),o={leverage:a,openType:"isolated"===t?1:2};void 0!==e&&(o.symbol=s.id),void 0!==n&&(o.positionType="short"===n?2:1),i=this.omit(i,"direction");const d=await this.contractPrivatePostPositionChangeLeverage(this.extend(o,i));return this.parseLeverage(d,s)}nonce(){return this.milliseconds()-this.safeInteger(this.options,"timeDifference",0)}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){const n=this.safeString(e,0),d=this.safeString(e,1);let c;if([t,s]=this.resolvePath(t,s),"spot"===n||"broker"===n){c="broker"===n?this.urls.api[n][d]+"/"+t:this.urls.api[n][d]+"/api/"+this.version+"/"+t;let e=s;"private"===d&&("broker"!==n||"POST"!==i&&"PUT"!==i&&"DELETE"!==i?(e.timestamp=this.nonce(),e.recvWindow=this.safeInteger(this.options,"recvWindow",5e3)):(e={timestamp:this.nonce(),recvWindow:this.safeInteger(this.options,"recvWindow",5e3)},a=this.json(s)));let h="";if(Object.keys(e).length&&(h=this.urlencode(e),c+="?"+h),"private"===d){this.checkRequiredCredentials();c+="&signature="+this.hmac(this.encode(h),this.encode(this.secret),o.s),r={"X-MEXC-APIKEY":this.apiKey,source:this.safeString(this.options,"broker","CCXT")}}"POST"!==i&&"PUT"!==i&&"DELETE"!==i||(r["Content-Type"]="application/json")}else if("contract"===n||"spot2"===n)if(c=this.urls.api[n][d]+"/"+this.implodeParams(t,s),s=this.omit(s,this.extractParams(t)),"public"===d)Object.keys(s).length&&(c+="?"+this.urlencode(s));else{this.checkRequiredCredentials();const t=this.nonce().toString();let e="";r={ApiKey:this.apiKey,"Request-Time":t,"Content-Type":"application/json",source:this.safeString(this.options,"broker","CCXT")},"POST"===i?(e=this.json(s),a=e):(s=this.keysort(s),Object.keys(s).length&&(e+=this.urlencode(s),c+="?"+e)),e=this.apiKey+t+e;const n=this.hmac(this.encode(e),this.encode(this.secret),o.s);r.Signature=n}return{url:c,method:i,body:a,headers:r}}handleErrors(t,e,i,s,a,n,o,d,c){if(void 0===o)return;if(!0===this.safeBool(o,"success",!1))return;const h=this.safeString(o,"code",void 0);if(void 0!==h&&"200"!==h&&"0"!==h){const t=this.id+" "+n;throw this.throwBroadlyMatchedException(this.exceptions.broad,n,t),this.throwExactlyMatchedException(this.exceptions.exact,h,t),new r.ExchangeError(t)}}}},2435(t,e,i){"use strict";i.d(e,{H:()=>b});var s=i(230),r=i(1094);const a=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),n=Uint8Array.from({length:16},(t,e)=>e),o=n.map(t=>(9*t+5)%16);let d=[n],c=[o];for(let t=0;t<4;t++)for(let e of[d,c])e.push(e[t].map(t=>a[t]));const h=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),l=d.map((t,e)=>t.map(t=>h[e][t])),u=c.map((t,e)=>t.map(t=>h[e][t])),p=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),f=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),m=(t,e)=>t<<e|t>>>32-e;function g(t,e,i,s){return 0===t?e^i^s:1===t?e&i|~e&s:2===t?(e|~i)^s:3===t?e&s|i&~s:e^(i|~s)}const y=new Uint32Array(16);class v extends s.D{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:i,h3:s,h4:r}=this;return[t,e,i,s,r]}set(t,e,i,s,r){this.h0=0|t,this.h1=0|e,this.h2=0|i,this.h3=0|s,this.h4=0|r}process(t,e){for(let i=0;i<16;i++,e+=4)y[i]=t.getUint32(e,!0);let i=0|this.h0,s=i,r=0|this.h1,a=r,n=0|this.h2,o=n,h=0|this.h3,v=h,b=0|this.h4,w=b;for(let t=0;t<5;t++){const e=4-t,S=p[t],k=f[t],O=d[t],T=c[t],P=l[t],_=u[t];for(let e=0;e<16;e++){const s=m(i+g(t,r,n,h)+y[O[e]]+S,P[e])+b|0;i=b,b=h,h=0|m(n,10),n=r,r=s}for(let t=0;t<16;t++){const i=m(s+g(e,a,o,v)+y[T[t]]+k,_[t])+w|0;s=w,w=v,v=0|m(o,10),o=a,a=i}}this.set(this.h1+n+v|0,this.h2+h+w|0,this.h3+b+s|0,this.h4+i+a|0,this.h0+r+o|0)}roundClean(){y.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const b=(0,r.ld)(()=>new v)},2442(t,e,i){"use strict";i.d(e,{Is:()=>p,x3:()=>u});var s=i(1064),r=i(191),a=i(7517);const{Ph:n,aT:o}=r,d={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=d;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const i=t[1],s=t.subarray(2,i+2);if(!i||s.length!==i)throw new e("Invalid signature integer: wrong length");if(0===s[0]&&s[1]<=127)throw new e("Invalid signature integer: trailing length");return{d:n(s),l:t.subarray(i+2)}},toSig(t){const{Err:e}=d,i="string"==typeof t?o(t):t;if(!(i instanceof Uint8Array))throw new Error("ui8a expected");let s=i.length;if(s<2||48!=i[0])throw new e("Invalid signature tag");if(i[1]!==s-2)throw new e("Invalid signature: incorrect length");const{d:r,l:a}=d._parseInt(i.subarray(2)),{d:n,l:c}=d._parseInt(a);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r,s:n}},hexFromSig(t){const e=t=>Number.parseInt(t[0],16)>=8?"00"+t:t,i=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},s=e(i(t.s)),r=e(i(t.r)),a=s.length/2,n=r.length/2,o=i(a),d=i(n);return`30${i(n+a+4)}02${d}${r}02${o}${s}`}},c=BigInt(0),h=BigInt(1);function l(t){const e=
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function(t){const e=(0,a.h)(t);r.Q5(e,{a:"field",b:"field",fromBytes:"function",toBytes:"function"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean"});const{endo:i,Fp:s,a:n}=e;if(i){if(!s.eql(n,s.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof i||"bigint"!=typeof i.beta||"function"!=typeof i.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:i}=e;function n(t){const{a:s,b:r}=e,a=i.sqr(t),n=i.mul(a,t);return i.add(i.add(n,i.mul(t,s)),r)}function o(t){return"bigint"==typeof t&&c<t&&t<e.n}function d(t){if(!o(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(t){const{allowedPrivateKeyLengths:i,nByteLength:a,wrapPrivateKey:n,n:o}=e;if(i&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=r.My(t)),"string"!=typeof t||!i.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*a,"0")}let c;try{c="bigint"==typeof t?t:r.Ph((0,r.qj)("private key",t,a))}catch(e){throw new Error(`private key must be ${a} bytes, hex or bigint, not ${typeof t}`)}return n&&(c=s.zi(c,o)),d(c),c}const u=new Map;function p(t){if(!(t instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(t,e,s){if(this.px=t,this.py=e,this.pz=s,null==t||!i.isValid(t))throw new Error("x required");if(null==e||!i.isValid(e))throw new Error("y required");if(null==s||!i.isValid(s))throw new Error("z required")}static fromAffine(t){const{x:e,y:s}=t||{};if(!t||!i.isValid(e)||!i.isValid(s))throw new Error("invalid affine point");if(t instanceof f)throw new Error("projective point not allowed");const r=t=>i.eql(t,i.ZERO);return r(e)&&r(s)?f.ZERO:new f(e,s,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=i.invertBatch(t.map(t=>t.pz));return t.map((t,i)=>t.toAffine(e[i])).map(f.fromAffine)}static fromHex(t){const i=f.fromAffine(e.fromBytes((0,r.qj)("pointHex",t)));return i.assertValidity(),i}static fromPrivateKey(t){return f.BASE.multiply(l(t))}_setWindowSize(t){this._WINDOW_SIZE=t,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:t,y:s}=this.toAffine();if(!i.isValid(t)||!i.isValid(s))throw new Error("bad point: x or y not FE");const r=i.sqr(s),a=n(t);if(!i.eql(r,a))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(i.isOdd)return!i.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){p(t);const{px:e,py:s,pz:r}=this,{px:a,py:n,pz:o}=t,d=i.eql(i.mul(e,o),i.mul(a,r)),c=i.eql(i.mul(s,o),i.mul(n,r));return d&&c}negate(){return new f(this.px,i.neg(this.py),this.pz)}double(){const{a:t,b:s}=e,r=i.mul(s,3n),{px:a,py:n,pz:o}=this;let d=i.ZERO,c=i.ZERO,h=i.ZERO,l=i.mul(a,a),u=i.mul(n,n),p=i.mul(o,o),m=i.mul(a,n);return m=i.add(m,m),h=i.mul(a,o),h=i.add(h,h),d=i.mul(t,h),c=i.mul(r,p),c=i.add(d,c),d=i.sub(u,c),c=i.add(u,c),c=i.mul(d,c),d=i.mul(m,d),h=i.mul(r,h),p=i.mul(t,p),m=i.sub(l,p),m=i.mul(t,m),m=i.add(m,h),h=i.add(l,l),l=i.add(h,l),l=i.add(l,p),l=i.mul(l,m),c=i.add(c,l),p=i.mul(n,o),p=i.add(p,p),l=i.mul(p,m),d=i.sub(d,l),h=i.mul(p,u),h=i.add(h,h),h=i.add(h,h),new f(d,c,h)}add(t){p(t);const{px:s,py:r,pz:a}=this,{px:n,py:o,pz:d}=t;let c=i.ZERO,h=i.ZERO,l=i.ZERO;const u=e.a,m=i.mul(e.b,3n);let g=i.mul(s,n),y=i.mul(r,o),v=i.mul(a,d),b=i.add(s,r),w=i.add(n,o);b=i.mul(b,w),w=i.add(g,y),b=i.sub(b,w),w=i.add(s,a);let S=i.add(n,d);return w=i.mul(w,S),S=i.add(g,v),w=i.sub(w,S),S=i.add(r,a),c=i.add(o,d),S=i.mul(S,c),c=i.add(y,v),S=i.sub(S,c),l=i.mul(u,w),c=i.mul(m,v),l=i.add(c,l),c=i.sub(y,l),l=i.add(y,l),h=i.mul(c,l),y=i.add(g,g),y=i.add(y,g),v=i.mul(u,v),w=i.mul(m,w),y=i.add(y,v),v=i.sub(g,v),v=i.mul(u,v),w=i.add(w,v),g=i.mul(y,w),h=i.add(h,g),g=i.mul(S,w),c=i.mul(b,c),c=i.sub(c,g),g=i.mul(b,y),l=i.mul(S,l),l=i.add(l,g),new f(c,h,l)}subtract(t){return this.add(t.negate())}is0(){return this.equals(f.ZERO)}wNAF(t){return g.wNAFCached(this,u,t,t=>{const e=i.invertBatch(t.map(t=>t.pz));return t.map((t,i)=>t.toAffine(e[i])).map(f.fromAffine)})}multiplyUnsafe(t){const s=f.ZERO;if(t===c)return s;if(d(t),t===h)return this;const{endo:r}=e;if(!r)return g.unsafeLadder(this,t);let{k1neg:a,k1:n,k2neg:o,k2:l}=r.splitScalar(t),u=s,p=s,m=this;for(;n>c||l>c;)n&h&&(u=u.add(m)),l&h&&(p=p.add(m)),m=m.double(),n>>=h,l>>=h;return a&&(u=u.negate()),o&&(p=p.negate()),p=new f(i.mul(p.px,r.beta),p.py,p.pz),u.add(p)}multiply(t){d(t);let s,r,a=t;const{endo:n}=e;if(n){const{k1neg:t,k1:e,k2neg:o,k2:d}=n.splitScalar(a);let{p:c,f:h}=this.wNAF(e),{p:l,f:u}=this.wNAF(d);c=g.constTimeNegate(t,c),l=g.constTimeNegate(o,l),l=new f(i.mul(l.px,n.beta),l.py,l.pz),s=c.add(l),r=h.add(u)}else{const{p:t,f:e}=this.wNAF(a);s=t,r=e}return f.normalizeZ([s,r])[0]}multiplyAndAddUnsafe(t,e,i){const s=f.BASE,r=(t,e)=>e!==c&&e!==h&&t.equals(s)?t.multiply(e):t.multiplyUnsafe(e),a=r(this,e).add(r(t,i));return a.is0()?void 0:a}toAffine(t){const{px:e,py:s,pz:r}=this,a=this.is0();null==t&&(t=a?i.ONE:i.inv(r));const n=i.mul(e,t),o=i.mul(s,t),d=i.mul(r,t);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(d,i.ONE))throw new Error("invZ was invalid");return{x:n,y:o}}isTorsionFree(){const{h:t,isTorsionFree:i}=e;if(t===h)return!0;if(i)return i(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:i}=e;return t===h?this:i?i(f,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),e.toBytes(f,this,t)}toHex(t=!0){return r.My(this.toRawBytes(t))}}f.BASE=new f(e.Gx,e.Gy,i.ONE),f.ZERO=new f(i.ZERO,i.ONE,i.ZERO);const m=e.nBitLength,g=(0,a.A)(f,e.endo?Math.ceil(m/2):m);return{ProjectivePoint:f,normPrivateKeyToScalar:l,weierstrassEquation:n,isWithinCurveOrder:o}}function u(t){const e=function(t){const e=(0,a.h)(t);return r.Q5(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),i=e.n,n=e.Fp,o=n.BYTES+1,u=2*n.BYTES+1;function p(t){return s.zi(t,i)}function f(t){return s.B8(t,i)}const{ProjectivePoint:m,normPrivateKeyToScalar:g,weierstrassEquation:y,isWithinCurveOrder:v}=l({...e,toBytes(t,e,i){const s=e.toAffine(),a=n.toBytes(s.x),o=r.Id;return i?o(Uint8Array.from([e.hasEvenY()?2:3]),a):o(Uint8Array.from([4]),a,n.toBytes(s.y))},fromBytes(t){const e=t.length,i=t[0],s=t.subarray(1);if(e!==o||2!==i&&3!==i){if(e===u&&4===i){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${e} was invalid. Expected ${o} compressed bytes or ${u} uncompressed bytes`)}{const t=r.Ph(s);if(!(c<(a=t)&&a<n.ORDER))throw new Error("Point is not on curve");const e=y(t);let o=n.sqrt(e);return!(1&~i)!==((o&h)===h)&&(o=n.neg(o)),{x:t,y:o}}var a}}),b=t=>r.My(r.lq(t,e.nByteLength));function w(t){return t>i>>h}const S=(t,e,i)=>r.Ph(t.slice(e,i));class k{constructor(t,e,i){this.r=t,this.s=e,this.recovery=i,this.assertValidity()}static fromCompact(t){const i=e.nByteLength;return t=(0,r.qj)("compactSignature",t,2*i),new k(S(t,0,i),S(t,i,2*i))}static fromDER(t){const{r:e,s:i}=d.toSig((0,r.qj)("DER",t));return new k(e,i)}assertValidity(){if(!v(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!v(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new k(this.r,this.s,t)}recoverPublicKey(t){const{r:i,s,recovery:a}=this,o=_((0,r.qj)("msgHash",t));if(null==a||![0,1,2,3].includes(a))throw new Error("recovery id invalid");const d=2===a||3===a?i+e.n:i;if(d>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const c=1&a?"03":"02",h=m.fromHex(c+b(d)),l=f(d),u=p(-o*l),g=p(s*l),y=m.BASE.multiplyAndAddUnsafe(h,u,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new k(this.r,p(-this.s),this.recovery):this}toDERRawBytes(){return r.aT(this.toDERHex())}toDERHex(){return d.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return r.aT(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}const O={isValidPrivateKey(t){try{return g(t),!0}catch(t){return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const t=e.randomBytes(n.BYTES+8),a=s.PA(t,i);return r.lq(a,e.nByteLength)},precompute:(t=8,e=m.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function T(t){const e=t instanceof Uint8Array,i="string"==typeof t,s=(e||i)&&t.length;return e?s===o||s===u:i?s===2*o||s===2*u:t instanceof m}const P=e.bits2int||function(t){const i=r.Ph(t),s=8*t.length-e.nBitLength;return s>0?i>>BigInt(s):i},_=e.bits2int_modN||function(t){return p(P(t))},A=r.OG(e.nBitLength);function I(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(c<=t&&t<A))throw new Error(`bigint expected < 2^${e.nBitLength}`);return r.lq(t,e.nByteLength)}function x(t,i,s=E){if(["recovered","canonical"].some(t=>t in s))throw new Error("sign() legacy options not supported");const{hash:a,randomBytes:o}=e;let{lowS:d,prehash:l,extraEntropy:u}=s;null==d&&(d=!0),t=(0,r.qj)("msgHash",t),l&&(t=(0,r.qj)("prehashed msgHash",a(t)));const y=_(t),b=g(i),S=[I(b),I(y)];if(null!=u){const t=!0===u?o(n.BYTES):u;S.push((0,r.qj)("extraEntropy",t,n.BYTES))}const O=r.Id(...S),T=y;return{seed:O,k2sig:function(t){const e=P(t);if(!v(e))return;const i=f(e),s=m.BASE.multiply(e).toAffine(),r=p(s.x);if(r===c)return;const a=p(i*p(T+r*b));if(a===c)return;let n=(s.x===r?0:2)|Number(s.y&h),o=a;return d&&w(a)&&(o=function(t){return w(t)?p(-t):t}(a),n^=1),new k(r,o,n)}}}const E={lowS:e.lowS,prehash:!1},M={lowS:e.lowS,prehash:!1};return m.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return m.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,i=!0){if(T(t))throw new Error("first arg must be private key");if(!T(e))throw new Error("second arg must be public key");return m.fromHex(e).multiply(g(t)).toRawBytes(i)},sign:function(t,i,s=E){const{seed:a,k2sig:n}=x(t,i,s);return r.fg(e.hash.outputLen,e.nByteLength,e.hmac)(a,n)},verify:function(t,i,s,a=M){const n=t;if(i=(0,r.qj)("msgHash",i),s=(0,r.qj)("publicKey",s),"strict"in a)throw new Error("options.strict was renamed to lowS");const{lowS:o,prehash:c}=a;let h,l;try{if("string"==typeof n||n instanceof Uint8Array)try{h=k.fromDER(n)}catch(t){if(!(t instanceof d.Err))throw t;h=k.fromCompact(n)}else{if("object"!=typeof n||"bigint"!=typeof n.r||"bigint"!=typeof n.s)throw new Error("PARSE");{const{r:t,s:e}=n;h=new k(t,e)}}l=m.fromHex(s)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(o&&h.hasHighS())return!1;c&&(i=e.hash(i));const{r:u,s:g}=h,y=_(i),v=f(g),b=p(y*v),w=p(u*v),S=m.BASE.multiplyAndAddUnsafe(l,b,w)?.toAffine();return!!S&&p(S.x)===u},ProjectivePoint:m,Signature:k,utils:O}}function p(t,e){if(s.jr(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const i=function(t,e){const i=t.ORDER;let s=0n;for(let t=i-1n;t%2n==0n;t/=2n)s+=1n;const r=s,a=(i-1n)/2n**r,n=(a-1n)/2n,o=2n**r-1n,d=2n**(r-1n),c=t.pow(e,a),h=t.pow(e,(a+1n)/2n);let l=(e,i)=>{let s=c,a=t.pow(i,o),l=t.sqr(a);l=t.mul(l,i);let u=t.mul(e,l);u=t.pow(u,n),u=t.mul(u,a),a=t.mul(u,i),l=t.mul(u,e);let p=t.mul(l,a);u=t.pow(p,d);let f=t.eql(u,t.ONE);a=t.mul(l,h),u=t.mul(p,s),l=t.cmov(a,l,f),p=t.cmov(u,p,f);for(let e=r;e>1;e--){let i=2n**(e-2n),r=t.pow(p,i);const n=t.eql(r,t.ONE);a=t.mul(l,s),s=t.mul(s,s),r=t.mul(p,s),l=t.cmov(a,l,n),p=t.cmov(r,p,n)}return{isValid:f,value:l}};if(t.ORDER%4n==3n){const i=(t.ORDER-3n)/4n,s=t.sqrt(t.neg(e));l=(e,r)=>{let a=t.sqr(r);const n=t.mul(e,r);a=t.mul(a,n);let o=t.pow(a,i);o=t.mul(o,n);const d=t.mul(o,s),c=t.mul(t.sqr(o),r),h=t.eql(c,e);return{isValid:h,value:t.cmov(d,o,h)}}}return l}(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return s=>{let r,a,n,o,d,c,h,l;r=t.sqr(s),r=t.mul(r,e.Z),a=t.sqr(r),a=t.add(a,r),n=t.add(a,t.ONE),n=t.mul(n,e.B),o=t.cmov(e.Z,t.neg(a),!t.eql(a,t.ZERO)),o=t.mul(o,e.A),a=t.sqr(n),c=t.sqr(o),d=t.mul(c,e.A),a=t.add(a,d),a=t.mul(a,n),c=t.mul(c,o),d=t.mul(c,e.B),a=t.add(a,d),h=t.mul(r,n);const{isValid:u,value:p}=i(a,c);l=t.mul(r,s),l=t.mul(l,p),h=t.cmov(h,n,u),l=t.cmov(l,p,u);const f=t.isOdd(s)===t.isOdd(l);return l=t.cmov(t.neg(l),l,f),h=t.div(h,o),{x:h,y:l}}}},2501(t,e,i){"use strict";i.d(e,{Y:()=>h});var s=i(6279),r=i(1170),a=i(5268),n=i(890),o=i(9476),d=i(1279),c=i(7196);class h extends o.s{constructor(t){super(),t&&("string"==typeof t?this.parseKey(t):(h.hasPrivateKeyProperty(t)||h.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))}parseKey(t){try{let i=0,s=0;const o=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(t)?r._.decode(t):a.o.unarmor(t);let c=n.Ge.decode(o);if(3===c.sub.length&&(c=c.sub[2].sub[0]),9===c.sub.length){i=c.sub[1].getHexStringValue(),this.n=(0,d.Bv)(i,16),s=c.sub[2].getHexStringValue(),this.e=parseInt(s,16);const t=c.sub[3].getHexStringValue();this.d=(0,d.Bv)(t,16);const e=c.sub[4].getHexStringValue();this.p=(0,d.Bv)(e,16);const r=c.sub[5].getHexStringValue();this.q=(0,d.Bv)(r,16);const a=c.sub[6].getHexStringValue();this.dmp1=(0,d.Bv)(a,16);const n=c.sub[7].getHexStringValue();this.dmq1=(0,d.Bv)(n,16);const o=c.sub[8].getHexStringValue();this.coeff=(0,d.Bv)(o,16)}else{if(2!==c.sub.length)return!1;if(c.sub[0].sub){var e=c.sub[1].sub[0];i=e.sub[0].getHexStringValue(),this.n=(0,d.Bv)(i,16),s=e.sub[1].getHexStringValue(),this.e=parseInt(s,16)}else i=c.sub[0].getHexStringValue(),this.n=(0,d.Bv)(i,16),s=c.sub[1].getHexStringValue(),this.e=parseInt(s,16)}return!0}catch(t){return!1}}getPrivateBaseKey(){const t={array:[new c.p.asn1.DERInteger({int:0}),new c.p.asn1.DERInteger({bigint:this.n}),new c.p.asn1.DERInteger({int:this.e}),new c.p.asn1.DERInteger({bigint:this.d}),new c.p.asn1.DERInteger({bigint:this.p}),new c.p.asn1.DERInteger({bigint:this.q}),new c.p.asn1.DERInteger({bigint:this.dmp1}),new c.p.asn1.DERInteger({bigint:this.dmq1}),new c.p.asn1.DERInteger({bigint:this.coeff})]};return new c.p.asn1.DERSequence(t).getEncodedHex()}getPrivateBaseKeyB64(){return(0,s.gr)(this.getPrivateBaseKey())}getPublicBaseKey(){const t=new c.p.asn1.DERSequence({array:[new c.p.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new c.p.asn1.DERNull]}),e=new c.p.asn1.DERSequence({array:[new c.p.asn1.DERInteger({bigint:this.n}),new c.p.asn1.DERInteger({int:this.e})]}),i=new c.p.asn1.DERBitString({hex:"00"+e.getEncodedHex()});return new c.p.asn1.DERSequence({array:[t,i]}).getEncodedHex()}getPublicBaseKeyB64(){return(0,s.gr)(this.getPublicBaseKey())}static wordwrap(t,e){if(!t)return t;const i="(.{1,"+(e=e||64)+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(i,"g")).join("\n")}getPrivateKey(){let t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=h.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----",t}getPublicKey(){let t="-----BEGIN PUBLIC KEY-----\n";return t+=h.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----",t}static hasPublicKeyProperty(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")}static hasPrivateKeyProperty(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")}parsePropertiesFrom(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)}}},2628(t,e,i){"use strict";i.d(e,{$r:()=>o,AR:()=>n,Ir:()=>r,OF:()=>d,W4:()=>s,XP:()=>c,cO:()=>a});function s(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function r(t,e){return t&e}function a(t,e){return t|e}function n(t,e){return t^e}function o(t,e){return t&~e}function d(t){if(0==t)return-1;let e=0;return 65535&t||(t>>=16,e+=16),255&t||(t>>=8,e+=8),15&t||(t>>=4,e+=4),3&t||(t>>=2,e+=2),1&t||++e,e}function c(t){let e=0;for(;0!=t;)t&=t-1,++e;return e}},2634(t,e,i){"use strict";var s;i.d(e,{V:()=>n});const r=new WeakMap,a=()=>{};class n{constructor(t){this.subscribers=[],this.settlement=null,this[s]="Unpromise",this.promise="function"==typeof t?new Promise(t):t;const e=this.promise.then(t=>{const{subscribers:e}=this;this.subscribers=null,this.settlement={status:"fulfilled",value:t},e?.forEach(({resolve:e})=>{e(t)})});"catch"in e&&e.catch(t=>{const{subscribers:e}=this;this.subscribers=null,this.settlement={status:"rejected",reason:t},e?.forEach(({reject:e})=>{e(t)})})}subscribe(){let t,e;const{settlement:i}=this;if(null===i){if(null===this.subscribers)throw new Error("Unpromise settled but still has subscribers");const i=function(){let t,e;const i=new Promise((i,s)=>{t=i,e=s});return{promise:i,resolve:t,reject:e}}();this.subscribers=(s=this.subscribers,r=i,[...s,r]),t=i.promise,e=()=>{null!==this.subscribers&&(this.subscribers=function(t,e){const i=t.indexOf(e);if(-1!==i)return function(t,e){return[...t.slice(0,e),...t.slice(e+1)]}(t,i);return t}(this.subscribers,i))}}else{const{status:s}=i;t="fulfilled"===s?Promise.resolve(i.value):Promise.reject(i.reason),e=a}var s,r;return Object.assign(t,{unsubscribe:e})}then(t,e){const i=this.subscribe(),{unsubscribe:s}=i;return Object.assign(i.then(t,e),{unsubscribe:s})}catch(t){const e=this.subscribe(),{unsubscribe:i}=e;return Object.assign(e.catch(t),{unsubscribe:i})}finally(t){const e=this.subscribe(),{unsubscribe:i}=e;return Object.assign(e.finally(t),{unsubscribe:i})}static proxy(t){const e=n.getSubscribablePromise(t);return void 0!==e?e:n.createSubscribablePromise(t)}static createSubscribablePromise(t){const e=new n(t);return r.set(t,e),r.set(e,e),e}static getSubscribablePromise(t){return r.get(t)}static resolve(t){const e="object"==typeof t&&null!==t&&"then"in t&&"function"==typeof t.then?t:Promise.resolve(t);return n.proxy(e).subscribe()}static async any(t){const e=(Array.isArray(t)?t:[...t]).map(n.resolve);try{return await Promise.any(e)}finally{e.forEach(({unsubscribe:t})=>{t()})}}static async race(t){const e=(Array.isArray(t)?t:[...t]).map(n.resolve);try{return await Promise.race(e)}finally{e.forEach(({unsubscribe:t})=>{t()})}}static async raceReferences(t){const e=t.map(o);try{return await Promise.race(e)}finally{for(const t of e)t.unsubscribe()}}}function o(t){return n.proxy(t).then(()=>[t])}s=Symbol.toStringTag},2755(t,e,i){"use strict";i.d(e,{bX:()=>r});var s=i(9332);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.transfer&&s.mr.encode(t.transfer,e.uint32(10).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={transfer:void 0};for(;i.pos<r;){const t=i.uint32();if(t>>>3==1)a.transfer=s.mr.decode(i,i.uint32());else i.skipType(7&t)}return a},fromPartial(t){const e={transfer:void 0};return e.transfer=void 0!==t.transfer&&null!==t.transfer?s.mr.fromPartial(t.transfer):void 0,e}}},2931(t,e,i){"use strict";i.d(e,{Hk:()=>o,I3:()=>r,Pt:()=>n,TG:()=>a});class s extends Array{constructor(t=void 0){super(),Object.defineProperty(this,"maxSize",{__proto__:null,value:t,writable:!0})}clear(){this.length=0}}class r extends s{constructor(t=void 0){super(t),this.hashmap={},Object.defineProperty(this,"nestedNewUpdatesBySymbol",{__proto__:null,value:!1,writable:!0}),Object.defineProperty(this,"newUpdatesBySymbol",{__proto__:null,value:{},writable:!0}),Object.defineProperty(this,"clearUpdatesBySymbol",{__proto__:null,value:{},writable:!0}),Object.defineProperty(this,"allNewUpdates",{__proto__:null,value:0,writable:!0}),Object.defineProperty(this,"clearAllUpdates",{__proto__:null,value:!1,writable:!0}),Object.defineProperty(this,"hashmap",{__proto__:null,value:{},writable:!0,enumerable:!1})}getLimit(t,e){let i;return void 0===t?(i=this.allNewUpdates,this.clearAllUpdates=!0):(i=this.newUpdatesBySymbol[t],void 0!==i&&this.nestedNewUpdatesBySymbol&&(i=i.size),this.clearUpdatesBySymbol[t]=!0),void 0===i?e:void 0!==e?Math.min(i,e):i}append(t){this.maxSize&&this.length===this.maxSize&&this.shift(),this.push(t),this.clearAllUpdates&&(this.clearAllUpdates=!1,this.clearUpdatesBySymbol={},this.allNewUpdates=0,this.newUpdatesBySymbol={}),this.clearUpdatesBySymbol[t.symbol]&&(this.clearUpdatesBySymbol[t.symbol]=!1,this.newUpdatesBySymbol[t.symbol]=0),this.newUpdatesBySymbol[t.symbol]=(this.newUpdatesBySymbol[t.symbol]||0)+1,this.allNewUpdates=(this.allNewUpdates||0)+1}}class a extends s{constructor(t=void 0){super(t),Object.defineProperty(this,"hashmap",{__proto__:null,value:{},writable:!0}),Object.defineProperty(this,"sizeTracker",{__proto__:null,value:new Set,writable:!0}),Object.defineProperty(this,"newUpdates",{__proto__:null,value:0,writable:!0}),Object.defineProperty(this,"clearUpdates",{__proto__:null,value:!1,writable:!0})}getLimit(t,e){return this.clearUpdates=!0,void 0===e?this.newUpdates:Math.min(this.newUpdates,e)}append(t){if(t[0]in this.hashmap){const e=this.hashmap[t[0]];if(e!==t)for(const i in t)e[i]=t[i]}else{if(this.hashmap[t[0]]=t,this.maxSize&&this.length===this.maxSize){const t=this.shift();delete this.hashmap[t[0]]}this.push(t)}this.clearUpdates&&(this.clearUpdates=!1,this.sizeTracker.clear()),this.sizeTracker.add(t[0]),this.newUpdates=this.sizeTracker.size}}class n extends r{constructor(t=void 0){super(t),this.nestedNewUpdatesBySymbol=!0}append(t){const e=this.hashmap[t.symbol]=this.hashmap[t.symbol]||{};if(t.id in e){const i=e[t.id];if(i!==t)for(const e in t)i[e]=t[e];t=i;const s=this.findIndex(e=>e.id===t.id);this.splice(s,1)}else e[t.id]=t;if(this.maxSize&&this.length===this.maxSize){const t=this.shift();delete this.hashmap[t.symbol][t.id]}this.push(t),this.clearAllUpdates&&(this.clearAllUpdates=!1,this.clearUpdatesBySymbol={},this.allNewUpdates=0,this.newUpdatesBySymbol={}),void 0===this.newUpdatesBySymbol[t.symbol]&&(this.newUpdatesBySymbol[t.symbol]=new Set),this.clearUpdatesBySymbol[t.symbol]&&(this.clearUpdatesBySymbol[t.symbol]=!1,this.newUpdatesBySymbol[t.symbol].clear());const i=this.newUpdatesBySymbol[t.symbol],s=i.size;i.add(t.id);const r=i.size;this.allNewUpdates=(this.allNewUpdates||0)+(r-s)}}class o extends r{constructor(){super(),this.nestedNewUpdatesBySymbol=!0,Object.defineProperty(this,"hashmap",{__proto__:null,value:{},writable:!0})}append(t){const e=this.hashmap[t.symbol]=this.hashmap[t.symbol]||{};if(t.side in e){const i=e[t.side];if(i!==t)for(const e in t)i[e]=t[e];t=i;const s=this.findIndex(e=>e.symbol===t.symbol&&e.side===t.side);this.splice(s,1)}else e[t.side]=t;this.push(t),this.clearAllUpdates&&(this.clearAllUpdates=!1,this.clearUpdatesBySymbol={},this.allNewUpdates=0,this.newUpdatesBySymbol={}),void 0===this.newUpdatesBySymbol[t.symbol]&&(this.newUpdatesBySymbol[t.symbol]=new Set),this.clearUpdatesBySymbol[t.symbol]&&(this.clearUpdatesBySymbol[t.symbol]=!1,this.newUpdatesBySymbol[t.symbol].clear());const i=this.newUpdatesBySymbol[t.symbol],s=i.size;i.add(t.side);const r=i.size;this.allNewUpdates=(this.allNewUpdates||0)+(r-s)}}},2961(t,e,i){"use strict";i.d(e,{k:()=>Be});var s=i(5095),r=i(7437),a=i(6238),n=i(2079),o=i(5147),d=i(7288),c=i(3206),h=i(3828),l=i(8283),u=i(8995),p=i(5897),f=i(4380),m=i(447),g=i(3187),y=i(7661),v=i(9793),b=i(9491),w=i(6907),S=i(1878),k=i(4852),O=i(3466),T=i(9187),P=i(1291),_=i.n(P);const{isNode:A,selfIsDefined:I,deepExtend:x,extend:E,clone:M,flatten:C,unique:B,indexBy:N,sortBy:R,sortBy2:L,safeFloat2:D,groupBy:q,aggregate:F,uuid:V,unCamelCase:U,precisionFromString:j,Throttler:G,capitalize:H,now:W,decimalToPrecision:z,safeValue:K,safeValue2:Y,safeString:Z,safeString2:$,seconds:Q,milliseconds:X,binaryToBase16:J,numberToBE:tt,base16ToBinary:et,iso8601:it,omit:st,isJsonEncodedObject:rt,safeInteger:at,sum:nt,omitZero:ot,implodeParams:dt,extractParams:ct,json:ht,merge:lt,binaryConcat:ut,hash:pt,arrayConcat:ft,encode:mt,urlencode:gt,hmac:yt,numberToString:vt,roundTimeframe:bt,parseTimeframe:wt,safeInteger2:St,safeStringLower:kt,parse8601:Ot,yyyymmdd:Tt,safeStringUpper:Pt,safeTimestamp:_t,binaryConcatArray:At,uuidv1:It,numberToLE:xt,ymdhms:Et,stringToBase64:Mt,decode:Ct,uuid22:Bt,safeIntegerProduct2:Nt,safeIntegerProduct:Rt,safeStringLower2:Lt,yymmdd:Dt,base58ToBinary:qt,binaryToBase58:Ft,safeTimestamp2:Vt,rawencode:Ut,keysort:jt,sort:Gt,inArray:Ht,isEmpty:Wt,ordered:zt,filterBy:Kt,uuid16:Yt,safeFloat:Zt,base64ToBinary:$t,safeStringUpper2:Qt,urlencodeWithArrayRepeat:Xt,microseconds:Jt,binaryToBase64:te,strip:ee,toArray:ie,safeFloatN:se,safeIntegerN:re,safeIntegerProductN:ae,safeTimestampN:ne,safeValueN:oe,safeStringN:de,safeStringLowerN:ce,safeStringUpperN:he,urlencodeNested:le,urlencodeBase64:ue,parseDate:pe,ymd:fe,base64ToString:me,crc32:ge,packb:ye,TRUNCATE:ve,ROUND:be,DECIMAL_PLACES:we,NO_PADDING:Se,TICK_SIZE:ke,SIGNIFICANT_DIGITS:Oe,sleep:Te}=s;let Pe,_e,Ae,Ie,xe,Ee,Me,Ce;(async()=>{try{Pe=await Promise.resolve().then(i.t.bind(i,2373,23))}catch(t){}})();class Be{constructor(t={}){this.isSandboxModeEnabled=!1,this.api=void 0,this.certified=!1,this.pro=!1,this.countries=void 0,this.userAgent=void 0,this.user_agent=void 0,this.userAgents={chrome:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36",chrome39:"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36",chrome100:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36"},this.headers={},this.returnResponseHeaders=!1,this.origin="*",this.MAX_VALUE=Number.MAX_VALUE,this.agent=void 0,this.nodeHttpModuleLoaded=!1,this.httpAgent=void 0,this.httpsAgent=void 0,this.minFundingAddressLength=1,this.substituteCommonCurrencyCodes=!0,this.quoteJsonNumbers=!0,this.number=Number,this.handleContentTypeApplicationZip=!1,this.reduceFees=!0,this.validateServerSsl=!0,this.validateClientSsl=!1,this.timeout=1e4,this.verbose=!1,this.twofa=void 0,this.balance={},this.liquidations={},this.orderbooks={},this.tickers={},this.fundingRates={},this.bidsasks={},this.orders=void 0,this.triggerOrders=void 0,this.transactions={},this.myLiquidations={},this.requiresWeb3=!1,this.requiresEddsa=!1,this.precision=void 0,this.enableLastJsonResponse=!1,this.enableLastHttpResponse=!0,this.enableLastResponseHeaders=!0,this.last_http_response=void 0,this.last_json_response=void 0,this.last_response_headers=void 0,this.last_request_headers=void 0,this.last_request_body=void 0,this.last_request_url=void 0,this.last_request_path=void 0,this.id="Exchange",this.markets=void 0,this.features=void 0,this.status=void 0,this.rateLimit=void 0,this.tokenBucket=void 0,this.throttler=void 0,this.enableRateLimit=void 0,this.rollingWindowSize=0,this.rateLimiterAlgorithm="leakyBucket",this.httpExceptions=void 0,this.limits=void 0,this.markets_by_id=void 0,this.symbols=void 0,this.ids=void 0,this.currencies={},this.baseCurrencies=void 0,this.quoteCurrencies=void 0,this.currencies_by_id=void 0,this.codes=void 0,this.reloadingMarkets=void 0,this.marketsLoading=void 0,this.accounts=void 0,this.accountsById=void 0,this.commonCurrencies=void 0,this.hostname=void 0,this.precisionMode=void 0,this.paddingMode=void 0,this.exceptions={},this.timeframes={},this.version=void 0,this.marketsByAltname=void 0,this.name=void 0,this.targetAccount=void 0,this.stablePairs={},this.httpProxyAgentModule=void 0,this.httpsProxyAgentModule=void 0,this.socksProxyAgentModule=void 0,this.socksProxyAgentModuleChecked=!1,this.proxyDictionaries={},this.proxiesModulesLoading=void 0,this.alias=!1,this.clients={},this.newUpdates=!0,this.streaming={},this.sleep=Te,this.deepExtend=x,this.deepExtendSafe=x,this.isNode=A,this.keys=r.HP,this.values=r.zu,this.extend=E,this.clone=M,this.flatten=C,this.unique=B,this.indexBy=N,this.indexBySafe=N,this.roundTimeframe=bt,this.sortBy=R,this.sortBy2=L,this.groupBy=q,this.aggregate=F,this.uuid=V,this.unCamelCase=U,this.precisionFromString=j,this.capitalize=H,this.now=W,this.decimalToPrecision=z,this.safeValue=K,this.safeValue2=Y,this.safeString=Z,this.safeString2=$,this.safeFloat=Zt,this.safeFloat2=D,this.seconds=Q,this.milliseconds=X,this.binaryToBase16=J,this.numberToBE=tt,this.base16ToBinary=et,this.iso8601=it,this.omit=st,this.isJsonEncodedObject=rt,this.safeInteger=at,this.sum=nt,this.omitZero=ot,this.implodeParams=dt,this.extractParams=ct,this.json=ht,this.vwap=a.ru,this.merge=lt,this.binaryConcat=ut,this.hash=pt,this.arrayConcat=ft,this.encode=mt,this.urlencode=gt,this.hmac=yt,this.numberToString=vt,this.parseTimeframe=wt,this.safeInteger2=St,this.safeStringLower=kt,this.parse8601=Ot,this.yyyymmdd=Tt,this.safeStringUpper=Pt,this.safeTimestamp=_t,this.binaryConcatArray=At,this.uuidv1=It,this.numberToLE=xt,this.ymdhms=Et,this.yymmdd=Dt,this.stringToBase64=Mt,this.decode=Ct,this.uuid22=Bt,this.safeIntegerProduct2=Nt,this.safeIntegerProduct=Rt,this.binaryToBase58=Ft,this.base58ToBinary=qt,this.base64ToBinary=$t,this.safeTimestamp2=Vt,this.rawencode=Ut,this.keysort=jt,this.sort=Gt,this.inArray=Ht,this.safeStringLower2=Lt,this.safeStringUpper2=Qt,this.isEmpty=Wt,this.ordered=zt,this.filterBy=Kt,this.uuid16=Yt,this.urlencodeWithArrayRepeat=Xt,this.microseconds=Jt,this.binaryToBase64=te,this.strip=ee,this.toArray=ie,this.safeFloatN=se,this.safeIntegerN=re,this.safeIntegerProductN=ae,this.safeTimestampN=ne,this.safeValueN=oe,this.safeStringN=de,this.safeStringLowerN=ce,this.safeStringUpperN=he,this.urlencodeNested=le,this.parseDate=pe,this.ymd=fe,this.base64ToString=me,this.crc32=ge,this.packb=ye,this.urlencodeBase64=ue,Object.assign(this,s),this.options=this.getDefaultOptions(),this.headers={},this.origin="*",this.minFundingAddressLength=1,this.substituteCommonCurrencyCodes=!0,this.quoteJsonNumbers=!0,this.number=Number,this.handleContentTypeApplicationZip=!1,this.reduceFees=!0,this.fetchImplementation=void 0,this.validateServerSsl=!0,this.validateClientSsl=!1,this.timeout=1e4,this.verbose=!1,this.twofa=void 0,this.apiKey=void 0,this.secret=void 0,this.uid=void 0,this.login=void 0,this.password=void 0,this.privateKey=void 0,this.walletAddress=void 0,this.token=void 0,this.balance={},this.bidsasks={},this.orderbooks={},this.tickers={},this.liquidations={},this.orders=void 0,this.trades={},this.transactions={},this.ohlcvs={},this.myLiquidations={},this.myTrades=void 0,this.positions=void 0,this.requiresWeb3=!1,this.requiresEddsa=!1,this.lastRestRequestTimestamp=0,this.enableLastJsonResponse=!1,this.enableLastHttpResponse=!0,this.enableLastResponseHeaders=!0,this.last_http_response=void 0,this.last_json_response=void 0,this.last_response_headers=void 0,this.last_request_headers=void 0,this.last_request_body=void 0,this.last_request_url=void 0,this.last_request_path=void 0;const e=(t=this)=>{if(null!==t){const i=Object.getOwnPropertyNames(t);for(let t=0;t<i.length;t++){const e=i[t];this[U(e)]=this[e]}e(Object.getPrototypeOf(t))}};e();const i=Object.entries(this.describe()).concat(Object.entries(t));for(let t=0;t<i.length;t++){const[e,s]=i[t];s&&Object.getPrototypeOf(s)===Object.prototype?this[e]=this.deepExtend(this[e],s):this[e]=s}const n={keepAlive:!0};this.validateServerSsl||(n.rejectUnauthorized=!1);const o=Object.keys(this.has);for(let t=0;t<o.length;t++){const e=o[t];this["has"+this.capitalize(e)]=!!this.has[e]}this.api&&this.defineRestApi(this.api,"request"),this.newUpdates=void 0===this.options.newUpdates||this.options.newUpdates,this.afterConstruct(),(this.safeBool(t,"sandbox")||this.safeBool(t,"testnet"))&&this.setSandboxMode(!0)}uuid5(t,e){const i=t.replace(/-/g,"").match(/.{1,2}/g).map(t=>parseInt(t,16)),s=(new TextEncoder).encode(e),r=new Uint8Array([...i,...s]),a=(0,O.e)(r);a[6]=15&a[6]|80,a[8]=63&a[8]|128;const n=[...a.slice(0,16)].map(t=>t.toString(16).padStart(2,"0")).join("");return[n.substring(0,8),n.substring(8,12),n.substring(12,16),n.substring(16,20),n.substring(20,32)].join("-")}encodeURIComponent(...t){return encodeURIComponent(...t)}checkRequiredVersion(t,e=!0){let i=!0;const[s,r,a]=t.split("."),[o,d,c]=Be.ccxtVersion.split("."),h=this.parseToInt(s),l=this.parseToInt(r),u=this.parseToInt(a),p=this.parseToInt(o),f=this.parseToInt(d),m=this.parseToInt(c);if(h>p&&(i=!1),h===p&&(l>f||l===f&&u>m)&&(i=!1),!i){if(e)throw new n.NotSupported("Your current version of CCXT is "+Be.ccxtVersion+", a newer version "+t+" is required, please, upgrade your version of CCXT");return e}return i}throttle(t=void 0){return this.throttler.throttle(t)}initThrottler(){this.throttler=new G(this.tokenBucket)}defineRestApiEndpoint(t,e,i,s,r,a,n={}){const o=r.split(/[^a-zA-Z0-9]/),d=o.map(this.capitalize).join(""),c=o.map(t=>t.trim().toLowerCase()).filter(t=>t.length>0).join("_"),h=[a[0]].concat(a.slice(1).map(this.capitalize)).join(""),l=[a[0]].concat(a.slice(1).map(t=>t.trim()).filter(t=>t.length>0)).join("_"),u=h+s+this.capitalize(d),p=l+"_"+i+"_"+c,f=a.length>1?a:a[0],m=async(i={},s={})=>this[t](r,f,e,i,void 0,void 0,n,s);this[u]=m,this[p]=m}defineRestApi(t,e,i=[]){const s=Object.keys(t);for(let r=0;r<s.length;r++){const a=s[r],o=t[a],d=a.toUpperCase(),c=a.toLowerCase(),h=this.capitalize(c);if(Array.isArray(o))for(let t=0;t<o.length;t++){const s=o[t].trim();this.defineRestApiEndpoint(e,d,c,h,s,i)}else if(a.match(/^(?:get|post|put|delete|head|patch)$/i)){const t=Object.keys(o);for(let s=0;s<t.length;s++){const r=t[s],a=r.trim(),l=o[r];if("object"==typeof l)this.defineRestApiEndpoint(e,d,c,h,a,i,l);else{if("number"!=typeof l)throw new n.NotSupported(this.id+" defineRestApi() API format is not supported, API leafs must strings, objects or numbers");this.defineRestApiEndpoint(e,d,c,h,a,i,{cost:l})}}}else this.defineRestApi(o,e,i.concat([a]))}}log(...t){console.log(...t)}async loadProxyModules(){return void 0===this.proxiesModulesLoading&&(this.proxiesModulesLoading=(async()=>{try{this.httpProxyAgentModule=await import("../static_dependencies/proxies/http-proxy-agent/index.js"),this.httpsProxyAgentModule=await import("../static_dependencies/proxies/https-proxy-agent/index.js")}catch(t){try{this.httpProxyAgentModule=await import("http-proxy-agent"),this.httpsProxyAgentModule=await import("https-proxy-agent")}catch(t){}}if(!1===this.socksProxyAgentModuleChecked){try{this.socksProxyAgentModule=await import("socks-proxy-agent")}catch(t){}this.socksProxyAgentModuleChecked=!0}})()),await this.proxiesModulesLoading}setProxyAgents(t,e,i){let s;if(!A&&(t||e||i))throw new n.NotSupported(this.id+' - proxies in browser-side projects are not supported. You have several choices: [A] Use `exchange.proxyUrl` property to redirect requests through local/remote cors-proxy server (find sample file named "sample-local-proxy-server-with-cors" in https://github.com/ccxt/ccxt/tree/master/examples/ folder, which can be used for REST requests only) [B] override `exchange.fetch` && `exchange.watch` methods to send requests through your custom proxy');if(t){if(void 0===this.httpProxyAgentModule)throw new n.NotSupported(this.id+" you need to load JS proxy modules with `await instance.loadProxyModules()` method at first to use proxies");t in this.proxyDictionaries||(this.proxyDictionaries[t]=new this.httpProxyAgentModule.HttpProxyAgent(t)),s=this.proxyDictionaries[t]}else if(e){if(void 0===this.httpsProxyAgentModule)throw new n.NotSupported(this.id+" you need to load JS proxy modules with `await instance.loadProxyModules()` method at first to use proxies");e in this.proxyDictionaries||(this.proxyDictionaries[e]=new this.httpsProxyAgentModule.HttpsProxyAgent(e)),s=this.proxyDictionaries[e],s.keepAlive=!0}else if(i){if(void 0===this.socksProxyAgentModule)throw new n.NotSupported(this.id+' - to use SOCKS proxy with ccxt, at first you need install module "npm i socks-proxy-agent" and then initialize proxies with `await instance.loadProxyModules()` method');i in this.proxyDictionaries||(this.proxyDictionaries[i]=new this.socksProxyAgentModule.SocksProxyAgent(i)),s=this.proxyDictionaries[i]}return s}async loadHttpProxyAgent(){if(!this.httpAgent){const t=await import("node:http");this.httpAgent=new t.Agent}return this.httpAgent}getHttpAgentIfNeeded(t){if(A&&"ws://"===t.substring(0,5)){if(void 0===this.httpAgent)throw new n.NotSupported(this.id+" to use proxy with non-ssl ws:// urls, at first run  `await exchange.loadHttpProxyAgent()` method");return this.httpAgent}}isBinaryMessage(t){return t instanceof Uint8Array}decodeProtoMsg(t){if(!Pe)throw new n.NotSupported(this.id+" requires protobuf to decode messages, please install it with `npm install protobufjs`");if(t instanceof Uint8Array){return Pe.default.PushDataV3ApiWrapper.decode(t).toJSON()}return t}async fetch(t,e="GET",i=void 0,s=void 0){if(A&&!this.nodeHttpModuleLoaded){this.nodeHttpModuleLoaded=!0;const t=await import("node:https");this.httpsAgent=new t.Agent({keepAlive:!0})}i=this.extend(this.headers,i);const r=this.checkProxyUrlSettings(t,e,i,s);let a=!1;void 0!==r&&(A&&(i=this.extend({Origin:this.origin},i),"http:"===r.substring(0,5)&&(await this.loadHttpProxyAgent(),a=this.httpAgent)),t=r+t);const[o,d,c]=this.checkProxySettings(t,e,i,s);this.checkConflictingProxies(o||d||c,r),A&&await this.loadProxyModules();const h=this.setProxyAgents(o,d,c),l=void 0!==this.userAgent?this.userAgent:this.user_agent;if(l&&A&&("string"==typeof l?i=this.extend({"User-Agent":l},i):"object"==typeof l&&"User-Agent"in l&&(i=this.extend(l,i))),i=this.setHeaders(i),this.verbose&&this.log("fetch Request:\n",this.id,e,t,"\nRequestHeaders:\n",i,"\nRequestBody:\n",s,"\n"),void 0===this.fetchImplementation)if(A){void 0===this.agent&&(this.agent=this.httpsAgent);try{const t=await import("../static_dependencies/node-fetch/index.js");this.AbortError=t.AbortError,this.fetchImplementation=t.default,this.FetchError=t.FetchError}catch(t){if("function"!=typeof fetch)throw new Error('Seems, "fetch" function is not available in your node-js version, please use latest node-js version');this.fetchImplementation=fetch,this.AbortError=DOMException,this.FetchError=TypeError}}else this.fetchImplementation=I()?self.fetch:fetch,this.AbortError=DOMException,this.FetchError=TypeError;const u=this.fetchImplementation,p={method:e,headers:i,body:s,timeout:this.timeout};this.agent&&(p.agent=this.agent),a?p.agent=a:h&&(p.agent=h);const f=new AbortController;p.signal=f.signal;const m=setTimeout(()=>{f.abort()},this.timeout);try{const r=await u(t,p);return clearTimeout(m),this.handleRestResponse(r,t,e,i,s)}catch(i){if(i instanceof this.AbortError)throw new n.RequestTimeout(this.id+" "+e+" "+t+" request timed out ("+this.timeout+" ms)");if(i instanceof this.FetchError)throw new n.NetworkError(this.id+" "+e+" "+t+" fetch failed");throw i}}parseJson(t){try{if(this.isJsonEncodedObject(t))return JSON.parse(this.onJsonResponse(t))}catch(t){return}}getResponseHeaders(t){const e={};return t.headers.forEach((t,i)=>{i=i.split("-").map(t=>this.capitalize(t)).join("-"),e[i]=t}),e}handleRestResponse(t,e,i="GET",s=void 0,r=void 0){const a=this.getResponseHeaders(t);if(this.handleContentTypeApplicationZip&&"application/zip"===a["Content-Type"]){const s=t.buffer();return this.enableLastResponseHeaders&&(this.last_response_headers=a),this.enableLastHttpResponse&&(this.last_http_response=s),this.verbose&&this.log("handleRestResponse:\n",this.id,i,e,t.status,t.statusText,"\nResponseHeaders:\n",a,"ZIP redacted","\n"),s}return t.text().then(n=>{const o=this.onRestResponse(t.status,t.statusText,e,i,a,n,s,r),d=this.parseJson(o);this.enableLastResponseHeaders&&(this.last_response_headers=a),this.enableLastHttpResponse&&(this.last_http_response=n),this.enableLastJsonResponse&&(this.last_json_response=d),this.verbose&&this.log("handleRestResponse:\n",this.id,i,e,t.status,t.statusText,"\nResponseHeaders:\n",a,"\nResponseBody:\n",n,"\n");return this.handleErrors(t.status,t.statusText,e,i,a,n,d,s,r)||this.handleHttpStatusCode(t.status,t.statusText,e,i,n),d&&!Array.isArray(d)&&this.returnResponseHeaders&&(d.responseHeaders=a),d||n})}onRestResponse(t,e,i,s,r,a,n,o){return a.trim()}onJsonResponse(t){return this.quoteJsonNumbers?t.replace(/":([+.0-9eE-]+)([,}])/g,'":"$1"$2'):t}async loadMarketsHelper(t=!1,e={}){if(!t&&this.markets)return this.markets_by_id?this.markets:this.setMarkets(this.markets);let i;!0===this.has.fetchCurrencies&&(i=await this.fetchCurrencies(),this.options.cachedCurrencies=i);const s=await this.fetchMarkets(e);return"cachedCurrencies"in this.options&&delete this.options.cachedCurrencies,this.setMarkets(s,i)}async loadMarkets(t=!1,e={}){return(t&&!this.reloadingMarkets||!this.marketsLoading)&&(this.reloadingMarkets=!0,this.marketsLoading=this.loadMarketsHelper(t,e).then(t=>(this.reloadingMarkets=!1,t),t=>{throw this.reloadingMarkets=!1,t})),this.marketsLoading}async fetchCurrencies(t={}){return new Promise((t,e)=>{t(this.currencies)})}async fetchCurrenciesWs(t={}){return new Promise((t,e)=>{t(this.currencies)})}async fetchMarkets(t={}){return new Promise((t,e)=>{t(Object.values(this.markets))})}async fetchMarketsWs(t={}){return new Promise((t,e)=>{t(Object.values(this.markets))})}checkRequiredDependencies(){}parseNumber(t,e=void 0){if(void 0===t)return e;try{const i=this.numberToString(t);if(i.indexOf("e-")>-1)return this.number(vt(parseFloat(i)));const s=this.number(i);return Number.isNaN(s)?e:s}catch(t){return e}}checkOrderArguments(t,e,i,s,r,a){if(void 0===r&&"limit"===e)throw new n.ArgumentsRequired(this.id+" createOrder() requires a price argument for a limit order");if(s<=0)throw new n.ArgumentsRequired(this.id+" createOrder() amount should be above 0")}handleHttpStatusCode(t,e,i,s,r){const a=t.toString();if(a in this.httpExceptions){throw new(0,this.httpExceptions[a])(this.id+" "+s+" "+i+" "+a+" "+e+" "+r)}}remove0xPrefix(t){return"0x"===t.slice(0,2)?t.slice(2):t}mapToSafeMap(t){return t}safeMapToMap(t){return t}spawn(t,...e){const i=(0,c.K)();return setTimeout(()=>{t.apply(this,e).then(i.resolve).catch(i.reject)},0),i}delay(t,e,...i){setTimeout(()=>{this.spawn(e,...i)},t)}orderBook(t={},e=Number.MAX_SAFE_INTEGER){return new h.Mi(t,e)}indexedOrderBook(t={},e=Number.MAX_SAFE_INTEGER){return new h.nS(t,e)}countedOrderBook(t={},e=Number.MAX_SAFE_INTEGER){return new h.if(t,e)}handleMessage(t,e){}ping(t){}client(t){if(this.clients=this.clients||{},!this.clients[t]){const e=this.handleMessage.bind(this),i=this.onError.bind(this),s=this.onClose.bind(this),r=this.onConnected.bind(this),a=this.safeValue(this.options,"ws",{}),[n,o,c]=this.checkWsProxySettings(),h=this.setProxyAgents(n,o,c),l=this.getHttpAgentIfNeeded(t),u=h||(l||this.agent),p=this.deepExtend(this.streaming,{log:this.log?this.log.bind(this):this.log,ping:this.ping?this.ping.bind(this):this.ping,verbose:this.verbose,throttler:new G(this.tokenBucket),options:{agent:u},decompressBinary:this.safeBool(this.options,"decompressBinary",!0)},a);this.clients[t]=new d.A(t,e,i,s,r,p)}return this.clients[t]}watchMultiple(t,e,i=void 0,s=void 0,r=void 0){const a=this.client(t),n=c.K.race(e.map(t=>a.future(t))),o=[];if(void 0!==s)for(let t=0;t<s.length;t++){const e=s[t];a.subscriptions[e]||(o.push(e),a.subscriptions[e]=r||!0)}const d=a.connect(0);return(void 0===s||o.length)&&d.then(()=>{const t=this.safeValue(this.options,"ws"),e=this.safeValue(t,"cost",1);i&&(this.enableRateLimit&&a.throttle?a.throttle(e).then(()=>{a.send(i)}).catch(t=>{for(let t=0;t<o.length;t++){const e=o[t];delete a.subscriptions[e]}n.reject(t)}):a.send(i).catch(t=>{for(let t=0;t<o.length;t++){const e=o[t];delete a.subscriptions[e]}n.reject(t)}))}).catch(t=>{for(let t=0;t<o.length;t++){const e=o[t];delete a.subscriptions[e]}n.reject(t)}),n}watch(t,e,i=void 0,s=void 0,r=void 0){const a=this.client(t);if(void 0===s&&e in a.futures)return a.futures[e];const n=a.future(e),o=a.subscriptions[s];o||(a.subscriptions[s]=r||!0);const d=a.connect(0);return o||d.then(()=>{const t=this.safeValue(this.options,"ws"),e=this.safeValue(t,"cost",1);i&&(this.enableRateLimit&&a.throttle?a.throttle(e).then(()=>{a.send(i)}).catch(t=>{a.onError(t)}):a.send(i).catch(t=>{a.onError(t)}))}).catch(t=>{delete a.subscriptions[s],n.reject(t)}),n}onConnected(t,e=void 0){}onError(t,e){t.url in this.clients&&this.clients[t.url].error&&delete this.clients[t.url]}onClose(t,e){t.error||this.clients[t.url]&&delete this.clients[t.url]}async close(){await this.sleep(0);const t=Object.values(this.clients||{}),e=[];for(let i=0;i<t.length;i++){const s=t[i];s.error=new n.ExchangeClosedByUser(this.id+" closedByUser"),e.push(s.close())}for(let i=0;i<t.length;i++){const s=t[i];delete this.clients[s.url],e.push(s.close())}return Promise.all(e)}async loadOrderBook(t,e,i,s=void 0,r={}){if(!(i in this.orderbooks))return void t.reject(new n.ExchangeError(this.id+" loadOrderBook() orderbook is not initiated"),e);const a=this.handleOption("watchOrderBook","snapshotMaxRetries",3);let o=0;try{const d=this.orderbooks[i];for(;o<a;){const a=d.cache,n=await this.fetchRestOrderBookSafe(i,s,r),c=this.getCacheIndex(n,a);if(c>=0)return d.reset(n),this.handleDeltas(d,a.slice(c)),d.cache.length=0,void t.resolve(d,e);o++}t.reject(new n.ExchangeError(this.id+" nonce is behind the cache after "+a.toString()+" tries."),e),delete this.clients[t.url],this.orderbooks[i]=this.orderBook()}catch(a){t.reject(a,e),await this.loadOrderBook(t,e,i,s,r)}}convertToBigInt(t){return BigInt(t)}stringToCharsArray(t){return t.split("")}valueIsDefined(t){return null!=t}arraySlice(t,e,i=void 0){return void 0===i?t.slice(e):t.slice(e,i)}getProperty(t,e,i=void 0){return e in t?t[e]:i}setProperty(t,e,i=void 0){t[e]=i}axolotl(t,e,i){return(0,l.Sw)(t,e,i)}fixStringifiedJsonMembers(t){let e=t.replaceAll("\\","");return e=e.replaceAll('"{',"{"),e=e.replaceAll('}"',"}"),e}ethAbiEncode(t,e){return this.base16ToBinary(p.Ay.encode(t,e).slice(2))}ethEncodeStructuredData(t,e,i){return this.base16ToBinary(f.z.encode(t,e,i).slice(-132))}retrieveStarkAccount(t,e,i){const s=(0,g.b)(t),r=(0,g.$u)(s),a=w.fP.compile({implementation:e,selector:v.BK("initialize"),calldata:w.fP.compile({signer:r,guardian:"0"})});return{privateKey:s,publicKey:r,address:b.r4(r,i,a,0)}}starknetEncodeStructuredData(t,e,i,s){const r=Object.keys(e);if(r.length>1)throw new n.NotSupported(this.id+" starknetEncodeStructuredData only support single type");const a={domain:t,primaryType:r[0],types:this.extend({StarkNetDomain:[{name:"name",type:"felt"},{name:"chainId",type:"felt"},{name:"version",type:"felt"}]},e),message:i};return S.E(a,s)}starknetSign(t,e){const i=(0,g._S)(t.replace("0x",""),e.replace("0x",""));return this.json([i.r.toString(),i.s.toString()])}async getZKContractSignatureObj(t,e={}){const i=BigInt("0x"+this.remove0xPrefix(this.hash(this.encode(this.safeString(e,"slotId")),k.s,"hex"))).toString(),s=BigInt("0x"+this.remove0xPrefix(this.hash(this.encode(this.safeString(e,"nonce")),k.s,"hex"))).toString(),r="4294967295",a=parseInt(o.Y.stringMod(this.safeString(e,"accountId"),r),10),n=parseInt(o.Y.stringDiv(o.Y.stringMod(i,"18446744073709551615"),r),10),d=parseInt(o.Y.stringMod(s,r),10);await(0,y.Ay)();const c=y.$s({});await c.initZklinkSigner(t);const h=new y.KR(a,0,n,d,this.safeInteger(e,"pairId"),o.Y.stringMul(this.safeString(e,"size"),"1e18"),o.Y.stringMul(this.safeString(e,"price"),"1e18"),"BUY"===this.safeString(e,"direction"),parseInt(o.Y.stringMul(this.safeString(e,"makerFeeRate"),"10000")),parseInt(o.Y.stringMul(this.safeString(e,"takerFeeRate"),"10000")),!1),l=y.JF(h);l?.sign(c?.getZkLinkSigner());const u=l.jsValue(),p=u?.signature?.signature;return p}async getZKTransferSignatureObj(t,e={}){await(0,y.Ay)();const i=y.$s({});await i.initZklinkSigner(t);let s=this.safeString(e,"nonce","0");if(!0===this.safeBool(e,"isContract")){const t="4294967295",e=BigInt("0x"+this.remove0xPrefix(this.hash(this.encode(s),k.s,"hex"))).toString();s=o.Y.stringMod(e,t)}const r=new y.H3(this.safeNumber(e,"zkAccountId",0),this.safeString(e,"receiverAddress"),this.safeNumber(e,"subAccountId",0),this.safeNumber(e,"receiverSubAccountId",0),this.safeNumber(e,"tokenId",0),this.safeString(e,"fee","0"),this.safeString(e,"amount","0"),this.parseToInt(s),this.safeNumber(e,"timestampSeconds",0)),a=y.qj(r);a?.sign(i?.getZkLinkSigner());const n=a.jsValue(),d=n?.signature?.signature;return d}async loadDydxProtos(){const t=[Promise.resolve().then(i.bind(i,1173)),Promise.resolve().then(i.bind(i,7171)),Promise.resolve().then(i.bind(i,5928))],e=await Promise.all(t);_e=e[0].encodeAsAny,Ae=e[1].AuthInfo,Ie=e[1].Tx,xe=e[1].TxBody,Ee=e[1].TxRaw,Me=e[1].SignDoc,Ce=e[2].SignMode}toDydxLong(t){return _().fromString(t)}retrieveDydxCredentials(t){let e;return t.indexOf(" ")>0?(e=(0,T.t)(t),e.mnemonic=t,e):(e=(0,T.e)(this.base16ToBinary(t)),e)}encodeDydxTxForSimulation(t,e,i,s){if(!_e)throw new n.NotSupported(this.id+" requires protobuf to encode messages, please install it with `npm install protobufjs`");if(!s)throw new Error("Public key cannot be undefined");const r=[t].map(t=>_e(t)),a=Ie.fromPartial({body:xe.fromPartial({messages:r,memo:e}),authInfo:Ae.fromPartial({fee:{},signerInfos:[{publicKey:_e({typeUrl:"/cosmos.crypto.secp256k1.PubKey",value:s}),sequence:i,modeInfo:{single:{mode:Ce.SIGN_MODE_UNSPECIFIED}}}]}),signatures:[new Uint8Array]});return this.binaryToBase64(Ie.encode(a).finish())}encodeDydxTxForSigning(t,e,i,s,r,a=void 0){if(!_e)throw new n.NotSupported(this.id+" requires protobuf to encode messages, please install it with `npm install protobufjs`");if(!s.pub_key)throw new Error("Public key cannot be undefined");const o=[t],d=this.milliseconds();void 0===a&&(a={amount:[],gasLimit:1e6});const c=o.map(t=>_e(t)),h=[_e({typeUrl:"/dydxprotocol.accountplus.TxExtension",value:{selectedAuthenticators:r??[]}})],l=xe.encode(xe.fromPartial({messages:c,memo:e,extensionOptions:[],nonCriticalExtensionOptions:h})).finish(),u=Ae.encode(Ae.fromPartial({fee:a,signerInfos:[{publicKey:_e({typeUrl:"/cosmos.crypto.secp256k1.PubKey",value:s.pub_key}),sequence:d,modeInfo:{single:{mode:Ce.SIGN_MODE_DIRECT}}}]})).finish(),p=Me.fromPartial({accountNumber:s.account_number,authInfoBytes:u,bodyBytes:l,chainId:i});return[this.hash(Me.encode(p).finish(),k.s,"hex"),p]}encodeDydxTxRaw(t,e){if(!_e)throw new n.NotSupported(this.id+" requires protobuf to encode messages, please install it with `npm install protobufjs`");return"0x"+this.binaryToBase16(Ee.encode(Ee.fromPartial({bodyBytes:t.bodyBytes,authInfoBytes:t.authInfoBytes,signatures:[this.base16ToBinary(e)]})).finish())}intToBase16(t){return t.toString(16)}extendExchangeOptions(t){this.options=this.extend(this.options,t)}createSafeDictionary(){return{}}convertToSafeDictionary(t){return t}randomBytes(t){const e=new m.D,i=[];return i.length=t,e.nextBytes(i),Buffer.from(i).toString("hex")}randNumber(t){let e="";for(let i=0;i<t;i++)e+=Math.floor(10*Math.random());return parseInt(e,10)}binaryLength(t){return t.length}lockId(){}unlockId(){}describe(){return{id:void 0,name:void 0,countries:void 0,enableRateLimit:!0,rateLimit:2e3,timeout:this.timeout,certified:!1,pro:!1,alias:!1,dex:!1,has:{publicAPI:!0,privateAPI:!0,CORS:void 0,sandbox:void 0,spot:void 0,margin:void 0,swap:void 0,future:void 0,option:void 0,addMargin:void 0,borrowCrossMargin:void 0,borrowIsolatedMargin:void 0,borrowMargin:void 0,cancelAllOrders:void 0,cancelAllOrdersWs:void 0,cancelOrder:!0,cancelOrderWithClientOrderId:void 0,cancelOrderWs:void 0,cancelOrders:void 0,cancelOrdersWithClientOrderId:void 0,cancelOrdersWs:void 0,closeAllPositions:void 0,closePosition:void 0,createDepositAddress:void 0,createLimitBuyOrder:void 0,createLimitBuyOrderWs:void 0,createLimitOrder:!0,createLimitOrderWs:void 0,createLimitSellOrder:void 0,createLimitSellOrderWs:void 0,createMarketBuyOrder:void 0,createMarketBuyOrderWs:void 0,createMarketBuyOrderWithCost:void 0,createMarketBuyOrderWithCostWs:void 0,createMarketOrder:!0,createMarketOrderWs:!0,createMarketOrderWithCost:void 0,createMarketOrderWithCostWs:void 0,createMarketSellOrder:void 0,createMarketSellOrderWs:void 0,createMarketSellOrderWithCost:void 0,createMarketSellOrderWithCostWs:void 0,createOrder:!0,createOrderWs:void 0,createOrders:void 0,createOrderWithTakeProfitAndStopLoss:void 0,createOrderWithTakeProfitAndStopLossWs:void 0,createPostOnlyOrder:void 0,createPostOnlyOrderWs:void 0,createReduceOnlyOrder:void 0,createReduceOnlyOrderWs:void 0,createStopLimitOrder:void 0,createStopLimitOrderWs:void 0,createStopLossOrder:void 0,createStopLossOrderWs:void 0,createStopMarketOrder:void 0,createStopMarketOrderWs:void 0,createStopOrder:void 0,createStopOrderWs:void 0,createTakeProfitOrder:void 0,createTakeProfitOrderWs:void 0,createTrailingAmountOrder:void 0,createTrailingAmountOrderWs:void 0,createTrailingPercentOrder:void 0,createTrailingPercentOrderWs:void 0,createTriggerOrder:void 0,createTriggerOrderWs:void 0,deposit:void 0,editOrder:"emulated",editOrderWithClientOrderId:void 0,editOrders:void 0,editOrderWs:void 0,fetchAccounts:void 0,fetchBalance:!0,fetchBalanceWs:void 0,fetchBidsAsks:void 0,fetchBorrowInterest:void 0,fetchBorrowRate:void 0,fetchBorrowRateHistories:void 0,fetchBorrowRateHistory:void 0,fetchBorrowRates:void 0,fetchBorrowRatesPerSymbol:void 0,fetchCanceledAndClosedOrders:void 0,fetchCanceledOrders:void 0,fetchClosedOrder:void 0,fetchClosedOrders:void 0,fetchClosedOrdersWs:void 0,fetchConvertCurrencies:void 0,fetchConvertQuote:void 0,fetchConvertTrade:void 0,fetchConvertTradeHistory:void 0,fetchCrossBorrowRate:void 0,fetchCrossBorrowRates:void 0,fetchCurrencies:"emulated",fetchCurrenciesWs:"emulated",fetchDeposit:void 0,fetchDepositAddress:void 0,fetchDepositAddresses:void 0,fetchDepositAddressesByNetwork:void 0,fetchDeposits:void 0,fetchDepositsWithdrawals:void 0,fetchDepositsWs:void 0,fetchDepositWithdrawFee:void 0,fetchDepositWithdrawFees:void 0,fetchFundingHistory:void 0,fetchFundingRate:void 0,fetchFundingRateHistory:void 0,fetchFundingInterval:void 0,fetchFundingIntervals:void 0,fetchFundingRates:void 0,fetchGreeks:void 0,fetchIndexOHLCV:void 0,fetchIsolatedBorrowRate:void 0,fetchIsolatedBorrowRates:void 0,fetchMarginAdjustmentHistory:void 0,fetchIsolatedPositions:void 0,fetchL2OrderBook:!0,fetchL3OrderBook:void 0,fetchLastPrices:void 0,fetchLedger:void 0,fetchLedgerEntry:void 0,fetchLeverage:void 0,fetchLeverages:void 0,fetchLeverageTiers:void 0,fetchLiquidations:void 0,fetchLongShortRatio:void 0,fetchLongShortRatioHistory:void 0,fetchMarginMode:void 0,fetchMarginModes:void 0,fetchMarketLeverageTiers:void 0,fetchMarkets:!0,fetchMarketsWs:void 0,fetchMarkOHLCV:void 0,fetchMyLiquidations:void 0,fetchMySettlementHistory:void 0,fetchMyTrades:void 0,fetchMyTradesWs:void 0,fetchOHLCV:void 0,fetchOHLCVWs:void 0,fetchOpenInterest:void 0,fetchOpenInterests:void 0,fetchOpenInterestHistory:void 0,fetchOpenOrder:void 0,fetchOpenOrders:void 0,fetchOpenOrdersWs:void 0,fetchOption:void 0,fetchOptionChain:void 0,fetchOrder:void 0,fetchOrderWithClientOrderId:void 0,fetchOrderBook:!0,fetchOrderBooks:void 0,fetchOrderBookWs:void 0,fetchOrders:void 0,fetchOrdersByStatus:void 0,fetchOrdersWs:void 0,fetchOrderTrades:void 0,fetchOrderWs:void 0,fetchPosition:void 0,fetchPositionHistory:void 0,fetchPositionsHistory:void 0,fetchPositionWs:void 0,fetchPositionMode:void 0,fetchPositions:void 0,fetchPositionsWs:void 0,fetchPositionsForSymbol:void 0,fetchPositionsForSymbolWs:void 0,fetchPositionsRisk:void 0,fetchPremiumIndexOHLCV:void 0,fetchSettlementHistory:void 0,fetchStatus:void 0,fetchTicker:!0,fetchTickerWs:void 0,fetchTickers:void 0,fetchMarkPrices:void 0,fetchTickersWs:void 0,fetchTime:void 0,fetchTrades:!0,fetchTradesWs:void 0,fetchTradingFee:void 0,fetchTradingFees:void 0,fetchTradingFeesWs:void 0,fetchTradingLimits:void 0,fetchTransactionFee:void 0,fetchTransactionFees:void 0,fetchTransactions:void 0,fetchTransfer:void 0,fetchTransfers:void 0,fetchUnderlyingAssets:void 0,fetchVolatilityHistory:void 0,fetchWithdrawAddresses:void 0,fetchWithdrawal:void 0,fetchWithdrawals:void 0,fetchWithdrawalsWs:void 0,fetchWithdrawalWhitelist:void 0,reduceMargin:void 0,repayCrossMargin:void 0,repayIsolatedMargin:void 0,setLeverage:void 0,setMargin:void 0,setMarginMode:void 0,setPositionMode:void 0,signIn:void 0,transfer:void 0,watchBalance:void 0,watchMyTrades:void 0,watchOHLCV:void 0,watchOHLCVForSymbols:void 0,watchOrderBook:void 0,watchBidsAsks:void 0,watchOrderBookForSymbols:void 0,watchOrders:void 0,watchOrdersForSymbols:void 0,watchPosition:void 0,watchPositions:void 0,watchStatus:void 0,watchTicker:void 0,watchTickers:void 0,watchTrades:void 0,watchTradesForSymbols:void 0,watchLiquidations:void 0,watchLiquidationsForSymbols:void 0,watchMyLiquidations:void 0,unWatchOrders:void 0,unWatchTrades:void 0,unWatchTradesForSymbols:void 0,unWatchOHLCVForSymbols:void 0,unWatchOrderBookForSymbols:void 0,unWatchPositions:void 0,unWatchOrderBook:void 0,unWatchTickers:void 0,unWatchMyTrades:void 0,unWatchTicker:void 0,unWatchOHLCV:void 0,watchMyLiquidationsForSymbols:void 0,withdraw:void 0,ws:void 0},urls:{logo:void 0,api:void 0,www:void 0,doc:void 0,fees:void 0},api:void 0,requiredCredentials:{apiKey:!0,secret:!0,uid:!1,accountId:!1,login:!1,password:!1,twofa:!1,privateKey:!1,walletAddress:!1,token:!1},markets:void 0,currencies:{},timeframes:void 0,fees:{trading:{tierBased:void 0,percentage:void 0,taker:void 0,maker:void 0},funding:{tierBased:void 0,percentage:void 0,withdraw:{},deposit:{}}},status:{status:"ok",updated:void 0,eta:void 0,url:void 0},exceptions:void 0,httpExceptions:{422:n.ExchangeError,418:n.DDoSProtection,429:n.RateLimitExceeded,404:n.ExchangeNotAvailable,409:n.ExchangeNotAvailable,410:n.ExchangeNotAvailable,451:n.ExchangeNotAvailable,500:n.ExchangeNotAvailable,501:n.ExchangeNotAvailable,502:n.ExchangeNotAvailable,520:n.ExchangeNotAvailable,521:n.ExchangeNotAvailable,522:n.ExchangeNotAvailable,525:n.ExchangeNotAvailable,526:n.ExchangeNotAvailable,400:n.ExchangeNotAvailable,403:n.ExchangeNotAvailable,405:n.ExchangeNotAvailable,503:n.ExchangeNotAvailable,530:n.ExchangeNotAvailable,408:n.RequestTimeout,504:n.RequestTimeout,401:n.AuthenticationError,407:n.AuthenticationError,511:n.AuthenticationError},commonCurrencies:{XBT:"BTC",BCHSV:"BSV"},precisionMode:ke,paddingMode:Se,limits:{leverage:{min:void 0,max:void 0},amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},rollingWindowSize:6e4}}safeBoolN(t,e,i=void 0){const s=this.safeValueN(t,e,i);return"boolean"==typeof s?s:i}safeBool2(t,e,i,s=void 0){return this.safeBoolN(t,[e,i],s)}safeBool(t,e,i=void 0){return this.safeBoolN(t,[e],i)}safeDictN(t,e,i=void 0){const s=this.safeValueN(t,e,i);return void 0===s||"object"!=typeof s||Array.isArray(s)?i:s}safeDict(t,e,i=void 0){return this.safeDictN(t,[e],i)}safeDict2(t,e,i,s=void 0){return this.safeDictN(t,[e,i],s)}safeListN(t,e,i=void 0){const s=this.safeValueN(t,e,i);return void 0===s?i:Array.isArray(s)?s:i}safeList2(t,e,i,s=void 0){return this.safeListN(t,[e,i],s)}safeList(t,e,i=void 0){return this.safeListN(t,[e],i)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}handleDelta(t,e){throw new n.NotSupported(this.id+" handleDelta not supported yet")}handleDeltasWithKeys(t,e,i=0,s=1,r=2){for(let a=0;a<e.length;a++){const n=this.parseBidAsk(e[a],i,s,r);t.storeArray(n)}}getCacheIndex(t,e){return-1}arraysConcat(t){let e=[];for(let i=0;i<t.length;i++)e=this.arrayConcat(e,t[i]);return e}findTimeframe(t,e=void 0){void 0===e&&(e=this.timeframes);const i=Object.keys(e);for(let s=0;s<i.length;s++){const r=i[s];if(e[r]===t)return r}}checkProxyUrlSettings(t=void 0,e=void 0,i=void 0,s=void 0){const r=[];let a;void 0!==this.proxyUrl&&(r.push("proxyUrl"),a=this.proxyUrl),void 0!==this.proxy_url&&(r.push("proxy_url"),a=this.proxy_url),void 0!==this.proxyUrlCallback&&(r.push("proxyUrlCallback"),a=this.proxyUrlCallback(t,e,i,s)),void 0!==this.proxy_url_callback&&(r.push("proxy_url_callback"),a=this.proxy_url_callback(t,e,i,s)),void 0!==this.proxy&&(r.push("proxy"),a="function"==typeof this.proxy?this.proxy(t,e,i,s):this.proxy);if(r.length>1){const t=r.join(",");throw new n.InvalidProxySettings(this.id+" you have multiple conflicting proxy settings ("+t+"), please use only one from : proxyUrl, proxy_url, proxyUrlCallback, proxy_url_callback")}return a}urlEncoderForProxyUrl(t){return t.indexOf("?")>=0?this.encodeURIComponent(t):t}checkProxySettings(t=void 0,e=void 0,i=void 0,s=void 0){const r=[];let a,o,d;const c=this.valueIsDefined(this.httpProxy),h=this.valueIsDefined(this.http_proxy);(c||h)&&(r.push("httpProxy"),a=c?this.httpProxy:this.http_proxy);const l=this.valueIsDefined(this.httpProxyCallback),u=this.valueIsDefined(this.http_proxy_callback);(l||u)&&(r.push("httpProxyCallback"),a=l?this.httpProxyCallback(t,e,i,s):this.http_proxy_callback(t,e,i,s));const p=this.valueIsDefined(this.httpsProxy),f=this.valueIsDefined(this.https_proxy);(p||f)&&(r.push("httpsProxy"),o=p?this.httpsProxy:this.https_proxy);const m=this.valueIsDefined(this.httpsProxyCallback),g=this.valueIsDefined(this.https_proxy_callback);(m||g)&&(r.push("httpsProxyCallback"),o=m?this.httpsProxyCallback(t,e,i,s):this.https_proxy_callback(t,e,i,s));const y=this.valueIsDefined(this.socksProxy),v=this.valueIsDefined(this.socks_proxy);(y||v)&&(r.push("socksProxy"),d=y?this.socksProxy:this.socks_proxy);const b=this.valueIsDefined(this.socksProxyCallback),w=this.valueIsDefined(this.socks_proxy_callback);(b||w)&&(r.push("socksProxyCallback"),d=b?this.socksProxyCallback(t,e,i,s):this.socks_proxy_callback(t,e,i,s));if(r.length>1){const t=r.join(",");throw new n.InvalidProxySettings(this.id+" you have multiple conflicting proxy settings ("+t+"), please use only one from: httpProxy, httpsProxy, httpProxyCallback, httpsProxyCallback, socksProxy, socksProxyCallback")}return[a,o,d]}checkWsProxySettings(){const t=[];let e,i,s;const r=this.valueIsDefined(this.wsProxy),a=this.valueIsDefined(this.ws_proxy);(r||a)&&(t.push("wsProxy"),e=r?this.wsProxy:this.ws_proxy);const o=this.valueIsDefined(this.wssProxy),d=this.valueIsDefined(this.wss_proxy);(o||d)&&(t.push("wssProxy"),i=o?this.wssProxy:this.wss_proxy);const c=this.valueIsDefined(this.wsSocksProxy),h=this.valueIsDefined(this.ws_socks_proxy);(c||h)&&(t.push("wsSocksProxy"),s=c?this.wsSocksProxy:this.ws_socks_proxy);if(t.length>1){const e=t.join(",");throw new n.InvalidProxySettings(this.id+" you have multiple conflicting proxy settings ("+e+"), please use only one from: wsProxy, wssProxy, wsSocksProxy")}return[e,i,s]}checkConflictingProxies(t,e){if(t&&e)throw new n.InvalidProxySettings(this.id+" you have multiple conflicting proxy settings, please use only one from : proxyUrl, httpProxy, httpsProxy, socksProxy")}checkAddress(t=void 0){if(void 0===t)throw new n.InvalidAddress(this.id+" address is undefined");if(1===this.unique(this.stringToCharsArray(t)).length||t.length<this.minFundingAddressLength||t.indexOf(" ")>-1)throw new n.InvalidAddress(this.id+" address is invalid or has less than "+this.minFundingAddressLength.toString()+' characters: "'+t.toString()+'"');return t}findMessageHashes(t,e){const i=[],s=Object.keys(t.futures);for(let t=0;t<s.length;t++){const r=s[t];r.indexOf(e)>=0&&i.push(r)}return i}filterByLimit(t,e=void 0,i="timestamp",s=!1){if(this.valueIsDefined(e)){const r=t.length;if(r>0){let a=!0;if(i in t[0]){const e=t[0][i],s=t[r-1][i];void 0!==e&&void 0!==s&&(a=e<=s)}s?(e>r&&(e=r),t=a?this.arraySlice(t,0,e):this.arraySlice(t,-e)):t=a?this.arraySlice(t,-e):this.arraySlice(t,0,e)}}return t}filterBySinceLimit(t,e=void 0,i=void 0,s="timestamp",r=!1){const a=this.valueIsDefined(e),n=this.toArray(t);let o=n;if(a){o=[];for(let t=0;t<n.length;t++){const i=n[t],r=this.safeValue(i,s);r&&r>=e&&o.push(i)}}if(r&&void 0!==i)return this.arraySlice(o,-i);const d=!r&&a;return this.filterByLimit(o,i,s,d)}filterByValueSinceLimit(t,e,i=void 0,s=void 0,r=void 0,a="timestamp",n=!1){const o=this.valueIsDefined(i),d=this.valueIsDefined(s),c=this.toArray(t);let h=c;if(o||d){h=[];for(let t=0;t<c.length;t++){const r=c[t],n=r[e]===i,l=!o||n,u=this.safeValue(r,a);l&&(!d||u&&void 0!==s&&u>=s)&&h.push(r)}}return n&&void 0!==r?this.arraySlice(h,-r):this.filterByLimit(h,r,a,d)}setSandboxMode(t){if(t){if(!("test"in this.urls))throw new n.NotSupported(this.id+" does not have a sandbox URL");"string"==typeof this.urls.api?(this.urls.apiBackup=this.urls.api,this.urls.api=this.urls.test):(this.urls.apiBackup=this.clone(this.urls.api),this.urls.api=this.clone(this.urls.test)),this.isSandboxModeEnabled=!0}else if("apiBackup"in this.urls){"string"==typeof this.urls.api?this.urls.api=this.urls.apiBackup:this.urls.api=this.clone(this.urls.apiBackup);const t=this.omit(this.urls,"apiBackup");this.urls=t,this.isSandboxModeEnabled=!1}}enableDemoTrading(t){if(this.isSandboxModeEnabled)throw new n.NotSupported(this.id+" demo trading does not support in sandbox environment. Please check https://www.binance.com/en/support/faq/detail/9be58f73e5e14338809e3b705b9687dd to see the differences");if(t)this.urls.apiBackupDemoTrading=this.urls.api,this.urls.api=this.urls.demo;else if("apiBackupDemoTrading"in this.urls){this.urls.api=this.urls.apiBackupDemoTrading;const t=this.omit(this.urls,"apiBackupDemoTrading");this.urls=t}this.options.enableDemoTrading=t}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){return{}}async fetchAccounts(t={}){throw new n.NotSupported(this.id+" fetchAccounts() is not supported yet")}async fetchTrades(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchTrades() is not supported yet")}async fetchTradesWs(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchTradesWs() is not supported yet")}async watchLiquidations(t,e=void 0,i=void 0,s={}){if(this.has.watchLiquidationsForSymbols)return await this.watchLiquidationsForSymbols([t],e,i,s);throw new n.NotSupported(this.id+" watchLiquidations() is not supported yet")}async watchLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchLiquidationsForSymbols() is not supported yet")}async watchMyLiquidations(t,e=void 0,i=void 0,s={}){if(this.has.watchMyLiquidationsForSymbols)return this.watchMyLiquidationsForSymbols([t],e,i,s);throw new n.NotSupported(this.id+" watchMyLiquidations() is not supported yet")}async watchMyLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchMyLiquidationsForSymbols() is not supported yet")}async watchTrades(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchTrades() is not supported yet")}async unWatchOrders(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchOrders() is not supported yet")}async unWatchTrades(t,e={}){throw new n.NotSupported(this.id+" unWatchTrades() is not supported yet")}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchTradesForSymbols() is not supported yet")}async unWatchTradesForSymbols(t,e={}){throw new n.NotSupported(this.id+" unWatchTradesForSymbols() is not supported yet")}async watchMyTradesForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchMyTradesForSymbols() is not supported yet")}async watchOrdersForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchOrdersForSymbols() is not supported yet")}async watchOHLCVForSymbols(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchOHLCVForSymbols() is not supported yet")}async unWatchOHLCVForSymbols(t,e={}){throw new n.NotSupported(this.id+" unWatchOHLCVForSymbols() is not supported yet")}async watchOrderBookForSymbols(t,e=void 0,i={}){throw new n.NotSupported(this.id+" watchOrderBookForSymbols() is not supported yet")}async unWatchOrderBookForSymbols(t,e={}){throw new n.NotSupported(this.id+" unWatchOrderBookForSymbols() is not supported yet")}async unWatchPositions(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchPositions() is not supported yet")}async unWatchTicker(t,e={}){throw new n.NotSupported(this.id+" unWatchTicker() is not supported yet")}async unWatchMarkPrice(t,e={}){throw new n.NotSupported(this.id+" unWatchMarkPrice() is not supported yet")}async unWatchMarkPrices(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchMarkPrices() is not supported yet")}async fetchDepositAddresses(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchDepositAddresses() is not supported yet")}async fetchOrderBook(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchOrderBook() is not supported yet")}async fetchOrderBookWs(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchOrderBookWs() is not supported yet")}async fetchMarginMode(t,e={}){if(this.has.fetchMarginModes){const i=await this.fetchMarginModes([t],e);return this.safeDict(i,t)}throw new n.NotSupported(this.id+" fetchMarginMode() is not supported yet")}async fetchMarginModes(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchMarginModes () is not supported yet")}async fetchRestOrderBookSafe(t,e=void 0,i={}){const s=this.handleOption("watchOrderBook","maxRetries",3);for(let r=0;r<s;r++)try{return await this.fetchOrderBook(t,e,i)}catch(t){if(r+1===s)throw t}}async watchOrderBook(t,e=void 0,i={}){throw new n.NotSupported(this.id+" watchOrderBook() is not supported yet")}async unWatchOrderBook(t,e={}){throw new n.NotSupported(this.id+" unWatchOrderBook() is not supported yet")}async fetchTime(t={}){throw new n.NotSupported(this.id+" fetchTime() is not supported yet")}async fetchTradingLimits(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchTradingLimits() is not supported yet")}parseCurrency(t){throw new n.NotSupported(this.id+" parseCurrency() is not supported yet")}parseCurrencies(t){const e={},i=this.toArray(t);for(let t=0;t<i.length;t++){const s=this.parseCurrency(i[t]);e[s.code]=s}return e}parseMarket(t){throw new n.NotSupported(this.id+" parseMarket() is not supported yet")}parseMarkets(t){const e=[];for(let i=0;i<t.length;i++)e.push(this.parseMarket(t[i]));return e}parseTicker(t,e=void 0){throw new n.NotSupported(this.id+" parseTicker() is not supported yet")}parseDepositAddress(t,e=void 0){throw new n.NotSupported(this.id+" parseDepositAddress() is not supported yet")}parseTrade(t,e=void 0){throw new n.NotSupported(this.id+" parseTrade() is not supported yet")}parseTransaction(t,e=void 0){throw new n.NotSupported(this.id+" parseTransaction() is not supported yet")}parseTransfer(t,e=void 0){throw new n.NotSupported(this.id+" parseTransfer() is not supported yet")}parseAccount(t){throw new n.NotSupported(this.id+" parseAccount() is not supported yet")}parseLedgerEntry(t,e=void 0){throw new n.NotSupported(this.id+" parseLedgerEntry() is not supported yet")}parseOrder(t,e=void 0){throw new n.NotSupported(this.id+" parseOrder() is not supported yet")}async fetchCrossBorrowRates(t={}){throw new n.NotSupported(this.id+" fetchCrossBorrowRates() is not supported yet")}async fetchIsolatedBorrowRates(t={}){throw new n.NotSupported(this.id+" fetchIsolatedBorrowRates() is not supported yet")}parseMarketLeverageTiers(t,e=void 0){throw new n.NotSupported(this.id+" parseMarketLeverageTiers() is not supported yet")}async fetchLeverageTiers(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchLeverageTiers() is not supported yet")}parsePosition(t,e=void 0){throw new n.NotSupported(this.id+" parsePosition() is not supported yet")}parseFundingRateHistory(t,e=void 0){throw new n.NotSupported(this.id+" parseFundingRateHistory() is not supported yet")}parseBorrowInterest(t,e=void 0){throw new n.NotSupported(this.id+" parseBorrowInterest() is not supported yet")}parseIsolatedBorrowRate(t,e=void 0){throw new n.NotSupported(this.id+" parseIsolatedBorrowRate() is not supported yet")}parseWsTrade(t,e=void 0){throw new n.NotSupported(this.id+" parseWsTrade() is not supported yet")}parseWsOrder(t,e=void 0){throw new n.NotSupported(this.id+" parseWsOrder() is not supported yet")}parseWsOrderTrade(t,e=void 0){throw new n.NotSupported(this.id+" parseWsOrderTrade() is not supported yet")}parseWsOHLCV(t,e=void 0){return this.parseOHLCV(t,e)}async fetchFundingRates(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchFundingRates() is not supported yet")}async fetchFundingIntervals(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchFundingIntervals() is not supported yet")}async watchFundingRate(t,e={}){throw new n.NotSupported(this.id+" watchFundingRate() is not supported yet")}async watchFundingRates(t,e={}){throw new n.NotSupported(this.id+" watchFundingRates() is not supported yet")}async watchFundingRatesForSymbols(t,e={}){return await this.watchFundingRates(t,e)}async transfer(t,e,i,s,r={}){throw new n.NotSupported(this.id+" transfer() is not supported yet")}async withdraw(t,e,i,s=void 0,r={}){throw new n.NotSupported(this.id+" withdraw() is not supported yet")}async createDepositAddress(t,e={}){throw new n.NotSupported(this.id+" createDepositAddress() is not supported yet")}async setLeverage(t,e=void 0,i={}){throw new n.NotSupported(this.id+" setLeverage() is not supported yet")}async fetchLeverage(t,e={}){if(this.has.fetchLeverages){const i=await this.fetchLeverages([t],e);return this.safeDict(i,t)}throw new n.NotSupported(this.id+" fetchLeverage() is not supported yet")}async fetchLeverages(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchLeverages() is not supported yet")}async setPositionMode(t,e=void 0,i={}){throw new n.NotSupported(this.id+" setPositionMode() is not supported yet")}async addMargin(t,e,i={}){throw new n.NotSupported(this.id+" addMargin() is not supported yet")}async reduceMargin(t,e,i={}){throw new n.NotSupported(this.id+" reduceMargin() is not supported yet")}async setMargin(t,e,i={}){throw new n.NotSupported(this.id+" setMargin() is not supported yet")}async fetchLongShortRatio(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchLongShortRatio() is not supported yet")}async fetchLongShortRatioHistory(t=void 0,e=void 0,i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchLongShortRatioHistory() is not supported yet")}async fetchMarginAdjustmentHistory(t=void 0,e=void 0,i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchMarginAdjustmentHistory() is not supported yet")}async setMarginMode(t,e=void 0,i={}){throw new n.NotSupported(this.id+" setMarginMode() is not supported yet")}async fetchDepositAddressesByNetwork(t,e={}){throw new n.NotSupported(this.id+" fetchDepositAddressesByNetwork() is not supported yet")}async fetchOpenInterestHistory(t,e="1h",i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchOpenInterestHistory() is not supported yet")}async fetchOpenInterest(t,e={}){throw new n.NotSupported(this.id+" fetchOpenInterest() is not supported yet")}async fetchOpenInterests(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchOpenInterests() is not supported yet")}async signIn(t={}){throw new n.NotSupported(this.id+" signIn() is not supported yet")}async fetchPaymentMethods(t={}){throw new n.NotSupported(this.id+" fetchPaymentMethods() is not supported yet")}parseToInt(t){const e=this.numberToString(t),i=parseFloat(e);return parseInt(i)}parseToNumeric(t){const e=this.numberToString(t);return e.indexOf(".")>=0?parseFloat(e):parseInt(e)}isRoundNumber(t){return 0===this.parseToNumeric(t%1)}safeNumberOmitZero(t,e,i=void 0){const s=this.safeString(t,e),r=this.parseNumber(this.omitZero(s));return void 0===r?i:r}safeIntegerOmitZero(t,e,i=void 0){const s=this.safeInteger(t,e,i);if(void 0!==s&&0!==s)return s}afterConstruct(){this.createNetworksByIdObject(),this.featuresGenerator(),this.markets&&this.setMarkets(this.markets),this.initRestRateLimiter();const t=this.safeBool2(this.options,"sandbox","testnet",!1);t&&this.setSandboxMode(t)}initRestRateLimiter(){if(void 0===this.rateLimit||void 0!==this.id&&-1===this.rateLimit)throw new n.ExchangeError(this.id+".rateLimit property is not configured");let t=this.MAX_VALUE;this.rateLimit>0&&(t=1/this.rateLimit);const e={delay:.001,capacity:1,cost:1,refillRate:t,algorithm:0===this.rollingWindowSize||"leakyBucket"===this.rateLimiterAlgorithm?"leakyBucket":"rollingWindow",windowSize:this.rollingWindowSize,rateLimit:this.rateLimit},i=void 0===this.tokenBucket?{}:this.tokenBucket;this.tokenBucket=this.extend(e,i),this.initThrottler()}featuresGenerator(){if(void 0===this.features)return;const t=this.features;this.features={};const e=["spot","swap","future","option"],i=["linear","inverse"];for(let s=0;s<e.length;s++){const r=e[s];if(r in t)if("spot"===r)this.features[r]=this.featuresMapper(t,r,void 0);else{this.features[r]={};for(let e=0;e<i.length;e++){const s=i[e];this.features[r][s]=this.featuresMapper(t,r,s)}}else this.features[r]=void 0}}featuresMapper(t,e,i=void 0){let s=void 0!==i?t[e][i]:t[e];if(void 0===s)return;const r=this.safeString(s,"extends");if(void 0!==r){s=this.omit(s,"extends");const e=this.featuresMapper(t,r);s=this.deepExtend(e,s)}if("createOrder"in s){const t=this.safeDict(s.createOrder,"attachedStopLossTakeProfit");s.createOrder.stopLoss=t,s.createOrder.takeProfit=t,"spot"===e&&(s.createOrder.hedged=!1,"leverage"in s.createOrder||(s.createOrder.leverage=!1)),void 0===this.safeBool(s.createOrder.timeInForce,"GTC")&&(s.createOrder.timeInForce.GTC=!0)}const a=Object.keys(s);for(let t=0;t<a.length;t++){const e=a[t],i=s[e];this.inArray(e,["sandbox"])||void 0===i||"symbolRequired"in i||(i.symbolRequired=this.inArray(e,["createOrder","createOrders","fetchOHLCV"]))}return s}featureValue(t,e=void 0,i=void 0,s=void 0){const r=this.market(t);return this.featureValueByType(r.type,r.subType,e,i,s)}featureValueByType(t,e,i=void 0,s=void 0,r=void 0){if(void 0===this.features)return r;if(void 0===t)return r;if(!(t in this.features))return r;if(void 0===this.features[t])return r;let a=this.features[t];if(void 0===e){if("spot"!==t)return r}else{if(!(e in this.features[t]))return r;if(void 0===this.features[t][e])return r;a=this.features[t][e]}if(void 0===i)return void 0!==r?r:a;if(!(i in a))return r;const n=a[i];if(void 0===n)return r;if(void 0===s)return void 0!==r?r:n;const o=s.split("."),d=o[0],c=this.safeString(o,1);if(!(d in n))return r;return void 0===this.safeDict(n,d)||void 0===c?n[d]:c in n[d]?n[d][c]:r}orderbookChecksumMessage(t){return t+' : orderbook data checksum validation failed. You can reconnect by calling watchOrderBook again or you can mute the error by setting exchange.options["watchOrderBook"]["checksum"] = false'}createNetworksByIdObject(){const t=this.invertFlatStringDictionary(this.safeValue(this.options,"networks",{}));this.options.networksById=this.extend(t,this.safeValue(this.options,"networksById",{}))}getDefaultOptions(){return{defaultNetworkCodeReplacements:{ETH:{ERC20:"ETH"},TRX:{TRC20:"TRX"},CRO:{CRC20:"CRONOS"},BRC20:{BRC20:"BTC"}}}}safeLedgerEntry(t,e=void 0){e=this.safeCurrency(void 0,e);let i=this.safeString(t,"direction"),s=this.safeString(t,"before"),r=this.safeString(t,"after");const a=this.safeString(t,"amount");void 0!==a&&(void 0===s&&void 0!==r?s=o.Y.stringSub(r,a):void 0!==s&&void 0===r&&(r=o.Y.stringAdd(s,a))),void 0!==s&&void 0!==r&&void 0===i&&(o.Y.stringGt(s,r)&&(i="out"),o.Y.stringGt(r,s)&&(i="in"));const n=this.safeValue(t,"fee");void 0!==n&&(n.cost=this.safeNumber(n,"cost"));const d=this.safeInteger(t,"timestamp"),c=this.safeDict(t,"info",{});return{id:this.safeString(t,"id"),timestamp:d,datetime:this.iso8601(d),direction:i,account:this.safeString(t,"account"),referenceId:this.safeString(t,"referenceId"),referenceAccount:this.safeString(t,"referenceAccount"),type:this.safeString(t,"type"),currency:e.code,amount:this.parseNumber(a),before:this.parseNumber(s),after:this.parseNumber(r),status:this.safeString(t,"status"),fee:n,info:c}}safeCurrencyStructure(t){const e=this.safeDict(t,"networks",{}),i=Object.keys(e),s=i.length;if(0!==s)for(let r=0;r<s;r++){const s=i[r],a=e[s],n=this.safeBool(a,"deposit");(void 0===this.safeBool(t,"deposit")||n)&&(t.deposit=n);const d=this.safeBool(a,"withdraw");(void 0===this.safeBool(t,"withdraw")||d)&&(t.withdraw=d);let c=this.safeBool(a,"active");void 0===c&&(n&&d?t.networks[s].active=!0:void 0!==n&&void 0!==d&&(t.networks[s].active=!1)),c=this.safeBool(t.networks[s],"active");(void 0===this.safeBool(t,"active")||c)&&(t.active=c);const h=this.safeString(a,"fee"),l=this.safeString(t,"fee");(void 0===l||o.Y.stringLt(h,l))&&(t.fee=this.parseNumber(h));const u=this.safeString(a,"precision"),p=this.safeString(t,"precision");(void 0===p||o.Y.stringGt(u,p))&&(t.precision=this.parseNumber(u));const f=this.safeDict(a,"limits"),m=this.safeDict(t,"limits");void 0===m&&(t.limits={});const g=this.safeDict(f,"deposit"),y=this.safeDict(m,"deposit");void 0===y&&(t.limits.deposit={});const v=this.safeString(g,"min"),b=this.safeString(g,"max"),w=this.safeString(y,"min"),S=this.safeString(y,"max");(void 0===w||o.Y.stringLt(v,w))&&(t.limits.deposit.min=this.parseNumber(v)),(void 0===S||o.Y.stringGt(b,S))&&(t.limits.deposit.max=this.parseNumber(b));const k=this.safeDict(f,"withdraw"),O=this.safeDict(m,"withdraw");void 0===O&&(t.limits.withdraw={});const T=this.safeString(k,"min"),P=this.safeString(k,"max"),_=this.safeString(O,"min"),A=this.safeString(O,"max");(void 0===_||o.Y.stringLt(T,_))&&(t.limits.withdraw.min=this.parseNumber(T)),(void 0===A||o.Y.stringGt(P,A))&&(t.limits.withdraw.max=this.parseNumber(P))}return this.extend({info:void 0,id:void 0,numericId:void 0,code:void 0,precision:void 0,type:void 0,name:void 0,active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,fees:{},networks:{},limits:{deposit:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}},t)}safeMarketStructure(t=void 0){const e={id:void 0,lowercaseId:void 0,symbol:void 0,base:void 0,quote:void 0,settle:void 0,baseId:void 0,quoteId:void 0,settleId:void 0,type:void 0,spot:void 0,margin:void 0,swap:void 0,future:void 0,option:void 0,index:void 0,active:void 0,contract:void 0,linear:void 0,inverse:void 0,subType:void 0,taker:void 0,maker:void 0,contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:void 0,price:void 0,cost:void 0,base:void 0,quote:void 0},limits:{leverage:{min:void 0,max:void 0},amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},marginModes:{cross:void 0,isolated:void 0},created:void 0,info:void 0};if(void 0!==t){const i=this.extend(e,t);return i.spot&&(void 0===i.contract&&(i.contract=!1),void 0===i.swap&&(i.swap=!1),void 0===i.future&&(i.future=!1),void 0===i.option&&(i.option=!1),void 0===i.index&&(i.index=!1)),i}return e}setMarkets(t,e=void 0){const i=[];this.markets_by_id=this.createSafeDictionary();const s=this.sortBy(this.toArray(t),"spot",!0,!0);for(let t=0;t<s.length;t++){const e=s[t];if(e.id in this.markets_by_id){const t=this.markets_by_id[e.id];t.push(e),this.markets_by_id[e.id]=t}else this.markets_by_id[e.id]=[e];const r=this.deepExtend(this.safeMarketStructure(),{precision:this.precision,limits:this.limits},this.fees.trading,e);r.linear?r.subType="linear":r.inverse?r.subType="inverse":r.subType=void 0,i.push(r)}this.markets=this.mapToSafeMap(this.indexBy(i,"symbol"));const r=this.keysort(this.markets),a=this.keysort(this.markets_by_id);this.symbols=Object.keys(r),this.ids=Object.keys(a);let n=0;if(void 0!==e){n=Object.keys(e).length}if(n>0)this.currencies=this.mapToSafeMap(this.deepExtend(this.currencies,e));else{let t=[],e=[];for(let s=0;s<i.length;s++){const r=i[s],a=this.precisionMode===we?8:this.parseNumber("1e-8"),n=this.safeDict(r,"precision",{});if("base"in r){const e=this.safeCurrencyStructure({id:this.safeString2(r,"baseId","base"),numericId:this.safeInteger(r,"baseNumericId"),code:this.safeString(r,"base"),precision:this.safeValue2(n,"base","amount",a)});t.push(e)}if("quote"in r){const t=this.safeCurrencyStructure({id:this.safeString2(r,"quoteId","quote"),numericId:this.safeInteger(r,"quoteNumericId"),code:this.safeString(r,"quote"),precision:this.safeValue2(n,"quote","price",a)});e.push(t)}}t=this.sortBy(t,"code",!1,""),e=this.sortBy(e,"code",!1,""),this.baseCurrencies=this.mapToSafeMap(this.indexBy(t,"code")),this.quoteCurrencies=this.mapToSafeMap(this.indexBy(e,"code"));const s=this.arrayConcat(t,e),r=this.groupBy(s,"code"),a=Object.keys(r),n=[];for(let t=0;t<a.length;t++){const e=a[t],i=this.safeList(r,e,[]);let s=this.safeValue(i,0);for(let t=1;t<i.length;t++){const e=i[t];s=this.precisionMode===ke?e.precision<s.precision?e:s:e.precision>s.precision?e:s}n.push(s)}const o=this.sortBy(n,"code");this.currencies=this.mapToSafeMap(this.deepExtend(this.currencies,this.indexBy(o,"code")))}this.currencies_by_id=this.indexBySafe(this.currencies,"id");const o=this.keysort(this.currencies);return this.codes=Object.keys(o),this.markets}setMarketsFromExchange(t){if(this.id!==t.id)throw new n.ArgumentsRequired(this.id+" shareMarkets() can only share markets with exchanges of the same type (got "+t.id+")");if(!t.markets)throw new n.ExchangeError("setMarketsFromExchange() source exchange must have loaded markets first. Can call by using loadMarkets function");this.markets=t.markets,this.markets_by_id=t.markets_by_id,this.symbols=t.symbols,this.ids=t.ids,this.currencies=t.currencies,this.currencies_by_id=t.currencies_by_id,this.baseCurrencies=t.baseCurrencies,this.quoteCurrencies=t.quoteCurrencies,this.codes=t.codes;const e=this.safeList(t.options,"marketHelperProps",[]);for(let i=0;i<e.length;i++){const s=e[i];void 0!==t.options[s]&&(this.options[s]=t.options[s])}return this}getDescribeForExtendedWsExchange(t,e,i){const s=this.deepExtend(e.describe(),t.describe());return this.deepExtend(s,i)}safeBalance(t){const e=this.omit(t,["info","timestamp","datetime","free","used","total"]),i=Object.keys(e);t.free={},t.used={},t.total={};const s={};for(let e=0;e<i.length;e++){const r=i[e];let a=this.safeString(t[r],"total"),n=this.safeString(t[r],"free"),d=this.safeString(t[r],"used");const c=this.safeString(t[r],"debt");void 0===a&&void 0!==n&&void 0!==d&&(a=o.Y.stringAdd(n,d)),void 0===n&&void 0!==a&&void 0!==d&&(n=o.Y.stringSub(a,d)),void 0===d&&void 0!==a&&void 0!==n&&(d=o.Y.stringSub(a,n)),t[r].free=this.parseNumber(n),t[r].used=this.parseNumber(d),t[r].total=this.parseNumber(a),t.free[r]=t[r].free,t.used[r]=t[r].used,t.total[r]=t[r].total,void 0!==c&&(t[r].debt=this.parseNumber(c),s[r]=t[r].debt)}return Object.keys(s).length&&(t.debt=s),t}safeOrder(t,e=void 0){let i=this.omitZero(this.safeString(t,"amount")),s=this.safeString(t,"remaining"),r=this.safeString(t,"filled"),a=this.safeString(t,"cost"),n=this.omitZero(this.safeString(t,"average")),d=this.omitZero(this.safeString(t,"price")),c=this.safeInteger(t,"lastTradeTimestamp"),h=this.safeString(t,"symbol"),l=this.safeString(t,"side");const u=this.safeString(t,"status"),p=void 0===r,f=void 0===a,m=void 0===c,g=this.safeValue(t,"fee"),y=void 0===g,v=void 0===this.safeValue(t,"fees"),b=void 0===h,w=void 0===l,S=y||v,k=this.safeList(t,"fees",[]);let O=[];const T=void 0!==this.safeString(t,"triggerPrice")||void 0!==this.safeString(t,"stopLossPrice")||void 0!==this.safeString(t,"takeProfitPrice");if(p||f||S){const i=this.safeValue(t,"trades",O),s=this.safeValue(i,0);O=void 0!==s&&"info"in s&&"id"in s?i:this.parseTrades(i,e);let n=0;const d=Array.isArray(O);if(d&&(n=O.length),d&&n>0){void 0===t.symbol&&(t.symbol=O[0].symbol),void 0===t.side&&(t.side=O[0].side),void 0===t.type&&(t.type=O[0].type),void 0===t.id&&(t.id=O[0].order),p&&(r="0"),f&&(a="0");for(let t=0;t<O.length;t++){const e=O[t],i=this.safeString(e,"amount");p&&void 0!==i&&(r=o.Y.stringAdd(r,i));const s=this.safeString(e,"cost");f&&void 0!==s&&(a=o.Y.stringAdd(a,s)),b&&(h=this.safeString(e,"symbol")),w&&(l=this.safeString(e,"side"));const n=this.safeValue(e,"timestamp");if(m&&void 0!==n&&(c=void 0===c?n:Math.max(c,n)),S){const t=this.safeValue(e,"fees");if(void 0!==t)for(let e=0;e<t.length;e++){const i=t[e];k.push(this.extend({},i))}else{const t=this.safeValue(e,"fee");void 0!==t&&k.push(this.extend({},t))}}}}}if(S){const e=this.reduceFees?this.reduceFeesByCurrency(k):k,i=e.length;for(let t=0;t<i;t++)e[t].cost=this.safeNumber(e[t],"cost"),"rate"in e[t]&&(e[t].rate=this.safeNumber(e[t],"rate"));if(!y&&0===i){const t=this.deepExtend(g);t.cost=this.safeNumber(t,"cost"),"rate"in t&&(t.rate=this.safeNumber(t,"rate")),e.push(t)}t.fees=e,y&&1===i&&(t.fee=e[0])}void 0===i&&(void 0!==r&&void 0!==s?i=o.Y.stringAdd(r,s):"closed"===u&&(i=r)),void 0===r&&(void 0!==i&&void 0!==s?r=o.Y.stringSub(i,s):"closed"===u&&void 0!==i&&(r=i)),void 0===s&&(void 0!==i&&void 0!==r?s=o.Y.stringSub(i,r):"closed"===u&&(s="0"));const P=this.safeBool(e,"inverse",!1),_=this.numberToString(this.safeValue(e,"contractSize",1));if(void 0===n&&void 0!==r&&void 0!==a&&o.Y.stringGt(r,"0")){const t=o.Y.stringMul(r,_);n=P?o.Y.stringDiv(t,a):o.Y.stringDiv(a,t)}if(f&&void 0!==r&&(void 0!==n||void 0!==d)){let t;t=void 0===n?d:n;const e=o.Y.stringMul(r,_);a=P?o.Y.stringDiv(e,t):o.Y.stringMul(e,t)}const A=this.safeValue(t,"type");(void 0===d||o.Y.stringEquals(d,"0"))&&"market"===A&&(d=n);for(let t=0;t<O.length;t++){const e=O[t];e.amount=this.safeNumber(e,"amount"),e.price=this.safeNumber(e,"price"),e.cost=this.safeNumber(e,"cost");const i=this.safeDict(e,"fee",{});i.cost=this.safeNumber(i,"cost"),"rate"in i&&(i.rate=this.safeNumber(i,"rate"));const s=this.safeList(e,"fees",[]);for(let t=0;t<s.length;t++)s[t].cost=this.safeNumber(s[t],"cost");e.fees=s,e.fee=i}let I=this.safeString(t,"timeInForce"),x=this.safeValue(t,"postOnly");void 0===I?(T||"market"!==this.safeString(t,"type")||(I="IOC"),x&&(I="PO")):void 0===x&&(x="PO"===I);const E=this.safeInteger(t,"timestamp"),M=this.safeInteger(t,"lastUpdateTimestamp");let C=this.safeString(t,"datetime");void 0===C&&(C=this.iso8601(E));const B=this.parseNumber(this.safeString2(t,"triggerPrice","stopPrice")),N=this.parseNumber(this.safeString(t,"takeProfitPrice")),R=this.parseNumber(this.safeString(t,"stopLossPrice"));return this.extend(t,{id:this.safeString(t,"id"),clientOrderId:this.safeString(t,"clientOrderId"),timestamp:E,datetime:C,symbol:h,type:this.safeString(t,"type"),side:l,lastTradeTimestamp:c,lastUpdateTimestamp:M,price:this.parseNumber(d),amount:this.parseNumber(i),cost:this.parseNumber(a),average:this.parseNumber(n),filled:this.parseNumber(r),remaining:this.parseNumber(s),timeInForce:I,postOnly:x,trades:O,reduceOnly:this.safeValue(t,"reduceOnly"),stopPrice:B,triggerPrice:B,takeProfitPrice:N,stopLossPrice:R,status:u,fee:this.safeValue(t,"fee")})}parseOrders(t,e=void 0,i=void 0,s=void 0,r={}){let a=[];if(Array.isArray(t))for(let i=0;i<t.length;i++){const s=this.parseOrder(t[i],e),n=this.extend(s,r);a.push(n)}else{const i=Object.keys(t);for(let s=0;s<i.length;s++){const n=i[s],o=this.extend({id:n},t[n]),d=this.parseOrder(o,e),c=this.extend(d,r);a.push(c)}}a=this.sortBy(a,"timestamp");const n=void 0!==e?e.symbol:void 0;return this.filterBySymbolSinceLimit(a,n,i,s)}calculateFeeWithRate(t,e,i,s,r,a="taker",d=void 0,c={}){if("market"===e&&"maker"===a)throw new n.ArgumentsRequired(this.id+' calculateFee() - you have provided incompatible arguments - "market" type order can not be "maker". Change either the "type" or the "takerOrMaker" argument to calculate the fee.');const h=this.markets[t],l=this.safeString(h,"feeSide","quote");let u;u="get"===l?"sell"===i:"give"===l?"buy"===i:"quote"===l;let p,f=this.numberToString(s);if(u){const t=this.numberToString(r);f=o.Y.stringMul(f,t),p="quote"}else p="base";h.spot||(p="settle"),"market"===e&&(a="taker");const m=void 0!==d?this.numberToString(d):this.safeString(h,a);return f=o.Y.stringMul(f,m),{type:a,currency:h[p],rate:this.parseNumber(m),cost:this.parseNumber(f)}}calculateFee(t,e,i,s,r,a="taker",n={}){return this.calculateFeeWithRate(t,e,i,s,r,a,void 0,n)}safeLiquidation(t,e=void 0){const i=this.safeString(t,"contracts"),s=this.safeString(e,"contractSize"),r=this.safeString(t,"price");let a=this.safeString(t,"baseValue"),n=this.safeString(t,"quoteValue");return void 0===a&&void 0!==i&&void 0!==s&&void 0!==r&&(a=o.Y.stringMul(i,s)),void 0===n&&void 0!==a&&void 0!==r&&(n=o.Y.stringMul(a,r)),t.contracts=this.parseNumber(i),t.contractSize=this.parseNumber(s),t.price=this.parseNumber(r),t.baseValue=this.parseNumber(a),t.quoteValue=this.parseNumber(n),t}safeTrade(t,e=void 0){const i=this.safeString(t,"amount"),s=this.safeString(t,"price");let r=this.safeString(t,"cost");if(void 0===r){const t=this.safeString(e,"contractSize");let a=s;if(void 0!==t){this.safeBool(e,"inverse",!1)&&(a=o.Y.stringDiv("1",s)),a=o.Y.stringMul(a,t)}r=o.Y.stringMul(a,i)}const[a,n]=this.parsedFeeAndFees(t);return t.fee=a,t.fees=n,t.amount=this.parseNumber(i),t.price=this.parseNumber(s),t.cost=this.parseNumber(r),t}createCcxtTradeId(t=void 0,e=void 0,i=void 0,s=void 0,r=void 0){let a;return void 0!==t&&(a=this.numberToString(t),void 0!==e&&(a+="-"+e),void 0!==i&&(a+="-"+this.numberToString(i)),void 0!==s&&(a+="-"+this.numberToString(s)),void 0!==r&&(a+="-"+r)),a}parsedFeeAndFees(t){let e=this.safeDict(t,"fee"),i=this.safeList(t,"fees");const s=void 0!==e,r=void 0!==i;if(s||r){s&&(e=this.parseFeeNumeric(e)),r||(i=[e]);const t=this.reduceFees?this.reduceFeesByCurrency(i):i,a=t.length;for(let e=0;e<a;e++)t[e]=this.parseFeeNumeric(t[e]);i=t,1===a?e=t[0]:0===a&&(e=void 0)}return void 0===e&&(e={cost:void 0,currency:void 0}),void 0===i&&(i=[]),[e,i]}parseFeeNumeric(t){return t.cost=this.safeNumber(t,"cost"),"rate"in t&&(t.rate=this.safeNumber(t,"rate")),t}findNearestCeiling(t,e){const i=t.length;for(let s=0;s<i;s++){const i=t[s];if(e<=i)return i}return t[i-1]}invertFlatStringDictionary(t){const e={},i=Object.keys(t);for(let s=0;s<i.length;s++){const r=i[s],a=t[r];"string"==typeof a&&(e[a]=r)}return e}reduceFeesByCurrency(t){const e={};for(let i=0;i<t.length;i++){const s=t[i],r=this.safeString(s,"currency"),a=void 0!==r?r:i.toString();if(void 0!==a){const t=this.safeString(s,"rate"),i=this.safeString(s,"cost");if(void 0===i)continue;a in e||(e[a]={});const n=void 0===t?"":t;n in e[a]?e[a][n].cost=o.Y.stringAdd(e[a][n].cost,i):(e[a][n]={currency:r,cost:i},void 0!==t&&(e[a][n].rate=t))}}let i=[];const s=Object.values(e);for(let t=0;t<s.length;t++){const e=Object.values(s[t]);i=this.arrayConcat(i,e)}return i}safeTicker(t,e=void 0){let i=this.omitZero(this.safeString(t,"open")),s=this.omitZero(this.safeString2(t,"close","last")),r=this.omitZero(this.safeString(t,"change")),a=this.omitZero(this.safeString(t,"percentage")),n=this.omitZero(this.safeString(t,"average")),d=this.safeString(t,"vwap");const c=this.safeString(t,"baseVolume"),h=this.safeString(t,"quoteVolume");if(void 0===d&&(d=o.Y.stringDiv(this.omitZero(h),c)),void 0!==r)void 0===s&&void 0!==n&&(s=o.Y.stringAdd(n,o.Y.stringDiv(r,"2"))),void 0===i&&void 0!==s&&(i=o.Y.stringSub(s,r));else if(void 0!==a){if(void 0===s&&void 0!==n){const t=o.Y.stringMul(n,"2"),e=o.Y.stringAdd("2",o.Y.stringDiv(a,"100")),r=void 0!==i?i:o.Y.stringDiv(t,e);s=o.Y.stringMul(r,o.Y.stringAdd("1",o.Y.stringDiv(a,"100")))}void 0===i&&void 0!==s&&(i=o.Y.stringDiv(s,o.Y.stringAdd("1",o.Y.stringDiv(a,"100"))))}if(void 0===r&&(void 0!==s&&void 0!==i?r=o.Y.stringSub(s,i):void 0!==s&&void 0!==a?r=o.Y.stringMul(o.Y.stringDiv(a,"100"),o.Y.stringDiv(s,"100")):void 0!==i&&void 0!==a&&(r=o.Y.stringMul(i,o.Y.stringDiv(a,"100")))),void 0!==i&&(void 0===a&&void 0!==r&&(a=o.Y.stringMul(o.Y.stringDiv(r,i),"100")),void 0===s&&void 0!==r&&(s=o.Y.stringAdd(i,r)),void 0===s&&void 0!==n&&(s=o.Y.stringMul(n,"2")),void 0===n&&void 0!==s)){let t=18;if(void 0!==e&&this.isTickPrecision()){const i=this.safeDict(e,"precision"),s=this.safeString(i,"price");void 0!==s&&(t=this.precisionFromString(s))}n=o.Y.stringDiv(o.Y.stringAdd(i,s),"2",t)}const l=this.parseNumber(this.omitZero(s));return this.extend(t,{bid:this.parseNumber(this.omitZero(this.safeString(t,"bid"))),bidVolume:this.safeNumber(t,"bidVolume"),ask:this.parseNumber(this.omitZero(this.safeString(t,"ask"))),askVolume:this.safeNumber(t,"askVolume"),high:this.parseNumber(this.omitZero(this.safeString(t,"high"))),low:this.parseNumber(this.omitZero(this.safeString(t,"low"))),open:this.parseNumber(this.omitZero(i)),close:l,last:l,change:this.parseNumber(r),percentage:this.parseNumber(a),average:this.parseNumber(n),vwap:this.parseNumber(d),baseVolume:this.parseNumber(c),quoteVolume:this.parseNumber(h),previousClose:this.safeNumber(t,"previousClose"),indexPrice:this.safeNumber(t,"indexPrice"),markPrice:this.safeNumber(t,"markPrice")})}async fetchBorrowRate(t,e,i={}){throw new n.NotSupported(this.id+" fetchBorrowRate is deprecated, please use fetchCrossBorrowRate or fetchIsolatedBorrowRate instead")}async repayCrossMargin(t,e,i={}){throw new n.NotSupported(this.id+" repayCrossMargin is not support yet")}async repayIsolatedMargin(t,e,i,s={}){throw new n.NotSupported(this.id+" repayIsolatedMargin is not support yet")}async borrowCrossMargin(t,e,i={}){throw new n.NotSupported(this.id+" borrowCrossMargin is not support yet")}async borrowIsolatedMargin(t,e,i,s={}){throw new n.NotSupported(this.id+" borrowIsolatedMargin is not support yet")}async borrowMargin(t,e,i=void 0,s={}){throw new n.NotSupported(this.id+" borrowMargin is deprecated, please use borrowCrossMargin or borrowIsolatedMargin instead")}async repayMargin(t,e,i=void 0,s={}){throw new n.NotSupported(this.id+" repayMargin is deprecated, please use repayCrossMargin or repayIsolatedMargin instead")}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){let a="";throw this.has.fetchTrades&&(a='. If you want to build OHLCV candles from trade executions data, visit https://github.com/ccxt/ccxt/tree/master/examples/ and see "build-ohlcv-bars" file'),new n.NotSupported(this.id+" fetchOHLCV() is not supported yet"+a)}async fetchOHLCVWs(t,e="1m",i=void 0,s=void 0,r={}){let a="";throw this.has.fetchTradesWs&&(a='. If you want to build OHLCV candles from trade executions data, visit https://github.com/ccxt/ccxt/tree/master/examples/ and see "build-ohlcv-bars" file'),new n.NotSupported(this.id+" fetchOHLCVWs() is not supported yet. Try using fetchOHLCV instead."+a)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" watchOHLCV() is not supported yet")}convertTradingViewToOHLCV(t,e="t",i="o",s="h",r="l",a="c",n="v",o=!1){const d=[],c=this.safeList(t,e,[]),h=this.safeList(t,i,[]),l=this.safeList(t,s,[]),u=this.safeList(t,r,[]),p=this.safeList(t,a,[]),f=this.safeList(t,n,[]);for(let t=0;t<c.length;t++)d.push([o?this.safeInteger(c,t):this.safeTimestamp(c,t),this.safeValue(h,t),this.safeValue(l,t),this.safeValue(u,t),this.safeValue(p,t),this.safeValue(f,t)]);return d}convertOHLCVToTradingView(t,e="t",i="o",s="h",r="l",a="c",n="v",o=!1){const d={};d[e]=[],d[i]=[],d[s]=[],d[r]=[],d[a]=[],d[n]=[];for(let c=0;c<t.length;c++){const h=o?t[c][0]:this.parseToInt(t[c][0]/1e3);d[e].push(h);d[i].push(t[c][1]);d[s].push(t[c][2]);d[r].push(t[c][3]);d[a].push(t[c][4]);d[n].push(t[c][5])}return d}async fetchWebEndpoint(t,e,i,s=void 0,r=void 0){let a="";const o=this.safeValue(this.options,t,{}),d=this.safeBool(o,"webApiMuteFailure",!0);try{if(!0!==this.safeBool(o,"webApiEnable",!0))return;const t=this.safeValue(o,"webApiRetries",10);let a,d=0,c=!1;for(;d<t;){try{a=await this[e]({}),c=!0;break}catch(e){if(d+=1,d===t)throw e}if(c)break}let h=a;if(void 0!==s){const t=h.split(s);h=t[1]}if(void 0!==r){const t=h.split(r);h=t[0]}if(i&&"string"==typeof h){const t=this.parseJson(h.trim());if(t)return t;throw new n.BadResponse("could not parse the response into json")}return h}catch(e){a=this.id+" "+t+"() failed to fetch correct data from website. Probably webpage markup has been changed, breaking the page custom parser."}if(!d)throw new n.BadResponse(a)}marketIds(t=void 0){if(void 0===t)return t;const e=[];for(let i=0;i<t.length;i++)e.push(this.marketId(t[i]));return e}currencyIds(t=void 0){if(void 0===t)return t;const e=[];for(let i=0;i<t.length;i++)e.push(this.currencyId(t[i]));return e}marketsForSymbols(t=void 0){if(void 0===t)return t;const e=[];for(let i=0;i<t.length;i++)e.push(this.market(t[i]));return e}marketSymbols(t=void 0,e=void 0,i=!0,s=!1,r=!1){if(void 0===t){if(!i)throw new n.ArgumentsRequired(this.id+" empty list of symbols is not supported");return t}if(0===t.length){if(!i)throw new n.ArgumentsRequired(this.id+" empty list of symbols is not supported");return t}const a=[];let o,d;for(let i=0;i<t.length;i++){const c=this.market(t[i]);if(s&&void 0!==o&&c.type!==o)throw new n.BadRequest(this.id+" symbols must be of the same type, either "+o+" or "+c.type+".");if(r&&void 0!==d&&c.linear!==d)throw new n.BadRequest(this.id+" symbols must be of the same subType, either linear or inverse.");if(void 0!==e&&c.type!==e)throw new n.BadRequest(this.id+" symbols must be of the same type "+e+". If the type is incorrect you can change it in options or the params of the request");o=c.type,c.spot||(d=c.linear);const h=this.safeString(c,"symbol",t[i]);a.push(h)}return a}marketCodes(t=void 0){if(void 0===t)return t;const e=[];for(let i=0;i<t.length;i++)e.push(this.commonCurrencyCode(t[i]));return e}parseBidsAsks(t,e=0,i=1,s=2){t=this.toArray(t);const r=[];for(let a=0;a<t.length;a++)r.push(this.parseBidAsk(t[a],e,i,s));return r}async fetchL2OrderBook(t,e=void 0,i={}){const s=await this.fetchOrderBook(t,e,i);return this.extend(s,{asks:this.sortBy(this.aggregate(s.asks),0),bids:this.sortBy(this.aggregate(s.bids),0,!0)})}filterBySymbol(t,e=void 0){if(void 0===e)return t;const i=[];for(let s=0;s<t.length;s++){this.safeString(t[s],"symbol")===e&&i.push(t[s])}return i}parseOHLCV(t,e=void 0){return Array.isArray(t)?[this.safeInteger(t,0),this.safeNumber(t,1),this.safeNumber(t,2),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,5)]:t}networkCodeToId(t,e=void 0){if(void 0===t)return;const i=this.safeValue(this.options,"networks",{});let s=this.safeString(i,t);if(void 0===s){if(void 0===e){const e=Object.values(this.currencies);for(let i=0;i<e.length;i++){const r=e[i],a=this.safeDict(r,"networks"),n=this.safeDict(a,t);if(s=this.safeString(n,"id"),void 0!==s)break}}else{const r=this.safeValue(this.options,"defaultNetworkCodeReplacements",{});if(e in r){const a=r[e],n=Object.keys(a);for(let e=0;e<n.length;e++){const r=n[e];if(a[r]===t){s=this.safeString(i,r);break}}}else{const i=this.safeDict(this.currencies,e),r=this.safeDict(i,"networks"),a=this.safeDict(r,t);s=this.safeString(a,"id")}}void 0===s&&(s=t)}return s}networkIdToCode(t=void 0,e=void 0){if(void 0===t)return;const i=this.safeDict(this.options,"networksById",{});let s=this.safeString(i,t,t);if(void 0!==e){const t=this.safeDict(this.options,"defaultNetworkCodeReplacements",{});if(e in t){const i=this.safeDict(t,e,{});s=this.safeString(i,s,s)}}return s}handleNetworkCodeAndParams(t){const e=this.safeString2(t,"networkCode","network");return void 0!==e&&(t=this.omit(t,["networkCode","network"])),[e,t]}defaultNetworkCode(t){let e;const i=this.safeDict(this.options,"defaultNetworks",{});if(t in i)e=i[t];else{const t=this.safeString(this.options,"defaultNetwork");void 0!==t&&(e=t)}return e}selectNetworkCodeFromUnifiedNetworks(t,e,i){return this.selectNetworkKeyFromNetworks(t,e,i,!0)}selectNetworkIdFromRawNetworks(t,e,i){return this.selectNetworkKeyFromNetworks(t,e,i,!1)}selectNetworkKeyFromNetworks(t,e,i,s=!1){let r;const a=Object.keys(i),o=a.length;if(void 0===e){if(0===o)throw new n.NotSupported(this.id+" - no networks were returned for "+t);{const e=this.defaultNetworkCode(t),r=s?e:this.networkCodeToId(e,t);if(r in i)return r;throw new n.NotSupported(this.id+' - can not determine the default network, please pass param["network"] one from : '+a.join(", "))}}if(0===o)throw new n.NotSupported(this.id+" - "+e+" network did not return any result for "+t);{const o=s?e:this.networkCodeToId(e,t);if(!(o in i))throw new n.NotSupported(this.id+" - "+o+" network was not found for "+t+", use one of "+a.join(", "));r=o}return r}safeNumber2(t,e,i,s=void 0){const r=this.safeString2(t,e,i);return this.parseNumber(r,s)}parseOrderBook(t,e,i=void 0,s="bids",r="asks",a=0,n=1,o=2){const d=this.parseBidsAsks(this.safeValue(t,s,[]),a,n,o),c=this.parseBidsAsks(this.safeValue(t,r,[]),a,n,o);return{symbol:e,bids:this.sortBy(d,0,!0),asks:this.sortBy(c,0),timestamp:i,datetime:this.iso8601(i),nonce:void 0}}parseOHLCVs(t,e=void 0,i="1m",s=void 0,r=void 0,a=!1){const n=[];for(let i=0;i<t.length;i++)n.push(this.parseOHLCV(t[i],e));const o=this.sortBy(n,0);return this.filterBySinceLimit(o,s,r,0,a)}parseLeverageTiers(t,e=void 0,i=void 0){const s={};let r=0;void 0!==(e=this.marketSymbols(e))&&(r=e.length);const a=void 0===e||0===r;if(Array.isArray(t))for(let r=0;r<t.length;r++){const n=t[r],o=this.safeString(n,i),d=this.safeMarket(o,void 0,void 0,"swap"),c=d.symbol;this.safeBool(d,"contract",!1)&&(a||this.inArray(c,e))&&(s[c]=this.parseMarketLeverageTiers(n,d))}else{const i=Object.keys(t);for(let r=0;r<i.length;r++){const n=i[r],o=t[n],d=this.safeMarket(n,void 0,void 0,"swap"),c=d.symbol;this.safeBool(d,"contract",!1)&&(a||this.inArray(c,e))&&(s[c]=this.parseMarketLeverageTiers(o,d))}}return s}async loadTradingLimits(t=void 0,e=!1,i={}){if(this.has.fetchTradingLimits&&(e||!("limitsLoaded"in this.options))){const e=await this.fetchTradingLimits(t);for(let i=0;i<t.length;i++){const s=t[i];this.markets[s]=this.deepExtend(this.markets[s],e[s])}this.options.limitsLoaded=this.milliseconds()}return this.markets}safePosition(t){const e=this.safeString(t,"unrealisedPnl"),i=this.safeString(t,"initialMargin");if(void 0===this.safeValue(t,"percentage")&&void 0!==e&&void 0!==i){const s=o.Y.stringMul(o.Y.stringDiv(e,i,4),"100");t.percentage=this.parseNumber(s)}let s=this.safeNumber(t,"contractSize");const r=this.safeString(t,"symbol");let a;return void 0!==r&&(a=this.safeValue(this.markets,r)),void 0===s&&void 0!==a&&(s=this.safeNumber(a,"contractSize"),t.contractSize=s),t}parsePositions(t,e=void 0,i={}){e=this.marketSymbols(e),t=this.toArray(t);const s=[];for(let e=0;e<t.length;e++){const r=this.extend(this.parsePosition(t[e],void 0),i);s.push(r)}return this.filterByArrayPositions(s,"symbol",e,!1)}parseAccounts(t,e={}){t=this.toArray(t);const i=[];for(let s=0;s<t.length;s++){const r=this.extend(this.parseAccount(t[s]),e);i.push(r)}return i}parseTradesHelper(t,e,i=void 0,s=void 0,r=void 0,a={}){e=this.toArray(e);let n=[];for(let s=0;s<e.length;s++){let r;r=t?this.parseWsTrade(e[s],i):this.parseTrade(e[s],i);const o=this.extend(r,a);n.push(o)}n=this.sortBy2(n,"timestamp","id");const o=void 0!==i?i.symbol:void 0;return this.filterBySymbolSinceLimit(n,o,s,r)}parseTrades(t,e=void 0,i=void 0,s=void 0,r={}){return this.parseTradesHelper(!1,t,e,i,s,r)}parseWsTrades(t,e=void 0,i=void 0,s=void 0,r={}){return this.parseTradesHelper(!0,t,e,i,s,r)}parseTransactions(t,e=void 0,i=void 0,s=void 0,r={}){t=this.toArray(t);let a=[];for(let i=0;i<t.length;i++){const s=this.extend(this.parseTransaction(t[i],e),r);a.push(s)}a=this.sortBy(a,"timestamp");const n=void 0!==e?e.code:void 0;return this.filterByCurrencySinceLimit(a,n,i,s)}parseTransfers(t,e=void 0,i=void 0,s=void 0,r={}){t=this.toArray(t);let a=[];for(let i=0;i<t.length;i++){const s=this.extend(this.parseTransfer(t[i],e),r);a.push(s)}a=this.sortBy(a,"timestamp");const n=void 0!==e?e.code:void 0;return this.filterByCurrencySinceLimit(a,n,i,s)}parseLedger(t,e=void 0,i=void 0,s=void 0,r={}){let a=[];const n=this.toArray(t);for(let t=0;t<n.length;t++){const i=this.parseLedgerEntry(n[t],e);if(Array.isArray(i))for(let t=0;t<i.length;t++)a.push(this.extend(i[t],r));else a.push(this.extend(i,r))}a=this.sortBy(a,"timestamp");const o=void 0!==e?e.code:void 0;return this.filterByCurrencySinceLimit(a,o,i,s)}nonce(){return this.seconds()}setHeaders(t){return t}currencyId(t){let e=this.safeDict(this.currencies,t);return void 0===e&&(e=this.safeCurrency(t)),void 0!==e?e.id:t}marketId(t){const e=this.market(t);return void 0!==e?e.id:t}symbol(t){const e=this.market(t);return this.safeString(e,"symbol",t)}handleParamString(t,e,i=void 0){const s=this.safeString(t,e,i);return void 0!==s&&(t=this.omit(t,e)),[s,t]}handleParamString2(t,e,i,s=void 0){const r=this.safeString2(t,e,i,s);return void 0!==r&&(t=this.omit(t,[e,i])),[r,t]}handleParamInteger(t,e,i=void 0){const s=this.safeInteger(t,e,i);return void 0!==s&&(t=this.omit(t,e)),[s,t]}handleParamInteger2(t,e,i,s=void 0){const r=this.safeInteger2(t,e,i,s);return void 0!==r&&(t=this.omit(t,[e,i])),[r,t]}handleParamBool(t,e,i=void 0){const s=this.safeBool(t,e,i);return void 0!==s&&(t=this.omit(t,e)),[s,t]}handleParamBool2(t,e,i,s=void 0){const r=this.safeBool2(t,e,i,s);return void 0!==r&&(t=this.omit(t,[e,i])),[r,t]}handleRequestNetwork(t,e,i,s=void 0,r=!1){let a;if([a,t]=this.handleNetworkCodeAndParams(t),void 0!==a)e[i]=this.networkCodeToId(a,s);else if(r)throw new n.ArgumentsRequired(this.id+' - "network" param is required for this request');return[e,t]}resolvePath(t,e){return[this.implodeParams(t,e),this.omit(e,this.extractParams(t))]}getListFromObjectValues(t,e){let i=t;Array.isArray(t)||(i=this.toArray(t));const s=[];for(let t=0;t<i.length;t++)s.push(i[t][e]);return s}getSymbolsForMarketType(t=void 0,e=void 0,i=!0,s=!0){let r=this.markets;void 0!==t&&(r=this.filterBy(r,"type",t)),void 0!==e&&(this.checkRequiredArgument("getSymbolsForMarketType",e,"subType",["linear","inverse","quanto"]),r=this.filterBy(r,"subType",e));const a=[];return i&&a.push(!0),s&&a.push(void 0),r=this.filterByArray(r,"active",a,!1),this.getListFromObjectValues(r,"symbol")}filterByArray(t,e,i=void 0,s=!0){if(t=this.toArray(t),void 0===i||!i)return s?this.indexBy(t,e):t;const r=[];for(let s=0;s<t.length;s++)this.inArray(t[s][e],i)&&r.push(t[s]);return s?this.indexBy(r,e):r}async fetch2(t,e="public",i="GET",s={},r=void 0,a=void 0,o={}){if(this.enableRateLimit){const r=this.calculateRateLimiterCost(e,i,t,s,o);await this.throttle(r)}let d,c;[d,s]=this.handleOptionAndParams(s,t,"maxRetriesOnFailure",0),[c,s]=this.handleOptionAndParams(s,t,"maxRetriesOnFailureDelay",0),this.lastRestRequestTimestamp=this.milliseconds();const h=this.sign(t,e,i,s,r,a);this.last_request_headers=h.headers,this.last_request_body=h.body,this.last_request_url=h.url;for(let t=0;t<d+1;t++)try{return await this.fetch(h.url,h.method,h.headers,h.body)}catch(e){if(!(e instanceof n.OperationFailed))throw e;if(!(t<d))throw e;if(this.verbose){const i=t+1;this.log("Request failed with the error: "+e.toString()+", retrying "+i.toString()+" of "+d.toString()+"...")}void 0!==c&&0!==c&&await this.sleep(c)}}async request(t,e="public",i="GET",s={},r=void 0,a=void 0,n={}){return await this.fetch2(t,e,i,s,r,a,n)}async loadAccounts(t=!1,e={}){if(t)this.accounts=await this.fetchAccounts(e);else{if(this.accounts)return this.accounts;this.accounts=await this.fetchAccounts(e)}return this.accountsById=this.indexBy(this.accounts,"id"),this.accounts}buildOHLCVC(t,e="1m",i=0,s=2147483647){const r=1e3*this.parseTimeframe(e),a=[],n=t.length,o=Math.min(n,s),d=this.safeDict(this.options,"buildOHLCVC",{}),c=this.safeBool(d,"skipZeroPrices",!0);for(let e=0;e<o;e++){const s=t[e],n=s.timestamp,o=s.price;if(n<i)continue;const d=Math.floor(n/r)*r;if(d<i)continue;const h=a.length-1;if(c&&!(o>0)&&!(o<0))continue;-1===h||d>=this.sum(a[h][0],r)?a.push([d,o,o,o,o,s.amount,1]):(a[h][2]=Math.max(a[h][2],o),a[h][3]=Math.min(a[h][3],o),a[h][4]=o,a[h][5]=this.sum(a[h][5],s.amount),a[h][6]=this.sum(a[h][6],1))}return a}parseTradingViewOHLCV(t,e=void 0,i="1m",s=void 0,r=void 0){const a=this.convertTradingViewToOHLCV(t);return this.parseOHLCVs(a,e,i,s,r)}async editLimitBuyOrder(t,e,i,s=void 0,r={}){return await this.editLimitOrder(t,e,"buy",i,s,r)}async editLimitSellOrder(t,e,i,s=void 0,r={}){return await this.editLimitOrder(t,e,"sell",i,s,r)}async editLimitOrder(t,e,i,s,r=void 0,a={}){return await this.editOrder(t,e,"limit",i,s,r,a)}async editOrder(t,e,i,s,r=void 0,a=void 0,n={}){return await this.cancelOrder(t,e),await this.createOrder(e,i,s,r,a,n)}async editOrderWithClientOrderId(t,e,i,s,r=void 0,a=void 0,n={}){return await this.editOrder("",e,i,s,r,a,this.extend({clientOrderId:t},n))}async editOrderWs(t,e,i,s,r=void 0,a=void 0,n={}){return await this.cancelOrderWs(t,e),await this.createOrderWs(e,i,s,r,a,n)}async fetchPosition(t,e={}){throw new n.NotSupported(this.id+" fetchPosition() is not supported yet")}async fetchPositionWs(t,e={}){throw new n.NotSupported(this.id+" fetchPositionWs() is not supported yet")}async watchPosition(t=void 0,e={}){throw new n.NotSupported(this.id+" watchPosition() is not supported yet")}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchPositions() is not supported yet")}async watchPositionForSymbols(t=void 0,e=void 0,i=void 0,s={}){return await this.watchPositions(t,e,i,s)}async fetchPositionsForSymbol(t,e={}){throw new n.NotSupported(this.id+" fetchPositionsForSymbol() is not supported yet")}async fetchPositionsForSymbolWs(t,e={}){throw new n.NotSupported(this.id+" fetchPositionsForSymbol() is not supported yet")}async fetchPositions(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchPositions() is not supported yet")}async fetchPositionsWs(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchPositions() is not supported yet")}async fetchPositionsRisk(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchPositionsRisk() is not supported yet")}async fetchBidsAsks(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchBidsAsks() is not supported yet")}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchBorrowInterest() is not supported yet")}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchLedger() is not supported yet")}async fetchLedgerEntry(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchLedgerEntry() is not supported yet")}parseBidAsk(t,e=0,i=1,s=2){const r=this.safeFloat(t,e),a=this.safeFloat(t,i),n=this.safeInteger(t,s),o=[r,a];return void 0!==n&&o.push(n),o}safeCurrency(t,e=void 0){if(void 0===t&&void 0!==e)return e;if(void 0!==this.currencies_by_id&&t in this.currencies_by_id&&void 0!==this.currencies_by_id[t])return this.currencies_by_id[t];let i=t;return void 0!==t&&(i=this.commonCurrencyCode(t.toUpperCase())),this.safeCurrencyStructure({id:t,code:i,precision:void 0})}safeMarket(t=void 0,e=void 0,i=void 0,s=void 0){if(void 0!==t)if(void 0!==this.markets_by_id&&t in this.markets_by_id){const i=this.markets_by_id[t];if(1===i.length)return i[0];if(void 0===s){if(void 0===e)throw new n.ArgumentsRequired(this.id+" safeMarket() requires a fourth argument for "+t+" to disambiguate between different markets with the same market id");s=e.type}for(let t=0;t<i.length;t++){const e=i[t];if(e[s])return e}}else if(void 0!==i&&""!==i){const e=t.split(i),s=e.length,r=this.safeMarketStructure({symbol:t,marketId:t});return 2===s&&(r.baseId=this.safeString(e,0),r.quoteId=this.safeString(e,1),r.base=this.safeCurrencyCode(r.baseId),r.quote=this.safeCurrencyCode(r.quoteId),r.symbol=r.base+"/"+r.quote),r}return void 0!==e?e:this.safeMarketStructure({symbol:t,marketId:t})}marketOrNull(t=void 0){if(void 0!==t)return this.market(t)}checkRequiredCredentials(t=!0){const e=Object.keys(this.requiredCredentials);for(let i=0;i<e.length;i++){const s=e[i];if(this.requiredCredentials[s]&&!this[s]){if(t)throw new n.AuthenticationError(this.id+' requires "'+s+'" credential');return!1}}return!0}oath(){if(void 0!==this.twofa)return(0,u.O)(this.twofa);throw new n.ExchangeError(this.id+" exchange.twofa has not been set for 2FA Two-Factor Authentication")}async fetchBalance(t={}){throw new n.NotSupported(this.id+" fetchBalance() is not supported yet")}async fetchBalanceWs(t={}){throw new n.NotSupported(this.id+" fetchBalanceWs() is not supported yet")}parseBalance(t){throw new n.NotSupported(this.id+" parseBalance() is not supported yet")}async watchBalance(t={}){throw new n.NotSupported(this.id+" watchBalance() is not supported yet")}async fetchPartialBalance(t,e={}){return(await this.fetchBalance(e))[t]}async fetchFreeBalance(t={}){return await this.fetchPartialBalance("free",t)}async fetchUsedBalance(t={}){return await this.fetchPartialBalance("used",t)}async fetchTotalBalance(t={}){return await this.fetchPartialBalance("total",t)}async fetchStatus(t={}){throw new n.NotSupported(this.id+" fetchStatus() is not supported yet")}async fetchTransactionFee(t,e={}){if(!this.has.fetchTransactionFees)throw new n.NotSupported(this.id+" fetchTransactionFee() is not supported yet");return await this.fetchTransactionFees([t],e)}async fetchTransactionFees(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchTransactionFees() is not supported yet")}async fetchDepositWithdrawFees(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchDepositWithdrawFees() is not supported yet")}async fetchDepositWithdrawFee(t,e={}){if(!this.has.fetchDepositWithdrawFees)throw new n.NotSupported(this.id+" fetchDepositWithdrawFee() is not supported yet");const i=await this.fetchDepositWithdrawFees([t],e);return this.safeValue(i,t)}getSupportedMapping(t,e={}){if(t in e)return e[t];throw new n.NotSupported(this.id+" "+t+" does not have a value in mapping")}async fetchCrossBorrowRate(t,e={}){if(await this.loadMarkets(),!this.has.fetchBorrowRates)throw new n.NotSupported(this.id+" fetchCrossBorrowRate() is not supported yet");const i=await this.fetchCrossBorrowRates(e),s=this.safeValue(i,t);if(void 0===s)throw new n.ExchangeError(this.id+" fetchCrossBorrowRate() could not find the borrow rate for currency code "+t);return s}async fetchIsolatedBorrowRate(t,e={}){if(await this.loadMarkets(),!this.has.fetchBorrowRates)throw new n.NotSupported(this.id+" fetchIsolatedBorrowRate() is not supported yet");const i=await this.fetchIsolatedBorrowRates(e),s=this.safeDict(i,t);if(void 0===s)throw new n.ExchangeError(this.id+" fetchIsolatedBorrowRate() could not find the borrow rate for market symbol "+t);return s}handleOptionAndParams(t,e,i,s=void 0){const r="default"+this.capitalize(i);let a=this.safeValue2(t,i,r);if(void 0!==a)t=this.omit(t,[i,r]);else{[e,t]=this.handleParamString(t,"callerMethodName",e);const n=this.safeValue(this.options,e);void 0!==n&&(a=this.safeValue2(n,i,r)),void 0===a&&(a=this.safeValue2(this.options,i,r)),a=void 0!==a?a:s}return[a,t]}handleOptionAndParams2(t,e,i,s,r=void 0){let a,n;return[a,t]=this.handleOptionAndParams(t,e,i),void 0!==a?[a,t=this.omit(t,s)]:([n,t]=this.handleOptionAndParams(t,e,s,r),[n,t])}handleOption(t,e,i=void 0){const s=this.handleOptionAndParams({},t,e,i);return this.safeValue(s,0)}handleMarketTypeAndParams(t,e=void 0,i={},s=void 0){const r=this.safeString2(i,"defaultType","type");if(void 0!==r)return[r,i=this.omit(i,["defaultType","type"])];if(void 0!==e)return[e.type,i];if(void 0!==s)return[s,i];const a=this.safeDict(this.options,t);if(void 0!==a){if("string"==typeof a)return[a,i];{const t=this.safeString2(a,"defaultType","type");if(void 0!==t)return[t,i]}}return[this.safeString2(this.options,"defaultType","type","spot"),i]}handleSubTypeAndParams(t,e=void 0,i={},s=void 0){let r;const a=this.safeString2(i,"subType","defaultSubType");if(void 0!==a)r=a,i=this.omit(i,["subType","defaultSubType"]);else if(void 0!==e&&(e.linear?r="linear":e.inverse&&(r="inverse")),void 0===r){r=this.handleOptionAndParams({},t,"subType",s)[0]}return[r,i]}handleMarginModeAndParams(t,e={},i=void 0){return this.handleOptionAndParams(e,t,"marginMode",i)}throwExactlyMatchedException(t,e,i){if(void 0!==e&&e in t)throw new t[e](i)}throwBroadlyMatchedException(t,e,i){const s=this.findBroadlyMatchedKey(t,e);if(void 0!==s)throw new t[s](i)}findBroadlyMatchedKey(t,e){const i=Object.keys(t);for(let t=0;t<i.length;t++){const s=i[t];if(void 0!==e&&e.indexOf(s)>=0)return s}}handleErrors(t,e,i,s,r,a,n,o,d){}calculateRateLimiterCost(t,e,i,s,r={}){return this.safeValue(r,"cost",1)}async fetchTicker(t,e={}){if(this.has.fetchTickers){await this.loadMarkets();t=this.market(t).symbol;const i=await this.fetchTickers([t],e),s=this.safeDict(i,t);if(void 0===s)throw new n.NullResponse(this.id+" fetchTickers() could not find a ticker for "+t);return s}throw new n.NotSupported(this.id+" fetchTicker() is not supported yet")}async fetchMarkPrice(t,e={}){if(this.has.fetchMarkPrices){await this.loadMarkets();t=this.market(t).symbol;const i=await this.fetchMarkPrices([t],e),s=this.safeDict(i,t);if(void 0===s)throw new n.NullResponse(this.id+" fetchMarkPrices() could not find a ticker for "+t);return s}throw new n.NotSupported(this.id+" fetchMarkPrices() is not supported yet")}async fetchTickerWs(t,e={}){if(this.has.fetchTickersWs){await this.loadMarkets();t=this.market(t).symbol;const i=await this.fetchTickersWs([t],e),s=this.safeDict(i,t);if(void 0===s)throw new n.NullResponse(this.id+" fetchTickerWs() could not find a ticker for "+t);return s}throw new n.NotSupported(this.id+" fetchTickerWs() is not supported yet")}async watchTicker(t,e={}){throw new n.NotSupported(this.id+" watchTicker() is not supported yet")}async fetchTickers(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchTickers() is not supported yet")}async fetchMarkPrices(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchMarkPrices() is not supported yet")}async fetchTickersWs(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchTickers() is not supported yet")}async fetchOrderBooks(t=void 0,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchOrderBooks() is not supported yet")}async watchBidsAsks(t=void 0,e={}){throw new n.NotSupported(this.id+" watchBidsAsks() is not supported yet")}async watchTickers(t=void 0,e={}){throw new n.NotSupported(this.id+" watchTickers() is not supported yet")}async unWatchTickers(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchTickers() is not supported yet")}async fetchOrder(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchOrder() is not supported yet")}async fetchOrderWithClientOrderId(t,e=void 0,i={}){const s=this.extend(i,{clientOrderId:t});return await this.fetchOrder("",e,s)}async fetchOrderWs(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchOrderWs() is not supported yet")}async fetchOrderStatus(t,e=void 0,i={}){return(await this.fetchOrder(t,e,i)).status}async fetchUnifiedOrder(t,e={}){return await this.fetchOrder(this.safeString(t,"id"),this.safeString(t,"symbol"),e)}async createOrder(t,e,i,s,r=void 0,a={}){throw new n.NotSupported(this.id+" createOrder() is not supported yet")}async createConvertTrade(t,e,i,s=void 0,r={}){throw new n.NotSupported(this.id+" createConvertTrade() is not supported yet")}async fetchConvertTrade(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchConvertTrade() is not supported yet")}async fetchConvertTradeHistory(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchConvertTradeHistory() is not supported yet")}async fetchPositionMode(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchPositionMode() is not supported yet")}async createTrailingAmountOrder(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTrailingAmountOrder() requires a trailingAmount argument");if(d.trailingAmount=a,void 0!==o&&(d.trailingTriggerPrice=o),this.has.createTrailingAmountOrder)return await this.createOrder(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createTrailingAmountOrder() is not supported yet")}async createTrailingAmountOrderWs(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTrailingAmountOrderWs() requires a trailingAmount argument");if(d.trailingAmount=a,void 0!==o&&(d.trailingTriggerPrice=o),this.has.createTrailingAmountOrderWs)return await this.createOrderWs(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createTrailingAmountOrderWs() is not supported yet")}async createTrailingPercentOrder(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTrailingPercentOrder() requires a trailingPercent argument");if(d.trailingPercent=a,void 0!==o&&(d.trailingTriggerPrice=o),this.has.createTrailingPercentOrder)return await this.createOrder(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createTrailingPercentOrder() is not supported yet")}async createTrailingPercentOrderWs(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTrailingPercentOrderWs() requires a trailingPercent argument");if(d.trailingPercent=a,void 0!==o&&(d.trailingTriggerPrice=o),this.has.createTrailingPercentOrderWs)return await this.createOrderWs(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createTrailingPercentOrderWs() is not supported yet")}async createMarketOrderWithCost(t,e,i,s={}){if(this.has.createMarketOrderWithCost||this.has.createMarketBuyOrderWithCost&&this.has.createMarketSellOrderWithCost)return await this.createOrder(t,"market",e,i,1,s);throw new n.NotSupported(this.id+" createMarketOrderWithCost() is not supported yet")}async createMarketBuyOrderWithCost(t,e,i={}){if(this.options.createMarketBuyOrderRequiresPrice||this.has.createMarketBuyOrderWithCost)return await this.createOrder(t,"market","buy",e,1,i);throw new n.NotSupported(this.id+" createMarketBuyOrderWithCost() is not supported yet")}async createMarketSellOrderWithCost(t,e,i={}){if(this.options.createMarketSellOrderRequiresPrice||this.has.createMarketSellOrderWithCost)return await this.createOrder(t,"market","sell",e,1,i);throw new n.NotSupported(this.id+" createMarketSellOrderWithCost() is not supported yet")}async createMarketOrderWithCostWs(t,e,i,s={}){if(this.has.createMarketOrderWithCostWs||this.has.createMarketBuyOrderWithCostWs&&this.has.createMarketSellOrderWithCostWs)return await this.createOrderWs(t,"market",e,i,1,s);throw new n.NotSupported(this.id+" createMarketOrderWithCostWs() is not supported yet")}async createTriggerOrder(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTriggerOrder() requires a triggerPrice argument");if(o.triggerPrice=a,this.has.createTriggerOrder)return await this.createOrder(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createTriggerOrder() is not supported yet")}async createTriggerOrderWs(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTriggerOrderWs() requires a triggerPrice argument");if(o.triggerPrice=a,this.has.createTriggerOrderWs)return await this.createOrderWs(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createTriggerOrderWs() is not supported yet")}async createStopLossOrder(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createStopLossOrder() requires a stopLossPrice argument");if(o.stopLossPrice=a,this.has.createStopLossOrder)return await this.createOrder(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createStopLossOrder() is not supported yet")}async createStopLossOrderWs(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createStopLossOrderWs() requires a stopLossPrice argument");if(o.stopLossPrice=a,this.has.createStopLossOrderWs)return await this.createOrderWs(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createStopLossOrderWs() is not supported yet")}async createTakeProfitOrder(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTakeProfitOrder() requires a takeProfitPrice argument");if(o.takeProfitPrice=a,this.has.createTakeProfitOrder)return await this.createOrder(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createTakeProfitOrder() is not supported yet")}async createTakeProfitOrderWs(t,e,i,s,r=void 0,a=void 0,o={}){if(void 0===a)throw new n.ArgumentsRequired(this.id+" createTakeProfitOrderWs() requires a takeProfitPrice argument");if(o.takeProfitPrice=a,this.has.createTakeProfitOrderWs)return await this.createOrderWs(t,e,i,s,r,o);throw new n.NotSupported(this.id+" createTakeProfitOrderWs() is not supported yet")}async createOrderWithTakeProfitAndStopLoss(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(d=this.setTakeProfitAndStopLossParams(t,e,i,s,r,a,o,d),this.has.createOrderWithTakeProfitAndStopLoss)return await this.createOrder(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createOrderWithTakeProfitAndStopLoss() is not supported yet")}setTakeProfitAndStopLossParams(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(void 0===a&&void 0===o)throw new n.ArgumentsRequired(this.id+" createOrderWithTakeProfitAndStopLoss() requires either a takeProfit or stopLoss argument");void 0!==a&&(d.takeProfit={triggerPrice:a}),void 0!==o&&(d.stopLoss={triggerPrice:o});const c=this.safeString(d,"takeProfitType"),h=this.safeString(d,"takeProfitPriceType"),l=this.safeString(d,"takeProfitLimitPrice"),u=this.safeString(d,"takeProfitAmount"),p=this.safeString(d,"stopLossType"),f=this.safeString(d,"stopLossPriceType"),m=this.safeString(d,"stopLossLimitPrice"),g=this.safeString(d,"stopLossAmount");return void 0!==c&&(d.takeProfit.type=c),void 0!==h&&(d.takeProfit.priceType=h),void 0!==l&&(d.takeProfit.price=this.parseToNumeric(l)),void 0!==u&&(d.takeProfit.amount=this.parseToNumeric(u)),void 0!==p&&(d.stopLoss.type=p),void 0!==f&&(d.stopLoss.priceType=f),void 0!==m&&(d.stopLoss.price=this.parseToNumeric(m)),void 0!==g&&(d.stopLoss.amount=this.parseToNumeric(g)),d=this.omit(d,["takeProfitType","takeProfitPriceType","takeProfitLimitPrice","takeProfitAmount","stopLossType","stopLossPriceType","stopLossLimitPrice","stopLossAmount"])}async createOrderWithTakeProfitAndStopLossWs(t,e,i,s,r=void 0,a=void 0,o=void 0,d={}){if(d=this.setTakeProfitAndStopLossParams(t,e,i,s,r,a,o,d),this.has.createOrderWithTakeProfitAndStopLossWs)return await this.createOrderWs(t,e,i,s,r,d);throw new n.NotSupported(this.id+" createOrderWithTakeProfitAndStopLossWs() is not supported yet")}async createOrders(t,e={}){throw new n.NotSupported(this.id+" createOrders() is not supported yet")}async editOrders(t,e={}){throw new n.NotSupported(this.id+" editOrders() is not supported yet")}async createOrderWs(t,e,i,s,r=void 0,a={}){throw new n.NotSupported(this.id+" createOrderWs() is not supported yet")}async cancelOrder(t,e=void 0,i={}){throw new n.NotSupported(this.id+" cancelOrder() is not supported yet")}async cancelOrderWithClientOrderId(t,e=void 0,i={}){const s=this.extend(i,{clientOrderId:t});return await this.cancelOrder("",e,s)}async cancelOrderWs(t,e=void 0,i={}){throw new n.NotSupported(this.id+" cancelOrderWs() is not supported yet")}async cancelOrders(t,e=void 0,i={}){throw new n.NotSupported(this.id+" cancelOrders() is not supported yet")}async cancelOrdersWithClientOrderIds(t,e=void 0,i={}){const s=this.extend(i,{clientOrderIds:t});return await this.cancelOrders([],e,s)}async cancelOrdersWs(t,e=void 0,i={}){throw new n.NotSupported(this.id+" cancelOrdersWs() is not supported yet")}async cancelAllOrders(t=void 0,e={}){throw new n.NotSupported(this.id+" cancelAllOrders() is not supported yet")}async cancelAllOrdersAfter(t,e={}){throw new n.NotSupported(this.id+" cancelAllOrdersAfter() is not supported yet")}async cancelOrdersForSymbols(t,e={}){throw new n.NotSupported(this.id+" cancelOrdersForSymbols() is not supported yet")}async cancelAllOrdersWs(t=void 0,e={}){throw new n.NotSupported(this.id+" cancelAllOrdersWs() is not supported yet")}async cancelUnifiedOrder(t,e={}){return this.cancelOrder(this.safeString(t,"id"),this.safeString(t,"symbol"),e)}async fetchOrders(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchOpenOrders&&this.has.fetchClosedOrders)throw new n.NotSupported(this.id+" fetchOrders() is not supported yet, consider using fetchOpenOrders() and fetchClosedOrders() instead");throw new n.NotSupported(this.id+" fetchOrders() is not supported yet")}async fetchOrdersWs(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchOrdersWs() is not supported yet")}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchOrderTrades() is not supported yet")}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchOrders() is not supported yet")}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchOrders){const r=await this.fetchOrders(t,e,i,s);return this.filterBy(r,"status","open")}throw new n.NotSupported(this.id+" fetchOpenOrders() is not supported yet")}async fetchOpenOrdersWs(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchOrdersWs){const r=await this.fetchOrdersWs(t,e,i,s);return this.filterBy(r,"status","open")}throw new n.NotSupported(this.id+" fetchOpenOrdersWs() is not supported yet")}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchOrders){const r=await this.fetchOrders(t,e,i,s);return this.filterBy(r,"status","closed")}throw new n.NotSupported(this.id+" fetchClosedOrders() is not supported yet")}async fetchCanceledAndClosedOrders(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchCanceledAndClosedOrders() is not supported yet")}async fetchClosedOrdersWs(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchOrdersWs){const r=await this.fetchOrdersWs(t,e,i,s);return this.filterBy(r,"status","closed")}throw new n.NotSupported(this.id+" fetchClosedOrdersWs() is not supported yet")}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchMyTrades() is not supported yet")}async fetchMyLiquidations(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchMyLiquidations() is not supported yet")}async fetchLiquidations(t,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchLiquidations() is not supported yet")}async fetchMyTradesWs(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchMyTradesWs() is not supported yet")}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" watchMyTrades() is not supported yet")}async fetchGreeks(t,e={}){throw new n.NotSupported(this.id+" fetchGreeks() is not supported yet")}async fetchAllGreeks(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchAllGreeks() is not supported yet")}async fetchOptionChain(t,e={}){throw new n.NotSupported(this.id+" fetchOptionChain() is not supported yet")}async fetchOption(t,e={}){throw new n.NotSupported(this.id+" fetchOption() is not supported yet")}async fetchConvertQuote(t,e,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchConvertQuote() is not supported yet")}async fetchDepositsWithdrawals(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchDepositsWithdrawals() is not supported yet")}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchDeposits() is not supported yet")}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchWithdrawals() is not supported yet")}async fetchDepositsWs(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchDepositsWs() is not supported yet")}async fetchWithdrawalsWs(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchWithdrawalsWs() is not supported yet")}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchFundingRateHistory() is not supported yet")}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchFundingHistory() is not supported yet")}async closePosition(t,e=void 0,i={}){throw new n.NotSupported(this.id+" closePosition() is not supported yet")}async closeAllPositions(t={}){throw new n.NotSupported(this.id+" closeAllPositions() is not supported yet")}async fetchL3OrderBook(t,e=void 0,i={}){throw new n.BadRequest(this.id+" fetchL3OrderBook() is not supported yet")}parseLastPrice(t,e=void 0){throw new n.NotSupported(this.id+" parseLastPrice() is not supported yet")}async fetchDepositAddress(t,e={}){if(this.has.fetchDepositAddresses){const i=await this.fetchDepositAddresses([t],e),s=this.safeValue(i,t);if(void 0===s)throw new n.InvalidAddress(this.id+" fetchDepositAddress() could not find a deposit address for "+t+", make sure you have created a corresponding deposit address in your wallet on the exchange website");return s}if(this.has.fetchDepositAddressesByNetwork){const i=this.safeString(e,"network");e=this.omit(e,"network");const s=await this.fetchDepositAddressesByNetwork(t,e);if(void 0!==i)return this.safeDict(s,i);{const t=Object.keys(s),e=this.safeString(t,0);return this.safeDict(s,e)}}throw new n.NotSupported(this.id+" fetchDepositAddress() is not supported yet")}account(){return{free:void 0,used:void 0,total:void 0}}commonCurrencyCode(t){return this.substituteCommonCurrencyCodes?this.safeString(this.commonCurrencies,t,t):t}currency(t){if(0===Object.keys(this.currencies).length)throw new n.ExchangeError(this.id+" currencies not loaded");if("string"==typeof t){if(t in this.currencies)return this.currencies[t];if(t in this.currencies_by_id)return this.currencies_by_id[t]}throw new n.ExchangeError(this.id+" does not have currency code "+t)}market(t){if(void 0===this.markets)throw new n.ExchangeError(this.id+" markets not loaded");if(t in this.markets)return this.markets[t];if(t in this.markets_by_id){const e=this.markets_by_id[t],i=this.safeString2(this.options,"defaultType","defaultSubType","spot");for(let t=0;t<e.length;t++){const s=e[t];if(s[i])return s}return e[0]}if(t.endsWith("-C")||t.endsWith("-P")||t.startsWith("C-")||t.startsWith("P-"))return this.createExpiredOptionMarket(t);throw new n.BadSymbol(this.id+" does not have market symbol "+t)}createExpiredOptionMarket(t){throw new n.NotSupported(this.id+" createExpiredOptionMarket () is not supported yet")}isLeveragedCurrency(t,e=!1,i=void 0){const s=["2L","2S","3L","3S","4L","4S","5L","5S","UP","DOWN","BULL","BEAR"];for(let r=0;r<s.length;r++){const a=s[r];if(t.endsWith(a)){if(!e)return!0;if(t.replace(a,"")in i)return!0}}return!1}handleWithdrawTagAndParams(t,e){return void 0!==t&&"object"==typeof t&&(e=this.extend(t,e),t=void 0),void 0===t&&void 0!==(t=this.safeString(e,"tag"))&&(e=this.omit(e,"tag")),[t,e]}async createLimitOrder(t,e,i,s,r={}){return await this.createOrder(t,"limit",e,i,s,r)}async createLimitOrderWs(t,e,i,s,r={}){return await this.createOrderWs(t,"limit",e,i,s,r)}async createMarketOrder(t,e,i,s=void 0,r={}){return await this.createOrder(t,"market",e,i,s,r)}async createMarketOrderWs(t,e,i,s=void 0,r={}){return await this.createOrderWs(t,"market",e,i,s,r)}async createLimitBuyOrder(t,e,i,s={}){return await this.createOrder(t,"limit","buy",e,i,s)}async createLimitBuyOrderWs(t,e,i,s={}){return await this.createOrderWs(t,"limit","buy",e,i,s)}async createLimitSellOrder(t,e,i,s={}){return await this.createOrder(t,"limit","sell",e,i,s)}async createLimitSellOrderWs(t,e,i,s={}){return await this.createOrderWs(t,"limit","sell",e,i,s)}async createMarketBuyOrder(t,e,i={}){return await this.createOrder(t,"market","buy",e,void 0,i)}async createMarketBuyOrderWs(t,e,i={}){return await this.createOrderWs(t,"market","buy",e,void 0,i)}async createMarketSellOrder(t,e,i={}){return await this.createOrder(t,"market","sell",e,void 0,i)}async createMarketSellOrderWs(t,e,i={}){return await this.createOrderWs(t,"market","sell",e,void 0,i)}costToPrecision(t,e){if(void 0===e)return;const i=this.market(t);return this.decimalToPrecision(e,ve,i.precision.price,this.precisionMode,this.paddingMode)}priceToPrecision(t,e){if(void 0===e)return;const i=this.market(t),s=this.decimalToPrecision(e,be,i.precision.price,this.precisionMode,this.paddingMode);if("0"===s)throw new n.InvalidOrder(this.id+" price of "+i.symbol+" must be greater than minimum price precision of "+this.numberToString(i.precision.price));return s}amountToPrecision(t,e){if(void 0===e)return;const i=this.market(t),s=this.decimalToPrecision(e,ve,i.precision.amount,this.precisionMode,this.paddingMode);if("0"===s)throw new n.InvalidOrder(this.id+" amount of "+i.symbol+" must be greater than minimum amount precision of "+this.numberToString(i.precision.amount));return s}feeToPrecision(t,e){if(void 0===e)return;const i=this.market(t);return this.decimalToPrecision(e,be,i.precision.price,this.precisionMode,this.paddingMode)}currencyToPrecision(t,e,i=void 0){const s=this.currencies[t];let r=this.safeValue(s,"precision");if(void 0!==i){const t=this.safeDict(s,"networks",{}),e=this.safeDict(t,i,{});r=this.safeValue(e,"precision",r)}if(void 0===r)return this.forceString(e);{const t=this.safeInteger(this.options,"currencyToPrecisionRoundingMode",be);return this.decimalToPrecision(e,t,r,this.precisionMode,this.paddingMode)}}forceString(t){return"string"!=typeof t?this.numberToString(t):t}isTickPrecision(){return this.precisionMode===ke}isDecimalPrecision(){return this.precisionMode===we}isSignificantPrecision(){return this.precisionMode===Oe}safeNumber(t,e,i=void 0){const s=this.safeString(t,e);return this.parseNumber(s,i)}safeNumberN(t,e,i=void 0){const s=this.safeStringN(t,e);return this.parseNumber(s,i)}parsePrecision(t){if(void 0===t)return;const e=parseInt(t);if(0===e)return"1";if(e>0){let t="0.";for(let i=0;i<e-1;i++)t+="0";return t+"1"}{let t="1";for(let i=0;i<-1*e-1;i++)t+="0";return t+"0"}}integerPrecisionToAmount(t){if(void 0!==t){if(o.Y.stringGe(t,"0"))return this.parsePrecision(t);{const e=o.Y.stringAbs(t),i=parseInt(e);let s="1";for(let t=0;t<i-1;t++)s+="0";return s+"0"}}}async loadTimeDifference(t={}){const e=await this.fetchTime(t),i=this.milliseconds();return this.options.timeDifference=i-e,this.options.timeDifference}implodeHostname(t){return this.implodeParams(t,{hostname:this.hostname})}async fetchMarketLeverageTiers(t,e={}){if(this.has.fetchLeverageTiers){if(!this.market(t).contract)throw new n.BadSymbol(this.id+" fetchMarketLeverageTiers() supports contract markets only");const e=await this.fetchLeverageTiers([t]);return this.safeValue(e,t)}throw new n.NotSupported(this.id+" fetchMarketLeverageTiers() is not supported yet")}async createPostOnlyOrder(t,e,i,s,r=void 0,a={}){if(!this.has.createPostOnlyOrder)throw new n.NotSupported(this.id+" createPostOnlyOrder() is not supported yet");const o=this.extend(a,{postOnly:!0});return await this.createOrder(t,e,i,s,r,o)}async createPostOnlyOrderWs(t,e,i,s,r=void 0,a={}){if(!this.has.createPostOnlyOrderWs)throw new n.NotSupported(this.id+" createPostOnlyOrderWs() is not supported yet");const o=this.extend(a,{postOnly:!0});return await this.createOrderWs(t,e,i,s,r,o)}async createReduceOnlyOrder(t,e,i,s,r=void 0,a={}){if(!this.has.createReduceOnlyOrder)throw new n.NotSupported(this.id+" createReduceOnlyOrder() is not supported yet");const o=this.extend(a,{reduceOnly:!0});return await this.createOrder(t,e,i,s,r,o)}async createReduceOnlyOrderWs(t,e,i,s,r=void 0,a={}){if(!this.has.createReduceOnlyOrderWs)throw new n.NotSupported(this.id+" createReduceOnlyOrderWs() is not supported yet");const o=this.extend(a,{reduceOnly:!0});return await this.createOrderWs(t,e,i,s,r,o)}async createStopOrder(t,e,i,s,r=void 0,a=void 0,o={}){if(!this.has.createStopOrder)throw new n.NotSupported(this.id+" createStopOrder() is not supported yet");if(void 0===a)throw new n.ArgumentsRequired(this.id+" create_stop_order() requires a stopPrice argument");const d=this.extend(o,{stopPrice:a});return await this.createOrder(t,e,i,s,r,d)}async createStopOrderWs(t,e,i,s,r=void 0,a=void 0,o={}){if(!this.has.createStopOrderWs)throw new n.NotSupported(this.id+" createStopOrderWs() is not supported yet");if(void 0===a)throw new n.ArgumentsRequired(this.id+" createStopOrderWs() requires a stopPrice argument");const d=this.extend(o,{stopPrice:a});return await this.createOrderWs(t,e,i,s,r,d)}async createStopLimitOrder(t,e,i,s,r,a={}){if(!this.has.createStopLimitOrder)throw new n.NotSupported(this.id+" createStopLimitOrder() is not supported yet");const o=this.extend(a,{stopPrice:r});return await this.createOrder(t,"limit",e,i,s,o)}async createStopLimitOrderWs(t,e,i,s,r,a={}){if(!this.has.createStopLimitOrderWs)throw new n.NotSupported(this.id+" createStopLimitOrderWs() is not supported yet");const o=this.extend(a,{stopPrice:r});return await this.createOrderWs(t,"limit",e,i,s,o)}async createStopMarketOrder(t,e,i,s,r={}){if(!this.has.createStopMarketOrder)throw new n.NotSupported(this.id+" createStopMarketOrder() is not supported yet");const a=this.extend(r,{stopPrice:s});return await this.createOrder(t,"market",e,i,void 0,a)}async createStopMarketOrderWs(t,e,i,s,r={}){if(!this.has.createStopMarketOrderWs)throw new n.NotSupported(this.id+" createStopMarketOrderWs() is not supported yet");const a=this.extend(r,{stopPrice:s});return await this.createOrderWs(t,"market",e,i,void 0,a)}async createSubAccount(t,e={}){throw new n.NotSupported(this.id+" createSubAccount() is not supported yet")}safeCurrencyCode(t,e=void 0){return(e=this.safeCurrency(t,e)).code}filterBySymbolSinceLimit(t,e=void 0,i=void 0,s=void 0,r=!1){return this.filterByValueSinceLimit(t,"symbol",e,i,s,"timestamp",r)}filterByCurrencySinceLimit(t,e=void 0,i=void 0,s=void 0,r=!1){return this.filterByValueSinceLimit(t,"currency",e,i,s,"timestamp",r)}filterBySymbolsSinceLimit(t,e=void 0,i=void 0,s=void 0,r=!1){const a=this.filterByArray(t,"symbol",e,!1);return this.filterBySinceLimit(a,i,s,"timestamp",r)}parseLastPrices(t,e=void 0,i={}){const s=[];if(Array.isArray(t))for(let e=0;e<t.length;e++){const r=this.extend(this.parseLastPrice(t[e]),i);s.push(r)}else{const e=Object.keys(t);for(let r=0;r<e.length;r++){const a=e[r],n=this.safeMarket(a),o=this.extend(this.parseLastPrice(t[a],n),i);s.push(o)}}return e=this.marketSymbols(e),this.filterByArray(s,"symbol",e)}parseTickers(t,e=void 0,i={}){const s=[];if(Array.isArray(t))for(let e=0;e<t.length;e++){const r=this.parseTicker(t[e]),a=this.extend(r,i);s.push(a)}else{const e=Object.keys(t);for(let r=0;r<e.length;r++){const a=e[r],n=this.safeMarket(a),o=this.parseTicker(t[a],n),d=this.extend(o,i);s.push(d)}}return e=this.marketSymbols(e),this.filterByArray(s,"symbol",e)}parseDepositAddresses(t,e=void 0,i=!0,s={}){let r=[];for(let e=0;e<t.length;e++){const i=this.extend(this.parseDepositAddress(t[e]),s);r.push(i)}return void 0!==e&&(r=this.filterByArray(r,"currency",e,!1)),i&&(r=this.filterByArray(r,"currency",void 0,i)),r}parseBorrowInterests(t,e=void 0){const i=[];for(let s=0;s<t.length;s++){const r=t[s];i.push(this.parseBorrowInterest(r,e))}return i}parseBorrowRate(t,e=void 0){throw new n.NotSupported(this.id+" parseBorrowRate() is not supported yet")}parseBorrowRateHistory(t,e,i,s){const r=[];for(let e=0;e<t.length;e++){const i=t[e],s=this.parseBorrowRate(i);r.push(s)}const a=this.sortBy(r,"timestamp");return this.filterByCurrencySinceLimit(a,e,i,s)}parseIsolatedBorrowRates(t){const e={};for(let i=0;i<t.length;i++){const s=t[i],r=this.parseIsolatedBorrowRate(s);e[this.safeString(r,"symbol")]=r}return e}parseFundingRateHistories(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i];r.push(this.parseFundingRateHistory(s,e))}const a=this.sortBy(r,"timestamp"),n=void 0===e?void 0:e.symbol;return this.filterBySymbolSinceLimit(a,n,i,s)}safeSymbol(t,e=void 0,i=void 0,s=void 0){return(e=this.safeMarket(t,e,i,s)).symbol}parseFundingRate(t,e=void 0){throw new n.NotSupported(this.id+" parseFundingRate() is not supported yet")}parseFundingRates(t,e=void 0){const i={};for(let e=0;e<t.length;e++){const s=t[e],r=this.parseFundingRate(s);i[r.symbol]=r}return this.filterByArray(i,"symbol",e)}parseLongShortRatio(t,e=void 0){throw new n.NotSupported(this.id+" parseLongShortRatio() is not supported yet")}parseLongShortRatioHistory(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i];r.push(this.parseLongShortRatio(s,e))}const a=this.sortBy(r,"timestamp"),n=void 0===e?void 0:e.symbol;return this.filterBySymbolSinceLimit(a,n,i,s)}handleTriggerPricesAndParams(t,e,i=!0){const s=this.safeString2(e,"triggerPrice","stopPrice");let r;const a=this.safeString(e,"stopLossPrice");let n;const o=this.safeString(e,"takeProfitPrice");let d;return void 0!==s&&(i&&(e=this.omit(e,["triggerPrice","stopPrice"])),r=this.priceToPrecision(t,parseFloat(s))),void 0!==a&&(i&&(e=this.omit(e,"stopLossPrice")),n=this.priceToPrecision(t,parseFloat(a))),void 0!==o&&(i&&(e=this.omit(e,"takeProfitPrice")),d=this.priceToPrecision(t,parseFloat(o))),[r,n,d,e]}handleTriggerDirectionAndParams(t,e=void 0,i=!1){let s=this.safeString(t,"triggerDirection");const r=void 0!==e&&e in t;if(void 0!==s&&(t=this.omit(t,"triggerDirection")),!this.inArray(s,["ascending","descending","up","down","above","below"])&&!r&&!i)throw new n.ArgumentsRequired(this.id+' createOrder() : trigger orders require params["triggerDirection"] to be either "ascending" or "descending"');return"up"===s||"above"===s?s="ascending":"down"!==s&&"below"!==s||(s="descending"),[s,t]}handleTriggerAndParams(t){const e=this.safeBool2(t,"trigger","stop");return e&&(t=this.omit(t,["trigger","stop"])),[e,t]}isTriggerOrder(t){return this.handleTriggerAndParams(t)}isPostOnly(t,e,i={}){const s=this.safeStringUpper(i,"timeInForce");let r=this.safeBool2(i,"postOnly","post_only",!1);if(r=r||"PO"===s||e,r){if("IOC"===s||"FOK"===s)throw new n.InvalidOrder(this.id+" postOnly orders cannot have timeInForce equal to "+s);if(t)throw new n.InvalidOrder(this.id+" market orders cannot be postOnly");return!0}return!1}handlePostOnly(t,e,i={}){const s=this.safeStringUpper(i,"timeInForce");let r=this.safeBool(i,"postOnly",!1);const a="PO"===s;if(r=r||a||e,r){if("IOC"===s||"FOK"===s)throw new n.InvalidOrder(this.id+" postOnly orders cannot have timeInForce equal to "+s);if(t)throw new n.InvalidOrder(this.id+" market orders cannot be postOnly");return a&&(i=this.omit(i,"timeInForce")),[!0,i=this.omit(i,"postOnly")]}return[!1,i]}async fetchLastPrices(t=void 0,e={}){throw new n.NotSupported(this.id+" fetchLastPrices() is not supported yet")}async fetchTradingFees(t={}){throw new n.NotSupported(this.id+" fetchTradingFees() is not supported yet")}async fetchTradingFeesWs(t={}){throw new n.NotSupported(this.id+" fetchTradingFeesWs() is not supported yet")}async fetchTradingFee(t,e={}){if(!this.has.fetchTradingFees)throw new n.NotSupported(this.id+" fetchTradingFee() is not supported yet");const i=await this.fetchTradingFees(e);return this.safeDict(i,t)}async fetchConvertCurrencies(t={}){throw new n.NotSupported(this.id+" fetchConvertCurrencies() is not supported yet")}parseOpenInterest(t,e=void 0){throw new n.NotSupported(this.id+" parseOpenInterest () is not supported yet")}parseOpenInterests(t,e=void 0){const i={};for(let e=0;e<t.length;e++){const s=t[e],r=this.parseOpenInterest(s);i[r.symbol]=r}return this.filterByArray(i,"symbol",e)}parseOpenInterestsHistory(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i],a=this.parseOpenInterest(s,e);r.push(a)}const a=this.sortBy(r,"timestamp"),n=this.safeString(e,"symbol");return this.filterBySymbolSinceLimit(a,n,i,s)}async fetchFundingRate(t,e={}){if(this.has.fetchFundingRates){await this.loadMarkets();const i=this.market(t);if(t=i.symbol,!i.contract)throw new n.BadSymbol(this.id+" fetchFundingRate() supports contract markets only");const s=await this.fetchFundingRates([t],e),r=this.safeValue(s,t);if(void 0===r)throw new n.NullResponse(this.id+" fetchFundingRate () returned no data for "+t);return r}throw new n.NotSupported(this.id+" fetchFundingRate () is not supported yet")}async fetchFundingInterval(t,e={}){if(this.has.fetchFundingIntervals){await this.loadMarkets();const i=this.market(t);if(t=i.symbol,!i.contract)throw new n.BadSymbol(this.id+" fetchFundingInterval() supports contract markets only");const s=await this.fetchFundingIntervals([t],e),r=this.safeValue(s,t);if(void 0===r)throw new n.NullResponse(this.id+" fetchFundingInterval() returned no data for "+t);return r}throw new n.NotSupported(this.id+" fetchFundingInterval() is not supported yet")}async fetchMarkOHLCV(t,e="1m",i=void 0,s=void 0,r={}){if(this.has.fetchMarkOHLCV){const a={price:"mark"};return await this.fetchOHLCV(t,e,i,s,this.extend(a,r))}throw new n.NotSupported(this.id+" fetchMarkOHLCV () is not supported yet")}async fetchIndexOHLCV(t,e="1m",i=void 0,s=void 0,r={}){if(this.has.fetchIndexOHLCV){const a={price:"index"};return await this.fetchOHLCV(t,e,i,s,this.extend(a,r))}throw new n.NotSupported(this.id+" fetchIndexOHLCV () is not supported yet")}async fetchPremiumIndexOHLCV(t,e="1m",i=void 0,s=void 0,r={}){if(this.has.fetchPremiumIndexOHLCV){const a={price:"premiumIndex"};return await this.fetchOHLCV(t,e,i,s,this.extend(a,r))}throw new n.NotSupported(this.id+" fetchPremiumIndexOHLCV () is not supported yet")}handleTimeInForce(t={}){const e=this.safeStringUpper(t,"timeInForce");if(void 0!==e){const t=this.safeString(this.options.timeInForce,e);if(void 0===t)throw new n.ExchangeError(this.id+' does not support timeInForce "'+e+'"');return t}}convertTypeToAccount(t){const e=this.safeDict(this.options,"accountsByType",{}),i=t.toLowerCase();if(i in e)return e[i];if(t in this.markets||t in this.markets_by_id){return this.market(t).id}return t}checkRequiredArgument(t,e,i,s=[]){const r=s.length;if(void 0===e||r>0&&!this.inArray(e,s)){const e=s.join(", ");let r=this.id+" "+t+"() requires a "+i+" argument";throw""!==e&&(r+=", one of ("+e+")"),new n.ArgumentsRequired(r)}}checkRequiredMarginArgument(t,e,i){if("isolated"===i&&void 0===e)throw new n.ArgumentsRequired(this.id+" "+t+"() requires a symbol argument for isolated margin");if("cross"===i&&void 0!==e)throw new n.ArgumentsRequired(this.id+" "+t+"() cannot have a symbol argument for cross margin")}parseDepositWithdrawFees(t,e=void 0,i=void 0){const s={},r=Array.isArray(t);let a=t;r||(a=Object.keys(t));for(let n=0;n<a.length;n++){const o=a[n],d=r?o:t[o],c=r?this.safeString(d,i):o,h=this.safeCurrency(c),l=this.safeString(h,"code");(void 0===e||this.inArray(l,e))&&(s[l]=this.parseDepositWithdrawFee(d,h))}return s}parseDepositWithdrawFee(t,e=void 0){throw new n.NotSupported(this.id+" parseDepositWithdrawFee() is not supported yet")}depositWithdrawFee(t){return{info:t,withdraw:{fee:void 0,percentage:void 0},deposit:{fee:void 0,percentage:void 0},networks:{}}}assignDefaultDepositWithdrawFees(t,e=void 0){const i=Object.keys(t.networks),s=i.length;if(1===s)return t.withdraw=t.networks[i[0]].withdraw,t.deposit=t.networks[i[0]].deposit,t;const r=this.safeString(e,"code");for(let e=0;e<s;e++){i[e]===r&&(t.withdraw=t.networks[i[e]].withdraw,t.deposit=t.networks[i[e]].deposit)}return t}parseIncome(t,e=void 0){throw new n.NotSupported(this.id+" parseIncome () is not supported yet")}parseIncomes(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i],a=this.parseIncome(s,e);r.push(a)}const a=this.sortBy(r,"timestamp"),n=this.safeString(e,"symbol");return this.filterBySymbolSinceLimit(a,n,i,s)}getMarketFromSymbols(t=void 0){if(void 0===t)return;const e=this.safeString(t,0);return this.market(e)}parseWsOHLCVs(t,e=void 0,i="1m",s=void 0,r=void 0){const a=[];for(let i=0;i<t.length;i++)a.push(this.parseWsOHLCV(t[i],e));return a}async fetchTransactions(t=void 0,e=void 0,i=void 0,s={}){if(this.has.fetchDepositsWithdrawals)return await this.fetchDepositsWithdrawals(t,e,i,s);throw new n.NotSupported(this.id+" fetchTransactions () is not supported yet")}filterByArrayPositions(t,e,i=void 0,s=!0){return this.filterByArray(t,e,i,s)}filterByArrayTickers(t,e,i=void 0,s=!0){return this.filterByArray(t,e,i,s)}createOHLCVObject(t,e,i){const s={};return s[t]={},s[t][e]=i,s}handleMaxEntriesPerRequestAndParams(t,e=void 0,i={}){let s;return[s,i]=this.handleOptionAndParams(i,t,"maxEntriesPerRequest"),void 0!==s&&s!==e&&(e=s),void 0===e&&(e=1e3),[e,i]}async fetchPaginatedCallDynamic(t,e=void 0,i=void 0,s=void 0,r={},a=void 0,o=!0){let d,c,h,l;[d,r]=this.handleOptionAndParams(r,t,"paginationCalls",10),[c,r]=this.handleOptionAndParams(r,t,"maxRetries",3),[h,r]=this.handleOptionAndParams(r,t,"paginationDirection","backward");let u=o;[u,r]=this.handleOptionAndParams(r,t,"removeRepeated",o);let p=0,f=[],m=0;const g=this.safeIntegerN(r,["until","untill","till"]);if([a,r]=this.handleMaxEntriesPerRequestAndParams(t,a,r),"forward"===h){if(void 0===i)throw new n.ArgumentsRequired(this.id+" pagination requires a since argument when paginationDirection set to forward");l=i}for(;p<d;){p+=1;try{if("backward"===h){void 0!==l&&(r.until=l-1);const s=await this[t](e,void 0,a,r),n=s.length;if(this.verbose){let e="Dynamic pagination call "+this.numberToString(p)+" method "+t+" response length "+this.numberToString(n);void 0!==l&&(e+=" timestamp "+this.numberToString(l)),this.log(e)}if(0===n)break;m=0,f=this.arrayConcat(f,s);const o=this.safeValue(s,0);if(l=this.safeInteger2(o,"timestamp",0),void 0!==i&&l<=i)break}else{const i=await this[t](e,l,a,r),s=i.length;if(this.verbose){let e="Dynamic pagination call "+this.numberToString(p)+" method "+t+" response length "+this.numberToString(s);void 0!==l&&(e+=" timestamp "+this.numberToString(l)),this.log(e)}if(0===s)break;m=0,f=this.arrayConcat(f,i);const n=this.safeValue(i,s-1);if(l=this.safeInteger(n,"timestamp")+1,void 0!==g&&l>=g)break}}catch(t){if(m+=1,m>c)throw t}}let y=f;u&&(y=this.removeRepeatedElementsFromArray(f));const v="fetchOHLCV"===t?0:"timestamp";return this.filterBySinceLimit(y,i,s,v)}async safeDeterministicCall(t,e=void 0,i=void 0,s=void 0,r=void 0,a={}){let o;[o,a]=this.handleOptionAndParams(a,t,"maxRetries",3);let d=0;for(;d<=o;)try{return r&&"fetchFundingRateHistory"!==t?await this[t](e,r,i,s,a):await this[t](e,i,s,a)}catch(t){if(t instanceof n.RateLimitExceeded)throw t;if(d+=1,d>o)throw t}return[]}async fetchPaginatedCallDeterministic(t,e=void 0,i=void 0,s=void 0,r=void 0,a={},o=void 0){let d;[d,a]=this.handleOptionAndParams(a,t,"paginationCalls",10),[o,a]=this.handleMaxEntriesPerRequestAndParams(t,o,a);const c=this.milliseconds(),h=[],l=1e3*this.parseTimeframe(r)*o;let u=c-d*l-1;u=void 0!==i?Math.max(u,i):Math.max(u,1241440531e3);const p=this.safeInteger2(a,"until","till");if(void 0!==p){const t=Math.ceil((p-i)/l);if(t>d)throw new n.BadRequest(this.id+" the number of required calls is greater than the max number of calls allowed, either increase the paginationCalls or decrease the since-until gap. Current paginationCalls limit is "+d.toString()+" required calls is "+t.toString())}for(let i=0;i<d&&!(void 0!==p&&u>=p)&&!(u>=c);i++)h.push(this.safeDeterministicCall(t,e,u,o,r,a)),u=this.sum(u,l)-1;const f=await Promise.all(h);let m=[];for(let t=0;t<f.length;t++)m=this.arrayConcat(m,f[t]);const g=this.removeRepeatedElementsFromArray(m),y="fetchOHLCV"===t?0:"timestamp";return this.filterBySinceLimit(g,i,s,y)}async fetchPaginatedCallCursor(t,e=void 0,i=void 0,s=void 0,r={},a=void 0,n=void 0,o=void 0,d=void 0){let c,h,l;[c,r]=this.handleOptionAndParams(r,t,"paginationCalls",10),[h,r]=this.handleOptionAndParams(r,t,"maxRetries",3),[d,r]=this.handleMaxEntriesPerRequestAndParams(t,d,r);let u=0,p=0,f=[];const m=this.safeString(r,"timeframe");for(r=this.omit(r,"timeframe");u<c;){try{let s;void 0!==l&&(void 0!==o&&(l=this.parseToInt(l)+o),r[n]=l),s="fetchAccounts"===t?await this[t](r):"getLeverageTiersPaginated"===t||"fetchPositions"===t?await this[t](e,r):"fetchOpenInterestHistory"===t?await this[t](e,m,i,d,r):await this[t](e,i,d,r),p=0;const c=s.length;if(this.verbose){const e=void 0===l?"":l,i="Cursor pagination call "+(u+1).toString()+" method "+t+" response length "+c.toString()+" cursor "+e;this.log(i)}if(0===c)break;f=this.arrayConcat(f,s);const h=this.safeDict(s,c-1);l=void 0;for(let t=0;t<c;t++){const e=c-t-1,i=this.safeDict(s,e),r=this.safeDict(i,"info"),n=this.safeValue(r,a);if(void 0!==n){l=n;break}}if(void 0===l)break;const g=this.safeInteger(h,"timestamp");if(void 0!==g&&g<i)break}catch(t){if(p+=1,p>h)throw t}u+=1}const g=this.sortCursorPaginatedResult(f),y="fetchOHLCV"===t?0:"timestamp";return this.filterBySinceLimit(g,i,s,y)}async fetchPaginatedCallIncremental(t,e=void 0,i=void 0,s=void 0,r={},a=void 0,n=void 0){let o,d;[o,r]=this.handleOptionAndParams(r,t,"paginationCalls",10),[d,r]=this.handleOptionAndParams(r,t,"maxRetries",3),[n,r]=this.handleMaxEntriesPerRequestAndParams(t,n,r);let c=0,h=0,l=[];for(;c<o;){try{r[a]=c+1;const s=await this[t](e,i,n,r);h=0;const o=s.length;if(this.verbose){const e="Incremental pagination call "+(c+1).toString()+" method "+t+" response length "+o.toString();this.log(e)}if(0===o)break;l=this.arrayConcat(l,s)}catch(t){if(h+=1,h>d)throw t}c+=1}const u=this.sortCursorPaginatedResult(l),p="fetchOHLCV"===t?0:"timestamp";return this.filterBySinceLimit(u,i,s,p)}sortCursorPaginatedResult(t){const e=this.safeValue(t,0);if(void 0!==e){if("timestamp"in e)return this.sortBy(t,"timestamp",!0);if("id"in e)return this.sortBy(t,"id",!0)}return t}removeRepeatedElementsFromArray(t,e=!0){const i={},s=[];for(let r=0;r<t.length;r++){const a=t[r],n=e?this.safeStringN(a,["id","timestamp",0]):this.safeString(a,"id");void 0===n||n in i||(i[n]=1,s.push(a))}return s.length>0?s:t}removeRepeatedTradesFromArray(t){const e={};for(let i=0;i<t.length;i++){const s=t[i];let r=this.safeString(s,"id");if(void 0===r){const t=this.safeString(s,"price"),e=this.safeString(s,"amount"),i=this.safeString(s,"timestamp"),a=this.safeString(s,"side");r="t_"+i.toString()+"_"+a+"_"+t+"_"+e}void 0===r||r in e||(e[r]=s)}return Object.values(e)}removeKeysFromDict(t,e){const i=Object.keys(t),s={};for(let r=0;r<i.length;r++){const a=i[r];this.inArray(a,e)||(s[a]=t[a])}return s}handleUntilOption(t,e,i,s=1){const r=this.safeInteger2(i,"until","till");return void 0!==r&&(e[t]=this.parseToInt(r*s),i=this.omit(i,["until","till"])),[e,i]}safeOpenInterest(t,e=void 0){let i=this.safeString(t,"symbol");return void 0===i&&(i=this.safeString(e,"symbol")),this.extend(t,{symbol:i,baseVolume:this.safeNumber(t,"baseVolume"),quoteVolume:this.safeNumber(t,"quoteVolume"),openInterestAmount:this.safeNumber(t,"openInterestAmount"),openInterestValue:this.safeNumber(t,"openInterestValue"),timestamp:this.safeInteger(t,"timestamp"),datetime:this.safeString(t,"datetime"),info:this.safeValue(t,"info")})}parseLiquidation(t,e=void 0){throw new n.NotSupported(this.id+" parseLiquidation () is not supported yet")}parseLiquidations(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i],a=this.parseLiquidation(s,e);r.push(a)}const a=this.sortBy(r,"timestamp"),n=this.safeString(e,"symbol");return this.filterBySymbolSinceLimit(a,n,i,s)}parseGreeks(t,e=void 0){throw new n.NotSupported(this.id+" parseGreeks () is not supported yet")}parseAllGreeks(t,e=void 0,i={}){const s=[];if(Array.isArray(t))for(let e=0;e<t.length;e++){const r=this.parseGreeks(t[e]),a=this.extend(r,i);s.push(a)}else{const e=Object.keys(t);for(let r=0;r<e.length;r++){const a=e[r],n=this.safeMarket(a),o=this.parseGreeks(t[a],n),d=this.extend(o,i);s.push(d)}}return e=this.marketSymbols(e),this.filterByArray(s,"symbol",e)}parseOption(t,e=void 0,i=void 0){throw new n.NotSupported(this.id+" parseOption () is not supported yet")}parseOptionChain(t,e=void 0,i=void 0){const s={};for(let r=0;r<t.length;r++){const a=t[r],n=this.safeString(a,e),o=this.safeCurrency(n),d=this.safeString(a,i),c=this.safeMarket(d,void 0,void 0,"option");s[c.symbol]=this.parseOption(a,o,c)}return s}parseMarginModes(t,e=void 0,i=void 0,s=void 0){const r={};void 0===s&&(s="swap");for(let a=0;a<t.length;a++){const n=t[a],o=this.safeString(n,i),d=this.safeMarket(o,void 0,void 0,s);(void 0===e||this.inArray(d.symbol,e))&&(r[d.symbol]=this.parseMarginMode(n,d))}return r}parseMarginMode(t,e=void 0){throw new n.NotSupported(this.id+" parseMarginMode () is not supported yet")}parseLeverages(t,e=void 0,i=void 0,s=void 0){const r={};void 0===s&&(s="swap");for(let a=0;a<t.length;a++){const n=t[a],o=this.safeString(n,i),d=this.safeMarket(o,void 0,void 0,s);(void 0===e||this.inArray(d.symbol,e))&&(r[d.symbol]=this.parseLeverage(n,d))}return r}parseLeverage(t,e=void 0){throw new n.NotSupported(this.id+" parseLeverage () is not supported yet")}parseConversions(t,e=void 0,i=void 0,s=void 0,r=void 0,a=void 0,n={}){t=this.toArray(t);const o=[];let d,c;for(let e=0;e<t.length;e++){const r=t[e],a=this.safeString(r,i),h=this.safeString(r,s);void 0!==a&&(d=this.safeCurrency(a)),void 0!==h&&(c=this.safeCurrency(h));const l=this.extend(this.parseConversion(r,d,c),n);o.push(l)}const h=this.sortBy(o,"timestamp");let l;if(void 0!==e&&(l=this.safeCurrency(e),e=l.code),void 0===e)return this.filterBySinceLimit(h,r,a);const u=this.filterBy(h,"fromCurrency",e),p=this.filterBy(h,"toCurrency",e),f=this.arrayConcat(u,p);return this.filterBySinceLimit(f,r,a)}parseConversion(t,e=void 0,i=void 0){throw new n.NotSupported(this.id+" parseConversion () is not supported yet")}convertExpireDate(t){return"20"+t.slice(0,2)+"-"+t.slice(2,4)+"-"+t.slice(4,6)+"T00:00:00Z"}convertExpireDateToMarketIdDate(t){const e=t.slice(0,2),i=t.slice(2,4);let s;"01"===i?s="JAN":"02"===i?s="FEB":"03"===i?s="MAR":"04"===i?s="APR":"05"===i?s="MAY":"06"===i?s="JUN":"07"===i?s="JUL":"08"===i?s="AUG":"09"===i?s="SEP":"10"===i?s="OCT":"11"===i?s="NOV":"12"===i&&(s="DEC");return t.slice(4,6)+s+e}convertMarketIdExpireDate(t){6===t.length&&(t="0"+t);const e=t.slice(0,2),i=t.slice(2,5),s=this.safeString({JAN:"01",FEB:"02",MAR:"03",APR:"04",MAY:"05",JUN:"06",JUL:"07",AUG:"08",SEP:"09",OCT:"10",NOV:"11",DEC:"12"},i);return t.slice(5,7)+s+e}async fetchPositionHistory(t,e=void 0,i=void 0,s={}){if(this.has.fetchPositionsHistory){return await this.fetchPositionsHistory([t],e,i,s)}throw new n.NotSupported(this.id+" fetchPositionHistory () is not supported yet")}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchPositionsHistory () is not supported yet")}parseMarginModification(t,e=void 0){throw new n.NotSupported(this.id+" parseMarginModification() is not supported yet")}parseMarginModifications(t,e=void 0,i=void 0,s=void 0){const r=[];for(let a=0;a<t.length;a++){const n=t[a],o=this.safeString(n,i),d=this.safeMarket(o,void 0,void 0,s);(void 0===e||this.inArray(d.symbol,e))&&r.push(this.parseMarginModification(n,d))}return r}async fetchTransfer(t,e=void 0,i={}){throw new n.NotSupported(this.id+" fetchTransfer () is not supported yet")}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){throw new n.NotSupported(this.id+" fetchTransfers () is not supported yet")}async unWatchOHLCV(t,e="1m",i={}){throw new n.NotSupported(this.id+" unWatchOHLCV () is not supported yet")}async watchMarkPrice(t,e={}){throw new n.NotSupported(this.id+" watchMarkPrice () is not supported yet")}async watchMarkPrices(t=void 0,e={}){throw new n.NotSupported(this.id+" watchMarkPrices () is not supported yet")}async withdrawWs(t,e,i,s=void 0,r={}){throw new n.NotSupported(this.id+" withdrawWs () is not supported yet")}async unWatchMyTrades(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchMyTrades () is not supported yet")}async createOrdersWs(t,e={}){throw new n.NotSupported(this.id+" createOrdersWs () is not supported yet")}async fetchOrdersByStatusWs(t,e=void 0,i=void 0,s=void 0,r={}){throw new n.NotSupported(this.id+" fetchOrdersByStatusWs () is not supported yet")}async unWatchBidsAsks(t=void 0,e={}){throw new n.NotSupported(this.id+" unWatchBidsAsks () is not supported yet")}cleanUnsubscription(t,e,i,s=!1){if(i in t.subscriptions&&delete t.subscriptions[i],s){const i=Object.keys(t.subscriptions);for(let s=0;s<i.length;s++){const r=i[s];r.startsWith(e)&&delete t.subscriptions[r]}const s=Object.keys(t.futures);for(let i=0;i<s.length;i++){const r=s[i];if(r.startsWith(e)){const e=new n.UnsubscribeError(this.id+" "+r);t.reject(e,r)}}}else if(e in t.subscriptions&&delete t.subscriptions[e],e in t.futures){const i=new n.UnsubscribeError(this.id+" "+e);t.reject(i,e)}t.resolve(!0,i)}cleanCache(t){const e=this.safeString(t,"topic"),i=this.safeList(t,"symbols",[]),s=i.length;if("ohlcv"===e){const e=this.safeList(t,"symbolsAndTimeframes",[]);for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString(i,0),r=this.safeString(i,1);void 0!==this.ohlcvs&&s in this.ohlcvs&&r in this.ohlcvs[s]&&delete this.ohlcvs[s][r]}}else if(s>0)for(let t=0;t<i.length;t++){const s=i[t];"trades"===e?s in this.trades&&delete this.trades[s]:"orderbook"===e?s in this.orderbooks&&delete this.orderbooks[s]:"ticker"===e?s in this.tickers&&delete this.tickers[s]:"bidsasks"===e&&s in this.bidsasks&&delete this.bidsasks[s]}else if("myTrades"===e&&void 0!==this.myTrades)this.myTrades=void 0;else if("orders"===e&&void 0!==this.orders)this.orders=void 0;else if("positions"===e&&void 0!==this.positions){this.positions=void 0;const t=Object.values(this.clients);for(let e=0;e<t.length;e++){const i=t[e].futures;void 0!==i&&"fetchPositionsSnapshot"in i&&delete i.fetchPositionsSnapshot}}else if("ticker"!==e&&"markPrice"!==e||void 0===this.tickers){if("bidsasks"===e&&void 0!==this.bidsasks){const t=Object.keys(this.bidsasks);for(let e=0;e<t.length;e++){const i=t[e];i in this.bidsasks&&delete this.bidsasks[i]}}}else{const t=Object.keys(this.tickers);for(let e=0;e<t.length;e++){const i=t[e];i in this.tickers&&delete this.tickers[i]}}}}},3168(t,e,i){"use strict";i.d(e,{k:()=>a});var s=i(9073),r=i(4176);class a extends r.Ue{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){const i=s.V.dereference(e,"bool");return t.writeValue(i?1:0)}decode(t){return!!t.readValue()}}},3187(t,e,i){"use strict";i.d(e,{$u:()=>A,Dq:()=>L,Ef:()=>U,NO:()=>N,_S:()=>w,b:()=>I,pd:()=>j});var s=i(8432),r=i(4852),a=i(1094),n=i(1064),o=i(1357),d=i(2442),c=i(191),h=i(1999);
/*! scure-starknet - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const l=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),u=BigInt("0x800000000000000000000000000000000000000000000000000000000000000");function p(t){for(;0===t[0];)t=t.subarray(1);const e=8*t.length-252,i=c.Ph(t);return e>0?i>>BigInt(e):i}function f(t){return"string"==typeof t&&1&(t=_(t)).length&&(t="0"+t),c.aT(t)}const m=(0,d.x3)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,n.Fp)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:l,nBitLength:252,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,h.Z)(r.s),bits2int:p,bits2int_modN:t=>{const e=c.Ph(t).toString(16);return 63===e.length&&(t=f(e+"0")),(0,n.zi)(p(t),l)}});function g(t){return c.qj("","string"==typeof t?f(t):t)}function y(t){return c.My(g(t)).padStart(64,"0")}function v(t){const{r:e,s:i}=t;if(e<0n||e>=u)throw new Error(`Signature.r should be [1, ${u})`);const s=(0,n.B8)(i,l);if(s<0n||s>=u)throw new Error(`inv(Signature.s) should be [1, ${u})`)}function b(t){const e=g(t);if(c.Ph(e)>=u)throw new Error(`msgHash should be [0, ${u})`);return e}function w(t,e,i){const s=m.sign(b(t),y(e),i);return v(s),s}const{CURVE:S,ProjectivePoint:k,Signature:O,utils:T}=m;function P(t){return`0x${c.My(t.subarray(1)).replace(/^0+/gm,"")}`}function _(t){return t.replace(/^0x/i,"")}function A(t){return P(function(t,e=!1){return m.getPublicKey(y(t),e)}(t,!0))}function I(t){if(130!==(t=_(t)).length)throw new Error("Wrong ethereum signature");return function(t){const e=g(t),i=2n**256n,s=i-(0,n.zi)(i,l);for(let t=0;;t++){const i=D(c.Id(e,c.IV(BigInt(t))));if(i<s)return(0,n.zi)(i,l).toString(16);if(1e5===t)throw new Error("grindKey is broken: tried 100k vals")}}(t.substring(0,64))}const x=[new k(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new k(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new k(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new k(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new k(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function E(t,e){const i=[];let s=t;for(let t=0;t<248;t++)i.push(s),s=s.double();s=e;for(let t=0;t<4;t++)i.push(s),s=s.double();return i}const M=E(x[1],x[2]),C=E(x[3],x[4]);function B(t,e,i){let s=function(t){let e;if("bigint"==typeof t)e=t;else if("number"==typeof t){if(!Number.isSafeInteger(t))throw new Error(`Invalid pedersenArg: ${t}`);e=BigInt(t)}else e=c.Ph(g(t));if(!(0n<=e&&e<m.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${e}`);return e}(e);for(let e=0;e<252;e++){const r=i[e];if(!r)throw new Error("invalid constant index");if(r.equals(t))throw new Error("Same point");0n!=(1n&s)&&(t=t.add(r)),s>>=1n}return t}function N(t,e){let i=x[0];return i=B(i,t,M),i=B(i,e,C),P(i.toRawBytes(!0))}const R=c.OG(250),L=t=>c.Ph((0,s.lY)(t))&R,D=t=>c.Ph((0,r.s)(t));function q(t,e,i){const s=t.fromBytes((0,r.s)((0,a.AI)(`${e}${i}`)));return t.create(s)}function F(t,e){if((0,n.jr)(t.Fp),!Number.isSafeInteger(t.rate)||!Number.isSafeInteger(t.capacity))throw new Error(`Wrong poseidon opts: ${t}`);const i=t.rate+t.capacity,s=t.roundsFull+t.roundsPartial,r=[];for(let e=0;e<s;e++){const s=[];for(let r=0;r<i;r++)s.push(q(t.Fp,"Hades",i*e+r));r.push(s)}const a=(0,o.sN)({...t,t:i,sboxPower:3,reversePartialPowIdx:!0,mds:e,roundConstants:r});return a.m=i,a.rate=t.rate,a.capacity=t.capacity,a}const V=F({Fp:(0,n.Fp)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481")),rate:2,capacity:1,roundsFull:8,roundsPartial:83},[[3,1,1],[1,-1,1],[1,1,-2]].map(t=>t.map(BigInt)));function U(t,e,i=V){return i([t,e,2n])[0]}function j(t,e=V){const{m:i,rate:s}=e;if(!Array.isArray(t))throw new Error("bigint array expected in values");const r=Array.from(t);for(r.push(1n);r.length%s!==0;)r.push(0n);let a=new Array(i).fill(0n);for(let t=0;t<r.length;t+=s){for(let e=0;e<s;e++){const i=r[t+e];if(void 0===i)throw new Error("invalid index");a[e]+=i}a=e(a)}return a[0]}},3192(t,e,i){"use strict";i.d(e,{A:()=>l});var s=i(335),r=i(2079),a=i(5147),n=i(1579),o=i(4852),d=i(5354),c=i(8283),h=i(6414);class l extends s.A{describe(){return this.deepExtend(super.describe(),{id:"binance",name:"Binance",countries:[],rateLimit:50,certified:!0,pro:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!0,option:!0,addMargin:!0,borrowCrossMargin:!0,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,closeAllPositions:!1,closePosition:!1,createConvertTrade:!0,createDepositAddress:!1,createLimitBuyOrder:!0,createLimitSellOrder:!0,createMarketBuyOrder:!0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!0,createMarketSellOrder:!0,createMarketSellOrderWithCost:!0,createOrder:!0,createOrders:!0,createOrderWithTakeProfitAndStopLoss:!1,createPostOnlyOrder:!0,createReduceOnlyOrder:!0,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!1,createStopOrder:!0,createTakeProfitOrder:!0,createTrailingPercentOrder:!0,createTriggerOrder:!0,editOrder:!0,editOrders:!0,fetchAccounts:void 0,fetchAllGreeks:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!0,fetchCanceledAndClosedOrders:"emulated",fetchCanceledOrders:"emulated",fetchClosedOrder:!1,fetchClosedOrders:"emulated",fetchConvertCurrencies:!0,fetchConvertQuote:!0,fetchConvertTrade:!0,fetchConvertTradeHistory:!0,fetchCrossBorrowRate:!0,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:!1,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!1,fetchDeposits:!0,fetchDepositsWithdrawals:!1,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingInterval:"emulated",fetchFundingIntervals:!0,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchGreeks:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:"emulated",fetchIsolatedBorrowRates:!0,fetchL3OrderBook:!1,fetchLastPrices:!0,fetchLedger:!0,fetchLedgerEntry:!0,fetchLeverage:"emulated",fetchLeverages:!0,fetchLeverageTiers:!0,fetchLiquidations:!1,fetchLongShortRatio:!1,fetchLongShortRatioHistory:!0,fetchMarginAdjustmentHistory:!0,fetchMarginMode:!0,fetchMarginModes:!0,fetchMarketLeverageTiers:"emulated",fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMarkPrice:!0,fetchMarkPrices:!0,fetchMyLiquidations:!0,fetchMySettlementHistory:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!0,fetchOpenInterestHistory:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOption:!0,fetchOptionChain:!1,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrders:!0,fetchOrderTrades:!0,fetchPosition:!0,fetchPositionHistory:!1,fetchPositionMode:!0,fetchPositions:!0,fetchPositionsHistory:!1,fetchPositionsRisk:!0,fetchPremiumIndexOHLCV:!0,fetchSettlementHistory:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTradingLimits:"emulated",fetchTransactionFee:"emulated",fetchTransactionFees:!0,fetchTransactions:!1,fetchTransfer:!1,fetchTransfers:!0,fetchUnderlyingAssets:!1,fetchVolatilityHistory:!1,fetchWithdrawAddresses:!1,fetchWithdrawal:!1,fetchWithdrawals:!0,fetchWithdrawalWhitelist:!1,reduceMargin:!0,repayCrossMargin:!0,repayIsolatedMargin:!0,sandbox:!0,setLeverage:!0,setMargin:!1,setMarginMode:!0,setPositionMode:!0,signIn:!1,transfer:!0,withdraw:!0},timeframes:{"1s":"1s","1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","8h":"8h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","1M":"1M"},urls:{logo:"https://github.com/user-attachments/assets/e9419b93-ccb0-46aa-9bff-c883f096274b",test:{dapiPublic:"https://testnet.binancefuture.com/dapi/v1",dapiPrivate:"https://testnet.binancefuture.com/dapi/v1",dapiPrivateV2:"https://testnet.binancefuture.com/dapi/v2",fapiPublic:"https://testnet.binancefuture.com/fapi/v1",fapiPublicV2:"https://testnet.binancefuture.com/fapi/v2",fapiPublicV3:"https://testnet.binancefuture.com/fapi/v3",fapiPrivate:"https://testnet.binancefuture.com/fapi/v1",fapiPrivateV2:"https://testnet.binancefuture.com/fapi/v2",fapiPrivateV3:"https://testnet.binancefuture.com/fapi/v3",public:"https://testnet.binance.vision/api/v3",private:"https://testnet.binance.vision/api/v3",v1:"https://testnet.binance.vision/api/v1"},demo:{dapiPublic:"https://demo-dapi.binance.com/dapi/v1",dapiPrivate:"https://demo-dapi.binance.com/dapi/v1",dapiPrivateV2:"https://demo-dapi.binance.com/dapi/v2",fapiPublic:"https://demo-fapi.binance.com/fapi/v1",fapiPublicV2:"https://demo-fapi.binance.com/fapi/v2",fapiPublicV3:"https://demo-fapi.binance.com/fapi/v3",fapiPrivate:"https://demo-fapi.binance.com/fapi/v1",fapiPrivateV2:"https://demo-fapi.binance.com/fapi/v2",fapiPrivateV3:"https://demo-fapi.binance.com/fapi/v3",public:"https://demo-api.binance.com/api/v3",private:"https://demo-api.binance.com/api/v3",v1:"https://demo-api.binance.com/api/v1"},api:{sapi:"https://api.binance.com/sapi/v1",sapiV2:"https://api.binance.com/sapi/v2",sapiV3:"https://api.binance.com/sapi/v3",sapiV4:"https://api.binance.com/sapi/v4",dapiPublic:"https://dapi.binance.com/dapi/v1",dapiPrivate:"https://dapi.binance.com/dapi/v1",eapiPublic:"https://eapi.binance.com/eapi/v1",eapiPrivate:"https://eapi.binance.com/eapi/v1",dapiPrivateV2:"https://dapi.binance.com/dapi/v2",dapiData:"https://dapi.binance.com/futures/data",fapiPublic:"https://fapi.binance.com/fapi/v1",fapiPublicV2:"https://fapi.binance.com/fapi/v2",fapiPublicV3:"https://fapi.binance.com/fapi/v3",fapiPrivate:"https://fapi.binance.com/fapi/v1",fapiPrivateV2:"https://fapi.binance.com/fapi/v2",fapiPrivateV3:"https://fapi.binance.com/fapi/v3",fapiData:"https://fapi.binance.com/futures/data",public:"https://api.binance.com/api/v3",private:"https://api.binance.com/api/v3",v1:"https://api.binance.com/api/v1",papi:"https://papi.binance.com/papi/v1",papiV2:"https://papi.binance.com/papi/v2"},www:"https://www.binance.com",referral:{url:"https://accounts.binance.com/register?ref=CCXTCOM",discount:.1},doc:["https://developers.binance.com/en"],api_management:"https://www.binance.com/en/usercenter/settings/api-management",fees:"https://www.binance.com/en/fee/schedule"},api:{sapi:{get:{"copyTrading/futures/userStatus":2,"copyTrading/futures/leadSymbol":2,"system/status":.1,accountSnapshot:240,"account/info":.1,"margin/asset":1,"margin/pair":1,"margin/allAssets":.1,"margin/allPairs":.1,"margin/priceIndex":1,"spot/delist-schedule":10,"asset/assetDividend":1,"asset/dribblet":.1,"asset/transfer":.1,"asset/assetDetail":.1,"asset/tradeFee":.1,"asset/ledger-transfer/cloud-mining/queryByPage":4.0002,"asset/convert-transfer/queryByPage":.033335,"asset/wallet/balance":6,"asset/custody/transfer-history":6,"margin/borrow-repay":1,"margin/loan":1,"margin/repay":1,"margin/account":1,"margin/transfer":.1,"margin/interestHistory":.1,"margin/forceLiquidationRec":.1,"margin/order":1,"margin/openOrders":1,"margin/allOrders":20,"margin/myTrades":1,"margin/maxBorrowable":5,"margin/maxTransferable":5,"margin/tradeCoeff":1,"margin/isolated/transfer":.1,"margin/isolated/account":1,"margin/isolated/pair":1,"margin/isolated/allPairs":1,"margin/isolated/accountLimit":.1,"margin/interestRateHistory":.1,"margin/orderList":1,"margin/allOrderList":20,"margin/openOrderList":1,"margin/crossMarginData":{cost:.1,noCoin:.5},"margin/isolatedMarginData":{cost:.1,noCoin:1},"margin/isolatedMarginTier":.1,"margin/rateLimit/order":2,"margin/dribblet":.1,"margin/dust":20.001,"margin/crossMarginCollateralRatio":10,"margin/exchange-small-liability":.6667,"margin/exchange-small-liability-history":.6667,"margin/next-hourly-interest-rate":.6667,"margin/capital-flow":10,"margin/delist-schedule":10,"margin/available-inventory":.3334,"margin/leverageBracket":.1,"loan/vip/loanable/data":40,"loan/vip/collateral/data":40,"loan/vip/request/data":2.6668,"loan/vip/request/interestRate":2.6668,"loan/income":40.002,"loan/ongoing/orders":40,"loan/ltv/adjustment/history":40,"loan/borrow/history":40,"loan/repay/history":40,"loan/loanable/data":40,"loan/collateral/data":40,"loan/repay/collateral/rate":600,"loan/flexible/ongoing/orders":30,"loan/flexible/borrow/history":40,"loan/flexible/repay/history":40,"loan/flexible/ltv/adjustment/history":40,"loan/vip/ongoing/orders":40,"loan/vip/repay/history":40,"loan/vip/collateral/account":600,"fiat/orders":600.03,"fiat/payments":.1,"futures/transfer":1,"futures/histDataLink":.1,"rebate/taxQuery":80.004,"capital/config/getall":1,"capital/deposit/address":1,"capital/deposit/address/list":1,"capital/deposit/hisrec":.1,"capital/deposit/subAddress":.1,"capital/deposit/subHisrec":.1,"capital/withdraw/history":2,"capital/withdraw/address/list":10,"capital/contract/convertible-coins":4.0002,"convert/tradeFlow":20.001,"convert/exchangeInfo":50,"convert/assetInfo":10,"convert/orderStatus":.6667,"convert/limit/queryOpenOrders":20.001,"account/status":.1,"account/apiTradingStatus":.1,"account/apiRestrictions/ipRestriction":.1,bnbBurn:.1,"sub-account/futures/account":1,"sub-account/futures/accountSummary":.1,"sub-account/futures/positionRisk":1,"sub-account/futures/internalTransfer":.1,"sub-account/list":.1,"sub-account/margin/account":1,"sub-account/margin/accountSummary":1,"sub-account/spotSummary":.1,"sub-account/status":1,"sub-account/sub/transfer/history":.1,"sub-account/transfer/subUserHistory":.1,"sub-account/universalTransfer":.1,"sub-account/apiRestrictions/ipRestriction/thirdPartyList":1,"sub-account/transaction-statistics":.40002,"sub-account/subAccountApi/ipRestriction":20.001,"managed-subaccount/asset":.1,"managed-subaccount/accountSnapshot":240,"managed-subaccount/queryTransLogForInvestor":.1,"managed-subaccount/queryTransLogForTradeParent":.40002,"managed-subaccount/fetch-future-asset":.40002,"managed-subaccount/marginAsset":.1,"managed-subaccount/info":.40002,"managed-subaccount/deposit/address":.006667,"managed-subaccount/query-trans-log":.40002,"lending/daily/product/list":.1,"lending/daily/userLeftQuota":.1,"lending/daily/userRedemptionQuota":.1,"lending/daily/token/position":.1,"lending/union/account":.1,"lending/union/purchaseRecord":.1,"lending/union/redemptionRecord":.1,"lending/union/interestHistory":.1,"lending/project/list":.1,"lending/project/position/list":.1,"eth-staking/eth/history/stakingHistory":15,"eth-staking/eth/history/redemptionHistory":15,"eth-staking/eth/history/rewardsHistory":15,"eth-staking/eth/quota":15,"eth-staking/eth/history/rateHistory":15,"eth-staking/account":15,"eth-staking/wbeth/history/wrapHistory":15,"eth-staking/wbeth/history/unwrapHistory":15,"eth-staking/eth/history/wbethRewardsHistory":15,"sol-staking/sol/history/stakingHistory":15,"sol-staking/sol/history/redemptionHistory":15,"sol-staking/sol/history/bnsolRewardsHistory":15,"sol-staking/sol/history/rateHistory":15,"sol-staking/account":15,"sol-staking/sol/quota":15,"mining/pub/algoList":.1,"mining/pub/coinList":.1,"mining/worker/detail":.5,"mining/worker/list":.5,"mining/payment/list":.5,"mining/statistics/user/status":.5,"mining/statistics/user/list":.5,"mining/payment/uid":.5,"bswap/pools":.1,"bswap/liquidity":{cost:.1,noPoolId:1},"bswap/liquidityOps":20.001,"bswap/quote":1.00005,"bswap/swap":20.001,"bswap/poolConfigure":1.00005,"bswap/addLiquidityPreview":1.00005,"bswap/removeLiquidityPreview":1.00005,"bswap/unclaimedRewards":6.667,"bswap/claimedHistory":6.667,"blvt/tokenInfo":.1,"blvt/subscribe/record":.1,"blvt/redeem/record":.1,"blvt/userLimit":.1,"apiReferral/ifNewUser":1,"apiReferral/customization":1,"apiReferral/userCustomization":1,"apiReferral/rebate/recentRecord":1,"apiReferral/rebate/historicalRecord":1,"apiReferral/kickback/recentRecord":1,"apiReferral/kickback/historicalRecord":1,"broker/subAccountApi":1,"broker/subAccount":1,"broker/subAccountApi/commission/futures":1,"broker/subAccountApi/commission/coinFutures":1,"broker/info":1,"broker/transfer":1,"broker/transfer/futures":1,"broker/rebate/recentRecord":1,"broker/rebate/historicalRecord":1,"broker/subAccount/bnbBurn/status":1,"broker/subAccount/depositHist":1,"broker/subAccount/spotSummary":1,"broker/subAccount/marginSummary":1,"broker/subAccount/futuresSummary":1,"broker/rebate/futures/recentRecord":1,"broker/subAccountApi/ipRestriction":1,"broker/universalTransfer":1,"account/apiRestrictions":.1,"c2c/orderMatch/listUserOrderHistory":.1,"nft/history/transactions":20.001,"nft/history/deposit":20.001,"nft/history/withdraw":20.001,"nft/user/getAsset":20.001,"pay/transactions":20.001,"giftcard/verify":.1,"giftcard/cryptography/rsa-public-key":.1,"giftcard/buyCode/token-limit":.1,"algo/spot/openOrders":.1,"algo/spot/historicalOrders":.1,"algo/spot/subOrders":.1,"algo/futures/openOrders":.1,"algo/futures/historicalOrders":.1,"algo/futures/subOrders":.1,"portfolio/account":.1,"portfolio/collateralRate":5,"portfolio/pmLoan":3.3335,"portfolio/interest-history":.6667,"portfolio/asset-index-price":.1,"portfolio/repay-futures-switch":3,"portfolio/margin-asset-leverage":5,"portfolio/balance":2,"portfolio/negative-balance-exchange-record":2,"portfolio/pmloan-history":5,"portfolio/earn-asset-balance":150,"staking/productList":.1,"staking/position":.1,"staking/stakingRecord":.1,"staking/personalLeftQuota":.1,"lending/auto-invest/target-asset/list":.1,"lending/auto-invest/target-asset/roi/list":.1,"lending/auto-invest/all/asset":.1,"lending/auto-invest/source-asset/list":.1,"lending/auto-invest/plan/list":.1,"lending/auto-invest/plan/id":.1,"lending/auto-invest/history/list":.1,"lending/auto-invest/index/info":.1,"lending/auto-invest/index/user-summary":.1,"lending/auto-invest/one-off/status":.1,"lending/auto-invest/redeem/history":.1,"lending/auto-invest/rebalance/history":.1,"simple-earn/flexible/list":15,"simple-earn/locked/list":15,"simple-earn/flexible/personalLeftQuota":15,"simple-earn/locked/personalLeftQuota":15,"simple-earn/flexible/subscriptionPreview":15,"simple-earn/locked/subscriptionPreview":15,"simple-earn/flexible/history/rateHistory":15,"simple-earn/flexible/position":15,"simple-earn/locked/position":15,"simple-earn/account":15,"simple-earn/flexible/history/subscriptionRecord":15,"simple-earn/locked/history/subscriptionRecord":15,"simple-earn/flexible/history/redemptionRecord":15,"simple-earn/locked/history/redemptionRecord":15,"simple-earn/flexible/history/rewardsRecord":15,"simple-earn/locked/history/rewardsRecord":15,"simple-earn/flexible/history/collateralRecord":.1,"dci/product/list":.1,"dci/product/positions":.1,"dci/product/accounts":.1},post:{"asset/dust":.06667,"asset/dust-btc":.1,"asset/transfer":6.0003,"asset/get-funding-asset":.1,"asset/convert-transfer":.033335,"account/disableFastWithdrawSwitch":.1,"account/enableFastWithdrawSwitch":.1,"capital/withdraw/apply":4.0002,"capital/contract/convertible-coins":4.0002,"capital/deposit/credit-apply":.1,"margin/borrow-repay":20.001,"margin/transfer":4.0002,"margin/loan":20.001,"margin/repay":20.001,"margin/order":.040002,"margin/order/oco":.040002,"margin/dust":20.001,"margin/exchange-small-liability":20.001,"margin/isolated/transfer":4.0002,"margin/isolated/account":2.0001,"margin/max-leverage":300,bnbBurn:.1,"sub-account/virtualSubAccount":.1,"sub-account/margin/transfer":4.0002,"sub-account/margin/enable":.1,"sub-account/futures/enable":.1,"sub-account/futures/transfer":.1,"sub-account/futures/internalTransfer":.1,"sub-account/transfer/subToSub":.1,"sub-account/transfer/subToMaster":.1,"sub-account/universalTransfer":.1,"sub-account/options/enable":.1,"managed-subaccount/deposit":.1,"managed-subaccount/withdraw":.1,userDataStream:.1,"userDataStream/isolated":.1,"futures/transfer":.1,"lending/customizedFixed/purchase":.1,"lending/daily/purchase":.1,"lending/daily/redeem":.1,"bswap/liquidityAdd":60,"bswap/liquidityRemove":60,"bswap/swap":60,"bswap/claimRewards":6.667,"blvt/subscribe":.1,"blvt/redeem":.1,"apiReferral/customization":1,"apiReferral/userCustomization":1,"apiReferral/rebate/historicalRecord":1,"apiReferral/kickback/historicalRecord":1,"broker/subAccount":1,"broker/subAccount/margin":1,"broker/subAccount/futures":1,"broker/subAccountApi":1,"broker/subAccountApi/permission":1,"broker/subAccountApi/commission":1,"broker/subAccountApi/commission/futures":1,"broker/subAccountApi/commission/coinFutures":1,"broker/transfer":1,"broker/transfer/futures":1,"broker/rebate/historicalRecord":1,"broker/subAccount/bnbBurn/spot":1,"broker/subAccount/bnbBurn/marginInterest":1,"broker/subAccount/blvt":1,"broker/subAccountApi/ipRestriction":1,"broker/subAccountApi/ipRestriction/ipList":1,"broker/universalTransfer":1,"broker/subAccountApi/permission/universalTransfer":1,"broker/subAccountApi/permission/vanillaOptions":1,"giftcard/createCode":.1,"giftcard/redeemCode":.1,"giftcard/buyCode":.1,"algo/spot/newOrderTwap":20.001,"algo/futures/newOrderVp":20.001,"algo/futures/newOrderTwap":20.001,"staking/purchase":.1,"staking/redeem":.1,"staking/setAutoStaking":.1,"eth-staking/eth/stake":15,"eth-staking/eth/redeem":15,"eth-staking/wbeth/wrap":15,"sol-staking/sol/stake":15,"sol-staking/sol/redeem":15,"mining/hash-transfer/config":.5,"mining/hash-transfer/config/cancel":.5,"portfolio/repay":20.001,"loan/vip/renew":40.002,"loan/vip/borrow":40.002,"loan/borrow":40.002,"loan/repay":40.002,"loan/adjust/ltv":40.002,"loan/customize/margin_call":40.002,"loan/flexible/repay":40.002,"loan/flexible/adjust/ltv":40.002,"loan/vip/repay":40.002,"convert/getQuote":1.3334,"convert/acceptQuote":3.3335,"convert/limit/placeOrder":3.3335,"convert/limit/cancelOrder":1.3334,"portfolio/auto-collection":150,"portfolio/asset-collection":6,"portfolio/bnb-transfer":150,"portfolio/repay-futures-switch":150,"portfolio/repay-futures-negative-balance":150,"portfolio/mint":20,"portfolio/redeem":20,"portfolio/earn-asset-transfer":150,"lending/auto-invest/plan/add":.1,"lending/auto-invest/plan/edit":.1,"lending/auto-invest/plan/edit-status":.1,"lending/auto-invest/one-off":.1,"lending/auto-invest/redeem":.1,"simple-earn/flexible/subscribe":.1,"simple-earn/locked/subscribe":.1,"simple-earn/flexible/redeem":.1,"simple-earn/locked/redeem":.1,"simple-earn/flexible/setAutoSubscribe":15,"simple-earn/locked/setAutoSubscribe":15,"simple-earn/locked/setRedeemOption":5,"dci/product/subscribe":.1,"dci/product/auto_compound/edit":.1},put:{userDataStream:.1,"userDataStream/isolated":.1},delete:{"margin/openOrders":.1,"margin/order":.006667,"margin/orderList":.006667,"margin/isolated/account":2.0001,userDataStream:.1,"userDataStream/isolated":.1,"broker/subAccountApi":1,"broker/subAccountApi/ipRestriction/ipList":1,"algo/spot/order":.1,"algo/futures/order":.1,"sub-account/subAccountApi/ipRestriction/ipList":20.001}},sapiV2:{get:{"eth-staking/account":15,"sub-account/futures/account":.1,"sub-account/futures/accountSummary":1,"sub-account/futures/positionRisk":.1,"loan/flexible/ongoing/orders":30,"loan/flexible/borrow/history":40,"loan/flexible/repay/history":40,"loan/flexible/ltv/adjustment/history":40,"loan/flexible/loanable/data":40,"loan/flexible/collateral/data":40,"portfolio/account":2},post:{"eth-staking/eth/stake":15,"sub-account/subAccountApi/ipRestriction":20.001,"loan/flexible/borrow":40.002,"loan/flexible/repay":40.002,"loan/flexible/adjust/ltv":40.002}},sapiV3:{get:{"sub-account/assets":.40002},post:{"asset/getUserAsset":.5}},sapiV4:{get:{"sub-account/assets":.40002}},dapiPublic:{get:{ping:1,time:1,exchangeInfo:1,depth:{cost:2,byLimit:[[50,2],[100,5],[500,10],[1e3,20]]},trades:5,historicalTrades:20,aggTrades:20,premiumIndex:10,fundingRate:1,klines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},continuousKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},indexPriceKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},markPriceKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},premiumIndexKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},"ticker/24hr":{cost:1,noSymbol:40},"ticker/price":{cost:1,noSymbol:2},"ticker/bookTicker":{cost:2,noSymbol:5},constituents:2,openInterest:1,fundingInfo:1}},dapiData:{get:{"delivery-price":1,openInterestHist:1,topLongShortAccountRatio:1,topLongShortPositionRatio:1,globalLongShortAccountRatio:1,takerBuySellVol:1,basis:1}},dapiPrivate:{get:{"positionSide/dual":30,orderAmendment:1,order:1,openOrder:1,openOrders:{cost:1,noSymbol:5},allOrders:{cost:20,noSymbol:40},balance:1,account:5,"positionMargin/history":1,positionRisk:1,userTrades:{cost:20,noSymbol:40},income:20,leverageBracket:1,forceOrders:{cost:20,noSymbol:50},adlQuantile:5,commissionRate:20,"income/asyn":5,"income/asyn/id":5,"trade/asyn":.5,"trade/asyn/id":.5,"order/asyn":.5,"order/asyn/id":.5,pmExchangeInfo:.5,pmAccountInfo:.5},post:{"positionSide/dual":1,order:4,batchOrders:5,countdownCancelAll:10,leverage:1,marginType:1,positionMargin:1,listenKey:1},put:{listenKey:1,order:1,batchOrders:5},delete:{order:1,allOpenOrders:1,batchOrders:5,listenKey:1}},dapiPrivateV2:{get:{leverageBracket:1}},fapiPublic:{get:{ping:1,time:1,exchangeInfo:1,depth:{cost:2,byLimit:[[50,2],[100,5],[500,10],[1e3,20]]},rpiDepth:20,trades:5,historicalTrades:20,aggTrades:20,klines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},continuousKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},markPriceKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},indexPriceKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},premiumIndexKlines:{cost:1,byLimit:[[99,1],[499,2],[1e3,5],[1e4,10]]},fundingRate:1,fundingInfo:1,premiumIndex:1,"ticker/24hr":{cost:1,noSymbol:40},"ticker/price":{cost:1,noSymbol:2},"ticker/bookTicker":{cost:1,noSymbol:2},openInterest:1,indexInfo:1,assetIndex:{cost:1,noSymbol:10},constituents:2,apiTradingStatus:{cost:1,noSymbol:10},lvtKlines:1,"convert/exchangeInfo":4,insuranceBalance:1,symbolAdlRisk:1,tradingSchedule:5}},fapiData:{get:{"delivery-price":1,openInterestHist:1,topLongShortAccountRatio:1,topLongShortPositionRatio:1,globalLongShortAccountRatio:1,takerlongshortRatio:1,basis:1}},fapiPrivate:{get:{forceOrders:{cost:20,noSymbol:50},allOrders:5,openOrder:1,openOrders:{cost:1,noSymbol:40},order:1,account:5,balance:5,leverageBracket:1,"positionMargin/history":1,positionRisk:5,"positionSide/dual":30,userTrades:5,income:30,commissionRate:20,"rateLimit/order":1,apiTradingStatus:1,multiAssetsMargin:30,"apiReferral/ifNewUser":1,"apiReferral/customization":1,"apiReferral/userCustomization":1,"apiReferral/traderNum":1,"apiReferral/overview":1,"apiReferral/tradeVol":1,"apiReferral/rebateVol":1,"apiReferral/traderSummary":1,adlQuantile:5,pmAccountInfo:5,orderAmendment:1,"income/asyn":1e3,"income/asyn/id":10,"order/asyn":1e3,"order/asyn/id":10,"trade/asyn":1e3,"trade/asyn/id":10,feeBurn:1,symbolConfig:5,accountConfig:5,"convert/orderStatus":5,algoOrder:1,openAlgoOrders:{cost:1,noSymbol:40},allAlgoOrders:5,"stock/contract":50},post:{batchOrders:5,"positionSide/dual":1,positionMargin:1,marginType:1,order:4,"order/test":1,leverage:1,listenKey:1,countdownCancelAll:10,multiAssetsMargin:1,"apiReferral/customization":1,"apiReferral/userCustomization":1,feeBurn:1,"convert/getQuote":200,"convert/acceptQuote":20,algoOrder:1},put:{listenKey:1,order:1,batchOrders:5},delete:{batchOrders:1,order:1,allOpenOrders:1,listenKey:1,algoOrder:1,algoOpenOrders:1}},fapiPublicV2:{get:{"ticker/price":0}},fapiPrivateV2:{get:{account:1,balance:1,positionRisk:1}},fapiPublicV3:{get:{}},fapiPrivateV3:{get:{account:1,balance:1,positionRisk:1}},eapiPublic:{get:{ping:1,time:1,exchangeInfo:1,index:1,ticker:5,mark:5,depth:1,klines:1,trades:5,historicalTrades:20,exerciseHistory:3,openInterest:3}},eapiPrivate:{get:{account:3,position:5,openOrders:{cost:1,noSymbol:40},historyOrders:3,userTrades:5,exerciseRecord:5,bill:1,"income/asyn":5,"income/asyn/id":5,marginAccount:3,mmp:1,countdownCancelAll:1,order:1,"block/order/orders":5,"block/order/execute":5,"block/user-trades":5,blockTrades:5},post:{order:1,batchOrders:5,listenKey:1,mmpSet:1,mmpReset:1,countdownCancelAll:1,countdownCancelAllHeartBeat:10,"block/order/create":5,"block/order/execute":5},put:{listenKey:1,"block/order/create":5},delete:{order:1,batchOrders:1,allOpenOrders:1,allOpenOrdersByUnderlying:1,listenKey:1,"block/order/create":5}},public:{get:{ping:.2,time:.2,depth:{cost:1,byLimit:[[100,1],[500,5],[1e3,10],[5e3,50]]},trades:2,aggTrades:.4,historicalTrades:2,klines:.4,uiKlines:.4,"ticker/24hr":{cost:.4,noSymbol:16},ticker:{cost:.4,noSymbol:16},"ticker/tradingDay":.8,"ticker/price":{cost:.4,noSymbol:.8},"ticker/bookTicker":{cost:.4,noSymbol:.8},exchangeInfo:4,avgPrice:.4},put:{userDataStream:.4},post:{userDataStream:.4},delete:{userDataStream:.4}},private:{get:{allOrderList:4,openOrderList:1.2,orderList:.8,order:.8,openOrders:{cost:1.2,noSymbol:16},allOrders:4,account:4,myTrades:4,"rateLimit/order":8,myPreventedMatches:4,myAllocations:4,"account/commission":4},post:{"order/oco":.2,"orderList/oco":.2,"orderList/oto":.2,"orderList/otoco":.2,"sor/order":.2,"sor/order/test":.2,order:.2,"order/cancelReplace":.2,"order/test":.2},delete:{openOrders:.2,orderList:.2,order:.2}},papi:{get:{ping:.2,"um/order":1,"um/openOrder":1,"um/openOrders":{cost:1,noSymbol:40},"um/allOrders":5,"cm/order":1,"cm/openOrder":1,"cm/openOrders":{cost:1,noSymbol:40},"cm/allOrders":20,"um/conditional/openOrder":1,"um/conditional/openOrders":{cost:1,noSymbol:40},"um/conditional/orderHistory":1,"um/conditional/allOrders":{cost:1,noSymbol:40},"cm/conditional/openOrder":1,"cm/conditional/openOrders":{cost:1,noSymbol:40},"cm/conditional/orderHistory":1,"cm/conditional/allOrders":40,"margin/order":10,"margin/openOrders":5,"margin/allOrders":100,"margin/orderList":5,"margin/allOrderList":100,"margin/openOrderList":5,"margin/myTrades":5,balance:4,account:4,"margin/maxBorrowable":1,"margin/maxWithdraw":1,"um/positionRisk":1,"cm/positionRisk":.2,"um/positionSide/dual":6,"cm/positionSide/dual":6,"um/userTrades":5,"cm/userTrades":20,"um/leverageBracket":.2,"cm/leverageBracket":.2,"margin/forceOrders":1,"um/forceOrders":{cost:20,noSymbol:50},"cm/forceOrders":{cost:20,noSymbol:50},"um/apiTradingStatus":{cost:.2,noSymbol:2},"um/commissionRate":4,"cm/commissionRate":4,"margin/marginLoan":2,"margin/repayLoan":2,"margin/marginInterestHistory":.2,"portfolio/interest-history":10,"um/income":6,"cm/income":6,"um/account":1,"cm/account":1,"repay-futures-switch":6,"um/adlQuantile":5,"cm/adlQuantile":5,"um/trade/asyn":300,"um/trade/asyn/id":2,"um/order/asyn":300,"um/order/asyn/id":2,"um/income/asyn":300,"um/income/asyn/id":2,"um/orderAmendment":1,"cm/orderAmendment":1,"um/feeBurn":30,"um/accountConfig":1,"um/symbolConfig":1,"cm/accountConfig":1,"cm/symbolConfig":1,"rateLimit/order":1},post:{"um/order":1,"um/conditional/order":1,"cm/order":1,"cm/conditional/order":1,"margin/order":1,marginLoan:100,repayLoan:100,"margin/order/oco":1,"um/leverage":.2,"cm/leverage":.2,"um/positionSide/dual":.2,"cm/positionSide/dual":.2,"auto-collection":150,"bnb-transfer":150,"repay-futures-switch":150,"repay-futures-negative-balance":150,listenKey:.2,"asset-collection":6,"margin/repay-debt":3e3,"um/feeBurn":1},put:{listenKey:.2,"um/order":1,"cm/order":1},delete:{"um/order":1,"um/conditional/order":1,"um/allOpenOrders":1,"um/conditional/allOpenOrders":1,"cm/order":1,"cm/conditional/order":1,"cm/allOpenOrders":1,"cm/conditional/allOpenOrders":1,"margin/order":2,"margin/allOpenOrders":5,"margin/orderList":2,listenKey:.2}},papiV2:{get:{"um/account":1}}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,taker:this.parseNumber("0.001"),maker:this.parseNumber("0.001")},linear:{trading:{feeSide:"quote",tierBased:!0,percentage:!0,taker:this.parseNumber("0.000500"),maker:this.parseNumber("0.000200"),tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.000400")],[this.parseNumber("250"),this.parseNumber("0.000400")],[this.parseNumber("2500"),this.parseNumber("0.000350")],[this.parseNumber("7500"),this.parseNumber("0.000320")],[this.parseNumber("22500"),this.parseNumber("0.000300")],[this.parseNumber("50000"),this.parseNumber("0.000270")],[this.parseNumber("100000"),this.parseNumber("0.000250")],[this.parseNumber("200000"),this.parseNumber("0.000220")],[this.parseNumber("400000"),this.parseNumber("0.000200")],[this.parseNumber("750000"),this.parseNumber("0.000170")]],maker:[[this.parseNumber("0"),this.parseNumber("0.000200")],[this.parseNumber("250"),this.parseNumber("0.000160")],[this.parseNumber("2500"),this.parseNumber("0.000140")],[this.parseNumber("7500"),this.parseNumber("0.000120")],[this.parseNumber("22500"),this.parseNumber("0.000100")],[this.parseNumber("50000"),this.parseNumber("0.000080")],[this.parseNumber("100000"),this.parseNumber("0.000060")],[this.parseNumber("200000"),this.parseNumber("0.000040")],[this.parseNumber("400000"),this.parseNumber("0.000020")],[this.parseNumber("750000"),this.parseNumber("0")]]}}},inverse:{trading:{feeSide:"base",tierBased:!0,percentage:!0,taker:this.parseNumber("0.000500"),maker:this.parseNumber("0.000100"),tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.000500")],[this.parseNumber("250"),this.parseNumber("0.000450")],[this.parseNumber("2500"),this.parseNumber("0.000400")],[this.parseNumber("7500"),this.parseNumber("0.000300")],[this.parseNumber("22500"),this.parseNumber("0.000250")],[this.parseNumber("50000"),this.parseNumber("0.000240")],[this.parseNumber("100000"),this.parseNumber("0.000240")],[this.parseNumber("200000"),this.parseNumber("0.000240")],[this.parseNumber("400000"),this.parseNumber("0.000240")],[this.parseNumber("750000"),this.parseNumber("0.000240")]],maker:[[this.parseNumber("0"),this.parseNumber("0.000100")],[this.parseNumber("250"),this.parseNumber("0.000080")],[this.parseNumber("2500"),this.parseNumber("0.000050")],[this.parseNumber("7500"),this.parseNumber("0.0000030")],[this.parseNumber("22500"),this.parseNumber("0")],[this.parseNumber("50000"),this.parseNumber("-0.000050")],[this.parseNumber("100000"),this.parseNumber("-0.000060")],[this.parseNumber("200000"),this.parseNumber("-0.000070")],[this.parseNumber("400000"),this.parseNumber("-0.000080")],[this.parseNumber("750000"),this.parseNumber("-0.000090")]]}}},option:{}},currencies:{BNFCR:this.safeCurrencyStructure({id:"BNFCR",code:"BNFCR",precision:this.parseNumber("0.001")})},commonCurrencies:{BCC:"BCC",YOYO:"YOYOW"},precisionMode:n.kb,options:{sandboxMode:!1,fetchMargins:!0,fetchMarkets:{types:["spot","linear","inverse"]},loadAllOptions:!1,fetchCurrencies:!0,defaultTimeInForce:"GTC",defaultType:"spot",defaultSubType:void 0,hasAlreadyAuthenticatedSuccessfully:!1,warnOnFetchOpenOrdersWithoutSymbol:!0,currencyToPrecisionRoundingMode:n.R3,throwMarginModeAlreadySet:!1,fetchPositions:"positionRisk",recvWindow:1e4,timeDifference:0,adjustForTimeDifference:!1,newOrderRespType:{market:"FULL",limit:"FULL"},quoteOrderQty:!0,broker:{spot:"x-TKT5PX2F",margin:"x-TKT5PX2F",future:"x-cvBPrNm9",delivery:"x-xcKtGhcu",swap:"x-cvBPrNm9",option:"x-xcKtGhcu",inverse:"x-xcKtGhcu"},accountsByType:{main:"MAIN",spot:"MAIN",funding:"FUNDING",margin:"MARGIN",cross:"MARGIN",future:"UMFUTURE",delivery:"CMFUTURE",linear:"UMFUTURE",swap:"UMFUTURE",inverse:"CMFUTURE",option:"OPTION"},accountsById:{MAIN:"spot",FUNDING:"funding",MARGIN:"margin",UMFUTURE:"linear",CMFUTURE:"inverse",OPTION:"option"},networks:{ERC20:"ETH",TRC20:"TRX",BEP2:"BNB",BEP20:"BSC",OMNI:"OMNI",EOS:"EOS",SPL:"SOL",SOL:"SOL"},networksById:{SOL:"SOL"},impliedNetworks:{ETH:{ERC20:"ETH"},TRX:{TRC20:"TRX"}},legalMoney:{MXN:!0,UGX:!0,SEK:!0,CHF:!0,VND:!0,AED:!0,DKK:!0,KZT:!0,HUF:!0,PEN:!0,PHP:!0,USD:!0,TRY:!0,EUR:!0,NGN:!0,PLN:!0,BRL:!0,ZAR:!0,KES:!0,ARS:!0,RUB:!0,AUD:!0,NOK:!0,CZK:!0,GBP:!0,UAH:!0,GHS:!0,HKD:!0,CAD:!0,INR:!0,JPY:!0,NZD:!0},legalMoneyCurrenciesById:{BUSD:"USD"},defaultWithdrawPrecision:1e-8},features:{spot:{sandbox:!0,fetchCurrencies:{private:!0},createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:void 0,triggerDirection:!1,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!0,leverage:!1,marketBuyByCost:!0,marketBuyRequiresPrice:!1,selfTradePrevention:{EXPIRE_MAKER:!0,EXPIRE_TAKER:!0,EXPIRE_BOTH:!0,NONE:!0},trailing:!1,icebergAmount:!0},createOrders:void 0,fetchMyTrades:{marginMode:!1,limit:1e3,daysBack:void 0,untilDays:1,symbolRequired:!0},fetchOrder:{marginMode:!0,trigger:!1,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:void 0,trigger:!1,trailing:!1,symbolRequired:!1},fetchOrders:{marginMode:!0,limit:1e3,daysBack:void 0,untilDays:1e4,trigger:!1,trailing:!1,symbolRequired:!0},fetchClosedOrders:{marginMode:!0,limit:1e3,daysBack:void 0,daysBackCanceled:void 0,untilDays:1e4,trigger:!1,trailing:!1,symbolRequired:!0},fetchOHLCV:{limit:1e3}},forDerivatives:{sandbox:!0,createOrder:{marginMode:!1,triggerPrice:!0,triggerPriceType:{mark:!0,last:!0,index:!1},stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!0},hedged:!0,selfTradePrevention:!0,trailing:!0,iceberg:!1,leverage:!1,marketBuyRequiresPrice:!1,marketBuyByCost:!0},createOrders:{max:5},fetchMyTrades:{marginMode:!1,daysBack:void 0,limit:1e3,untilDays:7,symbolRequired:!0},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:500,trigger:!1,trailing:!1,symbolRequired:!1},fetchOrders:{marginMode:!0,limit:1e3,daysBack:90,untilDays:7,trigger:!1,trailing:!1,symbolRequired:!0},fetchClosedOrders:{marginMode:!0,limit:1e3,daysBack:90,daysBackCanceled:3,untilDays:7,trigger:!1,trailing:!1,symbolRequired:!0},fetchOHLCV:{limit:1500}},swap:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}},future:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}}},exceptions:{spot:{exact:{"-1004":r.OperationFailed,"-1008":r.OperationFailed,"-1099":r.AuthenticationError,"-1108":r.BadRequest,"-1131":r.BadRequest,"-1134":r.BadRequest,"-1135":r.BadRequest,"-1145":r.BadRequest,"-1151":r.BadSymbol,"-2008":r.AuthenticationError,"-2016":r.OperationRejected,"-2021":r.BadResponse,"-2022":r.BadResponse,"-2026":r.InvalidOrder,"-3000":r.OperationFailed,"-3001":r.AuthenticationError,"-3002":r.BadSymbol,"-3003":r.BadRequest,"-3004":r.OperationRejected,"-3005":r.BadRequest,"-3006":r.BadRequest,"-3007":r.OperationFailed,"-3008":r.BadRequest,"-3009":r.OperationRejected,"-3010":r.BadRequest,"-3011":r.BadRequest,"-3012":r.OperationRejected,"-3013":r.BadRequest,"-3014":r.AccountSuspended,"-3015":r.BadRequest,"-3016":r.BadRequest,"-3017":r.OperationRejected,"-3018":r.AccountSuspended,"-3019":r.AccountSuspended,"-3020":r.BadRequest,"-3021":r.BadRequest,"-3022":r.AccountSuspended,"-3023":r.OperationRejected,"-3024":r.OperationRejected,"-3025":r.BadRequest,"-3026":r.BadRequest,"-3027":r.BadSymbol,"-3028":r.BadSymbol,"-3029":r.OperationFailed,"-3036":r.AccountSuspended,"-3037":r.OperationFailed,"-3038":r.BadRequest,"-3041":r.InsufficientFunds,"-3042":r.BadRequest,"-3043":r.PermissionDenied,"-3044":r.OperationFailed,"-3045":r.OperationRejected,"-3999":r.PermissionDenied,"-4000":r.ExchangeError,"-4001":r.BadRequest,"-4002":r.BadRequest,"-4003":r.BadRequest,"-4004":r.AuthenticationError,"-4005":r.RateLimitExceeded,"-4006":r.BadRequest,"-4007":r.PermissionDenied,"-4008":r.PermissionDenied,"-4009":r.ExchangeError,"-4010":r.PermissionDenied,"-4011":r.BadRequest,"-4012":r.PermissionDenied,"-4013":r.AuthenticationError,"-4014":r.OperationRejected,"-4015":r.PermissionDenied,"-4016":r.PermissionDenied,"-4017":r.PermissionDenied,"-4018":r.BadSymbol,"-4019":r.BadRequest,"-4020":r.ExchangeError,"-4021":r.BadRequest,"-4022":r.BadRequest,"-4023":r.OperationRejected,"-4024":r.InsufficientFunds,"-4025":r.InsufficientFunds,"-4026":r.InsufficientFunds,"-4027":r.OperationFailed,"-4028":r.BadRequest,"-4029":r.BadRequest,"-4030":r.BadResponse,"-4031":r.OperationFailed,"-4032":r.OperationRejected,"-4033":r.BadRequest,"-4034":r.OperationRejected,"-4035":r.PermissionDenied,"-4036":r.PermissionDenied,"-4037":r.OperationFailed,"-4038":r.OperationFailed,"-4039":r.PermissionDenied,"-4040":r.OperationRejected,"-4041":r.OperationFailed,"-4042":r.OperationRejected,"-4043":r.OperationRejected,"-4044":r.PermissionDenied,"-4045":r.OperationFailed,"-4046":r.AuthenticationError,"-4047":r.BadRequest,"-4048":r.ExchangeError,"-4049":r.ExchangeError,"-4050":r.ExchangeError,"-4051":r.ExchangeError,"-4052":r.ExchangeError,"-4053":r.ExchangeError,"-4054":r.ExchangeError,"-4055":r.ExchangeError,"-4056":r.ExchangeError,"-4057":r.ExchangeError,"-4058":r.ExchangeError,"-4059":r.ExchangeError,"-4060":r.OperationFailed,"-4061":r.ExchangeError,"-4062":r.ExchangeError,"-4063":r.ExchangeError,"-4064":r.ExchangeError,"-4065":r.ExchangeError,"-4066":r.ExchangeError,"-4067":r.ExchangeError,"-4068":r.ExchangeError,"-4069":r.ExchangeError,"-4070":r.ExchangeError,"-4071":r.ExchangeError,"-4072":r.ExchangeError,"-4073":r.ExchangeError,"-4074":r.ExchangeError,"-4075":r.ExchangeError,"-4076":r.ExchangeError,"-4077":r.ExchangeError,"-4078":r.ExchangeError,"-4079":r.ExchangeError,"-4080":r.ExchangeError,"-4081":r.ExchangeError,"-4082":r.ExchangeError,"-4083":r.ExchangeError,"-4084":r.ExchangeError,"-4085":r.ExchangeError,"-4086":r.ExchangeError,"-4087":r.ExchangeError,"-4088":r.ExchangeError,"-4089":r.ExchangeError,"-4091":r.ExchangeError,"-4092":r.ExchangeError,"-4093":r.ExchangeError,"-4094":r.ExchangeError,"-4095":r.ExchangeError,"-4096":r.ExchangeError,"-4097":r.ExchangeError,"-4098":r.ExchangeError,"-4099":r.ExchangeError,"-4101":r.ExchangeError,"-4102":r.ExchangeError,"-4103":r.ExchangeError,"-4104":r.ExchangeError,"-4105":r.ExchangeError,"-4106":r.ExchangeError,"-4107":r.ExchangeError,"-4108":r.ExchangeError,"-4109":r.ExchangeError,"-4110":r.ExchangeError,"-4112":r.ExchangeError,"-4113":r.ExchangeError,"-4114":r.ExchangeError,"-4115":r.ExchangeError,"-4116":r.ExchangeError,"-4117":r.ExchangeError,"-4118":r.ExchangeError,"-4119":r.ExchangeError,"-4120":r.ExchangeError,"-4121":r.ExchangeError,"-4122":r.ExchangeError,"-4123":r.ExchangeError,"-4124":r.ExchangeError,"-4125":r.ExchangeError,"-4126":r.ExchangeError,"-4127":r.ExchangeError,"-4128":r.ExchangeError,"-4129":r.ExchangeError,"-4130":r.ExchangeError,"-4131":r.ExchangeError,"-4132":r.ExchangeError,"-4133":r.ExchangeError,"-4134":r.ExchangeError,"-4135":r.ExchangeError,"-4136":r.ExchangeError,"-4137":r.ExchangeError,"-4138":r.ExchangeError,"-4139":r.ExchangeError,"-4141":r.ExchangeError,"-4142":r.ExchangeError,"-4143":r.ExchangeError,"-4144":r.ExchangeError,"-4145":r.ExchangeError,"-4146":r.ExchangeError,"-4147":r.ExchangeError,"-4148":r.ExchangeError,"-4149":r.ExchangeError,"-4150":r.ExchangeError,"-5001":r.BadRequest,"-5002":r.InsufficientFunds,"-5003":r.InsufficientFunds,"-5004":r.OperationRejected,"-5005":r.OperationRejected,"-5006":r.OperationRejected,"-5007":r.BadRequest,"-5008":r.OperationRejected,"-5009":r.BadSymbol,"-5010":r.OperationFailed,"-5011":r.BadRequest,"-5012":r.OperationFailed,"-5013":r.InsufficientFunds,"-5021":r.BadRequest,"-5022":r.BadRequest,"-6001":r.BadSymbol,"-6003":r.PermissionDenied,"-6004":r.BadRequest,"-6005":r.BadRequest,"-6006":r.BadRequest,"-6007":r.OperationRejected,"-6008":r.OperationRejected,"-6009":r.RateLimitExceeded,"-6011":r.OperationRejected,"-6012":r.InsufficientFunds,"-6013":r.BadResponse,"-6014":r.OperationRejected,"-6015":r.BadRequest,"-6016":r.BadRequest,"-6017":r.PermissionDenied,"-6018":r.InsufficientFunds,"-6019":r.OperationRejected,"-6020":r.BadRequest,"-7001":r.BadRequest,"-7002":r.BadRequest,"-10001":r.OperationFailed,"-10002":r.BadRequest,"-10005":r.BadResponse,"-10007":r.BadRequest,"-10008":r.BadRequest,"-10009":r.BadRequest,"-10010":r.BadRequest,"-10011":r.InsufficientFunds,"-10012":r.BadRequest,"-10013":r.InsufficientFunds,"-10015":r.OperationFailed,"-10016":r.OperationFailed,"-10017":r.OperationRejected,"-10018":r.BadRequest,"-10019":r.BadRequest,"-10020":r.BadRequest,"-10021":r.InvalidOrder,"-10022":r.BadRequest,"-10023":r.OperationFailed,"-10024":r.BadRequest,"-10025":r.OperationFailed,"-10026":r.BadRequest,"-10028":r.BadRequest,"-10029":r.OperationRejected,"-10030":r.OperationRejected,"-10031":r.OperationRejected,"-10032":r.OperationFailed,"-10034":r.OperationRejected,"-10039":r.OperationRejected,"-10040":r.OperationRejected,"-10041":r.OperationFailed,"-10042":r.BadSymbol,"-10043":r.OperationRejected,"-10044":r.OperationRejected,"-10045":r.OperationRejected,"-10046":r.OperationRejected,"-10047":r.PermissionDenied,"-11008":r.OperationRejected,"-12014":r.RateLimitExceeded,"-13000":r.OperationRejected,"-13001":r.OperationRejected,"-13002":r.OperationRejected,"-13003":r.PermissionDenied,"-13004":r.OperationRejected,"-13005":r.OperationRejected,"-13006":r.OperationRejected,"-13007":r.PermissionDenied,"-18002":r.OperationRejected,"-18003":r.OperationRejected,"-18004":r.OperationRejected,"-18005":r.PermissionDenied,"-18006":r.OperationRejected,"-18007":r.OperationRejected,"-21001":r.BadRequest,"-21002":r.BadRequest,"-21003":r.BadResponse,"-21004":r.OperationRejected,"-21005":r.InsufficientFunds,"-21006":r.OperationFailed,"-21007":r.OperationFailed,"-32603":r.BadRequest,400002:r.BadRequest,100001003:r.AuthenticationError,200003903:r.AuthenticationError}},linear:{exact:{"-1005":r.PermissionDenied,"-1008":r.OperationFailed,"-1011":r.PermissionDenied,"-1023":r.BadRequest,"-1099":r.AuthenticationError,"-1109":r.PermissionDenied,"-1110":r.BadRequest,"-1113":r.BadRequest,"-1122":r.BadRequest,"-1126":r.BadSymbol,"-1136":r.BadRequest,"-2012":r.OperationFailed,"-2016":r.OperationRejected,"-2017":r.PermissionDenied,"-2018":r.InsufficientFunds,"-2019":r.InsufficientFunds,"-2020":r.OperationFailed,"-2021":r.OrderImmediatelyFillable,"-2022":r.InvalidOrder,"-2023":r.OperationFailed,"-2024":r.InsufficientFunds,"-2025":r.OperationRejected,"-2026":r.InvalidOrder,"-2027":r.OperationRejected,"-2028":r.OperationRejected,"-4063":r.BadRequest,"-4064":r.BadRequest,"-4065":r.BadRequest,"-4066":r.BadRequest,"-4069":r.BadRequest,"-4070":r.BadRequest,"-4071":r.BadRequest,"-4072":r.OperationRejected,"-4073":r.BadRequest,"-4074":r.OperationRejected,"-4075":r.BadRequest,"-4076":r.OperationRejected,"-4077":r.OperationRejected,"-4078":r.OperationFailed,"-4079":r.BadRequest,"-4080":r.PermissionDenied,"-4081":r.BadRequest,"-4085":r.BadRequest,"-4087":r.PermissionDenied,"-4088":r.PermissionDenied,"-4114":r.BadRequest,"-4115":r.BadRequest,"-4116":r.InvalidOrder,"-4117":r.OperationRejected,"-4118":r.OperationRejected,"-4131":r.OperationRejected,"-4140":r.BadRequest,"-4141":r.OperationRejected,"-4144":r.BadSymbol,"-4164":r.InvalidOrder,"-4136":r.InvalidOrder,"-4165":r.BadRequest,"-4167":r.BadRequest,"-4168":r.BadRequest,"-4169":r.OperationRejected,"-4170":r.OperationRejected,"-4171":r.OperationRejected,"-4172":r.OperationRejected,"-4183":r.BadRequest,"-4184":r.BadRequest,"-4192":r.PermissionDenied,"-4202":r.PermissionDenied,"-4203":r.PermissionDenied,"-4205":r.PermissionDenied,"-4206":r.PermissionDenied,"-4208":r.OperationRejected,"-4209":r.OperationRejected,"-4210":r.BadRequest,"-4211":r.BadRequest,"-4400":r.PermissionDenied,"-4401":r.PermissionDenied,"-4402":r.PermissionDenied,"-4403":r.PermissionDenied,"-5021":r.OrderNotFillable,"-5022":r.OrderNotFillable,"-5024":r.OperationRejected,"-5025":r.OperationRejected,"-5026":r.OperationRejected,"-5027":r.OperationRejected,"-5028":r.BadRequest,"-5037":r.BadRequest,"-5038":r.BadRequest,"-5039":r.BadRequest,"-5040":r.BadRequest,"-5041":r.OperationFailed}},inverse:{exact:{"-1005":r.PermissionDenied,"-1011":r.PermissionDenied,"-1023":r.BadRequest,"-1109":r.AuthenticationError,"-1110":r.BadSymbol,"-1113":r.BadRequest,"-1128":r.BadRequest,"-1136":r.BadRequest,"-2016":r.OperationRejected,"-2018":r.InsufficientFunds,"-2019":r.InsufficientFunds,"-2020":r.OperationFailed,"-2021":r.OrderImmediatelyFillable,"-2022":r.InvalidOrder,"-2023":r.OperationFailed,"-2024":r.BadRequest,"-2025":r.OperationRejected,"-2026":r.InvalidOrder,"-2027":r.OperationRejected,"-2028":r.OperationRejected,"-4086":r.BadRequest,"-4087":r.BadSymbol,"-4088":r.BadRequest,"-4089":r.PermissionDenied,"-4090":r.PermissionDenied,"-4110":r.BadRequest,"-4111":r.BadRequest,"-4112":r.OperationRejected,"-4113":r.OperationRejected,"-4150":r.OperationRejected,"-4151":r.BadRequest,"-4152":r.BadRequest,"-4154":r.BadRequest,"-4155":r.BadRequest,"-4178":r.BadRequest,"-4188":r.BadRequest,"-4192":r.PermissionDenied,"-4194":r.PermissionDenied,"-4195":r.PermissionDenied,"-4196":r.BadRequest,"-4197":r.OperationRejected,"-4198":r.OperationRejected,"-4199":r.BadRequest,"-4200":r.PermissionDenied,"-4201":r.PermissionDenied,"-4202":r.OperationRejected}},option:{exact:{"-1003":r.ExchangeError,"-1004":r.ExchangeError,"-1006":r.ExchangeError,"-1007":r.ExchangeError,"-1008":r.RateLimitExceeded,"-1010":r.ExchangeError,"-1013":r.ExchangeError,"-1108":r.ExchangeError,"-1112":r.ExchangeError,"-1114":r.ExchangeError,"-1128":r.BadSymbol,"-1129":r.BadSymbol,"-1131":r.BadRequest,"-2011":r.ExchangeError,"-2018":r.InsufficientFunds,"-2027":r.InsufficientFunds,"-3029":r.OperationFailed,"-4006":r.ExchangeError,"-4007":r.ExchangeError,"-4008":r.ExchangeError,"-4009":r.ExchangeError,"-4010":r.ExchangeError,"-4011":r.ExchangeError,"-4012":r.ExchangeError,"-4014":r.ExchangeError,"-4015":r.ExchangeError,"-4016":r.ExchangeError,"-4017":r.ExchangeError,"-4018":r.ExchangeError,"-4019":r.ExchangeError,"-4020":r.ExchangeError,"-4021":r.ExchangeError,"-4022":r.ExchangeError,"-4023":r.ExchangeError,"-4024":r.ExchangeError,"-4025":r.ExchangeError,"-4026":r.ExchangeError,"-4027":r.ExchangeError,"-4028":r.ExchangeError,"-4031":r.ExchangeError,"-4032":r.ExchangeError,"-4033":r.ExchangeError,"-4034":r.ExchangeError,"-4035":r.ExchangeError,"-4036":r.ExchangeError,"-4037":r.ExchangeError,"-4038":r.ExchangeError,"-4039":r.ExchangeError,"-4040":r.ExchangeError,"-4041":r.ExchangeError,"-4042":r.ExchangeError,"-4043":r.ExchangeError,"-4044":r.ExchangeError,"-4045":r.ExchangeError,"-4046":r.ExchangeError,"-4047":r.ExchangeError,"-4048":r.ExchangeError,"-4049":r.ExchangeError,"-4050":r.ExchangeError,"-4051":r.ExchangeError,"-4052":r.ExchangeError,"-4053":r.ExchangeError,"-4054":r.ExchangeError,"-4056":r.ExchangeError,"-4057":r.ExchangeError,"-4058":r.ExchangeError,"-4059":r.ExchangeError,"-4060":r.ExchangeError,"-4061":r.ExchangeError,"-4062":r.ExchangeError,"-4063":r.ExchangeError,"-4064":r.ExchangeError,"-4065":r.ExchangeError,"-4066":r.ExchangeError,"-4067":r.ExchangeError,"-4068":r.ExchangeError,"-4069":r.ExchangeError,"-4070":r.ExchangeError,"-4071":r.ExchangeError,"-4072":r.ExchangeError,"-4073":r.ExchangeError,"-4074":r.ExchangeError,"-4075":r.ExchangeError,"-4076":r.ExchangeError,"-4077":r.ExchangeError,"-4078":r.ExchangeError,"-4079":r.ExchangeError,"-4080":r.ExchangeError,"-4081":r.ExchangeError,"-4082":r.ExchangeError,"-4083":r.ExchangeError,"-4084":r.ExchangeError,"-4085":r.ExchangeError,"-4086":r.ExchangeError,"-4087":r.ExchangeError,"-4088":r.ExchangeError,"-4089":r.ExchangeError,"-4091":r.ExchangeError,"-4092":r.ExchangeError,"-4093":r.ExchangeError,"-4094":r.ExchangeError,"-4095":r.ExchangeError,"-4096":r.ExchangeError,"-4097":r.ExchangeError,"-4098":r.ExchangeError,"-4099":r.ExchangeError,"-4101":r.ExchangeError,"-4102":r.ExchangeError,"-4103":r.ExchangeError,"-4104":r.ExchangeError,"-4105":r.ExchangeError,"-4106":r.ExchangeError,"-4107":r.ExchangeError,"-4108":r.ExchangeError,"-4109":r.ExchangeError,"-4110":r.ExchangeError,"-4112":r.ExchangeError,"-4113":r.ExchangeError,"-4114":r.ExchangeError,"-4115":r.ExchangeError,"-4116":r.ExchangeError,"-4117":r.ExchangeError,"-4118":r.ExchangeError,"-4119":r.ExchangeError,"-4120":r.ExchangeError,"-4121":r.ExchangeError,"-4122":r.ExchangeError,"-4123":r.ExchangeError,"-4124":r.ExchangeError,"-4125":r.ExchangeError,"-4126":r.ExchangeError,"-4127":r.ExchangeError,"-4128":r.ExchangeError,"-4129":r.ExchangeError,"-4130":r.ExchangeError,"-4131":r.ExchangeError,"-4132":r.ExchangeError,"-4133":r.ExchangeError,"-4134":r.ExchangeError,"-4135":r.ExchangeError,"-4136":r.ExchangeError,"-4137":r.ExchangeError,"-4138":r.ExchangeError,"-4139":r.ExchangeError,"-4141":r.ExchangeError,"-4142":r.ExchangeError,"-4143":r.ExchangeError,"-4144":r.ExchangeError,"-4145":r.ExchangeError,"-4146":r.ExchangeError,"-4147":r.ExchangeError,"-4148":r.ExchangeError,"-4149":r.ExchangeError,"-4150":r.ExchangeError,"-20121":r.ExchangeError,"-20124":r.ExchangeError,"-20130":r.ExchangeError,"-20132":r.ExchangeError,"-20194":r.ExchangeError,"-20195":r.ExchangeError,"-20196":r.ExchangeError,"-20198":r.ExchangeError,"-20204":r.ExchangeError}},portfolioMargin:{exact:{"-1000":r.OperationFailed,"-1001":r.ExchangeError,"-1002":r.PermissionDenied,"-1003":r.RateLimitExceeded,"-1004":r.BadRequest,"-1005":r.PermissionDenied,"-1006":r.BadResponse,"-1007":r.BadResponse,"-1008":r.OperationFailed,"-1010":r.ExchangeError,"-1011":r.PermissionDenied,"-1013":r.ExchangeError,"-1014":r.InvalidOrder,"-1015":r.InvalidOrder,"-1016":r.NotSupported,"-1020":r.NotSupported,"-1021":r.BadRequest,"-1022":r.BadRequest,"-1023":r.BadRequest,"-1099":r.OperationFailed,"-1100":r.BadRequest,"-1101":r.BadRequest,"-1102":r.BadRequest,"-1103":r.BadRequest,"-1104":r.BadRequest,"-1105":r.BadRequest,"-1106":r.BadRequest,"-1108":r.BadRequest,"-1109":r.BadRequest,"-1110":r.BadSymbol,"-1111":r.BadRequest,"-1112":r.BadRequest,"-1113":r.BadRequest,"-1114":r.BadRequest,"-1115":r.BadRequest,"-1116":r.BadRequest,"-1117":r.BadRequest,"-1118":r.BadRequest,"-1119":r.BadRequest,"-1120":r.BadRequest,"-1121":r.BadSymbol,"-1125":r.BadRequest,"-1127":r.BadRequest,"-1128":r.BadRequest,"-1130":r.BadRequest,"-1131":r.BadRequest,"-1134":r.BadRequest,"-1136":r.BadRequest,"-1145":r.BadRequest,"-1151":r.BadRequest,"-2010":r.InvalidOrder,"-2011":r.OperationRejected,"-2013":r.OrderNotFound,"-2014":r.OperationRejected,"-2015":r.OperationRejected,"-2016":r.OperationFailed,"-2018":r.OperationFailed,"-2019":r.OperationFailed,"-2020":r.OrderNotFillable,"-2021":r.OrderImmediatelyFillable,"-2022":r.InvalidOrder,"-2023":r.OperationFailed,"-2024":r.OperationRejected,"-2025":r.OperationRejected,"-2026":r.InvalidOrder,"-2027":r.OperationRejected,"-2028":r.OperationRejected,"-4000":r.BadRequest,"-4001":r.BadRequest,"-4002":r.BadRequest,"-4003":r.BadRequest,"-4004":r.BadRequest,"-4005":r.BadRequest,"-4006":r.BadRequest,"-4007":r.BadRequest,"-4008":r.BadRequest,"-4009":r.BadRequest,"-4010":r.BadRequest,"-4011":r.BadRequest,"-4012":r.BadRequest,"-4013":r.BadRequest,"-4014":r.BadRequest,"-4015":r.BadRequest,"-4016":r.BadRequest,"-4017":r.BadRequest,"-4018":r.BadRequest,"-4019":r.BadRequest,"-4020":r.BadRequest,"-4021":r.BadRequest,"-4022":r.BadRequest,"-4023":r.BadRequest,"-4024":r.BadRequest,"-4025":r.BadRequest,"-4026":r.BadRequest,"-4027":r.BadRequest,"-4028":r.BadRequest,"-4029":r.BadRequest,"-4030":r.BadRequest,"-4031":r.BadRequest,"-4032":r.BadRequest,"-4033":r.BadRequest,"-4044":r.BadRequest,"-4045":r.BadRequest,"-4046":r.BadRequest,"-4047":r.BadRequest,"-4048":r.BadRequest,"-4049":r.BadRequest,"-4050":r.BadRequest,"-4051":r.BadRequest,"-4052":r.BadRequest,"-4053":r.BadRequest,"-4054":r.BadRequest,"-4055":r.BadRequest,"-4056":r.PermissionDenied,"-4057":r.PermissionDenied,"-4058":r.BadRequest,"-4059":r.BadRequest,"-4060":r.BadRequest,"-4061":r.InvalidOrder,"-4062":r.BadRequest,"-4063":r.BadRequest,"-4064":r.BadRequest,"-4065":r.BadRequest,"-4066":r.BadRequest,"-4067":r.BadRequest,"-4068":r.BadRequest,"-4069":r.BadRequest,"-4070":r.BadRequest,"-4071":r.BadRequest,"-4072":r.OperationRejected,"-4073":r.BadRequest,"-4074":r.BadRequest,"-4075":r.BadRequest,"-4076":r.OperationRejected,"-4077":r.OperationRejected,"-4078":r.OperationFailed,"-4079":r.BadRequest,"-4080":r.PermissionDenied,"-4081":r.BadRequest,"-4082":r.BadRequest,"-4083":r.BadRequest,"-4084":r.NotSupported,"-4085":r.BadRequest,"-4086":r.BadRequest,"-4087":r.PermissionDenied,"-4088":r.PermissionDenied,"-4104":r.BadRequest,"-4114":r.BadRequest,"-4115":r.BadRequest,"-4118":r.OperationRejected,"-4131":r.OperationRejected,"-4135":r.BadRequest,"-4137":r.BadRequest,"-4138":r.BadRequest,"-4139":r.BadRequest,"-4140":r.OrderImmediatelyFillable,"-4141":r.BadRequest,"-4142":r.OrderImmediatelyFillable,"-4144":r.BadSymbol,"-4161":r.OperationRejected,"-4164":r.InvalidOrder,"-4165":r.BadRequest,"-4183":r.InvalidOrder,"-4184":r.InvalidOrder,"-4408":r.InvalidOrder,"-5021":r.OrderNotFillable,"-5022":r.OrderNotFillable,"-5028":r.OperationFailed,"-5041":r.RateLimitExceeded}},exact:{"-1000":r.OperationFailed,"-1001":r.OperationFailed,"-1002":r.AuthenticationError,"-1003":r.RateLimitExceeded,"-1004":r.OperationRejected,"-1006":r.OperationFailed,"-1007":r.RequestTimeout,"-1010":r.OperationFailed,"-1013":r.BadRequest,"-1014":r.InvalidOrder,"-1015":r.RateLimitExceeded,"-1016":r.BadRequest,"-1020":r.BadRequest,"-1021":r.InvalidNonce,"-1022":r.AuthenticationError,"-1100":r.BadRequest,"-1101":r.BadRequest,"-1102":r.BadRequest,"-1103":r.BadRequest,"-1104":r.BadRequest,"-1105":r.BadRequest,"-1106":r.BadRequest,"-1108":r.BadSymbol,"-1111":r.BadRequest,"-1112":r.OperationFailed,"-1114":r.BadRequest,"-1115":r.BadRequest,"-1116":r.BadRequest,"-1117":r.BadRequest,"-1118":r.BadRequest,"-1119":r.BadRequest,"-1120":r.BadRequest,"-1121":r.BadSymbol,"-1125":r.AuthenticationError,"-1127":r.BadRequest,"-1128":r.BadRequest,"-1130":r.BadRequest,"-2010":r.InvalidOrder,"-2011":r.OrderNotFound,"-2013":r.OrderNotFound,"-2014":r.AuthenticationError,"-2015":r.AuthenticationError,"-4000":r.InvalidOrder,"-4001":r.BadRequest,"-4002":r.BadRequest,"-4003":r.BadRequest,"-4004":r.BadRequest,"-4005":r.BadRequest,"-4006":r.BadRequest,"-4007":r.BadRequest,"-4008":r.BadRequest,"-4009":r.BadRequest,"-4010":r.BadRequest,"-4011":r.BadRequest,"-4012":r.BadRequest,"-4013":r.BadRequest,"-4014":r.BadRequest,"-4015":r.BadRequest,"-4016":r.BadRequest,"-4017":r.BadRequest,"-4018":r.BadRequest,"-4019":r.OperationRejected,"-4020":r.BadRequest,"-4021":r.BadRequest,"-4022":r.BadRequest,"-4023":r.BadRequest,"-4024":r.BadRequest,"-4025":r.BadRequest,"-4026":r.BadRequest,"-4027":r.BadRequest,"-4028":r.BadRequest,"-4029":r.BadRequest,"-4030":r.BadRequest,"-4031":r.BadRequest,"-4032":r.OperationRejected,"-4033":r.BadRequest,"-4044":r.BadRequest,"-4045":r.OperationRejected,"-4046":r.OperationRejected,"-4047":r.OperationRejected,"-4048":r.OperationRejected,"-4049":r.BadRequest,"-4050":r.InsufficientFunds,"-4051":r.InsufficientFunds,"-4052":r.OperationRejected,"-4053":r.BadRequest,"-4054":r.OperationRejected,"-4055":r.BadRequest,"-4056":r.AuthenticationError,"-4057":r.AuthenticationError,"-4058":r.BadRequest,"-4059":r.OperationRejected,"-4060":r.BadRequest,"-4061":r.OperationRejected,"-4062":r.BadRequest,"-4067":r.OperationRejected,"-4068":r.OperationRejected,"-4082":r.BadRequest,"-4083":r.OperationRejected,"-4084":r.BadRequest,"-4086":r.BadRequest,"-4104":r.BadRequest,"-4135":r.BadRequest,"-4137":r.BadRequest,"-4138":r.BadRequest,"-4139":r.BadRequest,"-4142":r.OrderImmediatelyFillable,"-20121":r.BadSymbol,"-20124":r.BadRequest,"-20130":r.BadRequest,"-20132":r.BadRequest,"-20194":r.BadRequest,"-20195":r.BadRequest,"-20196":r.BadRequest,"-20198":r.OperationRejected,"-20204":r.BadRequest,"System is under maintenance.":r.OnMaintenance,"System abnormality":r.OperationFailed,"You are not authorized to execute this request.":r.PermissionDenied,"API key does not exist":r.AuthenticationError,"Order would trigger immediately.":r.OrderImmediatelyFillable,"Stop price would trigger immediately.":r.OrderImmediatelyFillable,"Order would immediately match and take.":r.OrderImmediatelyFillable,"Account has insufficient balance for requested action.":r.InsufficientFunds,"Rest API trading is not enabled.":r.PermissionDenied,"This account may not place or cancel orders.":r.PermissionDenied,"You don't have permission.":r.PermissionDenied,"Market is closed.":r.MarketClosed,"Too many requests. Please try again later.":r.RateLimitExceeded,"This action is disabled on this account.":r.AccountSuspended,"Limit orders require GTC for this phase.":r.BadRequest,"This order type is not possible in this trading phase.":r.BadRequest,"This type of sub-account exceeds the maximum number limit":r.OperationRejected,"This symbol is restricted for this account.":r.PermissionDenied,"This symbol is not permitted for this account.":r.PermissionDenied},broad:{"has no operation privilege":r.PermissionDenied,MAX_POSITION:r.BadRequest,PERCENT_PRICE_BY_SIDE:r.InvalidOrder}},rollingWindowSize:6e4})}isInverse(t,e=void 0){return void 0===e?"delivery"===t:"inverse"===e}isLinear(t,e=void 0){return void 0===e?"future"===t||"swap"===t:"linear"===e}setSandboxMode(t){super.setSandboxMode(t),this.options.sandboxMode=t}createExpiredOptionMarket(t){const e="USDT",i=t.split("-"),s=t.split("/");let r;r=t.indexOf("/")>-1?this.safeString(s,0):this.safeString(i,0);const a=this.safeString(i,1),n=this.safeInteger(i,2),o=this.safeString(i,2),d=this.safeString(i,3),c=this.convertExpireDate(a);return{id:r+"-"+a+"-"+o+"-"+d,symbol:r+"/"+e+":"+e+"-"+a+"-"+o+"-"+d,base:r,quote:e,baseId:r,quoteId:e,active:void 0,type:"option",linear:void 0,inverse:void 0,spot:!1,swap:!1,future:!1,option:!0,margin:!1,contract:!0,contractSize:void 0,expiry:this.parse8601(c),expiryDatetime:c,optionType:"C"===d?"call":"put",strike:n,settle:e,settleId:e,precision:{amount:void 0,price:void 0},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:void 0}}market(t){if(void 0===this.markets)throw new r.ExchangeError(this.id+" markets not loaded");let e=this.safeString(this.options,"defaultType");const i=this.safeString(this.options,"defaultSubType"),s="future"===e,a="delivery"===e,n=s||a;if("string"==typeof t)if(t in this.markets){const e=this.markets[t];if(!n||!e.spot)return e;{const i=t+":"+(s?e.quote:e.base);if(i in this.markets)return this.markets[i]}}else{if(t in this.markets_by_id){const r=this.markets_by_id[t];s?e="linear":a?e="inverse":void 0===e&&(e=i);for(let t=0;t<r.length;t++){const i=r[t];if(i[e])return i}return r[0]}if(t.indexOf("/")>-1&&t.indexOf(":")<0){if(void 0!==e&&"spot"!==e){const[e,i]=t.split("/"),s=t+":"+("USD"===i?e:i);if(s in this.markets)return this.markets[s]}}else if(t.indexOf("-C")>-1||t.indexOf("-P")>-1)return this.createExpiredOptionMarket(t)}throw new r.BadSymbol(this.id+" does not have market symbol "+t)}safeMarket(t=void 0,e=void 0,i=void 0,s=void 0){return void 0!==t&&(t.indexOf("-C")>-1||t.indexOf("-P")>-1)&&!(t in this.markets_by_id)?this.createExpiredOptionMarket(t):super.safeMarket(t,e,i,s)}costToPrecision(t,e){return this.decimalToPrecision(e,n.R3,this.markets[t].precision.quote,this.precisionMode,this.paddingMode)}nonce(){return this.milliseconds()-this.options.timeDifference}enableDemoTrading(t){if(this.isSandboxModeEnabled)throw new r.NotSupported(this.id+" demo trading is not supported in the sandbox environment. Please check https://www.binance.com/en/support/faq/detail/9be58f73e5e14338809e3b705b9687dd to see the differences");if(t)this.urls.apiBackupDemoTrading=this.urls.api,this.urls.api=this.urls.demo;else if("apiBackupDemoTrading"in this.urls){this.urls.api=this.urls.apiBackupDemoTrading;const t=this.omit(this.urls,"apiBackupDemoTrading");this.urls=t}this.options.enableDemoTrading=t}async fetchTime(t={}){const e=this.safeString2(this.options,"fetchTime","defaultType","spot"),i=this.safeString(t,"type",e),s=this.omit(t,"type");let r,a;return[r,t]=this.handleSubTypeAndParams("fetchTime",void 0,t),a=this.isLinear(i,r)?await this.fapiPublicGetTime(s):this.isInverse(i,r)?await this.dapiPublicGetTime(s):await this.publicGetTime(s),this.safeInteger(a,"serverTime")}async fetchCurrencies(t={}){if(!this.safeBool(this.options,"fetchCurrencies"))return{};if(!this.checkRequiredCredentials(!1))return{};if(void 0!==this.safeValue(this.urls,"apiBackup"))return{};if(this.safeBool(this.options,"enableDemoTrading",!1))return{};const e=[this.sapiGetCapitalConfigGetall(t)],i=this.safeBool(this.options,"fetchMargins",!1);i&&e.push(this.sapiGetMarginAllPairs(t));const s=await Promise.all(e),r=s[0];let n;if(i){const t=s[1];n=this.indexBy(t,"assetName")}const o={};for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString(e,"coin"),s=this.safeString(e,"name"),d=this.safeCurrencyCode(i),c=this.safeBool(e,"isLegalMoney");let h,l=!0,u=!0;const p=this.safeList(e,"networkList",[]),f={};let m;const g={};for(let t=0;t<p.length;t++){const e=p[t],i=this.safeString(e,"network"),s=this.networkIdToCode(i),r="ETF"===i,n=this.safeNumber(e,"withdrawFee"),o=this.safeBool(e,"depositEnable"),d=this.safeBool(e,"withdrawEnable");u=u||o,l=l||d,f[i]=n;(this.safeBool(e,"isDefault")||void 0===m)&&(m=n);const y=this.safeString(e,"withdrawIntegerMultiple");let v=y;a.Y.stringEq(y,"0")?c||r||(v=this.omitZero(this.safeString(e,"withdrawInternalMin")),void 0===v&&(v=this.safeString(this.options,"defaultWithdrawPrecision"))):h=void 0===h?y:a.Y.stringMin(h,y),g[s]={info:e,id:i,network:s,active:o&&d,deposit:o,withdraw:d,fee:n,precision:this.parseNumber(v),limits:{withdraw:{min:this.safeNumber(e,"withdrawMin"),max:this.safeNumber(e,"withdrawMax")},deposit:{min:this.safeNumber(e,"depositDust"),max:void 0}}}}const y=this.safeBool(e,"trading"),v=l&&u&&y,b=this.safeDict(n,i,{});o[d]={id:i,name:s,code:d,type:c?"fiat":"crypto",precision:this.parseNumber(h),info:e,active:v,deposit:u,withdraw:l,networks:g,fee:m,fees:f,limits:this.limits,margin:this.safeBool(b,"isBorrowable")}}return o}async fetchMarkets(t={}){const e=[];let i;const s=["spot","linear","inverse"],a=this.safeDict(this.options,"fetchMarkets");i=void 0!==a?this.safeList(a,"types",s):this.safeList(this.options,"fetchMarkets",s);this.safeBool(this.options,"loadAllOptions",!1)&&(this.inArray("option",i)||i.push("option"));const n=this.safeBool(this.options,"sandboxMode",!1),o=this.safeBool(this.options,"enableDemoTrading",!1)||n,d=[];for(let t=0;t<i.length;t++){const e=i[t];"option"===e&&o||d.push(e)}const c=this.safeBool(this.options,"fetchMargins",!1);for(let i=0;i<d.length;i++){const s=d[i];if("spot"===s)e.push(this.publicGetExchangeInfo(t)),c&&this.checkRequiredCredentials(!1)&&!o&&(e.push(this.sapiGetMarginAllPairs(t)),e.push(this.sapiGetMarginIsolatedAllPairs(t)));else if("linear"===s)e.push(this.fapiPublicGetExchangeInfo(t));else if("inverse"===s)e.push(this.dapiPublicGetExchangeInfo(t));else{if("option"!==s)throw new r.ExchangeError(this.id+' fetchMarkets() this.options fetchMarkets "'+s+'" is not a supported market type');e.push(this.eapiPublicGetExchangeInfo(t))}}const h=await Promise.all(e);let l=[];this.options.crossMarginPairsData=[],this.options.isolatedMarginPairsData=[];for(let t=0;t<h.length;t++){const e=this.safeValue(h,t);if(c&&Array.isArray(e)){const t=Object.keys(this.indexBy(e,"symbol"));0===this.options.crossMarginPairsData.length?this.options.crossMarginPairsData=t:this.options.isolatedMarginPairsData=t}else{const t=this.safeList2(e,"symbols","optionSymbols",[]);l=this.arrayConcat(l,t)}}this.options.adjustForTimeDifference&&await this.loadTimeDifference();const u=[];for(let t=0;t<l.length;t++)u.push(this.parseMarket(l[t]));return u}parseMarket(t){let e=!1,i=!1,s=!1;const r=this.safeString(t,"underlying"),a=this.safeString(t,"symbol"),n=a.split("-"),o=this.safeString(n,0),d=this.safeStringLower(t,"symbol"),c=this.safeString(t,"baseAsset",o),h=this.safeString(t,"quoteAsset"),l=this.safeCurrencyCode(c),u=this.safeCurrencyCode(h),p=this.safeString(t,"contractType");let f="contractType"in t,m=this.safeInteger2(t,"deliveryDate","expiryDate"),g=this.safeString(t,"marginAsset");"PERPETUAL"===p||41334048e5===m?(m=void 0,e=!0):void 0!==r?(f=!0,s=!0,g=void 0===g?"USDT":g):void 0!==m&&(i=!0);const y=this.safeCurrencyCode(g),v=!f,b=this.safeList(t,"filters",[]),w=this.indexBy(b,"filterType"),S=this.safeString2(t,"status","contractStatus");let k,O,T,P,_=this.fees,A=l+"/"+u;if(f){e?A=A+":"+y:i?A=A+":"+y+"-"+this.yymmdd(m):s&&(P=this.numberToString(this.parseToNumeric(this.safeString(t,"strikePrice"))),A=A+":"+y+"-"+this.yymmdd(m)+"-"+P+"-"+this.safeString(n,3)),k=this.safeNumber2(t,"contractSize","unit",this.parseNumber("1")),O=y===u,T=y===l;const r=O?"linear":"inverse";_=this.safeDict(this.fees,r,{})}let I="TRADING"===S;if(v){const e=this.safeList(t,"permissions",[]);for(let t=0;t<e.length;t++)if("TRD_GRP_003"===e[t]){I=!1;break}}const x=this.safeBool(t,"isMarginTradingAllowed",!1);let E,M,C;if(v){E={cross:this.inArray(a,this.options.crossMarginPairsData),isolated:this.inArray(a,this.options.isolatedMarginPairsData)}}else(O||T)&&(E={cross:!0,isolated:!0});v?M="spot":e?M="swap":i?M="future":s&&(M="option",I=void 0),void 0!==P&&(C=this.parseToNumeric(P));const B={id:a,lowercaseId:d,symbol:A,base:l,quote:u,settle:y,baseId:c,quoteId:h,settleId:g,type:M,spot:v,margin:v&&x,marginModes:E,swap:e,future:i,option:s,active:I,contract:f,linear:O,inverse:T,taker:_.trading.taker,maker:_.trading.maker,contractSize:k,expiry:m,expiryDatetime:this.iso8601(m),strike:C,optionType:this.safeStringLower(t,"side"),precision:{amount:this.parseNumber(this.parsePrecision(this.safeString2(t,"quantityPrecision","quantityScale"))),price:this.parseNumber(this.parsePrecision(this.safeString2(t,"pricePrecision","priceScale"))),base:this.parseNumber(this.parsePrecision(this.safeString(t,"baseAssetPrecision"))),quote:this.parseNumber(this.parsePrecision(this.safeString(t,"quotePrecision")))},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(t,"minQty"),max:this.safeNumber(t,"maxQty")},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:t,created:this.safeInteger(t,"onboardDate")};if("PRICE_FILTER"in w){const t=this.safeDict(w,"PRICE_FILTER",{});B.limits.price={min:this.safeNumber(t,"minPrice"),max:this.safeNumber(t,"maxPrice")},B.precision.price=this.safeNumber(t,"tickSize")}if("LOT_SIZE"in w){const t=this.safeDict(w,"LOT_SIZE",{});B.precision.amount=this.safeNumber(t,"stepSize"),B.limits.amount={min:this.safeNumber(t,"minQty"),max:this.safeNumber(t,"maxQty")}}if("MARKET_LOT_SIZE"in w){const t=this.safeDict(w,"MARKET_LOT_SIZE",{});B.limits.market={min:this.safeNumber(t,"minQty"),max:this.safeNumber(t,"maxQty")}}if("MIN_NOTIONAL"in w||"NOTIONAL"in w){const t=this.safeDict2(w,"MIN_NOTIONAL","NOTIONAL",{});B.limits.cost.min=this.safeNumber2(t,"minNotional","notional"),B.limits.cost.max=this.safeNumber(t,"maxNotional")}return B}parseBalanceHelper(t){const e=this.account();e.used=this.safeString(t,"locked"),e.free=this.safeString(t,"free");const i=this.safeString(t,"interest"),s=this.safeString(t,"borrowed");return e.debt=a.Y.stringAdd(s,i),e}parseBalanceCustom(t,e=void 0,i=void 0,s=!1){const r={info:t};let n;const o="isolated"===i,d="margin"===e||"cross"===i;if(s)for(let i=0;i<t.length;i++){const s=t[i],n=this.account(),o=this.safeString(s,"asset"),c=this.safeCurrencyCode(o);if("linear"===e)n.free=this.safeString(s,"umWalletBalance"),n.used=this.safeString(s,"umUnrealizedPNL");else if("inverse"===e)n.free=this.safeString(s,"cmWalletBalance"),n.used=this.safeString(s,"cmUnrealizedPNL");else if(d){const t=this.safeString(s,"crossMarginBorrowed"),e=this.safeString(s,"crossMarginInterest");n.debt=a.Y.stringAdd(t,e),n.free=this.safeString(s,"crossMarginFree"),n.used=this.safeString(s,"crossMarginLocked"),n.total=this.safeString(s,"crossMarginAsset")}else{const t=this.safeString(s,"umUnrealizedPNL"),e=this.safeString(s,"cmUnrealizedPNL"),i=a.Y.stringAdd(t,e),r=this.safeString(s,"totalWalletBalance");n.total=a.Y.stringAdd(i,r)}r[c]=n}else if(o||"spot"!==e&&!d)if(o){const e=this.safeList(t,"assets");for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString(i,"symbol"),a=this.safeSymbol(s,void 0,void 0,"spot"),n=this.safeDict(i,"baseAsset",{}),o=this.safeDict(i,"quoteAsset",{}),d=this.safeCurrencyCode(this.safeString(n,"asset")),c=this.safeCurrencyCode(this.safeString(o,"asset")),h={};h[d]=this.parseBalanceHelper(n),h[c]=this.parseBalanceHelper(o),r[a]=this.safeBalance(h)}}else if("savings"===e){const e=this.safeList(t,"positionAmountVos",[]);for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString(i,"asset"),a=this.safeCurrencyCode(s),n=this.account(),o=this.safeString(i,"amount");n.total=o,n.used=o,r[a]=n}}else if("funding"===e)for(let e=0;e<t.length;e++){const i=t[e],s=this.account(),n=this.safeString(i,"asset"),o=this.safeCurrencyCode(n);s.free=this.safeString(i,"free");const d=this.safeString(i,"freeze"),c=this.safeString(i,"withdrawing"),h=this.safeString(i,"locked");s.used=a.Y.stringAdd(d,a.Y.stringAdd(h,c)),r[o]=s}else{let e=t;Array.isArray(t)||(e=this.safeList(t,"assets",[]));for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString(i,"asset"),a=this.safeCurrencyCode(s),n=this.account();n.free=this.safeString(i,"availableBalance"),n.used=this.safeString(i,"initialMargin"),n.total=this.safeString2(i,"marginBalance","balance"),r[a]=n}}else{n=this.safeInteger(t,"updateTime");const e=this.safeList2(t,"balances","userAssets",[]);for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString(i,"asset"),n=this.safeCurrencyCode(s),o=this.account();if(o.free=this.safeString(i,"free"),o.used=this.safeString(i,"locked"),d){const t=this.safeString(i,"borrowed"),e=this.safeString(i,"interest");o.debt=a.Y.stringAdd(t,e)}r[n]=o}}return r.timestamp=n,r.datetime=this.iso8601(n),o?r:this.safeBalance(r)}async fetchBalance(t={}){await this.loadMarkets();const e=this.safeString2(this.options,"fetchBalance","defaultType","spot");let i,s,r,a,n,o=this.safeString(t,"type",e);[i,t]=this.handleSubTypeAndParams("fetchBalance",void 0,t),[s,t]=this.handleOptionAndParams2(t,"fetchBalance","papi","portfolioMargin",!1),[r,a]=this.handleMarginModeAndParams("fetchBalance",t),a=this.omit(a,"type");const d={};if(s||"papi"===o)this.isLinear(o,i)?o="linear":this.isInverse(o,i)&&(o="inverse"),s=!0,n=await this.papiGetBalance(this.extend(d,a));else if(this.isLinear(o,i)){let e;o="linear",[e,t]=this.handleOptionAndParams(t,"fetchBalance","useV2",!1),t=this.extend(d,a),n=e?await this.fapiPrivateV2GetAccount(t):await this.fapiPrivateV3GetAccount(t)}else if(this.isInverse(o,i))o="inverse",n=await this.dapiPrivateGetAccount(this.extend(d,a));else if("isolated"===r){const e=this.safeList(t,"symbols");if(a=this.omit(a,"symbols"),void 0!==e){let t="";if(Array.isArray(e)){t=this.marketId(e[0]);for(let i=1;i<e.length;i++){const s=e[i];t+=","+this.marketId(s)}}else t=e;d.symbols=t}n=await this.sapiGetMarginIsolatedAccount(this.extend(d,a))}else n="margin"===o||"cross"===r?await this.sapiGetMarginAccount(this.extend(d,a)):"savings"===o?await this.sapiGetLendingUnionAccount(this.extend(d,a)):"funding"===o?await this.sapiPostAssetGetFundingAsset(this.extend(d,a)):await this.privateGetAccount(this.extend(d,a));return this.parseBalanceCustom(n,o,r,s)}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r={symbol:s.id};let a;if(void 0!==e&&(r.limit=e),s.option)a=await this.eapiPublicGetDepth(this.extend(r,i));else if(s.linear){const t=this.safeValue(i,"rpi",!1);i=this.omit(i,"rpi"),t?(r.limit=1e3,a=await this.fapiPublicGetRpiDepth(this.extend(r,i))):a=await this.fapiPublicGetDepth(this.extend(r,i))}else a=s.inverse?await this.dapiPublicGetDepth(this.extend(r,i)):await this.publicGetDepth(this.extend(r,i));const n=this.safeInteger(a,"T"),o=this.parseOrderBook(a,t,n);return o.nonce=this.safeInteger2(a,"lastUpdateId","u"),o}parseTicker(t,e=void 0){const i=this.safeInteger2(t,"closeTime","time");let s;"time"in t&&(s="contract"),void 0===s&&(s="bidQty"in t?"spot":"contract");const r=this.safeString(t,"symbol"),n=this.safeSymbol(r,e,void 0,s),o=this.safeString(t,"lastPrice"),d=this.safeString(t,"weightedAvgPrice");let c,h;return"baseVolume"in t?(c=this.safeString(t,"baseVolume"),h=a.Y.stringMul(c,d)):(c=this.safeString(t,"volume"),h=this.safeString2(t,"quoteVolume","amount")),this.safeTicker({symbol:n,timestamp:i,datetime:this.iso8601(i),high:this.safeString2(t,"highPrice","high"),low:this.safeString2(t,"lowPrice","low"),bid:this.safeString(t,"bidPrice"),bidVolume:this.safeString(t,"bidQty"),ask:this.safeString(t,"askPrice"),askVolume:this.safeString(t,"askQty"),vwap:d,open:this.safeString2(t,"openPrice","open"),close:o,last:o,previousClose:this.safeString(t,"prevClosePrice"),change:this.safeString(t,"priceChange"),percentage:this.safeString(t,"priceChangePercent"),average:void 0,baseVolume:c,quoteVolume:h,markPrice:this.safeString(t,"markPrice"),indexPrice:this.safeString(t,"indexPrice"),info:t},e)}async fetchStatus(t={}){const e=await this.sapiGetSystemStatus(t),i=this.safeString(e,"status");return{status:this.safeString({0:"ok",1:"maintenance"},i,i),updated:void 0,eta:void 0,url:void 0,info:e}}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r;if(i.option)r=await this.eapiPublicGetTicker(this.extend(s,e));else if(i.linear)r=await this.fapiPublicGetTicker24hr(this.extend(s,e));else if(i.inverse)r=await this.dapiPublicGetTicker24hr(this.extend(s,e));else{const t=this.safeBool(e,"rolling",!1);e=this.omit(e,"rolling"),r=t?await this.publicGetTicker(this.extend(s,e)):await this.publicGetTicker24hr(this.extend(s,e))}if(Array.isArray(r)){const t=this.safeDict(r,0,{});return this.parseTicker(t,i)}return this.parseTicker(r,i)}async fetchBidsAsks(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const i=this.getMarketFromSymbols(t);let s,a,n;if([s,e]=this.handleMarketTypeAndParams("fetchBidsAsks",i,e),[a,e]=this.handleSubTypeAndParams("fetchBidsAsks",i,e),this.isLinear(s,a))n=await this.fapiPublicGetTickerBookTicker(e);else if(this.isInverse(s,a))n=await this.dapiPublicGetTickerBookTicker(e);else{if("spot"!==s)throw new r.NotSupported(this.id+" fetchBidsAsks() does not support "+s+" markets yet");{const i={};void 0!==t&&(i.symbols=this.json(this.marketIds(t))),n=await this.publicGetTickerBookTicker(this.extend(i,e))}}return this.parseTickers(n,t)}async fetchLastPrices(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const i=this.getMarketFromSymbols(t);let s,a,n;if([s,e]=this.handleMarketTypeAndParams("fetchLastPrices",i,e),[a,e]=this.handleSubTypeAndParams("fetchLastPrices",i,e),this.isLinear(s,a))n=await this.fapiPublicV2GetTickerPrice(e);else if(this.isInverse(s,a))n=await this.dapiPublicGetTickerPrice(e);else{if("spot"!==s)throw new r.NotSupported(this.id+" fetchLastPrices() does not support "+s+" markets yet");n=await this.publicGetTickerPrice(e)}return this.parseLastPrices(n,t)}parseLastPrice(t,e=void 0){const i=this.safeInteger(t,"time"),s=void 0===i?"spot":"swap",r=this.safeString(t,"symbol");return{symbol:(e=this.safeMarket(r,e,void 0,s)).symbol,timestamp:i,datetime:this.iso8601(i),price:this.safeNumberOmitZero(t,"price"),side:void 0,info:t}}async fetchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const i=this.getMarketFromSymbols(t);let s,a,n;if([s,e]=this.handleMarketTypeAndParams("fetchTickers",i,e),[a,e]=this.handleSubTypeAndParams("fetchTickers",i,e),this.isLinear(s,a))n=await this.fapiPublicGetTicker24hr(e);else if(this.isInverse(s,a))n=await this.dapiPublicGetTicker24hr(e);else if("spot"===s){const i=this.safeBool(e,"rolling",!1);if(e=this.omit(e,"rolling"),i){t=this.marketSymbols(t);const i={symbols:this.json(this.marketIds(t))};return n=await this.publicGetTicker(this.extend(i,e)),this.parseTickersForRolling(n,t)}{const i={};void 0!==t&&(i.symbols=this.json(this.marketIds(t))),n=await this.publicGetTicker24hr(this.extend(i,e))}}else{if("option"!==s)throw new r.NotSupported(this.id+" fetchTickers() does not support "+s+" markets yet");n=await this.eapiPublicGetTicker(e)}return this.parseTickers(n,t)}parseTickersForRolling(t,e){const i=[];for(let e=0;e<t.length;e++){const s=this.safeString(t[e],"symbol"),r=this.safeMarket(s,void 0,void 0,"spot"),a=this.parseTicker(t[e]);a.symbol=r.symbol,i.push(a)}return this.filterByArray(i,"symbol",e)}async fetchMarkPrice(t,e={}){await this.loadMarkets();const i=this.market(t);let s,a;[s,e]=this.handleMarketTypeAndParams("fetchMarkPrice",i,e,"swap"),[a,e]=this.handleSubTypeAndParams("fetchMarkPrice",i,e,"linear");const n={symbol:i.id};let o;if(this.isLinear(s,a))o=await this.fapiPublicGetPremiumIndex(this.extend(n,e));else{if(!this.isInverse(s,a))throw new r.NotSupported(this.id+" fetchMarkPrice() does not support "+s+" markets yet");o=await this.dapiPublicGetPremiumIndex(this.extend(n,e))}return Array.isArray(o)?this.parseTicker(this.safeDict(o,0,{}),i):this.parseTicker(o,i)}async fetchMarkPrices(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const i=this.getMarketFromSymbols(t);let s,a,n;if([s,e]=this.handleMarketTypeAndParams("fetchMarkPrices",i,e,"swap"),[a,e]=this.handleSubTypeAndParams("fetchMarkPrices",i,e,"linear"),this.isLinear(s,a))n=await this.fapiPublicGetPremiumIndex(e);else{if(!this.isInverse(s,a))throw new r.NotSupported(this.id+" fetchMarkPrices() does not support "+s+" markets yet");n=await this.dapiPublicGetPremiumIndex(e)}return this.parseTickers(n,t)}parseOHLCV(t,e=void 0){const i=this.safeBool(e,"inverse")?7:5;return[this.safeInteger2(t,0,"openTime"),this.safeNumber2(t,1,"open"),this.safeNumber2(t,2,"high"),this.safeNumber2(t,3,"low"),this.safeNumber2(t,4,"close"),this.safeNumber2(t,i,"volume")]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();let a=!1;if([a,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate",!1),a)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,1e3);const n=this.market(t),o=this.safeString(r,"price"),d=this.safeInteger(r,"until");r=this.omit(r,["price","until"]),void 0!==i&&void 0!==d&&void 0===s&&(s=1500),s=void 0===s?500:Math.min(s,1500);const c={interval:this.safeString(this.timeframes,e,e),limit:s},h=n.id;if("index"===o){const t=h.split("_"),e=this.safeString(t,0);c.pair=e}else c.symbol=h;if(void 0!==i&&(c.startTime=i,n.inverse&&i>0)){const t=this.parseTimeframe(e),r=this.sum(i,s*t*1e3-1),a=this.milliseconds();c.endTime=Math.min(a,r)}let l;void 0!==d&&(c.endTime=d),l=n.option?await this.eapiPublicGetKlines(this.extend(c,r)):"mark"===o?n.inverse?await this.dapiPublicGetMarkPriceKlines(this.extend(c,r)):await this.fapiPublicGetMarkPriceKlines(this.extend(c,r)):"index"===o?n.inverse?await this.dapiPublicGetIndexPriceKlines(this.extend(c,r)):await this.fapiPublicGetIndexPriceKlines(this.extend(c,r)):"premiumIndex"===o?n.inverse?await this.dapiPublicGetPremiumIndexKlines(this.extend(c,r)):await this.fapiPublicGetPremiumIndexKlines(this.extend(c,r)):n.linear?await this.fapiPublicGetKlines(this.extend(c,r)):n.inverse?await this.dapiPublicGetKlines(this.extend(c,r)):await this.publicGetKlines(this.extend(c,r));return this.parseOHLCVs(l,n,e,i,s)}parseTrade(t,e=void 0){if("isDustTrade"in t)return this.parseDustTrade(t,e);const i=this.safeInteger2(t,"T","time");let s=this.safeString2(t,"q","qty");s=this.safeString(t,"quantity",s);const r=this.safeString(t,"symbol"),n="isIsolated"in t||"M"in t||"orderListId"in t||"isMaker"in t?"spot":"contract",o=(e=this.safeMarket(r,e,void 0,n)).symbol;let d;const c=this.safeBool2(t,"m","isBuyerMaker");let h,l;if(void 0!==c?d=c?"sell":"buy":"side"in t?d=this.safeStringLower(t,"side"):"isBuyer"in t&&(d=t.isBuyer?"buy":"sell"),"commission"in t&&(l={cost:this.safeString(t,"commission"),currency:this.safeCurrencyCode(this.safeString(t,"commissionAsset"))}),"isMaker"in t&&(h=t.isMaker?"maker":"taker"),"maker"in t&&(h=t.maker?"maker":"taker"),"optionSide"in t||e.option){const e=this.safeCurrencyCode(this.safeString(t,"quoteAsset","USDT"));h=this.safeStringLower(t,"liquidity"),"fee"in t&&(l={cost:this.safeString(t,"fee"),currency:e}),"buy"!==d&&"sell"!==d&&(d="1"===d?"buy":"sell"),"optionSide"in t&&"buy"!==d&&(s=a.Y.stringMul("-1",s))}return this.safeTrade({info:t,timestamp:i,datetime:this.iso8601(i),symbol:o,id:this.safeStringN(t,["t","a","tradeId","id"]),order:this.safeString(t,"orderId"),type:this.safeStringLower(t,"type"),side:d,takerOrMaker:h,price:this.safeString2(t,"p","price"),amount:s,cost:this.safeString2(t,"quoteQty","baseQty"),fee:l},e)}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchTrades","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchTrades",t,e,i,s);const a=this.market(t),n={symbol:a.id};if(!a.option){void 0!==e&&(n.startTime=e,n.endTime=this.sum(e,36e5));const t=this.safeInteger(s,"until");void 0!==t&&(n.endTime=t)}let o,d=this.safeString(this.options,"fetchTradesMethod");if(d=this.safeString2(s,"fetchTradesMethod","method",d),void 0!==i){const t=a.swap||a.future,e=void 0!==d&&d.indexOf("GetHistoricalTrades")>=0?500:1e3;n.limit=t?Math.min(i,e):i}return s=this.omit(s,["until","fetchTradesMethod"]),o=a.option||"eapiPublicGetTrades"===d?await this.eapiPublicGetTrades(this.extend(n,s)):a.linear||"fapiPublicGetAggTrades"===d?await this.fapiPublicGetAggTrades(this.extend(n,s)):a.inverse||"dapiPublicGetAggTrades"===d?await this.dapiPublicGetAggTrades(this.extend(n,s)):await this.publicGetAggTrades(this.extend(n,s)),this.parseTrades(o,a,e,i)}async editSpotOrder(t,e,i,s,a,n=void 0,o={}){await this.loadMarkets();const d=this.market(e);if(!d.spot)throw new r.NotSupported(this.id+" editSpotOrder() does not support "+d.type+" orders");const c=this.editSpotOrderRequest(t,e,i,s,a,n,o),h=await this.privatePostOrderCancelReplace(c),l=this.safeDict(h,"newOrderResponse");return this.parseOrder(l,d)}editSpotOrderRequest(t,e,i,s,o,d=void 0,c={}){const h=this.market(e),l=this.safeStringN(c,["newClientOrderId","clientOrderId","origClientOrderId"]),u={symbol:h.id,side:s.toUpperCase()},p=i.toUpperCase();let f=p;this.isPostOnly("MARKET"===p,"LIMIT_MAKER"===p,c)&&(f="LIMIT_MAKER");const m=this.safeNumber2(c,"stopPrice","triggerPrice");void 0!==m&&("MARKET"===f?f="STOP_LOSS":"LIMIT"===f&&(f="STOP_LOSS_LIMIT")),u.type=f;const g=this.safeList(h.info,"orderTypes");if(!this.inArray(f,g))throw p!==f?new r.InvalidOrder(this.id+" triggerPrice parameter is not allowed for "+e+" "+i+" orders"):new r.InvalidOrder(this.id+" "+i+" is not a valid order type for the "+e+" market");if(void 0===l){const t=this.safeDict(this.options,"broker");if(void 0!==t){const e=this.safeString(t,"spot");void 0!==e&&(u.newClientOrderId=e+this.uuid22())}}else u.newClientOrderId=l;u.newOrderRespType=this.safeValue(this.options.newOrderRespType,i,"RESULT");let y=!1,v=!1,b=!1,w=!1;if("MARKET"===f){if(this.safeBool(this.options,"quoteOrderQty",!0)){const t=this.safeValue2(c,"quoteOrderQty","cost"),e=h.precision.price;if(void 0!==t)u.quoteOrderQty=this.decimalToPrecision(t,n.R3,e,this.precisionMode);else if(void 0!==d){const t=this.numberToString(o),i=this.numberToString(d),s=a.Y.stringMul(t,i);u.quoteOrderQty=this.decimalToPrecision(s,n.R3,e,this.precisionMode)}else w=!0}else w=!0}else"LIMIT"===f?(v=!0,y=!0,w=!0):"STOP_LOSS"===f||"TAKE_PROFIT"===f?(b=!0,w=!0):"STOP_LOSS_LIMIT"===f||"TAKE_PROFIT_LIMIT"===f?(w=!0,b=!0,v=!0,y=!0):"LIMIT_MAKER"===f&&(v=!0,w=!0);if(w&&(u.quantity=this.amountToPrecision(e,o)),v){if(void 0===d)throw new r.InvalidOrder(this.id+" editOrder() requires a price argument for a "+i+" order");u.price=this.priceToPrecision(e,d)}if(y&&void 0===this.safeString(c,"timeInForce")&&(u.timeInForce=this.options.defaultTimeInForce),b){if(void 0===m)throw new r.InvalidOrder(this.id+" editOrder() requires a triggerPrice extra param for a "+i+" order");u.stopPrice=this.priceToPrecision(e,m)}u.cancelReplaceMode="STOP_ON_FAILURE";return void 0===this.safeString2(c,"cancelNewClientOrderId","cancelOrigClientOrderId")&&(u.cancelOrderId=t),"PO"===this.safeString(c,"timeInForce")&&(c=this.omit(c,["timeInForce"])),c=this.omit(c,["quoteOrderQty","cost","stopPrice","newClientOrderId","clientOrderId","postOnly"]),this.extend(u,c)}editContractOrderRequest(t,e,i,s,a,n=void 0,o={}){const d=this.market(e);if(!d.contract)throw new r.NotSupported(this.id+" editContractOrder() does not support "+d.type+" orders");const c={symbol:d.id,side:s.toUpperCase(),orderId:t,quantity:this.amountToPrecision(e,a)},h=this.safeStringN(o,["newClientOrderId","clientOrderId","origClientOrderId"]);return void 0!==n&&(c.price=this.priceToPrecision(e,n)),void 0!==h&&(c.origClientOrderId=h),o=this.omit(o,["clientOrderId","newClientOrderId"]),c}async editContractOrder(t,e,i,s,a,n=void 0,o={}){await this.loadMarkets();const d=this.market(e);let c;if([c,o]=this.handleOptionAndParams2(o,"editContractOrder","papi","portfolioMargin",!1),(d.linear||c)&&void 0===n&&!("priceMatch"in o))throw new r.ArgumentsRequired(this.id+" editOrder() requires a price argument for portfolio margin and linear orders");const h=this.editContractOrderRequest(t,e,i,s,a,n,o);let l;return d.linear?l=c?await this.papiPutUmOrder(this.extend(h,o)):await this.fapiPrivatePutOrder(this.extend(h,o)):d.inverse&&(l=c?await this.papiPutCmOrder(this.extend(h,o)):await this.dapiPrivatePutOrder(this.extend(h,o))),this.parseOrder(l,d)}async editOrder(t,e,i,s,a=void 0,n=void 0,o={}){await this.loadMarkets();const d=this.market(e);if(d.option)throw new r.NotSupported(this.id+" editOrder() does not support "+d.type+" orders");return d.spot?await this.editSpotOrder(t,e,i,s,a,n,o):await this.editContractOrder(t,e,i,s,a,n,o)}async editOrders(t,e={}){await this.loadMarkets();const i=[];let s=[];for(let e=0;e<t.length;e++){const a=t[e],n=this.safeString(a,"symbol");s.push(n);const o=this.safeString(a,"id"),d=this.safeString(a,"type"),c=this.safeString(a,"side"),h=this.safeValue(a,"amount"),l=this.safeValue(a,"price");let u,p=this.safeDict(a,"params",{});if([u,p]=this.handleOptionAndParams2(p,"editOrders","papi","portfolioMargin",!1),u)throw new r.NotSupported(this.id+" editOrders() does not support portfolio margin orders");const f=this.editContractOrderRequest(o,n,d,c,h,l,p);i.push(f)}s=this.marketSymbols(s,void 0,!1,!0,!0);const a=this.market(s[0]);if(a.spot||a.option)throw new r.NotSupported(this.id+" editOrders() does not support "+a.type+" orders");let n,o={batchOrders:i};return o=this.extend(o,e),a.linear?n=await this.fapiPrivatePutBatchOrders(o):a.inverse&&(n=await this.dapiPrivatePutBatchOrders(o)),this.parseOrders(n)}parseOrderStatus(t){return this.safeString({NEW:"open",PARTIALLY_FILLED:"open",ACCEPTED:"open",TRIGGERING:"open",FILLED:"closed",TRIGGERED:"closed",FINISHED:"closed",CANCELED:"canceled",CANCELLED:"canceled",PENDING_CANCEL:"canceling",REJECTED:"rejected",EXPIRED:"expired",EXPIRED_IN_MATCH:"expired"},t,t)}parseOrderType(t){return this.safeString({limit_maker:"limit",stop:"limit",stop_market:"market",take_profit:"limit",take_profit_market:"market",trailing_stop_market:"market"},t,t)}parseOrder(t,e=void 0){const i=this.safeString(t,"code");if(void 0!==i){const s=this.safeString(t,"msg");if("200"!==i&&"success"!==s&&"The operation of cancel all open order is done."!==s)return this.safeOrder({info:t,status:"rejected"},e)}const s=this.parseOrderStatus(this.safeStringN(t,["status","strategyStatus","algoStatus"])),r=this.safeString(t,"symbol"),n="positionSide"in t||"cumQuote"in t?"contract":"spot",o=this.safeSymbol(r,e,void 0,n),d=this.safeString(t,"executedQty","0"),c=this.safeIntegerN(t,["time","createTime","workingTime","transactTime","updateTime"]);let h;if("transactTime"in t||"updateTime"in t){const e=this.safeInteger2(t,"updateTime","transactTime");"open"===s?a.Y.stringGt(d,"0")&&(h=e):"closed"===s&&(h=e)}const l=this.safeInteger2(t,"transactTime","updateTime"),u=this.safeString(t,"avgPrice"),p=this.safeString(t,"price"),f=this.safeString2(t,"origQty","quantity");let m=this.safeString2(t,"cummulativeQuoteQty","cumQuote");m=this.safeString(t,"cumBase",m);const g=this.safeStringLower2(t,"type","orderType"),y=this.safeStringLower(t,"side"),v=this.safeList(t,"fills",[]);let b=this.safeString(t,"timeInForce");"GTX"===b&&(b="PO");const w="limit_maker"===g||"PO"===b,S=this.safeString2(t,"stopPrice","triggerPrice"),k=this.parseNumber(this.omitZero(S)),O=this.safeNumber(t,"fee");let T;return void 0!==O&&(T={currency:this.safeString(t,"quoteAsset"),cost:O,rate:void 0}),this.safeOrder({info:t,id:this.safeStringN(t,["strategyId","orderId","algoId"]),clientOrderId:this.safeStringN(t,["clientOrderId","newClientStrategyId","clientAlgoId"]),timestamp:c,datetime:this.iso8601(c),lastTradeTimestamp:h,lastUpdateTimestamp:l,symbol:o,type:this.parseOrderType(g),timeInForce:b,postOnly:w,reduceOnly:this.safeBool(t,"reduceOnly"),side:y,price:p,triggerPrice:k,amount:f,cost:m,average:u,filled:d,remaining:void 0,status:s,fee:T,trades:v},e)}async createOrders(t,e={}){await this.loadMarkets();const i=[];let s=[];for(let e=0;e<t.length;e++){const r=t[e],a=this.safeString(r,"symbol");s.push(a);const n=this.safeString(r,"type"),o=this.safeString(r,"side"),d=this.safeValue(r,"amount"),c=this.safeValue(r,"price"),h=this.safeDict(r,"params",{}),l=this.createOrderRequest(a,n,o,d,c,h);i.push(l)}s=this.marketSymbols(s,void 0,!1,!0,!0);const a=this.market(s[0]);if(a.spot)throw new r.NotSupported(this.id+" createOrders() does not support "+a.type+" orders");let n,o={batchOrders:i};return o=this.extend(o,e),n=a.linear?await this.fapiPrivatePostBatchOrders(o):a.option?await this.eapiPrivatePostBatchOrders(o):await this.dapiPrivatePostBatchOrders(o),this.parseOrders(n)}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=this.safeString(a,"type",n.type),d=this.safeString(a,"marginMode"),c=this.safeBool2(this.options,"papi","portfolioMargin",!1),h=this.safeBool2(a,"papi","portfolioMargin",c),l=this.safeString2(a,"triggerPrice","stopPrice"),u=this.safeString(a,"stopLossPrice"),p=this.safeString(a,"takeProfitPrice"),f=this.safeString2(a,"trailingPercent","callbackRate"),m=void 0!==l||void 0!==f||void 0!==u||void 0!==p,g=this.safeBool2(a,"sor","SOR",!1),y=this.safeBool(a,"test",!1);a=this.omit(a,["sor","SOR","test"]);const v=this.createOrderRequest(t,e,i,s,r,a);let b;return n.option?b=await this.eapiPrivatePostOrder(v):g?b=y?await this.privatePostSorOrderTest(v):await this.privatePostSorOrder(v):n.linear?h?b=m?await this.papiPostUmConditionalOrder(v):await this.papiPostUmOrder(v):m?(v.algoType="CONDITIONAL",b=await this.fapiPrivatePostAlgoOrder(v)):b=await this.fapiPrivatePostOrder(v):b=n.inverse?h?m?await this.papiPostCmConditionalOrder(v):await this.papiPostCmOrder(v):await this.dapiPrivatePostOrder(v):"margin"===o||void 0!==d||h?h?await this.papiPostMarginOrder(v):await this.sapiPostMarginOrder(v):y?await this.privatePostOrderTest(v):await this.privatePostOrder(v),this.parseOrder(b,n)}createOrderRequest(t,e,i,s,o=void 0,d={}){const c=this.market(t),h=this.safeString(d,"type",c.type),l=this.safeStringN(d,["clientAlgoId","newClientOrderId","clientOrderId"]),u=e.toUpperCase(),p="MARKET"===u,f="LIMIT"===u,m={symbol:c.id,side:i.toUpperCase()};let g,y;[g,d]=this.handleOptionAndParams2(d,"createOrder","papi","portfolioMargin",!1),[y,d]=this.handleMarginModeAndParams("createOrder",d);const v=this.safeBool(d,"reduceOnly",!1);v&&("margin"===h||!c.contract&&void 0!==y)&&(d=this.omit(d,"reduceOnly"),m.sideEffectType="AUTO_REPAY");const b=this.safeString2(d,"triggerPrice","stopPrice"),w=this.safeString(d,"stopLossPrice",b),S=this.safeString(d,"takeProfitPrice"),k=this.safeString(d,"trailingDelta"),O=this.safeString2(d,"trailingTriggerPrice","activationPrice"),T=this.safeStringN(d,["trailingPercent","callbackRate","trailingDelta"]),P=void 0!==T,_=void 0!==w||void 0!==k,A=void 0!==S,I=void 0!==b||P||_||A,x=g&&I,E=void 0!==this.safeString(d,"priceMatch");let M,C=!0,B=e.toUpperCase();if(P)if(c.swap)B="TRAILING_STOP_MARKET",m.callbackRate=T,void 0!==O&&(m.activationPrice=this.priceToPrecision(t,O));else{if("STOP_LOSS"!==B&&"TAKE_PROFIT"!==B&&"STOP_LOSS_LIMIT"!==B&&"TAKE_PROFIT_LIMIT"!==B){const e=this.safeString(d,"stopLossOrTakeProfit");if(d=this.omit(d,"stopLossOrTakeProfit"),"stopLoss"!==e&&"takeProfit"!==e)throw new r.InvalidOrder(this.id+t+" trailingPercent orders require a stopLossOrTakeProfit parameter of either stopLoss or takeProfit");p?"stopLoss"===e?B="STOP_LOSS":"takeProfit"===e&&(B="TAKE_PROFIT"):"stopLoss"===e?B="STOP_LOSS_LIMIT":"takeProfit"===e&&(B="TAKE_PROFIT_LIMIT")}"STOP_LOSS"!==B&&"TAKE_PROFIT"!==B||(C=!1),void 0!==O&&(M=this.priceToPrecision(t,O));const e=a.Y.stringMul(T,"100");m.trailingDelta=e}else _?(M=w,p?B=c.contract?"STOP_MARKET":"STOP_LOSS":f&&(B=c.contract?"STOP":"STOP_LOSS_LIMIT")):A&&(M=S,p?B=c.contract?"TAKE_PROFIT_MARKET":"TAKE_PROFIT":f&&(B=c.contract?"TAKE_PROFIT":"TAKE_PROFIT_LIMIT"));if(c.option){if("market"===e)throw new r.InvalidOrder(this.id+" "+e+" is not a valid order type for the "+t+" market")}else{const i=this.safeList(c.info,"orderTypes");if(!this.inArray(B,i))throw u!==B?new r.InvalidOrder(this.id+" triggerPrice parameter is not allowed for "+t+" "+e+" orders"):new r.InvalidOrder(this.id+" "+e+" is not a valid order type for the "+t+" market")}let N,R=x?"newClientStrategyId":"newClientOrderId";if(c.linear&&c.swap&&I&&!g&&(R="clientAlgoId"),void 0===l){const t=this.safeDict(this.options,"broker",{}),e=c.contract?"x-xcKtGhcu":"x-TKT5PX2F";let i="spot";c.contract&&(i=c.swap&&c.linear?"swap":"inverse");const s=this.safeString(t,i,e);m[R]=s+this.uuid22()}else m[R]=l;g?(N=this.isPostOnly(p,"LIMIT_MAKER"===u,d),N&&(c.contract?m.timeInForce="GTX":B="LIMIT_MAKER")):(N=this.isPostOnly(p,"LIMIT_MAKER"===u,d),(c.spot||"margin"===h)&&(N&&(B="LIMIT_MAKER"),"isolated"===y&&(m.isIsolated=!0))),m.newOrderRespType="spot"!==h&&"margin"!==h||g?"RESULT":this.safeString(this.options.newOrderRespType,e,"FULL");m[x?"strategyType":"type"]=B;const L=this.safeBool(d,"closePosition",!1);let D=!1,q=!1,F=!1,V=!1;if("MARKET"===B)if(c.spot){if(this.safeBool(this.options,"quoteOrderQty",!0)){const t=this.safeString2(d,"quoteOrderQty","cost"),e=c.precision.price;if(void 0!==t)m.quoteOrderQty=this.decimalToPrecision(t,n.R3,e,this.precisionMode);else if(void 0!==o){const t=this.numberToString(s),i=this.numberToString(o),r=a.Y.stringMul(t,i);m.quoteOrderQty=this.decimalToPrecision(r,n.R3,e,this.precisionMode)}else V=!0}else V=!0}else V=!0;else if("LIMIT"===B)q=!0,D=!0,V=!0;else if("STOP_LOSS"===B||"TAKE_PROFIT"===B)F=!0,V=!0,(c.linear||c.inverse)&&C&&(q=!0);else if("STOP_LOSS_LIMIT"===B||"TAKE_PROFIT_LIMIT"===B)V=!0,F=!0,q=!0,D=!0;else if("LIMIT_MAKER"===B)q=!0,V=!0;else if("STOP"===B)V=!0,F=!0,q=!0;else if("STOP_MARKET"===B||"TAKE_PROFIT_MARKET"===B)L||(V=!0),F=!0;else if("TRAILING_STOP_MARKET"===B&&(L||(V=!0),void 0===T))throw new r.InvalidOrder(this.id+" createOrder() requires a trailingPercent param for a "+e+" order");if(V){const e=void 0!==this.safeString(c.precision,"amount");m.quantity=e?this.amountToPrecision(t,s):this.parseToNumeric(s)}if(q&&!E){if(void 0===o)throw new r.InvalidOrder(this.id+" createOrder() requires a price argument for a "+e+" order");const i=void 0!==this.safeString(c.precision,"price");m.price=i?this.priceToPrecision(t,o):this.parseToNumeric(o)}if(F){if(c.contract){if(void 0===M)throw new r.InvalidOrder(this.id+" createOrder() requires a triggerPrice extra param for a "+e+" order")}else if(void 0===k&&void 0===M&&void 0===T)throw new r.InvalidOrder(this.id+" createOrder() requires a triggerPrice, trailingDelta or trailingPercent param for a "+e+" order");void 0!==M&&(c.linear&&c.swap&&!g?m.triggerPrice=this.priceToPrecision(t,M):m.stopPrice=this.priceToPrecision(t,M))}D&&void 0===this.safeString(d,"timeInForce")&&void 0===this.safeString(m,"timeInForce")&&(m.timeInForce=this.safeString(this.options,"defaultTimeInForce")),!g&&c.contract&&N&&(m.timeInForce="GTX"),"PO"===this.safeString(d,"timeInForce")&&(d=this.omit(d,"timeInForce"));const U=this.safeBool(d,"hedged",!1);let j;c.spot||c.option||!U||(v&&(d=this.omit(d,"reduceOnly"),i="buy"===i?"sell":"buy"),m.positionSide="buy"===i?"LONG":"SHORT"),[j,d]=this.handleOptionAndParams(d,"createOrder","selfTradePrevention"),void 0!==j&&c.spot&&(m.selfTradePreventionMode=j.toUpperCase());const G=this.safeNumber(d,"icebergAmount");void 0!==G&&c.spot&&(m.icebergQty=this.amountToPrecision(t,G));const H=this.omit(d,["type","newClientOrderId","clientOrderId","postOnly","stopLossPrice","takeProfitPrice","stopPrice","triggerPrice","trailingTriggerPrice","trailingPercent","quoteOrderQty","cost","test","hedged","icebergAmount"]);return this.extend(m,H)}async createMarketOrderWithCost(t,e,i,s={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketOrderWithCost() supports spot orders only");const a={cost:i};return await this.createOrder(t,"market",e,i,void 0,this.extend(a,s))}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");const s={cost:e};return await this.createOrder(t,"market","buy",e,void 0,this.extend(s,i))}async createMarketSellOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketSellOrderWithCost() supports spot orders only");return i.quoteOrderQty=e,await this.createOrder(t,"market","sell",e,void 0,i)}async fetchOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a=this.safeString2(this.options,"fetchOrder","defaultType","spot"),n=this.safeString(i,"type",a);let o,d;[o,i]=this.handleMarginModeAndParams("fetchOrder",i),[d,i]=this.handleOptionAndParams2(i,"fetchOrder","papi","portfolioMargin",!1);const c={symbol:s.id},h=this.safeBoolN(i,["stop","trigger","conditional"]),l=this.safeStringN(i,["origClientOrderId","clientOrderId","clientAlgoId"]);let u;return void 0!==l?s.option?c.clientOrderId=l:s.linear&&s.swap&&h&&!d?c.clientAlgoId=l:c.origClientOrderId=l:s.linear&&s.swap&&h&&!d?c.algoId=t:c.orderId=t,i=this.omit(i,["type","clientOrderId","origClientOrderId","stop","trigger","conditional","clientAlgoId"]),s.option?u=await this.eapiPrivateGetOrder(this.extend(c,i)):s.linear?u=d?await this.papiGetUmOrder(this.extend(c,i)):h?await this.fapiPrivateGetAlgoOrder(this.extend(c,i)):await this.fapiPrivateGetOrder(this.extend(c,i)):s.inverse?u=d?await this.papiGetCmOrder(this.extend(c,i)):await this.dapiPrivateGetOrder(this.extend(c,i)):"margin"===n||void 0!==o||d?d?u=await this.papiGetMarginOrder(this.extend(c,i)):("isolated"===o&&(c.isIsolated=!0),u=await this.sapiGetMarginOrder(this.extend(c,i))):u=await this.privateGetOrder(this.extend(c,i)),this.parseOrder(u,s)}async fetchOrders(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchOrders() requires a symbol argument");await this.loadMarkets();let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchOrders","paginate"),a)return await this.fetchPaginatedCallDynamic("fetchOrders",t,e,i,s);const n=this.market(t),o=this.safeString2(this.options,"fetchOrders","defaultType",n.type),d=this.safeString(s,"type",o);let c,h;[c,s]=this.handleMarginModeAndParams("fetchOrders",s),[h,s]=this.handleOptionAndParams2(s,"fetchOrders","papi","portfolioMargin",!1);const l=this.safeBoolN(s,["stop","trigger","conditional"]);s=this.omit(s,["stop","trigger","conditional","type"]);let u,p={symbol:n.id};return[p,s]=this.handleUntilOption("endTime",p,s),void 0!==e&&(p.startTime=e),void 0!==i&&(p.limit=i),n.option?u=await this.eapiPrivateGetHistoryOrders(this.extend(p,s)):n.linear?u=h?l?await this.papiGetUmConditionalAllOrders(this.extend(p,s)):await this.papiGetUmAllOrders(this.extend(p,s)):l?await this.fapiPrivateGetAllAlgoOrders(this.extend(p,s)):await this.fapiPrivateGetAllOrders(this.extend(p,s)):n.inverse?u=h?l?await this.papiGetCmConditionalAllOrders(this.extend(p,s)):await this.papiGetCmAllOrders(this.extend(p,s)):await this.dapiPrivateGetAllOrders(this.extend(p,s)):h?u=await this.papiGetMarginAllOrders(this.extend(p,s)):"margin"===d||void 0!==c?("isolated"===c&&(p.isIsolated=!0),u=await this.sapiGetMarginAllOrders(this.extend(p,s))):u=await this.privateGetAllOrders(this.extend(p,s)),this.parseOrders(u,n,e,i)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){let a,n;await this.loadMarkets();const o={};let d,c;[d,s]=this.handleMarginModeAndParams("fetchOpenOrders",s),[c,s]=this.handleOptionAndParams2(s,"fetchOpenOrders","papi","portfolioMargin",!1);const h=this.safeBoolN(s,["stop","trigger","conditional"]);if(void 0!==t){a=this.market(t),o.symbol=a.id;const e=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot"),i="type"in a?a.type:e;n=this.safeString(s,"type",i)}else{if(this.options.warnOnFetchOpenOrdersWithoutSymbol)throw new r.ExchangeError(this.id+" fetchOpenOrders() WARNING: fetching open orders without specifying a symbol has stricter rate limits (10 times more for spot, 40 times more for other markets) compared to requesting with symbol argument. To acknowledge this warning, set "+this.id+'.options["warnOnFetchOpenOrdersWithoutSymbol"] = false to suppress this warning message.');{const t=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot");n=this.safeString(s,"type",t)}}let l,u;if([l,s]=this.handleSubTypeAndParams("fetchOpenOrders",a,s),s=this.omit(s,["type","stop","trigger","conditional"]),"option"===n)void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i),u=await this.eapiPrivateGetOpenOrders(this.extend(o,s));else if(this.isLinear(n,l))u=c?h?await this.papiGetUmConditionalOpenOrders(this.extend(o,s)):await this.papiGetUmOpenOrders(this.extend(o,s)):h?await this.fapiPrivateGetOpenAlgoOrders(this.extend(o,s)):await this.fapiPrivateGetOpenOrders(this.extend(o,s));else if(this.isInverse(n,l))u=c?h?await this.papiGetCmConditionalOpenOrders(this.extend(o,s)):await this.papiGetCmOpenOrders(this.extend(o,s)):await this.dapiPrivateGetOpenOrders(this.extend(o,s));else if("margin"===n||void 0!==d||c)if(c)u=await this.papiGetMarginOpenOrders(this.extend(o,s));else{if("isolated"===d&&(o.isIsolated=!0,void 0===t))throw new r.ArgumentsRequired(this.id+" fetchOpenOrders() requires a symbol argument for isolated markets");u=await this.sapiGetMarginOpenOrders(this.extend(o,s))}else u=await this.privateGetOpenOrders(this.extend(o,s));return this.parseOrders(u,a,e,i)}async fetchOpenOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOpenOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={symbol:s.id};let n;[n,i]=this.handleOptionAndParams2(i,"fetchOpenOrder","papi","portfolioMargin",!1);const o=this.safeBoolN(i,["stop","trigger","conditional"]);i=this.omit(i,["stop","trigger","conditional"]);let d;if(a[n&&o?"strategyId":"orderId"]=t,s.linear)d=n?o?await this.papiGetUmConditionalOpenOrder(this.extend(a,i)):await this.papiGetUmOpenOrder(this.extend(a,i)):await this.fapiPrivateGetOpenOrder(this.extend(a,i));else if(s.inverse)d=n?o?await this.papiGetCmConditionalOpenOrder(this.extend(a,i)):await this.papiGetCmOpenOrder(this.extend(a,i)):await this.dapiPrivateGetOpenOrder(this.extend(a,i));else{if(s.option)throw new r.NotSupported(this.id+" fetchOpenOrder() does not support option markets");if(s.spot)throw new r.NotSupported(this.id+" fetchOpenOrder() does not support spot markets")}return this.parseOrder(d,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchClosedOrders() requires a symbol argument");const a=await this.fetchOrders(t,e,void 0,s),n=this.filterBy(a,"status","closed");return this.filterBySinceLimit(n,e,i)}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchCanceledOrders() requires a symbol argument");const a=await this.fetchOrders(t,e,void 0,s),n=this.filterBy(a,"status","canceled");return this.filterBySinceLimit(n,e,i)}async fetchCanceledAndClosedOrders(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchCanceledAndClosedOrders() requires a symbol argument");const a=await this.fetchOrders(t,e,void 0,s),n=this.filterBy(a,"status","canceled"),o=this.filterBy(a,"status","closed"),d=this.arrayConcat(n,o),c=this.sortBy(d,"timestamp");return this.filterBySinceLimit(c,e,i)}async cancelOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a=this.safeString2(this.options,"cancelOrder","defaultType","spot"),n=this.safeString(i,"type",a);let o,d;[o,i]=this.handleMarginModeAndParams("cancelOrder",i),[d,i]=this.handleOptionAndParams2(i,"cancelOrder","papi","portfolioMargin",!1);const c=this.safeBoolN(i,["stop","trigger","conditional"]),h={symbol:s.id},l=this.safeStringN(i,["origClientOrderId","clientOrderId","newClientStrategyId","clientAlgoId"]);let u;return void 0!==l?s.option?h.clientOrderId=l:s.linear&&s.swap&&c&&!d?h.clientAlgoId=l:d&&c?h.newClientStrategyId=l:h.origClientOrderId=l:d&&c?h.strategyId=t:s.linear&&s.swap&&c&&!d?h.algoId=t:h.orderId=t,i=this.omit(i,["type","origClientOrderId","clientOrderId","newClientStrategyId","stop","trigger","conditional","clientAlgoId"]),s.option?u=await this.eapiPrivateDeleteOrder(this.extend(h,i)):s.linear?u=d?c?await this.papiDeleteUmConditionalOrder(this.extend(h,i)):await this.papiDeleteUmOrder(this.extend(h,i)):c?await this.fapiPrivateDeleteAlgoOrder(this.extend(h,i)):await this.fapiPrivateDeleteOrder(this.extend(h,i)):s.inverse?u=d?c?await this.papiDeleteCmConditionalOrder(this.extend(h,i)):await this.papiDeleteCmOrder(this.extend(h,i)):await this.dapiPrivateDeleteOrder(this.extend(h,i)):"margin"===n||void 0!==o||d?d?u=await this.papiDeleteMarginOrder(this.extend(h,i)):("isolated"===o&&(h.isIsolated=!0),u=await this.sapiDeleteMarginOrder(this.extend(h,i))):u=await this.privateDeleteOrder(this.extend(h,i)),this.parseOrder(u,s)}async cancelAllOrders(t=void 0,e={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let a;[a,e]=this.handleOptionAndParams2(e,"cancelAllOrders","papi","portfolioMargin",!1);const n=this.safeBoolN(e,["stop","trigger","conditional"]),o=this.safeString(e,"type",i.type);let d,c;return e=this.omit(e,["type","stop","trigger","conditional"]),[d,e]=this.handleMarginModeAndParams("cancelAllOrders",e),i.option?c=await this.eapiPrivateDeleteAllOpenOrders(this.extend(s,e)):i.linear?c=a?n?await this.papiDeleteUmConditionalAllOpenOrders(this.extend(s,e)):await this.papiDeleteUmAllOpenOrders(this.extend(s,e)):n?await this.fapiPrivateDeleteAlgoOpenOrders(this.extend(s,e)):await this.fapiPrivateDeleteAllOpenOrders(this.extend(s,e)):i.inverse?c=a?n?await this.papiDeleteCmConditionalAllOpenOrders(this.extend(s,e)):await this.papiDeleteCmAllOpenOrders(this.extend(s,e)):await this.dapiPrivateDeleteAllOpenOrders(this.extend(s,e)):"margin"===o||void 0!==d||a?a?c=await this.papiDeleteMarginAllOpenOrders(this.extend(s,e)):("isolated"===d&&(s.isIsolated=!0),c=await this.sapiDeleteMarginOpenOrders(this.extend(s,e))):c=await this.privateDeleteOpenOrders(this.extend(s,e)),Array.isArray(c)?this.parseOrders(c,i):[this.safeOrder({info:c})]}async cancelOrders(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e);if(!s.contract)throw new r.BadRequest(this.id+" cancelOrders is only supported for swap markets.");const a={symbol:s.id},n=this.safeList2(i,"origClientOrderIdList","clientOrderIds");let o;return void 0!==n?(i=this.omit(i,["clientOrderIds"]),a.origClientOrderIdList=n):a.orderidlist=t,s.linear?o=await this.fapiPrivateDeleteBatchOrders(this.extend(a,i)):s.inverse&&(o=await this.dapiPrivateDeleteBatchOrders(this.extend(a,i))),this.parseOrders(o,s)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,a={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();const n=this.market(e),o=this.safeString(a,"type",n.type);if(a=this.omit(a,"type"),"spot"!==o)throw new r.NotSupported(this.id+" fetchOrderTrades() supports spot markets only");const d={orderId:t};return await this.fetchMyTrades(e,i,s,this.extend(d,a))}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),a)return await this.fetchPaginatedCallDynamic("fetchMyTrades",t,e,i,s);const n={};let o,d,c;void 0!==t&&(o=this.market(t),n.symbol=o.id),[d,s]=this.handleMarketTypeAndParams("fetchMyTrades",o,s);let h,l=this.safeInteger2(s,"until","endTime");if(void 0!==e){const t=e;n.startTime=t;const i=this.milliseconds(),s=6048e5;i-t>=s&&void 0===l&&o.linear&&(l=this.sum(t,s),l=Math.min(l,i))}if(void 0!==l&&(n.endTime=l,s=this.omit(s,["endTime","until"])),void 0!==i&&(("option"===d||o.contract)&&(i=Math.min(i,1e3)),n.limit=i),"option"===d)h=await this.eapiPrivateGetUserTrades(this.extend(n,s));else{if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol argument");let e;[c,s]=this.handleMarginModeAndParams("fetchMyTrades",s),[e,s]=this.handleOptionAndParams2(s,"fetchMyTrades","papi","portfolioMargin",!1),"spot"===d||"margin"===d?e?h=await this.papiGetMarginMyTrades(this.extend(n,s)):"margin"===d||void 0!==c?("isolated"===c&&(n.isIsolated=!0),h=await this.sapiGetMarginMyTrades(this.extend(n,s))):h=await this.privateGetMyTrades(this.extend(n,s)):o.linear?h=e?await this.papiGetUmUserTrades(this.extend(n,s)):await this.fapiPrivateGetUserTrades(this.extend(n,s)):o.inverse&&(h=e?await this.papiGetCmUserTrades(this.extend(n,s)):await this.dapiPrivateGetUserTrades(this.extend(n,s)))}return this.parseTrades(h,o,e,i)}async fetchMyDustTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};void 0!==e&&(r.startTime=e,r.endTime=this.sum(e,7776e6));const a=this.safeStringUpper(s,"type");s=this.omit(s,"type"),void 0!==a&&(r.accountType=a);const n=await this.sapiGetAssetDribblet(this.extend(r,s)),o=this.safeList(n,"userAssetDribblets",[]),d=this.safeInteger(n,"total",0),c=[];for(let t=0;t<d;t++){const e=this.safeList(o[t],"userAssetDribbletDetails",[]);for(let t=0;t<e.length;t++)e[t].isDustTrade=!0,c.push(e[t])}const h=this.parseTrades(c,void 0,e,i);return this.filterBySinceLimit(h,e,i)}parseDustTrade(t,e=void 0){const i=this.safeString(t,"transId"),s=this.safeInteger(t,"operateTime"),r=this.safeString(t,"fromAsset"),n=this.safeCurrencyCode(r),o=this.currency("BNB").code,d=o+"/"+n;let c=!1;d in this.markets&&(c=!0);const h=this.safeString(t,"serviceChargeAmount"),l={currency:o,cost:this.parseNumber(h)};let u,p,f,m,g;c?(u=d,p=this.safeString(t,"transferedAmount"),f=this.safeString(t,"amount"),m="buy"):(u=n+"/"+o,p=this.safeString(t,"amount"),f=this.safeString(t,"transferedAmount"),m="sell"),void 0!==f&&p&&(g=a.Y.stringDiv(f,p));const y=this.parseNumber(p),v=this.parseNumber(g),b=this.parseNumber(f);return{id:undefined,timestamp:s,datetime:this.iso8601(s),symbol:u,order:i,type:undefined,takerOrMaker:undefined,side:m,amount:y,price:v,cost:b,fee:l,info:t}}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n=!1;if([n,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),n)return await this.fetchPaginatedCallDynamic("fetchDeposits",t,e,i,s);const o={},d=this.safeDict(this.options,"legalMoney",{}),c=this.safeBool(s,"fiat",!1);s=this.omit(s,"fiatOnly");const h=this.safeInteger(s,"until");if(s=this.omit(s,"until"),c||t in d){void 0!==t&&(r=this.currency(t)),o.transactionType=0,void 0!==e&&(o.beginTime=e),void 0!==h&&(o.endTime=h);const i=await this.sapiGetFiatOrders(this.extend(o,s));a=this.safeList(i,"data",[])}else{if(void 0!==t&&(r=this.currency(t),o.coin=r.id),void 0!==e){o.startTime=e;let t=this.sum(e,7776e6);void 0!==h&&(t=Math.min(t,h)),o.endTime=t}void 0!==i&&(o.limit=i),a=await this.sapiGetCapitalDepositHisrec(this.extend(o,s))}for(let t=0;t<a.length;t++)a[t].type="deposit";return this.parseTransactions(a,r,e,i)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchWithdrawals",t,e,i,s);const a=this.safeDict(this.options,"legalMoney",{}),n=this.safeBool(s,"fiat",!1);s=this.omit(s,"fiatOnly");const o={},d=this.safeInteger(s,"until");let c,h;if(void 0!==d&&(s=this.omit(s,"until"),o.endTime=d),n||t in a){void 0!==t&&(h=this.currency(t)),o.transactionType=1,void 0!==e&&(o.beginTime=e);const i=await this.sapiGetFiatOrders(this.extend(o,s));c=this.safeList(i,"data",[])}else void 0!==t&&(h=this.currency(t),o.coin=h.id),void 0!==e&&(o.startTime=e,o.endTime=this.sum(e,7776e6)),void 0!==i&&(o.limit=i),c=await this.sapiGetCapitalWithdrawHistory(this.extend(o,s));for(let t=0;t<c.length;t++)c[t].type="withdrawal";return this.parseTransactions(c,h,e,i)}parseTransactionStatusByType(t,e=void 0){if(void 0===e)return t;const i=this.safeDict({deposit:{0:"pending",1:"ok",6:"ok",Processing:"pending",Failed:"failed",Successful:"ok",Refunding:"canceled",Refunded:"canceled","Refund Failed":"failed"},withdrawal:{0:"pending",1:"canceled",2:"pending",3:"failed",4:"pending",5:"failed",6:"ok",Processing:"pending",Failed:"failed",Successful:"ok",Refunding:"canceled",Refunded:"canceled","Refund Failed":"failed"}},e,{});return this.safeString(i,t,t)}parseTransaction(t,e=void 0){const i=this.safeString2(t,"id","orderNo"),s=this.safeString(t,"address");let r=this.safeString(t,"addressTag");void 0!==r&&r.length<1&&(r=void 0);let a=this.safeString(t,"txId");void 0!==a&&a.indexOf("Internal transfer ")>=0&&(a=a.slice(18));const n=this.safeString2(t,"coin","fiatCurrency");let o,d=this.safeCurrencyCode(n,e);o=this.safeInteger2(t,"insertTime","createTime"),void 0===o&&(o=this.parse8601(this.safeString(t,"applyTime")));const c=this.safeInteger2(t,"successTime","updateTime");let h=this.safeString(t,"type");if(void 0===h){const e=this.safeString(t,"transactionType");void 0!==e&&(h="0"===e?"deposit":"withdrawal");const i=this.safeDict(this.options,"legalMoneyCurrenciesById");d=this.safeString(i,d,d)}const l=this.parseTransactionStatusByType(this.safeString(t,"status"),h),u=this.safeNumber(t,"amount"),p=this.safeNumber2(t,"transactionFee","totalFee");let f;void 0!==p&&(f={currency:d,cost:p});const m=this.safeInteger(t,"transferType");let g;void 0!==m&&(g=0!==m);const y=this.safeString(t,"network");return{info:t,id:i,txid:a,timestamp:o,datetime:this.iso8601(o),network:y,address:s,addressTo:s,addressFrom:void 0,tag:r,tagTo:r,tagFrom:void 0,type:h,amount:u,currency:d,status:l,updated:c,internal:g,comment:void 0,fee:f}}parseTransferStatus(t){return this.safeString({CONFIRMED:"ok"},t,t)}parseTransfer(t,e=void 0){const i=this.safeString2(t,"tranId","transactionId"),s=this.safeString2(t,"asset","currency"),r=this.safeCurrencyCode(s,e),a=this.safeNumber(t,"amount"),n=this.safeString(t,"type");let o,d;const c=this.safeDict(this.options,"accountsById",{});if(void 0!==n){const t=n.split("_");o=this.safeValue(t,0),d=this.safeValue(t,1),o=this.safeString(c,o,o),d=this.safeString(c,d,d)}if(void 0!==this.safeInteger(t,"walletType")){const e=this.safeDict(t,"payerInfo",{}),i=this.safeDict(t,"receiverInfo",{});o=this.safeString(e,"accountId"),d=this.safeString(i,"accountId")}const h=this.safeInteger2(t,"timestamp","transactionTime"),l=this.parseTransferStatus(this.safeString(t,"status"));return{info:t,id:i,timestamp:h,datetime:this.iso8601(h),currency:r,amount:a,fromAccount:o,toAccount:d,status:l}}parseIncome(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeString(t,"asset"),r=this.safeInteger(t,"time");return{info:t,symbol:this.safeSymbol(i,e,void 0,"swap"),code:this.safeCurrencyCode(s),timestamp:r,datetime:this.iso8601(r),id:this.safeString(t,"tranId"),amount:this.safeNumber(t,"income")}}async transfer(t,e,i,s,a={}){await this.loadMarkets();const n=this.currency(t),o={asset:n.id,amount:this.currencyToPrecision(t,e)};if(o.type=this.safeString(a,"type"),a=this.omit(a,"type"),void 0===o.type){const t=this.safeString(a,"symbol");let e;void 0!==t&&(e=this.market(t),a=this.omit(a,"symbol"));let n,d=this.convertTypeToAccount(i).toUpperCase(),c=this.convertTypeToAccount(s).toUpperCase();if(void 0!==e&&(n=e.id),"ISOLATED"===d&&void 0===t)throw new r.ArgumentsRequired(this.id+' transfer () requires params["symbol"] when fromAccount is '+i);if("ISOLATED"===c&&void 0===t)throw new r.ArgumentsRequired(this.id+' transfer () requires params["symbol"] when toAccount is '+s);const h=this.safeDict(this.options,"accountsById",{}),l=!(d in h),u=!(c in h);if(l&&void 0===e&&(n=d),u&&void 0===e&&(n=c),l||u){const t="MAIN"===d,e="MAIN"===c;if((l||u)&&("UMFUTURE"===d||"CMFUTURE"===d||("UMFUTURE"===c||"CMFUTURE"===c)||("FUNDING"===d||"FUNDING"===c)||("OPTION"===d||"OPTION"===c)))throw new r.BadRequest(this.id+" transfer () does not allow transfers between "+i+" and "+s);e&&l?(d="ISOLATED_MARGIN",o.fromSymbol=n):t&&u?(c="ISOLATED_MARGIN",o.toSymbol=n):l&&u?(o.fromSymbol=d,o.toSymbol=c,d="ISOLATEDMARGIN",c="ISOLATEDMARGIN"):(l&&(o.fromSymbol=n,d="ISOLATEDMARGIN"),u&&(o.toSymbol=n,c="ISOLATEDMARGIN")),o.type=d+"_"+c}else o.type=d+"_"+c}const d=await this.sapiPostAssetTransfer(this.extend(o,a));return this.parseTransfer(d,n)}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=this.safeBool(s,"internal");s=this.omit(s,"internal");let n,o=!1;if([o,s]=this.handleOptionAndParams(s,"fetchTransfers","paginate"),o&&!a)return await this.fetchPaginatedCallDynamic("fetchTransfers",t,e,i,s);void 0!==t&&(n=this.currency(t));const d={};let c="limit";if(!a){const t=this.safeString2(this.options,"fetchTransfers","defaultType","spot"),e=this.safeString(s,"fromAccount",t),i="future"===e?"spot":"future",a=this.safeString(s,"toAccount",i);let n=this.safeString(s,"type");const o=this.safeDict(this.options,"accountsByType",{}),h=this.safeString(o,e),l=this.safeString(o,a);if(void 0===n){if(void 0===h){const t=Object.keys(o);throw new r.ExchangeError(this.id+" fromAccount parameter must be one of "+t.join(", "))}if(void 0===l){const t=Object.keys(o);throw new r.ExchangeError(this.id+" toAccount parameter must be one of "+t.join(", "))}n=h+"_"+l}d.type=n,c="size"}void 0!==i&&(d[c]=i),void 0!==e&&(d.startTime=e);const h=this.safeInteger(s,"until");let l;void 0!==h&&(s=this.omit(s,"until"),d.endTime=h),l=a?await this.sapiGetPayTransactions(this.extend(d,s)):await this.sapiGetAssetTransfer(this.extend(d,s));const u=this.safeList2(l,"rows","data",[]);return this.parseTransfers(u,n,e,i)}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s={coin:i.id},r=this.safeDict(this.options,"networks",{});let a=this.safeStringUpper(e,"network");a=this.safeString(r,a,a),void 0!==a&&(s.network=a,e=this.omit(e,"network"));const n=await this.sapiGetCapitalDepositAddress(this.extend(s,e));return this.parseDepositAddress(n,i)}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"url"),s=this.safeString(t,"address"),r=this.safeString(t,"currency"),a=this.safeCurrencyCode(r,e),n=this.getNetworkCodeByNetworkUrl(a,i);let o=this.safeString(t,"tag","");return 0===o.length&&(o=void 0),this.checkAddress(s),{info:t,currency:a,network:n,address:s,tag:o}}async fetchTransactionFees(t=void 0,e={}){await this.loadMarkets();const i=await this.sapiGetCapitalConfigGetall(e),s={};for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"coin"),a=this.safeCurrencyCode(r),n=this.safeList(e,"networkList",[]);s[a]={};for(let t=0;t<n.length;t++){const e=n[t],i=this.safeString(e,"network"),r=this.safeCurrencyCode(i),o=this.safeNumber(e,"withdrawFee");s[a][r]=o}}return{withdraw:s,deposit:{},info:i}}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.sapiGetCapitalConfigGetall(e);return this.parseDepositWithdrawFees(i,t,"coin")}parseDepositWithdrawFee(t,e=void 0){const i=this.safeList(t,"networkList",[]),s=this.depositWithdrawFee(t);for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"network"),a=this.networkIdToCode(r),n=this.safeNumber(e,"withdrawFee");!0===this.safeBool(e,"isDefault")&&(s.withdraw={fee:n,percentage:void 0}),s.networks[a]={withdraw:{fee:n,percentage:void 0},deposit:{fee:void 0,percentage:void 0}}}return s}async withdraw(t,e,i,s=void 0,r={}){[s,r]=this.handleWithdrawTagAndParams(s,r),this.checkAddress(i),await this.loadMarkets();const a=this.currency(t),n={coin:a.id,address:i};void 0!==s&&(n.addressTag=s);const o=this.safeDict(this.options,"networks",{});let d=this.safeStringUpper(r,"network");d=this.safeString(o,d,d),void 0!==d&&(n.network=d,r=this.omit(r,"network")),n.amount=this.currencyToPrecision(t,e,d);const c=await this.sapiPostCapitalWithdrawApply(this.extend(n,r));return this.parseTransaction(c,a)}parseTradingFee(t,e=void 0){const i=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(i,e,void 0,"spot"),maker:this.safeNumber2(t,"makerCommission","makerCommissionRate"),taker:this.safeNumber2(t,"takerCommission","takerCommissionRate"),percentage:void 0,tierBased:void 0}}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s=i.type;let r,a;[r,e]=this.handleSubTypeAndParams("fetchTradingFee",i,e),[a,e]=this.handleOptionAndParams2(e,"fetchTradingFee","papi","portfolioMargin",!1);const n=this.isLinear(s,r),o=this.isInverse(s,r),d={symbol:i.id};let c;c=n?a?await this.papiGetUmCommissionRate(this.extend(d,e)):await this.fapiPrivateGetCommissionRate(this.extend(d,e)):o?a?await this.papiGetCmCommissionRate(this.extend(d,e)):await this.dapiPrivateGetCommissionRate(this.extend(d,e)):await this.sapiGetAssetTradeFee(this.extend(d,e));let h=c;return Array.isArray(h)&&(h=this.safeDict(h,0,{})),this.parseTradingFee(h,i)}async fetchTradingFees(t={}){let e,i;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchTradingFees",void 0,t),[i,t]=this.handleSubTypeAndParams("fetchTradingFees",void 0,t,"linear");const s="spot"===e||"margin"===e,r=this.isLinear(e,i),a=this.isInverse(e,i);let n;if(s?n=await this.sapiGetAssetTradeFee(t):r?n=await this.fapiPrivateGetAccountConfig(t):a&&(n=await this.dapiPrivateGetAccount(t)),s){const t={};for(let e=0;e<n.length;e++){const i=this.parseTradingFee(n[e]);t[i.symbol]=i}return t}if(r){const t=Object.keys(this.markets),e={},i=this.safeInteger(n,"feeTier"),s=this.fees.linear.trading.tiers,r=s.maker[i][1],a=s.taker[i][1];for(let s=0;s<t.length;s++){const n=t[s];this.markets[n].linear&&(e[n]={info:{feeTier:i},symbol:n,maker:r,taker:a})}return e}if(a){const t=Object.keys(this.markets),e={},i=this.safeInteger(n,"feeTier"),s=this.fees.inverse.trading.tiers,r=s.maker[i][1],a=s.taker[i][1];for(let s=0;s<t.length;s++){const n=t[s];this.markets[n].inverse&&(e[n]={info:{feeTier:i},symbol:n,maker:r,taker:a})}return e}}async futuresTransfer(t,e,i,s={}){if(i<1||i>4)throw new r.ArgumentsRequired(this.id+" type must be between 1 and 4");await this.loadMarkets();const a=this.currency(t),n={asset:a.id,amount:e,type:i},o=await this.sapiPostFuturesTransfer(this.extend(n,s));return this.parseTransfer(o,a)}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let a;if(i.linear)a=await this.fapiPublicGetPremiumIndex(this.extend(s,e));else{if(!i.inverse)throw new r.NotSupported(this.id+" fetchFundingRate() supports linear and inverse contracts only");a=await this.dapiPublicGetPremiumIndex(this.extend(s,e))}return i.inverse&&(a=a[0]),this.parseFundingRate(a,i)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n=!1;if([n,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),n)return await this.fetchPaginatedCallDeterministic("fetchFundingRateHistory",t,e,i,"8h",s);const o=this.safeString2(this.options,"fetchFundingRateHistory","defaultType","future"),d=this.safeString(s,"type",o);let c,h;void 0!==t&&(c=this.market(t),t=c.symbol,a.symbol=c.id),[h,s]=this.handleSubTypeAndParams("fetchFundingRateHistory",c,s,"linear"),s=this.omit(s,"type"),void 0!==e&&(a.startTime=e);const l=this.safeInteger(s,"until"),u=this.safeInteger(s,"endTime",l);let p;if(s=this.omit(s,["endTime","until"]),void 0!==u&&(a.endTime=u),void 0!==i&&(a.limit=i),this.isLinear(d,h))p=await this.fapiPublicGetFundingRate(this.extend(a,s));else{if(!this.isInverse(d,h))throw new r.NotSupported(this.id+" fetchFundingRateHistory() is not supported for "+d+" markets");p=await this.dapiPublicGetFundingRate(this.extend(a,s))}return this.parseFundingRateHistories(p,c,e,i)}parseFundingRateHistory(t,e=void 0){const i=this.safeInteger(t,"fundingTime");return{info:t,symbol:this.safeSymbol(this.safeString(t,"symbol"),void 0,void 0,"swap"),fundingRate:this.safeNumber(t,"fundingRate"),timestamp:i,datetime:this.iso8601(i)}}async fetchFundingRates(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.safeString2(this.options,"fetchFundingRates","defaultType","future"),s=this.safeString(e,"type",i);let a;[a,e]=this.handleSubTypeAndParams("fetchFundingRates",void 0,e,"linear");const n=this.omit(e,"type");let o;if(this.isLinear(s,a))o=await this.fapiPublicGetPremiumIndex(n);else{if(!this.isInverse(s,a))throw new r.NotSupported(this.id+" fetchFundingRates() supports linear and inverse contracts only");o=await this.dapiPublicGetPremiumIndex(n)}return this.parseFundingRates(o,t)}parseFundingRate(t,e=void 0){const i=this.safeInteger(t,"time"),s=this.safeString(t,"symbol"),r=this.safeSymbol(s,e,void 0,"contract"),a=this.safeNumber(t,"markPrice"),n=this.safeNumber(t,"indexPrice"),o=this.safeNumber(t,"interestRate"),d=this.safeNumber(t,"estimatedSettlePrice"),c=this.safeNumber(t,"lastFundingRate"),h=this.safeInteger(t,"nextFundingTime"),l=this.safeString(t,"fundingIntervalHours");let u;return void 0!==l&&(u=l+"h"),{info:t,symbol:r,markPrice:a,indexPrice:n,interestRate:o,estimatedSettlePrice:d,timestamp:i,datetime:this.iso8601(i),fundingRate:c,fundingTimestamp:h,fundingDatetime:this.iso8601(h),nextFundingRate:void 0,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:u}}parseAccountPositions(t,e=!1){const i=this.safeList(t,"positions"),s=this.safeList(t,"assets",[]),r={};for(let t=0;t<s.length;t++){const e=s[t],i=this.safeString(e,"asset"),n=this.safeCurrencyCode(i),o=this.safeString(e,"crossWalletBalance"),d=this.safeString(e,"crossUnPnl");r[n]={crossMargin:a.Y.stringAdd(o,d),crossWalletBalance:o}}const n=[];for(let t=0;t<i.length;t++){const s=i[t],a=this.safeString(s,"symbol"),o=this.safeMarket(a,void 0,void 0,"contract"),d=o.linear?o.quote:o.base,c=this.safeString(s,"maintMargin");if((!e||"0"!==c&&"0.00000000"!==c)&&d in r){const t=this.parseAccountPosition(this.extend(s,{crossMargin:r[d].crossMargin,crossWalletBalance:r[d].crossWalletBalance}),o);n.push(t)}}return n}parseAccountPosition(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e,void 0,"contract");const s=this.safeString(e,"symbol"),r=this.safeString(t,"leverage"),n=void 0!==r?parseInt(r):void 0,o=this.safeString(t,"initialMargin"),d=this.parseNumber(o);let c;if(void 0!==r){c=a.Y.stringDiv("1",r,8);this.isRoundNumber(1e3%n)||(c=a.Y.stringDiv(a.Y.stringAdd(c,"1e-8"),"1",8))}const h="notional"in t,l=this.safeString(t,"maintMargin"),u=this.parseNumber(l),p=this.safeString(t,"entryPrice");let f=this.parseNumber(p);const m=this.safeString2(t,"notional","notionalValue"),g=a.Y.stringAbs(m),y=this.parseNumber(g);let v=this.safeString(t,"positionAmt"),b=a.Y.stringAbs(v);if(void 0===v){const t=a.Y.stringMul(a.Y.stringMul(r,o),p),i=this.safeString(e,"contractSize");v=a.Y.stringDiv(t,i),b=a.Y.stringDiv(a.Y.stringAdd(v,"0.5"),"1",0)}const w=this.parseNumber(b),S=this.safeDict(this.options,"leverageBrackets",{}),k=this.safeList(S,s,[]);let O;for(let t=0;t<k.length;t++){const e=k[t];if(a.Y.stringLt(g,e[0]))break;O=e[1]}const T=this.parseNumber(O),P=this.safeString(t,"unrealizedProfit"),_=this.parseNumber(P);let A=this.safeInteger(t,"updateTime");0===A&&(A=void 0);let I,x,E,M=this.safeBool(t,"isolated");if(void 0===M){const e=this.safeString(t,"isolatedMargin");M=!a.Y.stringEq(e,"0")}M?(I="isolated",E=this.safeString(t,"isolatedWallet"),x=a.Y.stringAdd(E,P)):(I="cross",E=this.safeString(t,"crossWalletBalance"),x=this.safeString(t,"crossMargin"));const C=this.parseNumber(x);let B,N,R,L,D;const q=this.safeValue(e,"contractSize"),F=this.numberToString(q);if(a.Y.stringEquals(m,"0"))f=void 0;else{if(N=a.Y.stringLt(m,"0")?"short":"long",B=this.parseNumber(a.Y.stringDiv(a.Y.stringAdd(a.Y.stringDiv(l,x),"5e-5"),"1",4)),R=this.parseNumber(a.Y.stringMul(a.Y.stringDiv(P,o,4),"100")),h){let t,e=p;"short"===N?t=a.Y.stringAdd("1",O):(t=a.Y.stringAdd("-1",O),e=a.Y.stringMul("-1",e));const i=a.Y.stringDiv(E,a.Y.stringMul(b,t)),s=a.Y.stringDiv(e,t);L=a.Y.stringAdd(i,s)}else{let t,e=p;"short"===N?t=a.Y.stringSub("1",O):(t=a.Y.stringSub("-1",O),e=a.Y.stringMul("-1",e));const i=a.Y.stringMul(b,F),s=a.Y.stringMul(i,t),r=a.Y.stringSub(a.Y.stringMul(a.Y.stringDiv("1",e),i),E);L=a.Y.stringDiv(s,r)}const t=this.precisionFromString(this.safeString(e.precision,"price")),i=(t+1).toString(),s=new a.Y("5e-"+i).toString(),r=a.Y.stringAdd(s,L);let n=a.Y.stringDiv(r,"1",t);"-"===n[0]&&(n=void 0),D=this.parseNumber(n)}const V="BOTH"!==this.safeString(t,"positionSide");return{info:t,id:void 0,symbol:s,timestamp:A,datetime:this.iso8601(A),initialMargin:d,initialMarginPercentage:this.parseNumber(c),maintenanceMargin:u,maintenanceMarginPercentage:T,entryPrice:f,notional:y,leverage:this.parseNumber(r),unrealizedPnl:_,contracts:w,contractSize:q,marginRatio:B,liquidationPrice:D,markPrice:void 0,collateral:C,marginMode:I,side:N,hedged:V,percentage:R}}parsePositionRisk(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e,void 0,"contract");const s=this.safeString(e,"symbol"),r=this.safeString(t,"isolatedMargin"),n=this.safeDict(this.options,"leverageBrackets",{}),o=this.safeList(n,s,[]),d=this.safeString2(t,"notional","notionalValue"),c=a.Y.stringAbs(d);let h;for(let t=0;t<o.length;t++){const e=o[t];if(a.Y.stringLt(c,e[0]))break;h=e[1]}const l=this.parseNumber(c),u=a.Y.stringAbs(this.safeString(t,"positionAmt")),p=this.parseNumber(u),f=this.safeString(t,"unRealizedProfit"),m=this.parseNumber(f),g=this.omitZero(this.safeString(t,"liquidationPrice")),y=this.parseNumber(g);let v,b,w=this.safeString(t,"marginType");void 0===w&&void 0!==r&&(w=a.Y.stringEq(r,"0")?"cross":"isolated"),a.Y.stringGt(d,"0")?b="long":a.Y.stringLt(d,"0")&&(b="short");const S=this.safeString(t,"entryPrice"),k=this.parseNumber(S),O=this.safeValue(e,"contractSize"),T=this.numberToString(O),P="notional"in t;if("cross"===w){const t=this.safeDict(e,"precision",{}),i=this.safeString(t,"base"),s=this.safeString2(t,"quote","price");if(!(void 0===i&&void 0===s))if(P){let e,i=S;"short"===b?(e=a.Y.stringAdd("1",h),i=a.Y.stringMul("-1",i)):e=a.Y.stringAdd("-1",h);const s=a.Y.stringMul(g,e),r=a.Y.stringAdd(s,i),n=this.precisionFromString(this.safeString2(t,"quote","price"));void 0!==n&&(v=a.Y.stringDiv(a.Y.stringMul(r,u),"1",n))}else{let e,i=S;"short"===b?e=a.Y.stringSub("1",h):(e=a.Y.stringSub("-1",h),i=a.Y.stringMul("-1",i));const s=a.Y.stringMul(u,T),r=a.Y.stringSub(a.Y.stringDiv("1",i),a.Y.stringDiv(e,g)),n=this.precisionFromString(this.safeString(t,"base"));void 0!==n&&(v=a.Y.stringDiv(a.Y.stringMul(s,r),"1",n))}}else v=this.safeString(t,"isolatedMargin");v=void 0===v?"0":v;const _=this.parseNumber(v),A=this.parseNumber(this.omitZero(this.safeString(t,"markPrice")));let I=this.safeInteger(t,"updateTime");0===I&&(I=void 0);const x=this.parseNumber(h);let E=a.Y.stringMul(h,c);void 0===E&&(E=this.safeString(t,"maintMargin"));const M=this.parseNumber(E);let C,B;const N=this.safeString(t,"leverage");if(void 0!==N){const t=parseInt(N),e=this.isRoundNumber(1e3%t);B=a.Y.stringDiv("1",N,8),e||(B=a.Y.stringAdd(B,"1e-8"));const i=a.Y.stringMul(c,B);C=a.Y.stringDiv(i,"1",8)}else{C=this.safeString(t,"initialMargin");const e=a.Y.stringMul(C,"1");B=a.Y.stringDiv(e,c,8)}let R,L;a.Y.stringEquals(v,"0")||(R=this.parseNumber(a.Y.stringDiv(a.Y.stringAdd(a.Y.stringDiv(E,v),"5e-5"),"1",4)),L=this.parseNumber(a.Y.stringMul(a.Y.stringDiv(f,C,4),"100")));const D="BOTH"!==this.safeString(t,"positionSide");return this.safePosition({info:t,id:void 0,symbol:s,contracts:p,contractSize:O,unrealizedPnl:m,leverage:this.parseNumber(N),liquidationPrice:y,collateral:_,notional:l,markPrice:A,entryPrice:k,timestamp:I,initialMargin:this.parseNumber(C),initialMarginPercentage:this.parseNumber(B),maintenanceMargin:M,maintenanceMarginPercentage:x,marginRatio:R,datetime:this.iso8601(I),marginMode:w,marginType:w,side:b,hedged:D,percentage:L,stopLossPrice:void 0,takeProfitPrice:void 0})}async loadLeverageBrackets(t=!1,e={}){await this.loadMarkets();if(void 0===this.safeDict(this.options,"leverageBrackets")||t){const t=this.safeString(this.options,"defaultType","future"),i=this.safeString(e,"type",t),s=this.omit(e,"type");let a,n,o;if([a,e]=this.handleSubTypeAndParams("loadLeverageBrackets",void 0,e,"linear"),[n,e]=this.handleOptionAndParams2(e,"loadLeverageBrackets","papi","portfolioMargin",!1),this.isLinear(i,a))o=n?await this.papiGetUmLeverageBracket(s):await this.fapiPrivateGetLeverageBracket(s);else{if(!this.isInverse(i,a))throw new r.NotSupported(this.id+" loadLeverageBrackets() supports linear and inverse contracts only");o=n?await this.papiGetCmLeverageBracket(s):await this.dapiPrivateV2GetLeverageBracket(s)}this.options.leverageBrackets=this.createSafeDictionary();for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString(e,"symbol"),s=this.safeSymbol(i,void 0,void 0,"contract"),r=this.safeList(e,"brackets",[]),a=[];for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString2(e,"notionalFloor","qtyFloor"),s=this.safeString(e,"maintMarginRatio");a.push([i,s])}this.options.leverageBrackets[s]=a}}return this.options.leverageBrackets}async fetchLeverageTiers(t=void 0,e={}){let i,s,a,n;if(await this.loadMarkets(),[i,e]=this.handleMarketTypeAndParams("fetchLeverageTiers",void 0,e),[s,e]=this.handleSubTypeAndParams("fetchLeverageTiers",void 0,e,"linear"),[a,e]=this.handleOptionAndParams2(e,"fetchLeverageTiers","papi","portfolioMargin",!1),this.isLinear(i,s))n=a?await this.papiGetUmLeverageBracket(e):await this.fapiPrivateGetLeverageBracket(e);else{if(!this.isInverse(i,s))throw new r.NotSupported(this.id+" fetchLeverageTiers() supports linear and inverse contracts only");n=a?await this.papiGetCmLeverageBracket(e):await this.dapiPrivateV2GetLeverageBracket(e)}return this.parseLeverageTiers(n,t,"symbol")}parseMarketLeverageTiers(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e,void 0,"contract");const s=this.safeList(t,"brackets",[]),r=[];for(let t=0;t<s.length;t++){const a=s[t];r.push({tier:this.safeNumber(a,"bracket"),symbol:this.safeSymbol(i,e),currency:e.quote,minNotional:this.safeNumber2(a,"notionalFloor","qtyFloor"),maxNotional:this.safeNumber2(a,"notionalCap","qtyCap"),maintenanceMarginRate:this.safeNumber(a,"maintMarginRatio"),maxLeverage:this.safeNumber(a,"initialLeverage"),info:a})}return r}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.option)throw new r.NotSupported(this.id+" fetchPosition() supports option markets only");const s={symbol:i.id},a=await this.eapiPrivateGetPosition(this.extend(s,e));return this.parseOptionPosition(a[0],i)}async fetchOptionPositions(t=void 0,e={}){await this.loadMarkets();const i={};let s;if(void 0!==(t=this.marketSymbols(t))){let e;if(Array.isArray(t)){if(t.length>1)throw new r.BadRequest(this.id+" fetchPositions() symbols argument cannot contain more than 1 symbol");e=t[0]}else e=t;s=this.market(e),i.symbol=s.id}const a=await this.eapiPrivateGetPosition(this.extend(i,e)),n=[];for(let t=0;t<a.length;t++)n.push(this.parseOptionPosition(a[t],s));return this.filterByArrayPositions(n,"symbol",t,!1)}parseOptionPosition(t,e=void 0){const i=this.safeString(t,"symbol"),s=(e=this.safeMarket(i,e,void 0,"swap")).symbol,r=this.safeStringLower(t,"side");let n=this.safeString(t,"quantity");"long"!==r&&(n=a.Y.stringMul("-1",n));const o=this.safeInteger(t,"time");return this.safePosition({info:t,id:void 0,symbol:s,entryPrice:this.safeNumber(t,"entryPrice"),markPrice:this.safeNumber(t,"markPrice"),notional:this.safeNumber(t,"markValue"),collateral:this.safeNumber(t,"positionCost"),unrealizedPnl:this.safeNumber(t,"unrealizedPNL"),side:r,contracts:this.parseNumber(n),contractSize:void 0,timestamp:o,datetime:this.iso8601(o),hedged:void 0,maintenanceMargin:void 0,maintenanceMarginPercentage:void 0,initialMargin:void 0,initialMarginPercentage:void 0,leverage:void 0,liquidationPrice:void 0,marginRatio:void 0,marginMode:void 0,percentage:void 0})}async fetchPositions(t=void 0,e={}){let i;if([i,e]=this.handleOptionAndParams(e,"fetchPositions","method"),void 0===i){i=void 0===this.safeDict(this.options,"fetchPositions")?this.safeString(this.options,"fetchPositions","positionRisk"):"positionRisk"}if("positionRisk"===i)return await this.fetchPositionsRisk(t,e);if("account"===i)return await this.fetchAccountPositions(t,e);if("option"===i)return await this.fetchOptionPositions(t,e);throw new r.NotSupported(this.id+'.options["fetchPositions"]["method"] or params["method"] = "'+i+'" is invalid, please choose between "account", "positionRisk" and "option"')}async fetchAccountPositions(t=void 0,e={}){if(void 0!==t&&!Array.isArray(t))throw new r.ArgumentsRequired(this.id+" fetchPositions() requires an array argument for symbols");await this.loadMarkets(),await this.loadLeverageBrackets(!1,e);const i=this.safeString(this.options,"defaultType","future"),s=this.safeString(e,"type",i);let a,n,o,d;if(e=this.omit(e,"type"),[a,e]=this.handleSubTypeAndParams("fetchAccountPositions",void 0,e,"linear"),[n,e]=this.handleOptionAndParams2(e,"fetchAccountPositions","papi","portfolioMargin",!1),this.isLinear(s,a))if(n)o=await this.papiV2GetUmAccount(e);else{let t;[t,e]=this.handleOptionAndParams(e,"fetchAccountPositions","useV2",!1),o=t?await this.fapiPrivateV2GetAccount(e):await this.fapiPrivateV3GetAccount(e)}else{if(!this.isInverse(s,a))throw new r.NotSupported(this.id+" fetchPositions() supports linear and inverse contracts only");o=n?await this.papiGetCmAccount(e):await this.dapiPrivateGetAccount(e)}[d,e]=this.handleOptionAndParams(e,"fetchAccountPositions","filterClosed",!1);const c=this.parseAccountPositions(o,d);return t=this.marketSymbols(t),this.filterByArrayPositions(c,"symbol",t,!1)}async fetchPositionsRisk(t=void 0,e={}){if(void 0!==t&&!Array.isArray(t))throw new r.ArgumentsRequired(this.id+" fetchPositionsRisk() requires an array argument for symbols");await this.loadMarkets(),await this.loadLeverageBrackets(!1,e);const i={};let s="future";s=this.safeString(this.options,"defaultType",s);const n=this.safeString(e,"type",s);let o,d,c;if([o,e]=this.handleSubTypeAndParams("fetchPositionsRisk",void 0,e,"linear"),[d,e]=this.handleOptionAndParams2(e,"fetchPositionsRisk","papi","portfolioMargin",!1),e=this.omit(e,"type"),this.isLinear(n,o))if(d)c=await this.papiGetUmPositionRisk(this.extend(i,e));else{let t;[t,e]=this.handleOptionAndParams(e,"fetchPositionsRisk","useV2",!1),e=this.extend(i,e),c=t?await this.fapiPrivateV2GetPositionRisk(e):await this.fapiPrivateV3GetPositionRisk(e)}else{if(!this.isInverse(n,o))throw new r.NotSupported(this.id+" fetchPositionsRisk() supports linear and inverse contracts only");c=d?await this.papiGetCmPositionRisk(this.extend(i,e)):await this.dapiPrivateGetPositionRisk(this.extend(i,e))}const h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeString(e,"entryPrice");a.Y.stringGt(i,"0")&&h.push(this.parsePositionRisk(c[t]))}return t=this.marketSymbols(t),this.filterByArrayPositions(h,"symbol",t,!1)}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){let a;await this.loadMarkets();let n,o,d={incomeType:"FUNDING_FEE"};if(void 0!==t&&(a=this.market(t),d.symbol=a.id,!a.swap))throw new r.NotSupported(this.id+" fetchFundingHistory() supports swap contracts only");[n,s]=this.handleSubTypeAndParams("fetchFundingHistory",a,s,"linear"),[o,s]=this.handleOptionAndParams2(s,"fetchFundingHistory","papi","portfolioMargin",!1),[d,s]=this.handleUntilOption("endTime",d,s),void 0!==e&&(d.startTime=e),void 0!==i&&(d.limit=i);const c=this.safeString2(this.options,"fetchFundingHistory","defaultType","future"),h=this.safeString(s,"type",c);let l;if(s=this.omit(s,"type"),this.isLinear(h,n))l=o?await this.papiGetUmIncome(this.extend(d,s)):await this.fapiPrivateGetIncome(this.extend(d,s));else{if(!this.isInverse(h,n))throw new r.NotSupported(this.id+" fetchFundingHistory() supports linear and inverse contracts only");l=o?await this.papiGetCmIncome(this.extend(d,s)):await this.dapiPrivateGetIncome(this.extend(d,s))}return this.parseIncomes(l,a,e,i)}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");if(t<1||t>125)throw new r.BadRequest(this.id+" leverage should be between 1 and 125");await this.loadMarkets();const s=this.market(e),a={symbol:s.id,leverage:t};let n,o;if([n,i]=this.handleOptionAndParams2(i,"setLeverage","papi","portfolioMargin",!1),s.linear)o=n?await this.papiPostUmLeverage(this.extend(a,i)):await this.fapiPrivatePostLeverage(this.extend(a,i));else{if(!s.inverse)throw new r.NotSupported(this.id+" setLeverage() supports linear and inverse contracts only");o=n?await this.papiPostCmLeverage(this.extend(a,i)):await this.dapiPrivatePostLeverage(this.extend(a,i))}return o}async setMarginMode(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a symbol argument");if("CROSS"===(t=t.toUpperCase())&&(t="CROSSED"),"ISOLATED"!==t&&"CROSSED"!==t)throw new r.BadRequest(this.id+" marginMode must be either isolated or cross");await this.loadMarkets();const s=this.market(e),a={symbol:s.id,marginType:t};let n;try{if(s.linear)n=await this.fapiPrivatePostMarginType(this.extend(a,i));else{if(!s.inverse)throw new r.NotSupported(this.id+" setMarginMode() supports linear and inverse contracts only");n=await this.dapiPrivatePostMarginType(this.extend(a,i))}}catch(t){if(!(t instanceof r.MarginModeAlreadySet))throw t;if(this.safeBool(this.options,"throwMarginModeAlreadySet",!1))throw t;n={code:-4046,msg:"No need to change margin type."}}return n}async setPositionMode(t,e=void 0,i={}){let s,a,n,o,d;void 0!==e&&(s=this.market(e)),[a,i]=this.handleMarketTypeAndParams("setPositionMode",s,i),[n,i]=this.handleSubTypeAndParams("setPositionMode",s,i),[o,i]=this.handleOptionAndParams2(i,"setPositionMode","papi","portfolioMargin",!1),d=t?"true":"false";const c={dualSidePosition:d};let h;if(this.isInverse(a,n))h=o?await this.papiPostCmPositionSideDual(this.extend(c,i)):await this.dapiPrivatePostPositionSideDual(this.extend(c,i));else{if(!this.isLinear(a,n))throw new r.BadRequest(this.id+" setPositionMode() supports linear and inverse contracts only");h=o?await this.papiPostUmPositionSideDual(this.extend(c,i)):await this.fapiPrivatePostPositionSideDual(this.extend(c,i))}return h}async fetchLeverages(t=void 0,e={}){let i,s,a,n;if(await this.loadMarkets(),await this.loadLeverageBrackets(!1,e),[i,e]=this.handleMarketTypeAndParams("fetchLeverages",void 0,e),[s,e]=this.handleSubTypeAndParams("fetchLeverages",void 0,e,"linear"),[a,e]=this.handleOptionAndParams2(e,"fetchLeverages","papi","portfolioMargin",!1),this.isLinear(i,s))n=a?await this.papiGetUmAccount(e):await this.fapiPrivateGetSymbolConfig(e);else{if(!this.isInverse(i,s))throw new r.NotSupported(this.id+" fetchLeverages() supports linear and inverse contracts only");n=a?await this.papiGetCmAccount(e):await this.dapiPrivateGetAccount(e)}let o=this.safeList(n,"positions",[]);return Array.isArray(n)&&(o=n),this.parseLeverages(o,t,"symbol")}parseLeverage(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeBool(t,"isolated");let r;void 0!==s&&(r=s?"isolated":"cross");const a=this.safeStringLower(t,"marginType");void 0!==a&&(r="crossed"===a?"cross":"isolated");const n=this.safeStringLower(t,"positionSide");let o,d;const c=this.safeInteger(t,"leverage");return void 0===n||"both"===n?(o=c,d=c):"long"===n?o=c:"short"===n&&(d=c),{info:t,symbol:this.safeSymbol(i,e),marginMode:r,longLeverage:o,shortLeverage:d}}async fetchSettlementHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=void 0===t?void 0:this.market(t);let n;if([n,s]=this.handleMarketTypeAndParams("fetchSettlementHistory",a,s),"option"!==n)throw new r.NotSupported(this.id+" fetchSettlementHistory() supports option markets only");const o={};void 0!==t&&(t=a.symbol,o.underlying=a.baseId+a.quoteId),void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i);const d=await this.eapiPublicGetExerciseHistory(this.extend(o,s)),c=this.parseSettlements(d,a),h=this.sortBy(c,"timestamp");return this.filterBySymbolSinceLimit(h,t,e,i)}async fetchMySettlementHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=void 0===t?void 0:this.market(t);let n;if([n,s]=this.handleMarketTypeAndParams("fetchMySettlementHistory",a,s),"option"!==n)throw new r.NotSupported(this.id+" fetchMySettlementHistory() supports option markets only");const o={};void 0!==t&&(o.symbol=a.id,t=a.symbol),void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i);const d=await this.eapiPrivateGetExerciseRecord(this.extend(o,s)),c=this.parseSettlements(d,a),h=this.sortBy(c,"timestamp");return this.filterBySymbolSinceLimit(h,t,e,i)}parseSettlement(t,e){const i=this.safeInteger2(t,"expiryDate","createDate"),s=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(s,e),price:this.safeNumber2(t,"realStrikePrice","exercisePrice"),timestamp:i,datetime:this.iso8601(i)}}parseSettlements(t,e){const i=[];for(let s=0;s<t.length;s++)i.push(this.parseSettlement(t[s],e));return i}async fetchLedgerEntry(t,e=void 0,i={}){let s;if(await this.loadMarkets(),[s,i]=this.handleMarketTypeAndParams("fetchLedgerEntry",void 0,i),"option"!==s)throw new r.BadRequest(this.id+" fetchLedgerEntry() can only be used for type option");this.checkRequiredArgument("fetchLedgerEntry",e,"code");const a=this.currency(e),n={recordId:t,currency:a.id},o=await this.eapiPrivateGetBill(this.extend(n,i)),d=this.safeDict(o,0,o);return this.parseLedgerEntry(d,a)}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a,n,o,d=!1;if([d,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),d)return await this.fetchPaginatedCallDynamic("fetchLedger",t,e,i,s,void 0,!1);void 0!==t&&(o=this.currency(t));const c={};[a,s]=this.handleMarketTypeAndParams("fetchLedger",void 0,s),[n,s]=this.handleSubTypeAndParams("fetchLedger",void 0,s),void 0!==e&&(c.startTime=e),void 0!==i&&(c.limit=i);const h=this.safeInteger(s,"until");let l,u;if(void 0!==h&&(s=this.omit(s,"until"),c.endTime=h),[l,s]=this.handleOptionAndParams2(s,"fetchLedger","papi","portfolioMargin",!1),"option"===a)this.checkRequiredArgument("fetchLedger",t,"code"),c.currency=o.id,u=await this.eapiPrivateGetBill(this.extend(c,s));else if(this.isLinear(a,n))u=l?await this.papiGetUmIncome(this.extend(c,s)):await this.fapiPrivateGetIncome(this.extend(c,s));else{if(!this.isInverse(a,n))throw new r.NotSupported(this.id+" fetchLedger() supports contract wallets only");u=l?await this.papiGetCmIncome(this.extend(c,s)):await this.dapiPrivateGetIncome(this.extend(c,s))}return this.parseLedger(u,o,e,i)}parseLedgerEntry(t,e=void 0){let i,s=this.safeString2(t,"amount","income");a.Y.stringLe(s,"0")?(i="out",s=a.Y.stringMul("-1",s)):i="in";const r=this.safeString(t,"asset"),n=this.safeCurrencyCode(r,e);e=this.safeCurrency(r,e);const o=this.safeInteger2(t,"createDate","time"),d=this.safeString2(t,"type","incomeType");return this.safeLedgerEntry({info:t,id:this.safeString2(t,"id","tranId"),direction:i,account:void 0,referenceAccount:void 0,referenceId:this.safeString(t,"tradeId"),type:this.parseLedgerEntryType(d),currency:n,amount:this.parseNumber(s),timestamp:o,datetime:this.iso8601(o),before:void 0,after:void 0,status:void 0,fee:void 0},e)}parseLedgerEntryType(t){return this.safeString({FEE:"fee",FUNDING_FEE:"fee",OPTIONS_PREMIUM_FEE:"fee",POSITION_LIMIT_INCREASE_FEE:"fee",CONTRACT:"trade",REALIZED_PNL:"trade",TRANSFER:"transfer",CROSS_COLLATERAL_TRANSFER:"transfer",INTERNAL_TRANSFER:"transfer",COIN_SWAP_DEPOSIT:"deposit",COIN_SWAP_WITHDRAW:"withdrawal",OPTIONS_SETTLE_PROFIT:"settlement",DELIVERED_SETTELMENT:"settlement",WELCOME_BONUS:"cashback",CONTEST_REWARD:"cashback",COMMISSION_REBATE:"rebate",API_REBATE:"rebate",REFERRAL_KICKBACK:"referral",COMMISSION:"commission"},t,t)}getNetworkCodeByNetworkUrl(t,e=void 0){if(void 0===e)return;let i;const s=this.currency(t),r=this.safeDict(s,"networks",{}),a=Object.keys(r);for(let t=0;t<a.length;t++){const s=a[t],n=this.safeDict(r[s],"info",{}),o=this.safeString(n,"contractAddressUrl");void 0!==o&&e.startsWith(this.getBaseDomainFromUrl(o))&&(i=s)}return i}getBaseDomainFromUrl(t){if(void 0===t)return;const e=t.split("/"),i=this.safeString(e,0);if(void 0===i)return;const s=this.safeString(e,2);return void 0!==s?i+"//"+s+"/":void 0}sign(t,e="public",i="GET",s={},a=void 0,n=void 0){if(!(e in this.urls.api))throw new r.NotSupported(this.id+" does not have a testnet/sandbox URL for "+e+" endpoints");let l=this.urls.api[e];if(l+="/"+t,"historicalTrades"===t){if(!this.apiKey)throw new r.AuthenticationError(this.id+" historicalTrades endpoint requires `apiKey` credential");a={"X-MBX-APIKEY":this.apiKey}}if("userDataStream"===t||"listenKey"===t){if(!this.apiKey)throw new r.AuthenticationError(this.id+" userDataStream endpoint requires `apiKey` credential");a={"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/x-www-form-urlencoded"},"GET"!==i&&(n=this.urlencode(s))}else if("private"===e||"eapiPrivate"===e||"sapi"===e&&"system/status"!==t||"sapiV2"===e||"sapiV3"===e||"sapiV4"===e||"dapiPrivate"===e||"dapiPrivateV2"===e||"fapiPrivate"===e||"fapiPrivateV2"===e||"fapiPrivateV3"===e||"papiV2"===e||"papi"===e&&"ping"!==t){if(this.checkRequiredCredentials(),l.indexOf("testnet.binancefuture.com")>-1&&this.isSandboxModeEnabled&&!this.safeBool(this.options,"disableFuturesSandboxWarning"))throw new r.NotSupported(this.id+" testnet/sandbox mode is not supported for futures anymore, please check the deprecation announcement https://t.me/ccxt_announcements/92 and consider using the demo trading instead.");if("POST"===i&&("order"===t||"sor/order"===t)){if(void 0===this.safeString(s,"newClientOrderId")){const t=e.indexOf("sapi")>-1||"private"===e,i=t?"spot":"future",r=t?"x-TKT5PX2F":"x-xcKtGhcu",a=this.safeDict(this.options,"broker",{}),n=this.safeString(a,i,r);s.newClientOrderId=n+this.uuid22()}}let u;if("batchOrders"===t&&("POST"===i||"PUT"===i)){const t=this.safeList(s,"batchOrders");let r=t;if("POST"===i&&"fapiPrivate"===e){r=[];for(let e=0;e<t.length;e++){const i=t[e];let s=this.safeString(i,"newClientOrderId");if(void 0===s){const t="x-xcKtGhcu",e=this.safeDict(this.options,"broker",{});s=this.safeString(e,"future",t)+this.uuid22(),i.newClientOrderId=s}r.push(i)}}const a=this.json(r);s.batchOrders=a}const p=this.safeInteger(this.options,"recvWindow");let f=this.extend({timestamp:this.nonce()},s);void 0!==p&&(f.recvWindow=p);const m=this.safeInteger(s,"recvWindow");if(void 0!==m&&(f.recvWindow=m),"sapi"===e&&"asset/dust"===t)u=this.urlencodeWithArrayRepeat(f);else if("batchOrders"===t||t.indexOf("sub-account")>=0||"capital/withdraw/apply"===t||t.indexOf("staking")>=0||t.indexOf("simple-earn")>=0)if("DELETE"===i&&"batchOrders"===t){const t=this.safeList(f,"orderidlist",[]),e=this.safeList2(f,"origclientorderidlist","origClientOrderIdList",[]);f=this.omit(f,["orderidlist","origclientorderidlist","origClientOrderIdList"]),"symbol"in f&&(f.symbol=this.encodeURIComponent(f.symbol)),u=this.rawencode(f);const i=t.length,s=e.length;if(i>0&&(u=u+"&orderidlist=%5B"+t.join("%2C")+"%5D"),s>0){const t=[];for(let i=0;i<s;i++)t.push("%22"+e[i]+"%22");u=u+"&origclientorderidlist=%5B"+t.join("%2C")+"%5D"}}else u=this.rawencode(f);else u=this.urlencode(f);let g;g=this.secret.indexOf("PRIVATE KEY")>-1?this.secret.length>120?this.encodeURIComponent((0,d.n)(u,this.secret,o.s)):this.encodeURIComponent((0,c.q4)(this.encode(u),this.secret,h.ev)):this.hmac(this.encode(u),this.encode(this.secret),o.s),u+="&signature="+g,a={"X-MBX-APIKEY":this.apiKey},"GET"===i||"DELETE"===i?l+="?"+u:(n=u,a["Content-Type"]="application/x-www-form-urlencoded")}else Object.keys(s).length&&(l+="?"+this.urlencode(s));return{url:l,method:i,body:n,headers:a}}getExceptionsByUrl(t,e){let i;const s=void 0!==this.hostname?this.hostname:"binance.com";if(t.startsWith("https://api."+s+"/")||t.startsWith("https://demo-api")||t.startsWith("https://testnet.binance.vision")?i="spot":t.startsWith("https://dapi."+s+"/")||t.startsWith("https://demo-dapi")||t.startsWith("https://testnet.binancefuture.com/dapi")?i="inverse":t.startsWith("https://fapi."+s+"/")||t.startsWith("https://demo-fapi")||t.startsWith("https://testnet.binancefuture.com/fapi")?i="linear":t.startsWith("https://eapi."+s+"/")?i="option":t.startsWith("https://papi."+s+"/")&&(i="portfolioMargin"),void 0!==i){const t=this.safeDict(this.exceptions,i,{});return this.safeDict(t,e,{})}return{}}handleErrors(t,e,i,s,n,o,d,c,h){if(418===t||429===t)throw new r.DDoSProtection(this.id+" "+t.toString()+" "+e+" "+o);if(t>=400){if(o.indexOf("Price * QTY is zero or less")>=0)throw new r.InvalidOrder(this.id+" order cost = amount * price is zero or less "+o);if(o.indexOf("LOT_SIZE")>=0)throw new r.InvalidOrder(this.id+" order amount should be evenly divisible by lot size "+o);if(o.indexOf("PRICE_FILTER")>=0)throw new r.InvalidOrder(this.id+" order price is invalid, i.e. exceeds allowed price precision, exceeds min price or max price limits or is invalid value in general, use this.priceToPrecision (symbol, amount) "+o)}if(void 0===d)return;const l=this.safeBool(d,"success",!0);if(!l){const t=this.safeString(d,"msg");let e;if(void 0!==t){try{e=JSON.parse(t)}catch(t){e=void 0}void 0!==e&&(d=e)}}const u=this.safeString(d,"msg");void 0!==u&&(this.throwExactlyMatchedException(this.getExceptionsByUrl(i,"exact"),u,this.id+" "+u),this.throwExactlyMatchedException(this.exceptions.exact,u,this.id+" "+u),this.throwBroadlyMatchedException(this.getExceptionsByUrl(i,"broad"),u,this.id+" "+u),this.throwBroadlyMatchedException(this.exceptions.broad,u,this.id+" "+u));const p=this.safeString(d,"code");if(void 0!==p){if("200"===p||a.Y.stringEquals(p,"0"))return;if("-2015"===p&&this.options.hasAlreadyAuthenticatedSuccessfully)throw new r.DDoSProtection(this.id+" "+o);const t=this.id+" "+o;if("No need to change margin type."===u)throw new r.MarginModeAlreadySet(t);throw this.throwExactlyMatchedException(this.getExceptionsByUrl(i,"exact"),p,t),this.throwExactlyMatchedException(this.exceptions.exact,p,t),new r.ExchangeError(t)}if(!l)throw new r.ExchangeError(this.id+" "+o);if(Array.isArray(d)){if(1===d.length){const t=d[0],e=this.safeString(t,"code");void 0!==e&&(this.throwExactlyMatchedException(this.getExceptionsByUrl(i,"exact"),e,this.id+" "+o),this.throwExactlyMatchedException(this.exceptions.exact,e,this.id+" "+o))}}}calculateRateLimiterCost(t,e,i,s,r={}){if("noCoin"in r&&!("coin"in s))return r.noCoin;if("noSymbol"in r&&!("symbol"in s))return r.noSymbol;if("noPoolId"in r&&!("poolId"in s))return r.noPoolId;if("byLimit"in r&&"limit"in s){const t=s.limit,e=r.byLimit;for(let i=0;i<e.length;i++){const s=e[i];if(t<=s[0])return s[1]}}return this.safeValue(r,"cost",1)}async request(t,e="public",i="GET",s={},r=void 0,a=void 0,n={}){const o=await this.fetch2(t,e,i,s,r,a,n);return"private"===e&&(this.options.hasAlreadyAuthenticatedSuccessfully=!0),o}async modifyMarginHelper(t,e,i,s={}){let a=this.safeString(this.options,"defaultType","future");"spot"===a&&(a="future");const n=this.safeString(s,"type",a);if("margin"===n||"spot"===n)throw new r.NotSupported(this.id+" add / reduce margin only supported with type future or delivery");await this.loadMarkets();const o=this.market(t);e=this.amountToPrecision(t,e);const d={type:i,symbol:o.id,amount:e};let c,h;return o.linear?(h=o.quote,c=await this.fapiPrivatePostPositionMargin(this.extend(d,s))):(h=o.base,c=await this.dapiPrivatePostPositionMargin(this.extend(d,s))),this.extend(this.parseMarginModification(c,o),{code:h})}parseMarginModification(t,e=void 0){const i=this.safeInteger(t,"type"),s=this.safeString(t,"code"),r=this.safeString(t,"symbol"),a=this.safeInteger(t,"time"),n=void 0===s,o="200"===s;return{info:t,symbol:(e=this.safeMarket(r,e,void 0,"swap")).symbol,type:1===i?"add":"reduce",marginMode:"isolated",amount:this.safeNumber(t,"amount"),code:this.safeString(t,"asset"),total:void 0,status:o||n?"ok":"failed",timestamp:a,datetime:this.iso8601(a)}}async reduceMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,2,i)}async addMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,1,i)}async fetchCrossBorrowRate(t,e={}){await this.loadMarkets();const i={asset:this.currency(t).id},s=await this.sapiGetMarginInterestRateHistory(this.extend(i,e)),r=this.safeDict(s,0);return this.parseBorrowRate(r)}async fetchIsolatedBorrowRate(t,e={}){const i={symbol:t},s=await this.fetchIsolatedBorrowRates(this.extend(i,e));return this.safeDict(s,t)}async fetchIsolatedBorrowRates(t={}){await this.loadMarkets();const e={},i=this.safeString(t,"symbol");if(t=this.omit(t,"symbol"),void 0!==i){const t=this.market(i);e.symbol=t.id}const s=await this.sapiGetMarginIsolatedMarginData(this.extend(e,t));return this.parseIsolatedBorrowRates(s)}async fetchBorrowRateHistory(t,e=void 0,i=void 0,s={}){if(await this.loadMarkets(),void 0===i)i=93;else if(i>93)throw new r.BadRequest(this.id+" fetchBorrowRateHistory() limit parameter cannot exceed 92");const a={asset:this.currency(t).id,limit:i};if(void 0!==e){a.startTime=e;const t=this.sum(e,864e5*i)-1,s=this.milliseconds();a.endTime=Math.min(t,s)}const n=await this.sapiGetMarginInterestRateHistory(this.extend(a,s));return this.parseBorrowRateHistory(n,t,e,i)}parseBorrowRate(t,e=void 0){const i=this.safeInteger(t,"timestamp"),s=this.safeString(t,"asset");return{currency:this.safeCurrencyCode(s,e),rate:this.safeNumber(t,"dailyInterestRate"),period:864e5,timestamp:i,datetime:this.iso8601(i),info:t}}parseIsolatedBorrowRate(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e,void 0,"spot");const s=this.safeList(t,"data"),r=this.safeDict(s,0),a=this.safeDict(s,1);return{info:t,symbol:this.safeString(e,"symbol"),base:this.safeString(r,"coin"),baseRate:this.safeNumber(r,"dailyInterest"),quote:this.safeString(a,"coin"),quoteRate:this.safeNumber(a,"dailyInterest"),period:864e5,timestamp:void 0,datetime:void 0}}async createGiftCode(t,e,i={}){await this.loadMarkets();const s={token:this.currency(t).id,amount:e},r=await this.sapiPostGiftcardCreateCode(this.extend(s,i)),a=this.safeDict(r,"data"),n=this.safeString(a,"code");return{info:r,id:this.safeString(a,"referenceNo"),code:n,currency:t,amount:e}}async redeemGiftCode(t,e={}){const i={code:t};return await this.sapiPostGiftcardRedeemCode(this.extend(i,e))}async verifyGiftCode(t,e={}){const i={referenceNo:t};return await this.sapiGetGiftcardVerify(this.extend(i,e))}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),[a,r]=this.handleOptionAndParams2(r,"fetchBorrowInterest","papi","portfolioMargin",!1);let n,o,d={};if(void 0!==t){const e=this.currency(t);d.asset=e.id}void 0!==i&&(d.startTime=i),void 0!==s&&(d.size=s),[d,r]=this.handleUntilOption("endTime",d,r),a?o=await this.papiGetMarginMarginInterestHistory(this.extend(d,r)):(void 0!==e&&(n=this.market(e),d.isolatedSymbol=n.id),o=await this.sapiGetMarginInterestHistory(this.extend(d,r)));const c=this.safeList(o,"rows"),h=this.parseBorrowInterests(c,n);return this.filterByCurrencySinceLimit(h,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"isolatedSymbol"),s=this.safeInteger(t,"interestAccuredTime"),r=void 0===i?"cross":"isolated";return{info:t,symbol:i,currency:this.safeCurrencyCode(this.safeString(t,"asset")),interest:this.safeNumber(t,"interest"),interestRate:this.safeNumber(t,"interestRate"),amountBorrowed:this.safeNumber(t,"principal"),marginMode:r,timestamp:s,datetime:this.iso8601(s)}}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={asset:s.id,amount:this.currencyToPrecision(t,e)};let a,n;if([n,i]=this.handleOptionAndParams2(i,"repayCrossMargin","papi","portfolioMargin",!1),n){let t;[t,i]=this.handleOptionAndParams2(i,"repayCrossMargin","repayCrossMarginMethod","method"),a="papiPostMarginRepayDebt"===t?await this.papiPostMarginRepayDebt(this.extend(r,i)):await this.papiPostRepayLoan(this.extend(r,i))}else r.isIsolated="FALSE",r.type="REPAY",a=await this.sapiPostMarginBorrowRepay(this.extend(r,i));return this.parseMarginLoan(a,s)}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=this.market(t),n={asset:r.id,amount:this.currencyToPrecision(e,i),symbol:a.id,isIsolated:"TRUE",type:"REPAY"},o=await this.sapiPostMarginBorrowRepay(this.extend(n,s));return this.parseMarginLoan(o,r)}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={asset:s.id,amount:this.currencyToPrecision(t,e)};let a,n;return[n,i]=this.handleOptionAndParams2(i,"borrowCrossMargin","papi","portfolioMargin",!1),n?a=await this.papiPostMarginLoan(this.extend(r,i)):(r.isIsolated="FALSE",r.type="BORROW",a=await this.sapiPostMarginBorrowRepay(this.extend(r,i))),this.parseMarginLoan(a,s)}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=this.market(t),n={asset:r.id,amount:this.currencyToPrecision(e,i),symbol:a.id,isIsolated:"TRUE",type:"BORROW"},o=await this.sapiPostMarginBorrowRepay(this.extend(n,s));return this.parseMarginLoan(o,r)}parseMarginLoan(t,e=void 0){const i=this.safeString(t,"asset"),s=this.safeInteger(t,"updateTime");return{id:this.safeInteger(t,"tranId"),currency:this.safeCurrencyCode(i,e),amount:this.safeNumber(t,"amount"),symbol:void 0,timestamp:s,datetime:this.iso8601(s),info:t}}async fetchOpenInterestHistory(t,e="5m",i=void 0,s=void 0,a={}){if("1m"===e)throw new r.BadRequest(this.id+" fetchOpenInterestHistory cannot use the 1m timeframe");await this.loadMarkets();let n=!1;if([n,a]=this.handleOptionAndParams(a,"fetchOpenInterestHistory","paginate",!1),n)return await this.fetchPaginatedCallDeterministic("fetchOpenInterestHistory",t,i,s,e,a,500);const o=this.market(t),d={period:this.safeString(this.timeframes,e,e)};void 0!==s&&(d.limit=s);d[o.linear?"symbol":"pair"]=o.id,o.inverse&&(d.contractType=this.safeString(a,"contractType","CURRENT_QUARTER")),void 0!==i&&(d.startTime=i);const c=this.safeInteger(a,"until"),h=this.safeInteger(a,"endTime",c);if(a=this.omit(a,["endTime","until"]),h)d.endTime=h;else if(i){void 0===s&&(s=30);const t=this.parseTimeframe(e);d.endTime=this.sum(i,t*s*1e3)}let l;return l=o.inverse?await this.dapiDataGetOpenInterestHist(this.extend(d,a)):await this.fapiDataGetOpenInterestHist(this.extend(d,a)),this.parseOpenInterestsHistory(l,o,i,s)}async fetchOpenInterest(t,e={}){await this.loadMarkets();const i=this.market(t),s={};if(i.option){if(s.underlyingAsset=i.baseId,void 0===i.expiry)throw new r.NotSupported(this.id+" fetchOpenInterest does not support "+t);s.expiration=this.yymmdd(i.expiry)}else s.symbol=i.id;let a;if(a=i.option?await this.eapiPublicGetOpenInterest(this.extend(s,e)):i.inverse?await this.dapiPublicGetOpenInterest(this.extend(s,e)):await this.fapiPublicGetOpenInterest(this.extend(s,e)),!i.option)return this.parseOpenInterest(a,i);{t=i.symbol;const e=this.parseOpenInterestsHistory(a,i);for(let i=0;i<e.length;i++){const s=e[i];if(s.symbol===t)return s}}}parseOpenInterest(t,e=void 0){const i=this.safeInteger2(t,"timestamp","time"),s=this.safeString(t,"symbol"),r=this.safeNumber2(t,"sumOpenInterest","openInterest"),a=this.safeNumber2(t,"sumOpenInterestValue","sumOpenInterestUsd");return this.safeOpenInterest({symbol:this.safeSymbol(s,e,void 0,"contract"),baseVolume:e.inverse?void 0:r,quoteVolume:a,openInterestAmount:r,openInterestValue:a,timestamp:i,datetime:this.iso8601(i),info:t},e)}async fetchMyLiquidations(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a,n,o,d,c=!1;if([c,s]=this.handleOptionAndParams(s,"fetchMyLiquidations","paginate"),c)return await this.fetchPaginatedCallIncremental("fetchMyLiquidations",t,e,i,s,"current",100);void 0!==t&&(a=this.market(t)),[n,s]=this.handleMarketTypeAndParams("fetchMyLiquidations",a,s),[o,s]=this.handleSubTypeAndParams("fetchMyLiquidations",a,s,"linear"),[d,s]=this.handleOptionAndParams2(s,"fetchMyLiquidations","papi","portfolioMargin",!1);let h,l={};if("spot"!==n&&(l.autoCloseType="LIQUIDATION"),void 0!==a){const t=a.spot?"isolatedSymbol":"symbol";d||(l[t]=a.id)}if(void 0!==e&&(l.startTime=e),void 0!==i&&("spot"===n?l.size=i:l.limit=i),[l,s]=this.handleUntilOption("endTime",l,s),"spot"===n)h=d?await this.papiGetMarginForceOrders(this.extend(l,s)):await this.sapiGetMarginForceLiquidationRec(this.extend(l,s));else if("linear"===o)h=d?await this.papiGetUmForceOrders(this.extend(l,s)):await this.fapiPrivateGetForceOrders(this.extend(l,s));else{if("inverse"!==o)throw new r.NotSupported(this.id+" fetchMyLiquidations() does not support "+a.type+" markets");h=d?await this.papiGetCmForceOrders(this.extend(l,s)):await this.dapiPrivateGetForceOrders(this.extend(l,s))}const u=this.safeList(h,"rows",h);return this.parseLiquidations(u,a,e,i)}parseLiquidation(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeInteger2(t,"updatedTime","updateTime");return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:this.safeNumber(t,"executedQty"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(t,"avgPrice"),side:this.safeStringLower(t,"side"),baseValue:this.safeNumber(t,"cumBase"),quoteValue:this.safeNumber(t,"cumQuote"),timestamp:s,datetime:this.iso8601(s)})}async fetchGreeks(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.eapiPublicGetMark(this.extend(s,e));return this.parseGreeks(r[0],i)}async fetchAllGreeks(t=void 0,e={}){await this.loadMarkets();const i={};let s;if(void 0!==(t=this.marketSymbols(t,void 0,!0,!0,!0))){1===t.length&&(s=this.market(t[0]),i.symbol=s.id)}const r=await this.eapiPublicGetMark(this.extend(i,e));return this.parseAllGreeks(r,t)}parseGreeks(t,e=void 0){const i=this.safeString(t,"symbol");return{symbol:this.safeSymbol(i,e),timestamp:void 0,datetime:void 0,delta:this.safeNumber(t,"delta"),gamma:this.safeNumber(t,"gamma"),theta:this.safeNumber(t,"theta"),vega:this.safeNumber(t,"vega"),rho:void 0,bidSize:void 0,askSize:void 0,bidImpliedVolatility:this.safeNumber(t,"bidIV"),askImpliedVolatility:this.safeNumber(t,"askIV"),markImpliedVolatility:this.safeNumber(t,"markIV"),bidPrice:void 0,askPrice:void 0,markPrice:this.safeNumber(t,"markPrice"),lastPrice:void 0,underlyingPrice:void 0,info:t}}async fetchTradingLimits(t=void 0,e={}){const i=await this.fetchMarkets(),s={};for(let e=0;e<i.length;e++){const r=i[e],a=r.symbol;(void 0===t||this.inArray(a,t))&&(s[a]=r.limits.amount)}return s}async fetchPositionMode(t=void 0,e={}){let i,s,a;if(void 0!==t&&(i=this.market(t)),[s,e]=this.handleSubTypeAndParams("fetchPositionMode",i,e),"linear"===s)a=await this.fapiPrivateGetPositionSideDual(e);else{if("inverse"!==s)throw new r.BadRequest(this.id+' fetchPositionMode requires either a symbol argument or params["subType"]');a=await this.dapiPrivateGetPositionSideDual(e)}return{info:a,hedged:this.safeBool(a,"dualSidePosition")}}async fetchMarginModes(t=void 0,e={}){let i,s,a;if(await this.loadMarkets(),void 0!==t&&(t=this.marketSymbols(t),i=this.market(t[0])),[s,e]=this.handleSubTypeAndParams("fetchMarginMode",i,e),"linear"===s)a=await this.fapiPrivateGetSymbolConfig(e);else{if("inverse"!==s)throw new r.BadRequest(this.id+" fetchMarginModes () supports linear and inverse subTypes only");a=await this.dapiPrivateGetAccount(e)}let n=this.safeList(a,"positions",[]);return Array.isArray(a)&&(n=a),this.parseMarginModes(n,t,"symbol","swap")}async fetchMarginMode(t,e={}){await this.loadMarkets();const i=this.market(t);let s,a;if([s,e]=this.handleSubTypeAndParams("fetchMarginMode",i,e),"linear"!==s){if("inverse"===s){return(await this.fetchMarginModes([t],e))[t]}throw new r.BadRequest(this.id+" fetchMarginMode () supports linear and inverse subTypes only")}{const t={symbol:i.id};a=await this.fapiPrivateGetSymbolConfig(this.extend(t,e))}return this.parseMarginMode(a[0],i)}parseMarginMode(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e);const s=this.safeBool(t,"isolated");let r;void 0!==s&&(r=s?"isolated":"cross");const a=this.safeStringLower(t,"marginType");return void 0!==a&&(r="crossed"===a?"cross":"isolated"),{info:t,symbol:e.symbol,marginMode:r}}async fetchOption(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.eapiPublicGetTicker(this.extend(s,e)),a=this.safeDict(r,0,{});return this.parseOption(a,void 0,i)}parseOption(t,e=void 0,i=void 0){const s=this.safeString(t,"symbol");return{info:t,currency:void 0,symbol:(i=this.safeMarket(s,i)).symbol,timestamp:void 0,datetime:void 0,impliedVolatility:void 0,openInterest:void 0,bidPrice:this.safeNumber(t,"bidPrice"),askPrice:this.safeNumber(t,"askPrice"),midPrice:void 0,markPrice:void 0,lastPrice:this.safeNumber(t,"lastPrice"),underlyingPrice:this.safeNumber(t,"exercisePrice"),change:this.safeNumber(t,"priceChange"),percentage:this.safeNumber(t,"priceChangePercent"),baseVolume:this.safeNumber(t,"volume"),quoteVolume:void 0}}async fetchMarginAdjustmentHistory(t=void 0,e=void 0,i=void 0,s=void 0,a={}){if(await this.loadMarkets(),void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMarginAdjustmentHistory () requires a symbol argument");const n=this.market(t),o=this.safeInteger(a,"until");a=this.omit(a,"until");const d={symbol:n.id};let c;if(void 0!==e&&(d.type="add"===e?1:2),void 0!==i&&(d.startTime=i),void 0!==s&&(d.limit=s),void 0!==o&&(d.endTime=o),n.linear)c=await this.fapiPrivateGetPositionMarginHistory(this.extend(d,a));else{if(!n.inverse)throw new r.BadRequest(this.id+" fetchMarginAdjustmentHistory () is not supported for markets of type "+n.type);c=await this.dapiPrivateGetPositionMarginHistory(this.extend(d,a))}const h=this.parseMarginModifications(c);return this.filterBySymbolSinceLimit(h,t,i,s)}async fetchConvertCurrencies(t={}){await this.loadMarkets();const e=await this.sapiGetConvertAssetInfo(t),i={};for(let t=0;t<e.length;t++){const s=e[t],r=this.safeString(s,"asset"),a=this.safeCurrencyCode(r);i[a]={info:s,id:r,code:a,networks:void 0,type:void 0,name:void 0,active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,precision:this.parseNumber(this.parsePrecision(this.safeString(s,"fraction"))),limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},created:void 0}}return i}async fetchConvertQuote(t,e,i=void 0,s={}){if(void 0===i)throw new r.ArgumentsRequired(this.id+" fetchConvertQuote() requires an amount argument");await this.loadMarkets();const a={fromAsset:t,toAsset:e,fromAmount:i},n=await this.sapiPostConvertGetQuote(this.extend(a,s)),o=this.currency(t),d=this.currency(e);return this.parseConversion(n,o,d)}async createConvertTrade(t,e,i,s=void 0,a={}){await this.loadMarkets();const n={};let o;if("BUSD"===e||"BUSD"===i){if(void 0===s)throw new r.ArgumentsRequired(this.id+" createConvertTrade() requires an amount argument");n.clientTranId=t,n.asset=e,n.targetAsset=i,n.amount=s,o=await this.sapiPostAssetConvertTransfer(this.extend(n,a))}else n.quoteId=t,o=await this.sapiPostConvertAcceptQuote(this.extend(n,a));const d=this.currency(e),c=this.currency(i);return this.parseConversion(o,d,c)}async fetchConvertTrade(t,e=void 0,i={}){await this.loadMarkets();const s={};let r;if("BUSD"===e){const a=864e5,n=this.milliseconds();if(void 0!==e){const t=this.currency(e);s.asset=t.id}s.tranId=t,s.startTime=n-a,s.endTime=n,r=await this.sapiGetAssetConvertTransferQueryByPage(this.extend(s,i))}else s.orderId=t,r=await this.sapiGetConvertOrderStatus(this.extend(s,i));let a=r;if("BUSD"===e){const t=this.safeList(r,"rows",[]);a=this.safeDict(t,0,{})}const n=this.safeString2(a,"deductedAsset","fromAsset"),o=this.safeString2(a,"targetAsset","toAsset");let d,c;return void 0!==n&&(d=this.currency(n)),void 0!==o&&(c=this.currency(o)),this.parseConversion(a,d,c)}async fetchConvertTradeHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={},n=2592e6,o=this.milliseconds();a.startTime=void 0!==e?e:o-n;const d=this.safeInteger2(s,"endTime","until");let c,h,l,u;if(a.endTime=void 0!==d?d:o,s=this.omit(s,"until"),"BUSD"===t){const e=this.currency(t);a.asset=e.id,void 0!==i&&(a.size=i),l="deductedAsset",u="targetAsset",h="rows",c=await this.sapiGetAssetConvertTransferQueryByPage(this.extend(a,s))}else{if(a.endTime-a.startTime>n)throw new r.BadRequest(this.id+" fetchConvertTradeHistory () the max interval between startTime and endTime is 30 days.");void 0!==i&&(a.limit=i),l="fromAsset",u="toAsset",h="list",c=await this.sapiGetConvertTradeFlow(this.extend(a,s))}const p=this.safeList(c,h,[]);return this.parseConversions(p,t,l,u,e,i)}parseConversion(t,e=void 0,i=void 0){const s=this.safeIntegerN(t,["time","validTimestamp","createTime"]),r=this.safeString2(t,"deductedAsset","fromAsset"),a=this.safeCurrencyCode(r,e),n=this.safeString2(t,"targetAsset","toAsset"),o=this.safeCurrencyCode(n,i);return{info:t,timestamp:s,datetime:this.iso8601(s),id:this.safeStringN(t,["tranId","orderId","quoteId"]),fromCurrency:a,fromAmount:this.safeNumber2(t,"deductedAmount","fromAmount"),toCurrency:o,toAmount:this.safeNumber2(t,"targetAmount","toAmount"),price:void 0,fee:void 0}}async fetchFundingIntervals(t=void 0,e={}){let i;await this.loadMarkets(),void 0!==t&&(t=this.marketSymbols(t),i=this.market(t[0]));const s="swap";let a,n;if([a,e]=this.handleSubTypeAndParams("fetchFundingIntervals",i,e,"linear"),this.isLinear(s,a))n=await this.fapiPublicGetFundingInfo(e);else{if(!this.isInverse(s,a))throw new r.NotSupported(this.id+" fetchFundingIntervals() supports linear and inverse swap contracts only");n=await this.dapiPublicGetFundingInfo(e)}return this.parseFundingRates(n,t)}async fetchLongShortRatioHistory(t=void 0,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();const n=this.market(t);void 0===e&&(e="1d");let o,d,c={period:e};if([c,a]=this.handleUntilOption("endTime",c,a),void 0!==i&&(c.startTime=i),void 0!==s&&(c.limit=s),[o,a]=this.handleSubTypeAndParams("fetchLongShortRatioHistory",n,a),"linear"===o)c.symbol=n.id,d=await this.fapiDataGetGlobalLongShortAccountRatio(this.extend(c,a));else{if("inverse"!==o)throw new r.BadRequest(this.id+" fetchLongShortRatioHistory() supports linear and inverse subTypes only");c.pair=n.info.pair,d=await this.dapiDataGetGlobalLongShortAccountRatio(this.extend(c,a))}return this.parseLongShortRatioHistory(d,n)}parseLongShortRatio(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeIntegerOmitZero(t,"timestamp");return{info:t,symbol:this.safeSymbol(i,e,void 0,"contract"),timestamp:s,datetime:this.iso8601(s),timeframe:void 0,longShortRatio:this.safeNumber(t,"longShortRatio")}}}},3200(t,e,i){"use strict";i.d(e,{i0:()=>o});var s=i(7525),r=i(9806);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var a=i(1291),n=i.n(a);const o={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.matchOrders&&h.encode(t.matchOrders,e.uint32(10).fork()).ldelim(),void 0!==t.matchPerpetualLiquidation&&u.encode(t.matchPerpetualLiquidation,e.uint32(18).fork()).ldelim(),void 0!==t.matchPerpetualDeleveraging&&p.encode(t.matchPerpetualDeleveraging,e.uint32(26).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={matchOrders:void 0,matchPerpetualLiquidation:void 0,matchPerpetualDeleveraging:void 0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.matchOrders=h.decode(i,i.uint32());break;case 2:r.matchPerpetualLiquidation=u.decode(i,i.uint32());break;case 3:r.matchPerpetualDeleveraging=p.decode(i,i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={matchOrders:void 0,matchPerpetualLiquidation:void 0,matchPerpetualDeleveraging:void 0};return e.matchOrders=void 0!==t.matchOrders&&null!==t.matchOrders?h.fromPartial(t.matchOrders):void 0,e.matchPerpetualLiquidation=void 0!==t.matchPerpetualLiquidation&&null!==t.matchPerpetualLiquidation?u.fromPartial(t.matchPerpetualLiquidation):void 0,e.matchPerpetualDeleveraging=void 0!==t.matchPerpetualDeleveraging&&null!==t.matchPerpetualDeleveraging?p.fromPartial(t.matchPerpetualDeleveraging):void 0,e}};function d(){return{fillAmount:n().UZERO,makerOrderId:void 0}}const c={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(t.fillAmount.isZero()||e.uint32(8).uint64(t.fillAmount),void 0!==t.makerOrderId&&s.e3.encode(t.makerOrderId,e.uint32(18).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=d();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.fillAmount=i.uint64();break;case 2:a.makerOrderId=s.e3.decode(i,i.uint32());break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=d();return e.fillAmount=void 0!==t.fillAmount&&null!==t.fillAmount?n().fromValue(t.fillAmount):n().UZERO,e.makerOrderId=void 0!==t.makerOrderId&&null!==t.makerOrderId?s.e3.fromPartial(t.makerOrderId):void 0,e}};const h={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.takerOrderId&&s.e3.encode(t.takerOrderId,e.uint32(10).fork()).ldelim();for(const i of t.fills)c.encode(i,e.uint32(18).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={takerOrderId:void 0,fills:[]};for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.takerOrderId=s.e3.decode(i,i.uint32());break;case 2:a.fills.push(c.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={takerOrderId:void 0,fills:[]};return e.takerOrderId=void 0!==t.takerOrderId&&null!==t.takerOrderId?s.e3.fromPartial(t.takerOrderId):void 0,e.fills=t.fills?.map(t=>c.fromPartial(t))||[],e}};function l(){return{liquidated:void 0,clobPairId:0,perpetualId:0,totalSize:n().UZERO,isBuy:!1,fills:[]}}const u={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.liquidated&&r.D.encode(t.liquidated,e.uint32(10).fork()).ldelim(),0!==t.clobPairId&&e.uint32(16).uint32(t.clobPairId),0!==t.perpetualId&&e.uint32(24).uint32(t.perpetualId),t.totalSize.isZero()||e.uint32(32).uint64(t.totalSize),!0===t.isBuy&&e.uint32(40).bool(t.isBuy);for(const i of t.fills)c.encode(i,e.uint32(50).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a=l();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.liquidated=r.D.decode(i,i.uint32());break;case 2:a.clobPairId=i.uint32();break;case 3:a.perpetualId=i.uint32();break;case 4:a.totalSize=i.uint64();break;case 5:a.isBuy=i.bool();break;case 6:a.fills.push(c.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=l();return e.liquidated=void 0!==t.liquidated&&null!==t.liquidated?r.D.fromPartial(t.liquidated):void 0,e.clobPairId=t.clobPairId??0,e.perpetualId=t.perpetualId??0,e.totalSize=void 0!==t.totalSize&&null!==t.totalSize?n().fromValue(t.totalSize):n().UZERO,e.isBuy=t.isBuy??!1,e.fills=t.fills?.map(t=>c.fromPartial(t))||[],e}};const p={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.liquidated&&r.D.encode(t.liquidated,e.uint32(10).fork()).ldelim(),0!==t.perpetualId&&e.uint32(16).uint32(t.perpetualId);for(const i of t.fills)m.encode(i,e.uint32(26).fork()).ldelim();return!0===t.isFinalSettlement&&e.uint32(32).bool(t.isFinalSettlement),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a={liquidated:void 0,perpetualId:0,fills:[],isFinalSettlement:!1};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.liquidated=r.D.decode(i,i.uint32());break;case 2:a.perpetualId=i.uint32();break;case 3:a.fills.push(m.decode(i,i.uint32()));break;case 4:a.isFinalSettlement=i.bool();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={liquidated:void 0,perpetualId:0,fills:[],isFinalSettlement:!1};return e.liquidated=void 0!==t.liquidated&&null!==t.liquidated?r.D.fromPartial(t.liquidated):void 0,e.perpetualId=t.perpetualId??0,e.fills=t.fills?.map(t=>m.fromPartial(t))||[],e.isFinalSettlement=t.isFinalSettlement??!1,e}};function f(){return{offsettingSubaccountId:void 0,fillAmount:n().UZERO}}const m={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.offsettingSubaccountId&&r.D.encode(t.offsettingSubaccountId,e.uint32(10).fork()).ldelim(),t.fillAmount.isZero()||e.uint32(16).uint64(t.fillAmount),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a=f();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.offsettingSubaccountId=r.D.decode(i,i.uint32());break;case 2:a.fillAmount=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=f();return e.offsettingSubaccountId=void 0!==t.offsettingSubaccountId&&null!==t.offsettingSubaccountId?r.D.fromPartial(t.offsettingSubaccountId):void 0,e.fillAmount=void 0!==t.fillAmount&&null!==t.fillAmount?n().fromValue(t.fillAmount):n().UZERO,e}}},3206(t,e,i){"use strict";i.d(e,{K:()=>r});var s=i(2634);function r(){let t,e;const i=new Promise((i,s)=>{t=i,e=s});return i.resolve=function(){queueMicrotask(()=>{t.apply(this,arguments)})},i.reject=function(){queueMicrotask(()=>{e.apply(this,arguments)})},i}r.race=t=>function(t){const e=r();return t.then(e.resolve,e.reject),e}(s.V.race(t))},3283(t,e,i){"use strict";i.d(e,{is:()=>o,wO:()=>a});var s=i(178),r=i(4921);const a=(1n<<128n)-1n,n=(1n<<256n)-1n;class o{constructor(...t){if("object"==typeof t[0]&&1===t.length&&"low"in t[0]&&"high"in t[0]){const e=o.validateProps(t[0].low,t[0].high);this.low=e.low,this.high=e.high}else if(1===t.length){const e=o.validate(t[0]);this.low=e&a,this.high=e>>128n}else{if(2!==t.length)throw Error("Incorrect constructor parameters");{const e=o.validateProps(t[0],t[1]);this.low=e.low,this.high=e.high}}}static validate(t){const e=BigInt(t);if(e<0n)throw Error("bigNumberish is smaller than UINT_256_MIN");if(e>n)throw new Error("bigNumberish is bigger than UINT_256_MAX");return e}static validateProps(t,e){const i=BigInt(t),s=BigInt(e);if(i<0n||i>340282366920938463463374607431768211455n)throw new Error("low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX");if(s<0n||s>340282366920938463463374607431768211455n)throw new Error("high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX");return{low:i,high:s}}static is(t){try{o.validate(t)}catch(t){return!1}return!0}static isAbiType(t){return t===o.abiSelector}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:(0,s.VO)(this.low.toString(16)),high:(0,s.VO)(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[(0,r.e)(this.low),(0,r.e)(this.high)]}}o.abiSelector="core::integer::u256"},3287(t,e,i){"use strict";i.d(e,{i:()=>a,z:()=>n});var s=i(3867),r=i(4176);class a extends r.Ue{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=(0,s.Lm)(e);let i=t.writeValue(e.length);return i+=t.writeBytes(e),i}decode(t){return t.readBytes(t.readIndex(),!0)}}class n extends a{constructor(t){super("bytes",t)}decode(t){return(0,s.c$)(super.decode(t))}}},3390(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(9024),r=i(712),a=i(1094);function n(t,e,i,n){s.Ay.hash(t);const o=(0,a.tY)({dkLen:32,asyncTick:10},n),{c:d,dkLen:c,asyncTick:h}=o;if(s.Ay.number(d),s.Ay.number(c),s.Ay.number(h),d<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=(0,a.ZJ)(e),u=(0,a.ZJ)(i),p=new Uint8Array(c),f=r.w.create(t,l),m=f._cloneInto().update(u);return{c:d,dkLen:c,asyncTick:h,DK:p,PRF:f,PRFSalt:m}}function o(t,e,i,s,r){return t.destroy(),e.destroy(),s&&s.destroy(),r.fill(0),i}function d(t,e,i,s){const{c:r,dkLen:d,DK:c,PRF:h,PRFSalt:l}=n(t,e,i,s);let u;const p=new Uint8Array(4),f=(0,a.O8)(p),m=new Uint8Array(h.outputLen);for(let t=1,e=0;e<d;t++,e+=h.outputLen){const i=c.subarray(e,e+h.outputLen);f.setInt32(0,t,!1),(u=l._cloneInto(u)).update(p).digestInto(m),i.set(m.subarray(0,i.length));for(let t=1;t<r;t++){h._cloneInto(u).update(m).digestInto(m);for(let t=0;t<i.length;t++)i[t]^=m[t]}}return o(h,l,c,u,m)}},3463(t,e,i){"use strict";i.d(e,{A:()=>g});var s=i(3283),r=i(274),a=i(178),n=i(1686),o=i(7925),d=i(2256),c=i(5307),h=i(6863),l=i(9620),u=i(1668),p=i(7593);function f(t,e){let i;switch(!0){case(0,c.Fi)(t):return i=e.next().value,Boolean(BigInt(i));case s.is.isAbiType(t):const n=e.next().value,d=e.next().value;return new s.is(n,d).toBigInt();case r.Ns.isAbiType(t):const h=e.next().value,l=e.next().value,u=e.next().value,p=e.next().value;return new r.Ns(h,l,u,p).toBigInt();case"core::starknet::eth_address::EthAddress"===t:return i=e.next().value,BigInt(i);case"core::bytes_31::bytes31"===t:return i=e.next().value,(0,o.Wb)(i);case(0,c.Z$)(t):const f=(0,a.ow)(e.next().value).padStart(32,"0"),m=(0,a.ow)(e.next().value).padStart(32,"0"),g=(0,a.ow)(e.next().value).padStart(32,"0"),y=(0,a.ow)(e.next().value).padStart(32,"0");return BigInt((0,a.VO)(m+f+y+g));default:return i=e.next().value,BigInt(i)}}function m(t,e,i,a){if("()"===e.type)return{};if(s.is.isAbiType(e.type)){const e=t.next().value,i=t.next().value;return new s.is(e,i).toBigInt()}if(r.Ns.isAbiType(e.type)){const e=t.next().value,i=t.next().value,s=t.next().value,a=t.next().value;return new r.Ns(e,i,s,a).toBigInt()}if((0,c.ak)(e.type)){const e=[],i=BigInt(t.next().value);for(;e.length<i;)e.push((0,n.nj)(t.next().value));const s={data:e,pending_word:(0,n.nj)(t.next().value),pending_word_len:BigInt(t.next().value)};return(0,d.f)(s)}if((0,c.G$)(e.type)){const s=[],r={name:"",type:(0,c.CS)(e.type)},n=BigInt(t.next().value);for(;s.length<n;)s.push(m(t,r,i,a));return s}if(i&&e.type in i&&i[e.type])return"core::starknet::eth_address::EthAddress"===e.type?f(e.type,t):i[e.type].members.reduce((e,s)=>(e[s.name]=m(t,s,i,a),e),{});if(a&&e.type in a&&a[e.type]){const s=Number(t.next().value),r=a[e.type].variants.reduce((e,r,n)=>n===s?(e[r.name]=m(t,{name:"",type:r.type},i,a),e):(e[r.name]=void 0,e),{});if(e.type.startsWith("core::option::Option")){const t=s===l.R.Some?r.Some:void 0;return new l.c(s,t)}if(e.type.startsWith("core::result::Result")){let t;return t=s===u.B.Ok?r.Ok:r.Err,new u.G(s,t)}return new h.b(r)}if((0,c.Zm)(e.type)){return(0,p.A)(e.type).reduce((e,s,r)=>{const n=s?.name?s.name:r,o={name:n,type:s?.type?s.type:s};return e[n]=m(t,o,i,a),e},{})}if((0,c.G$)(e.type)){const s=[],r={name:"",type:(0,c.CS)(e.type)},n=BigInt(t.next().value);for(;s.length<n;)s.push(m(t,r,i,a));return s}return f(e.type,t)}function g(t,e,i,s,r){const{name:a,type:n}=e;let o;switch(!0){case(0,c.ct)(a):return o=t.next().value,BigInt(o);case i&&n in i||(0,c.Zm)(n):case s&&(0,c.iO)(n,s):return m(t,e,i,s);case(0,c.G$)(n):if((0,c.s8)(n))return m(t,e,i,s);const d=[];if(r&&r[`${a}_len`]){const n=r[`${a}_len`];for(;d.length<n;)d.push(m(t,{name:a,type:e.type.replace("*","")},i,s))}return d;default:return f(n,t)}}},3466(t,e,i){"use strict";i.d(e,{e:()=>l});var s=i(230),r=i(1094);const a=(t,e)=>t<<e|t>>>32-e>>>0,n=(t,e,i)=>t&e^~t&i,o=(t,e,i)=>t&e^t&i^e&i,d=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),c=new Uint32Array(80);class h extends s.D{constructor(){super(64,20,8,!1),this.A=0|d[0],this.B=0|d[1],this.C=0|d[2],this.D=0|d[3],this.E=0|d[4]}get(){const{A:t,B:e,C:i,D:s,E:r}=this;return[t,e,i,s,r]}set(t,e,i,s,r){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|s,this.E=0|r}process(t,e){for(let i=0;i<16;i++,e+=4)c[i]=t.getUint32(e,!1);for(let t=16;t<80;t++)c[t]=a(c[t-3]^c[t-8]^c[t-14]^c[t-16],1);let{A:i,B:s,C:r,D:d,E:h}=this;for(let t=0;t<80;t++){let e,l;t<20?(e=n(s,r,d),l=1518500249):t<40?(e=s^r^d,l=1859775393):t<60?(e=o(s,r,d),l=2400959708):(e=s^r^d,l=3395469782);const u=a(i,5)+e+h+l+c[t]|0;h=d,d=r,r=a(s,30),s=i,i=u}i=i+this.A|0,s=s+this.B|0,r=r+this.C|0,d=d+this.D|0,h=h+this.E|0,this.set(i,s,r,d,h)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const l=(0,r.ld)(()=>new h)},3503(t,e,i){"use strict";i.d(e,{Qd:()=>s,ZH:()=>r,_n:()=>d,bB:()=>a,tg:()=>o,uR:()=>n});const s=t=>{const e={fetchOHLCVWs:"fetch_ohlcv_ws"};return e[t]?e[t]:t.match(/[A-Z]/)?t.replace(/[a-z0-9][A-Z]/g,t=>t[0]+"_"+t[1]).replace(/[A-Z0-9][A-Z0-9][a-z][^$]/g,t=>t[0]+"_"+t[1]+t[2]+t[3]).replace(/[a-z][0-9]$/g,t=>t[0]+"_"+t[1]).toLowerCase():t},r=t=>t.length?t.charAt(0).toUpperCase()+t.slice(1):t,a=t=>t.replace(/^\s+|\s+$/g,""),n=t=>t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,n),o=t=>t?(t^16*Math.random()>>t/4).toString(16):([1e5]+100+400+8e3).replace(/[018]/g,o),d=t=>t?(t^16*Math.random()>>t/4).toString(16):([1e7]+1e3+4e3+8e5).replace(/[018]/g,d)},3548(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},3649(t,e,i){"use strict";i.d(e,{Ay:()=>n});var s=i(6888),r=i(7942),a=i(1417);const n={formats:{default:a.Ay,formatters:a._J,RFC1738:a.j1,RFC3986:a.MV},parse:r.A,stringify:s.A}},3660(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(5531),r=i(2079),a=i(5147),n=i(1579),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"okx",name:"OKX",countries:["CN","US"],version:"v5",rateLimit:100*1.1,pro:!0,certified:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!0,option:!0,addMargin:!0,cancelAllOrders:!1,cancelAllOrdersAfter:!0,cancelOrder:!0,cancelOrders:!0,cancelOrdersForSymbols:!0,closeAllPositions:!1,closePosition:!0,createConvertTrade:!0,createDepositAddress:!1,createMarketBuyOrderWithCost:!0,createMarketSellOrderWithCost:!0,createOrder:!0,createOrders:!0,createOrderWithTakeProfitAndStopLoss:!0,createPostOnlyOrder:!0,createReduceOnlyOrder:!0,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTakeProfitOrder:!0,createTrailingPercentOrder:!0,createTriggerOrder:!0,editOrder:!0,fetchAccounts:!0,fetchAllGreeks:!0,fetchBalance:!0,fetchBidsAsks:void 0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!0,fetchBorrowRateHistory:!0,fetchCanceledOrders:!0,fetchClosedOrder:void 0,fetchClosedOrders:!0,fetchConvertCurrencies:!0,fetchConvertQuote:!0,fetchConvertTrade:!0,fetchConvertTradeHistory:!0,fetchCrossBorrowRate:!0,fetchCrossBorrowRates:!0,fetchCurrencies:!0,fetchDeposit:!0,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositsWithdrawals:!1,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingInterval:!0,fetchFundingIntervals:!1,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchGreeks:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchL3OrderBook:!1,fetchLedger:!0,fetchLedgerEntry:void 0,fetchLeverage:!0,fetchLeverageTiers:!1,fetchLongShortRatio:!1,fetchLongShortRatioHistory:!0,fetchMarginAdjustmentHistory:!0,fetchMarketLeverageTiers:!0,fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMarkPrice:!0,fetchMarkPrices:!0,fetchMySettlementHistory:!1,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!0,fetchOpenInterestHistory:!0,fetchOpenInterests:!0,fetchOpenOrder:void 0,fetchOpenOrders:!0,fetchOption:!0,fetchOptionChain:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrders:!1,fetchOrderTrades:!0,fetchPosition:!0,fetchPositionHistory:"emulated",fetchPositions:!0,fetchPositionsForSymbol:!0,fetchPositionsHistory:!0,fetchPositionsRisk:!1,fetchPremiumIndexOHLCV:!1,fetchSettlementHistory:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!1,fetchTradingLimits:!1,fetchTransactionFee:!1,fetchTransactionFees:!1,fetchTransactions:!1,fetchTransfer:!0,fetchTransfers:!0,fetchUnderlyingAssets:!0,fetchVolatilityHistory:!1,fetchWithdrawal:!0,fetchWithdrawals:!0,fetchWithdrawalWhitelist:!1,reduceMargin:!0,repayCrossMargin:!0,sandbox:!0,setLeverage:!0,setMargin:!1,setMarginMode:!0,setPositionMode:!0,signIn:!1,transfer:!0,withdraw:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1H","2h":"2H","4h":"4H","6h":"6H","12h":"12H","1d":"1D","1w":"1W","1M":"1M","3M":"3M"},hostname:"www.okx.com",urls:{logo:"https://user-images.githubusercontent.com/1294454/152485636-38b19e4a-bece-4dec-979a-5982859ffc04.jpg",api:{rest:"https://{hostname}"},www:"https://www.okx.com",doc:"https://www.okx.com/docs-v5/en/",fees:"https://www.okx.com/pages/products/fees.html",referral:{url:"https://www.okx.com/join/CCXTCOM",discount:.2},test:{rest:"https://{hostname}"}},api:{public:{get:{"market/tickers":1,"market/ticker":1,"market/books":.5,"market/books-full":2,"market/candles":.5,"market/history-candles":1,"market/trades":.2,"market/history-trades":2,"market/option/instrument-family-trades":1,"market/platform-24-volume":10,"market/call-auction-detail":1,"market/books-sbe":10,"market/block-tickers":1,"market/block-ticker":1,"market/sprd-ticker":1,"market/sprd-candles":.5,"market/sprd-history-candles":1,"market/index-tickers":1,"market/index-candles":1,"market/history-index-candles":2,"market/mark-price-candles":1,"market/history-mark-price-candles":1,"market/exchange-rate":20,"market/index-components":1,"market/open-oracle":50,"market/books-lite":5/3,"public/option-trades":1,"public/block-trades":1,"public/instruments":1,"public/estimated-price":2,"public/delivery-exercise-history":.5,"public/estimated-settlement-info":2,"public/settlement-history":.5,"public/funding-rate":2,"public/funding-rate-history":2,"public/open-interest":1,"public/price-limit":1,"public/opt-summary":1,"public/discount-rate-interest-free-quota":10,"public/time":2,"public/mark-price":2,"public/position-tiers":2,"public/interest-rate-loan-quota":10,"public/underlying":1,"public/insurance-fund":2,"public/convert-contract-coin":2,"public/instrument-tick-bands":4,"public/premium-history":1,"public/economic-calendar":50,"public/market-data-history":4,"public/vip-interest-rate-loan-quota":10,"rubik/stat/trading-data/support-coin":4,"rubik/stat/contracts/open-interest-history":2,"rubik/stat/taker-volume":4,"rubik/stat/taker-volume-contract":4,"rubik/stat/margin/loan-ratio":4,"rubik/stat/contracts/long-short-account-ratio-contract-top-trader":4,"rubik/stat/contracts/long-short-account-ratio-contract":4,"rubik/stat/contracts/long-short-account-ratio":4,"rubik/stat/contracts/open-interest-volume":4,"rubik/stat/option/open-interest-volume":4,"rubik/stat/option/open-interest-volume-ratio":4,"rubik/stat/option/open-interest-volume-expiry":4,"rubik/stat/option/open-interest-volume-strike":4,"rubik/stat/option/taker-block-volume":4,"system/status":50,"sprd/spreads":1,"sprd/books":1,"sprd/public-trades":1,"sprd/ticker":1,"tradingBot/grid/ai-param":1,"tradingBot/grid/min-investment":1,"tradingBot/public/rsi-back-testing":1,"tradingBot/grid/grid-quantity":4,"asset/exchange-list":5/3,"finance/staking-defi/eth/apy-history":5/3,"finance/staking-defi/sol/apy-history":5/3,"finance/savings/lending-rate-summary":5/3,"finance/savings/lending-rate-history":5/3,"finance/fixed-loan/lending-offers":10/3,"finance/fixed-loan/lending-apy-history":10/3,"finance/fixed-loan/pending-lending-volume":10/3,"finance/sfp/dcd/products":2/3,"copytrading/public-config":4,"copytrading/public-lead-traders":4,"copytrading/public-weekly-pnl":4,"copytrading/public-pnl":4,"copytrading/public-stats":4,"copytrading/public-preference-currency":4,"copytrading/public-current-subpositions":4,"copytrading/public-subpositions-history":4,"copytrading/public-copy-traders":4,"support/announcements":4,"support/announcements-types":20},post:{"tradingBot/grid/min-investment":1}},private:{get:{"rfq/counterparties":4,"rfq/maker-instrument-settings":4,"rfq/mmp-config":4,"rfq/rfqs":10,"rfq/quotes":10,"rfq/trades":4,"rfq/public-trades":4,"sprd/order":1,"sprd/orders-pending":2,"sprd/orders-history":1,"sprd/orders-history-archive":1,"sprd/trades":1,"trade/order":1/3,"trade/orders-pending":1/3,"trade/orders-history":.5,"trade/orders-history-archive":1,"trade/fills":1/3,"trade/fills-history":2,"trade/fills-archive":2,"trade/order-algo":1,"trade/orders-algo-pending":1,"trade/orders-algo-history":1,"trade/easy-convert-currency-list":20,"trade/easy-convert-history":20,"trade/one-click-repay-currency-list":20,"trade/one-click-repay-currency-list-v2":20,"trade/one-click-repay-history":20,"trade/one-click-repay-history-v2":20,"trade/account-rate-limit":1,"asset/currencies":5/3,"asset/balances":5/3,"asset/non-tradable-assets":5/3,"asset/asset-valuation":10,"asset/transfer-state":1,"asset/bills":5/3,"asset/bills-history":10,"asset/deposit-lightning":5,"asset/deposit-address":5/3,"asset/deposit-history":5/3,"asset/withdrawal-history":5/3,"asset/deposit-withdraw-status":20,"asset/monthly-statement":2,"asset/convert/currencies":5/3,"asset/convert/currency-pair":5/3,"asset/convert/history":5/3,"account/instruments":1,"account/balance":2,"account/positions":2,"account/positions-history":2,"account/account-position-risk":2,"account/bills":2,"account/bills-archive":4,"account/bills-history-archive":2,"account/config":4,"account/max-size":1,"account/max-avail-size":1,"account/leverage-info":1,"account/adjust-leverage-info":4,"account/max-loan":1,"account/trade-fee":4,"account/interest-accrued":4,"account/interest-rate":4,"account/max-withdrawal":1,"account/risk-state":2,"account/interest-limits":4,"account/spot-borrow-repay-history":4,"account/greeks":2,"account/position-tiers":2,"account/set-account-switch-precheck":4,"account/collateral-assets":4,"account/mmp-config":4,"account/move-positions-history":10,"account/precheck-set-delta-neutral":20,"account/quick-margin-borrow-repay-history":4,"account/borrow-repay-history":4,"account/vip-interest-accrued":4,"account/vip-interest-deducted":4,"account/vip-loan-order-list":4,"account/vip-loan-order-detail":4,"account/fixed-loan/borrowing-limit":4,"account/fixed-loan/borrowing-quote":5,"account/fixed-loan/borrowing-orders-list":5,"account/spot-manual-borrow-repay":30,"account/set-auto-repay":4,"users/subaccount/list":10,"account/subaccount/balances":10/3,"asset/subaccount/balances":10/3,"account/subaccount/max-withdrawal":1,"asset/subaccount/bills":5/3,"asset/subaccount/managed-subaccount-bills":5/3,"users/entrust-subaccount-list":10,"account/subaccount/interest-limits":4,"users/subaccount/apikey":10,"tradingBot/grid/orders-algo-pending":1,"tradingBot/grid/orders-algo-history":1,"tradingBot/grid/orders-algo-details":1,"tradingBot/grid/sub-orders":1,"tradingBot/grid/positions":1,"tradingBot/grid/ai-param":1,"tradingBot/signal/signals":1,"tradingBot/signal/orders-algo-details":1,"tradingBot/signal/orders-algo-pending":1,"tradingBot/signal/orders-algo-history":1,"tradingBot/signal/positions":1,"tradingBot/signal/positions-history":2,"tradingBot/signal/sub-orders":1,"tradingBot/signal/event-history":1,"tradingBot/recurring/orders-algo-pending":1,"tradingBot/recurring/orders-algo-history":1,"tradingBot/recurring/orders-algo-details":1,"tradingBot/recurring/sub-orders":1,"finance/savings/balance":5/3,"finance/savings/lending-history":5/3,"finance/staking-defi/offers":10/3,"finance/staking-defi/orders-active":10/3,"finance/staking-defi/orders-history":10/3,"finance/staking-defi/eth/product-info":10/3,"finance/staking-defi/eth/balance":5/3,"finance/staking-defi/eth/purchase-redeem-history":5/3,"finance/staking-defi/sol/product-info":10/3,"finance/staking-defi/sol/balance":5/3,"finance/staking-defi/sol/purchase-redeem-history":5/3,"finance/flexible-loan/borrow-currencies":4,"finance/flexible-loan/collateral-assets":4,"finance/flexible-loan/max-collateral-redeem-amount":4,"finance/flexible-loan/loan-info":4,"finance/flexible-loan/loan-history":4,"finance/flexible-loan/interest-accrued":4,"copytrading/current-subpositions":1,"copytrading/subpositions-history":1,"copytrading/instruments":4,"copytrading/profit-sharing-details":4,"copytrading/total-profit-sharing":4,"copytrading/unrealized-profit-sharing-details":4,"copytrading/total-unrealized-profit-sharing":4,"copytrading/config":4,"copytrading/copy-settings":4,"copytrading/current-lead-traders":4,"copytrading/batch-leverage-info":4,"copytrading/lead-traders-history":4,"broker/dma/subaccount-info":2,"broker/dma/subaccount-trade-fee":10,"broker/dma/subaccount/apikey":10,"broker/dma/rebate-per-orders":300,"broker/fd/rebate-per-orders":300,"broker/fd/if-rebate":5,"broker/nd/info":10,"broker/nd/subaccount-info":10,"broker/nd/subaccount/apikey":10,"asset/broker/nd/subaccount-deposit-address":5/3,"asset/broker/nd/subaccount-deposit-history":4,"asset/broker/nd/subaccount-withdrawal-history":4,"broker/nd/rebate-daily":100,"broker/nd/rebate-per-orders":300,"finance/sfp/dcd/order":2,"finance/sfp/dcd/orders":2,"affiliate/invitee/detail":1,"users/partner/if-rebate":1,"support/announcements":4},post:{"rfq/create-rfq":4,"rfq/cancel-rfq":4,"rfq/cancel-batch-rfqs":10,"rfq/cancel-all-rfqs":10,"rfq/execute-quote":15,"rfq/maker-instrument-settings":4,"rfq/mmp-reset":4,"rfq/mmp-config":100,"rfq/create-quote":.4,"rfq/cancel-quote":.4,"rfq/cancel-batch-quotes":10,"rfq/cancel-all-quotes":10,"rfq/cancel-all-after":10,"sprd/order":1,"sprd/cancel-order":1,"sprd/mass-cancel":1,"sprd/amend-order":1,"sprd/cancel-all-after":10,"trade/order":1/3,"trade/batch-orders":1/15,"trade/cancel-order":1/3,"trade/cancel-batch-orders":1/15,"trade/amend-order":1/3,"trade/amend-batch-orders":1/150,"trade/close-position":1,"trade/fills-archive":172800,"trade/cancel-advance-algos":1,"trade/easy-convert":20,"trade/one-click-repay":20,"trade/one-click-repay-v2":20,"trade/mass-cancel":4,"trade/cancel-all-after":10,"trade/order-precheck":4,"trade/order-algo":1,"trade/cancel-algos":1,"trade/amend-algos":1,"asset/transfer":5,"asset/withdrawal":5/3,"asset/withdrawal-lightning":5,"asset/cancel-withdrawal":5/3,"asset/convert-dust-assets":10,"asset/monthly-statement":1296e3,"asset/convert/estimate-quote":50,"asset/convert/trade":1,"account/bills-history-archive":72e3,"account/set-position-mode":4,"account/set-leverage":1,"account/position/margin-balance":1,"account/set-fee-type":4,"account/set-greeks":4,"account/set-isolated-mode":4,"account/spot-manual-borrow-repay":30,"account/set-auto-repay":4,"account/quick-margin-borrow-repay":4,"account/borrow-repay":5/3,"account/simulated_margin":10,"account/position-builder":10,"account/position-builder-graph":50,"account/set-riskOffset-type":2,"account/activate-option":4,"account/set-auto-loan":4,"account/account-level-switch-preset":4,"account/set-account-level":4,"account/set-collateral-assets":4,"account/mmp-reset":4,"account/mmp-config":50,"account/fixed-loan/borrowing-order":5,"account/fixed-loan/amend-borrowing-order":5,"account/fixed-loan/manual-reborrow":5,"account/fixed-loan/repay-borrowing-order":5,"account/move-positions":10,"account/set-auto-earn":10,"account/set-settle-currency":1,"account/set-trading-config":20,"asset/subaccount/transfer":10,"account/subaccount/set-loan-allocation":4,"users/subaccount/create-subaccount":10,"users/subaccount/apikey":10,"users/subaccount/modify-apikey":10,"users/subaccount/subaccount-apikey":10,"users/subaccount/delete-apikey":10,"users/subaccount/set-transfer-out":10,"tradingBot/grid/order-algo":1,"tradingBot/grid/amend-algo-basic-param":1,"tradingBot/grid/amend-order-algo":1,"tradingBot/grid/stop-order-algo":1,"tradingBot/grid/close-position":1,"tradingBot/grid/cancel-close-order":1,"tradingBot/grid/order-instant-trigger":1,"tradingBot/grid/withdraw-income":1,"tradingBot/grid/compute-margin-balance":1,"tradingBot/grid/margin-balance":1,"tradingBot/grid/min-investment":1,"tradingBot/grid/adjust-investment":1,"tradingBot/signal/create-signal":1,"tradingBot/signal/order-algo":1,"tradingBot/signal/stop-order-algo":1,"tradingBot/signal/margin-balance":1,"tradingBot/signal/amendTPSL":1,"tradingBot/signal/set-instruments":1,"tradingBot/signal/close-position":1,"tradingBot/signal/sub-order":1,"tradingBot/signal/cancel-sub-order":1,"tradingBot/recurring/order-algo":1,"tradingBot/recurring/amend-order-algo":1,"tradingBot/recurring/stop-order-algo":1,"finance/savings/purchase-redempt":5/3,"finance/savings/set-lending-rate":5/3,"finance/staking-defi/purchase":5,"finance/staking-defi/redeem":5,"finance/staking-defi/cancel":5,"finance/staking-defi/eth/purchase":5,"finance/staking-defi/eth/redeem":5,"finance/staking-defi/eth/cancel-redeem":5,"finance/staking-defi/sol/purchase":5,"finance/staking-defi/sol/redeem":5,"finance/staking-defi/sol/cancel-redeem":5,"finance/flexible-loan/max-loan":4,"finance/flexible-loan/adjust-collateral":4,"copytrading/algo-order":1,"copytrading/close-subposition":1,"copytrading/set-instruments":4,"copytrading/amend-profit-sharing-ratio":4,"copytrading/first-copy-settings":4,"copytrading/amend-copy-settings":4,"copytrading/stop-copy-trading":4,"copytrading/batch-set-leverage":4,"broker/nd/create-subaccount":.25,"broker/nd/delete-subaccount":1,"broker/nd/subaccount/apikey":.25,"broker/nd/subaccount/modify-apikey":1,"broker/nd/subaccount/delete-apikey":1,"broker/nd/set-subaccount-level":4,"broker/nd/set-subaccount-fee-rate":4,"broker/nd/set-subaccount-assets":.25,"asset/broker/nd/subaccount-deposit-address":1,"asset/broker/nd/modify-subaccount-deposit-address":5/3,"broker/nd/rebate-per-orders":36e3,"finance/sfp/dcd/quote":10,"finance/sfp/dcd/order":10,"broker/nd/report-subaccount-ip":.25,"broker/dma/subaccount/apikey":1/4,"broker/dma/trades":36e3,"broker/fd/rebate-per-orders":36e3}}},fees:{trading:{taker:this.parseNumber("0.0015"),maker:this.parseNumber("0.0010")},spot:{taker:this.parseNumber("0.0015"),maker:this.parseNumber("0.0010")},future:{taker:this.parseNumber("0.0005"),maker:this.parseNumber("0.0002")},swap:{taker:this.parseNumber("0.00050"),maker:this.parseNumber("0.00020")}},requiredCredentials:{apiKey:!0,secret:!0,password:!0},exceptions:{exact:{1:r.ExchangeError,2:r.ExchangeError,4088:r.ManualInteractionNeeded,5e4:r.BadRequest,50001:r.OnMaintenance,50002:r.BadRequest,50004:r.RequestTimeout,50005:r.ExchangeNotAvailable,50006:r.BadRequest,50007:r.AccountSuspended,50008:r.AuthenticationError,50009:r.AccountSuspended,50010:r.ExchangeError,50011:r.RateLimitExceeded,50012:r.ExchangeError,50013:r.ExchangeNotAvailable,50014:r.BadRequest,50015:r.ExchangeError,50016:r.ExchangeError,50017:r.ExchangeError,50018:r.ExchangeError,50019:r.ExchangeError,50020:r.ExchangeError,50021:r.ExchangeError,50022:r.ExchangeError,50023:r.ExchangeError,50024:r.BadRequest,50025:r.ExchangeError,50026:r.ExchangeNotAvailable,50027:r.PermissionDenied,50028:r.ExchangeError,50044:r.BadRequest,50061:r.ExchangeError,50062:r.ExchangeError,50100:r.ExchangeError,50101:r.AuthenticationError,50102:r.InvalidNonce,50103:r.AuthenticationError,50104:r.AuthenticationError,50105:r.AuthenticationError,50106:r.AuthenticationError,50107:r.AuthenticationError,50108:r.ExchangeError,50109:r.ExchangeError,50110:r.PermissionDenied,50111:r.AuthenticationError,50112:r.AuthenticationError,50113:r.AuthenticationError,50114:r.AuthenticationError,50115:r.BadRequest,51e3:r.BadRequest,51001:r.BadSymbol,51002:r.BadSymbol,51003:r.BadRequest,51004:r.InvalidOrder,51005:r.InvalidOrder,51006:r.InvalidOrder,51007:r.InvalidOrder,51008:r.InsufficientFunds,51009:r.AccountSuspended,51010:r.AccountNotEnabled,51011:r.InvalidOrder,51012:r.BadSymbol,51014:r.BadSymbol,51015:r.BadSymbol,51016:r.InvalidOrder,51017:r.ExchangeError,51018:r.ExchangeError,51019:r.ExchangeError,51020:r.InvalidOrder,51021:r.ContractUnavailable,51022:r.ContractUnavailable,51023:r.ExchangeError,51024:r.AccountSuspended,51025:r.ExchangeError,51026:r.BadSymbol,51027:r.ContractUnavailable,51028:r.ContractUnavailable,51029:r.ContractUnavailable,51030:r.ContractUnavailable,51031:r.InvalidOrder,51046:r.InvalidOrder,51047:r.InvalidOrder,51051:r.InvalidOrder,51072:r.InvalidOrder,51073:r.InvalidOrder,51074:r.InvalidOrder,51090:r.InvalidOrder,51091:r.InvalidOrder,51092:r.InvalidOrder,51093:r.InvalidOrder,51094:r.InvalidOrder,51095:r.InvalidOrder,51096:r.InvalidOrder,51098:r.InvalidOrder,51099:r.InvalidOrder,51100:r.InvalidOrder,51101:r.InvalidOrder,51102:r.InvalidOrder,51103:r.InvalidOrder,51104:r.InvalidOrder,51105:r.InvalidOrder,51106:r.InvalidOrder,51107:r.InvalidOrder,51108:r.InvalidOrder,51109:r.InvalidOrder,51110:r.InvalidOrder,51111:r.BadRequest,51112:r.InvalidOrder,51113:r.RateLimitExceeded,51115:r.InvalidOrder,51116:r.InvalidOrder,51117:r.InvalidOrder,51118:r.InvalidOrder,51119:r.InsufficientFunds,51120:r.InvalidOrder,51121:r.InvalidOrder,51122:r.InvalidOrder,51124:r.InvalidOrder,51125:r.InvalidOrder,51126:r.InvalidOrder,51127:r.InsufficientFunds,51128:r.InvalidOrder,51129:r.InvalidOrder,51130:r.BadSymbol,51131:r.InsufficientFunds,51132:r.InvalidOrder,51133:r.InvalidOrder,51134:r.InvalidOrder,51135:r.InvalidOrder,51136:r.InvalidOrder,51137:r.InvalidOrder,51138:r.InvalidOrder,51139:r.InvalidOrder,51155:r.RestrictedLocation,51156:r.BadRequest,51159:r.BadRequest,51162:r.InvalidOrder,51163:r.InvalidOrder,51166:r.InvalidOrder,51174:r.InvalidOrder,51185:r.InvalidOrder,51201:r.InvalidOrder,51202:r.InvalidOrder,51203:r.InvalidOrder,51204:r.InvalidOrder,51205:r.InvalidOrder,51250:r.InvalidOrder,51251:r.InvalidOrder,51252:r.InvalidOrder,51253:r.InvalidOrder,51254:r.InvalidOrder,51255:r.InvalidOrder,51256:r.InvalidOrder,51257:r.InvalidOrder,51258:r.InvalidOrder,51259:r.InvalidOrder,51260:r.InvalidOrder,51261:r.InvalidOrder,51262:r.InvalidOrder,51263:r.InvalidOrder,51264:r.InvalidOrder,51265:r.InvalidOrder,51267:r.InvalidOrder,51268:r.InvalidOrder,51269:r.InvalidOrder,51270:r.InvalidOrder,51271:r.InvalidOrder,51272:r.InvalidOrder,51273:r.InvalidOrder,51274:r.InvalidOrder,51275:r.InvalidOrder,51276:r.InvalidOrder,51277:r.InvalidOrder,51278:r.InvalidOrder,51279:r.InvalidOrder,51280:r.InvalidOrder,51321:r.InvalidOrder,51322:r.InvalidOrder,51323:r.BadRequest,51324:r.BadRequest,51325:r.InvalidOrder,51327:r.InvalidOrder,51328:r.InvalidOrder,51329:r.InvalidOrder,51330:r.InvalidOrder,51400:r.OrderNotFound,51401:r.OrderNotFound,51402:r.OrderNotFound,51403:r.InvalidOrder,51404:r.InvalidOrder,51405:r.ExchangeError,51406:r.ExchangeError,51407:r.BadRequest,51408:r.ExchangeError,51409:r.ExchangeError,51410:r.CancelPending,51500:r.ExchangeError,51501:r.ExchangeError,51502:r.InsufficientFunds,51503:r.ExchangeError,51506:r.ExchangeError,51508:r.ExchangeError,51509:r.ExchangeError,51510:r.ExchangeError,51511:r.ExchangeError,51600:r.ExchangeError,51601:r.ExchangeError,51602:r.ExchangeError,51603:r.OrderNotFound,51732:r.AuthenticationError,51733:r.AuthenticationError,51734:r.AuthenticationError,51735:r.ExchangeError,51736:r.InsufficientFunds,52e3:r.ExchangeError,54e3:r.ExchangeError,54001:r.ExchangeError,54008:r.InvalidOrder,54009:r.InvalidOrder,54011:r.InvalidOrder,54072:r.ExchangeError,54073:r.BadRequest,54074:r.ExchangeError,55100:r.InvalidOrder,55101:r.InvalidOrder,55102:r.InvalidOrder,55103:r.InvalidOrder,55104:r.InvalidOrder,55111:r.InvalidOrder,55112:r.InvalidOrder,55113:r.InvalidOrder,58e3:r.ExchangeError,58001:r.AuthenticationError,58002:r.PermissionDenied,58003:r.ExchangeError,58004:r.AccountSuspended,58005:r.ExchangeError,58006:r.ExchangeError,58007:r.ExchangeError,58100:r.ExchangeError,58101:r.AccountSuspended,58102:r.RateLimitExceeded,58103:r.ExchangeError,58104:r.ExchangeError,58105:r.ExchangeError,58106:r.ExchangeError,58107:r.ExchangeError,58108:r.ExchangeError,58109:r.ExchangeError,58110:r.ExchangeError,58111:r.ExchangeError,58112:r.ExchangeError,58114:r.ExchangeError,58115:r.ExchangeError,58116:r.ExchangeError,58117:r.ExchangeError,58125:r.BadRequest,58126:r.BadRequest,58127:r.BadRequest,58128:r.BadRequest,58200:r.ExchangeError,58201:r.ExchangeError,58202:r.ExchangeError,58203:r.InvalidAddress,58204:r.AccountSuspended,58205:r.ExchangeError,58206:r.ExchangeError,58207:r.InvalidAddress,58208:r.ExchangeError,58209:r.ExchangeError,58210:r.ExchangeError,58211:r.ExchangeError,58212:r.ExchangeError,58213:r.AuthenticationError,58221:r.BadRequest,58222:r.BadRequest,58224:r.BadRequest,58227:r.BadRequest,58228:r.BadRequest,58229:r.InsufficientFunds,58300:r.ExchangeError,58350:r.InsufficientFunds,59e3:r.ExchangeError,59001:r.ExchangeError,59100:r.ExchangeError,59101:r.ExchangeError,59102:r.ExchangeError,59103:r.InsufficientFunds,59104:r.ExchangeError,59105:r.ExchangeError,59106:r.ExchangeError,59107:r.ExchangeError,59108:r.InsufficientFunds,59109:r.ExchangeError,59128:r.InvalidOrder,59200:r.InsufficientFunds,59201:r.InsufficientFunds,59216:r.BadRequest,59260:r.PermissionDenied,59262:r.PermissionDenied,59300:r.ExchangeError,59301:r.ExchangeError,59313:r.ExchangeError,59401:r.ExchangeError,59410:r.OperationRejected,59411:r.InsufficientFunds,59412:r.OperationRejected,59413:r.OperationRejected,59414:r.BadRequest,59500:r.ExchangeError,59501:r.ExchangeError,59502:r.ExchangeError,59503:r.ExchangeError,59504:r.ExchangeError,59505:r.ExchangeError,59506:r.ExchangeError,59507:r.ExchangeError,59508:r.AccountSuspended,59515:r.ExchangeError,59516:r.ExchangeError,59517:r.ExchangeError,59518:r.ExchangeError,59519:r.ExchangeError,59642:r.BadRequest,59643:r.ExchangeError,59683:r.ExchangeError,59684:r.BadRequest,59686:r.BadRequest,60001:r.AuthenticationError,60002:r.AuthenticationError,60003:r.AuthenticationError,60004:r.AuthenticationError,60005:r.AuthenticationError,60006:r.InvalidNonce,60007:r.AuthenticationError,60008:r.AuthenticationError,60009:r.AuthenticationError,60010:r.AuthenticationError,60011:r.AuthenticationError,60012:r.BadRequest,60013:r.BadRequest,60014:r.RateLimitExceeded,60015:r.NetworkError,60016:r.ExchangeNotAvailable,60017:r.BadRequest,60018:r.BadRequest,60019:r.BadRequest,60020:r.ExchangeError,60021:r.AccountNotEnabled,60022:r.AuthenticationError,60023:r.DDoSProtection,60024:r.AuthenticationError,60025:r.ExchangeError,60026:r.AuthenticationError,60027:r.ArgumentsRequired,60028:r.NotSupported,60029:r.AccountNotEnabled,60030:r.AccountNotEnabled,60031:r.AuthenticationError,60032:r.AuthenticationError,63999:r.ExchangeError,64e3:r.BadRequest,64001:r.BadRequest,64002:r.BadRequest,64003:r.AccountNotEnabled,70010:r.BadRequest,70013:r.BadRequest,70016:r.BadRequest,70060:r.BadRequest,70061:r.BadRequest,70062:r.BadRequest,70064:r.BadRequest,70065:r.BadRequest,70066:r.BadRequest,70067:r.BadRequest,1009:r.BadRequest,4001:r.AuthenticationError,4002:r.BadRequest,4003:r.RateLimitExceeded,4004:r.NetworkError,4005:r.ExchangeNotAvailable,4006:r.BadRequest,4007:r.AuthenticationError,4008:r.RateLimitExceeded},broad:{"Internal Server Error":r.ExchangeNotAvailable,"server error":r.ExchangeNotAvailable}},httpExceptions:{429:r.ExchangeNotAvailable},precisionMode:n.kb,options:{sandboxMode:!1,defaultNetwork:"ERC20",defaultNetworks:{ETH:"ERC20",BTC:"BTC",USDT:"TRC20"},networks:{BTC:"Bitcoin",BTCLN:"Lightning",BTCLIGHTNING:"Lightning",BEP20:"BSC",BRC20:"BRC20",ERC20:"ERC20",TRC20:"TRC20",CRC20:"Crypto",ACA:"Acala",ALGO:"Algorand",APT:"Aptos",SCROLL:"Scroll",ARBONE:"Arbitrum One",AVAXC:"Avalanche C-Chain",AVAXX:"Avalanche X-Chain",BASE:"Base",SUI:"SUI",ZKSYNCERA:"zkSync Era",LINEA:"Linea",AR:"Arweave",ASTR:"Astar",BCH:"BitcoinCash",BSV:"Bitcoin SV",ADA:"Cardano",CSPR:"Casper",CELO:"CELO",XCH:"Chia",ATOM:"Cosmos",DGB:"Digibyte",DOGE:"Dogecoin",EGLD:"Elrond",CFX:"Conflux",EOS:"EOS",CORE:"CORE",ETC:"Ethereum Classic",ETHW:"EthereumPow",FIL:"Filecoin",ONE:"Harmony",HBAR:"Hedera",ICX:"ICON",ICP:"Dfinity",IOST:"IOST",IOTA:"MIOTA",KLAY:"Klaytn",KSM:"Kusama",LSK:"Lisk",LTC:"Litecoin",METIS:"Metis",MINA:"Mina",GLRM:"Moonbeam",MOVR:"Moonriver",NANO:"Nano",NEAR:"NEAR",NULS:"NULS",OASYS:"OASYS",ONT:"Ontology",OPTIMISM:"Optimism",LAT:"PlatON",DOT:"Polkadot",MATIC:"Polygon",RVN:"Ravencoin",XRP:"Ripple",SC:"Siacoin",SOL:"Solana",STX:"l-Stacks",XLM:"Stellar Lumens",XTZ:"Tezos",TON:"TON",THETA:"Theta",WAX:"Wax",ZIL:"Zilliqa"},fetchOpenInterestHistory:{timeframes:{"5m":"5m","1h":"1H","8h":"8H","1d":"1D","5M":"5m","1H":"1H","8H":"8H","1D":"1D"}},fetchOHLCV:{timezone:"UTC"},fetchPositions:{method:"privateGetAccountPositions"},createOrder:"privatePostTradeBatchOrders",createMarketBuyOrderRequiresPrice:!1,fetchMarkets:{types:["spot","future","swap","option"]},timeDifference:0,adjustForTimeDifference:!1,defaultType:"spot",fetchLedger:{method:"privateGetAccountBills"},fetchOrder:{method:"privateGetTradeOrder"},fetchOpenOrders:{method:"privateGetTradeOrdersPending"},cancelOrders:{method:"privatePostTradeCancelBatchOrders"},fetchCanceledOrders:{method:"privateGetTradeOrdersHistory"},fetchClosedOrders:{method:"privateGetTradeOrdersHistory"},withdraw:{password:void 0,pwd:void 0},algoOrderTypes:{conditional:!0,trigger:!0,oco:!0,move_order_stop:!0,iceberg:!0,twap:!0},accountsByType:{funding:"6",trading:"18",spot:"18",future:"18",futures:"18",margin:"18",swap:"18",option:"18"},accountsById:{6:"funding",18:"trading"},exchangeType:{spot:"SPOT",margin:"MARGIN",swap:"SWAP",future:"FUTURES",futures:"FUTURES",option:"OPTION",SPOT:"SPOT",MARGIN:"MARGIN",SWAP:"SWAP",FUTURES:"FUTURES",OPTION:"OPTION"},brokerId:"6b9ad766b55dBCDE"},features:{default:{sandbox:!0,createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:{last:!0,mark:!0,index:!0},triggerDirection:!1,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:{triggerPriceType:{last:!0,mark:!0,index:!0},price:!0},timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!0,trailing:!0,iceberg:!0,leverage:!1,selfTradePrevention:!0,marketBuyByCost:!0,marketBuyRequiresPrice:!1},createOrders:{max:20},fetchMyTrades:{marginMode:!1,daysBack:90,limit:100,untilDays:1e4,symbolRequired:!1},fetchOrder:{marginMode:!1,trigger:!0,trailing:!0,symbolRequired:!0},fetchOpenOrders:{marginMode:!1,limit:100,trigger:!0,trailing:!0,symbolRequired:!1},fetchOrders:void 0,fetchClosedOrders:{marginMode:!1,limit:100,daysBack:90,daysBackCanceled:1/12,untilDays:void 0,trigger:!0,trailing:!0,symbolRequired:!1},fetchOHLCV:{limit:300,mark:100,index:100}},spot:{extends:"default",fetchCurrencies:{private:!0}},swap:{linear:{extends:"default"},inverse:{extends:"default"}},future:{linear:{extends:"default"},inverse:{extends:"default"}}},currencies:{USD:this.safeCurrencyStructure({id:"USD",code:"USD",precision:this.parseNumber("0.0001")}),EUR:this.safeCurrencyStructure({id:"EUR",code:"EUR",precision:this.parseNumber("0.0001")}),AED:this.safeCurrencyStructure({id:"AED",code:"AED",precision:this.parseNumber("0.0001")}),GBP:this.safeCurrencyStructure({id:"GBP",code:"GBP",precision:this.parseNumber("0.0001")}),AUD:this.safeCurrencyStructure({id:"AUD",code:"AUD",precision:this.parseNumber("0.0001")})},commonCurrencies:{AE:"AET"}})}handleMarketTypeAndParams(t,e=void 0,i={},s=void 0){const r=this.safeString(i,"instType");i=this.omit(i,"instType");return void 0===this.safeString(i,"type")&&void 0!==r&&(i.type=r),super.handleMarketTypeAndParams(t,e,i,s)}convertToInstrumentType(t){const e=this.safeDict(this.options,"exchangeType",{});return this.safeString(e,t,t)}createExpiredOptionMarket(t){const e="USD",i=t.split("-"),s=t.split("/");let r;r=t.indexOf("/")>-1?this.safeString(s,0):this.safeString(i,0);const a=r,n=this.safeString(i,2),o=this.safeString(i,3),d=this.safeString(i,4),c=this.convertExpireDate(n),h=this.parse8601(c);return{id:r+"-"+e+"-"+n+"-"+o+"-"+d,symbol:r+"/"+e+":"+a+"-"+n+"-"+o+"-"+d,base:r,quote:e,settle:a,baseId:r,quoteId:e,settleId:a,active:!1,type:"option",linear:void 0,inverse:void 0,spot:!1,swap:!1,future:!1,option:!0,margin:!1,contract:!0,contractSize:this.parseNumber("1"),expiry:h,expiryDatetime:c,optionType:"C"===d?"call":"put",strike:this.parseNumber(o),precision:{amount:void 0,price:void 0},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:void 0}}safeMarket(t=void 0,e=void 0,i=void 0,s=void 0){return void 0!==t&&(t.indexOf("-C")>-1||t.indexOf("-P")>-1)&&!(t in this.markets_by_id)?this.createExpiredOptionMarket(t):super.safeMarket(t,e,i,s)}async fetchStatus(t={}){const e=await this.publicGetSystemStatus(t),i=this.safeList(e,"data",[]),s={updated:void 0,status:0===i.length?"ok":"maintenance",eta:void 0,url:void 0,info:e};for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"state");s.eta=this.safeInteger(e,"end"),s.url=this.safeString(e,"href"),"ongoing"===r?s.status="maintenance":("scheduled"===r||"completed"===r||"canceled"===r)&&(s.status="ok")}return s}async fetchTime(t={}){const e=await this.publicGetPublicTime(t),i=this.safeList(e,"data",[]),s=this.safeDict(i,0,{});return this.safeInteger(s,"ts")}async fetchAccounts(t={}){const e=await this.privateGetAccountConfig(t),i=this.safeList(e,"data",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"uid"),a=this.safeString(e,"acctLv");s.push({id:r,type:a,currency:void 0,info:e,code:void 0})}return s}nonce(){return this.milliseconds()-this.options.timeDifference}async fetchMarkets(t={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference();let e=["spot","future","swap","option"];const i=this.safeDict(this.options,"fetchMarkets");e=void 0!==i?this.safeList(i,"types",e):this.safeList(this.options,"fetchMarkets",e);let s=[],r=[];for(let i=0;i<e.length;i++)s.push(this.fetchMarketsByType(e[i],t));s=await Promise.all(s);for(let t=0;t<s.length;t++)r=this.arrayConcat(r,s[t]);return r}parseMarket(t){const e=this.safeString(t,"instId");let i=this.safeStringLower(t,"instType");"futures"===i&&(i="future");const s="spot"===i,r="future"===i,n="swap"===i,o="option"===i,d=n||r||o;let c=this.safeString(t,"baseCcy",""),h=this.safeString(t,"quoteCcy","");const l=this.safeString(t,"settleCcy"),u=this.safeCurrencyCode(l),p=this.safeString(t,"uly");if(void 0!==p&&!s){const t=p.split("-");c=this.safeString(t,0),h=this.safeString(t,1)}if((""===c||""===h)&&s){const e=this.safeString(t,"instId","").split("-");c=this.safeString(e,0),h=this.safeString(e,1)}const f=this.safeCurrencyCode(c),m=this.safeCurrencyCode(h);let g,y,v,b=f+"/"+m;if(""!==f&&""!==m||(b=e),d)if(void 0!==u&&(b=b+":"+u),r){if(g=this.safeInteger(t,"expTime"),void 0!==g){b=b+"-"+this.yymmdd(g)}}else if(o&&(g=this.safeInteger(t,"expTime"),y=this.safeString(t,"stk"),v=this.safeString(t,"optType"),void 0!==g)){b=b+"-"+this.yymmdd(g)+"-"+y+"-"+v,v="P"===v?"put":"call"}const w=this.safeDict2(this.fees,i,"trading",{});let S=this.safeString(t,"lever","1");S=a.Y.stringMax(S,"1");const k=this.safeNumber(t,"maxMktSz"),O=this.safeString(t,"state");return this.extend(w,{id:e,symbol:b,base:f,quote:m,settle:u,baseId:c,quoteId:h,settleId:l,type:i,spot:s,margin:s&&a.Y.stringGt(S,"1"),swap:n,future:r,option:o,active:"live"===O,contract:d,linear:d?h===l:void 0,inverse:d?c===l:void 0,contractSize:d?this.safeNumber(t,"ctVal"):void 0,expiry:g,expiryDatetime:this.iso8601(g),strike:this.parseNumber(y),optionType:v,created:this.safeInteger2(t,"contTdSwTime","listTime"),precision:{amount:this.safeNumber(t,"lotSz"),price:this.safeNumber(t,"tickSz")},limits:{leverage:{min:this.parseNumber("1"),max:this.parseNumber(S)},amount:{min:this.safeNumber(t,"minSz"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:d?void 0:k}},info:t})}async fetchMarketsByType(t,e={}){const i={instType:this.convertToInstrumentType(t)};if("option"===t){const t=this.safeList(this.options,"defaultUnderlying",["BTC-USD","ETH-USD"]),s=[];for(let r=0;r<t.length;r++){const a=t[r];i.uly=a,s.push(this.publicGetPublicInstruments(this.extend(i,e)))}const r=await Promise.all(s);let a=[];for(let t=0;t<r.length;t++){const e=this.safeDict(r,t,{}),i=this.safeList(e,"data",[]);a=this.arrayConcat(a,i)}return this.parseMarkets(a)}const s=await this.publicGetPublicInstruments(this.extend(i,e)),r=this.safeList(s,"data",[]);return this.parseMarkets(r)}async fetchCurrencies(t={}){const e=this.safeBool(this.options,"sandboxMode",!1);if(!this.checkRequiredCredentials(!1)||e)return{};const i=await this.privateGetAssetCurrencies(t),s=this.safeList(i,"data",[]),r={},a=this.groupBy(s,"ccy"),n=Object.keys(a);for(let t=0;t<n.length;t++){const e=n[t],i=this.safeCurrency(e),s=i.code,o=a[e],d={};let c="crypto";const h=o.length;for(let t=0;t<h;t++){const e=o[t],s=this.safeString(e,"chain","");""===s&&(c="fiat");const r=s.split("-"),a=this.arraySlice(r,1).join("-"),n=this.networkIdToCode(a,i.code);d[n]={id:s,network:n,active:void 0,deposit:this.safeBool(e,"canDep"),withdraw:this.safeBool(e,"canWd"),fee:this.safeNumber(e,"fee"),precision:this.parseNumber(this.parsePrecision(this.safeString(e,"wdTickSz"))),limits:{withdraw:{min:this.safeNumber(e,"minWd"),max:this.safeNumber(e,"maxWd")}},info:e}}const l=this.safeDict(o,0,{});r[s]=this.safeCurrencyStructure({info:o,code:s,id:e,name:this.safeString(l,"name"),active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0}},type:c,networks:d})}return r}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s={instId:this.market(t).id};let r,a;[r,i]=this.handleOptionAndParams(i,"fetchOrderBook","method","publicGetMarketBooks"),"publicGetMarketBooksFull"===r&&void 0===e&&(e=5e3),void 0!==(e=void 0===e?100:e)&&(s.sz=e),a="publicGetMarketBooksFull"===r||e>400?await this.publicGetMarketBooksFull(this.extend(s,i)):await this.publicGetMarketBooks(this.extend(s,i));const n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{}),d=this.safeInteger(o,"ts");return this.parseOrderBook(o,t,d)}parseTicker(t,e=void 0){const i=this.safeInteger(t,"ts"),s=this.safeString(t,"instId"),r=(e=this.safeMarket(s,e,"-")).symbol,a=this.safeString(t,"last"),n=this.safeString(t,"open24h"),o=this.safeBool(e,"spot",!1)?this.safeString(t,"volCcy24h"):void 0,d=this.safeString(t,"vol24h"),c=this.safeString(t,"high24h"),h=this.safeString(t,"low24h");return this.safeTicker({symbol:r,timestamp:i,datetime:this.iso8601(i),high:c,low:h,bid:this.safeString(t,"bidPx"),bidVolume:this.safeString(t,"bidSz"),ask:this.safeString(t,"askPx"),askVolume:this.safeString(t,"askSz"),vwap:void 0,open:n,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:d,quoteVolume:o,markPrice:this.safeString(t,"markPx"),indexPrice:this.safeString(t,"idxPx"),info:t},e)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={instId:i.id},r=await this.publicGetMarketTicker(this.extend(s,e)),a=this.safeList(r,"data",[]),n=this.safeDict(a,0,{});return this.parseTicker(n,i)}async fetchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.getMarketFromSymbols(t);let s;[s,e]=this.handleMarketTypeAndParams("fetchTickers",i,e);const a={instType:this.convertToInstrumentType(s)};if("option"===s){const t=this.safeString(this.options,"defaultUnderlying","BTC-USD"),i=this.safeString2(e,"uly","marketId",t);if(void 0===i)throw new r.ArgumentsRequired(this.id+" fetchTickers() requires an underlying uly or marketId parameter for options markets");a.uly=i}const n=await this.publicGetMarketTickers(this.extend(a,e)),o=this.safeList(n,"data",[]);return this.parseTickers(o,t)}async fetchMarkPrice(t,e={}){await this.loadMarkets();const i=this.market(t),s={instId:i.id},r=await this.publicGetPublicMarkPrice(this.extend(s,e)),a=this.safeList(r,"data");return this.parseTicker(this.safeDict(a,0),i)}async fetchMarkPrices(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.getMarketFromSymbols(t);let s;[s,e]=this.handleMarketTypeAndParams("fetchTickers",i,e,"swap");const a={instType:this.convertToInstrumentType(s)};if("option"===s){const t=this.safeString(this.options,"defaultUnderlying","BTC-USD"),i=this.safeString2(e,"uly","marketId",t);if(void 0===i)throw new r.ArgumentsRequired(this.id+" fetchMarkPrices() requires an underlying uly or marketId parameter for options markets");a.uly=i}const n=await this.publicGetPublicMarkPrice(this.extend(a,e)),o=this.safeList(n,"data",[]);return this.parseTickers(o,t)}parseTrade(t,e=void 0){const i=this.safeString(t,"tradeId"),s=this.safeString(t,"instId"),r=(e=this.safeMarket(s,e,"-")).symbol,n=this.safeInteger(t,"ts"),o=this.safeString2(t,"fillPx","px"),d=this.safeString2(t,"fillSz","sz"),c=this.safeString(t,"side"),h=this.safeString(t,"ordId"),l=this.safeString(t,"fee");let u;if(void 0!==l){const e=a.Y.stringNeg(l),i=this.safeString(t,"feeCcy");u={cost:e,currency:this.safeCurrencyCode(i)}}let p=this.safeString(t,"execType");return"T"===p?p="taker":"M"===p&&(p="maker"),this.safeTrade({info:t,timestamp:n,datetime:this.iso8601(n),symbol:r,id:i,order:h,type:void 0,takerOrMaker:p,side:c,price:o,amount:d,cost:void 0,fee:u},e)}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchTrades","paginate"),r)return await this.fetchPaginatedCallCursor("fetchTrades",t,e,i,s,"tradeId","after",void 0,100);const a=this.market(t),n={instId:a.id};let o;if(a.option)o=await this.publicGetPublicOptionTrades(this.extend(n,s));else{let t;void 0!==i&&(n.limit=i),[t,s]=this.handleOptionAndParams(s,"fetchTrades","method","publicGetMarketTrades"),"publicGetMarketTrades"===t?o=await this.publicGetMarketTrades(this.extend(n,s)):"publicGetMarketHistoryTrades"===t&&(o=await this.publicGetMarketHistoryTrades(this.extend(n,s)))}const d=this.safeList(o,"data",[]);return this.parseTrades(d,a,e,i)}parseOHLCV(t,e=void 0){const i="spot"===this.handleMarketTypeAndParams("fetchOHLCV",e,void 0)[0]?5:6;return[this.safeInteger(t,0),this.safeNumber(t,1),this.safeNumber(t,2),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,i)]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);let n=!1;if([n,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate"),n)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,200);const o=this.safeString(r,"price"),d=this.inArray(o,["mark","index"]);r=this.omit(r,"price");const c=this.safeDict(this.options,"fetchOHLCV",{}),h=this.safeString(c,"timezone","UTC"),l=void 0===s;if(void 0===s)s=100;else{const t=d?100:300;s=Math.min(s,t)}const u=this.parseTimeframe(e);let p=this.safeString(this.timeframes,e,e);"UTC"===h&&u>=21600&&(p+=h.toLowerCase());const f={instId:a.id,bar:p,limit:s};let m="Candles";if(void 0!==i){const t=1e3*u;if(i<this.milliseconds()-1439*t){m="HistoryCandles";const t=d?100:300;s=Math.min(s,t)}const e=Math.max(i-1,0);f.before=e,f.after=this.sum(i,t*s)}const g=this.safeInteger(r,"until");void 0!==g&&(f.after=g,r=this.omit(r,"until")),m=this.safeString(c,"type",m);const y=this.safeString(r,"type",m);r=this.omit(r,"type");const v="HistoryCandles"===y;let b;"mark"===o?b=v?await this.publicGetMarketHistoryMarkPriceCandles(this.extend(f,r)):await this.publicGetMarketMarkPriceCandles(this.extend(f,r)):"index"===o?(f.instId=a.info.instFamily,b=v?await this.publicGetMarketHistoryIndexCandles(this.extend(f,r)):await this.publicGetMarketIndexCandles(this.extend(f,r))):v?(l&&100===s&&(s=300,f.limit=300),b=await this.publicGetMarketHistoryCandles(this.extend(f,r))):b=await this.publicGetMarketCandles(this.extend(f,r));const w=this.safeList(b,"data",[]);return this.parseOHLCVs(w,a,e,i,s)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),a)return await this.fetchPaginatedCallDeterministic("fetchFundingRateHistory",t,e,i,"8h",s,100);const n=this.market(t),o={instId:n.id};void 0!==e&&(o.before=Math.max(e-1,0)),void 0!==i&&(o.limit=i);const d=await this.publicGetPublicFundingRateHistory(this.extend(o,s)),c=[],h=this.safeList(d,"data",[]);for(let t=0;t<h.length;t++){const e=h[t],i=this.safeInteger(e,"fundingTime");c.push({info:e,symbol:this.safeSymbol(this.safeString(e,"instId")),fundingRate:this.safeNumber(e,"realizedRate"),timestamp:i,datetime:this.iso8601(i)})}const l=this.sortBy(c,"timestamp");return this.filterBySymbolSinceLimit(l,n.symbol,e,i)}parseBalanceByType(t,e){return"funding"===t?this.parseFundingBalance(e):this.parseTradingBalance(e)}parseTradingBalance(t){const e={info:t},i=this.safeList(t,"data",[]),s=this.safeDict(i,0,{}),r=this.safeInteger(s,"uTime"),a=this.safeList(s,"details",[]);for(let t=0;t<a.length;t++){const i=a[t],s=this.safeString(i,"ccy"),r=this.safeCurrencyCode(s),n=this.account(),o=this.safeString(i,"eq"),d=this.safeString(i,"availEq");n.total=o,void 0===d?(n.free=this.safeString(i,"availBal"),n.used=this.safeString(i,"frozenBal")):n.free=d,e[r]=n}return e.timestamp=r,e.datetime=this.iso8601(r),this.safeBalance(e)}parseFundingBalance(t){const e={info:t},i=this.safeList(t,"data",[]);for(let t=0;t<i.length;t++){const s=i[t],r=this.safeString(s,"ccy"),a=this.safeCurrencyCode(r),n=this.account();n.total=this.safeString(s,"bal"),n.free=this.safeString(s,"availBal"),n.used=this.safeString(s,"frozenBal"),e[a]=n}return this.safeBalance(e)}parseTradingFee(t,e=void 0){return{info:t,symbol:this.safeSymbol(void 0,e),maker:this.parseNumber(a.Y.stringNeg(this.safeString2(t,"maker","makerU"))),taker:this.parseNumber(a.Y.stringNeg(this.safeString2(t,"taker","takerU"))),percentage:void 0,tierBased:void 0}}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={instType:this.convertToInstrumentType(i.type)};if(i.spot)s.instId=i.id;else{if(!(i.swap||i.future||i.option))throw new r.NotSupported(this.id+" fetchTradingFee() supports spot, swap, future or option markets only");s.uly=i.baseId+"-"+i.quoteId}const a=await this.privateGetAccountTradeFee(this.extend(s,e)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{});return this.parseTradingFee(o,i)}async fetchBalance(t={}){await this.loadMarkets();const[e,i]=this.handleMarketTypeAndParams("fetchBalance",void 0,t),s={};let r;return r="funding"===e?await this.privateGetAssetBalances(this.extend(s,i)):await this.privateGetAccountBalance(this.extend(s,i)),this.parseBalanceByType(e,r)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot markets only");return await this.createOrder(t,"market","buy",e,void 0,this.extend({createMarketBuyOrderRequiresPrice:!1,tgtCcy:"quote_ccy"},i))}async createMarketSellOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketSellOrderWithCost() supports spot markets only");return await this.createOrder(t,"market","sell",e,void 0,this.extend({createMarketBuyOrderRequiresPrice:!1,tgtCcy:"quote_ccy"},i))}createOrderRequest(t,e,i,s,n=void 0,o={}){const d=this.market(t);let c={instId:d.id,side:i,ordType:e,sz:this.amountToPrecision(t,s)};const h=d.spot,l=d.contract,u=this.safeValueN(o,["triggerPrice","stopPrice","triggerPx"]),p=this.safeString(o,"timeInForce","GTC"),f=this.safeValue2(o,"takeProfitPrice","tpTriggerPx"),m=this.safeValue(o,"tpOrdPx",n),g=this.safeString(o,"tpTriggerPxType","last"),y=this.safeValue2(o,"stopLossPrice","slTriggerPx"),v=this.safeValue(o,"slOrdPx",n),b=this.safeString(o,"slTriggerPxType","last"),w=this.safeString2(o,"clOrdId","clientOrderId"),S=this.safeValue(o,"stopLoss"),k=this.safeValue(o,"takeProfit"),O=void 0!==S,T=void 0!==k,P=this.safeString2(o,"trailingPercent","callbackRatio"),_=void 0!==P,A=this.safeString2(o,"trailingPrice","callbackSpread"),I=void 0!==A,x=void 0!==u||"trigger"===e,E=this.safeValue(o,"reduceOnly",!1),M=this.safeString2(this.options,"defaultMarginMode","marginMode","cross");let C=this.safeString2(o,"marginMode","tdMode"),B=!1;if(void 0!==C&&"cash"!==C?B=!0:(C=M,B=this.safeBool(o,"margin",!1)),h){if(B){const t="buy"===i?d.quote:d.base,e=this.safeString(o,"ccy",t);c.ccy=this.safeCurrencyCode(e)}const t=B?C:"cash";c.tdMode=t}else if(l){if(d.swap||d.future){let t;if([t,o]=this.handleOptionAndParams(o,"createOrder","positionSide"),void 0!==t)c.posSide=t;else{let t;if([t,o]=this.handleOptionAndParams(o,"createOrder","hedged"),t){const t="buy"===i;void 0!==f||void 0!==y||E?(c.posSide=t?"short":"long",E&&(o=this.omit(o,"reduceOnly"))):c.posSide=t?"long":"short"}}}c.tdMode=C}const N="market"===e;let R=!1;[R,o]=this.handlePostOnly(N,"post_only"===e,o),o=this.omit(o,["currency","ccy","marginMode","timeInForce","stopPrice","triggerPrice","clientOrderId","stopLossPrice","takeProfitPrice","slOrdPx","tpOrdPx","margin","stopLoss","takeProfit","trailingPercent"]);const L="IOC"===p||"ioc"===e,D="FOK"===p||"fok"===e,q=void 0!==y||void 0!==f||"conditional"===e,F=N&&L||"optimal_limit_ioc"===e,V=this.safeString(this.options,"tgtCcy","base_ccy"),U=this.safeString(o,"tgtCcy",V);if(l||B||(c.tgtCcy=U),N||F){if(c.ordType="market",h&&"buy"===i&&"quote_ccy"===U){let e=!0;[e,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0);let i=this.safeNumber2(o,"cost","sz");if(o=this.omit(o,["cost","sz"]),e){if(void 0!==n){if(void 0===i){const t=this.numberToString(s),e=this.numberToString(n),r=a.Y.stringMul(t,e);i=this.parseNumber(r)}}else if(void 0===i)throw new r.InvalidOrder(this.id+" createOrder() requires the price argument with market buy orders to calculate total order cost (amount to spend), where cost = amount * price. Supply a price argument to createOrder() call if you want the cost to be calculated for you from price and amount, or, alternatively, add .options['createMarketBuyOrderRequiresPrice'] = false and supply the total cost value in the 'amount' argument or in the 'cost' unified extra parameter or in exchange-specific 'sz' extra parameter (the exchange-specific behaviour)")}else i=void 0===i?s:i;c.sz=this.costToPrecision(t,i)}F&&l&&(c.ordType="optimal_limit_ioc")}else x||q||(c.px=this.priceToPrecision(t,n));if(R?c.ordType="post_only":L&&!F?c.ordType="ioc":D&&(c.ordType="fok"),_){const t=a.Y.stringDiv(P,"100");c.callbackRatio=t,c.ordType="move_order_stop"}else if(I)c.callbackSpread=A,c.ordType="move_order_stop";else if(O||T){let e={};if(O){const i=this.safeValueN(S,["triggerPrice","stopPrice","slTriggerPx"]);if(void 0===i)throw new r.InvalidOrder(this.id+' createOrder() requires a trigger price in params["stopLoss"]["triggerPrice"], or params["stopLoss"]["stopPrice"], or params["stopLoss"]["slTriggerPx"] for a stop loss order');const s=this.priceToPrecision(t,i),a={};a.slTriggerPx=s;const n=this.safeValueN(S,["price","stopLossPrice","slOrdPx"]),o=this.safeString(S,"type");if(void 0!==o){const e="limit"===o;if(!e&&!("market"===o))throw new r.InvalidOrder(this.id+' createOrder() params["stopLoss"]["type"] must be either "limit" or "market"');if(e){if(void 0===n)throw new r.InvalidOrder(this.id+' createOrder() requires a limit price in params["stopLoss"]["price"] or params["stopLoss"]["slOrdPx"] for a stop loss limit order');a.slOrdPx=this.priceToPrecision(t,n)}else"market"===o&&(a.slOrdPx="-1")}else a.slOrdPx=void 0!==n?this.priceToPrecision(t,n):"-1";const d=this.safeString2(S,"triggerPriceType","slTriggerPxType","last");if(void 0!==d){if("last"!==d&&"index"!==d&&"mark"!==d)throw new r.InvalidOrder(this.id+' createOrder() stop loss trigger price type must be one of "last", "index" or "mark"');a.slTriggerPxType=d}e=this.extend(e,a)}if(T){const i=this.safeValueN(k,["triggerPrice","stopPrice","tpTriggerPx"]);if(void 0===i)throw new r.InvalidOrder(this.id+' createOrder() requires a trigger price in params["takeProfit"]["triggerPrice"], or params["takeProfit"]["stopPrice"], or params["takeProfit"]["tpTriggerPx"] for a take profit order');const s={};s.tpTriggerPx=this.priceToPrecision(t,i);const a=this.safeValueN(k,["price","takeProfitPrice","tpOrdPx"]),n=this.safeString2(k,"type","tpOrdKind");if(void 0!==n){const e="limit"===n;if(!e&&!("market"===n))throw new r.InvalidOrder(this.id+' createOrder() params["takeProfit"]["type"] must be either "limit" or "market"');if(e){if(void 0===a)throw new r.InvalidOrder(this.id+' createOrder() requires a limit price in params["takeProfit"]["price"] or params["takeProfit"]["tpOrdPx"] for a take profit limit order');s.tpOrdKind=n,s.tpOrdPx=this.priceToPrecision(t,a)}else"market"===n&&(s.tpOrdPx="-1")}else void 0!==a?(s.tpOrdKind="limit",s.tpOrdPx=this.priceToPrecision(t,a)):s.tpOrdPx="-1";const o=this.safeString2(k,"triggerPriceType","tpTriggerPxType","last");if(void 0!==o){if("last"!==o&&"index"!==o&&"mark"!==o)throw new r.InvalidOrder(this.id+' createOrder() take profit trigger price type must be one of "last", "index" or "mark"');s.tpTriggerPxType=o}e=this.extend(e,s)}Object.keys(e).length>0&&(c.attachAlgoOrds=[e])}if(x)c.ordType="trigger",c.triggerPx=this.priceToPrecision(t,u),c.orderPx=N?"-1":this.priceToPrecision(t,n);else if(q){c.ordType="conditional";if(void 0!==f&&void 0!==y&&(c.ordType="oco"),"sell"===i&&(c=this.omit(c,"tgtCcy")),"cash"===this.safeString(c,"tdMode")&&(c.tdMode=C),void 0!==f){c.tpTriggerPx=this.priceToPrecision(t,f);let e="-1";void 0!==m&&(e=this.priceToPrecision(t,m)),c.tpOrdPx=e,c.tpTriggerPxType=g}if(void 0!==y){c.slTriggerPx=this.priceToPrecision(t,y);let e="-1";void 0!==v&&(e=this.priceToPrecision(t,v)),c.slOrdPx=e,c.slTriggerPxType=b}}if(void 0===w){const t=this.safeString(this.options,"brokerId");void 0!==t&&(c.clOrdId=t+this.uuid16(),c.tag=t)}else c.clOrdId=w,o=this.omit(o,["clOrdId","clientOrderId"]);return this.extend(c,o)}async createOrder(t,e,i,s,a=void 0,n={}){await this.loadMarkets();const o=this.market(t);let d=this.createOrderRequest(t,e,i,s,a,n),c=this.safeString(this.options,"createOrder","privatePostTradeBatchOrders");const h=this.safeString(d,"ordType");if("trigger"!==h&&"conditional"!==h&&"move_order_stop"!==h&&"move_order_stop"!==e&&"oco"!==e&&"iceberg"!==e&&"twap"!==e||(c="privatePostTradeOrderAlgo"),"privatePostTradeOrder"!==c&&"privatePostTradeOrderAlgo"!==c&&"privatePostTradeBatchOrders"!==c)throw new r.ExchangeError(this.id+' createOrder() this.options["createOrder"] must be either privatePostTradeBatchOrders or privatePostTradeOrder or privatePostTradeOrderAlgo');let l;"privatePostTradeBatchOrders"===c&&(d=[d]),l="privatePostTradeOrder"===c?await this.privatePostTradeOrder(d):"privatePostTradeOrderAlgo"===c?await this.privatePostTradeOrderAlgo(d):await this.privatePostTradeBatchOrders(d);const u=this.safeList(l,"data",[]),p=this.safeDict(u,0,{}),f=this.parseOrder(p,o);return f.type=e,f.side=i,f}async createOrders(t,e={}){await this.loadMarkets();const i=[];for(let s=0;s<t.length;s++){const r=t[s],a=this.safeString(r,"symbol"),n=this.safeString(r,"type"),o=this.safeString(r,"side"),d=this.safeValue(r,"amount"),c=this.safeValue(r,"price"),h=this.safeDict(r,"params",{}),l=this.extend(h,e),u=this.createOrderRequest(a,n,o,d,c,l);i.push(u)}const s=await this.privatePostTradeBatchOrders(i),r=this.safeList(s,"data",[]);return this.parseOrders(r)}editOrderRequest(t,e,i,s,a=void 0,n=void 0,o={}){const d={instId:this.market(e).id};let c;"trigger"!==i&&"conditional"!==i&&"move_order_stop"!==i&&"oco"!==i&&"iceberg"!==i&&"twap"!==i||(c=!0);const h=this.safeString2(o,"clOrdId","clientOrderId");void 0!==h?c?d.algoClOrdId=h:d.clOrdId=h:c?d.algoId=t:d.ordId=t;let l=this.safeValue2(o,"stopLossPrice","newSlTriggerPx"),u=this.safeValue(o,"newSlOrdPx");const p=this.safeString(o,"newSlTriggerPxType","last");let f=this.safeValue2(o,"takeProfitPrice","newTpTriggerPx"),m=this.safeValue(o,"newTpOrdPx");const g=this.safeString(o,"newTpTriggerPxType","last"),y=this.safeValue(o,"stopLoss"),v=this.safeValue(o,"takeProfit"),b=void 0!==y,w=void 0!==v;if(c){if(void 0===l&&void 0===f)throw new r.BadRequest(this.id+" editOrder() requires a stopLossPrice or takeProfitPrice parameter for editing an algo order");if(void 0!==l){if(void 0===u)throw new r.BadRequest(this.id+" editOrder() requires a newSlOrdPx parameter for editing an algo order");d.newSlTriggerPx=this.priceToPrecision(e,l),d.newSlOrdPx="market"===i?"-1":this.priceToPrecision(e,u),d.newSlTriggerPxType=p}if(void 0!==f){if(void 0===m)throw new r.BadRequest(this.id+" editOrder() requires a newTpOrdPx parameter for editing an algo order");d.newTpTriggerPx=this.priceToPrecision(e,f),d.newTpOrdPx="market"===i?"-1":this.priceToPrecision(e,m),d.newTpTriggerPxType=g}}else{if(void 0!==l&&(d.newSlTriggerPx=this.priceToPrecision(e,l),d.newSlOrdPx="market"===i?"-1":this.priceToPrecision(e,u),d.newSlTriggerPxType=p),void 0!==f&&(d.newTpTriggerPx=this.priceToPrecision(e,f),d.newTpOrdPx="market"===i?"-1":this.priceToPrecision(e,m),d.newTpTriggerPxType=g),b){l=this.safeValue(y,"triggerPrice"),u=this.safeValue(y,"price");const t=this.safeString(y,"type");d.newSlTriggerPx=this.priceToPrecision(e,l),d.newSlOrdPx="market"===t?"-1":this.priceToPrecision(e,u),d.newSlTriggerPxType=p}if(w){f=this.safeValue(v,"triggerPrice"),m=this.safeValue(v,"price");const t=this.safeString(v,"type");d.newTpOrdKind="limit"===t?t:"condition",d.newTpTriggerPx=this.priceToPrecision(e,f),d.newTpOrdPx="market"===t?"-1":this.priceToPrecision(e,m),d.newTpTriggerPxType=g}}return void 0!==a&&(d.newSz=this.amountToPrecision(e,a)),c||void 0!==n&&(d.newPx=this.priceToPrecision(e,n)),o=this.omit(o,["clOrdId","clientOrderId","takeProfitPrice","stopLossPrice","stopLoss","takeProfit","postOnly"]),this.extend(d,o)}async editOrder(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.market(e),d=this.editOrderRequest(t,e,i,s,r,a,n);let c,h;"trigger"!==i&&"conditional"!==i&&"move_order_stop"!==i&&"oco"!==i&&"iceberg"!==i&&"twap"!==i||(c=!0),h=c?await this.privatePostTradeAmendAlgos(this.extend(d,n)):await this.privatePostTradeAmendOrder(this.extend(d,n));const l=this.safeList(h,"data",[]),u=this.safeDict(l,0,{}),p=this.parseOrder(u,o);return p.type=i,p.side=s,p}async cancelOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");const s=this.safeValue2(i,"stop","trigger"),a=this.safeBool(i,"trailing",!1);if(s||a){const s=await this.cancelOrders([t],e,i);return this.safeDict(s,0)}await this.loadMarkets();const n=this.market(e),o={instId:n.id},d=this.safeString2(i,"clOrdId","clientOrderId");void 0!==d?o.clOrdId=d:o.ordId=t;const c=this.omit(i,["clOrdId","clientOrderId"]),h=await this.privatePostTradeCancelOrder(this.extend(o,c)),l=this.safeValue(h,"data",[]),u=this.safeDict(l,0);return this.parseOrder(u,n)}parseIds(t){return void 0!==t&&"string"==typeof t?t.split(","):t}async cancelOrders(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a=[],n=this.safeValue(this.options,"cancelOrders",{}),o=this.safeString(n,"method","privatePostTradeCancelBatchOrders");let d=this.safeString(i,"method",o);const c=this.parseIds(this.safeValue2(i,"clOrdId","clientOrderId")),h=this.parseIds(this.safeValue(i,"algoId")),l=this.safeValue2(i,"stop","trigger"),u=this.safeBool(i,"trailing",!1);if((l||u)&&(d="privatePostTradeCancelAlgos"),void 0===c){if(t=this.parseIds(t),void 0!==h)for(let t=0;t<h.length;t++)a.push({algoId:h[t],instId:s.id});for(let e=0;e<t.length;e++)u||l?a.push({algoId:t[e],instId:s.id}):a.push({ordId:t[e],instId:s.id})}else for(let t=0;t<c.length;t++)u||l?a.push({instId:s.id,algoClOrdId:c[t]}):a.push({instId:s.id,clOrdId:c[t]});let p;p="privatePostTradeCancelAlgos"===d?await this.privatePostTradeCancelAlgos(a):await this.privatePostTradeCancelBatchOrders(a);const f=this.safeList(p,"data",[]);return this.parseOrders(f,s,void 0,void 0,i)}async cancelOrdersForSymbols(t,e={}){await this.loadMarkets();const i=[],s=this.safeDict(this.options,"cancelOrders",{}),r=this.safeString(s,"method","privatePostTradeCancelBatchOrders");let a=this.safeString(e,"method",r);const n=this.safeBool2(e,"stop","trigger"),o=this.safeBool(e,"trailing",!1),d=n||o;d&&(a="privatePostTradeCancelAlgos");for(let e=0;e<t.length;e++){const s=t[e],r=this.safeString(s,"id"),a=this.safeString2(s,"clOrdId","clientOrderId"),n=this.safeString(s,"symbol");let o="ordId";d?o="algoId":void 0!==a&&(o=d?"algoClOrdId":"clOrdId");const c={instId:this.market(n).id};c[o]=void 0!==a?a:r,i.push(c)}let c;c="privatePostTradeCancelAlgos"===a?await this.privatePostTradeCancelAlgos(i):await this.privatePostTradeCancelBatchOrders(i);const h=this.safeList(c,"data",[]);return this.parseOrders(h,void 0,void 0,void 0,e)}async cancelAllOrdersAfter(t,e={}){await this.loadMarkets();const i={timeOut:t>0?this.parseToInt(t/1e3):0};return await this.privatePostTradeCancelAllAfter(this.extend(i,e))}parseOrderStatus(t){return this.safeString({canceled:"canceled",order_failed:"canceled",live:"open",partially_filled:"open",filled:"closed",effective:"closed"},t,t)}parseOrder(t,e=void 0){const i=this.safeString(t,"sCode");if(void 0!==i&&"0"!==i)return this.safeOrder({id:this.safeString(t,"ordId"),clientOrderId:this.safeString(t,"clOrdId"),status:"rejected",info:t});const s=this.safeString2(t,"algoId","ordId"),r=this.safeInteger(t,"cTime"),n=this.safeInteger(t,"uTime"),o=this.safeInteger(t,"fillTime"),d=this.safeString(t,"side");let c,h,l=this.safeString(t,"ordType");"post_only"===l?(c=!0,l="limit"):"fok"===l?(h="FOK",l="limit"):"ioc"===l&&(h="IOC",l="limit");const u=this.safeString(t,"instId");e=this.safeMarket(u,e);const p=this.safeSymbol(u,e,"-"),f=this.safeString(t,"accFillSz"),m=this.safeString2(t,"px","ordPx"),g=this.safeString(t,"avgPx"),y=this.parseOrderStatus(this.safeString(t,"state")),v=this.safeString(t,"fee");let b,w;const S=this.safeString(this.options,"tgtCcy","base_ccy"),k=this.safeString(t,"tgtCcy",S),O=this.safeString(t,"instType");let T;if("buy"===d&&"market"===l&&"SPOT"===O&&"quote_ccy"===k?w=this.safeString(t,"sz"):b=this.safeString(t,"sz"),void 0!==v){const e=a.Y.stringNeg(v),i=this.safeString(t,"feeCcy"),s=this.safeCurrencyCode(i);T={cost:this.parseNumber(e),currency:s}}let P=this.safeString(t,"clOrdId");void 0!==P&&P.length<1&&(P=void 0);const _=this.safeNumber2(t,"slTriggerPx","slOrdPx"),A=this.safeNumber2(t,"tpTriggerPx","tpOrdPx"),I=this.safeString(t,"reduceOnly");let x=!1;return void 0!==x&&(x="true"===I),this.safeOrder({info:t,id:s,clientOrderId:P,timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:o,lastUpdateTimestamp:n,symbol:p,type:l,timeInForce:h,postOnly:c,side:d,price:m,stopLossPrice:_,takeProfitPrice:A,triggerPrice:this.safeNumberN(t,["triggerPx","moveTriggerPx"]),average:g,cost:w,amount:b,filled:f,remaining:void 0,status:y,fee:T,trades:void 0,reduceOnly:x},e)}async fetchOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={instId:s.id},n=this.safeString2(i,"clOrdId","clientOrderId"),o=this.safeValue(this.options,"fetchOrder",{}),d=this.safeString(o,"method","privateGetTradeOrder");let c=this.safeString(i,"method",d);this.safeValue2(i,"stop","trigger")?(c="privateGetTradeOrderAlgo",void 0!==n?a.algoClOrdId=n:a.algoId=t):void 0!==n?a.clOrdId=n:a.ordId=t;const h=this.omit(i,["method","clOrdId","clientOrderId","stop","trigger"]);let l;l="privateGetTradeOrderAlgo"===c?await this.privateGetTradeOrderAlgo(this.extend(a,h)):await this.privateGetTradeOrder(this.extend(a,h));const u=this.safeValue(l,"data",[]),p=this.safeDict(u,0);return this.parseOrder(p,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchOpenOrders","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchOpenOrders",t,e,i,s);const a={};let n;void 0!==t&&(n=this.market(t),a.instId=n.id),void 0!==i&&(a.limit=i);const o=this.safeValue(this.options,"fetchOpenOrders",{}),d=this.safeValue(this.options,"algoOrderTypes",{}),c=this.safeString(o,"method","privateGetTradeOrdersPending");let h=this.safeString(s,"method",c);const l=this.safeString(s,"ordType"),u=this.safeValue2(s,"stop","trigger"),p=this.safeBool(s,"trailing",!1);(p||u||l in d)&&(h="privateGetTradeOrdersAlgoPending"),p?a.ordType="move_order_stop":u&&void 0===l&&(a.ordType="trigger");const f=this.omit(s,["method","stop","trigger","trailing"]);let m;m="privateGetTradeOrdersAlgoPending"===h?await this.privateGetTradeOrdersAlgoPending(this.extend(a,f)):await this.privateGetTradeOrdersPending(this.extend(a,f));const g=this.safeList(m,"data",[]);return this.parseOrders(g,n,e,i)}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const a={};let n,o,d;void 0!==t&&(n=this.market(t),a.instId=n.id),[o,d]=this.handleMarketTypeAndParams("fetchCanceledOrders",n,s),a.instType=this.convertToInstrumentType(o),void 0!==i&&(a.limit=i),a.state="canceled";const c=this.safeValue(this.options,"fetchCanceledOrders",{}),h=this.safeValue(this.options,"algoOrderTypes",{}),l=this.safeString(c,"method","privateGetTradeOrdersHistory");let u=this.safeString(s,"method",l);const p=this.safeString(s,"ordType"),f=this.safeValue2(s,"stop","trigger");if(this.safeBool(s,"trailing",!1))u="privateGetTradeOrdersAlgoHistory",a.ordType="move_order_stop";else if(f||p in h){u="privateGetTradeOrdersAlgoHistory";const t=this.safeString(s,"algoId");if(void 0!==t&&(a.algoId=t,s=this.omit(s,"algoId")),f&&void 0===p)throw new r.ArgumentsRequired(this.id+' fetchCanceledOrders() requires an "ordType" string parameter, "conditional", "oco", "trigger", "move_order_stop", "iceberg", or "twap"')}else{void 0!==e&&(a.begin=e);const t=this.safeInteger(d,"until");void 0!==t&&(a.end=t,d=this.omit(d,["until"]))}const m=this.omit(d,["method","stop","trigger","trailing"]);let g;g="privateGetTradeOrdersAlgoHistory"===u?await this.privateGetTradeOrdersAlgoHistory(this.extend(a,m)):await this.privateGetTradeOrdersHistory(this.extend(a,m));const y=this.safeList(g,"data",[]);return this.parseOrders(y,n,e,i)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchClosedOrders","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchClosedOrders",t,e,i,s);const a={};let n,o,d;void 0!==t&&(n=this.market(t),a.instId=n.id),[o,d]=this.handleMarketTypeAndParams("fetchClosedOrders",n,s),a.instType=this.convertToInstrumentType(o),void 0!==i&&(a.limit=i);const c=this.safeDict(this.options,"fetchClosedOrders",{}),h=this.safeDict(this.options,"algoOrderTypes",{}),l=this.safeString(c,"method","privateGetTradeOrdersHistory");let u=this.safeString(s,"method",l);const p=this.safeString(s,"ordType"),f=this.safeBool2(s,"stop","trigger"),m=this.safeBool(s,"trailing",!1);if((m||f||p in h)&&(u="privateGetTradeOrdersAlgoHistory",a.state="effective"),m)a.ordType="move_order_stop";else if(f)void 0===p&&(a.ordType="trigger");else{void 0!==e&&(a.begin=e);const t=this.safeInteger(d,"until");void 0!==t&&(a.end=t,d=this.omit(d,["until"])),a.state="filled"}const g=this.omit(d,["method","stop","trigger","trailing"]);let y;y="privateGetTradeOrdersAlgoHistory"===u?await this.privateGetTradeOrdersAlgoHistory(this.extend(a,g)):"privateGetTradeOrdersHistoryArchive"===u?await this.privateGetTradeOrdersHistoryArchive(this.extend(a,g)):await this.privateGetTradeOrdersHistory(this.extend(a,g));const v=this.safeList(y,"data",[]);return this.parseOrders(v,n,e,i)}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchMyTrades",t,e,i,s);let a,n={};void 0!==t&&(a=this.market(t),n.instId=a.id),void 0!==e&&(n.begin=e),[n,s]=this.handleUntilOption("end",n,s);const[o,d]=this.handleMarketTypeAndParams("fetchMyTrades",a,s);n.instType=this.convertToInstrumentType(o),void 0!==i&&void 0===e&&(n.limit=i);const c=await this.privateGetTradeFillsHistory(this.extend(n,d)),h=this.safeList(c,"data",[]);return this.parseTrades(h,a,e,i,d)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){const a={ordId:t};return await this.fetchMyTrades(e,i,s,this.extend(a,r))}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchLedger",t,e,i,s);const a=this.safeDict(this.options,"fetchLedger",{});let n=this.safeString(a,"method");n=this.safeString(s,"method",n),s=this.omit(s,"method");let o,d={};[o,s]=this.handleMarginModeAndParams("fetchLedger",s),void 0===o&&(o=this.safeString(s,"mgnMode")),"privateGetAssetBills"!==n&&void 0!==o&&(d.mgnMode=o);const[c,h]=this.handleMarketTypeAndParams("fetchLedger",void 0,s);let l,u;void 0!==c&&(d.instType=this.convertToInstrumentType(c)),void 0!==i&&(d.limit=i),void 0!==t&&(l=this.currency(t),d.ccy=l.id),[d,s]=this.handleUntilOption("end",d,s),u="privateGetAccountBillsArchive"===n?await this.privateGetAccountBillsArchive(this.extend(d,h)):"privateGetAssetBills"===n?await this.privateGetAssetBills(this.extend(d,h)):await this.privateGetAccountBills(this.extend(d,h));const p=this.safeList(u,"data",[]);return this.parseLedger(p,l,e,i)}parseLedgerEntryType(t){return this.safeString({1:"transfer",2:"trade",3:"trade",4:"rebate",5:"trade",6:"transfer",7:"trade",8:"fee",9:"trade",10:"trade",11:"trade"},t,t)}parseLedgerEntry(t,e=void 0){const i=this.safeString(t,"ccy"),s=this.safeCurrencyCode(i,e);e=this.safeCurrency(i,e);const r=this.safeInteger(t,"ts"),n=this.safeString(t,"fee");let o;void 0!==n&&(o={cost:this.parseNumber(a.Y.stringNeg(n)),currency:s});const d=this.safeString(t,"instId"),c=this.safeSymbol(d,void 0,"-");return this.safeLedgerEntry({info:t,id:this.safeString(t,"billId"),timestamp:r,datetime:this.iso8601(r),account:void 0,referenceId:this.safeString(t,"ordId"),referenceAccount:void 0,type:this.parseLedgerEntryType(this.safeString(t,"type")),currency:s,symbol:c,amount:this.safeNumber(t,"balChg"),before:void 0,after:this.safeNumber(t,"bal"),status:"ok",fee:o},e)}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"addr");let s=this.safeStringN(t,["tag","pmtId","memo"]);if(void 0===s){const e=this.safeValue(t,"addrEx",{});s=this.safeString(e,"comment")}const r=this.safeString(t,"ccy"),a=(e=this.safeCurrency(r,e)).code,n=this.safeString(t,"chain"),o=this.safeValue(e,"networks",{}),d=this.indexBy(o,"id");let c=this.safeValue(d,n);"USDT-Polygon"===n&&(c=this.safeValue2(d,"USDT-Polygon-Bridge","USDT-Polygon"));const h=this.safeString(c,"network"),l=this.networkIdToCode(h,a);return this.checkAddress(i),{info:t,currency:a,network:l,address:i,tag:s}}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();const i=this.currency(t),s={ccy:i.id},r=await this.privateGetAssetDepositAddress(this.extend(s,e)),a=this.safeList(r,"data",[]),n=this.filterBy(a,"selected",!0),o=this.parseDepositAddresses(n,[i.code],!1);return this.indexBy(o,"network")}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.safeString(e,"network");e=this.omit(e,"network"),t=this.safeCurrencyCode(t);const s=this.networkIdToCode(i,t),a=await this.fetchDepositAddressesByNetwork(t,e);if(void 0!==s){const e=this.safeDict(a,s);if(void 0===e)throw new r.InvalidAddress(this.id+" fetchDepositAddress() cannot find "+s+" deposit address for "+t);return e}const n=this.networkIdToCode(t,t);if(n in a)return a[n];const o=Object.keys(a),d=this.safeString(o,0);return this.safeDict(a,d)}async withdraw(t,e,i,s=void 0,a={}){[s,a]=this.handleWithdrawTagAndParams(s,a),this.checkAddress(i),await this.loadMarkets();const n=this.currency(t);void 0!==s&&s.length>0&&(i=i+":"+s);const o={ccy:n.id,toAddr:i,dest:"4",amt:this.numberToString(e)};let d=this.safeString(a,"network");if(void 0!==d){const t=this.safeDict(this.options,"networks",{});d=this.safeString(t,d.toUpperCase(),d),o.chain=n.id+"-"+d,a=this.omit(a,"network")}let c=this.safeString(a,"fee");if(void 0===c){const t=await this.fetchCurrencies();this.currencies=this.mapToSafeMap(this.deepExtend(this.currencies,t));const e=this.safeDict(n.networks,this.networkIdToCode(d),{});if(c=this.safeString(e,"fee"),void 0===c)throw new r.ArgumentsRequired(this.id+' withdraw() requires a "fee" string parameter, network transaction fee must be  0. Withdrawals to OKCoin or OKX are fee-free, please set "0". Withdrawing to external digital asset address requires network transaction fee.')}o.fee=this.numberToString(c);const h=this.omit(a,["fee"]),l=await this.privatePostAssetWithdrawal(this.extend(o,h)),u=this.safeList(l,"data",[]),p=this.safeDict(u,0);return this.parseTransaction(p,n)}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchDeposits",t,e,i,s);let a,n={};void 0!==t&&(a=this.currency(t),n.ccy=a.id),void 0!==e&&(n.before=Math.max(e-1,0)),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("after",n,s);const o=await this.privateGetAssetDepositHistory(this.extend(n,s)),d=this.safeList(o,"data",[]);return this.parseTransactions(d,a,e,i,s)}async fetchDeposit(t,e=void 0,i={}){await this.loadMarkets();const s={depId:t};let r;void 0!==e&&(r=this.currency(e),s.ccy=r.id);const a=await this.privateGetAssetDepositHistory(this.extend(s,i)),n=this.safeValue(a,"data"),o=this.safeDict(n,0,{});return this.parseTransaction(o,r)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchWithdrawals",t,e,i,s);let a,n={};void 0!==t&&(a=this.currency(t),n.ccy=a.id),void 0!==e&&(n.before=Math.max(e-1,0)),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("after",n,s);const o=await this.privateGetAssetWithdrawalHistory(this.extend(n,s)),d=this.safeList(o,"data",[]);return this.parseTransactions(d,a,e,i,s)}async fetchWithdrawal(t,e=void 0,i={}){await this.loadMarkets();const s={wdId:t};let r;void 0!==e&&(r=this.currency(e),s.ccy=r.id);const a=await this.privateGetAssetWithdrawalHistory(this.extend(s,i)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{});return this.parseTransaction(o)}parseTransactionStatus(t){return this.safeString({"-3":"pending","-2":"canceled","-1":"failed",0:"pending",1:"pending",2:"ok",3:"pending",4:"pending",5:"pending",6:"pending",7:"pending",8:"pending",9:"pending",10:"pending",12:"pending",15:"pending",16:"pending"},t,t)}parseTransaction(t,e=void 0){let i,s;const r=this.safeString(t,"wdId"),a=this.safeString(t,"from"),n=this.safeString(t,"to"),o=n;let d=this.safeString2(t,"tag","memo");d=this.safeString2(t,"pmtId",d),void 0!==r?(i="withdrawal",s=r):(s=this.safeString(t,"depId"),i="deposit");const c=this.safeString(t,"ccy"),h=this.safeCurrencyCode(c),l=this.safeNumber(t,"amt"),u=this.parseTransactionStatus(this.safeString(t,"state")),p=this.safeString(t,"txId"),f=this.safeInteger(t,"ts");let m;return m="deposit"===i?0:this.safeNumber(t,"fee"),{info:t,id:s,currency:h,amount:l,network:void 0,addressFrom:a,addressTo:n,address:o,tagFrom:void 0,tagTo:d,tag:d,status:u,type:i,updated:void 0,txid:p,timestamp:f,datetime:this.iso8601(f),internal:void 0,comment:void 0,fee:{currency:h,cost:m}}}async fetchLeverage(t,e={}){let i;if(await this.loadMarkets(),[i,e]=this.handleMarginModeAndParams("fetchLeverage",e),void 0===i&&(i=this.safeString(e,"mgnMode","cross")),"cross"!==i&&"isolated"!==i)throw new r.BadRequest(this.id+" fetchLeverage() requires a marginMode parameter that must be either cross or isolated");const s=this.market(t),a={instId:s.id,mgnMode:i},n=await this.privateGetAccountLeverageInfo(this.extend(a,e)),o=this.safeList(n,"data",[]);return this.parseLeverage(o,s)}parseLeverage(t,e=void 0){let i,s,r,a;for(let e=0;e<t.length;e++){const n=t[e];s=this.safeStringLower(n,"mgnMode"),i=this.safeString(n,"instId");const o=this.safeStringLower(n,"posSide");"long"===o?r=this.safeInteger(n,"lever"):("short"===o||(r=this.safeInteger(n,"lever")),a=this.safeInteger(n,"lever"))}return{info:t,symbol:this.safeSymbol(i,e),marginMode:s,longLeverage:r,shortLeverage:a}}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t),[s,r]=this.handleMarketTypeAndParams("fetchPosition",i,e),a={instId:i.id};void 0!==s&&(a.instType=this.convertToInstrumentType(s));const n=await this.privateGetAccountPositions(this.extend(a,r)),o=this.safeList(n,"data",[]),d=this.safeDict(o,0);if(void 0!==d)return this.parsePosition(d,i)}async fetchPositions(t=void 0,e={}){await this.loadMarkets();const i={};if(void 0!==t){const e=[];for(let i=0;i<t.length;i++){const s=t[i],r=this.market(s);e.push(r.id)}e.length>0&&(i.instId=e.join(","))}const s=this.safeDict(this.options,"fetchPositions",{});let r;r="privateGetAccountPositionsHistory"===this.safeString(s,"method","privateGetAccountPositions")?await this.privateGetAccountPositionsHistory(this.extend(i,e)):await this.privateGetAccountPositions(this.extend(i,e));const a=this.safeList(r,"data",[]),n=[];for(let t=0;t<a.length;t++)n.push(this.parsePosition(a[t]));return this.filterByArrayPositions(n,"symbol",this.marketSymbols(t),!1)}async fetchPositionsForSymbol(t,e={}){return await this.fetchPositions([t],e)}parsePosition(t,e=void 0){const i=this.safeString(t,"instId"),s=(e=this.safeMarket(i,e,void 0,"contract")).symbol,r=this.safeString(t,"pos"),n=a.Y.stringAbs(r);let o=this.safeString2(t,"posSide","direction");const d="net"!==o,c=this.parseNumber(n);if(e.margin){if("net"===o){const i=this.safeString(t,"posCcy"),s=this.safeCurrencyCode(i);void 0!==s&&(o=e.base===s?"long":"short")}void 0===o&&(o=this.safeString(t,"direction"))}else void 0!==r&&"net"===o&&(o=a.Y.stringGt(r,"0")?"long":a.Y.stringLt(r,"0")?"short":void 0);const h=this.safeNumber(e,"contractSize"),l=this.numberToString(h),u=this.safeString(t,"markPx");let p=this.safeString(t,"notionalUsd");e.inverse&&(p=a.Y.stringDiv(a.Y.stringMul(n,l),u));const f=this.parseNumber(p),m=this.safeString(t,"mgnMode");let g;const y=this.safeString2(t,"avgPx","openAvgPx"),v=this.safeString(t,"upl"),b=this.safeString(t,"lever");let w,S;"cross"===m?(g=this.safeString(t,"imr"),S=a.Y.stringAdd(g,v)):"isolated"===m&&(w=a.Y.stringDiv("1",b),S=this.safeString(t,"margin"));const k=this.safeString(t,"mmr"),O=this.parseNumber(k),T=a.Y.stringDiv(k,p);void 0===w?w=this.parseNumber(a.Y.stringDiv(g,p,4)):void 0===g&&(g=a.Y.stringMul(w,p));const P=this.parseNumber(a.Y.stringDiv(a.Y.stringAdd(T,"0.00005"),"1",4)),_=this.safeNumber(t,"liqPx"),A=this.safeString(t,"uplRatio"),I=this.parseNumber(a.Y.stringMul(A,"100")),x=this.safeInteger(t,"cTime"),E=this.parseNumber(a.Y.stringDiv(k,S,4));return this.safePosition({info:t,id:this.safeString(t,"posId"),symbol:s,notional:f,marginMode:m,liquidationPrice:_,entryPrice:this.parseNumber(y),unrealizedPnl:this.parseNumber(v),realizedPnl:this.safeNumber(t,"realizedPnl"),percentage:I,contracts:c,contractSize:h,markPrice:this.parseNumber(u),lastPrice:this.safeNumber(t,"closeAvgPx"),side:o,hedged:d,timestamp:x,datetime:this.iso8601(x),lastUpdateTimestamp:this.safeInteger(t,"uTime"),maintenanceMargin:O,maintenanceMarginPercentage:P,collateral:this.parseNumber(S),initialMargin:this.parseNumber(g),initialMarginPercentage:this.parseNumber(w),leverage:this.parseNumber(b),marginRatio:E,stopLossPrice:void 0,takeProfitPrice:void 0})}async transfer(t,e,i,s,r={}){await this.loadMarkets();const a=this.currency(t),n=this.safeDict(this.options,"accountsByType",{}),o=this.safeString(n,i,i),d=this.safeString(n,s,s),c={ccy:a.id,amt:this.currencyToPrecision(t,e),type:"0",from:o,to:d};"master"===o?(c.type="1",c.subAcct=d,c.from=this.safeString(r,"from","6"),c.to=this.safeString(r,"to","6")):"master"===d&&(c.type="2",c.subAcct=o,c.from=this.safeString(r,"from","6"),c.to=this.safeString(r,"to","6"));const h=await this.privatePostAssetTransfer(this.extend(c,r)),l=this.safeList(h,"data",[]),u=this.safeDict(l,0,{});return this.parseTransfer(u,a)}parseTransfer(t,e=void 0){const i=this.safeString2(t,"transId","billId"),s=this.safeString(t,"ccy"),r=this.safeCurrencyCode(s,e);let n=this.safeNumber(t,"amt");const o=this.safeString(t,"from"),d=this.safeString(t,"to"),c=this.safeDict(this.options,"accountsById",{}),h=this.safeInteger(t,"ts"),l=this.safeString(t,"sz");return void 0!==l&&(n=this.parseNumber(a.Y.stringAbs(l))),{info:t,id:i,timestamp:h,datetime:this.iso8601(h),currency:r,amount:n,fromAccount:this.safeString(c,o),toAccount:this.safeString(c,d),status:this.parseTransferStatus(this.safeString(t,"state"))}}parseTransferStatus(t){return this.safeString({success:"ok"},t,t)}async fetchTransfer(t,e=void 0,i={}){await this.loadMarkets();const s={transId:t},r=await this.privateGetAssetTransferState(this.extend(s,i)),a=this.safeList(r,"data",[]),n=this.safeDict(a,0);return this.parseTransfer(n)}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();const a={type:"1"};void 0!==t&&(r=this.currency(t),a.ccy=r.id),void 0!==e&&(a.begin=e),void 0!==i&&(a.limit=i);const n=await this.privateGetAccountBillsArchive(this.extend(a,s)),o=this.safeList(n,"data",[]);return this.parseTransfers(o,r,e,i,s)}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){const n=Array.isArray(s),d="/api/"+this.version+"/"+this.implodeParams(t,s),c=this.omit(s,this.extractParams(t));let h=this.implodeHostname(this.urls.api.rest)+d;if("public"===e)Object.keys(c).length&&(h+="?"+this.urlencode(c));else if("private"===e){if(this.checkRequiredCredentials(),"POST"===i&&("trade/batch-orders"===t||"trade/order-algo"===t||"trade/order"===t)){const t=this.safeString(this.options,"brokerId","6b9ad766b55dBCDE");if(Array.isArray(s))for(let e=0;e<s.length;e++){const i=s[e];void 0===this.safeString(i,"clOrdId")&&(i.clOrdId=t+this.uuid16(),i.tag=t,s[e]=i)}else{void 0===this.safeString(s,"clOrdId")&&(s.clOrdId=t+this.uuid16(),s.tag=t)}}const e=this.iso8601(this.nonce());r={"OK-ACCESS-KEY":this.apiKey,"OK-ACCESS-PASSPHRASE":this.password,"OK-ACCESS-TIMESTAMP":e};let l=e+i+d;if("GET"===i){if(Object.keys(c).length){const t="?"+this.urlencode(c);h+=t,l+=t}}else(n||Object.keys(c).length)&&(l+=a=this.json(c)),r["Content-Type"]="application/json";const u=this.hmac(this.encode(l),this.encode(this.secret),o.s,"base64");r["OK-ACCESS-SIGN"]=u}return{url:h,method:i,body:a,headers:r}}parseFundingRate(t,e=void 0){const i=this.safeInteger(t,"nextFundingTime"),s=this.safeString(t,"instId"),r=this.safeSymbol(s,e),n=this.safeNumber(t,"nextFundingRate"),o=this.safeInteger(t,"fundingTime"),d=this.safeString(t,"fundingTime"),c=this.safeString(t,"nextFundingTime"),h=a.Y.stringSub(c,d);return{info:t,symbol:r,markPrice:void 0,indexPrice:void 0,interestRate:this.parseNumber("0"),estimatedSettlePrice:void 0,timestamp:void 0,datetime:void 0,fundingRate:this.safeNumber(t,"fundingRate"),fundingTimestamp:o,fundingDatetime:this.iso8601(o),nextFundingRate:n,nextFundingTimestamp:i,nextFundingDatetime:this.iso8601(i),previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:this.parseFundingInterval(h)}}parseFundingInterval(t){return this.safeString({36e5:"1h",144e5:"4h",288e5:"8h",576e5:"16h",864e5:"24h"},t,t)}async fetchFundingInterval(t,e={}){return await this.fetchFundingRate(t,e)}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.swap)throw new r.ExchangeError(this.id+" fetchFundingRate() is only valid for swap markets");const s={instId:i.id},a=await this.publicGetPublicFundingRate(this.extend(s,e)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{});return this.parseFundingRate(o,i)}async fetchFundingRates(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,"swap",!0);const i=await this.publicGetPublicFundingRate(this.extend({instId:"ANY"},e)),s=this.safeList(i,"data",[]);return this.parseFundingRates(s,t)}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={type:"8"};let a;void 0!==i&&(r.limit=i.toString()),void 0!==t&&(a=this.market(t),t=a.symbol,a.contract&&(a.linear?(r.ctType="linear",r.ccy=a.quoteId):(r.ctType="inverse",r.ccy=a.baseId)));const[n,o]=this.handleMarketTypeAndParams("fetchFundingHistory",a,s);"swap"===n&&(r.instType=this.convertToInstrumentType(n));const d=await this.privateGetAccountBillsArchive(this.extend(r,o)),c=this.safeList(d,"data",[]),h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeInteger(e,"ts"),s=this.safeString(e,"instId"),r=this.safeMarket(s),a=this.safeString(e,"ccy"),n=this.safeCurrencyCode(a);h.push({info:e,symbol:r.symbol,code:n,timestamp:i,datetime:this.iso8601(i),id:this.safeString(e,"billId"),amount:this.safeNumber(e,"balChg")})}const l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,t,e,i)}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");if(t<1||t>125)throw new r.BadRequest(this.id+" setLeverage() leverage should be between 1 and 125");await this.loadMarkets();const s=this.market(e);let a;if([a,i]=this.handleMarginModeAndParams("setLeverage",i),void 0===a&&(a=this.safeString(i,"mgnMode","cross")),"cross"!==a&&"isolated"!==a)throw new r.BadRequest(this.id+" setLeverage() requires a marginMode parameter that must be either cross or isolated");const n={lever:t,mgnMode:a,instId:s.id},o=this.safeString(i,"posSide","net");if("isolated"===a){if("long"!==o&&"short"!==o&&"net"!==o)throw new r.BadRequest(this.id+' setLeverage() requires the posSide argument to be either "long", "short" or "net"');n.posSide=o}return await this.privatePostAccountSetLeverage(this.extend(n,i))}async fetchPositionMode(t=void 0,e={}){const i=await this.fetchAccounts();let s;if(i.length>1){const t=this.safeString(e,"accountId");if(void 0===t){const t=this.getListFromObjectValues(i,"id");throw new r.ExchangeError(this.id+' fetchPositionMode() can not detect position mode, because you have multiple accounts. Set params["accountId"] to desired id from: '+t.join(", "))}{const e=this.indexBy(i,"id");s=this.safeDict(e,t)}}else s=i[0];const a=s.info;return{info:a,hedged:"long_short_mode"===this.safeString(a,"posMode")}}async setPositionMode(t,e=void 0,i={}){let s;s=t?"long_short_mode":"net_mode";const r={posMode:s};return await this.privatePostAccountSetPositionMode(this.extend(r,i))}async setMarginMode(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a symbol argument");if("cross"!==(t=t.toLowerCase())&&"isolated"!==t)throw new r.BadRequest(this.id+" setMarginMode() marginMode must be either cross or isolated");await this.loadMarkets();const s=this.market(e),a=this.safeInteger2(i,"lever","leverage");if(void 0===a||a<1||a>125)throw new r.BadRequest(this.id+' setMarginMode() params["lever"] should be between 1 and 125');i=this.omit(i,["leverage"]);const n={lever:a,mgnMode:t,instId:s.id};return await this.privatePostAccountSetLeverage(this.extend(n,i))}async fetchCrossBorrowRates(t={}){await this.loadMarkets();const e=await this.privateGetAccountInterestRate(t),i=this.safeList(e,"data",[]),s=[];for(let t=0;t<i.length;t++)s.push(this.parseBorrowRate(i[t]));return s}async fetchCrossBorrowRate(t,e={}){await this.loadMarkets();const i={ccy:this.currency(t).id},s=await this.privateGetAccountInterestRate(this.extend(i,e)),r=this.safeList(s,"data",[]),a=this.safeDict(r,0,{});return this.parseBorrowRate(a)}parseBorrowRate(t,e=void 0){const i=this.safeString(t,"ccy"),s=this.safeInteger(t,"ts");return{currency:this.safeCurrencyCode(i),rate:this.safeNumber2(t,"interestRate","rate"),period:864e5,timestamp:s,datetime:this.iso8601(s),info:t}}parseBorrowRateHistories(t,e,i,s){const r={};for(let i=0;i<t.length;i++){const s=t[i],a=this.safeCurrencyCode(this.safeString(s,"ccy"));if(void 0===e||this.inArray(a,e)){a in r||(r[a]=[]);const t=this.parseBorrowRate(s);r[a].push(t)}}const a=Object.keys(r);for(let t=0;t<a.length;t++){const e=a[t];r[e]=this.filterByCurrencySinceLimit(r[e],e,i,s)}return r}async fetchBorrowRateHistories(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};void 0!==e&&(r.before=e),void 0!==i&&(r.limit=i);const a=await this.publicGetFinanceSavingsLendingRateHistory(this.extend(r,s)),n=this.safeList(a,"data",[]);return this.parseBorrowRateHistories(n,t,e,i)}async fetchBorrowRateHistory(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={ccy:this.currency(t).id};void 0!==e&&(r.before=e),void 0!==i&&(r.limit=i);const a=await this.publicGetFinanceSavingsLendingRateHistory(this.extend(r,s)),n=this.safeList(a,"data",[]);return this.parseBorrowRateHistory(n,t,e,i)}async modifyMarginHelper(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a=this.safeString(s,"posSide","net");s=this.omit(s,["posSide"]);const n={instId:r.id,amt:e,type:i,posSide:a},o=await this.privatePostAccountPositionMarginBalance(this.extend(n,s)),d=this.safeList(o,"data",[]),c=this.safeDict(d,0,{}),h=this.safeString(o,"code");return this.extend(this.parseMarginModification(c,r),{status:"0"===h?"ok":"failed"})}parseMarginModification(t,e=void 0){const i=this.safeString2(t,"amt","posBalChg"),s=this.safeString(t,"type");let r;r="6"===s?a.Y.stringGt(i,"0")?"add":"reduce":s;const n=a.Y.stringAbs(i),o=this.safeString(t,"instId"),d=this.safeMarket(o,e),c=d.inverse?d.base:d.quote,h=this.safeInteger(t,"ts");return{info:t,symbol:d.symbol,type:r,marginMode:"isolated",amount:this.parseNumber(n),code:c,total:void 0,status:void 0,timestamp:h,datetime:this.iso8601(h)}}async reduceMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"reduce",i)}async addMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"add",i)}async fetchMarketLeverageTiers(t,e={}){await this.loadMarkets();const i=this.market(t),s=i.spot?"MARGIN":this.convertToInstrumentType(i.type),a=this.safeString(i.info,"uly");if(!a&&"MARGIN"!==s)throw new r.BadRequest(this.id+" fetchMarketLeverageTiers() cannot fetch leverage tiers for "+t);let n;[n,e]=this.handleMarginModeAndParams("fetchMarketLeverageTiers",e),void 0===n&&(n=this.safeString(e,"tdMode","cross"));const o={instType:s,tdMode:n,uly:a};"MARGIN"===s&&(o.instId=i.id);const d=await this.publicGetPublicPositionTiers(this.extend(o,e)),c=this.safeList(d,"data",[]);return this.parseMarketLeverageTiers(c,i)}parseMarketLeverageTiers(t,e=void 0){const i=[];for(let s=0;s<t.length;s++){const r=t[s],a=this.safeString(r,"instId");i.push({tier:this.safeInteger(r,"tier"),symbol:this.safeSymbol(a,e),currency:e.quote,minNotional:this.safeNumber(r,"minSz"),maxNotional:this.safeNumber(r,"maxSz"),maintenanceMarginRate:this.safeNumber(r,"mmr"),maxLeverage:this.safeNumber(r,"maxLever"),info:r})}return i}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),[a,r]=this.handleMarginModeAndParams("fetchBorrowInterest",r),void 0===a&&(a=this.safeString(r,"mgnMode","cross"));const n={mgnMode:a};let o;if(void 0!==t){const e=this.currency(t);n.ccy=e.id}void 0!==i&&(n.before=i-1),void 0!==s&&(n.limit=s),void 0!==e&&(o=this.market(e),n.instId=o.id);const d=await this.privateGetAccountInterestAccrued(this.extend(n,r)),c=this.safeList(d,"data",[]),h=this.parseBorrowInterests(c);return this.filterByCurrencySinceLimit(h,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"instId");void 0!==i&&(e=this.safeMarket(i,e));const s=this.safeInteger(t,"ts");return{info:t,symbol:this.safeString(e,"symbol"),currency:this.safeCurrencyCode(this.safeString(t,"ccy")),interest:this.safeNumber(t,"interest"),interestRate:this.safeNumber(t,"interestRate"),amountBorrowed:this.safeNumber(t,"liab"),marginMode:this.safeString(t,"mgnMode"),timestamp:s,datetime:this.iso8601(s)}}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={ccy:s.id,amt:this.currencyToPrecision(t,e),side:"borrow"},a=await this.privatePostAccountBorrowRepay(this.extend(r,i)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{});return this.parseMarginLoan(o,s)}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.safeString2(i,"id","ordId");if(i=this.omit(i,"id"),void 0===s)throw new r.ArgumentsRequired(this.id+" repayCrossMargin() requires an id parameter");const a=this.currency(t),n={ccy:a.id,amt:this.currencyToPrecision(t,e),side:"repay",ordId:s},o=await this.privatePostAccountBorrowRepay(this.extend(n,i)),d=this.safeList(o,"data",[]),c=this.safeDict(d,0,{});return this.parseMarginLoan(c,a)}parseMarginLoan(t,e=void 0){const i=this.safeString(t,"ccy");return{id:void 0,currency:this.safeCurrencyCode(i,e),amount:this.safeNumber(t,"amt"),symbol:void 0,timestamp:void 0,datetime:void 0,info:t}}async fetchOpenInterest(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.contract)throw new r.BadRequest(this.id+" fetchOpenInterest() supports contract markets only");const s={instType:this.convertToInstrumentType(i.type),uly:this.safeString(i.info,"uly"),instId:i.id},a=await this.publicGetPublicOpenInterest(this.extend(s,e)),n=this.safeList(a,"data",[]);return this.parseOpenInterest(n[0],i)}async fetchOpenInterests(t=void 0,e={}){let i,s;await this.loadMarkets(),void 0!==(t=this.marketSymbols(t,void 0,!0,!0))&&(i=this.market(t[0])),[s,e]=this.handleSubTypeAndParams("fetchOpenInterests",i,e,"swap");let a="SWAP";"future"===s?a="FUTURES":"option"===a&&(a="OPTION");const n={instType:a},o=this.safeString(e,"uly");void 0!==o&&(n.uly=o);const d=this.safeString(e,"instFamily");if(void 0!==d&&(n.instFamily=d),"OPTION"===a&&void 0===o&&void 0===d)throw new r.BadRequest(this.id+" fetchOpenInterests() requires either uly or instFamily parameter for OPTION markets");const c=await this.publicGetPublicOpenInterest(this.extend(n,e)),h=this.safeList(c,"data",[]);return this.parseOpenInterests(h,t)}async fetchOpenInterestHistory(t,e="1d",i=void 0,s=void 0,a={}){const n=this.safeDict(this.options,"fetchOpenInterestHistory",{}),o=this.safeDict(n,"timeframes",{});if("5m"!==(e=this.safeString(o,e,e))&&"1H"!==e&&"1D"!==e)throw new r.BadRequest(this.id+" fetchOpenInterestHistory cannot only use the 5m, 1h, and 1d timeframe");let d,c;if(await this.loadMarkets(),t in this.markets||t in this.markets_by_id)c=this.market(t),d=c.baseId;else{d=this.currency(t).id}const h={ccy:d,period:e};let l,u;if([l,a]=this.handleMarketTypeAndParams("fetchOpenInterestHistory",c,a),"option"===l)u=await this.publicGetRubikStatOptionOpenInterestVolume(this.extend(h,a));else{void 0!==i&&(h.begin=i);const t=this.safeInteger(a,"until");void 0!==t&&(h.end=t,a=this.omit(a,["until"])),u=await this.publicGetRubikStatContractsOpenInterestVolume(this.extend(h,a))}const p=this.safeList(u,"data",[]);return this.parseOpenInterestsHistory(p,void 0,i,s)}parseOpenInterest(t,e=void 0){const i=this.safeString(t,"instId");e=this.safeMarket(i,e);const s=this.safeInteger(t,"ts"),r=this.safeInteger(t,0,s);let a,n,o,d;const c=this.safeString(this.options,"defaultType");return Array.isArray(t)?"option"===c?(o=this.safeNumber(t,1),a=this.safeNumber(t,2)):(d=this.safeNumber(t,1),n=this.safeNumber(t,2)):(a=this.safeNumber(t,"oiCcy"),o=this.safeNumber(t,"oi"),d=this.safeNumber(t,"oiUsd")),this.safeOpenInterest({symbol:this.safeSymbol(i),baseVolume:a,quoteVolume:n,openInterestAmount:o,openInterestValue:d,timestamp:r,datetime:this.iso8601(r),info:t},e)}setSandboxMode(t){super.setSandboxMode(t),this.options.sandboxMode=t,t?this.headers["x-simulated-trading"]="1":"x-simulated-trading"in this.headers&&(this.headers=this.omit(this.headers,"x-simulated-trading"))}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i={};if(void 0!==t){const e=this.currencyIds(t);i.ccy=e.join(",")}const s=await this.privateGetAssetCurrencies(this.extend(i,e)),r=this.safeList(s,"data");return this.parseDepositWithdrawFees(r,t)}parseDepositWithdrawFees(t,e=void 0,i=void 0){const s={};e=this.marketCodes(e);for(let i=0;i<t.length;i++){const r=t[i],a=this.safeString(r,"ccy"),n=this.safeCurrencyCode(a);if(void 0===e||this.inArray(n,e)){void 0===this.safeValue(s,n)&&(s[n]=this.depositWithdrawFee({})),s[n].info[a]=r;const t=this.safeString(r,"chain");if(void 0===t)continue;const e=t.split("-"),i=this.safeValue(e,1),o=this.safeNumber(r,"fee"),d={fee:o,percentage:void 0===o&&void 0},c={fee:void 0,percentage:void 0},h=this.networkIdToCode(i,n);s[n].networks[h]={withdraw:d,deposit:c}}}const r=Object.keys(s);for(let t=0;t<r.length;t++){const e=r[t],i=this.currency(e);s[e]=this.assignDefaultDepositWithdrawFees(s[e],i)}return s}async fetchSettlementHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchSettlementHistory() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n;if([n,s]=this.handleMarketTypeAndParams("fetchSettlementHistory",a,s),"future"!==n&&"option"!==n)throw new r.NotSupported(this.id+" fetchSettlementHistory() supports futures and options markets only");const o={instType:this.convertToInstrumentType(n),uly:a.baseId+"-"+a.quoteId};void 0!==e&&(o.before=e-1),void 0!==i&&(o.limit=i);const d=await this.publicGetPublicDeliveryExerciseHistory(this.extend(o,s)),c=this.safeList(d,"data",[]),h=this.parseSettlements(c,a),l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,a.symbol,e,i)}parseSettlement(t,e){const i=this.safeString(t,"insId");return{info:t,symbol:this.safeSymbol(i,e),price:this.safeNumber(t,"px"),timestamp:void 0,datetime:void 0}}parseSettlements(t,e){const i=[];for(let s=0;s<t.length;s++){const r=t[s],a=this.safeInteger(r,"ts"),n=this.safeList(r,"details",[]);for(let t=0;t<n.length;t++){const s=this.parseSettlement(n[t],e);i.push(this.extend(s,{timestamp:a,datetime:this.iso8601(a)}))}}return i}async fetchUnderlyingAssets(t={}){let e;if(await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchUnderlyingAssets",void 0,t),void 0!==e&&"spot"!==e||(e="option"),"option"!==e&&"swap"!==e&&"future"!==e)throw new r.NotSupported(this.id+" fetchUnderlyingAssets() supports contract markets only");const i={instType:this.convertToInstrumentType(e)},s=await this.publicGetPublicUnderlying(this.extend(i,t));return this.safeList(s,"data",[])[0]}async fetchGreeks(t,e={}){await this.loadMarkets();const i=this.market(t),s=i.id,r=s.split("-"),a={uly:i.info.uly,instFamily:i.info.instFamily,expTime:this.safeString(r,2)},n=await this.publicGetPublicOptSummary(this.extend(a,e)),o=this.safeList(n,"data",[]);for(let t=0;t<o.length;t++){const e=o[t];if(this.safeString(e,"instId")===s)return this.parseGreeks(e,i)}}async fetchAllGreeks(t=void 0,e={}){await this.loadMarkets();const i={};let s,a;if(void 0!==(t=this.marketSymbols(t,void 0,!0,!0,!0))&&(s=t.length),void 0===t||1!==s){const t=this.safeString(e,"uly");void 0!==t&&(i.uly=t);const s=this.safeString(e,"instFamily");if(void 0!==s&&(i.instFamily=s),void 0===t&&void 0===s)throw new r.BadRequest(this.id+" fetchAllGreeks() requires either a uly or instFamily parameter")}if(void 0!==t&&1===s){a=this.market(t[0]);const e=a.id.split("-");i.uly=a.info.uly,i.instFamily=a.info.instFamily,i.expTime=this.safeString(e,2)}e=this.omit(e,["uly","instFamily"]);const n=await this.publicGetPublicOptSummary(this.extend(i,e)),o=this.safeList(n,"data",[]);return this.parseAllGreeks(o,t)}parseGreeks(t,e=void 0){const i=this.safeInteger(t,"ts"),s=this.safeString(t,"instId");return{symbol:this.safeSymbol(s,e),timestamp:i,datetime:this.iso8601(i),delta:this.safeNumber(t,"delta"),gamma:this.safeNumber(t,"gamma"),theta:this.safeNumber(t,"theta"),vega:this.safeNumber(t,"vega"),rho:void 0,bidSize:void 0,askSize:void 0,bidImpliedVolatility:this.safeNumber(t,"bidVol"),askImpliedVolatility:this.safeNumber(t,"askVol"),markImpliedVolatility:this.safeNumber(t,"markVol"),bidPrice:void 0,askPrice:void 0,markPrice:void 0,lastPrice:void 0,underlyingPrice:void 0,info:t}}async closePosition(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r=this.safeString(i,"clientOrderId"),a=this.safeString(i,"code");let n;[n,i]=this.handleMarginModeAndParams("closePosition",i,"cross");const o={instId:s.id,mgnMode:n};if(void 0!==e&&(o.posSide="buy"===e?"long":"sell"===e?"short":e),void 0!==r&&(o.clOrdId=r),void 0!==a){const t=this.currency(a);o.ccy=t.id}const d=await this.privatePostTradeClosePosition(this.extend(o,i)),c=this.safeList(d,"data",[]),h=this.safeDict(c,0);return this.parseOrder(h,s)}async fetchOption(t,e={}){await this.loadMarkets();const i=this.market(t),s={instId:i.id},r=await this.publicGetMarketTicker(this.extend(s,e)),a=this.safeList(r,"data",[]),n=this.safeDict(a,0,{});return this.parseOption(n,void 0,i)}async fetchOptionChain(t,e={}){await this.loadMarkets();const i={uly:this.currency(t).code+"-USD",instType:"OPTION"},s=await this.publicGetMarketTickers(this.extend(i,e)),r=this.safeList(s,"data",[]);return this.parseOptionChain(r,void 0,"instId")}parseOption(t,e=void 0,i=void 0){const s=this.safeString(t,"instId");i=this.safeMarket(s,i);const r=this.safeInteger(t,"ts");return{info:t,currency:void 0,symbol:i.symbol,timestamp:r,datetime:this.iso8601(r),impliedVolatility:void 0,openInterest:void 0,bidPrice:this.safeNumber(t,"bidPx"),askPrice:this.safeNumber(t,"askPx"),midPrice:void 0,markPrice:void 0,lastPrice:this.safeNumber(t,"last"),underlyingPrice:void 0,change:void 0,percentage:void 0,baseVolume:this.safeNumber(t,"volCcy24h"),quoteVolume:void 0}}async fetchConvertQuote(t,e,i=void 0,s={}){await this.loadMarkets();const r={baseCcy:t.toUpperCase(),quoteCcy:e.toUpperCase(),rfqSzCcy:t.toUpperCase(),rfqSz:this.numberToString(i),side:"sell"},a=await this.privatePostAssetConvertEstimateQuote(this.extend(r,s)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{}),d=this.safeString(o,"baseCcy",t),c=this.currency(d),h=this.safeString(o,"quoteCcy",e),l=this.currency(h);return this.parseConversion(o,c,l)}async createConvertTrade(t,e,i,s=void 0,r={}){await this.loadMarkets();const a={quoteId:t,baseCcy:e,quoteCcy:i,szCcy:e,sz:this.numberToString(s),side:"sell"},n=await this.privatePostAssetConvertTrade(this.extend(a,r)),o=this.safeList(n,"data",[]),d=this.safeDict(o,0,{}),c=this.safeString(d,"baseCcy",e),h=this.currency(c),l=this.safeString(d,"quoteCcy",i),u=this.currency(l);return this.parseConversion(d,h,u)}async fetchConvertTrade(t,e=void 0,i={}){await this.loadMarkets();const s={clTReqId:t},r=await this.privateGetAssetConvertHistory(this.extend(s,i)),a=this.safeList(r,"data",[]),n=this.safeDict(a,0,{}),o=this.safeString(n,"baseCcy"),d=this.safeString(n,"quoteCcy");let c,h;return void 0!==o&&(c=this.currency(o)),void 0!==d&&(h=this.currency(d)),this.parseConversion(n,c,h)}async fetchConvertTradeHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r={};[r,s]=this.handleUntilOption("after",r,s),void 0!==e&&(r.before=e),void 0!==i&&(r.limit=i);const a=await this.privateGetAssetConvertHistory(this.extend(r,s)),n=this.safeList(a,"data",[]);return this.parseConversions(n,t,"baseCcy","quoteCcy",e,i)}parseConversion(t,e=void 0,i=void 0){const s=this.safeInteger2(t,"quoteTime","ts"),r=this.safeString(t,"baseCcy"),a=this.safeCurrencyCode(r,e),n=this.safeString(t,"quoteCcy"),o=this.safeCurrencyCode(n,i);return{info:t,timestamp:s,datetime:this.iso8601(s),id:this.safeStringN(t,["clQReqId","tradeId","quoteId"]),fromCurrency:a,fromAmount:this.safeNumber2(t,"baseSz","fillBaseSz"),toCurrency:o,toAmount:this.safeNumber2(t,"quoteSz","fillQuoteSz"),price:this.safeNumber2(t,"cnvtPx","fillPx"),fee:void 0}}async fetchConvertCurrencies(t={}){await this.loadMarkets();const e=await this.privateGetAssetConvertCurrencies(t),i={},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeString(e,"ccy"),a=this.safeCurrencyCode(r);i[a]={info:e,id:r,code:a,networks:void 0,type:void 0,name:void 0,active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,precision:void 0,limits:{amount:{min:this.safeNumber(e,"min"),max:this.safeNumber(e,"max")},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},created:void 0}}return i}handleErrors(t,e,i,s,a,n,o,d,c){if(!o)return;const h=this.safeString(o,"code");if("0"!==h&&"2"!==h){const t=this.id+" "+n,e=this.safeList(o,"data",[]);for(let i=0;i<e.length;i++){const s=e[i],r=this.safeString(s,"sCode"),a=this.safeString(s,"sMsg");this.throwExactlyMatchedException(this.exceptions.exact,r,t),this.throwBroadlyMatchedException(this.exceptions.broad,a,t)}throw this.throwExactlyMatchedException(this.exceptions.exact,h,t),new r.ExchangeError(t)}}async fetchMarginAdjustmentHistory(t=void 0,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();const n=this.safeBool(a,"auto");if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchMarginAdjustmentHistory () requires a type argument");const o="add"===e;let d=o?"160":"161";if(n){if(!o)throw new r.BadRequest(this.id+" cannot fetch margin adjustments for type "+e);d="162"}const c={subType:d,mgnMode:"isolated"},h=this.safeInteger(a,"until");let l;a=this.omit(a,"until"),void 0!==i&&(c.startTime=i),void 0!==s&&(c.limit=s),void 0!==h&&(c.endTime=h);const u=this.milliseconds(),p=u-7776e6;if(void 0===i||i>u-6048e5)l=await this.privateGetAccountBills(this.extend(c,a));else{if(!(i>p))throw new r.BadRequest(this.id+" fetchMarginAdjustmentHistory () cannot fetch margin adjustments older than 3 months");l=await this.privateGetAccountBillsArchive(this.extend(c,a))}const f=this.safeList(l,"data"),m=this.parseMarginModifications(f);return this.filterBySymbolSinceLimit(m,t,i,s)}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.safeString(s,"marginMode"),a=this.safeStringUpper(s,"instType");s=this.omit(s,["until","marginMode","instType"]),void 0===i&&(i=100);const n={limit:i};if(void 0!==t){if(1===t.length){const e=this.market(t[0]);n.instId=e.id}}void 0!==r&&(n.mgnMode=r),void 0!==a&&(n.instType=a);const o=await this.privateGetAccountPositionsHistory(this.extend(n,s)),d=this.safeList(o,"data"),c=this.parsePositions(d,t,s);return this.filterBySinceLimit(c,e,i)}async fetchLongShortRatioHistory(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t),n={instId:a.id},o=this.safeString2(r,"until","end");r=this.omit(r,"until"),void 0!==o&&(n.end=o),void 0!==e&&(n.period=e),void 0!==i&&(n.begin=i),void 0!==s&&(n.limit=s);const d=await this.publicGetRubikStatContractsLongShortAccountRatioContract(this.extend(n,r)),c=this.safeList(d,"data",[]),h=[];for(let t=0;t<c.length;t++){const e=c[t];h.push({timestamp:this.safeString(e,0),longShortRatio:this.safeString(e,1)})}return this.parseLongShortRatioHistory(h,a)}parseLongShortRatio(t,e=void 0){const i=this.safeInteger(t,"timestamp");let s;return void 0!==e&&(s=e.symbol),{info:t,symbol:s,timestamp:i,datetime:this.iso8601(i),timeframe:void 0,longShortRatio:this.safeNumber(t,"longShortRatio")}}}},3726(t,e,i){"use strict";i.d(e,{X:()=>s}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const s={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.shortTermOrderEquityTiers)a.encode(i,e.uint32(10).fork()).ldelim();for(const i of t.statefulOrderEquityTiers)a.encode(i,e.uint32(18).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={shortTermOrderEquityTiers:[],statefulOrderEquityTiers:[]};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.shortTermOrderEquityTiers.push(a.decode(i,i.uint32()));break;case 2:r.statefulOrderEquityTiers.push(a.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={shortTermOrderEquityTiers:[],statefulOrderEquityTiers:[]};return e.shortTermOrderEquityTiers=t.shortTermOrderEquityTiers?.map(t=>a.fromPartial(t))||[],e.statefulOrderEquityTiers=t.statefulOrderEquityTiers?.map(t=>a.fromPartial(t))||[],e}};function r(){return{usdTncRequired:new Uint8Array,limit:0}}const a={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.usdTncRequired.length&&e.uint32(10).bytes(t.usdTncRequired),0!==t.limit&&e.uint32(16).uint32(t.limit),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a=r();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.usdTncRequired=i.bytes();break;case 2:a.limit=i.uint32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=r();return e.usdTncRequired=t.usdTncRequired??new Uint8Array,e.limit=t.limit??0,e}}},3828(t,e,i){"use strict";i.d(e,{Mi:()=>n,if:()=>o,nS:()=>d});var s=i(8403),r=i(7437),a=i(975);class n{constructor(t={},e=void 0){this.cache=[],Object.defineProperty(this,"cache",{__proto__:null,value:[],writable:!0,enumerable:!1}),e=e||Number.MAX_SAFE_INTEGER;const i={bids:[],asks:[],timestamp:void 0,datetime:void 0,nonce:void 0,symbol:void 0},n=Object.entries((0,r.X$)(i,t));for(let t=0;t<n.length;t++){const[e,i]=n[t];this[e]=i}"Array"===this.asks.constructor.name&&(this.asks=new a.$w(this.asks,e)),"Array"===this.bids.constructor.name&&(this.bids=new a.PB(this.bids,e)),this.timestamp&&(this.datetime=(0,s.LC)(this.timestamp))}limit(){return this.asks.limit(),this.bids.limit(),this}update(t){return void 0!==t.nonce&&void 0!==this.nonce&&t.nonce<=this.nonce?this:(this.nonce=t.nonce,this.timestamp=t.timestamp,this.datetime=(0,s.LC)(this.timestamp),this.reset(t))}reset(t={}){if(this.asks.index.fill(Number.MAX_VALUE),this.asks.length=0,t.asks)for(let e=0;e<t.asks.length;e++)this.asks.storeArray(t.asks[e]);if(this.bids.index.fill(Number.MAX_VALUE),this.bids.length=0,t.bids)for(let e=0;e<t.bids.length;e++)this.bids.storeArray(t.bids[e]);return this.nonce=t.nonce,this.timestamp=t.timestamp,this.datetime=(0,s.LC)(this.timestamp),this.symbol=t.symbol,this}}class o extends n{constructor(t={},e=void 0){super((0,r.X$)(t,{asks:new a.f_(t.asks||[],e),bids:new a.jR(t.bids||[],e)}))}}class d extends n{constructor(t={},e=void 0){super((0,r.X$)(t,{asks:new a.o5(t.asks||[],e),bids:new a.eB(t.bids||[],e)}))}}},3867(t,e,i){"use strict";i.d(e,{Lm:()=>n,Lo:()=>o,c$:()=>h,f:()=>d,nx:()=>p,q5:()=>a,xW:()=>l});var s=i(1420);function r(t,e,i){if(t instanceof Uint8Array)return i?new Uint8Array(t):t;if("string"==typeof t&&t.match(/^0x([0-9a-f][0-9a-f])*$/i)){const e=new Uint8Array((t.length-2)/2);let i=2;for(let s=0;s<e.length;s++)e[s]=parseInt(t.substring(i,i+2),16),i+=2;return e}(0,s.MR)(!1,"invalid BytesLike value",e||"value",t)}function a(t,e){return r(t,e,!1)}function n(t,e){return r(t,e,!0)}function o(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/))&&(("number"!=typeof e||t.length===2+2*e)&&(!0!==e||t.length%2==0))}function d(t){return o(t,!0)||t instanceof Uint8Array}const c="0123456789abcdef";function h(t){const e=a(t);let i="0x";for(let t=0;t<e.length;t++){const s=e[t];i+=c[(240&s)>>4]+c[15&s]}return i}function l(t){return"0x"+t.map(t=>h(t).substring(2)).join("")}function u(t,e,i){const r=a(t);(0,s.vA)(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const n=new Uint8Array(e);return n.fill(0),i?n.set(r,e-r.length):n.set(r,0),h(n)}function p(t,e){return u(t,e,!0)}},3898(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(9946),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,createOrderWs:!1,editOrderWs:!1,fetchOpenOrdersWs:!1,fetchOrderWs:!1,cancelOrderWs:!1,cancelOrdersWs:!1,cancelAllOrdersWs:!1,fetchTradesWs:!1,fetchBalanceWs:!1,watchOrderBook:!0,watchOrders:!0,watchTickers:!1,watchTicker:!0,watchTrades:!0,watchTradesForSymbols:!1,watchMyTrades:!0,watchBalance:!0,watchOHLCV:!0,unwatchTicker:!0,unwatchOHLCV:!0,unwatchTrades:!0,unwatchOrderBook:!0},urls:{api:{ws:{api:{spot:{public:"wss://{hostname}/ws",private:"wss://{hostname}/ws/v2",feed:"wss://{hostname}/feed"},future:{linear:{public:"wss://api.hbdm.com/linear-swap-ws",private:"wss://api.hbdm.com/linear-swap-notification"},inverse:{public:"wss://api.hbdm.com/ws",private:"wss://api.hbdm.com/notification"}},swap:{inverse:{public:"wss://api.hbdm.com/swap-ws",private:"wss://api.hbdm.com/swap-notification"},linear:{public:"wss://api.hbdm.com/linear-swap-ws",private:"wss://api.hbdm.com/linear-swap-notification"}}},"api-aws":{spot:{public:"wss://api-aws.huobi.pro/ws",private:"wss://api-aws.huobi.pro/ws/v2",feed:"wss://{hostname}/feed"},future:{linear:{public:"wss://api.hbdm.vn/linear-swap-ws",private:"wss://api.hbdm.vn/linear-swap-notification"},inverse:{public:"wss://api.hbdm.vn/ws",private:"wss://api.hbdm.vn/notification"}},swap:{linear:{public:"wss://api.hbdm.vn/linear-swap-ws",private:"wss://api.hbdm.vn/linear-swap-notification"},inverse:{public:"wss://api.hbdm.vn/swap-ws",private:"wss://api.hbdm.vn/swap-notification"}}}}}},options:{tradesLimit:1e3,OHLCVLimit:1e3,api:"api",watchOrderBook:{maxRetries:3,checksum:!0,depth:150},ws:{gunzip:!0},watchTicker:{name:"market.{marketId}.detail"}},exceptions:{ws:{exact:{"bad-request":r.BadRequest,2002:r.AuthenticationError,2021:r.BadRequest,2001:r.BadSymbol,2011:r.BadSymbol,2040:r.BadRequest,4007:r.BadRequest}}}})}requestId(){this.lockId();const t=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=t,this.unlockId(),t.toString()}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t);t=i.symbol;const s=this.safeDict(this.options,"watchTicker",{}),a=this.safeString(s,"name","market.{marketId}.detail");if("market.{marketId}.ticker"===a&&"spot"!==i.type)throw new r.BadRequest(this.id+" watchTicker() with name market.{marketId}.ticker is only allowed for spot markets, use market.{marketId}.detail instead");const n=this.implodeParams(a,{marketId:i.id}),o=this.getUrlByMarketType(i.type,i.linear);return await this.subscribePublic(o,t,n,void 0,e)}async unWatchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s=this.safeDict(this.options,"watchTicker",{}),a=this.safeString(s,"name","market.{marketId}.detail");if("market.{marketId}.ticker"===a&&"spot"!==i.type)throw new r.BadRequest(this.id+" watchTicker() with name market.{marketId}.ticker is only allowed for spot markets, use market.{marketId}.detail instead");const n=this.implodeParams(a,{marketId:i.id});return await this.unsubscribePublic(i,n,"ticker",e)}handleTicker(t,e){const i=this.safeValue(e,"tick",{}),s=this.safeString(e,"ch"),r=s.split("."),a=this.safeString(r,1),n=this.safeMarket(a),o=this.parseTicker(i,n),d=this.safeValue(e,"ts");o.timestamp=d,o.datetime=this.iso8601(d);const c=o.symbol;return this.tickers[c]=o,t.resolve(o,s),e}async watchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t);t=r.symbol;const a="market."+r.id+".trade.detail",n=this.getUrlByMarketType(r.type,r.linear),o=await this.subscribePublic(n,t,a,void 0,s);return this.newUpdates&&(i=o.getLimit(t,i)),this.filterBySinceLimit(o,e,i,"timestamp",!0)}async unWatchTrades(t,e={}){await this.loadMarkets();const i=this.market(t),s=this.safeDict(this.options,"watchTrades",{}),r=this.safeString(s,"name","market.{marketId}.trade.detail"),a=this.implodeParams(r,{marketId:i.id});return await this.unsubscribePublic(i,a,"trades",e)}handleTrades(t,e){const i=this.safeValue(e,"tick",{}),s=this.safeValue(i,"data",{}),r=this.safeString(e,"ch"),n=r.split("."),o=this.safeString(n,1),d=this.safeMarket(o),c=d.symbol;let h=this.safeValue(this.trades,c);if(void 0===h){const t=this.safeInteger(this.options,"tradesLimit",1e3);h=new a.I3(t),this.trades[c]=h}for(let t=0;t<s.length;t++){const e=this.parseTrade(s[t],d);h.append(e)}return t.resolve(h,r),e}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);t=a.symbol;const n=this.safeString(this.timeframes,e,e),o="market."+a.id+".kline."+n,d=this.getUrlByMarketType(a.type,a.linear),c=await this.subscribePublic(d,t,o,void 0,r);return this.newUpdates&&(s=c.getLimit(t,s)),this.filterBySinceLimit(c,i,s,0,!0)}async unWatchOHLCV(t,e="1m",i={}){await this.loadMarkets();const s=this.market(t),r=this.safeString(this.timeframes,e,e),a="market."+s.id+".kline."+r;return i.symbolsAndTimeframes=[[s.symbol,e]],await this.unsubscribePublic(s,a,"ohlcv",i)}handleOHLCV(t,e){const i=this.safeString(e,"ch"),s=i.split("."),r=this.safeString(s,1),n=this.safeMarket(r),o=n.symbol,d=this.safeString(s,3),c=this.findTimeframe(d);this.ohlcvs[o]=this.safeValue(this.ohlcvs,o,{});let h=this.safeValue(this.ohlcvs[o],c);if(void 0===h){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);h=new a.TG(t),this.ohlcvs[o][c]=h}const l=this.safeValue(e,"tick"),u=this.parseOHLCV(l,n);h.append(u),t.resolve(h,i)}async watchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t);t=s.symbol;const a=this.safeDict(this.options,"watchOrderBook",{});if(void 0===e&&(e=this.safeInteger(a,"depth",150)),!this.inArray(e,[5,20,150,400]))throw new r.ExchangeError(this.id+" watchOrderBook market accepts limits of 5, 20, 150 or 400 only");let n;n=s.spot?"market."+s.id+".mbp."+this.numberToString(e):"market."+s.id+".depth.size_"+this.numberToString(e)+".high_freq";const o=this.getUrlByMarketType(s.type,s.linear,!1,!0);let d=this.handleOrderBookSubscription;s.spot||((i=this.extend(i)).data_type="incremental",d=void 0);return(await this.subscribePublic(o,t,n,d,i)).limit()}async unWatchOrderBook(t,e={}){await this.loadMarkets();const i=this.market(t),s=this.safeDict(this.options,"watchOrderBook",{}),r=this.safeInteger(s,"depth",150);let a;return a=i.spot?"market."+i.id+".mbp."+this.numberToString(r):"market."+i.id+".depth.size_"+this.numberToString(r)+".high_freq",i.spot||(e.data_type="incremental"),await this.unsubscribePublic(i,a,"orderbook",e)}handleOrderBookSnapshot(t,e,i){const s=this.safeString(i,"symbol"),a=this.safeString(i,"messageHash"),n=this.safeString(e,"id"),o=this.safeInteger(i,"lastTimestamp");try{const d=this.orderbooks[s],c=this.safeValue(e,"data"),h=d.cache,l=this.safeValue(h,0,{}),u=this.parseOrderBook(c,s),p=this.safeValue(l,"tick"),f=this.safeInteger(p,"prevSeqNum"),m=this.safeInteger(c,"seqNum");u.nonce=m;const g=this.safeInteger(e,"ts");i.lastTimestamp=g;const y=this.safeInteger(i,"limit"),v=this.orderBook(u,y);if(t.resolve(v,n),void 0===f||m<f){const n=this.handleOption("watchOrderBook","maxRetries",3);let d=this.safeInteger(i,"numAttempts",0);if(!(d<n))throw new r.InvalidNonce(this.id+" failed to synchronize WebSocket feed with the snapshot for symbol "+s+" in "+n.toString()+" attempts");if(a in t.subscriptions){d=this.sum(d,1);const s=this.sum(1e3,o-g);i.numAttempts=d,t.subscriptions[a]=i,this.delay(s,this.watchOrderBookSnapshot,t,e,i)}}else{d.reset(u);for(let e=0;e<h.length;e++)this.handleOrderBookMessage(t,h[e]);d.cache=[],this.orderbooks[s]=d,t.resolve(d,a)}}catch(e){delete t.subscriptions[a],delete this.orderbooks[s],t.reject(e,a)}}async watchOrderBookSnapshot(t,e,i){const s=this.safeString(i,"messageHash"),r=this.safeString(i,"symbol"),a=this.safeInteger(i,"limit"),n=this.safeInteger(e,"ts"),o=this.safeValue(i,"params"),d=this.safeInteger(i,"numAttempts",0),c=this.market(r),h=this.getUrlByMarketType(c.type,c.linear,!1,!0),l=this.requestId(),u={req:s,id:l},p={id:l,messageHash:s,symbol:r,limit:a,params:o,numAttempts:d,lastTimestamp:n,method:this.handleOrderBookSnapshot};try{return(await this.watch(h,l,u,l,p)).limit()}catch(e){delete t.subscriptions[s],t.reject(e,s)}}handleDelta(t,e){const i=this.safeFloat(e,0),s=this.safeFloat(e,1);t.store(i,s)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}handleOrderBookMessage(t,e){const i=this.safeValue(e,"ch").split("."),s=this.safeString(i,1),a=this.safeMarket(s),n=a.symbol,o=this.orderbooks[n],d=this.safeValue(e,"tick",{}),c=this.safeInteger(d,"seqNum"),h=this.safeInteger(d,"prevSeqNum"),l=this.safeString(d,"event"),u=this.safeInteger(d,"version"),p=this.safeInteger(e,"ts");if("snapshot"===l){const t=this.parseOrderBook(d,n,p);o.reset(t),o.nonce=u}if(void 0!==h&&h>o.nonce){if(this.handleOption("watchOrderBook","checksum",!0))throw new r.ChecksumError(this.id+" "+this.orderbookChecksumMessage(n))}const f=a.spot&&h===o.nonce,m=a.contract&&u-1===o.nonce;if(f||m){const t=this.safeValue(d,"asks",[]),e=this.safeValue(d,"bids",[]);this.handleDeltas(o.asks,t),this.handleDeltas(o.bids,e),o.nonce=f?c:u,o.timestamp=p,o.datetime=this.iso8601(p)}}handleOrderBook(t,e){const i=this.safeString(e,"ch"),s=this.safeDict(e,"tick"),r=this.safeString(s,"event"),a=this.safeString(e,"ch").split("."),n=this.safeString(a,1),o=this.safeSymbol(n);if(!(o in this.orderbooks)){const t=this.safeString(a,3).split("_"),e=this.safeInteger(t,1);this.orderbooks[o]=this.orderBook({},e)}const d=this.orderbooks[o];void 0===r&&void 0===d.nonce?d.cache.push(e):(this.handleOrderBookMessage(t,e),t.resolve(d,i))}handleOrderBookSubscription(t,e,i){const s=this.safeString(i,"symbol"),r=this.market(s),a=this.safeInteger(i,"limit");this.orderbooks[s]=this.orderBook({},a),r.spot&&this.spawn(this.watchOrderBookSnapshot,t,e,i)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r;this.checkRequiredCredentials(),await this.loadMarkets();let a,n,o,d,c,h="*";if(void 0!==t?(a=this.market(t),t=a.symbol,r=a.type,c=a.linear?"linear":"inverse",h=a.lowercaseId):(r=this.safeString(this.options,"defaultType","spot"),r=this.safeString(s,"type",r),c=this.safeString2(this.options,"subType","defaultSubType","linear"),c=this.safeString(s,"subType",c),s=this.omit(s,["type","subType"])),"spot"===r){let t;void 0===t&&(t=this.safeString2(this.options,"watchMyTrades","mode","0"),t=this.safeString(s,"mode",t),s=this.omit(s,"mode")),n="trade.clearing#"+h+"#"+t,o=n}else{const t=this.getOrderChannelAndMessageHash(r,c,a,s);o=this.safeString(t,0);n=this.safeString(t,1)+":trade"}return d=await this.subscribePrivate(o,n,r,c,s),this.newUpdates&&(i=d.getLimit(t,i)),this.filterBySymbolSinceLimit(d,t,e,i,!0)}getOrderChannelAndMessageHash(t,e,i=void 0,s={}){let r,a,n=this.safeString(this.options,"orderType","orders");n=this.safeString(s,"orderType",n),s=this.omit(s,"orderType");const o=void 0!==i?i.lowercaseId.toLowerCase():void 0,d=void 0!==i?i.baseId:void 0,c=n;if(r=c,"linear"===e){const t="cross"===this.safeString(s,"margin","cross")?c+"_cross":c;r=t,void 0!==o?(r+="."+o,a=r):a=t+".*"}else"future"===t?void 0!==d?(a=c+"."+d.toLowerCase(),r=a):a=c+".*":void 0!==o?(a=c+"."+o,r=a):a=c+".*";return[a,r]}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){let r,a,n;await this.loadMarkets();let o,d,c="*";if(void 0!==t?(n=this.market(t),t=n.symbol,r=n.type,c=n.lowercaseId,a=n.linear?"linear":"inverse"):(r=this.safeString(this.options,"defaultType","spot"),r=this.safeString(s,"type",r),a=this.safeString2(this.options,"subType","defaultSubType","linear"),a=this.safeString(s,"subType",a),s=this.omit(s,["type","subType"])),"spot"===r)o="orders#"+c,d=o;else{const t=this.getOrderChannelAndMessageHash(r,a,n,s);d=this.safeString(t,0),o=this.safeString(t,1)}const h=await this.subscribePrivate(d,o,r,a,s);return this.newUpdates&&(i=h.getLimit(t,i)),this.filterBySinceLimit(h,e,i,"timestamp",!0)}handleOrder(t,e){const i=this.safeString2(e,"ch","topic"),s=this.safeValue(e,"data");let r=this.safeString(e,"contract_code");void 0===r&&(r=this.safeString(s,"symbol"));const n=this.safeMarket(r);let o;if(void 0!==s){if("trade"===this.safeString(s,"eventType")){const t=this.parseOrderTrade(s,n),e=this.safeString(t,"order"),i=[t],r=this.parseOrderStatus(this.safeString2(s,"orderStatus","status","closed")),a=this.safeString(s,"execAmt"),d=this.safeString(s,"remainAmt");o={id:e,trades:i,status:r,symbol:n.symbol,filled:this.parseNumber(a),remaining:this.parseNumber(d),price:this.safeNumber(s,"orderPrice"),amount:this.safeNumber(s,"orderSize"),info:s}}else o=this.parseWsOrder(s,n)}else{o=this.parseWsOrder(e,n);const s=this.safeValue(e,"trade",[]);if(s.length>0){const e={trades:s,ch:i,symbol:r},a={order:this.safeString(o,"id"),type:this.safeString(o,"type"),side:this.safeString(o,"side")};this.handleMyTrade(t,e,a)}}if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a.Pt(t)}this.orders.append(o),t.resolve(this.orders,i);let d=i.replace("."+n.lowercaseId,"");const c=this.safeStringLower(n,"baseId");d=d.replace("."+c,""),t.resolve(this.orders,d)}parseWsOrder(t,e=void 0){const i=this.safeInteger2(t,"lastActTime","ts"),s=this.safeInteger(t,"orderCreateTime"),r=this.safeString2(t,"contract_code","symbol");e=this.safeMarket(r,e);const a=this.safeSymbol(r,e),n=this.safeString2(t,"orderSize","volume"),o=this.parseOrderStatus(this.safeString2(t,"orderStatus","status")),d=this.safeString2(t,"orderId","order_id"),c=this.safeString2(t,"clientOrderId","client_order_id"),h=this.safeString2(t,"orderPrice","price"),l=this.safeString(t,"execAmt"),u=this.safeString(t,"type"),p=this.safeString(t,"fee");let f;if(void 0!==p){const e=this.safeString(t,"fee_asset");f={cost:p,currency:this.safeCurrencyCode(e)}}const m=this.safeString(t,"trade_avg_price"),g=this.safeValue(t,"trade");let y=[];void 0!==u&&(y=u.split("-"));let v=this.safeStringLower(y,1);void 0===v&&(v=this.safeString(t,"order_price_type"));let b=this.safeStringLower(y,0);void 0===b&&(b=this.safeString(t,"direction"));const w=this.safeString(t,"orderValue");return this.safeOrder({info:t,id:d,clientOrderId:c,timestamp:s,datetime:this.iso8601(s),lastTradeTimestamp:i,status:o,symbol:a,type:v,timeInForce:void 0,postOnly:void 0,side:b,price:h,amount:n,filled:l,remaining:void 0,cost:w,fee:f,average:m,trades:g},e)}parseOrderTrade(t,e=void 0){const i=(e=this.safeMarket(void 0,e)).symbol,s=this.safeString(t,"tradeId"),r=this.safeString(t,"tradePrice"),a=this.safeString(t,"tradeVolume"),n=this.safeString(t,"orderId"),o=this.safeInteger(t,"tradeTime");let d,c=this.safeString(t,"type");if(void 0!==c){const t=c.split("-");d=t[0],c=t[1]}const h=this.safeValue(t,"aggressor");let l;return void 0!==h&&(l=h?"taker":"maker"),this.safeTrade({info:t,timestamp:o,datetime:this.iso8601(o),symbol:i,id:s,order:n,type:c,takerOrMaker:l,side:d,price:r,amount:a,cost:void 0,fee:void 0},e)}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();let a,n,o,d="";this.isEmpty(t)||(r=this.getMarketFromSymbols(t),d="::"+t.join(",")),void 0!==r?(a=r.type,n=r.linear?"linear":"inverse"):([a,s]=this.handleMarketTypeAndParams("watchPositions",r,s),"spot"===a&&(a="future"),[n,s]=this.handleOptionAndParams(s,"watchPositions","subType",n)),t=this.marketSymbols(t),[o,s]=this.handleMarginModeAndParams("watchPositions",s,"cross");const c="linear"===n,h=this.getUrlByMarketType(a,c,!0);d=o+":positions"+d;const l="cross"===o?"positions_cross.*":"positions.*",u=await this.subscribePrivate(l,d,a,n,s);return this.newUpdates?u:this.filterBySymbolsSinceLimit(this.positions[h][o],t,e,i,!1)}handlePositions(t,e){const i=t.url,s="positions_cross"===this.safeString(e,"topic","")?"cross":"isolated";void 0===this.positions&&(this.positions={});const r=this.safeValue(this.positions,i);void 0===r&&(this.positions[i]={});void 0===this.safeValue(r,s)&&(this.positions[i][s]=new a.Hk);const n=this.positions[i][s],o=this.safeValue(e,"data",[]),d=[],c=this.safeInteger(e,"ts");for(let t=0;t<o.length;t++){const e=o[t],i=this.parsePosition(e);i.timestamp=c,i.datetime=this.iso8601(c),d.push(i),n.append(i)}const h=this.findMessageHashes(t,s+":positions::");for(let e=0;e<h.length;e++){const i=h[e],s=i.split("::")[1].split(","),r=this.filterByArray(d,"symbol",s,!1);this.isEmpty(r)||t.resolve(r,i)}t.resolve(d,s+":positions")}async watchBalance(t={}){let e,i;[e,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t),[i,t]=this.handleSubTypeAndParams("watchBalance",void 0,t,"linear");const s=this.safeValue2(t,"isUnifiedAccount","unified",!1);let r,a,n;if(t=this.omit(t,["isUnifiedAccount","unified"]),await this.loadMarkets(),"spot"===e){let e=this.safeString2(this.options,"watchBalance","mode","2");e=this.safeString(t,"mode",e),r="accounts.update#"+e,a=r}else{const o=this.safeString(t,"symbol"),d=this.safeString(t,"currency"),c=void 0!==o?this.market(o):void 0,h=void 0!==d?this.currency(d):void 0;n=this.safeString(t,"margin","cross"),t=this.omit(t,["currency","symbol","margin"]);let l="accounts";r=l,"linear"===i?s?(l="accounts_unify",r=l,a=l+".usdt"):(l="cross"===n?l+"_cross":l,r=l,"isolated"===n?void 0!==o?(r+="."+c.id,a=r):a=l+".*":void 0!==h?(a=l+"."+h.id,r=a):a=l+".*"):"future"===e?void 0!==h?(r+="."+h.id,a=r):a=l+".*":void 0!==c?(r+="."+c.id,a=r):a=l+".*"}const o={type:e,subType:i,margin:n};return await this.subscribePrivate(a,r,e,i,t,o)}handleBalance(t,e){const i=this.safeString(e,"ch"),s=this.safeValue(e,"data",[]),r=this.safeInteger(s,"changeTime",this.safeInteger(e,"ts"));if(this.balance.timestamp=r,this.balance.datetime=this.iso8601(r),this.balance.info=s,void 0!==i){const e=this.safeString(s,"currency"),r=this.safeCurrencyCode(e),a=this.account();a.free=this.safeString(s,"available"),a.total=this.safeString(s,"balance"),this.balance[r]=a,this.balance=this.safeBalance(this.balance),t.resolve(this.balance,i)}else{if(0===s.length)return;const i=this.safeValue(s,0,{}),r=this.safeString(e,"topic"),a=r.split(".");let n=this.safeString(a,0),o=this.safeValue2(t.subscriptions,n,n+".*");if(void 0===o){n+="."+this.safeString2(i,"margin_asset","symbol").toLowerCase(),o=this.safeValue(t.subscriptions,n)}const d=this.safeString(o,"type"),c=this.safeString(o,"subType");if("accounts_unify"===r){const e=this.safeString(i,"margin_asset"),s=this.safeCurrencyCode(e),r=this.safeString(i,"margin_frozen"),a=this.account();a.free=this.safeString(i,"withdraw_available"),a.used=r,this.balance[s]=a,this.balance=this.safeBalance(this.balance),t.resolve(this.balance,"accounts_unify")}else if("linear"===c){if("cross"===this.safeString(o,"margin")){const t="future"===d?"futures_contract_detail":"contract_detail",e=this.safeValue(i,t,[]);if(e.length>0)for(let t=0;t<e.length;t++){const i=e[t],s=this.safeString2(i,"contract_code","margin_account"),r=this.safeMarket(s),a=this.safeString(i,"margin_asset"),n=this.safeCurrency(a),o=this.safeString(r,"settle",n.code);if(void 0!==o){const t=this.account();t.free=this.safeString2(i,"margin_balance","margin_available"),t.used=this.safeString(i,"margin_frozen");const e={};e[o]=t;const s=r.symbol;this.balance[s]=this.safeBalance(e)}}}else for(let t=0;t<s.length;t++){const e=s[t],i=this.account();i.free=this.safeString(e,"margin_balance","margin_available"),i.used=this.safeString(e,"margin_frozen");const r=this.safeString2(e,"margin_asset","symbol"),a=this.safeCurrencyCode(r);this.balance[a]=i,this.balance=this.safeBalance(this.balance)}}else for(let t=0;t<s.length;t++){const e=s[t],i=this.safeString(e,"symbol"),r=this.safeCurrencyCode(i),a=this.account();a.free=this.safeString(e,"margin_available"),a.used=this.safeString(e,"margin_frozen"),this.balance[r]=a,this.balance=this.safeBalance(this.balance)}t.resolve(this.balance,n)}}handleSubscriptionStatus(t,e){const i=this.safeString(e,"id"),s=this.indexBy(t.subscriptions,"id"),r=this.safeDict(s,i);if(void 0!==r){const s=this.safeValue(r,"method");void 0!==s&&s.call(this,t,e,r),i in t.subscriptions&&delete t.subscriptions[i]}"unsubbed"in e&&this.handleUnSubscription(t,r)}handleUnSubscription(t,e){const i=this.safeList(e,"messageHashes",[]),s=this.safeList(e,"subMessageHashes",[]);for(let e=0;e<i.length;e++){const r=i[e],a=s[e];this.cleanUnsubscription(t,a,r)}this.cleanCache(e)}handleSystemStatus(t,e){return e}handleSubject(t,e){const i=this.safeValue(e,"ch",""),s=i.split(".");if("market"===this.safeString(s,0)){const i=this.safeString(s,2),r={depth:this.handleOrderBook,mbp:this.handleOrderBook,detail:this.handleTicker,bbo:this.handleTicker,ticker:this.handleTicker,trade:this.handleTrades,kline:this.handleOHLCV},a=this.safeValue(r,i);if(void 0!==a)return void a.call(this,t,e)}const r=i.split("#"),a=this.safeString(r,0,"");if("trade.clearing"===a)return void this.handleMyTrade(t,e);if(a.indexOf("accounts.update")>=0)return void this.handleBalance(t,e);if("orders"===a)return void this.handleOrder(t,e);if("notify"===this.safeString(e,"op")){const i=this.safeString(e,"topic","");i.indexOf("orders")>=0&&this.handleOrder(t,e),i.indexOf("account")>=0&&this.handleBalance(t,e),i.indexOf("positions")>=0&&this.handlePositions(t,e)}}async pong(t,e){try{const i=this.safeInteger(e,"ping");if(void 0!==i)return void await t.send({pong:i});if("ping"===this.safeString(e,"action")){const i=this.safeValue(e,"data"),s=this.safeInteger(i,"ts");return void await t.send({action:"pong",data:{ts:s}})}if("ping"===this.safeString(e,"op")){const i=this.safeInteger(e,"ts");await t.send({op:"pong",ts:i})}}catch(e){const i=new r.NetworkError(this.id+" pong failed "+this.json(e));t.reset(i)}}handlePing(t,e){this.spawn(this.pong,t,e)}handleAuthenticate(t,e){t.futures.auth.resolve(e)}handleErrorMessage(t,e){if("error"===this.safeString(e,"status")){const i=this.safeString(e,"id"),s=this.indexBy(t.subscriptions,"id"),a=this.safeValue(s,i);if(void 0!==a){const s=this.safeString(e,"err-code");try{throw this.throwExactlyMatchedException(this.exceptions.ws.exact,s,this.json(e)),new r.ExchangeError(this.json(e))}catch(e){const s=this.safeString(a,"messageHash");t.reject(e,s),t.reject(e,i),i in t.subscriptions&&delete t.subscriptions[i]}}return!1}const i=this.safeString2(e,"code","err-code");if(void 0!==i&&"200"!==i&&"0"!==i){const s=this.id+" "+this.json(e);try{throw this.throwExactlyMatchedException(this.exceptions.ws.exact,i,s),new r.ExchangeError(s)}catch(e){if(e instanceof r.AuthenticationError){t.reject(e,"auth");const i="auth";return i in t.subscriptions&&delete t.subscriptions[i],!1}t.reject(e)}}return!0}handleMessage(t,e){if(this.handleErrorMessage(t,e)){if("id"in e)return void this.handleSubscriptionStatus(t,e);if("action"in e){const i=this.safeString(e,"action");if("ping"===i)return void this.handlePing(t,e);if("sub"===i)return void this.handleSubscriptionStatus(t,e)}if("ch"in e)return"auth"===e.ch?void this.handleAuthenticate(t,e):void this.handleSubject(t,e);if("op"in e){const i=this.safeString(e,"op");if("ping"===i)return void this.handlePing(t,e);if("auth"===i)return void this.handleAuthenticate(t,e);if("sub"===i)return void this.handleSubscriptionStatus(t,e);if("notify"===i)return void this.handleSubject(t,e)}"ping"in e&&this.handlePing(t,e)}}handleMyTrade(t,e,i={}){if(void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new a.Pt(t)}const s=this.myTrades,r=this.safeString(e,"ch");if(void 0!==r){const a=this.safeValue(e,"data");if(void 0!==a){const e=this.parseWsTrade(a);void 0!==this.safeString(e,"symbol")&&(s.append(e),t.resolve(this.myTrades,r))}else{const a=this.safeValue(e,"trades",[]),n=this.safeValue(e,"symbol"),o=this.market(n);for(let t=0;t<a.length;t++){const e=a[t];let r=this.parseTrade(e,o);r=this.extend(r,i),s.append(r)}const d=r+":trade";t.resolve(this.myTrades,d);let c=r.replace("."+o.lowercaseId,"");const h=this.safeStringLower(o,"baseId");c=c.replace("."+h,"");const l=c+":trade";t.resolve(this.myTrades,l)}}}parseWsTrade(t,e=void 0){const i=this.safeSymbol(this.safeString(t,"symbol")),s=this.safeString2(t,"side","orderSide"),r=this.safeString(t,"tradeId"),a=this.safeString(t,"tradePrice"),n=this.safeString(t,"tradeVolume"),o=this.safeString(t,"orderId"),d=this.safeInteger(t,"tradeTime");e=this.market(i);const c=this.safeString(t,"orderType"),h=this.safeValue(t,"aggressor");let l,u;void 0!==h&&(l=h?"taker":"maker");let p,f=[];void 0!==c&&(f=c.split("-"),u=this.safeString(f,1));const m=this.safeCurrencyCode(this.safeString(t,"feeCurrency"));return void 0!==m&&(p={cost:this.safeString(t,"transactFee"),currency:m}),this.safeTrade({info:t,timestamp:d,datetime:this.iso8601(d),symbol:i,id:r,order:o,type:u,takerOrMaker:l,side:s,price:a,amount:n,cost:void 0,fee:p},e)}getUrlByMarketType(t,e=!0,i=!1,s=!1){const r=this.safeString(this.options,"api","api"),a={hostname:this.hostname};let n,o;if("spot"===t)n=i?this.urls.api.ws[r].spot.private:s?this.urls.api.ws[r].spot.feed:this.urls.api.ws[r].spot.public,o=this.implodeParams(n,a);else{const s=this.urls.api.ws[r][t],a=e?s.linear:s.inverse;o=i?a.private:a.public}return o}async subscribePublic(t,e,i,s=void 0,r={}){const a=this.requestId(),n={sub:i,id:a},o={id:a,messageHash:i,symbol:e,params:r};return void 0!==s&&(o.method=s),await this.watch(t,i,this.extend(n,r),i,o)}async unsubscribePublic(t,e,i,s={}){const r=this.requestId(),a={unsub:e,id:r},n="unsubscribe::"+e,o="orderbook"===i,d=this.getUrlByMarketType(t.type,t.linear,!1,o),c={unsubscribe:!0,id:r,subMessageHashes:[e],messageHashes:[n],symbols:[t.symbol],topic:i},h=this.safeList(s,"symbolsAndTimeframes");return void 0!==h&&(c.symbolsAndTimeframes=h,s=this.omit(s,"symbolsAndTimeframes")),await this.watch(d,n,this.extend(a,s),n,c)}async subscribePrivate(t,e,i,s,r={},a={}){const n=this.requestId(),o={id:n,messageHash:e,params:r},d=this.extend(o,a);let c;c="spot"===i?{action:"sub",ch:t}:{op:"sub",topic:t,cid:n};const h="linear"===s,l=this.getUrlByMarketType(i,h,!0),u={type:i,url:l,hostname:"spot"===i?this.urls.hostnames.spot:this.urls.hostnames.contract};return await this.authenticate(u),await this.watch(l,e,this.extend(c,r),t,d)}async authenticate(t={}){const e=this.safeString(t,"url"),i=this.safeString(t,"hostname"),s=this.safeString(t,"type");if(void 0===e||void 0===i||void 0===s)throw new r.ArgumentsRequired(this.id+" authenticate requires a url, hostname and type argument");this.checkRequiredCredentials();const a="auth",o=e.replace("wss://"+i,""),d=this.client(e),c=d.reusableFuture(a);if(void 0===this.safeValue(d.subscriptions,a)){const r=this.ymdhms(this.milliseconds(),"T");let d;d="spot"===s?{accessKey:this.apiKey,signatureMethod:"HmacSHA256",signatureVersion:"2.1",timestamp:r}:{AccessKeyId:this.apiKey,SignatureMethod:"HmacSHA256",SignatureVersion:"2",Timestamp:r},d=this.keysort(d);const c=["GET",i,o,this.urlencode(d,!0)].join("\n"),h=this.hmac(this.encode(c),this.encode(this.secret),n.s,"base64");let l;if("spot"===s){l={params:{authType:"api",accessKey:this.apiKey,signatureMethod:"HmacSHA256",signatureVersion:"2.1",timestamp:r,signature:h},action:"req",ch:"auth"}}else l={op:"auth",type:"api",AccessKeyId:this.apiKey,SignatureMethod:"HmacSHA256",SignatureVersion:"2",Timestamp:r,Signature:h};const u={id:this.requestId(),messageHash:a,params:t};this.watch(e,a,l,a,u)}return await c}}},4035(t,e,i){"use strict";i.d(e,{F:()=>d});var s=i(1094);function r(t,e){var i=t[0],s=t[1],r=t[2],a=t[3];s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&r|~s&a)+e[0]-680876936|0)<<7|i>>>25)+s|0)&s|~i&r)+e[1]-389564586|0)<<12|a>>>20)+i|0)&i|~a&s)+e[2]+606105819|0)<<17|r>>>15)+a|0)&a|~r&i)+e[3]-1044525330|0)<<22|s>>>10)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&r|~s&a)+e[4]-176418897|0)<<7|i>>>25)+s|0)&s|~i&r)+e[5]+1200080426|0)<<12|a>>>20)+i|0)&i|~a&s)+e[6]-1473231341|0)<<17|r>>>15)+a|0)&a|~r&i)+e[7]-45705983|0)<<22|s>>>10)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&r|~s&a)+e[8]+1770035416|0)<<7|i>>>25)+s|0)&s|~i&r)+e[9]-1958414417|0)<<12|a>>>20)+i|0)&i|~a&s)+e[10]-42063|0)<<17|r>>>15)+a|0)&a|~r&i)+e[11]-1990404162|0)<<22|s>>>10)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&r|~s&a)+e[12]+1804603682|0)<<7|i>>>25)+s|0)&s|~i&r)+e[13]-40341101|0)<<12|a>>>20)+i|0)&i|~a&s)+e[14]-1502002290|0)<<17|r>>>15)+a|0)&a|~r&i)+e[15]+1236535329|0)<<22|s>>>10)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&a|r&~a)+e[1]-165796510|0)<<5|i>>>27)+s|0)&r|s&~r)+e[6]-1069501632|0)<<9|a>>>23)+i|0)&s|i&~s)+e[11]+643717713|0)<<14|r>>>18)+a|0)&i|a&~i)+e[0]-373897302|0)<<20|s>>>12)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&a|r&~a)+e[5]-701558691|0)<<5|i>>>27)+s|0)&r|s&~r)+e[10]+38016083|0)<<9|a>>>23)+i|0)&s|i&~s)+e[15]-660478335|0)<<14|r>>>18)+a|0)&i|a&~i)+e[4]-405537848|0)<<20|s>>>12)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&a|r&~a)+e[9]+568446438|0)<<5|i>>>27)+s|0)&r|s&~r)+e[14]-1019803690|0)<<9|a>>>23)+i|0)&s|i&~s)+e[3]-187363961|0)<<14|r>>>18)+a|0)&i|a&~i)+e[8]+1163531501|0)<<20|s>>>12)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s&a|r&~a)+e[13]-1444681467|0)<<5|i>>>27)+s|0)&r|s&~r)+e[2]-51403784|0)<<9|a>>>23)+i|0)&s|i&~s)+e[7]+1735328473|0)<<14|r>>>18)+a|0)&i|a&~i)+e[12]-1926607734|0)<<20|s>>>12)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s^r^a)+e[5]-378558|0)<<4|i>>>28)+s|0)^s^r)+e[8]-2022574463|0)<<11|a>>>21)+i|0)^i^s)+e[11]+1839030562|0)<<16|r>>>16)+a|0)^a^i)+e[14]-35309556|0)<<23|s>>>9)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s^r^a)+e[1]-1530992060|0)<<4|i>>>28)+s|0)^s^r)+e[4]+1272893353|0)<<11|a>>>21)+i|0)^i^s)+e[7]-155497632|0)<<16|r>>>16)+a|0)^a^i)+e[10]-1094730640|0)<<23|s>>>9)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s^r^a)+e[13]+681279174|0)<<4|i>>>28)+s|0)^s^r)+e[0]-358537222|0)<<11|a>>>21)+i|0)^i^s)+e[3]-722521979|0)<<16|r>>>16)+a|0)^a^i)+e[6]+76029189|0)<<23|s>>>9)+r|0,s=((s+=((r=((r+=((a=((a+=((i=((i+=(s^r^a)+e[9]-640364487|0)<<4|i>>>28)+s|0)^s^r)+e[12]-421815835|0)<<11|a>>>21)+i|0)^i^s)+e[15]+530742520|0)<<16|r>>>16)+a|0)^a^i)+e[2]-995338651|0)<<23|s>>>9)+r|0,s=((s+=((a=((a+=(s^((i=((i+=(r^(s|~a))+e[0]-198630844|0)<<6|i>>>26)+s|0)|~r))+e[7]+1126891415|0)<<10|a>>>22)+i|0)^((r=((r+=(i^(a|~s))+e[14]-1416354905|0)<<15|r>>>17)+a|0)|~i))+e[5]-57434055|0)<<21|s>>>11)+r|0,s=((s+=((a=((a+=(s^((i=((i+=(r^(s|~a))+e[12]+1700485571|0)<<6|i>>>26)+s|0)|~r))+e[3]-1894986606|0)<<10|a>>>22)+i|0)^((r=((r+=(i^(a|~s))+e[10]-1051523|0)<<15|r>>>17)+a|0)|~i))+e[1]-2054922799|0)<<21|s>>>11)+r|0,s=((s+=((a=((a+=(s^((i=((i+=(r^(s|~a))+e[8]+1873313359|0)<<6|i>>>26)+s|0)|~r))+e[15]-30611744|0)<<10|a>>>22)+i|0)^((r=((r+=(i^(a|~s))+e[6]-1560198380|0)<<15|r>>>17)+a|0)|~i))+e[13]+1309151649|0)<<21|s>>>11)+r|0,s=((s+=((a=((a+=(s^((i=((i+=(r^(s|~a))+e[4]-145523070|0)<<6|i>>>26)+s|0)|~r))+e[11]-1120210379|0)<<10|a>>>22)+i|0)^((r=((r+=(i^(a|~s))+e[2]+718787259|0)<<15|r>>>17)+a|0)|~i))+e[9]-343485551|0)<<21|s>>>11)+r|0,t[0]=i+t[0]|0,t[1]=s+t[1]|0,t[2]=r+t[2]|0,t[3]=a+t[3]|0}function a(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return i}const n=new Uint32Array([1732584193,-271733879,-1732584194,271733878]);class o extends s.Vw{constructor(){super(...arguments),this.blockLen=64,this.outputLen=16,this._buffer=new Uint8Array}digest(){const t=function(t){var e,i,s,o,d,c,h=t.length,l=new Uint32Array(n);for(e=64;e<=h;e+=64)r(l,a(t.subarray(e-64,e)));for(i=(t=e-64<h?t.subarray(e-64):new Uint8Array(0)).length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)s[e>>2]|=t[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(r(l,s),e=0;e<16;e+=1)s[e]=0;o=(o=8*h).toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(o[2],16),c=parseInt(o[1],16)||0,s[14]=d,s[15]=c,r(l,s);const u=new Uint8Array(4*l.length);for(let t=0;t<s.length;t++){const e=4*t;u[e]=255&l[t],u[e+1]=l[t]>>8&255,u[e+2]=l[t]>>16&255,u[e+3]=l[t]>>24}return u}(this._buffer);return this.destroy(),t}digestInto(t){const e=this.digest();for(let i=0;i<e.length;i++)t[i]=e[i]}_cloneInto(t){return this}destroy(){this._buffer=new Uint8Array}update(t){return this._buffer=(0,s.Id)(this._buffer,(0,s.ZJ)(t)),this}}let d;d=(0,s.ld)(()=>new o)},4176(t,e,i){"use strict";i.d(e,{AU:()=>E,Q7:()=>A,Ue:()=>x,Yx:()=>k,mP:()=>M});var s,r,a,n,o,d,c,h,l,u,p,f,m,g=i(3867),y=i(1420),v=i(1768),b=i(9654),w=function(t,e,i,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(t,i):r?r.value=i:e.set(t,i),i},S=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};const k=32,O=new Uint8Array(k),T=["then"],P={};function _(t,e){const i=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw i.error=e,i}class A extends Array{constructor(...t){const e=t[0];let i=t[1],r=(t[2]||[]).slice(),a=!0;e!==P&&(i=t,r=[],a=!1),super(i.length),s.set(this,void 0),i.forEach((t,e)=>{this[e]=t});const n=r.reduce((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t),new Map);if(w(this,s,Object.freeze(i.map((t,e)=>{const i=r[e];return null!=i&&1===n.get(i)?i:null})),"f"),a)return Object.freeze(this),new Proxy(this,{get:(t,e,i)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const i=(0,v.WZ)(e,"%index");if(i<0||i>=this.length)throw new RangeError("out of result range");const s=t[i];return s instanceof Error&&_(`index ${i}`,s),s}if(T.indexOf(e)>=0)return Reflect.get(t,e,i);const s=t[e];if(s instanceof Function)return function(...e){return s.apply(this===i?t:this,e)};if(!(e in t))return t.getValue.apply(this===i?t:this,[e])}return Reflect.get(t,e,i)}})}toArray(){const t=[];return this.forEach((e,i)=>{e instanceof Error&&_(`index ${i}`,e),t.push(e)}),t}toObject(){return S(this,s,"f").reduce((t,e,i)=>((0,y.vA)(null!=e,"value at index ${ index } unnamed","UNSUPPORTED_OPERATION",{operation:"toObject()"}),e in t||(t[e]=this.getValue(e)),t),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const i=[],r=[];for(let a=t;a<e;a++)i.push(this[a]),r.push(S(this,s,"f")[a]);return new A(P,i,r)}filter(t,e){const i=[],r=[];for(let a=0;a<this.length;a++){const n=this[a];n instanceof Error&&_(`index ${a}`,n),t.call(e,n,a,this)&&(i.push(n),r.push(S(this,s,"f")[a]))}return new A(P,i,r)}map(t,e){const i=[];for(let s=0;s<this.length;s++){const r=this[s];r instanceof Error&&_(`index ${s}`,r),i.push(t.call(e,r,s,this))}return i}getValue(t){const e=S(this,s,"f").indexOf(t);if(-1===e)return;const i=this[e];return i instanceof Error&&_(`property ${JSON.stringify(t)}`,i.error),i}static fromItems(t,e){return new A(P,t,e)}}function I(t){let e=(0,v.c4)(t);return(0,y.vA)(e.length<=k,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:k,offset:e.length}),e.length!==k&&(e=(0,g.Lm)((0,g.xW)([O.slice(e.length%k),e]))),e}s=new WeakMap;class x{constructor(t,e,i,s){(0,b.n)(this,{name:t,type:e,localName:i,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){(0,y.MR)(!1,t,this.localName,e)}}class E{constructor(){r.add(this),a.set(this,void 0),n.set(this,void 0),w(this,a,[],"f"),w(this,n,0,"f")}get data(){return(0,g.xW)(S(this,a,"f"))}get length(){return S(this,n,"f")}appendWriter(t){return S(this,r,"m",o).call(this,(0,g.Lm)(t.data))}writeBytes(t){let e=(0,g.Lm)(t);const i=e.length%k;return i&&(e=(0,g.Lm)((0,g.xW)([e,O.slice(i)]))),S(this,r,"m",o).call(this,e)}writeValue(t){return S(this,r,"m",o).call(this,I(t))}writeUpdatableValue(){const t=S(this,a,"f").length;return S(this,a,"f").push(O),w(this,n,S(this,n,"f")+k,"f"),e=>{S(this,a,"f")[t]=I(e)}}}a=new WeakMap,n=new WeakMap,r=new WeakSet,o=function(t){return S(this,a,"f").push(t),w(this,n,S(this,n,"f")+t.length,"f"),t.length};class M{constructor(t,e,i){d.add(this),c.set(this,void 0),h.set(this,void 0),l.set(this,void 0),u.set(this,void 0),p.set(this,void 0),(0,b.n)(this,{allowLoose:!!e}),w(this,c,(0,g.Lm)(t),"f"),w(this,l,0,"f"),w(this,u,null,"f"),w(this,p,null!=i?i:1024,"f"),w(this,h,0,"f")}get data(){return(0,g.c$)(S(this,c,"f"))}get dataLength(){return S(this,c,"f").length}get consumed(){return S(this,h,"f")}get bytes(){return new Uint8Array(S(this,c,"f"))}subReader(t){const e=new M(S(this,c,"f").slice(S(this,h,"f")+t),this.allowLoose,S(this,p,"f"));return w(e,u,this,"f"),e}readBytes(t,e){let i=S(this,d,"m",m).call(this,0,t,!!e);return S(this,d,"m",f).call(this,t),w(this,h,S(this,h,"f")+i.length,"f"),i.slice(0,t)}readValue(){return(0,v.Dg)(this.readBytes(k))}readIndex(){return(0,v.Ro)(this.readBytes(k))}}c=new WeakMap,h=new WeakMap,l=new WeakMap,u=new WeakMap,p=new WeakMap,d=new WeakSet,f=function t(e){var i;if(S(this,u,"f"))return S(i=S(this,u,"f"),d,"m",t).call(i,e);w(this,l,S(this,l,"f")+e,"f"),(0,y.vA)(S(this,p,"f")<1||S(this,l,"f")<=S(this,p,"f")*this.dataLength,`compressed ABI data exceeds inflation ratio of ${S(this,p,"f")} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:(0,g.Lm)(S(this,c,"f")),offset:S(this,h,"f"),length:e,info:{bytesRead:S(this,l,"f"),dataLength:this.dataLength}})},m=function(t,e,i){let s=Math.ceil(e/k)*k;return S(this,h,"f")+s>S(this,c,"f").length&&(this.allowLoose&&i&&S(this,h,"f")+e<=S(this,c,"f").length?s=e:(0,y.vA)(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:(0,g.Lm)(S(this,c,"f")),length:S(this,c,"f").length,offset:S(this,h,"f")+s})),S(this,c,"f").slice(S(this,h,"f"),S(this,h,"f")+s)}},4350(t,e,i){"use strict";i.d(e,{HM:()=>N,Wt:()=>R});var s=Uint8Array,r=Uint16Array,a=Uint32Array,n=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var i=new r(31),s=0;s<31;++s)i[s]=e+=1<<t[s-1];var n=new a(i[30]);for(s=1;s<30;++s)for(var o=i[s];o<i[s+1];++o)n[o]=o-i[s]<<5|s;return[i,n]},h=c(n,2),l=h[0],u=h[1];l[28]=258,u[258]=28;for(var p=c(o,0),f=p[0],m=(p[1],new r(32768)),g=0;g<32768;++g){var y=(43690&g)>>>1|(21845&g)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,m[g]=((65280&y)>>>8|(255&y)<<8)>>>1}var v=function(t,e,i){for(var s=t.length,a=0,n=new r(e);a<s;++a)t[a]&&++n[t[a]-1];var o,d=new r(e);for(a=0;a<e;++a)d[a]=d[a-1]+n[a-1]<<1;if(i){o=new r(1<<e);var c=15-e;for(a=0;a<s;++a)if(t[a])for(var h=a<<4|t[a],l=e-t[a],u=d[t[a]-1]++<<l,p=u|(1<<l)-1;u<=p;++u)o[m[u]>>>c]=h}else for(o=new r(s),a=0;a<s;++a)t[a]&&(o[a]=m[d[t[a]-1]++]>>>15-t[a]);return o},b=new s(288);for(g=0;g<144;++g)b[g]=8;for(g=144;g<256;++g)b[g]=9;for(g=256;g<280;++g)b[g]=7;for(g=280;g<288;++g)b[g]=8;var w=new s(32);for(g=0;g<32;++g)w[g]=5;var S=v(b,9,1),k=v(w,5,1),O=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},T=function(t,e,i){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(7&e)&i},P=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},_=function(t){return(t+7)/8|0},A=function(t,e,i){(null==e||e<0)&&(e=0),(null==i||i>t.length)&&(i=t.length);var n=new(2==t.BYTES_PER_ELEMENT?r:4==t.BYTES_PER_ELEMENT?a:s)(i-e);return n.set(t.subarray(e,i)),n},I=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],x=function(t,e,i){var s=new Error(e||I[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,x),!i)throw s;return s},E=function(t,e,i){var r=t.length;if(!r||i&&i.f&&!i.l)return e||new s(0);var a=!e||i,c=!i||i.i;i||(i={}),e||(e=new s(3*r));var h=function(t){var i=e.length;if(t>i){var r=new s(Math.max(2*i,t));r.set(e),e=r}},u=i.f||0,p=i.p||0,m=i.b||0,g=i.l,y=i.d,b=i.m,w=i.n,I=8*r;do{if(!g){u=T(t,p,1);var E=T(t,p+1,3);if(p+=3,!E){var M=t[(j=_(p)+4)-4]|t[j-3]<<8,C=j+M;if(C>r){c&&x(0);break}a&&h(m+M),e.set(t.subarray(j,C),m),i.b=m+=M,i.p=p=8*C,i.f=u;continue}if(1==E)g=S,y=k,b=9,w=5;else if(2==E){var B=T(t,p,31)+257,N=T(t,p+10,15)+4,R=B+T(t,p+5,31)+1;p+=14;for(var L=new s(R),D=new s(19),q=0;q<N;++q)D[d[q]]=T(t,p+3*q,7);p+=3*N;var F=O(D),V=(1<<F)-1,U=v(D,F,1);for(q=0;q<R;){var j,G=U[T(t,p,V)];if(p+=15&G,(j=G>>>4)<16)L[q++]=j;else{var H=0,W=0;for(16==j?(W=3+T(t,p,3),p+=2,H=L[q-1]):17==j?(W=3+T(t,p,7),p+=3):18==j&&(W=11+T(t,p,127),p+=7);W--;)L[q++]=H}}var z=L.subarray(0,B),K=L.subarray(B);b=O(z),w=O(K),g=v(z,b,1),y=v(K,w,1)}else x(1);if(p>I){c&&x(0);break}}a&&h(m+131072);for(var Y=(1<<b)-1,Z=(1<<w)-1,$=p;;$=p){var Q=(H=g[P(t,p)&Y])>>>4;if((p+=15&H)>I){c&&x(0);break}if(H||x(2),Q<256)e[m++]=Q;else{if(256==Q){$=p,g=null;break}var X=Q-254;if(Q>264){var J=n[q=Q-257];X=T(t,p,(1<<J)-1)+l[q],p+=J}var tt=y[P(t,p)&Z],et=tt>>>4;tt||x(3),p+=15&tt;K=f[et];if(et>3){J=o[et];K+=P(t,p)&(1<<J)-1,p+=J}if(p>I){c&&x(0);break}a&&h(m+131072);for(var it=m+X;m<it;m+=4)e[m]=e[m-K],e[m+1]=e[m+1-K],e[m+2]=e[m+2-K],e[m+3]=e[m+3-K];m=it}}i.l=g,i.p=$,i.b=m,i.f=u,g&&(u=1,i.m=b,i.d=y,i.n=w)}while(!u);return m==e.length?e:A(e,0,m)},M=new s(0),C=function(t){31==t[0]&&139==t[1]&&8==t[2]||x(6,"invalid gzip data");var e=t[3],i=10;4&e&&(i+=t[10]|2+(t[11]<<8));for(var s=(e>>3&1)+(e>>4&1);s>0;s-=!t[i++]);return i+(2&e)},B=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0};function N(t,e=void 0){return E(t,e)}function R(t,e=void 0){return E(t.subarray(C(t),-8),e||new s(B(t)))}var L="undefined"!=typeof TextDecoder&&new TextDecoder;try{L.decode(M,{stream:!0})}catch(t){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout},4365(t,e,i){"use strict";i.d(e,{A:()=>m});var s=i(3283),r=i(274),a=i(178),n=i(1686),o=i(7925),d=i(2256),c=i(5307),h=i(9620),l=i(1668),u=i(7593);function p(t,e){switch(!0){case s.is.isAbiType(t):return new s.is(e).toApiRequest();case r.Ns.isAbiType(t):return new r.Ns(e).toApiRequest();case(0,c.gr)(t):return(0,o.Mu)(e.toString());case(0,c.Z$)(t):{const t=(0,a.ow)((0,n.nj)(e)).padStart(128,"0"),i=(0,c.iN)((0,a.VO)(t.slice(-64))),s=(0,c.iN)((0,a.VO)(t.slice(0,-64)));return[(0,c.AB)(s.low),(0,c.AB)(s.high),(0,c.AB)(i.low),(0,c.AB)(i.high)]}default:return(0,c.AB)(e)}}function f(t,e,i,a){if(void 0===t)throw Error(`Missing parameter for type ${e}`);if(Array.isArray(t)){const s=[];s.push((0,c.AB)(t.length));const r=(0,c.CS)(e);return t.reduce((t,e)=>t.concat(f(e,r,i,a)),s)}if(i[e]&&i[e].members.length){if(s.is.isAbiType(e))return new s.is(t).toApiRequest();if(r.Ns.isAbiType(e))return new r.Ns(t).toApiRequest();if("core::starknet::eth_address::EthAddress"===e)return p(e,t);if("core::byte_array::ByteArray"===e)return function(t){const e=(0,d.p)(t);return[e.data.length.toString(),...e.data.map(t=>t.toString()),e.pending_word.toString(),e.pending_word_len.toString()]}(t);const{members:n}=i[e],o=t;return n.reduce((t,e)=>t.concat(f(o[e.name],e.type,i,a)),[])}if((0,c.Zm)(e)){const s=function(t,e){const i=(0,u.A)(e),s=Object.values(t);if(s.length!==i.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.\n      provided: ${s} \n      expected: ${i}`);return i.map((t,e)=>({element:s[e],type:t.type??t}))}(t,e);return s.reduce((t,e)=>{const s=f(e.element,e.type,i,a);return t.concat(s)},[])}if(s.is.isAbiType(e))return new s.is(t).toApiRequest();if(r.Ns.isAbiType(e))return new r.Ns(t).toApiRequest();if((0,c.iO)(e,a)){const{variants:s}=a[e];if((0,c.e4)(e)){const e=t;if(e.isSome()){const t=s.find(t=>"Some"===t.name);if(void 0===t)throw Error("Error in abi : Option has no 'Some' variant.");const r=t.type;if("()"===r)return h.R.Some.toString();const n=f(e.unwrap(),r,i,a);return Array.isArray(n)?[h.R.Some.toString(),...n]:[h.R.Some.toString(),n]}return h.R.None.toString()}if((0,c.u)(e)){const e=t;if(e.isOk()){const t=s.find(t=>"Ok"===t.name);if(void 0===t)throw Error("Error in abi : Result has no 'Ok' variant.");const r=t.type;if("()"===r)return l.B.Ok.toString();const n=f(e.unwrap(),r,i,a);return Array.isArray(n)?[l.B.Ok.toString(),...n]:[l.B.Ok.toString(),n]}const r=s.find(t=>"Err"===t.name);if(void 0===r)throw Error("Error in abi : Result has no 'Err' variant.");const n=r.type;if("()"===n)return l.B.Err.toString();const o=f(e.unwrap(),n,i,a);return Array.isArray(o)?[l.B.Err.toString(),...o]:[l.B.Err.toString(),o]}const r=t,n=r.activeVariant(),o=s.find(t=>t.name===n);if(void 0===o)throw Error(`Not find in abi : Enum has no '${n}' variant.`);const d=o.type,u=s.findIndex(t=>t.name===n);if("()"===d)return u.toString();const p=f(r.unwrap(),d,i,a);return Array.isArray(p)?[u.toString(),...p]:[u.toString(),p]}if("object"==typeof t)throw Error(`Parameter ${t} do not align with abi parameter ${e}`);return p(e,t)}function m(t,e,i,r){const{name:a,type:n}=e;let{value:d}=t.next();switch(!0){case(0,c.G$)(n):if(!Array.isArray(d)&&!(0,o.KH)(d))throw Error(`ABI expected parameter ${a} to be array or long string, got ${d}`);return(0,o.Kg)(d)&&(d=(0,o.mE)(d)),f(d,e.type,i,r);case"core::starknet::eth_address::EthAddress"===n:return p(n,d);case(0,c.wJ)(n,i)||(0,c.Zm)(n)||s.is.isAbiType(n)||s.is.isAbiType(n):case(0,c.iO)(n,r):return f(d,n,i,r);default:return p(n,d)}}},4380(t,e,i){"use strict";i.d(e,{z:()=>M});var s,r,a,n,o,d=i(2014),c=i(4815),h=i(3867),l=i(1420),u=i(1768),p=i(9654),f=i(5095),m=function(t,e,i,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(t,i):r?r.value=i:e.set(t,i),i},g=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};const{base16ToBinary:y}=f,v=new Uint8Array(32);v.fill(0);const b=BigInt(-1),w=BigInt(0),S=BigInt(1),k=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const O=(0,u.up)(S,32),T=(0,u.up)(w,32),P={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},_=["name","version","chainId","verifyingContract","salt"];function A(t){return function(e){return(0,l.MR)("string"==typeof e,`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const I={name:A("name"),version:A("version"),chainId:function(t){const e=(0,u.Ab)(t,"domain.chainId");return(0,l.MR)(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):(0,u.nD)(e)},verifyingContract:function(t){try{return(0,d.b)(t).toLowerCase()}catch(t){}(0,l.MR)(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=(0,h.q5)(t,"domain.salt");return(0,l.MR)(32===e.length,'invalid domain value "salt"',"domain.salt",t),(0,h.c$)(e)}};function x(t){{const e=t.match(/^(u?)int(\d*)$/);if(e){const i=""===e[1],s=parseInt(e[2]||"256");(0,l.MR)(s%8==0&&0!==s&&s<=256&&(null==e[2]||e[2]===String(s)),"invalid numeric width","type",t);const r=(0,u.dK)(k,i?s-1:s),a=i?(r+S)*b:w;return function(e){const s=(0,u.Ab)(e,"value");return(0,l.MR)(s>=a&&s<=r,`value out-of-bounds for ${t}`,"value",s),(0,u.up)(i?(0,u.JJ)(s,256):s,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const i=parseInt(e[1]);return(0,l.MR)(0!==i&&i<=32&&e[1]===String(i),"invalid bytes width","type",t),function(e){const s=(0,h.q5)(e);return(0,l.MR)(s.length===i,`invalid length for ${t}`,"value",e),function(t){const e=(0,h.q5)(t),i=e.length%32;return i?(0,h.xW)([e,v.slice(i)]):(0,h.c$)(e)}(e)}}}switch(t){case"address":return function(t){return(0,h.nx)((0,d.b)(t),32)};case"bool":return function(t){return t?O:T};case"bytes":return function(t){return(0,c.So)(t)};case"string":return function(t){return(0,c.id)(t)}}return null}function E(t,e){return`${t}(${e.map(({name:t,type:e})=>e+" "+t).join(",")})`}class M{constructor(t){s.add(this),r.set(this,void 0),a.set(this,void 0),n.set(this,void 0),m(this,r,JSON.stringify(t),"f"),m(this,a,new Map,"f"),m(this,n,new Map,"f");const e=new Map,i=new Map,o=new Map;Object.keys(t).forEach(t=>{e.set(t,new Set),i.set(t,[]),o.set(t,new Set)});for(const s in t){const r=new Set;for(const a of t[s]){(0,l.MR)(!r.has(a.name),`duplicate variable name ${JSON.stringify(a.name)} in ${JSON.stringify(s)}`,"types",t),r.add(a.name);const n=a.type.match(/^([^\x5b]*)(\x5b|$)/)[1]||null;(0,l.MR)(n!==s,`circular type reference to ${JSON.stringify(n)}`,"types",t);x(n)||((0,l.MR)(i.has(n),`unknown type ${JSON.stringify(n)}`,"types",t),i.get(n).push(s),e.get(s).add(n))}}const d=Array.from(i.keys()).filter(t=>0===i.get(t).length);(0,l.MR)(0!==d.length,"missing primary type","types",t),(0,l.MR)(1===d.length,`ambiguous primary types or unused types: ${d.map(t=>JSON.stringify(t)).join(", ")}`,"types",t),(0,p.n)(this,{primaryType:d[0]}),function s(r,a){(0,l.MR)(!a.has(r),`circular type reference to ${JSON.stringify(r)}`,"types",t),a.add(r);for(const t of e.get(r))if(i.has(t)){s(t,a);for(const e of a)o.get(e).add(t)}a.delete(r)}(this.primaryType,new Set);for(const[e,i]of o){const s=Array.from(i);s.sort(),g(this,a,"f").set(e,E(e,t[e])+s.map(e=>E(e,t[e])).join(""))}}get types(){return JSON.parse(g(this,r,"f"))}getEncoder(t){let e=g(this,n,"f").get(t);return e||(e=g(this,s,"m",o).call(this,t),g(this,n,"f").set(t,e)),e}encodeType(t){const e=g(this,a,"f").get(t);return(0,l.MR)(e,`unknown type: ${JSON.stringify(t)}`,"name",t),e}encodeData(t,e){return this.getEncoder(t)(e)}hashStruct(t,e){return(0,c.So)(y(this.encodeData(t,e).slice(2)))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,e,i){if(x(t))return i(t,e);const s=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(s)return(0,l.MR)(!s[3]||parseInt(s[3])===e.length,`array length mismatch; expected length ${parseInt(s[3])}`,"value",e),e.map(t=>this._visit(s[1],t,i));const r=this.types[t];if(r)return r.reduce((t,{name:s,type:r})=>(t[s]=this._visit(r,e[s],i),t),{});(0,l.MR)(!1,`unknown type: ${t}`,"type",t)}visit(t,e){return this._visit(this.primaryType,t,e)}static from(t){return new M(t)}static getPrimaryType(t){return M.from(t).primaryType}static hashStruct(t,e,i){return M.from(e).hashStruct(t,i)}static hashDomain(t){const e=[];for(const i in t){if(null==t[i])continue;const s=P[i];(0,l.MR)(s,`invalid typed-data domain key: ${JSON.stringify(i)}`,"domain",t),e.push({name:i,type:s})}return e.sort((t,e)=>_.indexOf(t.name)-_.indexOf(e.name)),M.hashStruct("EIP712Domain",{EIP712Domain:e},t)}static encode(t,e,i){return(0,h.xW)(["0x1901",M.hashDomain(t),M.from(e).hash(i)])}static hash(t,e,i){return(0,c.So)(M.encode(t,e,i))}static async resolveNames(t,e,i,s){t=Object.assign({},t);for(const e in t)null==t[e]&&delete t[e];const r={};t.verifyingContract&&!(0,h.Lo)(t.verifyingContract,20)&&(r[t.verifyingContract]="0x");const a=M.from(e);a.visit(i,(t,e)=>("address"!==t||(0,h.Lo)(e,20)||(r[e]="0x"),e));for(const t in r)r[t]=await s(t);return t.verifyingContract&&r[t.verifyingContract]&&(t.verifyingContract=r[t.verifyingContract]),{domain:t,value:i=a.visit(i,(t,e)=>"address"===t&&r[e]?r[e]:e)}}static getPayload(t,e,i){M.hashDomain(t);const s={},r=[];_.forEach(e=>{const i=t[e];null!=i&&(s[e]=I[e](i),r.push({name:e,type:P[e]}))});const a=M.from(e),n=Object.assign({},e);return(0,l.MR)(null==n.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",e),n.EIP712Domain=r,a.encode(i),{types:n,domain:s,primaryType:a.primaryType,message:a.visit(i,(t,e)=>{if(t.match(/^bytes(\d*)/))return(0,h.c$)((0,h.q5)(e));if(t.match(/^u?int/))return(0,u.Ab)(e).toString();switch(t){case"address":return e.toLowerCase();case"bool":return!!e;case"string":return(0,l.MR)("string"==typeof e,"invalid string","value",e),e}(0,l.MR)(!1,"unsupported type","type",t)})}}}r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakSet,o=function(t){{const e=x(t);if(e)return e}const e=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(e){const t=e[1],i=this.getEncoder(t);return s=>{(0,l.MR)(!e[3]||parseInt(e[3])===s.length,`array length mismatch; expected length ${parseInt(e[3])}`,"value",s);let r=s.map(i);return g(this,a,"f").has(t)&&(r=r.map(c.So)),(0,c.So)((0,h.q5)((0,h.xW)(r)))}}const i=this.types[t];if(i){const e=(0,c.id)(g(this,a,"f").get(t));return t=>{const s=i.map(({name:e,type:i})=>{const s=this.getEncoder(i)(t[e]);return g(this,a,"f").has(i)?(0,c.So)(s):s});return s.unshift(e),(0,h.xW)(s)}}(0,l.MR)(!1,`unknown type: ${t}`,"type",t)}},4506(t,e,i){"use strict";i.d(e,{FL:()=>l,qj:()=>u});var s=i(1064),r=i(191);const a=r.Ph;function n(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const i=Array.from({length:e}).fill(0);for(let s=e-1;s>=0;s--)i[s]=255&t,t>>>=8;return new Uint8Array(i)}function o(t,e){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t[s]^e[s];return i}function d(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function c(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function h(t,e,i){(0,r.Q5)(i,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:h,k:l,m:u,hash:p,expand:f,DST:m}=i;d(t),c(e);const g=function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return(0,r.AI)(t);throw new Error("DST must be Uint8Array or string")}(m),y=h.toString(2).length,v=Math.ceil((y+l)/8),b=e*u*v;let w;if("xmd"===f)w=function(t,e,i,s){d(t),d(e),c(i),e.length>255&&(e=s((0,r.Id)((0,r.AI)("H2C-OVERSIZE-DST-"),e)));const{outputLen:a,blockLen:h}=s,l=Math.ceil(i/a);if(l>255)throw new Error("Invalid xmd length");const u=(0,r.Id)(e,n(e.length,1)),p=n(0,h),f=n(i,2),m=new Array(l),g=s((0,r.Id)(p,t,f,n(0,1),u));m[0]=s((0,r.Id)(g,n(1,1),u));for(let t=1;t<=l;t++){const e=[o(g,m[t-1]),n(t+1,1),u];m[t]=s((0,r.Id)(...e))}return(0,r.Id)(...m).slice(0,i)}(t,g,b,p);else if("xof"===f)w=function(t,e,i,s,a){if(d(t),d(e),c(i),e.length>255){const t=Math.ceil(2*s/8);e=a.create({dkLen:t}).update((0,r.AI)("H2C-OVERSIZE-DST-")).update(e).digest()}if(i>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return a.create({dkLen:i}).update(t).update(n(i,2)).update(e).update(n(e.length,1)).digest()}(t,g,b,l,p);else{if(void 0!==f)throw new Error('expand must be "xmd", "xof" or undefined');w=t}const S=new Array(e);for(let t=0;t<e;t++){const e=new Array(u);for(let i=0;i<u;i++){const r=v*(i+t*u),n=w.subarray(r,r+v);e[i]=(0,s.zi)(a(n),h)}S[t]=e}return S}function l(t,e){const i=e.map(t=>Array.from(t).reverse());return(e,s)=>{const[r,a,n,o]=i.map(i=>i.reduce((i,s)=>t.add(t.mul(i,e),s)));return e=t.div(r,a),s=t.mul(s,t.div(n,o)),{x:e,y:s}}}function u(t,e,i){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");return{hashToCurve(s,r){const a=h(s,2,{...i,DST:i.DST,...r}),n=t.fromAffine(e(a[0])),o=t.fromAffine(e(a[1])),d=n.add(o).clearCofactor();return d.assertValidity(),d},encodeToCurve(s,r){const a=h(s,1,{...i,DST:i.encodeDST,...r}),n=t.fromAffine(e(a[0])).clearCofactor();return n.assertValidity(),n}}}},4599(t,e,i){"use strict";i.d(e,{v:()=>n});var s=i(9436),r=i(9073),a=i(3287);class n extends a.i{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,(0,s.YW)(r.V.dereference(e,"string")))}decode(t){return(0,s._v)(super.decode(t))}}},4710(t,e,i){"use strict";
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function s(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function r(...t){const e=(t,e)=>i=>t(e(i));return{encode:Array.from(t).reverse().reduce((t,i)=>t?e(t,i.encode):i.encode,void 0),decode:t.reduce((t,i)=>t?e(t,i.decode):i.decode,void 0)}}function a(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map(e=>{if(s(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]})},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map(e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const i=t.indexOf(e);if(-1===i)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return i})}}}function n(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw new Error(`join.encode: non-string input=${t}`);return e.join(t)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(t)}}}function o(t,e="="){if(s(t),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(i){if(!Array.isArray(i)||i.length&&"string"!=typeof i[0])throw new Error("padding.encode input should be array of strings");for(let t of i)if("string"!=typeof t)throw new Error(`padding.encode: non-string input=${t}`);for(;i.length*t%8;)i.push(e);return i},decode(i){if(!Array.isArray(i)||i.length&&"string"!=typeof i[0])throw new Error("padding.encode input should be array of strings");for(let t of i)if("string"!=typeof t)throw new Error(`padding.decode: non-string input=${t}`);let s=i.length;if(s*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;s>0&&i[s-1]===e;s--)if(!((s-1)*t%8))throw new Error("Invalid padding: string has too much padding");return i.slice(0,s)}}}function d(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:t=>t,decode:e=>t(e)}}function c(t,e,i){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(i<2)throw new Error(`convertRadix: wrong to=${i}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const a=[],n=Array.from(t);for(n.forEach(t=>{if(s(t),t<0||t>=e)throw new Error(`Wrong integer: ${t}`)});;){let t=0,s=!0;for(let a=r;a<n.length;a++){const o=n[a],d=e*t+o;if(!Number.isSafeInteger(d)||e*t/e!==t||d-o!==e*t)throw new Error("convertRadix: carry overflow");if(t=d%i,n[a]=Math.floor(d/i),!Number.isSafeInteger(n[a])||n[a]*i+t!==d)throw new Error("convertRadix: carry overflow");s&&(n[a]?s=!1:r=a)}if(a.push(t),s)break}for(let e=0;e<t.length-1&&0===t[e];e++)a.push(0);return a.reverse()}i.d(e,{As:()=>I,K3:()=>w,RG:()=>b,Wp:()=>y,tw:()=>k,xn:()=>v});const h=(t,e)=>e?h(e,t%e):t,l=(t,e)=>t+(e-h(t,e));function u(t,e,i,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(i<=0||i>32)throw new Error(`convertRadix2: wrong to=${i}`);if(l(e,i)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${i} carryBits=${l(e,i)}`);let a=0,n=0;const o=2**i-1,d=[];for(const r of t){if(s(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(a=a<<e|r,n+e>32)throw new Error(`convertRadix2: carry overflow pos=${n} from=${e}`);for(n+=e;n>=i;n-=i)d.push((a>>n-i&o)>>>0);a&=2**n-1}if(a=a<<i-n&o,!r&&n>=e)throw new Error("Excess padding");if(!r&&a)throw new Error(`Non-zero padding: ${a}`);return r&&n>0&&d.push(a>>>0),d}function p(t){return s(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return c(Array.from(e),256,t)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(c(e,t,256))}}}function f(t,e=!1){if(s(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(l(8,t)>32||l(t,8)>32)throw new Error("radix2: carry overflow");return{encode:i=>{if(!(i instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return u(Array.from(i),8,t,!e)},decode:i=>{if(!Array.isArray(i)||i.length&&"number"!=typeof i[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(u(i,t,8,e))}}}function m(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch(t){}}}function g(t,e){if(s(t),"function"!=typeof e)throw new Error("checksum fn should be function");return{encode(i){if(!(i instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const s=e(i).slice(0,t),r=new Uint8Array(i.length+t);return r.set(i),r.set(s,i.length),r},decode(i){if(!(i instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const s=i.slice(0,-t),r=e(s).slice(0,t),a=i.slice(-t);for(let e=0;e<t;e++)if(r[e]!==a[e])throw new Error("Invalid checksum");return s}}}const y={alphabet:a,chain:r,checksum:g,radix:p,radix2:f,join:n,padding:o},v=r(f(4),a("0123456789abcdef"),n("")),b=r(f(5),a("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o(5),n("")),w=(r(f(5),a("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o(5),n("")),r(f(5),a("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),n(""),d(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),r(f(6),a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o(6),n(""))),S=(r(f(6),a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(6),n("")),t=>r(p(58),a(t),n(""))),k=S("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),O=(S("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),S("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),r(a("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),n(""))),T=[996825010,642813549,513874426,1027748829,705979059];function P(t){const e=t>>25;let i=(33554431&t)<<5;for(let t=0;t<T.length;t++)1==(e>>t&1)&&(i^=T[t]);return i}function _(t,e,i=1){const s=t.length;let r=1;for(let e=0;e<s;e++){const i=t.charCodeAt(e);if(i<33||i>126)throw new Error(`Invalid prefix (${t})`);r=P(r)^i>>5}r=P(r);for(let e=0;e<s;e++)r=P(r)^31&t.charCodeAt(e);for(let t of e)r=P(r)^t;for(let t=0;t<6;t++)r=P(r);return r^=i,O.encode(u([r%2**30],30,5,!1))}function A(t){const e="bech32"===t?1:734539939,i=f(5),s=i.decode,r=i.encode,a=m(s);function n(t,i=90){if("string"!=typeof t)throw new Error("bech32.decode input should be string, not "+typeof t);if(t.length<8||!1!==i&&t.length>i)throw new TypeError(`Wrong string length: ${t.length} (${t}). Expected (8..${i})`);const s=t.toLowerCase();if(t!==s&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const r=(t=s).lastIndexOf("1");if(0===r||-1===r)throw new Error('Letter "1" must be present between prefix and data only');const a=t.slice(0,r),n=t.slice(r+1);if(n.length<6)throw new Error("Data must be at least 6 characters long");const o=O.decode(n).slice(0,-6),d=_(a,o,e);if(!n.endsWith(d))throw new Error(`Invalid checksum in ${t}: expected "${d}"`);return{prefix:a,words:o}}return{encode:function(t,i,s=90){if("string"!=typeof t)throw new Error("bech32.encode prefix should be string, not "+typeof t);if(!Array.isArray(i)||i.length&&"number"!=typeof i[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof i);const r=t.length+7+i.length;if(!1!==s&&r>s)throw new TypeError(`Length ${r} exceeds limit ${s}`);return`${t=t.toLowerCase()}1${O.encode(i)}${_(t,i,e)}`},decode:n,decodeToBytes:function(t){const{prefix:e,words:i}=n(t,!1);return{prefix:e,words:i,bytes:s(i)}},decodeUnsafe:m(n),fromWords:s,fromWordsUnsafe:a,toWords:r}}A("bech32"),A("bech32m");const I={encode:t=>(new TextDecoder).decode(t),decode:t=>(new TextEncoder).encode(t)};r(f(4),a("0123456789abcdef"),n(""),d(t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}))},4782(t,e,i){"use strict";i.d(e,{n:()=>h});var s=i(1064),r=i(191),a=i(7517);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const n=BigInt(0),o=BigInt(1),d=BigInt(2),c=BigInt(8);function h(t){const e=function(t){const e=(0,a.h)(t);return r.Q5(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:i,n:h,preHash:l,hash:u,randomBytes:p,nByteLength:f,h:m}=e,g=d**BigInt(8*f),y=i.create,v=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:i.sqrt(t*i.inv(e))}}catch(t){return{isValid:!1,value:n}}}),b=e.adjustScalarBytes||(t=>t),w=e.domain||((t,e,i)=>{if(e.length||i)throw new Error("Contexts/pre-hash are not supported");return t}),S=t=>"bigint"==typeof t&&0n<t,k=(t,e)=>S(t)&&S(e)&&t<e,O=t=>t===n||k(t,g);function T(t,e){if(k(t,e))return t;throw new Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function P(t){return t===n?t:T(t,h)}const _=new Map;function A(t){if(!(t instanceof I))throw new Error("ExtendedPoint expected")}class I{constructor(t,e,i,s){if(this.ex=t,this.ey=e,this.ez=i,this.et=s,!O(t))throw new Error("x required");if(!O(e))throw new Error("y required");if(!O(i))throw new Error("z required");if(!O(s))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof I)throw new Error("extended point not allowed");const{x:e,y:i}=t||{};if(!O(e)||!O(i))throw new Error("invalid affine point");return new I(e,i,o,y(e*i))}static normalizeZ(t){const e=i.invertBatch(t.map(t=>t.ez));return t.map((t,i)=>t.toAffine(e[i])).map(I.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,_.delete(this)}assertValidity(){const{a:t,d:i}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:s,ey:r,ez:a,et:n}=this,o=y(s*s),d=y(r*r),c=y(a*a),h=y(c*c),l=y(o*t);if(y(c*y(l+d))!==y(h+y(i*y(o*d))))throw new Error("bad point: equation left != right (1)");if(y(s*r)!==y(a*n))throw new Error("bad point: equation left != right (2)")}equals(t){A(t);const{ex:e,ey:i,ez:s}=this,{ex:r,ey:a,ez:n}=t,o=y(e*n),d=y(r*s),c=y(i*n),h=y(a*s);return o===d&&c===h}is0(){return this.equals(I.ZERO)}negate(){return new I(y(-this.ex),this.ey,this.ez,y(-this.et))}double(){const{a:t}=e,{ex:i,ey:s,ez:r}=this,a=y(i*i),n=y(s*s),o=y(d*y(r*r)),c=y(t*a),h=i+s,l=y(y(h*h)-a-n),u=c+n,p=u-o,f=c-n,m=y(l*p),g=y(u*f),v=y(l*f),b=y(p*u);return new I(m,g,b,v)}add(t){A(t);const{a:i,d:s}=e,{ex:r,ey:a,ez:o,et:c}=this,{ex:h,ey:l,ez:u,et:p}=t;if(i===BigInt(-1)){const t=y((a-r)*(l+h)),e=y((a+r)*(l-h)),i=y(e-t);if(i===n)return this.double();const s=y(o*d*p),f=y(c*d*u),m=f+s,g=e+t,v=f-s,b=y(m*i),w=y(g*v),S=y(m*v),k=y(i*g);return new I(b,w,k,S)}const f=y(r*h),m=y(a*l),g=y(c*s*p),v=y(o*u),b=y((r+a)*(h+l)-f-m),w=v-g,S=v+g,k=y(m-i*f),O=y(b*w),T=y(S*k),P=y(b*k),_=y(w*S);return new I(O,T,_,P)}subtract(t){return this.add(t.negate())}wNAF(t){return M.wNAFCached(this,_,t,I.normalizeZ)}multiply(t){const{p:e,f:i}=this.wNAF(T(t,h));return I.normalizeZ([e,i])[0]}multiplyUnsafe(t){let e=P(t);return e===n?E:this.equals(E)||e===o?this:this.equals(x)?this.wNAF(e).p:M.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(m).is0()}isTorsionFree(){return M.unsafeLadder(this,h).is0()}toAffine(t){const{ex:e,ey:s,ez:r}=this,a=this.is0();null==t&&(t=a?c:i.inv(r));const d=y(e*t),h=y(s*t),l=y(r*t);if(a)return{x:n,y:o};if(l!==o)throw new Error("invZ was invalid");return{x:d,y:h}}clearCofactor(){const{h:t}=e;return t===o?this:this.multiplyUnsafe(t)}static fromHex(t,s=!0){const{d:a,a:d}=e,c=i.BYTES,h=(t=(0,r.qj)("pointHex",t,c)).slice(),l=t[c-1];h[c-1]=-129&l;const u=r.lX(h);u===n||T(u,s?i.ORDER:g);const p=y(u*u),f=y(p-o),m=y(a*p-d);let{isValid:b,value:w}=v(f,m);if(!b)throw new Error("Point.fromHex: invalid y coordinate");return!!(128&l)!==((w&o)===o)&&(w=y(-w)),I.fromAffine({x:w,y:u})}static fromPrivateKey(t){return N(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),s=r.z(e,i.BYTES);return s[s.length-1]|=t&o?128:0,s}toHex(){return r.My(this.toRawBytes())}}I.BASE=new I(e.Gx,e.Gy,o,y(e.Gx*e.Gy)),I.ZERO=new I(n,o,o,n);const{BASE:x,ZERO:E}=I,M=(0,a.A)(I,8*f);function C(t){return(0,s.zi)(t,h)}function B(t){return C(r.lX(t))}function N(t){const e=f;t=(0,r.qj)("private key",t,e);const i=(0,r.qj)("hashed private key",u(t),2*e),s=b(i.slice(0,e)),a=i.slice(e,2*e),n=B(s),o=x.multiply(n),d=o.toRawBytes();return{head:s,prefix:a,scalar:n,point:o,pointBytes:d}}function R(t=new Uint8Array,...e){const i=r.Id(...e);return B(u(w(i,(0,r.qj)("context",t),!!l)))}x._setWindowSize(8);return{CURVE:e,getPublicKey:function(t){return N(t).pointBytes},sign:function(t,e,s){t=(0,r.qj)("message",t),l&&(t=l(t));const{prefix:a,scalar:n,pointBytes:o}=N(e),d=R(s,a,t),c=x.multiply(d).toRawBytes(),h=C(d+R(s,c,o,t)*n);P(h);const u=r.Id(c,r.z(h,i.BYTES));return(0,r.qj)("result",u,2*f)},signModified:function(t,e,s){t=(0,r.qj)("message",t);const a=(0,r.qj)("privKey",e),n=r.lX(a),o=x.multiply(C(n)).toRawBytes(),d=128&o[31],c=R(s,a,t),h=x.multiply(c).toRawBytes(),l=C(c+R(s,h,o,t)*n);P(l);const u=r.z(l,i.BYTES);u[31]|=d;const p=r.Id(h,u);return(0,r.qj)("result",p,2*f)},verify:function(t,e,s,a){const n=i.BYTES;t=(0,r.qj)("signature",t,2*n),e=(0,r.qj)("message",e),l&&(e=l(e));const o=I.fromHex(s,!1),d=I.fromHex(t.slice(0,n),!1),c=r.lX(t.slice(n,2*n)),h=x.multiplyUnsafe(c),u=R(a,d.toRawBytes(),o.toRawBytes(),e);return d.add(o.multiplyUnsafe(u)).subtract(h).clearCofactor().equals(I.ZERO)},ExtendedPoint:I,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>p(i.BYTES),precompute:(t=8,e=I.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}},4815(t,e,i){"use strict";i.d(e,{So:()=>o,id:()=>n});var s=i(3867),r=i(8283),a=i(8432);function n(t){return"0x"+(0,r.tW)(t,a.lY,"hex")}function o(t){return(0,s.Lo)(t)?"0x"+(0,r.tW)((0,s.q5)(t),a.lY,"hex"):"0x"+(0,r.tW)(t,a.lY,"hex")}},4852(t,e,i){"use strict";i.d(e,{s:()=>u});var s=i(230),r=i(1094);const a=(t,e,i)=>t&e^~t&i,n=(t,e,i)=>t&e^t&i^e&i,o=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),d=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class h extends s.D{constructor(){super(64,32,8,!1),this.A=0|d[0],this.B=0|d[1],this.C=0|d[2],this.D=0|d[3],this.E=0|d[4],this.F=0|d[5],this.G=0|d[6],this.H=0|d[7]}get(){const{A:t,B:e,C:i,D:s,E:r,F:a,G:n,H:o}=this;return[t,e,i,s,r,a,n,o]}set(t,e,i,s,r,a,n,o){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|s,this.E=0|r,this.F=0|a,this.G=0|n,this.H=0|o}process(t,e){for(let i=0;i<16;i++,e+=4)c[i]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],i=c[t-2],s=(0,r.Ow)(e,7)^(0,r.Ow)(e,18)^e>>>3,a=(0,r.Ow)(i,17)^(0,r.Ow)(i,19)^i>>>10;c[t]=a+c[t-7]+s+c[t-16]|0}let{A:i,B:s,C:d,D:h,E:l,F:u,G:p,H:f}=this;for(let t=0;t<64;t++){const e=f+((0,r.Ow)(l,6)^(0,r.Ow)(l,11)^(0,r.Ow)(l,25))+a(l,u,p)+o[t]+c[t]|0,m=((0,r.Ow)(i,2)^(0,r.Ow)(i,13)^(0,r.Ow)(i,22))+n(i,s,d)|0;f=p,p=u,u=l,l=h+e|0,h=d,d=s,s=i,i=e+m|0}i=i+this.A|0,s=s+this.B|0,d=d+this.C|0,h=h+this.D|0,l=l+this.E|0,u=u+this.F|0,p=p+this.G|0,f=f+this.H|0,this.set(i,s,d,h,l,u,p,f)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends h{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const u=(0,r.ld)(()=>new h);(0,r.ld)(()=>new l)},4921(t,e,i){"use strict";i.d(e,{e:()=>a});var s=i(1686),r=i(7925);function a(t){if((0,s.sI)(t)||Number.isInteger(t))return t.toString();if((0,r.Kg)(t)){if((0,s.qv)(t))return BigInt(t).toString();if((0,r.KH)(t)){if(!(0,r.O4)(t))throw new Error(`${t} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt((0,r.Mu)(t)).toString()}if((0,s.A6)(t))return t}if((0,s.Lm)(t))return""+ +t;throw new Error(`${t} can't be computed by felt()`)}},4965(t,e,i){"use strict";i.d(e,{A:()=>n});var s=i(1397),r=i(2079),a=i(2931);class n extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,createOrderWs:!1,editOrderWs:!1,fetchOpenOrdersWs:!1,fetchOrderWs:!1,cancelOrderWs:!1,cancelOrdersWs:!1,cancelAllOrdersWs:!1,watchBidsAsks:!0,watchOrderBook:!0,watchOrders:!0,watchMyTrades:!0,watchTickers:!0,watchTicker:!0,watchTrades:!0,watchTradesForSymbols:!0,watchOrderBookForSymbols:!0,watchBalance:!0,watchOHLCV:!0,unWatchTicker:!0,unWatchOHLCV:!0,unWatchOrderBook:!0,unWatchTrades:!0,unWatchhTradesForSymbols:!0},options:{tradesLimit:1e3,watchTicker:{name:"market/snapshot"},watchOrderBook:{snapshotDelay:5,snapshotMaxRetries:3,method:"/market/level2"},watchMyTrades:{method:"/spotMarket/tradeOrders"}},streaming:{ping:this.ping}})}async negotiate(t,e={}){const i=t?"private":"public",s=this.safeValue(this.options,"urls",{});let r=this.safeValue(s,i);return void 0!==r||(s[i]=this.spawn(this.negotiateHelper,t,e),this.options.urls=s,r=s[i]),await r}async negotiateHelper(t,e={}){let i;const s=t?"private":"public";try{i=t?await this.privatePostBulletPrivate(e):await this.publicPostBulletPublic(e);const r=this.safeValue(i,"data",{}),a=this.safeValue(r,"instanceServers",[]),n=this.safeValue(a,0),o=this.safeInteger(n,"pingInterval"),d=this.safeString(n,"endpoint"),c=this.safeString(r,"token"),h=d+"?"+this.urlencode({token:c,privateChannel:t,connectId:s});return this.client(h).keepAlive=o,h}catch(t){this.safeValue(this.options.urls,s).reject(t),delete this.options.urls[s]}}requestId(){this.lockId();const t=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=t,this.unlockId(),t}async subscribe(t,e,i,s={},r=void 0){const a=this.requestId().toString(),n={id:a,type:"subscribe",topic:i,response:!0},o=this.extend(n,s),d=this.client(t);return i in d.subscriptions||(d.subscriptions[a]=i),await this.watch(t,e,o,i,r)}async unSubscribe(t,e,i,s,r={},a=void 0){return await this.unSubscribeMultiple(t,[e],i,[s],r,a)}async subscribeMultiple(t,e,i,s,r={},a=void 0){const n=this.requestId().toString(),o={id:n,type:"subscribe",topic:i,response:!0},d=this.extend(o,r),c=this.client(t);for(let t=0;t<s.length;t++){const e=s[t];e in c.subscriptions||(c.subscriptions[n]=e)}return await this.watchMultiple(t,e,d,s,a)}async unSubscribeMultiple(t,e,i,s,r={},a=void 0){const n=this.requestId().toString(),o={id:n,type:"unsubscribe",topic:i,response:!0},d=this.extend(o,r);void 0!==a&&(a[n]=n);const c=this.client(t);for(let t=0;t<s.length;t++){const e=s[t];e in c.subscriptions||(c.subscriptions[n]=e)}return await this.watchMultiple(t,e,d,s,a)}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t);t=i.symbol;const s=await this.negotiate(!1),[r,a]=this.handleOptionAndParams(e,"watchTicker","method","/market/snapshot"),n=r+":"+i.id,o="ticker:"+t;return await this.subscribe(s,o,n,a)}async unWatchTicker(t,e={}){await this.loadMarkets();const i=this.market(t);t=i.symbol;const s=await this.negotiate(!1);let r;[r,e]=this.handleOptionAndParams(e,"watchTicker","method","/market/snapshot");const a=r+":"+i.id,n="unsubscribe:ticker:"+t,o="ticker:"+t,d={messageHashes:[n],subMessageHashes:[o],topic:"trades",unsubscribe:!0,symbols:[t]};return await this.unSubscribe(s,n,a,o,e,d)}async watchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);let i;[i,e]=this.handleOptionAndParams(e,"watchTickers","method","/market/ticker");const s=[],r=[];if(void 0!==t)for(let e=0;e<t.length;e++){const a=t[e];s.push("ticker:"+a);const n=this.market(a);r.push(i+":"+n.id)}const a=await this.negotiate(!1);let n;if(void 0===t){const t=i+":all";if(n=await this.subscribe(a,"tickers",t,e),this.newUpdates)return n}else{const o=i+":"+this.marketIds(t).join(",");if(n=await this.subscribeMultiple(a,s,o,r,e),this.newUpdates){const t={};return t[n.symbol]=n,t}}return this.filterByArray(this.tickers,"symbol",t)}handleTicker(t,e){const i=this.safeString(e,"topic");let s;if(void 0!==i){const t=i.split(":"),r=this.safeString(t,1);let a;a="all"===r?this.safeString(e,"subject"):r,s=this.safeMarket(a,s,"-")}const r=this.safeValue(e,"data",{}),a=this.safeValue(r,"data",r),n=this.parseTicker(a,s),o=n.symbol;this.tickers[o]=n;const d="ticker:"+o;t.resolve(n,d);const c={};c[o]=n,t.resolve(c,"tickers")}async watchBidsAsks(t=void 0,e={}){const i=await this.watchMultiHelper("watchBidsAsks","/spotMarket/level1:",t,e);if(this.newUpdates){const t={};return t[i.symbol]=i,t}return this.filterByArray(this.bidsasks,"symbol",t)}async watchMultiHelper(t,e,i=void 0,s={}){await this.loadMarkets();if((i=this.marketSymbols(i,void 0,!1,!0,!1)).length>100)throw new r.ArgumentsRequired(this.id+" "+t+"() accepts a maximum of 100 symbols");const a=[];for(let t=0;t<i.length;t++){const e=i[t],s=this.market(e);a.push("bidask@"+s.symbol)}const n=await this.negotiate(!1),o=this.marketIds(i).join(","),d={id:this.requestId().toString(),type:"subscribe",topic:e+o,response:!0},c=this.extend(d,s);return await this.watchMultiple(n,a,c,a)}handleBidAsk(t,e){const i=this.parseWsBidAsk(e),s=i.symbol;this.bidsasks[s]=i;const r="bidask@"+s;t.resolve(i,r)}parseWsBidAsk(t,e=void 0){const i=this.safeString(t,"topic").split(":")[1];e=this.safeMarket(i,e);const s=this.safeString(e,"symbol"),r=this.safeDict(t,"data",{}),a=this.safeList(r,"asks",[]),n=this.safeList(r,"bids",[]),o=this.safeInteger(r,"timestamp");return this.safeTicker({symbol:s,timestamp:o,datetime:this.iso8601(o),ask:this.safeNumber(a,0),askVolume:this.safeNumber(a,1),bid:this.safeNumber(n,0),bidVolume:this.safeNumber(n,1),info:t},e)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=await this.negotiate(!1),n=this.market(t);t=n.symbol;const o=this.safeString(this.timeframes,e,e),d="/market/candles:"+n.id+"_"+o,c="candles:"+t+":"+e,h=await this.subscribe(a,c,d,r);return this.newUpdates&&(s=h.getLimit(t,s)),this.filterBySinceLimit(h,i,s,0,!0)}async unWatchOHLCV(t,e="1m",i={}){await this.loadMarkets();const s=await this.negotiate(!1),r=this.market(t);t=r.symbol;const a=this.safeString(this.timeframes,e,e),n="/market/candles:"+r.id+"_"+a,o="unsubscribe:candles:"+t+":"+e,d={messageHashes:[o],subMessageHashes:["candles:"+t+":"+e],topic:"ohlcv",unsubscribe:!0,symbols:[t]};return await this.unSubscribe(s,o,n,o,i,d)}handleOHLCV(t,e){const i=this.safeValue(e,"data",{}),s=this.safeString(i,"symbol"),r=this.safeValue(i,"candles",[]),n=this.safeString(e,"topic").split("_"),o=this.safeString(n,1),d=this.findTimeframe(o),c=this.safeMarket(s),h=c.symbol,l="candles:"+h+":"+d;this.ohlcvs[h]=this.safeValue(this.ohlcvs,h,{});let u=this.safeValue(this.ohlcvs[h],d);if(void 0===u){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);u=new a.TG(t),this.ohlcvs[h][d]=u}const p=this.parseOHLCV(r,c);u.append(p),t.resolve(u,l)}async watchTrades(t,e=void 0,i=void 0,s={}){return await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){if(0===t.length)throw new r.ArgumentsRequired(this.id+" watchTradesForSymbols() requires a non-empty array of symbols");await this.loadMarkets(),t=this.marketSymbols(t);const a=this.marketIds(t),n=await this.negotiate(!1),o=[],d=[],c="/market/match:"+a.join(",");for(let e=0;e<t.length;e++){const i=t[e];o.push("trades:"+i);const s=a[e];d.push("/market/match:"+s)}const h=await this.subscribeMultiple(n,o,c,d,s);if(this.newUpdates){const t=this.safeValue(h,0),e=this.safeString(t,"symbol");i=h.getLimit(e,i)}return this.filterBySinceLimit(h,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=this.marketIds(t),s=await this.negotiate(!1),r=[],a=[],n="/market/match:"+i.join(",");for(let e=0;e<t.length;e++){const i=t[e];r.push("unsubscribe:trades:"+i),a.push("trades:"+i)}const o={messageHashes:r,subMessageHashes:a,topic:"trades",unsubscribe:!0,symbols:t};return await this.unSubscribeMultiple(s,r,n,r,e,o)}async unWatchTrades(t,e={}){return await this.unWatchTradesForSymbols([t],e)}handleTrade(t,e){const i=this.safeValue(e,"data",{}),s=this.parseTrade(i),r=s.symbol,n="trades:"+r;let o=this.safeValue(this.trades,r);if(void 0===o){const t=this.safeInteger(this.options,"tradesLimit",1e3);o=new a.I3(t),this.trades[r]=o}o.append(s),t.resolve(o,n)}async watchOrderBook(t,e=void 0,i={}){return await this.watchOrderBookForSymbols([t],e,i)}async unWatchOrderBook(t,e={}){return await this.unWatchOrderBookForSymbols([t],e)}async watchOrderBookForSymbols(t,e=void 0,i={}){if(0===t.length)throw new r.ArgumentsRequired(this.id+" watchOrderBookForSymbols() requires a non-empty array of symbols");if(void 0!==e&&20!==e&&100!==e&&50!==e&&5!==e)throw new r.ExchangeError(this.id+" watchOrderBook 'limit' argument must be undefined, 5, 20, 50 or 100");await this.loadMarkets(),t=this.marketSymbols(t);const s=this.marketIds(t),a=await this.negotiate(!1);let n;[n,i]=this.handleOptionAndParams(i,"watchOrderBook","method","/market/level2"),5!==e&&50!==e||(n="/spotMarket/level2Depth"+e.toString());const o=n+":"+s.join(","),d=[],c=[];for(let e=0;e<t.length;e++){const i=t[e];d.push("orderbook:"+i);const r=s[e];c.push(n+":"+r)}let h={};"/market/level2"===n&&(h={method:this.handleOrderBookSubscription,symbols:t,limit:e});return(await this.subscribeMultiple(a,d,o,c,i,h)).limit()}async unWatchOrderBookForSymbols(t,e={}){const i=this.safeInteger(e,"limit");e=this.omit(e,"limit"),await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const s=this.marketIds(t),r=await this.negotiate(!1);let a;[a,e]=this.handleOptionAndParams(e,"watchOrderBook","method","/market/level2"),5!==i&&50!==i||(a="/spotMarket/level2Depth"+i.toString());const n=a+":"+s.join(","),o=[],d=[];for(let e=0;e<t.length;e++){const i=t[e];o.push("unsubscribe:orderbook:"+i),d.push("orderbook:"+i)}const c={messageHashes:o,symbols:t,unsubscribe:!0,topic:"orderbook",subMessageHashes:d};return await this.unSubscribeMultiple(r,o,n,o,e,c)}handleOrderBook(t,e){const i=this.safeValue(e,"data"),s=this.safeString(e,"subject"),r=this.safeString(e,"topic").split(":"),a=this.safeString(r,1),n=this.safeString(r,0),o=this.safeString(i,"symbol",a),d=this.safeSymbol(o,void 0,"-"),c="orderbook:"+d;if("level2"===s){if(d in this.orderbooks){this.orderbooks[d].reset()}else this.orderbooks[d]=this.orderBook();this.orderbooks[d].symbol=d}else{d in this.orderbooks||(this.orderbooks[d]=this.orderBook());const e=this.orderbooks[d],s=this.safeInteger(e,"nonce"),r=this.safeInteger2(i,"sequenceEnd","timestamp");if(void 0===s){const s=e.cache.length,r=Object.keys(t.subscriptions);let o;for(let e=0;e<r.length;e++){const i=r[e];if(i.indexOf(a)>=0&&i.indexOf(n)>=0){o=t.subscriptions[i];break}}const h=this.safeInteger(o,"limit");return s===this.handleOption("watchOrderBook","snapshotDelay",5)&&this.spawn(this.loadOrderBook,t,c,d,h,{}),void e.cache.push(i)}if(s>=r)return}this.handleDelta(this.orderbooks[d],i),t.resolve(this.orderbooks[d],c)}getCacheIndex(t,e){const i=this.safeValue(e,0),s=this.safeInteger(t,"nonce");if(s<this.safeInteger(i,"sequenceStart")-1)return-1;for(let t=0;t<e.length;t++){const i=e[t],r=this.safeInteger(i,"sequenceStart"),a=this.safeInteger(i,"sequenceEnd");if(s>=r-1&&s<a)return t}return e.length}handleDelta(t,e){const i=this.safeInteger2(e,"time","timestamp");t.nonce=this.safeInteger(e,"sequenceEnd",i),t.timestamp=i,t.datetime=this.iso8601(i);const s=this.safeValue(e,"changes",e),r=this.safeValue(s,"bids",[]),a=this.safeValue(s,"asks",[]),n=t.bids,o=t.asks;this.handleBidAsks(n,r),this.handleBidAsks(o,a)}handleBidAsks(t,e){for(let i=0;i<e.length;i++){const s=this.parseBidAsk(e[i]);t.storeArray(s)}}handleOrderBookSubscription(t,e,i){const s=this.safeInteger(i,"limit"),r=this.safeValue(i,"symbols");if(void 0===r){const t=this.safeString(i,"symbol");this.orderbooks[t]=this.orderBook({},s)}else for(let t=0;t<r.length;t++){const e=r[t];this.orderbooks[e]=this.orderBook({},s)}}handleSubscriptionStatus(t,e){const i=this.safeString(e,"id");if(!(i in t.subscriptions))return;const s=this.safeString(t.subscriptions,i),r=this.safeValue(t.subscriptions,s);delete t.subscriptions[i];const a=this.safeValue(r,"method");void 0!==a&&a.call(this,t,e,r);if(this.safeBool(r,"unsubscribe",!1)){const e=this.safeList(r,"messageHashes",[]),i=this.safeList(r,"subMessageHashes",[]);for(let s=0;s<e.length;s++){const r=e[s],a=i[s];this.cleanUnsubscription(t,a,r)}this.cleanCache(r)}}handleSystemStatus(t,e){return e}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.safeValue2(s,"stop","trigger");s=this.omit(s,["stop","trigger"]);const a=await this.negotiate(!0),n=r?"/spotMarket/advancedOrders":"/spotMarket/tradeOrders";let o="orders";if(void 0!==t){o=o+":"+(t=this.market(t).symbol)}const d=await this.subscribe(a,o,n,this.extend({privateChannel:!0},s));return this.newUpdates&&(i=d.getLimit(t,i)),this.filterBySymbolSinceLimit(d,t,e,i,!0)}parseWsOrderStatus(t){return this.safeString({open:"open",filled:"closed",match:"open",update:"open",canceled:"canceled",cancel:"canceled",TRIGGERED:"triggered"},t,t)}parseWsOrder(t,e=void 0){const i=this.safeString(t,"type");let s=this.parseWsOrderStatus(i);const r=this.safeInteger2(t,"orderTime","createdAt"),a=this.safeString(t,"symbol");e=this.safeMarket(a,e);const n=this.safeString(t,"stopPrice"),o=this.safeValue(t,"triggerSuccess");return"triggered"===s&&(!0!==o&&void 0!==o)&&(s="canceled"),this.safeOrder({info:t,symbol:e.symbol,id:this.safeString(t,"orderId"),clientOrderId:this.safeString(t,"clientOid"),timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:void 0,type:this.safeStringLower(t,"orderType"),timeInForce:void 0,postOnly:void 0,side:this.safeStringLower(t,"side"),price:this.safeString2(t,"price","orderPrice"),stopPrice:n,triggerPrice:n,amount:this.safeString(t,"size"),cost:void 0,average:void 0,filled:this.safeString(t,"filledSize"),remaining:void 0,status:s,fee:void 0,trades:void 0},e)}handleOrder(t,e){const i="orders",s=this.safeValue(e,"data");void 0!==this.safeString(s,"tradeId")&&this.handleMyTrade(t,e);const r=this.parseWsOrder(s),n=this.safeString(r,"symbol"),o=this.safeString(r,"id"),d=void 0!==this.safeValue(r,"triggerPrice");if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a.Pt(t),this.triggerOrders=new a.Pt(t)}const c=d?this.triggerOrders:this.orders,h=this.safeValue(c.hashmap,n,{}),l=this.safeValue(h,o);void 0!==l&&"closed"===l.status&&(r.status="closed"),c.append(r),t.resolve(c,i);const u=i+":"+n;t.resolve(c,u)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.negotiate(!0);let a;[a,s]=this.handleOptionAndParams(s,"watchMyTrades","method","/spotMarket/tradeOrders");let n="myTrades";if(void 0!==t){const e=this.market(t);t=e.symbol,n=n+":"+e.symbol}const o=await this.subscribe(r,n,a,this.extend({privateChannel:!0},s));return this.newUpdates&&(i=o.getLimit(t,i)),this.filterBySymbolSinceLimit(o,t,e,i,!0)}handleMyTrade(t,e){if(void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new a.Pt(t)}const i=this.safeDict(e,"data"),s=this.parseWsTrade(i);this.myTrades.append(s);const r="myTrades";t.resolve(this.myTrades,r);const n=r+":"+s.symbol;t.resolve(this.myTrades,n)}parseWsTrade(t,e=void 0){const i=this.safeString(t,"symbol"),s=(e=this.safeMarket(i,e,"-")).symbol,r=this.safeString(t,"orderType"),a=this.safeString(t,"side"),n=this.safeString(t,"tradeId");let o=this.safeString(t,"matchPrice"),d=this.safeString(t,"matchSize");void 0===o&&(o=this.safeString(t,"price"),d=this.safeString(t,"size"));const c=this.safeString(t,"orderId"),h=this.safeIntegerProduct2(t,"ts","time",1e-6),l=e.quote,u=this.safeString(t,"feeRate"),p=this.safeString(t,"fee");return this.safeTrade({info:t,timestamp:h,datetime:this.iso8601(h),symbol:s,id:n,order:c,type:r,takerOrMaker:this.safeString(t,"liquidity"),side:a,price:o,amount:d,cost:void 0,fee:{cost:p,rate:u,currency:l}},e)}async watchBalance(t={}){await this.loadMarkets();const e=await this.negotiate(!0);return await this.subscribe(e,"balance","/account/balance",this.extend({privateChannel:!0},t))}handleBalance(t,e){const i=this.safeValue(e,"data",{}),s=this.safeString(i,"currency"),r=this.safeString(i,"relationEvent");let a;if(void 0!==r){const t=r.split(".");a=this.safeString(t,0)}const n=this.safeString2(this.options,"watchBalance","defaultType","trade"),o=this.safeValue(this.options,"accountsByType"),d=this.safeString(o,a,"trade");d in this.balance||(this.balance[d]={}),this.balance[d].info=i;const c=this.safeInteger(i,"time");this.balance[d].timestamp=c,this.balance[d].datetime=this.iso8601(c);const h=this.safeCurrencyCode(s),l=this.account();l.free=this.safeString(i,"available"),l.used=this.safeString(i,"hold"),l.total=this.safeString(i,"total"),this.balance[d][h]=l,this.balance[d]=this.safeBalance(this.balance[d]),d===n&&t.resolve(this.balance[d],"balance")}handleSubject(t,e){if("/market/ticker:all"===this.safeString(e,"topic"))return void this.handleTicker(t,e);const i=this.safeString(e,"subject"),s={level1:this.handleBidAsk,level2:this.handleOrderBook,"trade.l2update":this.handleOrderBook,"trade.ticker":this.handleTicker,"trade.snapshot":this.handleTicker,"trade.l3match":this.handleTrade,"trade.candles.update":this.handleOHLCV,"account.balance":this.handleBalance,orderChange:this.handleOrder,stopOrder:this.handleOrder,"/spot/tradeFills":this.handleMyTrade},r=this.safeValue(s,i);void 0!==r&&r.call(this,t,e)}ping(t){return{id:this.requestId().toString(),type:"ping"}}handlePong(t,e){t.lastPong=this.milliseconds()}handleErrorMessage(t,e){const i=this.safeString(e,"data","");if("token is expired"===i){let e="public";t.url.indexOf("connectId=private")>=0&&(e="private"),this.options.urls[e]=void 0}return this.handleErrors(1,"",t.url,"",{},i,e,{},{}),!1}handleMessage(t,e){const i=this.safeString(e,"type"),s={welcome:this.handleSystemStatus,ack:this.handleSubscriptionStatus,message:this.handleSubject,pong:this.handlePong,error:this.handleErrorMessage},r=this.safeValue(s,i);void 0!==r&&r.call(this,t,e)}}},5095(t,e,i){"use strict";i.r(e),i.d(e,{DECIMAL_PLACES:()=>o.fv,NO_PADDING:()=>o.w1,PAD_WITH_ZERO:()=>o.ex,ROUND:()=>o.D_,ROUND_DOWN:()=>o._g,ROUND_UP:()=>o.Tz,SIGNIFICANT_DIGITS:()=>o.v,TICK_SIZE:()=>o.kb,TRUNCATE:()=>o.R3,Throttler:()=>l.x,TimedOut:()=>h.GA,aggregate:()=>u.QD,arrayConcat:()=>r.ax,asFloat:()=>n.Pf,asInteger:()=>n.JU,axolotl:()=>c.Sw,base16ToBinary:()=>d.FF,base58ToBinary:()=>d.Ry,base64ToBase64Url:()=>d.xg,base64ToBinary:()=>d.cg,base64ToString:()=>d.QM,binaryConcat:()=>d.qo,binaryConcatArray:()=>d.Vw,binaryToBase16:()=>d.t7,binaryToBase58:()=>d.bj,binaryToBase64:()=>d.sQ,binaryToString:()=>d.kn,capitalize:()=>a.ZH,clone:()=>r.o8,crc32:()=>c.QR,decimalToPrecision:()=>o.fq,decode:()=>d.D4,deepExtend:()=>r.zw,ecdsa:()=>c.h1,eddsa:()=>c.q4,encode:()=>d.lF,extend:()=>r.X$,extractParams:()=>u.um,filterBy:()=>r.WP,flatten:()=>r.Bq,groupBy:()=>r.$z,hasProps:()=>n.dl,hash:()=>c.tW,hmac:()=>c.w8,implodeParams:()=>u.Hp,inArray:()=>r.RV,index:()=>r.Pe,indexBy:()=>r.wQ,isArray:()=>n.cy,isBrowser:()=>s.Bd,isDeno:()=>s.N6,isDictionary:()=>n.Hf,isElectron:()=>s.b8,isEmpty:()=>r.Im,isInteger:()=>n.Fq,isJsonEncodedObject:()=>d.mC,isNode:()=>s.Ll,isNumber:()=>n.Et,isObject:()=>n.Gv,isString:()=>n.Kg,isStringCoercible:()=>n.KL,isWebWorker:()=>s.p7,isWindows:()=>s.uF,iso8601:()=>h.LC,json:()=>d.Pq,keys:()=>r.HP,keysort:()=>r.CA,mdy:()=>h.rE,merge:()=>r.h1,microseconds:()=>h.EZ,milliseconds:()=>h.Rz,now:()=>h.tB,numberToBE:()=>d.qE,numberToLE:()=>d.aN,numberToString:()=>o.um,omit:()=>r.cJ,omitZero:()=>o.Ye,ordered:()=>r.Sj,packb:()=>d.Am,parse8601:()=>h.Dj,parseDate:()=>h._U,parseTimeframe:()=>u.ce,pluck:()=>r.Ey,precisionConstants:()=>o.S2,precisionFromString:()=>o.Iu,prop:()=>n._w,rawencode:()=>d.rO,rfc2616:()=>h.D9,roundTimeframe:()=>u.jG,safeFloat:()=>n.w,safeFloat2:()=>n.Cw,safeFloatN:()=>n.Q7,safeInteger:()=>n.Y2,safeInteger2:()=>n.mU,safeIntegerN:()=>n.At,safeIntegerProduct:()=>n.lu,safeIntegerProduct2:()=>n.J0,safeIntegerProductN:()=>n.hO,safeString:()=>n.nr,safeString2:()=>n.d0,safeStringLower:()=>n.gw,safeStringLower2:()=>n.uS,safeStringLowerN:()=>n.I9,safeStringN:()=>n.Rc,safeStringUpper:()=>n.RH,safeStringUpper2:()=>n.F7,safeStringUpperN:()=>n.fu,safeTimestamp:()=>n.q0,safeTimestamp2:()=>n.ww,safeTimestampN:()=>n.Y_,safeValue:()=>n.pI,safeValue2:()=>n.Dj,safeValueN:()=>n.DR,seconds:()=>h.YA,selfIsDefined:()=>u.Se,setTimeout_safe:()=>h.k4,sleep:()=>h.yy,sort:()=>r.di,sortBy:()=>r.Ul,sortBy2:()=>r.sy,stringToBase64:()=>d.q3,stringToBinary:()=>d.wN,strip:()=>a.bB,sum:()=>r.cz,timeout:()=>h.wR,toArray:()=>r.$r,truncate:()=>o.xv,truncate_to_string:()=>o.NZ,unCamelCase:()=>a.Qd,unique:()=>r.Am,urlencode:()=>d.mu,urlencodeBase64:()=>d.LI,urlencodeNested:()=>d.Dy,urlencodeWithArrayRepeat:()=>d.ev,uuid:()=>a.uR,uuid16:()=>a.tg,uuid22:()=>a._n,uuidv1:()=>h.nm,values:()=>r.zu,vwap:()=>u.ru,ymd:()=>h.Th,ymdhms:()=>h.RR,yymmdd:()=>h.x_,yyyymmdd:()=>h.Rn});var s=i(7597),r=i(7437),a=i(3503),n=i(6834),o=i(1579),d=i(9560),c=i(8283),h=i(8403),l=i(7618),u=i(6238)},5147(t,e,i){"use strict";i.d(e,{Y:()=>n});const s=BigInt(0),r=BigInt(-1),a=BigInt(10);class n{constructor(t,e=void 0){if(this.base=void 0,void 0===e){let e=0;if((t=t.toLowerCase()).indexOf("e")>-1){let i="0";[t,i]=t.split("e"),e=parseInt(i)}const i=t.indexOf(".");this.decimals=i>-1?t.length-i-1:0;const s=t.replace(".","");this.integer=BigInt(s),this.decimals=this.decimals-e}else this.integer=t,this.decimals=e}mul(t){const e=this.integer*t.integer;return new n(e,this.decimals+t.decimals)}div(t,e=18){const i=e-this.decimals+t.decimals;let s;if(0===i)s=this.integer;else if(i<0){const t=a**BigInt(-i);s=this.integer/t}else{const t=a**BigInt(i);s=this.integer*t}const r=s/t.integer;return new n(r,e)}add(t){if(this.decimals===t.decimals){const e=this.integer+t.integer;return new n(e,this.decimals)}{const[e,i]=this.decimals>t.decimals?[t,this]:[this,t],s=i.decimals-e.decimals,r=e.integer*a**BigInt(s)+i.integer;return new n(r,i.decimals)}}mod(t){const e=Math.max(-this.decimals+t.decimals,0),i=this.integer*a**BigInt(e),s=Math.max(-t.decimals+this.decimals,0),r=t.integer*a**BigInt(s);return new n(i%r,s+t.decimals)}sub(t){const e=new n(-t.integer,t.decimals);return this.add(e)}abs(){return new n(this.integer<0?this.integer*r:this.integer,this.decimals)}neg(){return new n(-this.integer,this.decimals)}or(t){const e=this.integer|t.integer;return new n(e,this.decimals)}min(t){return this.lt(t)?this:t}max(t){return this.gt(t)?this:t}gt(t){return this.sub(t).integer>0}ge(t){return this.sub(t).integer>=0}lt(t){return t.gt(this)}le(t){return t.ge(this)}reduce(){const t=this.integer.toString(),e=t.length-1;if(0===e)return"0"===t&&(this.decimals=0),this;let i;for(i=e;i>=0&&"0"===t.charAt(i);i--);const s=e-i;if(0===s)return this;this.decimals-=s,this.integer=BigInt(t.slice(0,i+1))}equals(t){return this.reduce(),t.reduce(),this.decimals===t.decimals&&this.integer===t.integer}toString(){let t,e;this.reduce(),this.integer<0?(t="-",e=-this.integer):(t="",e=this.integer);const i=Array.from(e.toString(Number(a)).padStart(this.decimals,"0")),s=i.length-this.decimals;let r;return r=0===s?"0.":this.decimals<0?"0".repeat(-this.decimals):0===this.decimals?"":".",i.splice(s,0,r),t+i.join("")}static stringMul(t,e){if(void 0!==t&&void 0!==e)return new n(t).mul(new n(e)).toString()}static stringDiv(t,e,i=18){if(void 0===t||void 0===e)return;const r=new n(e);return r.integer!==s?new n(t).div(r,i).toString():void 0}static stringAdd(t,e){if(void 0!==t||void 0!==e)return void 0===t?e:void 0===e?t:new n(t).add(new n(e)).toString()}static stringSub(t,e){if(void 0!==t&&void 0!==e)return new n(t).sub(new n(e)).toString()}static stringAbs(t){if(void 0!==t)return new n(t).abs().toString()}static stringNeg(t){if(void 0!==t)return new n(t).neg().toString()}static stringMod(t,e){if(void 0!==t&&void 0!==e)return new n(t).mod(new n(e)).toString()}static stringOr(t,e){if(void 0!==t&&void 0!==e)return new n(t).or(new n(e)).toString()}static stringEquals(t,e){if(void 0!==t&&void 0!==e)return new n(t).equals(new n(e))}static stringEq(t,e){if(void 0!==t&&void 0!==e)return new n(t).equals(new n(e))}static stringMin(t,e){if(void 0!==t&&void 0!==e)return new n(t).min(new n(e)).toString()}static stringMax(t,e){if(void 0!==t&&void 0!==e)return new n(t).max(new n(e)).toString()}static stringGt(t,e){if(void 0!==t&&void 0!==e)return new n(t).gt(new n(e))}static stringGe(t,e){if(void 0!==t&&void 0!==e)return new n(t).ge(new n(e))}static stringLt(t,e){if(void 0!==t&&void 0!==e)return new n(t).lt(new n(e))}static stringLe(t,e){if(void 0!==t&&void 0!==e)return new n(t).le(new n(e))}}},5268(t,e,i){"use strict";let s;i.d(e,{o:()=>r});const r={decode(t){let e;if(void 0===s){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="= \f\n\r\t\u2028\u2029";for(s=Object.create(null),e=0;e<64;++e)s[t.charAt(e)]=e;for(s["-"]=62,s._=63,e=0;e<i.length;++e)s[i.charAt(e)]=-1}const i=[];let r=0,a=0;for(e=0;e<t.length;++e){let n=t.charAt(e);if("="==n)break;if(n=s[n],-1!=n){if(void 0===n)throw new Error("Illegal character at offset "+e);r|=n,++a>=4?(i[i.length]=r>>16,i[i.length]=r>>8&255,i[i.length]=255&r,r=0,a=0):r<<=6}}switch(a){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:i[i.length]=r>>10;break;case 3:i[i.length]=r>>16,i[i.length]=r>>8&255}return i},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor(t){const e=r.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw new Error("RegExp out of sync");t=e[2]}return r.decode(t)}}},5277(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},5307(t,e,i){"use strict";i.d(e,{$H:()=>m,AB:()=>_,CS:()=>O,Fi:()=>y,G$:()=>d,GY:()=>v,Gw:()=>g,Z$:()=>S,Zm:()=>c,ak:()=>w,cl:()=>T,ct:()=>n,e4:()=>p,gr:()=>b,iN:()=>P,iO:()=>u,mQ:()=>h,s8:()=>k,sB:()=>o,u:()=>f,wJ:()=>l});var s=i(40),r=i(4921),a=i(3283);const n=t=>/_len$/.test(t),o=t=>"felt"===t||"core::felt252"===t,d=t=>/\*/.test(t)||t.startsWith("core::array::Array::")||t.startsWith("core::array::Span::"),c=t=>/^\(.*\)$/i.test(t),h=t=>/\(.*\)/i.test(t)&&t.includes(":"),l=(t,e)=>t in e,u=(t,e)=>t in e,p=t=>t.startsWith("core::option::Option::"),f=t=>t.startsWith("core::result::Result::"),m=t=>Object.values(s.Fg).includes(t),g=t=>Object.values(s.uS).includes(t),y=t=>"core::bool"===t,v=t=>"core::starknet::eth_address::EthAddress"===t,b=t=>"core::bytes_31::bytes31"===t,w=t=>"core::byte_array::byteArray.js"===t,S=t=>"core::starknet::secp256k1::Secp256k1Point"===t,k=t=>t.includes("::"),O=t=>k(t)?t.substring(t.indexOf("<")+1,t.lastIndexOf(">")):t.replace("*","");function T(t){const{cairo:e}=function(t){if(t.find(t=>"interface"===t.type))return{cairo:"1",compiler:"2"};const e=t.find(t=>"function"===t.type&&(t.inputs.length||t.outputs.length));if(!e)return{cairo:void 0,compiler:void 0};const i=e.inputs.length?e.inputs:e.outputs;if(k(i[0].type))return{cairo:"1",compiler:"1"};return{cairo:"0",compiler:"0"}}(t);if(void 0===e)throw Error("Unable to determine Cairo version");return"1"===e}const P=t=>new a.is(t).toUint256DecimalString();function _(t){return(0,r.e)(t)}},5354(t,e,i){"use strict";i.d(e,{a:()=>h,n:()=>c});var s=i(5944),r=i(4710),a=i(9560),n=i(8283),o=i(8342),d=i(6414);function c(t,e,i){const a=new s.v;a.setPrivateKey(e);const n=i.create().constructor.name.toLowerCase();return a.sign(t,t=>r.xn.encode(i(t)),n)}function h(t,e,i,s=!1,h={}){let l=(s?"RS":"HS")+8*i.outputLen;h.alg&&(l=h.alg.toUpperCase());const u=Object.assign({alg:l,typ:"JWT"},h);void 0!==u.iat&&(t.iat=u.iat,delete u.iat);let p=[(0,a.LI)(JSON.stringify(u)),(0,a.LI)(JSON.stringify(t))].join(".");const f=l.slice(0,2);let m;if("HS"===f)m=(0,a.LI)((0,n.w8)(p,e,i,"binary"));else if(s||"RS"===f)m=(0,a.LI)((0,a.cg)(c(p,r.As.encode(e),i)));else if("ES"===f){const t=(0,n.h1)(p,r.As.encode(e),o.Qj,i),s=t.r.padStart(64,"0"),d=t.s.padStart(64,"0");m=(0,a.LI)((0,a.FF)(s+d))}else if("ED"===f){const t=(0,n.q4)(function(t){for(var e="",i=0;i<t.length;i++)e+=t.charCodeAt(i).toString(16);return e}(p),e,d.ev);m=(0,a.xg)(t)}return[p,m].join(".")}},5425(t,e,i){"use strict";i.d(e,{nj:()=>a});var s,r=i(7525);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()),function(t){t[t.REMOVAL_REASON_UNSPECIFIED=0]="REMOVAL_REASON_UNSPECIFIED",t[t.REMOVAL_REASON_UNDERCOLLATERALIZED=1]="REMOVAL_REASON_UNDERCOLLATERALIZED",t[t.REMOVAL_REASON_INVALID_REDUCE_ONLY=2]="REMOVAL_REASON_INVALID_REDUCE_ONLY",t[t.REMOVAL_REASON_POST_ONLY_WOULD_CROSS_MAKER_ORDER=3]="REMOVAL_REASON_POST_ONLY_WOULD_CROSS_MAKER_ORDER",t[t.REMOVAL_REASON_INVALID_SELF_TRADE=4]="REMOVAL_REASON_INVALID_SELF_TRADE",t[t.REMOVAL_REASON_CONDITIONAL_FOK_COULD_NOT_BE_FULLY_FILLED=5]="REMOVAL_REASON_CONDITIONAL_FOK_COULD_NOT_BE_FULLY_FILLED",t[t.REMOVAL_REASON_CONDITIONAL_IOC_WOULD_REST_ON_BOOK=6]="REMOVAL_REASON_CONDITIONAL_IOC_WOULD_REST_ON_BOOK",t[t.REMOVAL_REASON_FULLY_FILLED=7]="REMOVAL_REASON_FULLY_FILLED",t[t.REMOVAL_REASON_VIOLATES_ISOLATED_SUBACCOUNT_CONSTRAINTS=8]="REMOVAL_REASON_VIOLATES_ISOLATED_SUBACCOUNT_CONSTRAINTS",t[t.REMOVAL_REASON_PERMISSIONED_KEY_EXPIRED=9]="REMOVAL_REASON_PERMISSIONED_KEY_EXPIRED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(s||(s={}));const a={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.orderId&&r.e3.encode(t.orderId,e.uint32(10).fork()).ldelim(),0!==t.removalReason&&e.uint32(16).int32(t.removalReason),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a={orderId:void 0,removalReason:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.orderId=r.e3.decode(i,i.uint32());break;case 2:a.removalReason=i.int32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={orderId:void 0,removalReason:0};return e.orderId=void 0!==t.orderId&&null!==t.orderId?r.e3.fromPartial(t.orderId):void 0,e.removalReason=t.removalReason??0,e}}},5462(t,e,i){"use strict";i.d(e,{A:()=>c});var s=i(1293),r=i(1579),a=i(2079),n=i(5147),o=i(4852),d=i(5354);class c extends s.A{describe(){return this.deepExtend(super.describe(),{id:"bybit",name:"Bybit",countries:["VG"],version:"v5",userAgent:void 0,rateLimit:20,hostname:"bybit.com",pro:!0,certified:!0,has:{CORS:!0,spot:!0,margin:!0,swap:!0,future:!0,option:!0,borrowCrossMargin:!0,cancelAllOrders:!0,cancelAllOrdersAfter:!0,cancelOrder:!0,cancelOrders:!0,cancelOrdersForSymbols:!0,closeAllPositions:!1,closePosition:!1,createConvertTrade:!0,createMarketBuyOrderWithCost:!0,createMarketSellOrderWithCost:!0,createOrder:!0,createOrders:!0,createOrderWithTakeProfitAndStopLoss:!0,createPostOnlyOrder:!0,createReduceOnlyOrder:!0,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTakeProfitOrder:!0,createTrailingAmountOrder:!0,createTriggerOrder:!0,editOrder:!0,editOrders:!0,fetchAllGreeks:!0,fetchBalance:!0,fetchBidsAsks:"emulated",fetchBorrowInterest:!1,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchCanceledAndClosedOrders:!0,fetchCanceledOrders:!0,fetchClosedOrder:!0,fetchClosedOrders:!0,fetchConvertCurrencies:!0,fetchConvertQuote:!0,fetchConvertTrade:!0,fetchConvertTradeHistory:!0,fetchCrossBorrowRate:!0,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:!1,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingRate:"emulated",fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchGreeks:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchLedger:!0,fetchLeverage:!0,fetchLeverageTiers:!0,fetchLongShortRatio:!1,fetchLongShortRatioHistory:!0,fetchMarginAdjustmentHistory:!1,fetchMarketLeverageTiers:!0,fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMyLiquidations:!0,fetchMySettlementHistory:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!0,fetchOpenInterestHistory:!0,fetchOpenOrder:!0,fetchOpenOrders:!0,fetchOption:!0,fetchOptionChain:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!1,fetchOrderTrades:!0,fetchPosition:!0,fetchPositionHistory:"emulated",fetchPositions:!0,fetchPositionsHistory:!0,fetchPremiumIndexOHLCV:!0,fetchSettlementHistory:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!1,fetchTransfers:!0,fetchUnderlyingAssets:!1,fetchVolatilityHistory:!0,fetchWithdrawals:!0,repayCrossMargin:!0,sandbox:!0,setLeverage:!0,setMarginMode:!0,setPositionMode:!0,transfer:!0,withdraw:!0},timeframes:{"1m":"1","3m":"3","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","6h":"360","12h":"720","1d":"D","1w":"W","1M":"M"},urls:{test:{spot:"https://api-testnet.{hostname}",futures:"https://api-testnet.{hostname}",v2:"https://api-testnet.{hostname}",public:"https://api-testnet.{hostname}",private:"https://api-testnet.{hostname}"},logo:"https://github.com/user-attachments/assets/97a5d0b3-de10-423d-90e1-6620960025ed",api:{spot:"https://api.{hostname}",futures:"https://api.{hostname}",v2:"https://api.{hostname}",public:"https://api.{hostname}",private:"https://api.{hostname}"},demotrading:{spot:"https://api-demo.{hostname}",futures:"https://api-demo.{hostname}",v2:"https://api-demo.{hostname}",public:"https://api-demo.{hostname}",private:"https://api-demo.{hostname}"},www:"https://www.bybit.com",doc:["https://bybit-exchange.github.io/docs/inverse/","https://bybit-exchange.github.io/docs/linear/","https://github.com/bybit-exchange"],fees:"https://help.bybit.com/hc/en-us/articles/360039261154",referral:"https://www.bybit.com/invite?ref=XDK12WP"},api:{public:{get:{"spot/v3/public/symbols":1,"spot/v3/public/quote/depth":1,"spot/v3/public/quote/depth/merged":1,"spot/v3/public/quote/trades":1,"spot/v3/public/quote/kline":1,"spot/v3/public/quote/ticker/24hr":1,"spot/v3/public/quote/ticker/price":1,"spot/v3/public/quote/ticker/bookTicker":1,"spot/v3/public/server-time":1,"spot/v3/public/infos":1,"spot/v3/public/margin-product-infos":1,"spot/v3/public/margin-ensure-tokens":1,"v3/public/time":1,"contract/v3/public/copytrading/symbol/list":1,"derivatives/v3/public/order-book/L2":1,"derivatives/v3/public/kline":1,"derivatives/v3/public/tickers":1,"derivatives/v3/public/instruments-info":1,"derivatives/v3/public/mark-price-kline":1,"derivatives/v3/public/index-price-kline":1,"derivatives/v3/public/funding/history-funding-rate":1,"derivatives/v3/public/risk-limit/list":1,"derivatives/v3/public/delivery-price":1,"derivatives/v3/public/recent-trade":1,"derivatives/v3/public/open-interest":1,"derivatives/v3/public/insurance":1,"v5/announcements/index":5,"v5/market/time":5,"v5/market/kline":5,"v5/market/mark-price-kline":5,"v5/market/index-price-kline":5,"v5/market/premium-index-price-kline":5,"v5/market/instruments-info":5,"v5/market/orderbook":5,"v5/market/tickers":5,"v5/market/funding/history":5,"v5/market/recent-trade":5,"v5/market/open-interest":5,"v5/market/historical-volatility":5,"v5/market/insurance":5,"v5/market/risk-limit":5,"v5/market/delivery-price":5,"v5/market/account-ratio":5,"v5/spot-lever-token/info":5,"v5/spot-lever-token/reference":5,"v5/spot-margin-trade/data":5,"v5/spot-margin-trade/collateral":5,"v5/spot-cross-margin-trade/data":5,"v5/spot-cross-margin-trade/pledge-token":5,"v5/spot-cross-margin-trade/borrow-token":5,"v5/crypto-loan/collateral-data":5,"v5/crypto-loan/loanable-data":5,"v5/crypto-loan-common/loanable-data":5,"v5/crypto-loan-common/collateral-data":5,"v5/crypto-loan-fixed/supply-order-quote":5,"v5/crypto-loan-fixed/borrow-order-quote":5,"v5/ins-loan/product-infos":5,"v5/ins-loan/ensure-tokens-convert":5,"v5/earn/product":5}},private:{get:{"v5/market/instruments-info":5,"v2/private/wallet/fund/records":25,"spot/v3/private/order":2.5,"spot/v3/private/open-orders":2.5,"spot/v3/private/history-orders":2.5,"spot/v3/private/my-trades":2.5,"spot/v3/private/account":2.5,"spot/v3/private/reference":2.5,"spot/v3/private/record":2.5,"spot/v3/private/cross-margin-orders":10,"spot/v3/private/cross-margin-account":10,"spot/v3/private/cross-margin-loan-info":10,"spot/v3/private/cross-margin-repay-history":10,"spot/v3/private/margin-loan-infos":10,"spot/v3/private/margin-repaid-infos":10,"spot/v3/private/margin-ltv":10,"asset/v3/private/transfer/inter-transfer/list/query":50,"asset/v3/private/transfer/sub-member/list/query":50,"asset/v3/private/transfer/sub-member-transfer/list/query":50,"asset/v3/private/transfer/universal-transfer/list/query":25,"asset/v3/private/coin-info/query":25,"asset/v3/private/deposit/address/query":10,"contract/v3/private/copytrading/order/list":30,"contract/v3/private/copytrading/position/list":40,"contract/v3/private/copytrading/wallet/balance":25,"contract/v3/private/position/limit-info":25,"contract/v3/private/order/unfilled-orders":1,"contract/v3/private/order/list":1,"contract/v3/private/position/list":1,"contract/v3/private/execution/list":1,"contract/v3/private/position/closed-pnl":1,"contract/v3/private/account/wallet/balance":1,"contract/v3/private/account/fee-rate":1,"contract/v3/private/account/wallet/fund-records":1,"unified/v3/private/order/unfilled-orders":1,"unified/v3/private/order/list":1,"unified/v3/private/position/list":1,"unified/v3/private/execution/list":1,"unified/v3/private/delivery-record":1,"unified/v3/private/settlement-record":1,"unified/v3/private/account/wallet/balance":1,"unified/v3/private/account/transaction-log":1,"unified/v3/private/account/borrow-history":1,"unified/v3/private/account/borrow-rate":1,"unified/v3/private/account/info":1,"user/v3/private/frozen-sub-member":10,"user/v3/private/query-sub-members":5,"user/v3/private/query-api":5,"user/v3/private/get-member-type":1,"asset/v3/private/transfer/transfer-coin/list/query":50,"asset/v3/private/transfer/account-coin/balance/query":50,"asset/v3/private/transfer/account-coins/balance/query":25,"asset/v3/private/transfer/asset-info/query":50,"asset/v3/public/deposit/allowed-deposit-list/query":.17,"asset/v3/private/deposit/record/query":10,"asset/v3/private/withdraw/record/query":10,"v5/order/realtime":5,"v5/order/history":5,"v5/order/spot-borrow-check":1,"v5/position/list":5,"v5/execution/list":5,"v5/position/closed-pnl":5,"v5/position/move-history":5,"v5/pre-upgrade/order/history":5,"v5/pre-upgrade/execution/list":5,"v5/pre-upgrade/position/closed-pnl":5,"v5/pre-upgrade/account/transaction-log":5,"v5/pre-upgrade/asset/delivery-record":5,"v5/pre-upgrade/asset/settlement-record":5,"v5/account/wallet-balance":1,"v5/account/borrow-history":1,"v5/account/instruments-info":1,"v5/account/collateral-info":1,"v5/asset/coin-greeks":1,"v5/account/fee-rate":10,"v5/account/info":5,"v5/account/transaction-log":1,"v5/account/contract-transaction-log":1,"v5/account/smp-group":1,"v5/account/mmp-state":5,"v5/account/withdrawal":5,"v5/asset/exchange/query-coin-list":.5,"v5/asset/exchange/convert-result-query":.5,"v5/asset/exchange/query-convert-history":.5,"v5/asset/exchange/order-record":5,"v5/asset/delivery-record":5,"v5/asset/settlement-record":5,"v5/asset/transfer/query-asset-info":50,"v5/asset/transfer/query-account-coins-balance":25,"v5/asset/transfer/query-account-coin-balance":50,"v5/asset/transfer/query-transfer-coin-list":50,"v5/asset/transfer/query-inter-transfer-list":50,"v5/asset/transfer/query-sub-member-list":50,"v5/asset/transfer/query-universal-transfer-list":25,"v5/asset/deposit/query-allowed-list":5,"v5/asset/deposit/query-record":10,"v5/asset/deposit/query-sub-member-record":10,"v5/asset/deposit/query-internal-record":5,"v5/asset/deposit/query-address":10,"v5/asset/deposit/query-sub-member-address":10,"v5/asset/coin/query-info":28,"v5/asset/withdraw/query-address":10,"v5/asset/withdraw/query-record":10,"v5/asset/withdraw/withdrawable-amount":5,"v5/asset/withdraw/vasp/list":5,"v5/user/query-sub-members":5,"v5/user/query-api":5,"v5/user/sub-apikeys":5,"v5/user/get-member-type":5,"v5/user/aff-customer-info":5,"v5/user/del-submember":5,"v5/user/submembers":5,"v5/affiliate/aff-user-list":5,"v5/spot-lever-token/order-record":1,"v5/spot-margin-trade/interest-rate-history":5,"v5/spot-margin-trade/state":5,"v5/spot-margin-trade/max-borrowable":5,"v5/spot-margin-trade/position-tiers":5,"v5/spot-margin-trade/coinstate":5,"v5/spot-margin-trade/repayment-available-amount":5,"v5/spot-cross-margin-trade/loan-info":1,"v5/spot-cross-margin-trade/account":1,"v5/spot-cross-margin-trade/orders":1,"v5/spot-cross-margin-trade/repay-history":1,"v5/crypto-loan/borrowable-collateralisable-number":5,"v5/crypto-loan/ongoing-orders":5,"v5/crypto-loan/repayment-history":5,"v5/crypto-loan/borrow-history":5,"v5/crypto-loan/max-collateral-amount":5,"v5/crypto-loan/adjustment-history":5,"v5/crypto-loan-common/max-collateral-amount":10,"v5/crypto-loan-common/adjustment-history":10,"v5/crypto-loan-common/position":10,"v5/crypto-loan-flexible/ongoing-coin":10,"v5/crypto-loan-flexible/borrow-history":10,"v5/crypto-loan-flexible/repayment-history":10,"v5/crypto-loan-fixed/borrow-contract-info":10,"v5/crypto-loan-fixed/supply-contract-info":10,"v5/crypto-loan-fixed/borrow-order-info":10,"v5/crypto-loan-fixed/renew-info":10,"v5/crypto-loan-fixed/supply-order-info":10,"v5/crypto-loan-fixed/repayment-history":10,"v5/ins-loan/product-infos":5,"v5/ins-loan/ensure-tokens-convert":5,"v5/ins-loan/loan-order":5,"v5/ins-loan/repaid-history":5,"v5/ins-loan/ltv-convert":5,"v5/lending/info":5,"v5/lending/history-order":5,"v5/lending/account":5,"v5/broker/earning-record":5,"v5/broker/earnings-info":5,"v5/broker/account-info":5,"v5/broker/asset/query-sub-member-deposit-record":10,"v5/earn/product":5,"v5/earn/order":5,"v5/earn/position":5,"v5/earn/yield":5,"v5/earn/hourly-yield":5},post:{"spot/v3/private/order":2.5,"spot/v3/private/cancel-order":2.5,"spot/v3/private/cancel-orders":2.5,"spot/v3/private/cancel-orders-by-ids":2.5,"spot/v3/private/purchase":2.5,"spot/v3/private/redeem":2.5,"spot/v3/private/cross-margin-loan":10,"spot/v3/private/cross-margin-repay":10,"asset/v3/private/transfer/inter-transfer":150,"asset/v3/private/withdraw/create":300,"asset/v3/private/withdraw/cancel":50,"asset/v3/private/transfer/sub-member-transfer":150,"asset/v3/private/transfer/transfer-sub-member-save":150,"asset/v3/private/transfer/universal-transfer":10,"user/v3/private/create-sub-member":10,"user/v3/private/create-sub-api":10,"user/v3/private/update-api":10,"user/v3/private/delete-api":10,"user/v3/private/update-sub-api":10,"user/v3/private/delete-sub-api":10,"contract/v3/private/copytrading/order/create":30,"contract/v3/private/copytrading/order/cancel":30,"contract/v3/private/copytrading/order/close":30,"contract/v3/private/copytrading/position/close":40,"contract/v3/private/copytrading/position/set-leverage":40,"contract/v3/private/copytrading/wallet/transfer":25,"contract/v3/private/copytrading/order/trading-stop":2.5,"contract/v3/private/order/create":1,"contract/v3/private/order/cancel":1,"contract/v3/private/order/cancel-all":1,"contract/v3/private/order/replace":1,"contract/v3/private/position/set-auto-add-margin":1,"contract/v3/private/position/switch-isolated":1,"contract/v3/private/position/switch-mode":1,"contract/v3/private/position/switch-tpsl-mode":1,"contract/v3/private/position/set-leverage":1,"contract/v3/private/position/trading-stop":1,"contract/v3/private/position/set-risk-limit":1,"contract/v3/private/account/setMarginMode":1,"unified/v3/private/order/create":30,"unified/v3/private/order/replace":30,"unified/v3/private/order/cancel":30,"unified/v3/private/order/create-batch":30,"unified/v3/private/order/replace-batch":30,"unified/v3/private/order/cancel-batch":30,"unified/v3/private/order/cancel-all":30,"unified/v3/private/position/set-leverage":2.5,"unified/v3/private/position/tpsl/switch-mode":2.5,"unified/v3/private/position/set-risk-limit":2.5,"unified/v3/private/position/trading-stop":2.5,"unified/v3/private/account/upgrade-unified-account":2.5,"unified/v3/private/account/setMarginMode":2.5,"fht/compliance/tax/v3/private/registertime":50,"fht/compliance/tax/v3/private/create":50,"fht/compliance/tax/v3/private/status":50,"fht/compliance/tax/v3/private/url":50,"v5/order/create":2.5,"v5/order/amend":5,"v5/order/cancel":2.5,"v5/order/cancel-all":50,"v5/order/create-batch":5,"v5/order/amend-batch":5,"v5/order/cancel-batch":5,"v5/order/disconnected-cancel-all":5,"v5/position/set-leverage":5,"v5/position/switch-isolated":5,"v5/position/set-tpsl-mode":5,"v5/position/switch-mode":5,"v5/position/set-risk-limit":5,"v5/position/trading-stop":5,"v5/position/set-auto-add-margin":5,"v5/position/add-margin":5,"v5/position/move-positions":5,"v5/position/confirm-pending-mmr":5,"v5/account/upgrade-to-uta":5,"v5/account/quick-repayment":5,"v5/account/set-margin-mode":5,"v5/account/set-hedging-mode":5,"v5/account/mmp-modify":5,"v5/account/mmp-reset":5,"v5/account/borrow":5,"v5/account/repay":5,"v5/account/no-convert-repay":5,"v5/asset/exchange/quote-apply":1,"v5/asset/exchange/convert-execute":1,"v5/asset/transfer/inter-transfer":50,"v5/asset/transfer/save-transfer-sub-member":150,"v5/asset/transfer/universal-transfer":10,"v5/asset/deposit/deposit-to-account":5,"v5/asset/withdraw/create":50,"v5/asset/withdraw/cancel":50,"v5/user/create-sub-member":10,"v5/user/create-sub-api":10,"v5/user/frozen-sub-member":10,"v5/user/update-api":10,"v5/user/update-sub-api":10,"v5/user/delete-api":10,"v5/user/delete-sub-api":10,"v5/spot-lever-token/purchase":2.5,"v5/spot-lever-token/redeem":2.5,"v5/spot-margin-trade/switch-mode":5,"v5/spot-margin-trade/set-leverage":5,"v5/spot-cross-margin-trade/loan":2.5,"v5/spot-cross-margin-trade/repay":2.5,"v5/spot-cross-margin-trade/switch":2.5,"v5/crypto-loan/borrow":5,"v5/crypto-loan/repay":5,"v5/crypto-loan/adjust-ltv":5,"v5/crypto-loan-common/adjust-ltv":50,"v5/crypto-loan-flexible/borrow":50,"v5/crypto-loan-flexible/repay":50,"v5/crypto-loan-flexible/repay-collateral":50,"v5/crypto-loan-fixed/borrow":50,"v5/crypto-loan-fixed/renew":50,"v5/crypto-loan-fixed/supply":50,"v5/crypto-loan-fixed/borrow-order-cancel":50,"v5/crypto-loan-fixed/supply-order-cancel":50,"v5/crypto-loan-fixed/fully-repay":50,"v5/crypto-loan-fixed/repay-collateral":50,"v5/ins-loan/association-uid":5,"v5/lending/purchase":5,"v5/lending/redeem":5,"v5/lending/redeem-cancel":5,"v5/account/set-collateral-switch":5,"v5/account/set-collateral-switch-batch":5,"v5/account/demo-apply-money":5,"v5/broker/award/info":5,"v5/broker/award/distribute-award":5,"v5/broker/award/distribution-record":5,"v5/earn/place-order":5}}},httpExceptions:{403:a.RateLimitExceeded},exceptions:{exact:{"-10009":a.BadRequest,"-1004":a.BadRequest,"-1021":a.BadRequest,"-1103":a.BadRequest,"-1140":a.InvalidOrder,"-1197":a.InvalidOrder,"-2013":a.InvalidOrder,"-2015":a.AuthenticationError,"-6017":a.BadRequest,"-6025":a.BadRequest,"-6029":a.BadRequest,5004:a.ExchangeError,7001:a.BadRequest,10001:a.BadRequest,10002:a.InvalidNonce,10003:a.AuthenticationError,10004:a.AuthenticationError,10005:a.PermissionDenied,10006:a.RateLimitExceeded,10007:a.AuthenticationError,10008:a.AccountSuspended,10009:a.AuthenticationError,10010:a.PermissionDenied,10014:a.BadRequest,10016:a.ExchangeError,10017:a.BadRequest,10018:a.RateLimitExceeded,10020:a.PermissionDenied,10024:a.PermissionDenied,10027:a.PermissionDenied,10028:a.PermissionDenied,10029:a.PermissionDenied,12137:a.InvalidOrder,12201:a.BadRequest,12141:a.BadRequest,100028:a.PermissionDenied,110001:a.OrderNotFound,110003:a.InvalidOrder,110004:a.InsufficientFunds,110005:a.InvalidOrder,110006:a.InsufficientFunds,110007:a.InsufficientFunds,110008:a.InvalidOrder,110009:a.InvalidOrder,110010:a.InvalidOrder,110011:a.InvalidOrder,110012:a.InsufficientFunds,110013:a.BadRequest,110014:a.InsufficientFunds,110015:a.BadRequest,110016:a.InvalidOrder,110017:a.InvalidOrder,110018:a.BadRequest,110019:a.InvalidOrder,110020:a.InvalidOrder,110021:a.InvalidOrder,110022:a.InvalidOrder,110023:a.InvalidOrder,110024:a.BadRequest,110025:a.NoChange,110026:a.MarginModeAlreadySet,110027:a.NoChange,110028:a.BadRequest,110029:a.BadRequest,110030:a.InvalidOrder,110031:a.InvalidOrder,110032:a.InvalidOrder,110033:a.InvalidOrder,110034:a.InvalidOrder,110035:a.InvalidOrder,110036:a.InvalidOrder,110037:a.InvalidOrder,110038:a.InvalidOrder,110039:a.InvalidOrder,110040:a.InvalidOrder,110041:a.InvalidOrder,110042:a.InvalidOrder,110043:a.BadRequest,110044:a.InsufficientFunds,110045:a.InsufficientFunds,110046:a.BadRequest,110047:a.BadRequest,110048:a.BadRequest,110049:a.BadRequest,110050:a.BadRequest,110051:a.InsufficientFunds,110052:a.InsufficientFunds,110053:a.InsufficientFunds,110054:a.InvalidOrder,110055:a.InvalidOrder,110056:a.InvalidOrder,110057:a.InvalidOrder,110058:a.InvalidOrder,110059:a.InvalidOrder,110060:a.BadRequest,110061:a.BadRequest,110062:a.BadRequest,110063:a.ExchangeError,110064:a.InvalidOrder,110065:a.PermissionDenied,110066:a.ExchangeError,110067:a.PermissionDenied,110068:a.PermissionDenied,110069:a.PermissionDenied,110070:a.InvalidOrder,110071:a.ExchangeError,110072:a.InvalidOrder,110073:a.ExchangeError,110092:a.InvalidOrder,110093:a.InvalidOrder,110094:a.InvalidOrder,130006:a.InvalidOrder,130021:a.InsufficientFunds,130074:a.InvalidOrder,131001:a.InsufficientFunds,131084:a.ExchangeError,131200:a.ExchangeError,131201:a.ExchangeError,131202:a.BadRequest,131203:a.BadRequest,131204:a.BadRequest,131205:a.BadRequest,131206:a.ExchangeError,131207:a.BadRequest,131208:a.ExchangeError,131209:a.BadRequest,131210:a.BadRequest,131211:a.BadRequest,131212:a.InsufficientFunds,131213:a.BadRequest,131214:a.BadRequest,131215:a.BadRequest,131216:a.ExchangeError,131217:a.ExchangeError,131231:a.NotSupported,131232:a.NotSupported,131002:a.BadRequest,131003:a.ExchangeError,131004:a.AuthenticationError,131085:a.InsufficientFunds,131086:a.BadRequest,131088:a.BadRequest,131089:a.BadRequest,131090:a.ExchangeError,131091:a.ExchangeError,131092:a.ExchangeError,131093:a.ExchangeError,131094:a.BadRequest,131095:a.BadRequest,131096:a.BadRequest,131097:a.ExchangeError,131098:a.ExchangeError,131099:a.ExchangeError,140001:a.OrderNotFound,140003:a.InvalidOrder,140004:a.InsufficientFunds,140005:a.InvalidOrder,140006:a.InsufficientFunds,140007:a.InsufficientFunds,140008:a.InvalidOrder,140009:a.InvalidOrder,140010:a.InvalidOrder,140011:a.InvalidOrder,140012:a.InsufficientFunds,140013:a.BadRequest,140014:a.InsufficientFunds,140015:a.InvalidOrder,140016:a.InvalidOrder,140017:a.InvalidOrder,140018:a.BadRequest,140019:a.InvalidOrder,140020:a.InvalidOrder,140021:a.InvalidOrder,140022:a.InvalidOrder,140023:a.InvalidOrder,140024:a.BadRequest,140025:a.BadRequest,140026:a.BadRequest,140027:a.BadRequest,140028:a.InvalidOrder,140029:a.BadRequest,140030:a.InvalidOrder,140031:a.BadRequest,140032:a.InvalidOrder,140033:a.InvalidOrder,140034:a.InvalidOrder,140035:a.InvalidOrder,140036:a.BadRequest,140037:a.InvalidOrder,140038:a.BadRequest,140039:a.BadRequest,140040:a.InvalidOrder,140041:a.InvalidOrder,140042:a.InvalidOrder,140043:a.BadRequest,140044:a.InsufficientFunds,140045:a.InsufficientFunds,140046:a.BadRequest,140047:a.BadRequest,140048:a.BadRequest,140049:a.BadRequest,140050:a.InvalidOrder,140051:a.InsufficientFunds,140052:a.InsufficientFunds,140053:a.InsufficientFunds,140054:a.InvalidOrder,140055:a.InvalidOrder,140056:a.InvalidOrder,140057:a.InvalidOrder,140058:a.InvalidOrder,140059:a.InvalidOrder,140060:a.BadRequest,140061:a.BadRequest,140062:a.BadRequest,140063:a.ExchangeError,140064:a.InvalidOrder,140065:a.PermissionDenied,140066:a.ExchangeError,140067:a.PermissionDenied,140068:a.PermissionDenied,140069:a.PermissionDenied,140070:a.InvalidOrder,170001:a.ExchangeError,170005:a.InvalidOrder,170007:a.RequestTimeout,170010:a.InvalidOrder,170011:a.InvalidOrder,170019:a.InvalidOrder,170031:a.ExchangeError,170032:a.ExchangeError,170033:a.InsufficientFunds,170034:a.InsufficientFunds,170035:a.BadRequest,170036:a.BadRequest,170037:a.BadRequest,170105:a.BadRequest,170115:a.InvalidOrder,170116:a.InvalidOrder,170117:a.InvalidOrder,170121:a.InvalidOrder,170124:a.InvalidOrder,170130:a.BadRequest,170131:a.InsufficientFunds,170132:a.InvalidOrder,170133:a.InvalidOrder,170134:a.InvalidOrder,170135:a.InvalidOrder,170136:a.InvalidOrder,170137:a.InvalidOrder,170139:a.InvalidOrder,170140:a.InvalidOrder,170141:a.InvalidOrder,170142:a.InvalidOrder,170143:a.InvalidOrder,170144:a.InvalidOrder,170145:a.InvalidOrder,170146:a.InvalidOrder,170147:a.InvalidOrder,170148:a.InvalidOrder,170149:a.ExchangeError,170150:a.ExchangeError,170151:a.InvalidOrder,170157:a.InvalidOrder,170159:a.InvalidOrder,170190:a.InvalidOrder,170191:a.InvalidOrder,170192:a.InvalidOrder,170193:a.InvalidOrder,170194:a.InvalidOrder,170195:a.InvalidOrder,170196:a.InvalidOrder,170197:a.InvalidOrder,170198:a.InvalidOrder,170199:a.InvalidOrder,170200:a.InvalidOrder,170201:a.PermissionDenied,170202:a.InvalidOrder,170203:a.InvalidOrder,170204:a.InvalidOrder,170206:a.InvalidOrder,170210:a.InvalidOrder,170213:a.OrderNotFound,170217:a.InvalidOrder,170218:a.InvalidOrder,170221:a.BadRequest,170222:a.RateLimitExceeded,170223:a.InsufficientFunds,170224:a.PermissionDenied,170226:a.InsufficientFunds,170227:a.ExchangeError,170228:a.InvalidOrder,170229:a.InvalidOrder,170234:a.ExchangeError,170241:a.ManualInteractionNeeded,175e3:a.InvalidOrder,175001:a.InvalidOrder,175002:a.InvalidOrder,175003:a.InsufficientFunds,175004:a.InvalidOrder,175005:a.InvalidOrder,175006:a.InsufficientFunds,175007:a.InvalidOrder,175008:a.InvalidOrder,175009:a.InvalidOrder,175010:a.PermissionDenied,175012:a.InvalidOrder,175013:a.InvalidOrder,175014:a.InvalidOrder,175015:a.InvalidOrder,175016:a.InvalidOrder,175017:a.InvalidOrder,175027:a.ExchangeError,176002:a.BadRequest,176004:a.BadRequest,176003:a.BadRequest,176006:a.BadRequest,176005:a.BadRequest,176008:a.BadRequest,176007:a.BadRequest,176010:a.BadRequest,176009:a.BadRequest,176012:a.BadRequest,176011:a.BadRequest,176014:a.BadRequest,176013:a.BadRequest,176015:a.InsufficientFunds,176016:a.BadRequest,176017:a.BadRequest,176018:a.BadRequest,176019:a.BadRequest,176020:a.BadRequest,176021:a.BadRequest,176022:a.BadRequest,176023:a.BadRequest,176024:a.BadRequest,176025:a.BadRequest,176026:a.BadRequest,176027:a.BadRequest,176028:a.BadRequest,176029:a.BadRequest,176030:a.BadRequest,176031:a.BadRequest,176034:a.BadRequest,176035:a.PermissionDenied,176036:a.PermissionDenied,176037:a.PermissionDenied,176038:a.BadRequest,176039:a.BadRequest,176040:a.BadRequest,181e3:a.BadRequest,181001:a.BadRequest,181002:a.InvalidOrder,181003:a.InvalidOrder,181004:a.InvalidOrder,182e3:a.InvalidOrder,181017:a.BadRequest,20001:a.OrderNotFound,20003:a.InvalidOrder,20004:a.InvalidOrder,20005:a.InvalidOrder,20006:a.InvalidOrder,20007:a.InvalidOrder,20008:a.InvalidOrder,20009:a.InvalidOrder,20010:a.InvalidOrder,20011:a.InvalidOrder,20012:a.InvalidOrder,20013:a.InvalidOrder,20014:a.InvalidOrder,20015:a.InvalidOrder,20016:a.InvalidOrder,20017:a.InvalidOrder,20018:a.InvalidOrder,20019:a.InvalidOrder,20020:a.InvalidOrder,20021:a.InvalidOrder,20022:a.BadRequest,20023:a.BadRequest,20031:a.BadRequest,20070:a.BadRequest,20071:a.BadRequest,20084:a.BadRequest,30001:a.BadRequest,30003:a.InvalidOrder,30004:a.InvalidOrder,30005:a.InvalidOrder,30007:a.InvalidOrder,30008:a.InvalidOrder,30009:a.ExchangeError,30010:a.InsufficientFunds,30011:a.PermissionDenied,30012:a.PermissionDenied,30013:a.PermissionDenied,30014:a.InvalidOrder,30015:a.InvalidOrder,30016:a.ExchangeError,30017:a.InvalidOrder,30018:a.InvalidOrder,30019:a.InvalidOrder,30020:a.InvalidOrder,30021:a.InvalidOrder,30022:a.InvalidOrder,30023:a.InvalidOrder,30024:a.InvalidOrder,30025:a.InvalidOrder,30026:a.InvalidOrder,30027:a.InvalidOrder,30028:a.InvalidOrder,30029:a.InvalidOrder,30030:a.InvalidOrder,30031:a.InsufficientFunds,30032:a.InvalidOrder,30033:a.RateLimitExceeded,30034:a.OrderNotFound,30035:a.RateLimitExceeded,30036:a.ExchangeError,30037:a.InvalidOrder,30041:a.ExchangeError,30042:a.InsufficientFunds,30043:a.InvalidOrder,30044:a.InvalidOrder,30045:a.InvalidOrder,30049:a.InsufficientFunds,30050:a.ExchangeError,30051:a.ExchangeError,30052:a.ExchangeError,30054:a.ExchangeError,30057:a.ExchangeError,30063:a.ExchangeError,30067:a.InsufficientFunds,30068:a.ExchangeError,30074:a.InvalidOrder,30075:a.InvalidOrder,30078:a.ExchangeError,33004:a.AuthenticationError,34026:a.ExchangeError,34036:a.BadRequest,35015:a.BadRequest,340099:a.ExchangeError,3400045:a.ExchangeError,3100116:a.BadRequest,3100198:a.BadRequest,3200300:a.InsufficientFunds},broad:{"Not supported symbols":a.BadSymbol,"Request timeout":a.RequestTimeout,"unknown orderInfo":a.OrderNotFound,"invalid api_key":a.AuthenticationError,oc_diff:a.InsufficientFunds,new_oc:a.InsufficientFunds,"openapi sign params error!":a.AuthenticationError}},precisionMode:r.kb,options:{usePrivateInstrumentsInfo:!1,enableDemoTrading:!1,fetchMarkets:{types:["spot","linear","inverse","option"]},enableUnifiedMargin:void 0,enableUnifiedAccount:void 0,unifiedMarginStatus:void 0,createMarketBuyOrderRequiresPrice:!1,createUnifiedMarginAccount:!1,defaultType:"swap",defaultSubType:"linear",defaultSettle:"USDT",code:"BTC",recvWindow:5e3,timeDifference:0,adjustForTimeDifference:!1,loadAllOptions:!1,loadExpiredOptions:!1,brokerId:"CCXT",accountsByType:{spot:"SPOT",margin:"SPOT",future:"CONTRACT",swap:"CONTRACT",option:"OPTION",investment:"INVESTMENT",unified:"UNIFIED",funding:"FUND",fund:"FUND",contract:"CONTRACT"},accountsById:{SPOT:"spot",MARGIN:"spot",CONTRACT:"contract",OPTION:"option",INVESTMENT:"investment",UNIFIED:"unified",FUND:"fund"},networks:{ERC20:"ETH",TRC20:"TRX",BEP20:"BSC",SOL:"SOL",ACA:"ACA",ADA:"ADA",ALGO:"ALGO",APT:"APTOS",AR:"AR",ARBONE:"ARBI",AVAXC:"CAVAX",AVAXX:"XAVAX",ATOM:"ATOM",BCH:"BCH",BEP2:"BNB",CHZ:"CHZ",DCR:"DCR",DGB:"DGB",DOGE:"DOGE",DOT:"DOT",EGLD:"EGLD",EOS:"EOS",ETC:"ETC",ETHF:"ETHF",ETHW:"ETHW",FIL:"FIL",STEP:"FITFI",FLOW:"FLOW",FTM:"FTM",GLMR:"GLMR",HBAR:"HBAR",HNT:"HNT",ICP:"ICP",ICX:"ICX",KDA:"KDA",KLAY:"KLAY",KMA:"KMA",KSM:"KSM",LTC:"LTC",MATIC:"MATIC",MINA:"MINA",MOVR:"MOVR",NEAR:"NEAR",NEM:"NEM",OASYS:"OAS",OASIS:"ROSE",OMNI:"OMNI",ONE:"ONE",OPTIMISM:"OP",POKT:"POKT",QTUM:"QTUM",RVN:"RVN",SC:"SC",SCRT:"SCRT",STX:"STX",THETA:"THETA",TON:"TON",WAVES:"WAVES",WAX:"WAXP",XDC:"XDC",XEC:"XEC",XLM:"XLM",XRP:"XRP",XTZ:"XTZ",XYM:"XYM",ZEN:"ZEN",ZIL:"ZIL",ZKSYNC:"ZKSYNC"},networksById:{ETH:"ERC20",TRX:"TRC20",BSC:"BEP20",OMNI:"OMNI",SPL:"SOL"},defaultNetwork:"ERC20",defaultNetworks:{USDT:"TRC20"},intervals:{"5m":"5min","15m":"15min","30m":"30min","1h":"1h","4h":"4h","1d":"1d"},useMarkPriceForPositionCollateral:!1},features:{default:{sandbox:!0,createOrder:{marginMode:!1,triggerPrice:!0,triggerPriceType:{last:!0,mark:!0,index:!0},triggerDirection:!0,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:{triggerPriceType:{last:!0,mark:!0,index:!0},price:!0},timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!0,selfTradePrevention:!0,trailing:!0,iceberg:!1,leverage:!1,marketBuyRequiresPrice:!1,marketBuyByCost:!0},createOrders:{max:10},fetchMyTrades:{marginMode:!1,limit:100,daysBack:730,untilDays:7,symbolRequired:!1},fetchOrder:{marginMode:!1,trigger:!0,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!1,limit:50,trigger:!0,trailing:!1,symbolRequired:!1},fetchOrders:void 0,fetchClosedOrders:{marginMode:!1,limit:50,daysBack:730,daysBackCanceled:1,untilDays:7,trigger:!0,trailing:!1,symbolRequired:!1},fetchOHLCV:{limit:1e3},editOrders:{max:10}},spot:{extends:"default",fetchCurrencies:{private:!0},createOrder:{triggerPriceType:void 0,triggerDirection:!1,attachedStopLossTakeProfit:{triggerPriceType:void 0,price:!0},marketBuyRequiresPrice:!0}},swap:{linear:{extends:"default"},inverse:{extends:"default"}},future:{linear:{extends:"default"},inverse:{extends:"default"}}},fees:{trading:{feeSide:"get",tierBased:!0,percentage:!0,taker:75e-5,maker:1e-4},funding:{tierBased:!1,percentage:!1,withdraw:{},deposit:{}}}})}enableDemoTrading(t){if(this.isSandboxModeEnabled)throw new a.NotSupported(this.id+" demo trading does not support in sandbox environment");if(t)this.urls.apiBackupDemoTrading=this.urls.api,this.urls.api=this.urls.demotrading;else if("apiBackupDemoTrading"in this.urls){this.urls.api=this.urls.apiBackupDemoTrading;const t=this.omit(this.urls,"apiBackupDemoTrading");this.urls=t}this.options.enableDemoTrading=t}nonce(){return this.milliseconds()-this.options.timeDifference}addPaginationCursorToResult(t){const e=this.safeDict(t,"result",{}),i=this.safeListN(e,["list","rows","data","dataList"],[]),s=this.safeString2(e,"nextPageCursor","cursor"),r=i.length;if(void 0!==s&&r>0){const t=i[0];t.nextPageCursor=s,i[0]=t}return i}async isUnifiedEnabled(t={}){const e=this.safeBool(this.options,"enableUnifiedMargin"),i=this.safeBool(this.options,"enableUnifiedAccount");if(void 0===e||void 0===i){if(this.options.enableDemoTrading)return this.options.enableUnifiedMargin=!1,this.options.enableUnifiedAccount=!0,this.options.unifiedMarginStatus=6,[this.options.enableUnifiedMargin,this.options.enableUnifiedAccount];const e=[this.privateGetV5UserQueryApi(t),this.privateGetV5AccountInfo(t)],i=await Promise.all(e),s=i[0],r=i[1],a=this.safeDict(s,"result",{}),n=this.safeDict(r,"result",{});this.options.enableUnifiedMargin=1===this.safeInteger(a,"unified"),this.options.enableUnifiedAccount=1===this.safeInteger(a,"uta"),this.options.unifiedMarginStatus=this.safeInteger(n,"unifiedMarginStatus",6)}return[this.options.enableUnifiedMargin,this.options.enableUnifiedAccount]}async upgradeUnifiedTradeAccount(t={}){return await this.privatePostV5AccountUpgradeToUta(t)}createExpiredOptionMarket(t){let e,i;const s=t.split("-"),r=t.split("/");let a,n;if(t.indexOf("/")>-1){a=this.safeString(r,0),n=this.safeString(s,1);const t=this.safeString(r,1).split(":"),o=this.safeString(t,0);e=o,i=o}else a=this.safeString(s,0),n=this.convertMarketIdExpireDate(this.safeString(s,1)),t.endsWith("-USDT")?(e="USDT",i="USDT"):(e="USDC",i="USDC");const o=this.safeString(s,2),d=this.safeString(s,3),c=this.convertExpireDate(n),h=this.parse8601(c);let l,u;return"BTC"===a?(l=this.parseNumber("0.01"),u=this.parseNumber("5")):"ETH"===a?(l=this.parseNumber("0.1"),u=this.parseNumber("0.1")):"SOL"===a&&(l=this.parseNumber("1"),u=this.parseNumber("0.01")),{id:a+"-"+this.convertExpireDateToMarketIdDate(n)+"-"+o+"-"+d,symbol:a+"/"+e+":"+i+"-"+n+"-"+o+"-"+d,base:a,quote:e,settle:i,baseId:a,quoteId:e,settleId:i,active:!1,type:"option",linear:void 0,inverse:void 0,spot:!1,swap:!1,future:!1,option:!0,margin:!1,contract:!0,contractSize:this.parseNumber("1"),expiry:h,expiryDatetime:c,optionType:"C"===d?"call":"put",strike:this.parseNumber(o),precision:{amount:l,price:u},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:void 0}}safeMarket(t=void 0,e=void 0,i=void 0,s=void 0){return void 0!==t&&(t.indexOf("-C")>-1||t.indexOf("-P")>-1)&&!(t in this.markets_by_id)?this.createExpiredOptionMarket(t):super.safeMarket(t,e,i,s)}getBybitType(t,e,i={}){let s,r;return[s,i]=this.handleMarketTypeAndParams(t,e,i),[r,i]=this.handleSubTypeAndParams(t,e,i),"option"===s||"spot"===s?[s,i]:[r,i]}getAmount(t,e){const i=void 0===this.market(t).precision.amount,s=this.numberToString(e);return i||"0"===s?s:this.amountToPrecision(t,e)}getPrice(t,e){if(void 0===e)return e;return void 0===this.market(t).precision.price?e:this.priceToPrecision(t,e)}getCost(t,e){return void 0===this.market(t).precision.price?e:this.costToPrecision(t,e)}async fetchTime(t={}){const e=await this.publicGetV5MarketTime(t);return this.safeInteger(e,"time")}async fetchCurrencies(t={}){if(!this.checkRequiredCredentials(!1))return{};if(this.options.enableDemoTrading)return{};const e=await this.privateGetV5AssetCoinQueryInfo(t),i=this.safeDict(e,"result",{}),s=this.safeList(i,"rows",[]),r={};for(let t=0;t<s.length;t++){const e=s[t],i=this.safeString(e,"coin"),a=this.safeCurrencyCode(i),n=this.safeString(e,"name"),o=this.safeList(e,"chains",[]),d={};for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString(e,"chain"),s=this.networkIdToCode(i);d[s]={info:e,id:i,network:s,active:void 0,deposit:1===this.safeInteger(e,"chainDeposit"),withdraw:1===this.safeInteger(e,"chainWithdraw"),fee:this.safeNumber(e,"withdrawFee"),precision:this.parseNumber(this.parsePrecision(this.safeString(e,"minAccuracy"))),limits:{withdraw:{min:this.safeNumber(e,"withdrawMin"),max:void 0},deposit:{min:this.safeNumber(e,"depositMin"),max:void 0}}}}r[a]=this.safeCurrencyStructure({info:e,code:a,id:i,name:n,active:void 0,deposit:void 0,withdraw:void 0,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},networks:d,type:"crypto"})}return r}async fetchMarkets(t={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference();const e=[];let i;const s=["spot","linear","inverse","option"],r=this.safeDict(this.options,"fetchMarkets");i=void 0!==r?this.safeList(r,"types",s):this.safeList(this.options,"fetchMarkets",s);for(let s=0;s<i.length;s++){const r=i[s];if("spot"===r)e.push(this.fetchSpotMarkets(t));else if("linear"===r)e.push(this.fetchFutureMarkets({category:"linear"}));else if("inverse"===r)e.push(this.fetchFutureMarkets({category:"inverse"}));else{if("option"!==r)throw new a.ExchangeError(this.id+' fetchMarkets() this.options fetchMarkets "'+r+'" is not a supported market type');e.push(this.fetchOptionMarkets({baseCoin:"BTC"})),e.push(this.fetchOptionMarkets({baseCoin:"ETH"})),e.push(this.fetchOptionMarkets({baseCoin:"SOL"}))}}const n=await Promise.all(e),o=this.safeList(n,0,[]),d=this.safeList(n,1,[]),c=this.safeList(n,2,[]),h=this.safeList(n,3,[]),l=this.safeList(n,4,[]),u=this.safeList(n,5,[]),p=this.arrayConcat(d,c);let f=this.arrayConcat(h,l);f=this.arrayConcat(f,u);const m=this.arrayConcat(p,f);return this.arrayConcat(o,m)}async fetchSpotMarkets(t){const e={category:"spot"};let i;i=this.safeBool(this.options,"usePrivateInstrumentsInfo",!1)?await this.privateGetV5MarketInstrumentsInfo(this.extend(e,t)):await this.publicGetV5MarketInstrumentsInfo(this.extend(e,t));const s=this.safeDict(i,"result",{}),r=this.safeList(s,"list",[]),a=[],n=this.parseNumber("0.001"),o=this.parseNumber("0.001");for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString(e,"symbol"),s=this.safeString(e,"baseCoin"),d=this.safeString(e,"quoteCoin"),c=this.safeCurrencyCode(s),h=this.safeCurrencyCode(d),l=c+"/"+h,u="Trading"===this.safeString(e,"status"),p=this.safeDict(e,"lotSizeFilter"),f=this.safeDict(e,"priceFilter"),m=this.safeNumber(p,"quotePrecision"),g="none"!==this.safeString(e,"marginTrading","none");a.push(this.safeMarketStructure({id:i,symbol:l,base:c,quote:h,settle:void 0,baseId:s,quoteId:d,settleId:void 0,type:"spot",spot:!0,margin:g,swap:!1,future:!1,option:!1,active:u,contract:!1,linear:void 0,inverse:void 0,taker:n,maker:o,contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(p,"basePrecision"),price:this.safeNumber(f,"tickSize",m)},limits:{leverage:{min:this.parseNumber("1"),max:void 0},amount:{min:this.safeNumber(p,"minOrderQty"),max:this.safeNumber(p,"maxOrderQty")},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(p,"minOrderAmt"),max:this.safeNumber(p,"maxOrderAmt")}},created:void 0,info:e}))}return a}async fetchFutureMarkets(t){(t=this.extend(t)).limit=1e3;let e=[];const i=this.safeBool(this.options,"usePrivateInstrumentsInfo",!1);let s;if(i)s=await this.privateGetV5MarketInstrumentsInfo(t);else{const i=[this.publicGetV5MarketInstrumentsInfo(t),this.publicGetV5MarketInstrumentsInfo(this.extend(t,{status:"PreLaunch"}))],r=await Promise.all(i);s=this.safeDict(r,0,{}),e=this.safeDict(r,1,{})}const r=this.safeDict(s,"result",{});let a=this.safeList(r,"list",[]),n=this.safeString(r,"nextPageCursor");if(void 0!==n)for(;void 0!==n;){let e;t.cursor=n,e=i?await this.privateGetV5MarketInstrumentsInfo(t):await this.publicGetV5MarketInstrumentsInfo(t);const s=this.safeDict(e,"result",{}),r=this.safeList(s,"list",[]);if(0===r.length)break;a=this.arrayConcat(r,a),n=this.safeString(s,"nextPageCursor")}const o=this.safeDict(e,"result",{}),d=this.safeList(o,"list",[]);a=this.arrayConcat(a,d);const c=[];let h=this.safeString(r,"category");for(let t=0;t<a.length;t++){const e=a[t];void 0===h&&(h=this.safeString(e,"category"));const i="linear"===h,s="inverse"===h,r=this.safeString(e,"contractType"),n="InverseFutures"===r,o="LinearFutures"===r,d="LinearPerpetual"===r,l="InversePerpetual"===r,u=this.safeString(e,"symbol"),p=this.safeString(e,"baseCoin"),f=this.safeString(e,"quoteCoin"),m=i?f:p,g=this.safeString(e,"settleCoin",m),y=this.safeCurrencyCode(p),v=this.safeCurrencyCode(f);let b;b=d&&"USD"===g?"USDC":this.safeCurrencyCode(g);let w=y+"/"+v;const S=this.safeDict(e,"lotSizeFilter",{}),k=this.safeDict(e,"priceFilter",{}),O=this.safeDict(e,"leverageFilter",{}),T=this.safeString(e,"status"),P=d||l,_=n||o;let A,I;P?A="swap":_&&(A="future"),P||(I=this.omitZero(this.safeString(e,"deliveryTime")),void 0!==I&&(I=parseInt(I)));const x=this.iso8601(I);w=w+":"+b,void 0!==I&&(w=w+"-"+this.yymmdd(I));const E=s?this.safeNumber2(S,"minTradingQty","minOrderQty"):this.parseNumber("1");c.push(this.safeMarketStructure({id:u,symbol:w,base:y,quote:v,settle:b,baseId:p,quoteId:f,settleId:g,type:A,spot:!1,margin:void 0,swap:P,future:_,option:!1,active:"Trading"===T,contract:!0,linear:i,inverse:s,taker:this.safeNumber(e,"takerFee",this.parseNumber("0.0006")),maker:this.safeNumber(e,"makerFee",this.parseNumber("0.0001")),contractSize:E,expiry:I,expiryDatetime:x,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(S,"qtyStep"),price:this.safeNumber(k,"tickSize")},limits:{leverage:{min:this.safeNumber(O,"minLeverage"),max:this.safeNumber(O,"maxLeverage")},amount:{min:this.safeNumber2(S,"minTradingQty","minOrderQty"),max:this.safeNumber2(S,"maxTradingQty","maxOrderQty")},price:{min:this.safeNumber(k,"minPrice"),max:this.safeNumber(k,"maxPrice")},cost:{min:void 0,max:void 0}},created:this.safeInteger(e,"launchTime"),info:e}))}return c}async fetchOptionMarkets(t){const e={category:"option"},i=this.safeBool(this.options,"usePrivateInstrumentsInfo",!1);let s;s=i?await this.privateGetV5MarketInstrumentsInfo(this.extend(e,t)):await this.publicGetV5MarketInstrumentsInfo(this.extend(e,t));const r=this.safeDict(s,"result",{});let a=this.safeList(r,"list",[]);if(this.options.loadAllOptions){e.limit=1e3;let s=this.safeString(r,"nextPageCursor");if(void 0!==s)for(;void 0!==s;){let r;e.cursor=s,r=i?await this.privateGetV5MarketInstrumentsInfo(this.extend(e,t)):await this.publicGetV5MarketInstrumentsInfo(this.extend(e,t));const n=this.safeDict(r,"result",{}),o=this.safeList(n,"list",[]);if(0===o.length)break;a=this.arrayConcat(o,a),s=this.safeString(n,"nextPageCursor")}}const n=[];for(let t=0;t<a.length;t++){const e=a[t],i=this.safeString(e,"symbol"),s=this.safeString(e,"baseCoin"),r=this.safeString(e,"quoteCoin"),o=this.safeString(e,"settleCoin"),d=this.safeCurrencyCode(s),c=this.safeCurrencyCode(r),h=this.safeCurrencyCode(o),l=this.safeDict(e,"lotSizeFilter",{}),u=this.safeDict(e,"priceFilter",{}),p=this.safeString(e,"status"),f=this.safeInteger(e,"deliveryTime"),m=i.split("-"),g=this.safeString(m,2),y=this.safeString(m,3),v="Trading"===p,b=d===h;(v||this.options.loadAllOptions||this.options.loadExpiredOptions)&&n.push(this.safeMarketStructure({id:i,symbol:d+"/"+c+":"+h+"-"+this.yymmdd(f)+"-"+g+"-"+y,base:d,quote:c,settle:h,baseId:s,quoteId:r,settleId:o,type:"option",subType:void 0,spot:!1,margin:!1,swap:!1,future:!1,option:!0,active:v,contract:!0,linear:!b,inverse:b,taker:this.safeNumber(e,"takerFee",this.parseNumber("0.0006")),maker:this.safeNumber(e,"makerFee",this.parseNumber("0.0001")),contractSize:this.parseNumber("1"),expiry:f,expiryDatetime:this.iso8601(f),strike:this.parseNumber(g),optionType:this.safeStringLower(e,"optionsType"),precision:{amount:this.safeNumber(l,"qtyStep"),price:this.safeNumber(u,"tickSize")},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(l,"minOrderQty"),max:this.safeNumber(l,"maxOrderQty")},price:{min:this.safeNumber(u,"minPrice"),max:this.safeNumber(u,"maxPrice")},cost:{min:void 0,max:void 0}},created:this.safeInteger(e,"launchTime"),info:e}))}return n}parseTicker(t,e=void 0){const i=void 0===this.safeString(t,"openInterestValue"),s=this.safeInteger(t,"time"),r=this.safeString(t,"symbol"),a=i?"spot":"contract";e=this.safeMarket(r,e,void 0,a);const o=this.safeSymbol(r,e,void 0,a),d=this.safeString(t,"lastPrice"),c=this.safeString(t,"prevPrice24h");let h=this.safeString(t,"price24hPcnt");h=n.Y.stringMul(h,"100");const l=this.safeString(t,"turnover24h"),u=this.safeString(t,"volume24h"),p=this.safeString(t,"bid1Price"),f=this.safeString(t,"ask1Price"),m=this.safeString(t,"highPrice24h"),g=this.safeString(t,"lowPrice24h");return this.safeTicker({symbol:o,timestamp:s,datetime:this.iso8601(s),high:m,low:g,bid:p,bidVolume:this.safeString2(t,"bidSize","bid1Size"),ask:f,askVolume:this.safeString2(t,"askSize","ask1Size"),vwap:void 0,open:c,close:d,last:d,previousClose:void 0,change:void 0,percentage:h,average:void 0,baseVolume:u,quoteVolume:l,markPrice:this.safeString(t,"markPrice"),indexPrice:this.safeString(t,"indexPrice"),info:t},e)}async fetchTicker(t,e={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchTicker() requires a symbol argument");await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r;[r,e]=this.getBybitType("fetchTicker",i,e),s.category=r;const n=await this.publicGetV5MarketTickers(this.extend(s,e)),o=this.safeDict(n,"result",{}),d=this.safeList(o,"list",[]),c=this.safeDict(d,0);return this.parseTicker(c,i)}async fetchTickers(t=void 0,e={}){await this.loadMarkets();let i,s,r=this.safeStringN(e,["code","currency","baseCoin"]);if(void 0!==t){s=[];const n=this.handleMarketTypeAndParams("fetchTickers",void 0,e)[0];let o;for(let d=0;d<t.length;d++){const c=t[d];if(i=-1===c.indexOf("/")?this.safeMarket(c,void 0,void 0,n):this.market(c),void 0===o)o=i.type;else if(i.type!==o)throw new a.BadRequest(this.id+" fetchTickers can only accept a list of symbols of the same type");if(i.option){if(void 0!==r&&r!==i.base)throw new a.BadRequest(this.id+" fetchTickers the base currency must be the same for all symbols, this endpoint only supports one base currency at a time. Read more about it here: https://bybit-exchange.github.io/docs/v5/market/tickers");void 0===r&&(r=i.base),e=this.omit(e,["code","currency"])}s.push(i.symbol)}}const n={};let o;[o,e]=this.getBybitType("fetchTickers",i,e),n.category=o,"option"===o&&(n.category="option",void 0===r&&(r="BTC"),n.baseCoin=r);const d=await this.publicGetV5MarketTickers(this.extend(n,e)),c=this.safeDict(d,"result",{}),h=this.safeList(c,"list",[]);return this.parseTickers(h,s)}async fetchBidsAsks(t=void 0,e={}){return await this.fetchTickers(t,e)}parseOHLCV(t,e=void 0){const i=e.inverse?6:5;return[this.safeInteger(t,0),this.safeNumber(t,1),this.safeNumber(t,2),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,i)]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchOHLCV() requires a symbol argument");await this.loadMarkets();let n=!1;if([n,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate"),n)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,1e3);const o=this.market(t);let d,c={symbol:o.id};if(void 0===s&&(s=200),void 0!==i&&(c.start=i),void 0!==s&&(c.limit=s),[c,r]=this.handleUntilOption("end",c,r),c.interval=this.safeString(this.timeframes,e,e),o.spot)c.category="spot",d=await this.publicGetV5MarketKline(this.extend(c,r));else{const t=this.safeString(r,"price");if(r=this.omit(r,"price"),o.linear)c.category="linear";else{if(!o.inverse)throw new a.NotSupported(this.id+" fetchOHLCV() is not supported for option markets");c.category="inverse"}d="mark"===t?await this.publicGetV5MarketMarkPriceKline(this.extend(c,r)):"index"===t?await this.publicGetV5MarketIndexPriceKline(this.extend(c,r)):"premiumIndex"===t?await this.publicGetV5MarketPremiumIndexPriceKline(this.extend(c,r)):await this.publicGetV5MarketKline(this.extend(c,r))}const h=this.safeDict(d,"result",{}),l=this.safeList(h,"list",[]);return this.parseOHLCVs(l,o,e,i,s)}parseFundingRate(t,e=void 0){const i=this.safeInteger(t,"timestamp");t=this.omit(t,"timestamp");const s=this.safeString(t,"symbol"),r=this.safeSymbol(s,e,void 0,"swap"),a=this.safeNumber(t,"fundingRate"),n=this.safeInteger(t,"nextFundingTime"),o=this.safeNumber(t,"markPrice"),d=this.safeNumber(t,"indexPrice"),c=this.safeDict(this.safeMarket(s,e,void 0,"swap"),"info"),h=this.safeInteger(c,"fundingInterval");let l;if(void 0!==h){l=this.parseToInt(h/60).toString()+"h"}return{info:t,symbol:r,markPrice:o,indexPrice:d,interestRate:void 0,estimatedSettlePrice:void 0,timestamp:i,datetime:this.iso8601(i),fundingRate:a,fundingTimestamp:n,fundingDatetime:this.iso8601(n),nextFundingRate:void 0,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:l}}async fetchFundingRates(t=void 0,e={}){let i;await this.loadMarkets();const s={};if(void 0!==t){t=this.marketSymbols(t),i=this.market(t[0]);1===t.length&&(s.symbol=i.id)}let r;if([r,e]=this.handleMarketTypeAndParams("fetchFundingRates",i,e),"swap"!==r)throw new a.NotSupported(this.id+" fetchFundingRates() does not support "+r+" markets");{let t;[t,e]=this.handleSubTypeAndParams("fetchFundingRates",i,e,"linear"),s.category=t}const n=await this.publicGetV5MarketTickers(this.extend(s,e)),o=this.safeDict(n,"result",{}),d=this.safeList(o,"list",[]),c=this.safeInteger(n,"time");for(let t=0;t<d.length;t++)d[t].timestamp=c;return this.parseFundingRates(d,t)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),r)return await this.fetchPaginatedCallDeterministic("fetchFundingRateHistory",t,e,i,"8h",s,200);void 0===i&&(i=200);const n={limit:i},o=this.market(t);let d;if(t=o.symbol,n.symbol=o.id,[d,s]=this.getBybitType("fetchFundingRateHistory",o,s),"spot"===d||"option"===d)throw new a.NotSupported(this.id+" fetchFundingRateHistory() only support linear and inverse market");n.category=d,void 0!==e&&(n.startTime=e);const c=this.safeInteger(s,"until"),h=this.safeInteger(s,"endTime",c);if(s=this.omit(s,["endTime","until"]),void 0!==h)n.endTime=h;else if(void 0!==e){const t=288e5;n.endTime=e+i*t}const l=await this.publicGetV5MarketFundingHistory(this.extend(n,s)),u=[],p=this.safeDict(l,"result"),f=this.safeList(p,"list");for(let t=0;t<f.length;t++){const e=f[t],i=this.safeInteger(e,"fundingRateTimestamp");u.push({info:e,symbol:this.safeSymbol(this.safeString(e,"symbol"),void 0,void 0,"swap"),fundingRate:this.safeNumber(e,"fundingRate"),timestamp:i,datetime:this.iso8601(i)})}const m=this.sortBy(u,"timestamp");return this.filterBySymbolSinceLimit(m,t,e,i)}parseTrade(t,e=void 0){const i=this.safeStringN(t,["execId","id","tradeId"]),s=this.safeString(t,"symbol");let r="createType"in t?"contract":"spot";const a=this.safeString(t,"category");void 0!==a&&(r="spot"===a?"spot":"contract"),void 0!==e&&(r=e.type);const o=(e=this.safeMarket(s,e,void 0,r)).symbol,d=this.safeStringN(t,["execQty","orderQty","size"]),c=this.safeStringN(t,["execPrice","orderPrice","price"]),h=this.safeString(t,"execValue"),l=this.safeIntegerN(t,["time","execTime","tradeTime"]);let u=this.safeStringLower(t,"side");if(void 0===u){const e=this.safeInteger(t,"isBuyer");void 0!==e&&(u=e?"buy":"sell")}const p=this.safeBool(t,"isMaker");let f;if(void 0!==p)f=p?"maker":"taker";else{let e=this.safeString(t,"lastLiquidityInd");"UNKNOWN"===e&&(e=void 0),void 0!==e&&(f="TAKER"===e||"MAKER"===e?e.toLowerCase():"AddedLiquidity"===e?"maker":"taker")}let m=this.safeStringLower(t,"orderType");"unknown"===m&&(m=void 0);const g=this.safeString(t,"execFee");let y;if(void 0!==g){const i=this.safeString(t,"feeRate");let s;s=e.spot?n.Y.stringGt(g,"0")?"buy"===u?e.base:e.quote:"buy"===u?e.quote:e.base:e.inverse?e.base:e.settle,y={cost:g,currency:this.safeString(t,"feeCoin",s),rate:i}}return this.safeTrade({id:i,info:t,timestamp:l,datetime:this.iso8601(l),symbol:o,order:this.safeString(t,"orderId"),type:m,side:u,takerOrMaker:f,price:c,amount:d,cost:h,fee:y},e)}async fetchTrades(t,e=void 0,i=void 0,s={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchTrades() requires a symbol argument");await this.loadMarkets();const r=this.market(t),n={symbol:r.id};let o;void 0!==i&&(n.limit=i),[o,s]=this.getBybitType("fetchTrades",r,s),n.category=o;const d=await this.publicGetV5MarketRecentTrade(this.extend(n,s)),c=this.safeDict(d,"result",{}),h=this.safeList(c,"list",[]);return this.parseTrades(h,r,e,i)}async fetchOrderBook(t,e=void 0,i={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchOrderBook() requires a symbol argument");await this.loadMarkets();const s=this.market(t),r={symbol:s.id};let n=25;s.spot?(n=50,r.category="spot"):s.option?r.category="option":s.linear?r.category="linear":s.inverse&&(r.category="inverse"),r.limit=void 0!==e?e:n;const o=await this.publicGetV5MarketOrderbook(this.extend(r,i)),d=this.safeDict(o,"result",{}),c=this.safeInteger(d,"ts");return this.parseOrderBook(d,t,c,"b","a")}parseBalance(t){const e=this.safeInteger(t,"time"),i={info:t,timestamp:e,datetime:this.iso8601(e)},s=this.safeDict(t,"result",{}),r=this.safeListN(s,["loanAccountList","list","balance"]);if(void 0===r){const t="USDC",e=this.account();e.free=this.safeString(s,"availableBalance"),e.total=this.safeString(s,"walletBalance"),i[t]=e}else for(let t=0;t<r.length;t++){const e=r[t],s=this.safeString(e,"accountType");if("UNIFIED"===s||"CONTRACT"===s||"SPOT"===s){const t=this.safeList(e,"coin");for(let e=0;e<t.length;e++){const s=this.account(),r=t[e],a=this.safeString(r,"borrowAmount"),o=this.safeString(r,"accruedInterest");void 0!==a&&void 0!==o&&(s.debt=n.Y.stringAdd(a,o)),s.total=this.safeString(r,"walletBalance");const d=this.safeString2(r,"availableToWithdraw","free");if(void 0!==d)s.free=d;else{const t=this.safeString(r,"locked","0"),e=this.safeString(r,"totalPositionIM","0"),i=this.safeString(r,"totalOrderIM","0");let a=n.Y.stringAdd(t,e);a=n.Y.stringAdd(a,i),s.used=a}const c=this.safeString(r,"coin");i[this.safeCurrencyCode(c)]=s}}else{const t=this.account(),s=this.safeString(e,"loan"),r=this.safeString(e,"interest");void 0!==s&&void 0!==r&&(t.debt=n.Y.stringAdd(s,r)),t.total=this.safeString2(e,"total","walletBalance"),t.free=this.safeStringN(e,["free","availableBalanceWithoutConvert","availableBalance","transferBalance"]),t.used=this.safeString(e,"locked");const a=this.safeStringN(e,["tokenId","coin","currencyCoin"]);i[this.safeCurrencyCode(a)]=t}}return this.safeBalance(i)}async fetchBalance(t={}){await this.loadMarkets();const e={},[i,s]=await this.isUnifiedEnabled(),r=i||s;let a,n;[a,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t),[n,t]=this.handleSubTypeAndParams("fetchBalance",void 0,t),"swap"!==a&&"future"!==a||(a=n);const o=void 0!==a?a.toLowerCase():void 0,d="spot"===a,c="linear"===a,h="inverse"===a,l="fund"===o||"funding"===o;if(r){a=this.safeInteger(this.options,"unifiedMarginStatus",6)<5&&h?"contract":"unified"}else(c||h)&&(a="contract");const u=this.safeDict(this.options,"accountsByType",{}),p=this.safeStringUpper(u,a,a);let f,m;return[f,t]=this.handleMarginModeAndParams("fetchBalance",t),d&&void 0!==f?m=await this.privateGetV5SpotCrossMarginTradeAccount(this.extend(e,t)):l?(e.accountType="FUND",m=await this.privateGetV5AssetTransferQueryAccountCoinsBalance(this.extend(e,t))):(e.accountType=p,m=await this.privateGetV5AccountWalletBalance(this.extend(e,t))),this.parseBalance(m)}parseOrderStatus(t){return this.safeString({NEW:"open",PARTIALLY_FILLED:"open",FILLED:"closed",CANCELED:"canceled",PENDING_CANCEL:"open",PENDING_NEW:"open",REJECTED:"rejected",PARTIALLY_FILLED_CANCELLED:"closed",Created:"open",New:"open",Rejected:"rejected",PartiallyFilled:"open",PartiallyFilledCanceled:"closed",Filled:"closed",PendingCancel:"open",Cancelled:"canceled",Untriggered:"open",Deactivated:"canceled",Triggered:"open",Active:"open"},t,t)}parseTimeInForce(t){return this.safeString({GoodTillCancel:"GTC",ImmediateOrCancel:"IOC",FillOrKill:"FOK",PostOnly:"PO"},t,t)}parseOrder(t,e=void 0){const i=this.safeString(t,"code");if(void 0!==i&&"0"!==i){const e="spot"===this.safeString(t,"category")?"spot":"contract";return this.safeOrder({info:t,status:"rejected",id:this.safeString(t,"orderId"),clientOrderId:this.safeString(t,"orderLinkId"),symbol:this.safeSymbol(this.safeString(t,"symbol"),void 0,void 0,e)})}const s=this.safeString(t,"symbol"),r="tpslMode"in t;let a;a=void 0!==e?e.type:r?"contract":"spot";const n=(e=this.safeMarket(s,e,void 0,a)).symbol,o=this.safeInteger2(t,"createdTime","createdAt"),d=this.safeString(t,"marketUnit","baseCoin"),c=this.safeString(t,"orderId"),h=this.safeStringLower(t,"orderType"),l=this.safeString(t,"price");let u,p;"baseCoin"===d?(u=this.safeString(t,"qty"),p=this.safeString(t,"cumExecValue")):p=this.safeString(t,"cumExecValue");const f=this.safeString(t,"cumExecQty"),m=this.safeString(t,"leavesQty"),g=this.safeInteger2(t,"updatedTime","updatedAt"),y=this.safeString(t,"orderStatus"),v=this.parseOrderStatus(y),b=this.safeStringLower(t,"side");let w;const S=this.safeDict(t,"cumFeeDetail",{}),k=Object.keys(S),O=this.safeString(k,0);void 0!==O&&(w={cost:this.safeNumber(S,O),currency:O});let T=this.safeString(t,"orderLinkId");void 0!==T&&T.length<1&&(T=void 0);const P=this.omitZero(this.safeString(t,"avgPrice")),_=this.safeString(t,"timeInForce"),A=this.parseTimeInForce(_),I=this.omitZero(this.safeString(t,"triggerPrice")),x=this.safeBool(t,"reduceOnly");let E=this.omitZero(this.safeString(t,"takeProfit")),M=this.omitZero(this.safeString(t,"stopLoss"));const C="1"===this.safeString(t,"triggerDirection"),B=void 0!==I&&x;return void 0===M&&B&&(C&&"buy"===b&&(M=I),C||"sell"!==b||(M=I)),void 0===E&&B&&(C&&"sell"===b&&(E=I),C||"buy"!==b||(E=I)),this.safeOrder({info:t,id:c,clientOrderId:T,timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:g,lastUpdateTimestamp:g,symbol:n,type:h,timeInForce:A,postOnly:void 0,reduceOnly:this.safeBool(t,"reduceOnly"),side:b,price:l,triggerPrice:I,takeProfitPrice:E,stopLossPrice:M,amount:u,cost:p,average:P,filled:f,remaining:m,status:v,fee:w,trades:void 0},e)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new a.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");const s={cost:e};return await this.createOrder(t,"market","buy",-1,void 0,this.extend(s,i))}async createMarketSellOrderWithCost(t,e,i={}){await this.loadMarkets();if(!(await this.isUnifiedEnabled())[1])throw new a.NotSupported(this.id+" createMarketSellOrderWithCost() supports UTA accounts only");if(!this.market(t).spot)throw new a.NotSupported(this.id+" createMarketSellOrderWithCost() supports spot orders only");const s={cost:e};return await this.createOrder(t,"market","sell",-1,void 0,this.extend(s,i))}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=(await this.isUnifiedEnabled())[1],d=void 0!==this.safeString2(a,"trailingAmount","trailingStop"),c=void 0!==this.safeString(a,"stopLossPrice"),h=void 0!==this.safeString(a,"takeProfitPrice"),l=this.createOrderRequest(t,e,i,s,r,a,o),u=c&&h||this.safeBool(a,"tradingStopEndpoint",!1);let p,f,m;p=!d&&!u||n.spot?"privatePostV5OrderCreate":"privatePostV5PositionTradingStop",[f,a]=this.handleOptionAndParams(a,"createOrder","method",p),m="privatePostV5PositionTradingStop"===f?await this.privatePostV5PositionTradingStop(l):await this.privatePostV5OrderCreate(l);const g=this.safeDict(m,"result",{});return this.parseOrder(g,n)}createOrderRequest(t,e,i,s,r=void 0,o={},d=!0){const c=this.market(t);t=c.symbol;const h=e.toLowerCase(),l={symbol:c.id},u=this.safeBool(o,"hedged",!1),p=this.safeBool(o,"reduceOnly");let f=this.safeValue2(o,"triggerPrice","stopPrice");const m=this.safeValue(o,"stopLossPrice"),g=this.safeValue(o,"takeProfitPrice"),y=this.safeValue(o,"stopLoss"),v=this.safeValue(o,"takeProfit"),b=this.safeString2(o,"trailingTriggerPrice","activePrice",this.numberToString(r)),w=this.safeString2(o,"trailingAmount","trailingStop"),S=void 0!==w,k=void 0!==f,O=void 0!==m,T=void 0!==g,P=void 0!==y,_=void 0!==v,A="market"===h,I="limit"===h,x="buy"===i,E=O&&T||this.safeBool(o,"tradingStopEndpoint",!1);let M,C;M=S||E?"privatePostV5PositionTradingStop":"privatePostV5OrderCreate",[C,o]=this.handleOptionAndParams(o,"createOrder","method",M);const B="privatePostV5PositionTradingStop"===C;if(void 0===r&&"limit"===h&&!B)throw new a.ArgumentsRequired(this.id+" createOrder requires a price argument for limit orders");n.Y.stringGt(this.numberToString(s),"0")||(s=void 0);const N=void 0!==s?this.getAmount(t,s):void 0,R=void 0!==r?this.getPrice(t,this.numberToString(r)):void 0;if(B){if(P||_||k||c.spot)throw new a.InvalidOrder(this.id+" the API endpoint used only supports contract trailingAmount, stopLossPrice and takeProfitPrice orders");if(O||T){let e,i;if(O){l.stopLoss=this.getPrice(t,m);const i=this.safeString2(o,"stopLossLimitPrice","slLimitPrice");void 0!==i?(e="Partial",l.slOrderType="Limit",l.slLimitPrice=i,l.slSize=N):(l.slOrderType="Market",void 0!==N?(l.slSize=N,e="Partial"):e="Full")}if(T){l.takeProfit=this.getPrice(t,g);const e=this.safeString2(o,"takeProfitLimitPrice","tpLimitPrice");void 0!==e?(i="Partial",l.tpOrderType="Limit",l.tpLimitPrice=e,l.tpSize=N):(l.tpOrderType="Market",void 0!==N?(l.tpSize=N,i="Partial"):i="Full")}if(e!==i)throw new a.InvalidOrder(this.id+" createOrder() requires both stopLoss and takeProfit to be full or partial when using as OCO combination");l.tpslMode=e,o=this.omit(o,["stopLossLimitPrice","takeProfitLimitPrice"])}}else{l.side=this.capitalize(i),l.orderType=this.capitalize(h);const t=this.safeStringLower(o,"timeInForce");let e;[e,o]=this.handlePostOnly(A,"postonly"===t,o),e?l.timeInForce="PostOnly":"gtc"===t?l.timeInForce="GTC":"fok"===t?l.timeInForce="FOK":"ioc"===t&&(l.timeInForce="IOC"),c.spot&&(void 0!==f?l.orderFilter="StopOrder":(O||T)&&(l.orderFilter="tpslOrder"));const s=this.safeString(o,"clientOrderId");void 0!==s?l.orderLinkId=s:c.option&&(l.orderLinkId=this.uuid16()),I&&(l.price=R)}let L;[L,o]=this.getBybitType("createOrderRequest",c,o),l.category=L;const D=this.safeString(o,"cost");o=this.omit(o,"cost");const q="market"===h&&"buy"===i&&(void 0!==r||void 0!==D),F="market"===h;if(c.spot&&F&&d&&!q)if(void 0!==D||void 0!==r){let e;if(l.marketUnit="quoteCoin",void 0!==D)e=D;else{e=n.Y.stringMul(N,R)}l.qty=this.getCost(t,e)}else l.marketUnit="baseCoin",l.qty=N;else if(c.spot&&F&&"buy"===i){let e=!0;if([e,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice"),e){if(void 0===r&&void 0===D)throw new a.InvalidOrder(this.id+" createOrder() requires the price argument for market buy orders to calculate the total cost to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend in the amount argument");{const e=n.Y.stringMul(this.numberToString(s),R),i=void 0!==D?D:e;l.qty=this.getCost(t,i)}}else l.qty=void 0!==D?this.getCost(t,this.numberToString(D)):void 0!==r?this.getCost(t,n.Y.stringMul(N,R)):N}else S||B||(l.qty=N);if(S)void 0!==b&&(l.activePrice=this.getPrice(t,b)),l.trailingStop=w;else if(k&&!B){const e=this.safeString(o,"triggerDirection");if(o=this.omit(o,["triggerPrice","stopPrice","triggerDirection"]),c.spot){if(void 0!==e)throw new a.NotSupported(this.id+" createOrder() : trigger order does not support triggerDirection for spot markets yet")}else{if(void 0===e)throw new a.ArgumentsRequired(this.id+' stop/trigger orders require a triggerDirection parameter, either "ascending" or "descending" to determine the direction of the trigger.');const t="ascending"===e||"above"===e||"1"===e;l.triggerDirection=t?1:2}l.triggerPrice=this.getPrice(t,f)}else!O&&!T||B||(l.triggerDirection=x?O?1:2:O?2:1,f=O?m:g,l.triggerPrice=this.getPrice(t,f),l.reduceOnly=!0);if((P||_)&&!B){if(P){const e=this.safeValue2(y,"triggerPrice","stopPrice",y);l.stopLoss=this.getPrice(t,e);const i=this.safeValue(y,"price");if(void 0!==i?(l.tpslMode="Partial",l.slOrderType="Limit",l.slLimitPrice=this.getPrice(t,i)):c.spot&&(l.slOrderType="Market"),c.spot&&F)throw new a.InvalidOrder(this.id+" createOrder(): attached stopLoss is not supported for spot market orders")}if(_){const e=this.safeValue2(v,"triggerPrice","stopPrice",v);l.takeProfit=this.getPrice(t,e);const i=this.safeValue(v,"price");if(void 0!==i?(l.tpslMode="Partial",l.tpOrderType="Limit",l.tpLimitPrice=this.getPrice(t,i)):c.spot&&(l.tpOrderType="Market"),c.spot&&F)throw new a.InvalidOrder(this.id+" createOrder(): attached takeProfit is not supported for spot market orders")}}return!c.spot&&u&&(p&&(o=this.omit(o,"reduceOnly"),i="buy"===i?"sell":"buy"),l.positionIdx="buy"===i?1:2),o=this.omit(o,["stopPrice","timeInForce","stopLossPrice","takeProfitPrice","postOnly","clientOrderId","triggerPrice","stopLoss","takeProfit","trailingAmount","trailingTriggerPrice","hedged"]),this.extend(l,o)}async createOrders(t,e={}){await this.loadMarkets();const i=(await this.isUnifiedEnabled())[1],s=[],r=[];for(let e=0;e<t.length;e++){const a=t[e],n=this.safeString(a,"symbol");r.push(n);const o=this.safeString(a,"type"),d=this.safeString(a,"side"),c=this.safeValue(a,"amount"),h=this.safeValue(a,"price"),l=this.safeDict(a,"params",{}),u=this.createOrderRequest(n,o,d,c,h,l,i);delete u.category,s.push(u)}const n=this.marketSymbols(r,void 0,!1,!0,!0),o=this.market(n[0]),d=this.safeInteger(this.options,"unifiedMarginStatus",6);let c;if([c,e]=this.getBybitType("createOrders",o,e),"inverse"===c&&d<5)throw new a.NotSupported(this.id+" createOrders does not allow inverse orders for non UTA2.0 account");const h={category:c,request:s},l=await this.privatePostV5OrderCreateBatch(this.extend(h,e)),u=this.safeDict(l,"result",{}),p=this.safeList(u,"list",[]),f=this.safeDict(l,"retExtInfo",{}),m=this.safeList(f,"list",[]);for(let t=0;t<m.length;t++){const e=m[t];0!==this.safeInteger(e,"code")&&(p[t]=this.extend(p[t],e))}return this.parseOrders(p)}editOrderRequest(t,e,i,s,r=void 0,a=void 0,n={}){const o=this.market(e),d={symbol:o.id},c=this.safeString2(n,"orderLinkId","clientOrderId");let h;void 0===c?d.orderId=t:d.orderLinkId=c,[h,n]=this.getBybitType("editOrderRequest",o,n),d.category=h,void 0!==r&&(d.qty=this.getAmount(e,r)),void 0!==a&&(d.price=this.getPrice(e,this.numberToString(a)));let l=this.safeString2(n,"triggerPrice","stopPrice");const u=this.safeString(n,"stopLossPrice"),p=this.safeString(n,"takeProfitPrice"),f=this.safeValue(n,"stopLoss"),m=this.safeValue(n,"takeProfit"),g=void 0!==u,y=void 0!==f,v=void 0!==m;if((g||void 0!==p)&&(l=g?u:p),void 0!==l){const t="0"===l?l:this.getPrice(e,l);d.triggerPrice=t;const i=this.safeString(n,"triggerBy","LastPrice");d.triggerBy=i}if(y||v){if(y){const t=this.safeString2(f,"triggerPrice","stopPrice",f),i="0"===t?t:this.getPrice(e,t);d.stopLoss=i;const s=this.safeString(n,"slTriggerBy","LastPrice");d.slTriggerBy=s}if(v){const t=this.safeString2(m,"triggerPrice","stopPrice",m),i="0"===t?t:this.getPrice(e,t);d.takeProfit=i;const s=this.safeString(n,"tpTriggerBy","LastPrice");d.tpTriggerBy=s}}return n=this.omit(n,["stopPrice","stopLossPrice","takeProfitPrice","triggerPrice","clientOrderId","stopLoss","takeProfit"]),d}async editOrder(t,e,i,s,r=void 0,n=void 0,o={}){if(await this.loadMarkets(),void 0===e)throw new a.ArgumentsRequired(this.id+" editOrder() requires a symbol argument");const d=this.market(e),c=this.editOrderRequest(t,e,i,s,r,n,o),h=await this.privatePostV5OrderAmend(this.extend(c,o)),l=this.safeDict(h,"result",{});return this.safeOrder({info:h,id:this.safeString(l,"orderId"),clientOrderId:this.safeString(l,"orderLinkId")},d)}async editOrders(t,e={}){await this.loadMarkets();const i=[];let s=[];for(let e=0;e<t.length;e++){const r=t[e],a=this.safeString(r,"symbol");s.push(a);const n=this.safeString(r,"id"),o=this.safeString(r,"type"),d=this.safeString(r,"side"),c=this.safeValue(r,"amount"),h=this.safeValue(r,"price"),l=this.safeDict(r,"params",{}),u=this.editOrderRequest(n,a,o,d,c,h,l);delete u.category,i.push(u)}s=this.marketSymbols(s,void 0,!1,!0,!0);const r=this.market(s[0]),n=this.safeInteger(this.options,"unifiedMarginStatus",6);let o;if([o,e]=this.getBybitType("editOrders",r,e),"inverse"===o&&n<5)throw new a.NotSupported(this.id+" editOrders does not allow inverse orders for non UTA2.0 account");const d={category:o,request:i},c=await this.privatePostV5OrderAmendBatch(this.extend(d,e)),h=this.safeDict(c,"result",{}),l=this.safeList(h,"list",[]),u=this.safeDict(c,"retExtInfo",{}),p=this.safeList(u,"list",[]);for(let t=0;t<p.length;t++){const e=p[t];0!==this.safeInteger(e,"code")&&(l[t]=this.extend(l[t],e))}return this.parseOrders(l)}cancelOrderRequest(t,e=void 0,i={}){const s=this.market(e),r={symbol:s.id};if(s.spot){const t=this.safeBool2(i,"stop","trigger",!1);i=this.omit(i,["stop","trigger"]),r.orderFilter=t?"StopOrder":"Order"}let a;return void 0!==t&&(r.orderId=t),[a,i]=this.getBybitType("cancelOrderRequest",s,i),r.category=a,this.extend(r,i)}async cancelOrder(t,e=void 0,i={}){if(void 0===e)throw new a.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),r=this.cancelOrderRequest(t,e,i),n=await this.privatePostV5OrderCancel(r),o=this.safeDict(n,"result",{});return this.parseOrder(o,s)}async cancelOrders(t,e=void 0,i={}){if(void 0===e)throw new a.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e);if(!(await this.isUnifiedEnabled())[1])throw new a.NotSupported(this.id+" cancelOrders() supports UTA accounts only");let r;if([r,i]=this.getBybitType("cancelOrders",s,i),"inverse"===r)throw new a.NotSupported(this.id+" cancelOrders does not allow inverse orders");const n=[],o=this.safeList2(i,"clientOrderIds","clientOids",[]);i=this.omit(i,["clientOrderIds","clientOids"]);for(let t=0;t<o.length;t++)n.push({symbol:s.id,orderLinkId:this.safeString(o,t)});for(let e=0;e<t.length;e++)n.push({symbol:s.id,orderId:this.safeString(t,e)});const d={category:r,request:n},c=await this.privatePostV5OrderCancelBatch(this.extend(d,i)),h=this.safeDict(c,"result",{}),l=this.safeList(h,"list",[]);return this.parseOrders(l,s)}async cancelAllOrdersAfter(t,e={}){await this.loadMarkets();const i={timeWindow:this.parseToInt(t/1e3)};let s;[s,e]=this.handleMarketTypeAndParams("cancelAllOrdersAfter",void 0,e,"swap");const r=this.safeString({spot:"SPOT",swap:"DERIVATIVES",option:"OPTIONS"},s,s);i.product=r;return await this.privatePostV5OrderDisconnectedCancelAll(this.extend(i,e))}async cancelOrdersForSymbols(t,e={}){await this.loadMarkets();if(!(await this.isUnifiedEnabled())[1])throw new a.NotSupported(this.id+" cancelOrdersForSymbols() supports UTA accounts only");const i=[];let s;for(let r=0;r<t.length;r++){const n=t[r],o=this.safeString(n,"symbol"),d=this.market(o);let c;if([c,e]=this.getBybitType("cancelOrders",d,e),"inverse"===c)throw new a.NotSupported(this.id+" cancelOrdersForSymbols does not allow inverse orders");if(void 0!==s&&s!==c)throw new a.ExchangeError(this.id+" cancelOrdersForSymbols requires all orders to be of the same category (linear, spot or option))");s=c;const h=this.safeString(n,"id"),l=this.safeString(n,"clientOrderId");let u="orderId";void 0!==l&&(u="orderLinkId");const p={symbol:d.id};p[u]="orderId"===u?h:l,i.push(p)}const r={category:s,request:i},n=await this.privatePostV5OrderCancelBatch(this.extend(r,e)),o=this.safeDict(n,"result",{}),d=this.safeList(o,"list",[]);return this.parseOrders(d,void 0)}async cancelAllOrders(t=void 0,e={}){await this.loadMarkets();const[i,s]=await this.isUnifiedEnabled(),r=i||s;let n;const o={};let d;if(void 0!==t&&(n=this.market(t),o.symbol=n.id),[d,e]=this.getBybitType("cancelAllOrders",n,e),o.category=d,"option"===d&&!r)throw new a.NotSupported(this.id+" cancelAllOrders() Normal Account not support "+d+" market");if("linear"===d||"inverse"===d){const i=this.safeString(e,"baseCoin");if(void 0===t&&void 0===i){const t=this.safeString(this.options,"defaultSettle","USDT");o.settleCoin=this.safeString(e,"settleCoin",t)}}const c=this.safeBool2(e,"stop","trigger",!1);e=this.omit(e,["stop","trigger"]),c&&(o.orderFilter="StopOrder");const h=await this.privatePostV5OrderCancelAll(this.extend(o,e)),l=this.safeDict(h,"result",{}),u=this.safeList(l,"list");return Array.isArray(u)?this.parseOrders(u,n):[this.safeOrder({info:h})]}async fetchOrderClassic(t,e=void 0,i={}){if(void 0===e)throw new a.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();if(this.market(e).spot)throw new a.NotSupported(this.id+" fetchOrder() is not supported for spot markets");const s={orderId:t},r=await this.fetchOrders(e,void 0,void 0,this.extend(s,i)),n=r.length;if(0===n){const e=this.safeBoolN(i,["trigger","stop"],!1)?"":' If you are trying to fetch SL/TP conditional order, you might try setting params["trigger"] = true';throw new a.OrderNotFound("Order "+t.toString()+" was not found."+e)}if(n>1)throw new a.InvalidOrder(this.id+" returned more than one order");return this.safeValue(r,0)}async fetchOrder(t,e=void 0,i={}){await this.loadMarkets();const[s,r]=await this.isUnifiedEnabled();if(!(s||r))return await this.fetchOrderClassic(t,e,i);let n=!1;if([n,i]=this.handleOptionAndParams(i,"fetchOrder","acknowledged"),!n)throw new a.ArgumentsRequired(this.id+' fetchOrder() can only access an order if it is in last 500 orders (of any status) for your account. Set params["acknowledged"] = true to hide this warning. Alternatively, we suggest to use fetchOpenOrder or fetchClosedOrder');const o=this.market(e);let d;[d,i]=this.getBybitType("fetchOrder",o,i);const c={symbol:o.id,orderId:t,category:d};let h;[h,i]=this.handleParamBool2(i,"trigger","stop",!1),h&&(c.orderFilter="StopOrder");const l=await this.privateGetV5OrderRealtime(this.extend(c,i)),u=this.safeDict(l,"result",{}),p=this.safeList(u,"list",[]);if(0===p.length){const e=h?"":' If you are trying to fetch SL/TP conditional order, you might try setting params["trigger"] = true';throw new a.OrderNotFound("Order "+t.toString()+" was not found."+e)}const f=this.safeDict(p,0,{});return this.parseOrder(f,o)}async fetchOrders(t=void 0,e=void 0,i=void 0,s={}){const r=await this.isUnifiedEnabled();if(this.safeBool(r,1))throw new a.NotSupported(this.id+" fetchOrders() is not supported after the 5/02 update for UTA accounts, please use fetchOpenOrders, fetchClosedOrders or fetchCanceledOrders");return await this.fetchOrdersClassic(t,e,i,s)}async fetchOrdersClassic(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchOrders","paginate"),r)return await this.fetchPaginatedCallCursor("fetchOrders",t,e,i,s,"nextPageCursor","cursor",void 0,50);const n={};let o,d;if(void 0!==t&&(o=this.market(t),n.symbol=o.id),[d,s]=this.getBybitType("fetchOrders",o,s),"spot"===d)throw new a.NotSupported(this.id+" fetchOrders() is not supported for spot markets");n.category=d;const c=this.safeBoolN(s,["trigger","stop"],!1);s=this.omit(s,["trigger","stop"]),c&&(n.orderFilter="StopOrder"),void 0!==i&&(n.limit=i),void 0!==e&&(n.startTime=e);const h=this.safeInteger(s,"until"),l=this.safeInteger(s,"endTime",h);s=this.omit(s,["endTime","until"]),void 0!==l&&(n.endTime=l);const u=await this.privateGetV5OrderHistory(this.extend(n,s)),p=this.addPaginationCursorToResult(u);return this.parseOrders(p,o,e,i)}async fetchClosedOrder(t,e=void 0,i={}){await this.loadMarkets();const s={orderId:t},r=await this.fetchClosedOrders(e,void 0,void 0,this.extend(s,i)),n=r.length;if(0===n){const e=this.safeBoolN(i,["trigger","stop"],!1)?"":' If you are trying to fetch SL/TP conditional order, you might try setting params["trigger"] = true';throw new a.OrderNotFound("Order "+t.toString()+" was not found."+e)}if(n>1)throw new a.InvalidOrder(this.id+" returned more than one order");return this.safeValue(r,0)}async fetchOpenOrder(t,e=void 0,i={}){await this.loadMarkets();const s={orderId:t},r=await this.fetchOpenOrders(e,void 0,void 0,this.extend(s,i)),n=r.length;if(0===n){const e=this.safeBoolN(i,["trigger","stop"],!1)?"":' If you are trying to fetch SL/TP conditional order, you might try setting params["trigger"] = true';throw new a.OrderNotFound("Order "+t.toString()+" was not found."+e)}if(n>1)throw new a.InvalidOrder(this.id+" returned more than one order");return this.safeValue(r,0)}async fetchCanceledAndClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchCanceledAndClosedOrders","paginate"),r)return await this.fetchPaginatedCallCursor("fetchCanceledAndClosedOrders",t,e,i,s,"nextPageCursor","cursor",void 0,50);const a={};let n,o;void 0!==t&&(n=this.market(t),a.symbol=n.id),[o,s]=this.getBybitType("fetchCanceledAndClosedOrders",n,s),a.category=o;const d=this.safeBoolN(s,["trigger","stop"],!1);s=this.omit(s,["trigger","stop"]),d&&(a.orderFilter="StopOrder"),void 0!==i&&(a.limit=i),void 0!==e&&(a.startTime=e);const c=this.safeInteger(s,"until"),h=this.safeInteger(s,"endTime",c);s=this.omit(s,["endTime","until"]),void 0!==h&&(a.endTime=h);const l=await this.privateGetV5OrderHistory(this.extend(a,s)),u=this.addPaginationCursorToResult(l);return this.parseOrders(u,n,e,i)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();return await this.fetchCanceledAndClosedOrders(t,e,i,this.extend({orderStatus:"Filled"},s))}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();return await this.fetchCanceledAndClosedOrders(t,e,i,this.extend({orderStatus:"Cancelled"},s))}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchOpenOrders","paginate"),r)return await this.fetchPaginatedCallCursor("fetchOpenOrders",t,e,i,s,"nextPageCursor","cursor",void 0,50);const a={};let n,o;if(void 0!==t&&(n=this.market(t),a.symbol=n.id),[o,s]=this.getBybitType("fetchOpenOrders",n,s),"linear"===o||"inverse"===o){const e=this.safeString(s,"baseCoin");if(void 0===t&&void 0===e){const t=this.safeString(this.options,"defaultSettle","USDT"),e=this.safeString(s,"settleCoin",t);a.settleCoin=e}}a.category=o;const d=this.safeBool2(s,"stop","trigger",!1);s=this.omit(s,["stop","trigger"]),d&&(a.orderFilter="StopOrder"),void 0!==i&&(a.limit=i);const c=await this.privateGetV5OrderRealtime(this.extend(a,s)),h=this.addPaginationCursorToResult(c);return this.parseOrders(h,n,e,i)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){const a={},n=this.safeString2(r,"clientOrderId","orderLinkId");return void 0!==n?a.orderLinkId=n:a.orderId=t,r=this.omit(r,["clientOrderId","orderLinkId"]),await this.fetchMyTrades(e,i,s,this.extend(a,r))}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),r)return await this.fetchPaginatedCallCursor("fetchMyTrades",t,e,i,s,"nextPageCursor","cursor",void 0,100);let a,n,o={execType:"Trade"};void 0!==t&&(a=this.market(t),o.symbol=a.id),[n,s]=this.getBybitType("fetchMyTrades",a,s),o.category=n,void 0!==i&&(o.limit=i),void 0!==e&&(o.startTime=e),[o,s]=this.handleUntilOption("endTime",o,s);const d=await this.privateGetV5ExecutionList(this.extend(o,s)),c=this.addPaginationCursorToResult(d);return this.parseTrades(c,a,e,i)}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"addressDeposit"),s=this.safeString(t,"tagDeposit"),r=this.safeString(e,"code");return this.checkAddress(i),{info:t,currency:r,network:this.networkIdToCode(this.safeString(t,"chain"),r),address:i,tag:s}}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();let i=this.currency(t);const s={coin:i.id};let r;[r,e]=this.handleNetworkCodeAndParams(e),void 0!==r&&(s.chainType=this.networkCodeToId(r,t));const a=await this.privateGetV5AssetDepositQueryAddress(this.extend(s,e)),n=this.safeDict(a,"result",{}),o=this.safeList(n,"chains",[]),d=this.safeString(n,"coin");i=this.currency(d);const c=this.parseDepositAddresses(o,[i.code],!1,{currency:i.code});return this.indexBy(c,"network")}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),[s,r]=this.handleNetworkCodeAndParams(e),a=await this.fetchDepositAddressesByNetwork(t,r);return a[this.selectNetworkCodeFromUnifiedNetworks(i.code,s,a)]}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),r)return await this.fetchPaginatedCallCursor("fetchDeposits",t,e,i,s,"nextPageCursor","cursor",void 0,50);let a,n={};void 0!==t&&(a=this.currency(t),n.coin=a.id),void 0!==e&&(n.startTime=e),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("endTime",n,s);const o=await this.privateGetV5AssetDepositQueryRecord(this.extend(n,s)),d=this.addPaginationCursorToResult(o);return this.parseTransactions(d,a,e,i)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),r)return await this.fetchPaginatedCallCursor("fetchWithdrawals",t,e,i,s,"nextPageCursor","cursor",void 0,50);let a,n={};void 0!==t&&(a=this.currency(t),n.coin=a.id),void 0!==e&&(n.startTime=e),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("endTime",n,s);const o=await this.privateGetV5AssetWithdrawQueryRecord(this.extend(n,s)),d=this.addPaginationCursorToResult(o);return this.parseTransactions(d,a,e,i)}parseTransactionStatus(t){return this.safeString({0:"unknown",1:"pending",2:"processing",3:"ok",4:"fail",SecurityCheck:"pending",Pending:"pending",success:"ok",CancelByUser:"canceled",Reject:"rejected",Fail:"failed",BlockchainConfirmed:"ok"},t,t)}parseTransaction(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeCurrencyCode(i,e),r=this.safeInteger2(t,"createTime","successAt"),a=this.safeInteger(t,"updateTime"),n=this.parseTransactionStatus(this.safeString(t,"status")),o=this.safeNumber2(t,"depositFee","withdrawFee"),d="depositFee"in t?"deposit":"withdrawal";let c;void 0!==o&&(c={cost:o,currency:s});const h=this.safeString(t,"toAddress");return{info:t,id:this.safeString2(t,"id","withdrawId"),txid:this.safeString(t,"txID"),timestamp:r,datetime:this.iso8601(r),network:this.networkIdToCode(this.safeString(t,"chain")),address:void 0,addressTo:h,addressFrom:void 0,tag:this.safeString(t,"tag"),tagTo:void 0,tagFrom:void 0,type:d,amount:this.safeNumber(t,"amount"),currency:s,status:n,updated:a,fee:c,internal:void 0,comment:void 0}}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),r)return await this.fetchPaginatedCallCursor("fetchLedger",t,e,i,s,"nextPageCursor","cursor",void 0,50);const a={},n=await this.isUnifiedEnabled();let o,d,c,h="coin";if(n[1]?(h="currency",void 0!==e&&(a.startTime=e)):void 0!==e&&(a.start_date=this.yyyymmdd(e)),void 0!==t&&(o=this.currency(t),a[h]=o.id),void 0!==i&&(a.limit=i),[d,s]=this.handleSubTypeAndParams("fetchLedger",void 0,s),n[1]){const t=this.safeInteger(this.options,"unifiedMarginStatus",5);c="inverse"===d&&t<5?await this.privateGetV5AccountContractTransactionLog(this.extend(a,s)):await this.privateGetV5AccountTransactionLog(this.extend(a,s))}else c=await this.privateGetV5AccountContractTransactionLog(this.extend(a,s));const l=this.addPaginationCursorToResult(c);return this.parseLedger(l,o,e,i)}parseLedgerEntry(t,e=void 0){const i=this.safeString2(t,"coin","currency"),s=this.safeCurrencyCode(i,e);e=this.safeCurrency(i,e);const r=this.safeString2(t,"amount","change"),a=this.safeString2(t,"wallet_balance","cashBalance"),o=n.Y.stringLt(r,"0")?"out":"in";let d,c,h;if(void 0!==a&&void 0!==r){const t="out"===o?r:n.Y.stringNeg(r);d=this.parseToNumeric(n.Y.stringAdd(a,t)),c=this.parseToNumeric(a),h=this.parseToNumeric(n.Y.stringAbs(r))}let l=this.parse8601(this.safeString(t,"exec_time"));return void 0===l&&(l=this.safeInteger(t,"transactionTime")),this.safeLedgerEntry({info:t,id:this.safeString(t,"id"),direction:o,account:this.safeString(t,"wallet_id"),referenceId:this.safeString(t,"tx_id"),referenceAccount:void 0,type:this.parseLedgerEntryType(this.safeString(t,"type")),currency:s,amount:h,timestamp:l,datetime:this.iso8601(l),before:d,after:c,status:"ok",fee:{currency:s,cost:this.safeNumber(t,"fee")}},e)}parseLedgerEntryType(t){return this.safeString({Deposit:"transaction",Withdraw:"transaction",RealisedPNL:"trade",Commission:"fee",Refund:"cashback",Prize:"prize",ExchangeOrderWithdraw:"transaction",ExchangeOrderDeposit:"transaction",TRANSFER_IN:"transaction",TRANSFER_OUT:"transaction",TRADE:"trade",SETTLEMENT:"trade",DELIVERY:"trade",LIQUIDATION:"trade",BONUS:"Prize",FEE_REFUND:"cashback",INTEREST:"transaction",CURRENCY_BUY:"trade",CURRENCY_SELL:"trade"},t,t)}async withdraw(t,e,i,s=void 0,r={}){let a;[s,r]=this.handleWithdrawTagAndParams(s,r);const n=(await this.isUnifiedEnabled())[1];[a,r]=this.handleOptionAndParams(r,"withdraw","accountType"),void 0===a&&(a=n?"UTA":"SPOT"),await this.loadMarkets(),this.checkAddress(i);const o=this.currency(t),d={coin:o.id,amount:this.numberToString(e),address:i,timestamp:this.milliseconds(),accountType:a};void 0!==s&&(d.tag=s);const[c,h]=this.handleNetworkCodeAndParams(r),l=this.networkCodeToId(c);void 0!==l&&(d.chain=l.toUpperCase());const u=await this.privatePostV5AssetWithdrawCreate(this.extend(d,h)),p=this.safeDict(u,"result",{});return this.parseTransaction(p,o)}async fetchPosition(t,e={}){if(void 0===t)throw new a.ArgumentsRequired(this.id+" fetchPosition() requires a symbol argument");await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r,n;[n,e]=this.getBybitType("fetchPosition",i,e),s.category=n,r=await this.privateGetV5PositionList(this.extend(s,e));const o=this.safeDict(r,"result",{}),d=this.safeList2(o,"list","dataList",[]),c=this.safeInteger(r,"time"),h=this.safeDict(d,0,{}),l=this.parsePosition(h,i);return l.timestamp=c,l.datetime=this.iso8601(c),l}async fetchPositions(t=void 0,e={}){await this.loadMarkets();let i,s=!1;if([s,e]=this.handleOptionAndParams(e,"fetchPositions","paginate"),s)return await this.fetchPaginatedCallCursor("fetchPositions",t,void 0,void 0,e,"nextPageCursor","cursor",void 0,200);if(void 0!==t&&Array.isArray(t)){const e=t.length;if(e>1)throw new a.ArgumentsRequired(this.id+" fetchPositions() does not accept an array with more than one symbol");1===e&&(i=t[0]),t=this.marketSymbols(t)}else void 0!==t&&(i=t,t=[this.symbol(i)]);const r={};let n,o;if(void 0!==i&&(n=this.market(i),i=n.symbol,r.symbol=n.id),[o,e]=this.getBybitType("fetchPositions",n,e),"linear"===o||"inverse"===o){const t=this.safeString(e,"baseCoin");if("linear"===o){if(void 0===i&&void 0===t){const t=this.safeString(this.options,"defaultSettle","USDT"),i=this.safeString(e,"settleCoin",t);r.settleCoin=i}}else void 0===i&&void 0===t&&(r.category="inverse")}void 0===this.safeInteger(e,"limit")&&(r.limit=200),e=this.omit(e,["type"]),r.category=o;const d=await this.privateGetV5PositionList(this.extend(r,e)),c=this.addPaginationCursorToResult(d),h=[];for(let t=0;t<c.length;t++){let e=c[t];"data"in e&&"is_valid"in e&&(e=this.safeDict(e,"data")),h.push(this.parsePosition(e))}return this.filterByArrayPositions(h,"symbol",t,!1)}parsePosition(t,e=void 0){const i=void 0!==this.safeString(t,"closedSize"),s=this.safeString(t,"symbol");e=this.safeMarket(s,e,void 0,"contract");const r=n.Y.stringAbs(this.safeString2(t,"size","qty"));let a=this.safeString(t,"side");void 0!==a&&(a="Buy"===a?i?"short":"long":"Sell"===a?i?"long":"short":void 0);const o=this.safeString2(t,"positionValue","cumExitValue"),d=this.omitZero(this.safeString(t,"unrealisedPnl"));let c=this.safeString2(t,"positionIM","cumEntryValue"),h=this.safeString(t,"positionMM");const l=this.safeIntegerN(t,["createdTime","createdAt"]);let u=this.parse8601(this.safeString(t,"updated_at"));void 0===u&&(u=this.safeIntegerN(t,["updatedTime","updatedAt","updatedTime"]));const p=this.safeInteger(t,"tradeMode",0);let f;(!this.options.enableUnifiedAccount||this.options.enableUnifiedAccount&&e.inverse)&&(i||(f=1===p?"isolated":"cross"));let m=this.safeString(t,"positionBalance");const g=this.omitZero(this.safeStringN(t,["entryPrice","avgPrice","avgEntryPrice"])),y=this.safeString(t,"markPrice"),v=this.omitZero(this.safeString(t,"liqPrice")),b=this.safeString(t,"leverage");if(void 0!==v)if("USDC"===e.settle){const t=this.safeBool(this.options,"useMarkPriceForPositionCollateral",!1)?y:g,e=n.Y.stringAbs(n.Y.stringSub(t,v));m=n.Y.stringAdd(n.Y.stringAdd(n.Y.stringMul(e,r),h),d)}else{const i=this.safeString(t,"bustPrice");if(e.linear){const t=n.Y.stringAbs(n.Y.stringSub(v,i));h=n.Y.stringMul(t,r),void 0!==g&&void 0===c&&(c=n.Y.stringDiv(n.Y.stringMul(r,g),b))}else{const t=n.Y.stringAbs(n.Y.stringSub(i,v)),e=n.Y.stringMul(i,v);h=n.Y.stringDiv(n.Y.stringMul(r,t),e),void 0!==g&&void 0===c&&(c=n.Y.stringDiv(r,n.Y.stringMul(g,b)))}}const w=n.Y.stringDiv(h,o),S=n.Y.stringDiv(h,m,4),k=this.safeString(t,"positionIdx"),O=void 0!==k&&"0"!==k;return this.safePosition({info:t,id:void 0,symbol:e.symbol,timestamp:l,datetime:this.iso8601(l),lastUpdateTimestamp:u,initialMargin:this.parseNumber(c),initialMarginPercentage:this.parseNumber(n.Y.stringDiv(c,o)),maintenanceMargin:this.parseNumber(h),maintenanceMarginPercentage:this.parseNumber(w),entryPrice:this.parseNumber(g),notional:this.parseNumber(o),leverage:this.parseNumber(b),unrealizedPnl:this.parseNumber(d),realizedPnl:this.safeNumber(t,"closedPnl"),contracts:this.parseNumber(r),contractSize:this.safeNumber(e,"contractSize"),marginRatio:this.parseNumber(S),liquidationPrice:this.parseNumber(v),markPrice:this.parseNumber(y),lastPrice:this.safeNumber(t,"avgExitPrice"),collateral:this.parseNumber(m),marginMode:f,side:a,percentage:void 0,stopLossPrice:this.safeNumber2(t,"stop_loss","stopLoss"),takeProfitPrice:this.safeNumber2(t,"take_profit","takeProfit"),hedged:O})}async fetchLeverage(t,e={}){await this.loadMarkets();const i=this.market(t),s=await this.fetchPosition(t,e);return this.parseLeverage(s,i)}parseLeverage(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeInteger(t,"leverage");return{info:t,symbol:this.safeSymbol(i,e),marginMode:this.safeStringLower(t,"marginMode"),longLeverage:s,shortLeverage:s}}async setMarginMode(t,e=void 0,i={}){await this.loadMarkets();const[s,r]=await this.isUnifiedEnabled();let n,o;if(s||r){if("isolated"===t)t="ISOLATED_MARGIN";else if("cross"===t)t="REGULAR_MARGIN";else{if("portfolio"!==t)throw new a.NotSupported(this.id+" setMarginMode() marginMode must be either [isolated, cross, portfolio]");t="PORTFOLIO_MARGIN"}const e={setMarginMode:t};o=await this.privatePostV5AccountSetMarginMode(this.extend(e,i))}else{if(void 0===e)throw new a.ArgumentsRequired(this.id+" setMarginMode() requires a symbol parameter for non unified account");n=this.market(e);if("USDC"===n.settle){if("cross"===t)t="REGULAR_MARGIN";else{if("portfolio"!==t)throw new a.NotSupported(this.id+" setMarginMode() for usdc market marginMode must be either [cross, portfolio]");t="PORTFOLIO_MARGIN"}const e={setMarginMode:t};o=await this.privatePostV5AccountSetMarginMode(this.extend(e,i))}else{let e,s,r,d;if([e,i]=this.getBybitType("setPositionMode",n,i),"cross"===t)s=0;else{if("isolated"!==t)throw new a.NotSupported(this.id+" setMarginMode() with symbol marginMode must be either [isolated, cross]");s=1}const c=this.safeString(i,"leverage");if(void 0===c){if(r=this.safeString2(i,"sell_leverage","sellLeverage"),d=this.safeString2(i,"buy_leverage","buyLeverage"),void 0===r&&void 0===d)throw new a.ArgumentsRequired(this.id+" setMarginMode() requires a leverage parameter or sell_leverage and buy_leverage parameters");void 0===d&&(d=r),void 0===r&&(r=d),i=this.omit(i,["buy_leverage","sell_leverage","sellLeverage","buyLeverage"])}else r=c,d=c,i=this.omit(i,"leverage");const h={category:e,symbol:n.id,tradeMode:s,buyLeverage:d,sellLeverage:r};o=await this.privatePostV5PositionSwitchIsolated(this.extend(h,i))}}return o}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new a.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");await this.loadMarkets();const s=this.market(e),r=this.numberToString(t),n={symbol:s.id,buyLeverage:r,sellLeverage:r};if(n.buyLeverage=r,n.sellLeverage=r,s.linear)n.category="linear";else{if(!s.inverse)throw new a.NotSupported(this.id+" setLeverage() only support linear and inverse market");n.category="inverse"}return await this.privatePostV5PositionSetLeverage(this.extend(n,i))}async setPositionMode(t,e=void 0,i={}){let s,r;await this.loadMarkets(),void 0!==e&&(s=this.market(e)),r=t?3:0;const a={mode:r};if(void 0===e?a.coin="USDT":a.symbol=s.id,void 0!==e)a.category=s.linear?"linear":"inverse";else{let t;[t,i]=this.getBybitType("setPositionMode",s,i),a.category=t}i=this.omit(i,"type");return await this.privatePostV5PositionSwitchMode(this.extend(a,i))}async fetchDerivativesOpenInterestHistory(t,e="1h",i=void 0,s=void 0,r={}){await this.loadMarkets();let n=this.market(t);const o=n.linear?"linear":"inverse",d=this.safeString(r,"category",o),c=this.safeDict(this.options,"intervals"),h=this.safeString(c,e);if(void 0===h)throw new a.BadRequest(this.id+" fetchOpenInterestHistory() cannot use the "+e+" timeframe");const l={symbol:n.id,intervalTime:h,category:d};void 0!==i&&(l.startTime=i);const u=this.safeInteger(r,"until");r=this.omit(r,["until"]),void 0!==u&&(l.endTime=u),void 0!==s&&(l.limit=s);const p=await this.publicGetV5MarketOpenInterest(this.extend(l,r)),f=this.safeDict(p,"result",{}),m=this.addPaginationCursorToResult(p),g=this.safeString(f,"symbol");return n=this.safeMarket(g,n,void 0,"contract"),this.parseOpenInterestsHistory(m,n,i,s)}async fetchOpenInterest(t,e={}){await this.loadMarkets();let i=this.market(t);if(!i.contract)throw new a.BadRequest(this.id+" fetchOpenInterest() supports contract markets only");const s=this.safeString(e,"interval","1h"),r=this.safeDict(this.options,"intervals"),n=this.safeString(r,s);if(void 0===n)throw new a.BadRequest(this.id+" fetchOpenInterest() cannot use the "+s+" timeframe");const o=i.linear?"linear":"inverse",d=this.safeString(e,"category",o),c={symbol:i.id,intervalTime:n,category:d},h=await this.publicGetV5MarketOpenInterest(this.extend(c,e)),l=this.safeDict(h,"result",{}),u=this.safeString(l,"symbol");i=this.safeMarket(u,i,void 0,"contract");const p=this.addPaginationCursorToResult(h);return this.parseOpenInterest(p[0],i)}async fetchOpenInterestHistory(t,e="1h",i=void 0,s=void 0,r={}){if("1m"===e)throw new a.BadRequest(this.id+" fetchOpenInterestHistory cannot use the 1m timeframe");await this.loadMarkets();if(this.safeBool(r,"paginate"))return(r=this.omit(r,"paginate")).timeframe=e,await this.fetchPaginatedCallCursor("fetchOpenInterestHistory",t,i,s,r,"nextPageCursor","cursor",void 0,200);const n=this.market(t);if(n.spot||n.option)throw new a.BadRequest(this.id+" fetchOpenInterestHistory() symbol does not support market "+t);const o={symbol:n.id};return void 0!==s&&(o.limit=s),await this.fetchDerivativesOpenInterestHistory(t,e,i,s,r)}parseOpenInterest(t,e=void 0){const i=this.safeInteger(t,"timestamp"),s=this.safeNumber2(t,"open_interest","openInterest"),r=e.linear?s:void 0,a=e.inverse?s:void 0;return this.safeOpenInterest({symbol:e.symbol,openInterestAmount:r,openInterestValue:a,timestamp:i,datetime:this.iso8601(i),info:t},e)}async fetchCrossBorrowRate(t,e={}){await this.loadMarkets();const i=this.currency(t),s={coin:i.id},r=await this.privateGetV5SpotCrossMarginTradeLoanInfo(this.extend(s,e)),a=this.safeInteger(r,"time"),n=this.safeDict(r,"result",{});return n.timestamp=a,this.parseBorrowRate(n,i)}parseBorrowRate(t,e=void 0){const i=this.safeInteger(t,"timestamp"),s=this.safeString2(t,"coin","currency"),r=this.safeNumber(t,"hourlyBorrowRate"),a=void 0!==r?36e5:864e5;return{currency:this.safeCurrencyCode(s,e),rate:this.safeNumber(t,"interestRate",r),period:a,timestamp:i,datetime:this.iso8601(i),info:t}}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a=await this.privateGetV5SpotCrossMarginTradeAccount(this.extend({},r)),n=this.safeDict(a,"result",{}),o=this.safeList(n,"loanAccountList",[]),d=this.parseBorrowInterests(o,void 0);return this.filterByCurrencySinceLimit(d,t,i,s)}async fetchBorrowRateHistory(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={currency:this.currency(t).id};void 0===e&&(e=this.milliseconds()-2592e6),r.startTime=e;let a=this.safeInteger2(s,"until","endTime");s=this.omit(s,["until"]),void 0===a&&(a=e+2592e6),r.endTime=a;const n=await this.privateGetV5SpotMarginTradeInterestRateHistory(this.extend(r,s)),o=this.safeDict(n,"result"),d=this.safeList(o,"list",[]);return this.parseBorrowRateHistory(d,t,e,i)}parseBorrowInterest(t,e=void 0){return{info:t,symbol:void 0,currency:this.safeCurrencyCode(this.safeString(t,"tokenId")),interest:this.safeNumber(t,"interest"),interestRate:void 0,amountBorrowed:this.safeNumber(t,"loan"),marginMode:"cross",timestamp:void 0,datetime:void 0}}async transfer(t,e,i,s,r={}){await this.loadMarkets();const a=this.safeString(r,"transferId",this.uuid()),n=this.safeDict(this.options,"accountsByType",{}),o=this.safeString(n,i,i),d=this.safeString(n,s,s),c=this.currency(t),h=this.currencyToPrecision(t,e),l={transferId:a,fromAccountType:o,toAccountType:d,coin:c.id,amount:h},u=await this.privatePostV5AssetTransferInterTransfer(this.extend(l,r)),p=this.safeInteger(u,"time"),f=this.safeDict(u,"result",{}),m=this.safeStringN(u,["retCode","retMsg"]),g=this.parseTransferStatus(m);return this.extend(this.parseTransfer(f,c),{timestamp:p,datetime:this.iso8601(p),amount:this.parseNumber(h),fromAccount:i,toAccount:s,status:g})}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchTransfers","paginate"),a)return await this.fetchPaginatedCallCursor("fetchTransfers",t,e,i,s,"nextPageCursor","cursor",void 0,50);let n={};void 0!==t&&(r=this.safeCurrency(t),n.coin=r.id),void 0!==e&&(n.startTime=e),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("endTime",n,s);const o=await this.privateGetV5AssetTransferQueryInterTransferList(this.extend(n,s)),d=this.addPaginationCursorToResult(o);return this.parseTransfers(d,r,e,i)}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={coin:s.id,amount:this.currencyToPrecision(t,e)},a=await this.privatePostV5AccountBorrow(this.extend(r,i)),n=this.safeDict(a,"result",{});return this.parseMarginLoan(n,s)}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={coin:s.id,amount:this.numberToString(e)},a=await this.privatePostV5AccountNoConvertRepay(this.extend(r,i)),n=this.safeDict(a,"result",{}),o=this.parseMarginLoan(n,s);return this.extend(o,{amount:e})}parseMarginLoan(t,e=void 0){const i=this.safeString(t,"coin");return{id:void 0,currency:this.safeCurrencyCode(i,e),amount:this.safeString(t,"amount"),symbol:void 0,timestamp:void 0,datetime:void 0,info:t}}parseTransferStatus(t){return this.safeString({0:"ok",OK:"ok",SUCCESS:"ok"},t,t)}parseTransfer(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeInteger(t,"timestamp"),r=this.safeString(t,"fromAccountType"),a=this.safeString(t,"toAccountType"),n=this.safeDict(this.options,"accountsById",{}),o=this.safeString(n,r,r),d=this.safeString(n,a,a);return{info:t,id:this.safeString(t,"transferId"),timestamp:s,datetime:this.iso8601(s),currency:this.safeCurrencyCode(i,e),amount:this.safeNumber(t,"amount"),fromAccount:o,toAccount:d,status:this.parseTransferStatus(this.safeString(t,"status"))}}async fetchDerivativesMarketLeverageTiers(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};i.linear?s.category="linear":i.inverse&&(s.category="inverse");const r=await this.publicGetV5MarketRiskLimit(this.extend(s,e)),a=this.safeDict(r,"result"),n=this.safeList(a,"list");return this.parseMarketLeverageTiers(n,i)}async fetchMarketLeverageTiers(t,e={}){await this.loadMarkets();let i;if(i=this.market(t),i.spot||i.option)throw new a.BadRequest(this.id+" fetchMarketLeverageTiers() symbol does not support market "+t);return i.id,await this.fetchDerivativesMarketLeverageTiers(t,e)}parseTradingFee(t,e=void 0){const i=this.safeString(t,"symbol"),s=void 0!==e?e.type:"contract";return{info:t,symbol:this.safeSymbol(i,e,void 0,s),maker:this.safeNumber(t,"makerFeeRate"),taker:this.safeNumber(t,"takerFeeRate"),percentage:void 0,tierBased:void 0}}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r;[r,e]=this.getBybitType("fetchTradingFee",i,e),s.category=r;const a=await this.privateGetV5AccountFeeRate(this.extend(s,e)),n=this.safeDict(a,"result",{}),o=this.safeList(n,"list",[]),d=this.safeDict(o,0,{});return this.parseTradingFee(d,i)}async fetchTradingFees(t={}){let e;if(await this.loadMarkets(),[e,t]=this.handleOptionAndParams(t,"fetchTradingFees","type","future"),"spot"===e)throw new a.NotSupported(this.id+" fetchTradingFees() is not supported for spot market");const i=await this.privateGetV5AccountFeeRate(t);let s=this.safeDict(i,"result",{});s=this.safeList(s,"list",[]);const r={};for(let t=0;t<s.length;t++){const e=this.parseTradingFee(s[t]);r[e.symbol]=e}return r}parseDepositWithdrawFee(t,e=void 0){const i=this.safeList(t,"chains",[]),s=i.length,r={info:t,withdraw:{fee:void 0,percentage:void 0},deposit:{fee:void 0,percentage:void 0},networks:{}};if(0!==s)for(let t=0;t<s;t++){const a=i[t],n=this.safeString(a,"chain"),o=this.safeString(e,"code"),d=this.networkIdToCode(n,o);r.networks[d]={deposit:{fee:void 0,percentage:void 0},withdraw:{fee:this.safeNumber(a,"withdrawFee"),percentage:!1}},1===s&&(r.withdraw.fee=this.safeNumber(a,"withdrawFee"),r.withdraw.percentage=!1)}return r}async fetchDepositWithdrawFees(t=void 0,e={}){this.checkRequiredCredentials(),await this.loadMarkets();const i=await this.privateGetV5AssetCoinQueryInfo(e),s=this.safeDict(i,"result",{}),r=this.safeList(s,"rows",[]);return this.parseDepositWithdrawFees(r,t,"coin")}async fetchSettlementHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};let n,o;if(void 0!==t&&(n=this.market(t),r.symbol=n.id),[o,s]=this.getBybitType("fetchSettlementHistory",n,s),"spot"===o)throw new a.NotSupported(this.id+" fetchSettlementHistory() is not supported for spot market");r.category=o,void 0!==i&&(r.limit=i);const d=await this.publicGetV5MarketDeliveryPrice(this.extend(r,s)),c=this.safeDict(d,"result",{}),h=this.safeList(c,"list",[]),l=this.parseSettlements(h,n),u=this.sortBy(l,"timestamp");return this.filterBySymbolSinceLimit(u,n.symbol,e,i)}async fetchMySettlementHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};let n,o;if(void 0!==t&&(n=this.market(t),r.symbol=n.id),[o,s]=this.getBybitType("fetchMySettlementHistory",n,s),"spot"===o)throw new a.NotSupported(this.id+" fetchMySettlementHistory() is not supported for spot market");r.category=o,void 0!==i&&(r.limit=i);const d=await this.privateGetV5AssetDeliveryRecord(this.extend(r,s)),c=this.safeDict(d,"result",{}),h=this.safeList(c,"list",[]),l=this.parseSettlements(h,n),u=this.sortBy(l,"timestamp");return this.filterBySymbolSinceLimit(u,n.symbol,e,i)}parseSettlement(t,e){const i=this.safeInteger(t,"deliveryTime"),s=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(s,e),price:this.safeNumber(t,"deliveryPrice"),timestamp:i,datetime:this.iso8601(i)}}parseSettlements(t,e){const i=[];for(let s=0;s<t.length;s++)i.push(this.parseSettlement(t[s],e));return i}async fetchVolatilityHistory(t,e={}){await this.loadMarkets();const i={category:"option",baseCoin:this.currency(t).id},s=await this.publicGetV5MarketHistoricalVolatility(this.extend(i,e)),r=this.safeList(s,"result",[]);return this.parseVolatilityHistory(r)}parseVolatilityHistory(t){const e=[];for(let i=0;i<t.length;i++){const s=t[i],r=this.safeInteger(s,"time");e.push({info:t,timestamp:r,datetime:this.iso8601(r),volatility:this.safeNumber(s,"value")})}return e}async fetchGreeks(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id,category:"option"},r=await this.publicGetV5MarketTickers(this.extend(s,e)),a=this.safeInteger(r,"time"),n=this.safeDict(r,"result",{}),o=this.safeList(n,"list",[]),d=this.parseGreeks(o[0],i);return this.extend(d,{timestamp:a,datetime:this.iso8601(a)})}async fetchAllGreeks(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const i={category:"option",baseCoin:this.safeString(e,"baseCoin","BTC")};let s;if(void 0!==t){1===t.length&&(s=this.market(t[0]),i.symbol=s.id)}const r=await this.publicGetV5MarketTickers(this.extend(i,e)),a=this.safeDict(r,"result",{}),n=this.safeList(a,"list",[]);return this.parseAllGreeks(n,t)}parseGreeks(t,e=void 0){const i=this.safeString(t,"symbol");return{symbol:this.safeSymbol(i,e),timestamp:void 0,datetime:void 0,delta:this.safeNumber(t,"delta"),gamma:this.safeNumber(t,"gamma"),theta:this.safeNumber(t,"theta"),vega:this.safeNumber(t,"vega"),rho:void 0,bidSize:this.safeNumber(t,"bid1Size"),askSize:this.safeNumber(t,"ask1Size"),bidImpliedVolatility:this.safeNumber(t,"bid1Iv"),askImpliedVolatility:this.safeNumber(t,"ask1Iv"),markImpliedVolatility:this.safeNumber(t,"markIv"),bidPrice:this.safeNumber(t,"bid1Price"),askPrice:this.safeNumber(t,"ask1Price"),markPrice:this.safeNumber(t,"markPrice"),lastPrice:this.safeNumber(t,"lastPrice"),underlyingPrice:this.safeNumber(t,"underlyingPrice"),info:t}}async fetchMyLiquidations(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchMyLiquidations","paginate"),r)return await this.fetchPaginatedCallCursor("fetchMyLiquidations",t,e,i,s,"nextPageCursor","cursor",void 0,100);let a,n,o={execType:"BustTrade"};void 0!==t&&(a=this.market(t),o.symbol=a.id),[n,s]=this.getBybitType("fetchMyLiquidations",a,s),o.category=n,void 0!==i&&(o.limit=i),void 0!==e&&(o.startTime=e),[o,s]=this.handleUntilOption("endTime",o,s);const d=await this.privateGetV5ExecutionList(this.extend(o,s)),c=this.addPaginationCursorToResult(d);return this.parseLiquidations(c,a,e,i)}parseLiquidation(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeInteger(t,"execTime"),r=this.safeString(t,"execQty"),a=this.safeString(e,"contractSize"),o=this.safeString(t,"execPrice"),d=n.Y.stringMul(r,a),c=n.Y.stringMul(d,o);return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e,void 0,"contract"),contracts:this.parseNumber(r),contractSize:this.parseNumber(a),price:this.parseNumber(o),baseValue:this.parseNumber(d),quoteValue:this.parseNumber(c),timestamp:s,datetime:this.iso8601(s)})}async getLeverageTiersPaginated(t=void 0,e={}){let i;await this.loadMarkets(),void 0!==t&&(i=this.market(t));let s,r=!1;if([r,e]=this.handleOptionAndParams(e,"getLeverageTiersPaginated","paginate"),r)return await this.fetchPaginatedCallCursor("getLeverageTiersPaginated",t,void 0,void 0,e,"nextPageCursor","cursor",void 0,100);[s,e]=this.handleSubTypeAndParams("getLeverageTiersPaginated",i,e,"linear");const a={category:s},n=await this.publicGetV5MarketRiskLimit(this.extend(a,e)),o=this.addPaginationCursorToResult(n),d=this.safeDict(o,0),c=o.length-1,h=this.safeDict(o,c),l=this.safeString(d,"nextPageCursor");return h.info={nextPageCursor:l},o[c]=h,o}async fetchLeverageTiers(t=void 0,e={}){let i,s;if(await this.loadMarkets(),void 0!==t){if(i=this.market(t[0]),i.spot)throw new a.NotSupported(this.id+" fetchLeverageTiers() is not supported for spot market");s=i.symbol}const r=await this.getLeverageTiersPaginated(s,this.extend({paginate:!0,paginationCalls:50},e));return t=this.marketSymbols(t),this.parseLeverageTiers(r,t,"symbol")}parseLeverageTiers(t,e=void 0,i=void 0){const s={},r=this.marketIds(e),a=this.filterByArray(t,i,r,!1),n=this.groupBy(a,i),o=Object.keys(n);for(let t=0;t<o.length;t++){const e=o[t],i=n[e];for(let t=0;t<i.length;t++){const e=this.safeInteger(i[t],"id");i[t].id=e}const r=this.safeMarket(e,void 0,void 0,"contract");s[r.symbol]=this.parseMarketLeverageTiers(this.sortBy(i,"id"),r)}return s}parseMarketLeverageTiers(t,e=void 0){const i=[];for(let s=0;s<t.length;s++){const r=t[s],a=this.safeString(t,"symbol");e=this.safeMarket(a);let n=this.parseNumber("0");0!==s&&(n=this.safeNumber(t[s-1],"riskLimitValue")),i.push({tier:this.safeInteger(r,"id"),symbol:this.safeSymbol(a,e),currency:e.settle,minNotional:n,maxNotional:this.safeNumber(r,"riskLimitValue"),maintenanceMarginRate:this.safeNumber(r,"maintenanceMargin"),maxLeverage:this.safeNumber(r,"maxLeverage"),info:r})}return i}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchFundingHistory","paginate"),r)return await this.fetchPaginatedCallCursor("fetchFundingHistory",t,e,i,s,"nextPageCursor","cursor",void 0,100);let a,n,o={execType:"Funding"};void 0!==t&&(a=this.market(t),o.symbol=a.id),[n,s]=this.getBybitType("fetchFundingHistory",a,s),o.category=n,void 0!==t&&(o.symbol=a.id),void 0!==e&&(o.startTime=e),o.size=void 0!==i?i:100,[o,s]=this.handleUntilOption("endTime",o,s);const d=await this.privateGetV5ExecutionList(this.extend(o,s)),c=this.addPaginationCursorToResult(d);return this.parseIncomes(c,a,e,i)}parseIncome(t,e=void 0){const i=this.safeString(t,"symbol");let s="USDT";(e=this.safeMarket(i,e,void 0,"contract")).inverse&&(s=e.quote);const r=this.safeInteger(t,"execTime");return{info:t,symbol:this.safeSymbol(i,e,"-","swap"),code:s,timestamp:r,datetime:this.iso8601(r),id:this.safeString(t,"execId"),amount:this.safeNumber(t,"execFee"),rate:this.safeNumber(t,"feeRate")}}async fetchOption(t,e={}){await this.loadMarkets();const i=this.market(t),s={category:"option",symbol:i.id},r=await this.publicGetV5MarketTickers(this.extend(s,e)),a=this.safeDict(r,"result",{}),n=this.safeList(a,"list",[]),o=this.safeDict(n,0,{});return this.parseOption(o,void 0,i)}async fetchOptionChain(t,e={}){await this.loadMarkets();const i={category:"option",baseCoin:this.currency(t).id},s=await this.publicGetV5MarketTickers(this.extend(i,e)),r=this.safeDict(s,"result",{}),a=this.safeList(r,"list",[]);return this.parseOptionChain(a,void 0,"symbol")}parseOption(t,e=void 0,i=void 0){const s=this.safeString(t,"symbol");return{info:t,currency:void 0,symbol:(i=this.safeMarket(s,i)).symbol,timestamp:void 0,datetime:void 0,impliedVolatility:this.safeNumber(t,"markIv"),openInterest:this.safeNumber(t,"openInterest"),bidPrice:this.safeNumber(t,"bid1Price"),askPrice:this.safeNumber(t,"ask1Price"),midPrice:void 0,markPrice:this.safeNumber(t,"markPrice"),lastPrice:this.safeNumber(t,"lastPrice"),underlyingPrice:this.safeNumber(t,"underlyingPrice"),change:this.safeNumber(t,"change24h"),percentage:void 0,baseVolume:this.safeNumber(t,"totalVolume"),quoteVolume:void 0}}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){let r,a;await this.loadMarkets();let n=0;void 0!==t&&(n=t.length,n>0&&(r=this.market(t[0])));const o=this.safeInteger(s,"until");[a,s]=this.handleSubTypeAndParams("fetchPositionsHistory",r,s,"linear"),s=this.omit(s,"until");const d={category:a};void 0!==t&&1===n&&(d.symbol=r.id),void 0!==e&&(d.startTime=e),void 0!==i&&(d.limit=i),void 0!==o&&(d.endTime=o);const c=await this.privateGetV5PositionClosedPnl(this.extend(d,s)),h=this.safeDict(c,"result"),l=this.safeList(h,"list"),u=this.parsePositions(l,t,s);return this.filterBySinceLimit(u,e,i)}async fetchConvertCurrencies(t={}){let e;await this.loadMarkets();const[i,s]=await this.isUnifiedEnabled(),r=i||s?"eb_convert_uta":"eb_convert_spot";[e,t]=this.handleOptionAndParams(t,"fetchConvertCurrencies","accountType",r);const a={accountType:e},n=await this.privateGetV5AssetExchangeQueryCoinList(this.extend(a,t)),o={},d=this.safeDict(n,"result",{}),c=this.safeList(d,"coins",[]);for(let t=0;t<c.length;t++){const e=c[t],i=this.safeString(e,"coin"),s=this.safeBool(e,"disableFrom"),r=this.safeBool(e,"disableTo"),a=s||r,n=this.safeCurrencyCode(i);o[n]={info:e,id:i,code:n,networks:void 0,type:this.safeString(e,"coinType"),name:this.safeString(e,"fullName"),active:!a,deposit:void 0,withdraw:this.safeNumber(e,"balance"),fee:void 0,precision:void 0,limits:{amount:{min:this.safeNumber(e,"singleFromMinLimit"),max:this.safeNumber(e,"singleFromMaxLimit")},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},created:void 0}}return o}async fetchConvertQuote(t,e,i=void 0,s={}){let r;await this.loadMarkets();const[a,n]=await this.isUnifiedEnabled(),o=a||n?"eb_convert_uta":"eb_convert_spot";[r,s]=this.handleOptionAndParams(s,"fetchConvertQuote","accountType",o);const d={fromCoin:t,toCoin:e,requestAmount:this.numberToString(i),requestCoin:t,accountType:r},c=await this.privatePostV5AssetExchangeQuoteApply(this.extend(d,s)),h=this.safeDict(c,"result",{}),l=this.safeString(h,"fromCoin",t),u=this.currency(l),p=this.safeString(h,"toCoin",e),f=this.currency(p);return this.parseConversion(h,u,f)}async createConvertTrade(t,e,i,s=void 0,r={}){await this.loadMarkets();const a={quoteTxId:t},n=await this.privatePostV5AssetExchangeConvertExecute(this.extend(a,r)),o=this.safeDict(n,"result",{});return this.parseConversion(o)}async fetchConvertTrade(t,e=void 0,i={}){let s;await this.loadMarkets();const[r,a]=await this.isUnifiedEnabled(),n=r||a?"eb_convert_uta":"eb_convert_spot";[s,i]=this.handleOptionAndParams(i,"fetchConvertQuote","accountType",n);const o={quoteTxId:t,accountType:s},d=await this.privateGetV5AssetExchangeConvertResultQuery(this.extend(o,i)),c=this.safeDict(d,"result",{}),h=this.safeDict(c,"result",{}),l=this.safeString(h,"fromCoin"),u=this.safeString(h,"toCoin");let p,f;return void 0!==l&&(p=this.currency(l)),void 0!==u&&(f=this.currency(u)),this.parseConversion(h,p,f)}async fetchConvertTradeHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};void 0!==i&&(r.limit=i);const a=await this.privateGetV5AssetExchangeQueryConvertHistory(this.extend(r,s)),n=this.safeDict(a,"result",{}),o=this.safeList(n,"list",[]);return this.parseConversions(o,t,"fromCoin","toCoin",e,i)}parseConversion(t,e=void 0,i=void 0){const s=this.safeInteger2(t,"expiredTime","createdAt"),r=this.safeString(t,"fromCoin"),a=this.safeCurrencyCode(r,e),n=this.safeString(t,"toCoin"),o=this.safeCurrencyCode(n,i);return{info:t,timestamp:s,datetime:this.iso8601(s),id:this.safeString2(t,"quoteTxId","exchangeTxId"),fromCurrency:a,fromAmount:this.safeNumber(t,"fromAmount"),toCurrency:o,toAmount:this.safeNumber(t,"toAmount"),price:void 0,fee:void 0}}async fetchLongShortRatioHistory(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const n=this.market(t);let o;if([o,r]=this.getBybitType("fetchLongShortRatioHistory",n,r),"spot"===o||"option"===o)throw new a.NotSupported(this.id+" fetchLongShortRatioHistory() only support linear and inverse markets");void 0===e&&(e="1d");const d={symbol:n.id,period:e,category:o};void 0!==s&&(d.limit=s);const c=await this.publicGetV5MarketAccountRatio(this.extend(d,r)),h=this.safeDict(c,"result",{}),l=this.safeList(h,"list",[]);return this.parseLongShortRatioHistory(l,n)}parseLongShortRatio(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeIntegerOmitZero(t,"timestamp"),r=this.safeString(t,"buyRatio"),a=this.safeString(t,"sellRatio");return{info:t,symbol:this.safeSymbol(i,e,void 0,"contract"),timestamp:s,datetime:this.iso8601(s),timeframe:void 0,longShortRatio:this.parseToNumeric(n.Y.stringDiv(r,a))}}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){let n=this.implodeHostname(this.urls.api[e])+"/"+t;if("public"===e)Object.keys(s).length&&(n+="?"+this.rawencode(s));else if("private"===e){this.checkRequiredCredentials();const t=n.indexOf("openapi")>=0,e=n.indexOf("unified/v3")>=0,c=n.indexOf("contract/v3")>=0,h=n.indexOf("v5")>=0,l=this.nonce().toString();if(t){a=Object.keys(s).length?this.json(s):"{}";const t=l+this.apiKey+a,e=this.hmac(this.encode(t),this.encode(this.secret),o.s,"hex");r={"Content-Type":"application/json","X-BAPI-API-KEY":this.apiKey,"X-BAPI-TIMESTAMP":l,"X-BAPI-SIGN":e}}else if(e||c||h){r={"Content-Type":"application/json","X-BAPI-API-KEY":this.apiKey,"X-BAPI-TIMESTAMP":l,"X-BAPI-RECV-WINDOW":this.options.recvWindow.toString()},(e||c)&&(r["X-BAPI-SIGN-TYPE"]="2");const t=this.extend({},s),h=this.rawencode(t),u=l.toString()+this.apiKey+this.options.recvWindow.toString();let p,f;"POST"===i?p=u+(a=this.json(t)):(p=u+h,n+="?"+h),f=this.secret.indexOf("PRIVATE KEY")>-1?(0,d.n)(p,this.secret,o.s):this.hmac(this.encode(p),this.encode(this.secret),o.s),r["X-BAPI-SIGN"]=f}else{const t=this.extend(s,{api_key:this.apiKey,recv_window:this.options.recvWindow,timestamp:l}),e=this.keysort(t),c=this.rawencode(e,!0);let h;if(h=this.secret.indexOf("PRIVATE KEY")>-1?(0,d.n)(c,this.secret,o.s):this.hmac(this.encode(c),this.encode(this.secret),o.s),"POST"===i){const e=n.indexOf("spot")>=0,i=this.extend(t,{sign:h});e?(a=this.urlencode(i),r={"Content-Type":"application/x-www-form-urlencoded"}):(a=this.json(i),r={"Content-Type":"application/json"})}else n+="?"+this.rawencode(e,!0),n+="&sign="+h}}if("POST"===i){const t=this.safeString(this.options,"brokerId");void 0!==t&&(r.Referer=t)}return{url:n,method:i,body:a,headers:r}}handleErrors(t,e,i,s,r,n,o,d,c){if(!o)return;const h=this.safeString2(o,"ret_code","retCode");if("0"!==h){if("30084"===h)return;let t;throw t="10005"===h&&i.indexOf("order")<0?this.id+' private api uses /user/v3/private/query-api to check if you have a unified account. The API key of user id must own one of permissions: "Account Transfer", "Subaccount Transfer", "Withdrawal" '+n:this.id+" "+n,n.indexOf("Withdraw address chain or destination tag are not equal")>-1&&(t+="; You might also need to ensure the address is whitelisted"),this.throwBroadlyMatchedException(this.exceptions.broad,n,t),this.throwExactlyMatchedException(this.exceptions.exact,h,t),new a.ExchangeError(t)}}}},5531(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},5661(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},5897(t,e,i){"use strict";i.d(e,{Ay:()=>s});const s=i(8595).y.defaultAbiCoder()},5928(t,e,i){"use strict";i.r(e),i.d(e,{SignMode:()=>a,SignModeSDKType:()=>d,SignatureDescriptor:()=>p,SignatureDescriptor_Data:()=>f,SignatureDescriptor_Data_Multi:()=>y,SignatureDescriptor_Data_Single:()=>g,SignatureDescriptors:()=>l,signModeFromJSON:()=>c,signModeToJSON:()=>h});var s=i(497),r=i(8166);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var a,n=i(1291),o=i.n(n);!function(t){t[t.SIGN_MODE_UNSPECIFIED=0]="SIGN_MODE_UNSPECIFIED",t[t.SIGN_MODE_DIRECT=1]="SIGN_MODE_DIRECT",t[t.SIGN_MODE_TEXTUAL=2]="SIGN_MODE_TEXTUAL",t[t.SIGN_MODE_DIRECT_AUX=3]="SIGN_MODE_DIRECT_AUX",t[t.SIGN_MODE_LEGACY_AMINO_JSON=127]="SIGN_MODE_LEGACY_AMINO_JSON",t[t.SIGN_MODE_EIP_191=191]="SIGN_MODE_EIP_191",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(a||(a={}));const d=a;function c(t){switch(t){case 0:case"SIGN_MODE_UNSPECIFIED":return a.SIGN_MODE_UNSPECIFIED;case 1:case"SIGN_MODE_DIRECT":return a.SIGN_MODE_DIRECT;case 2:case"SIGN_MODE_TEXTUAL":return a.SIGN_MODE_TEXTUAL;case 3:case"SIGN_MODE_DIRECT_AUX":return a.SIGN_MODE_DIRECT_AUX;case 127:case"SIGN_MODE_LEGACY_AMINO_JSON":return a.SIGN_MODE_LEGACY_AMINO_JSON;case 191:case"SIGN_MODE_EIP_191":return a.SIGN_MODE_EIP_191;default:return a.UNRECOGNIZED}}function h(t){switch(t){case a.SIGN_MODE_UNSPECIFIED:return"SIGN_MODE_UNSPECIFIED";case a.SIGN_MODE_DIRECT:return"SIGN_MODE_DIRECT";case a.SIGN_MODE_TEXTUAL:return"SIGN_MODE_TEXTUAL";case a.SIGN_MODE_DIRECT_AUX:return"SIGN_MODE_DIRECT_AUX";case a.SIGN_MODE_LEGACY_AMINO_JSON:return"SIGN_MODE_LEGACY_AMINO_JSON";case a.SIGN_MODE_EIP_191:return"SIGN_MODE_EIP_191";case a.UNRECOGNIZED:default:return"UNRECOGNIZED"}}const l={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.signatures)p.encode(i,e.uint32(10).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={signatures:[]};for(;i.pos<s;){const t=i.uint32();if(t>>>3==1)r.signatures.push(p.decode(i,i.uint32()));else i.skipType(7&t)}return r},fromPartial(t){const e={signatures:[]};return e.signatures=t.signatures?.map(t=>p.fromPartial(t))||[],e}};function u(){return{publicKey:void 0,data:void 0,sequence:o().UZERO}}const p={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.publicKey&&r.F.encode(t.publicKey,e.uint32(10).fork()).ldelim(),void 0!==t.data&&f.encode(t.data,e.uint32(18).fork()).ldelim(),t.sequence.isZero()||e.uint32(24).uint64(t.sequence),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a=u();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.publicKey=r.F.decode(i,i.uint32());break;case 2:a.data=f.decode(i,i.uint32());break;case 3:a.sequence=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=u();return e.publicKey=void 0!==t.publicKey&&null!==t.publicKey?r.F.fromPartial(t.publicKey):void 0,e.data=void 0!==t.data&&null!==t.data?f.fromPartial(t.data):void 0,e.sequence=void 0!==t.sequence&&null!==t.sequence?o().fromValue(t.sequence):o().UZERO,e}};const f={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.single&&g.encode(t.single,e.uint32(10).fork()).ldelim(),void 0!==t.multi&&y.encode(t.multi,e.uint32(18).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={single:void 0,multi:void 0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.single=g.decode(i,i.uint32());break;case 2:r.multi=y.decode(i,i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={single:void 0,multi:void 0};return e.single=void 0!==t.single&&null!==t.single?g.fromPartial(t.single):void 0,e.multi=void 0!==t.multi&&null!==t.multi?y.fromPartial(t.multi):void 0,e}};function m(){return{mode:0,signature:new Uint8Array}}const g={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.mode&&e.uint32(8).int32(t.mode),0!==t.signature.length&&e.uint32(18).bytes(t.signature),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=m();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.mode=i.int32();break;case 2:r.signature=i.bytes();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=m();return e.mode=t.mode??0,e.signature=t.signature??new Uint8Array,e}};const y={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.bitarray&&s.s.encode(t.bitarray,e.uint32(10).fork()).ldelim();for(const i of t.signatures)f.encode(i,e.uint32(18).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={bitarray:void 0,signatures:[]};for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.bitarray=s.s.decode(i,i.uint32());break;case 2:a.signatures.push(f.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={bitarray:void 0,signatures:[]};return e.bitarray=void 0!==t.bitarray&&null!==t.bitarray?s.s.fromPartial(t.bitarray):void 0,e.signatures=t.signatures?.map(t=>f.fromPartial(t))||[],e}}},5944(t,e,i){"use strict";i.d(e,{v:()=>n});var s=i(6279),r=i(2501);const a="undefined"!=typeof process?process.env?.npm_package_version:void 0;class n{constructor(t={}){t=t||{},this.default_key_size=t.default_key_size?parseInt(t.default_key_size,10):1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null}setKey(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new r.Y(t)}setPrivateKey(t){this.setKey(t)}setPublicKey(t){this.setKey(t)}decrypt(t){try{return this.getKey().decrypt((0,s.ry)(t))}catch(t){return!1}}encrypt(t){try{return(0,s.gr)(this.getKey().encrypt(t))}catch(t){return!1}}sign(t,e,i){try{return(0,s.gr)(this.getKey().sign(t,e,i))}catch(t){return!1}}verify(t,e,i){try{return this.getKey().verify(t,(0,s.ry)(e),i)}catch(t){return!1}}getKey(t){if(!this.key){if(this.key=new r.Y,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key}getPrivateKey(){return this.getKey().getPrivateKey()}getPrivateKeyB64(){return this.getKey().getPrivateBaseKeyB64()}getPublicKey(){return this.getKey().getPublicKey()}getPublicKeyB64(){return this.getKey().getPublicBaseKeyB64()}}n.version=a},6157(t,e,i){"use strict";i.d(e,{Ay:()=>n});const s=BigInt(2**32-1),r=BigInt(32);function a(t,e=!1){return e?{h:Number(t&s),l:Number(t>>r&s)}:{h:0|Number(t>>r&s),l:0|Number(t&s)}}const n={fromBig:a,split:function(t,e=!1){let i=new Uint32Array(t.length),s=new Uint32Array(t.length);for(let r=0;r<t.length;r++){const{h:n,l:o}=a(t[r],e);[i[r],s[r]]=[n,o]}return[i,s]},toBig:(t,e)=>BigInt(t>>>0)<<r|BigInt(e>>>0),shrSH:(t,e,i)=>t>>>i,shrSL:(t,e,i)=>t<<32-i|e>>>i,rotrSH:(t,e,i)=>t>>>i|e<<32-i,rotrSL:(t,e,i)=>t<<32-i|e>>>i,rotrBH:(t,e,i)=>t<<64-i|e>>>i-32,rotrBL:(t,e,i)=>t>>>i-32|e<<64-i,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:(t,e,i)=>t<<i|e>>>32-i,rotlSL:(t,e,i)=>e<<i|t>>>32-i,rotlBH:(t,e,i)=>e<<i-32|t>>>64-i,rotlBL:(t,e,i)=>t<<i-32|e>>>64-i,add:function(t,e,i,s){const r=(e>>>0)+(s>>>0);return{h:t+i+(r/2**32|0)|0,l:0|r}},add3L:(t,e,i)=>(t>>>0)+(e>>>0)+(i>>>0),add3H:(t,e,i,s)=>e+i+s+(t/2**32|0)|0,add4L:(t,e,i,s)=>(t>>>0)+(e>>>0)+(i>>>0)+(s>>>0),add4H:(t,e,i,s,r)=>e+i+s+r+(t/2**32|0)|0,add5H:(t,e,i,s,r,a)=>e+i+s+r+a+(t/2**32|0)|0,add5L:(t,e,i,s,r)=>(t>>>0)+(e>>>0)+(i>>>0)+(s>>>0)+(r>>>0)}},6238(t,e,i){"use strict";i.d(e,{Hp:()=>c,QD:()=>l,Se:()=>u,ce:()=>n,jG:()=>o,ru:()=>h,um:()=>d});var s=i(1579),r=i(6834),a=i(2079);const n=t=>{const e=(0,r.Pf)(t.slice(0,-1)),i=t.slice(-1);let s;if("y"===i)s=31536e3;else if("M"===i)s=2592e3;else if("w"===i)s=604800;else if("d"===i)s=86400;else if("h"===i)s=3600;else if("m"===i)s=60;else{if("s"!==i)throw new a.NotSupported("timeframe unit "+i+" is not supported");s=1}return e*s},o=(t,e,i=s._g)=>{const r=1e3*n(t);return e-e%r+(i===s.Tz?r:0)},d=t=>{const e=/{([\w-]+)}/g,i=[];let s=e.exec(t);for(;s;)i.push(s[1]),s=e.exec(t);return i},c=(t,e)=>{if(!Array.isArray(e)){const i=Object.keys(e);for(let s=0;s<i.length;s++){const r=i[s];Array.isArray(e[r])||(t=t.replace("{"+r+"}",e[r]))}}return t};function h(t,e){return void 0!==t&&void 0!==e&&t>0?e/t:void 0}function l(t){const e={};for(let i=0;i<t.length;i++){const[s,r]=t[i];r>0&&(e[s]=(e[s]||0)+r)}return Object.keys(e).map(t=>[parseFloat(t),parseFloat(e[t])])}function u(){let t=!1;try{t=void 0!==self}catch(e){t=!1}return t}},6279(t,e,i){"use strict";i.d(e,{gr:()=>r,ry:()=>a});var s=i(4710);function r(t){return s.K3.encode(s.xn.decode(t))}function a(t){return s.xn.encode(s.K3.decode(t))}},6335(t,e,i){"use strict";i.d(e,{A:()=>r});var s=i(3898);class r extends s.A{describe(){return this.deepExtend(super.describe(),{alias:!0,id:"huobi"})}}},6378(t,e,i){"use strict";i.d(e,{b:()=>s});
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/
var s={};s.lang={extend:function(t,e,i){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var s=function(){};if(s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),i){var r;for(r in i)t.prototype[r]=i[r];var a=function(){},n=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(a=function(t,e){for(r=0;r<n.length;r+=1){var i=n[r],s=e[i];"function"==typeof s&&s!=Object.prototype[i]&&(t[i]=s)}})}catch(t){}a(t.prototype,i)}}}},6414(t,e,i){"use strict";i.d(e,{ev:()=>P});var s=i(7481),r=i(1094),a=i(4782),n=i(6451),o=i(1064),d=i(191),c=i(4506);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const h=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),u=BigInt(0),p=BigInt(1),f=BigInt(2),m=BigInt(5),g=BigInt(10),y=BigInt(20),v=BigInt(40),b=BigInt(80);function w(t){const e=h,i=t*t%e*t%e,s=(0,o.zH)(i,f,e)*i%e,r=(0,o.zH)(s,p,e)*t%e,a=(0,o.zH)(r,m,e)*r%e,n=(0,o.zH)(a,g,e)*a%e,d=(0,o.zH)(n,y,e)*n%e,c=(0,o.zH)(d,v,e)*d%e,l=(0,o.zH)(c,b,e)*c%e,u=(0,o.zH)(l,b,e)*c%e,w=(0,o.zH)(u,g,e)*a%e;return{pow_p_5_8:(0,o.zH)(w,f,e)*t%e,b2:i}}function S(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function k(t,e){const i=h,s=(0,o.zi)(e*e*e,i),r=w(t*(0,o.zi)(s*s*e,i)).pow_p_5_8;let a=(0,o.zi)(t*s*r,i);const n=(0,o.zi)(e*a*a,i),d=a,c=(0,o.zi)(a*l,i),u=n===t,p=n===(0,o.zi)(-t,i),f=n===(0,o.zi)(-t*l,i);return u&&(a=d),(p||f)&&(a=c),(0,o.dQ)(a,i)&&(a=(0,o.zi)(-a,i)),{isValid:u||p,value:a}}const O=(0,o.Fp)(h,void 0,!0),T={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:O,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:s.Zf,randomBytes:r.po,adjustScalarBytes:S,uvRatio:k},P=(0,a.n)(T);function _(t,e,i){if(e.length>255)throw new Error("Context is too big");return(0,r.Id)((0,r.AI)("SigEd25519 no Ed25519 collisions"),new Uint8Array([i?1:0,e.length]),e,t)}(0,a.n)({...T,domain:_}),(0,a.n)({...T,domain:_,preHash:s.Zf}),(0,n.E)({P:h,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=h,{pow_p_5_8:i,b2:s}=w(t);return(0,o.zi)((0,o.zH)(i,BigInt(3),e)*s,e)},adjustScalarBytes:S,randomBytes:r.po});const A=(O.ORDER+BigInt(3))/BigInt(8),I=O.pow(f,A),x=O.sqrt(O.neg(O.ONE)),E=(O.ORDER-BigInt(5))/BigInt(8),M=BigInt(486662);const C=(0,o.Tv)(O,O.neg(BigInt(486664)));function B(t){const{xMn:e,xMd:i,yMn:s,yMd:r}=function(t){let e=O.sqr(t);e=O.mul(e,f);let i=O.add(e,O.ONE),s=O.neg(M),r=O.sqr(i),a=O.mul(r,i),n=O.mul(e,M);n=O.mul(n,s),n=O.add(n,r),n=O.mul(n,s);let o=O.sqr(a);r=O.sqr(o),o=O.mul(o,a),o=O.mul(o,n),r=O.mul(r,o);let d=O.pow(r,E);d=O.mul(d,o);let c=O.mul(d,x);r=O.sqr(d),r=O.mul(r,a);let h=O.eql(r,n),l=O.cmov(c,d,h),u=O.mul(s,e),p=O.mul(d,t);p=O.mul(p,I);let m=O.mul(p,x),g=O.mul(n,e);r=O.sqr(p),r=O.mul(r,a);let y=O.eql(r,g),v=O.cmov(m,p,y);r=O.sqr(l),r=O.mul(r,a);let b=O.eql(r,n),w=O.cmov(u,s,b),S=O.cmov(v,l,b),k=O.isOdd(S);return S=O.cmov(S,O.neg(S),b!==k),{xMn:w,xMd:i,yMn:S,yMd:1n}}(t);let a=O.mul(e,r);a=O.mul(a,C);let n=O.mul(i,s),o=O.sub(e,i),d=O.add(e,i),c=O.mul(n,d),h=O.eql(c,O.ZERO);a=O.cmov(a,O.ZERO,h),n=O.cmov(n,O.ONE,h),o=O.cmov(o,O.ONE,h),d=O.cmov(d,O.ONE,h);const l=O.invertBatch([n,d]);return{x:O.mul(a,l[0]),y:O.mul(o,l[1])}}const{hashToCurve:N,encodeToCurve:R}=c.qj(P.ExtendedPoint,t=>B(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:O.ORDER,m:1,k:128,expand:"xmd",hash:s.Zf});function L(t){if(!(t instanceof z))throw new Error("RistrettoPoint expected")}const D=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),q=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),F=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),V=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),U=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),j=t=>k(p,t),G=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),H=t=>P.CURVE.Fp.create((0,d.lX)(t)&G);function W(t){const{d:e}=P.CURVE,i=P.CURVE.Fp.ORDER,s=P.CURVE.Fp.create,r=s(D*t*t),a=s((r+p)*V);let n=BigInt(-1);const d=s((n-e*r)*s(r+e));let{isValid:c,value:h}=k(a,d),l=s(h*t);(0,o.dQ)(l,i)||(l=s(-l)),c||(h=l),c||(n=r);const u=s(n*(r-p)*U-d),f=h*h,m=s((h+h)*d),g=s(u*q),y=s(p-f),v=s(p+f);return new P.ExtendedPoint(s(m*v),s(y*g),s(g*v),s(m*y))}class z{constructor(t){this.ep=t}static fromAffine(t){return new z(P.ExtendedPoint.fromAffine(t))}static hashToCurve(t){t=(0,d.qj)("ristrettoHash",t,64);const e=W(H(t.slice(0,32))),i=W(H(t.slice(32,64)));return new z(e.add(i))}static fromHex(t){t=(0,d.qj)("ristrettoHex",t,32);const{a:e,d:i}=P.CURVE,s=P.CURVE.Fp.ORDER,r=P.CURVE.Fp.create,a="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",n=H(t);if(!(0,d.ex)((0,d.z)(n,32),t)||(0,o.dQ)(n,s))throw new Error(a);const c=r(n*n),h=r(p+e*c),l=r(p-e*c),f=r(h*h),m=r(l*l),g=r(e*i*f-m),{isValid:y,value:v}=j(r(g*m)),b=r(v*l),w=r(v*b*g);let S=r((n+n)*b);(0,o.dQ)(S,s)&&(S=r(-S));const k=r(h*w),O=r(S*k);if(!y||(0,o.dQ)(O,s)||k===u)throw new Error(a);return new z(new P.ExtendedPoint(S,k,p,O))}toRawBytes(){let{ex:t,ey:e,ez:i,et:s}=this.ep;const r=P.CURVE.Fp.ORDER,a=P.CURVE.Fp.create,n=a(a(i+e)*a(i-e)),c=a(t*e),h=a(c*c),{value:l}=j(a(n*h)),u=a(l*n),p=a(l*c),f=a(u*p*s);let m;if((0,o.dQ)(s*f,r)){let i=a(e*D),s=a(t*D);t=i,e=s,m=a(u*F)}else m=p;(0,o.dQ)(t*f,r)&&(e=a(-e));let g=a((i-e)*m);return(0,o.dQ)(g,r)&&(g=a(-g)),(0,d.z)(g,32)}toHex(){return(0,d.My)(this.toRawBytes())}toString(){return this.toHex()}equals(t){L(t);const{ex:e,ey:i}=this.ep,{ex:s,ey:r}=t.ep,a=P.CURVE.Fp.create,n=a(e*r)===a(i*s),o=a(i*r)===a(e*s);return n||o}add(t){return L(t),new z(this.ep.add(t.ep))}subtract(t){return L(t),new z(this.ep.subtract(t.ep))}multiply(t){return new z(this.ep.multiply(t))}multiplyUnsafe(t){return new z(this.ep.multiplyUnsafe(t))}}z.BASE=new z(P.ExtendedPoint.BASE),z.ZERO=new z(P.ExtendedPoint.ZERO)},6451(t,e,i){"use strict";i.d(e,{E:()=>o});var s=i(1064),r=i(191);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const a=BigInt(0),n=BigInt(1);function o(t){const e=(i=t,(0,r.Q5)(i,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...i}));var i;const{P:o}=e,d=t=>(0,s.zi)(t,o),c=e.montgomeryBits,h=Math.ceil(c/8),l=e.nByteLength,u=e.adjustScalarBytes||(t=>t),p=e.powPminus2||(t=>(0,s.n7)(t,o-BigInt(2),o));function f(t,e,i){const s=d(t*(e-i));return[e=d(e-s),i=d(i+s)]}function m(t){if("bigint"==typeof t&&a<=t&&t<o)return t;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const g=(e.a-BigInt(2))/BigInt(4);function y(t){return(0,r.z)(d(t),h)}function v(t,e){const i=function(t){const e=(0,r.qj)("u coordinate",t,h);return l===h&&(e[l-1]&=127),(0,r.lX)(e)}(e),s=function(t,e){const i=m(t),s=m(e),r=i;let o,h=n,l=a,u=i,y=n,v=a;for(let t=BigInt(c-1);t>=a;t--){const e=s>>t&n;v^=e,o=f(v,h,u),h=o[0],u=o[1],o=f(v,l,y),l=o[0],y=o[1],v=e;const i=h+l,a=d(i*i),c=h-l,p=d(c*c),m=a-p,b=u+y,w=d((u-y)*i),S=d(b*c),k=w+S,O=w-S;u=d(k*k),y=d(r*d(O*O)),h=d(a*p),l=d(m*(a+d(g*m)))}o=f(v,h,u),h=o[0],u=o[1],o=f(v,l,y),l=o[0],y=o[1];const b=p(l);return d(h*b)}(i,function(t){const e=(0,r.qj)("scalar",t);if(e.length!==h&&e.length!==l)throw new Error(`Expected ${h} or ${l} bytes, got ${e.length}`);return(0,r.lX)(u(e))}(t));if(s===a)throw new Error("Invalid private or public key received");return y(s)}const b=y(e.Gu);function w(t){return v(t,b)}return{scalarMult:v,scalarMultBase:w,getSharedSecret:(t,e)=>v(t,e),getPublicKey:t=>w(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:b}}},6768(t,e,i){"use strict";i.d(e,{S:()=>o});var s=i(2014),r=i(1768),a=i(9073),n=i(4176);class o extends n.Ue{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){let i=a.V.dereference(e,"string");try{i=(0,s.b)(i)}catch(t){return this._throwError(t.message,e)}return t.writeValue(i)}decode(t){return(0,s.b)((0,r.up)(t.readValue(),20))}}},6834(t,e,i){"use strict";i.d(e,{At:()=>B,Cw:()=>T,DR:()=>L,Dj:()=>I,Et:()=>s,F7:()=>M,Fq:()=>r,Gv:()=>d,Hf:()=>c,I9:()=>q,J0:()=>_,JU:()=>m,KL:()=>h,Kg:()=>o,Pf:()=>f,Q7:()=>C,RH:()=>O,Rc:()=>D,Y2:()=>y,Y_:()=>R,_w:()=>l,cy:()=>a,d0:()=>x,dl:()=>n,fu:()=>F,gw:()=>k,hO:()=>N,lu:()=>v,mU:()=>P,nr:()=>S,pI:()=>w,q0:()=>b,uS:()=>E,w:()=>g,ww:()=>A});const s=Number.isFinite,r=Number.isInteger,a=Array.isArray,n=t=>null!=t,o=t=>"string"==typeof t,d=t=>null!==t&&"object"==typeof t,c=t=>d(t)&&Object.getPrototypeOf(t)===Object.prototype&&!a(t)&&!(t=>t instanceof RegExp)(t),h=t=>n(t)&&t.toString||s(t),l=(t,e)=>d(t)&&""!==t[e]&&null!==t[e]?t[e]:void 0,u=(t,e,i)=>d(t)?void 0!==t[e]&&""!==t[e]&&null!==t[e]?t[e]:""!==t[i]&&null!==t[i]?t[i]:void 0:void 0,p=(t,e)=>d(t)?t[e.find(e=>void 0!==l(t,e))]:void 0,f=t=>s(t)||o(t)&&0!==t.length?parseFloat(t):NaN,m=t=>s(t)||o(t)&&0!==t.length?Math.trunc(Number(t)):NaN,g=(t,e,i)=>{const r=f(l(t,e));return s(r)?r:i},y=(t,e,i)=>{const r=m(l(t,e));return s(r)?r:i},v=(t,e,i,r)=>{const a=f(l(t,e));return s(a)?parseInt(a*i):r},b=(t,e,i)=>{const r=f(l(t,e));return s(r)?parseInt(1e3*r):i},w=(t,e,i)=>{const s=l(t,e);return n(s)?s:i},S=(t,e,i)=>{const s=l(t,e);return h(s)?String(s):i},k=(t,e,i)=>{const s=l(t,e);return h(s)?String(s).toLowerCase():h(i)?String(i).toLowerCase():i},O=(t,e,i)=>{const s=l(t,e);return h(s)?String(s).toUpperCase():h(i)?String(i).toUpperCase():i},T=(t,e,i,r)=>{const a=f(u(t,e,i));return s(a)?a:r},P=(t,e,i,r)=>{const a=m(u(t,e,i));return s(a)?a:r},_=(t,e,i,r,a)=>{const n=f(u(t,e,i));return s(n)?parseInt(n*r):a},A=(t,e,i,r)=>{const a=f(u(t,e,i));return s(a)?parseInt(1e3*a):r},I=(t,e,i,s)=>{const r=u(t,e,i);return n(r)?r:s},x=(t,e,i,s)=>{const r=u(t,e,i);return h(r)?String(r):s},E=(t,e,i,s)=>{const r=u(t,e,i);return h(r)?String(r).toLowerCase():h(s)?String(s).toLowerCase():s},M=(t,e,i,s)=>{const r=u(t,e,i);return h(r)?String(r).toUpperCase():h(s)?String(s).toUpperCase():s},C=(t,e,i)=>{const r=f(p(t,e));return s(r)?r:i},B=(t,e,i)=>{if(void 0===t)return i;const r=m(p(t,e));return s(r)?r:i},N=(t,e,i,r)=>{const a=f(p(t,e));return s(a)?parseInt(a*i):r},R=(t,e,i)=>{const r=f(p(t,e));return s(r)?parseInt(1e3*r):i},L=(t,e,i)=>{if(void 0===t)return i;const s=p(t,e);return n(s)?s:i},D=(t,e,i)=>{if(void 0===t)return i;const s=p(t,e);return h(s)?String(s):i},q=(t,e,i)=>{const s=p(t,e);return h(s)?String(s).toLowerCase():h(i)?String(i).toLowerCase():i},F=(t,e,i)=>{const s=p(t,e);return h(s)?String(s).toUpperCase():h(i)?String(i).toUpperCase():i}},6863(t,e,i){"use strict";i.d(e,{b:()=>s});class s{constructor(t){const e=Object.values(t);if(0===e.length)throw new Error("This Enum must have at least 1 variant");if(1!==e.filter(t=>void 0!==t).length)throw new Error("This Enum must have exactly one active variant");this.variant=t}unwrap(){const t=Object.entries(this.variant).find(t=>void 0!==t[1]);if(void 0!==t)return t[1]}activeVariant(){const t=Object.entries(this.variant).find(t=>void 0!==t[1]);return void 0===t?"":t[0]}}},6888(t,e,i){"use strict";i.d(e,{A:()=>p});var s=i(700),r=i(1417),a=Object.prototype.hasOwnProperty,n={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},o=Array.isArray,d=Array.prototype.push,c=function(t,e){d.apply(t,o(e)?e:[e])},h=Date.prototype.toISOString,l={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:s.lF,encodeValuesOnly:!1,formatter:r._J[r.Ay],indices:!1,serializeDate:function(t){return h.call(t)},skipNulls:!1,strictNullHandling:!1},u=function t(e,i,r,a,n,d,h,u,p,f,m,g,y){var v=e;if("function"==typeof h?v=h(i,v):v instanceof Date?v=f(v):"comma"===r&&o(v)&&(v=v.join(",")),null===v){if(a)return d&&!g?d(i,l.encoder,y):i;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||s.Pe(v))return d?[m(g?i:d(i,l.encoder,y))+"="+m(d(v,l.encoder,y))]:[m(i)+"="+m(String(v))];var b,w=[];if(void 0===v)return w;if(o(h))b=h;else{var S=Object.keys(v);b=u?S.sort(u):S}for(var k=0;k<b.length;++k){var O=b[k];n&&null===v[O]||(o(v)?c(w,t(v[O],"function"==typeof r?r(i,O):i,r,a,n,d,h,u,p,f,m,g,y)):c(w,t(v[O],i+(p?"."+O:"["+O+"]"),r,a,n,d,h,u,p,f,m,g,y)))}return w};function p(t,e){var i,s=t,d=function(t){if(!t)return l;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||l.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=r.Ay;if(void 0!==t.format){if(!a.call(r._J,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var s=r._J[i],n=l.filter;return("function"==typeof t.filter||o(t.filter))&&(n=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:l.addQueryPrefix,allowDots:void 0===t.allowDots?l.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:l.charsetSentinel,delimiter:void 0===t.delimiter?l.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:l.encode,encoder:"function"==typeof t.encoder?t.encoder:l.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:l.encodeValuesOnly,filter:n,formatter:s,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:l.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:l.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:l.strictNullHandling}}(e);"function"==typeof d.filter?s=(0,d.filter)("",s):o(d.filter)&&(i=d.filter);var h,p=[];if("object"!=typeof s||null===s)return"";h=e&&e.arrayFormat in n?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices";var f=n[h];i||(i=Object.keys(s)),d.sort&&i.sort(d.sort);for(var m=0;m<i.length;++m){var g=i[m];d.skipNulls&&null===s[g]||c(p,u(s[g],g,f,d.strictNullHandling,d.skipNulls,d.encode?d.encoder:null,d.filter,d.sort,d.allowDots,d.serializeDate,d.formatter,d.encodeValuesOnly,d.charset))}var y=p.join(d.delimiter),v=!0===d.addQueryPrefix?"?":"";return d.charsetSentinel&&("iso-8859-1"===d.charset?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),y.length>0?v+y:""}},6907(t,e,i){"use strict";i.d(e,{fP:()=>v});var s=i(40),r=i(9550),a=i(1686),n=i(9793),o=i(7925),d=i(2256),c=i(5307),h=i(9620),l=i(1668),u=i(9161),p=i(591),f=i(916),m=i(4365),g=i(3463),y=i(9873);class v{constructor(t){this.structs=v.getAbiStruct(t),this.enums=v.getAbiEnum(t),this.parser=(0,p.k)(t),this.abi=this.parser.getLegacyFormat()}validate(t,e,i=[]){if(t!==s.fE.DEPLOY){const i=this.abi.filter(e=>{if("function"!==e.type)return!1;const i="view"===e.stateMutability||"view"===e.state_mutability;return t===s.fE.INVOKE?!i:i}).map(t=>t.name);(0,r.A)(i.includes(e),(t===s.fE.INVOKE?"invocable":"viewable")+" method not found in abi")}const a=this.abi.find(i=>t===s.fE.DEPLOY?i.name===e&&"constructor"===i.type:i.name===e&&"function"===i.type);if((0,p.CO)(e,i,a))return;const n=this.parser.methodInputsLength(a);if(i.length!==n)throw Error(`Invalid number of arguments, expected ${n} arguments, but got ${i.length}`);(0,y.A)(a,i,this.structs,this.enums)}compile(t,e){const i=this.abi.find(e=>e.name===t);if((0,p.CO)(t,e,i))return[];let s;if(Array.isArray(e))s=e;else{const t=(0,f.A)(e,i.inputs,this.structs,this.enums);s=Object.values(t),(0,y.A)(i,s,this.structs,this.enums)}const r=s[Symbol.iterator](),a=i.inputs.reduce((t,e)=>(0,c.ct)(e.name)&&!(0,c.s8)(e.type)?t:t.concat((0,m.A)(r,e,this.structs,this.enums)),[]);return Object.defineProperty(a,"__compiled__",{enumerable:!1,writable:!1,value:!0}),a}static compile(t){const e=t=>{const e=(t,i=".")=>{const s=Array.isArray(t)?[t.length.toString(),...t]:t;return Object.entries(s).flatMap(([t,r])=>{let u=r;"entrypoint"===t?u=(0,n.BK)(u):(0,o.IN)(u)&&(u=(0,d.p)(u));const p=Array.isArray(s)&&"0"===t?"$$len":t;if((0,a.sI)(u))return[[`${i}${p}`,(0,c.AB)(u)]];if(Object(u)===u){const t=Object.getOwnPropertyNames(Object.getPrototypeOf(u)),s=[...Object.getOwnPropertyNames(u),...t];if(s.includes("isSome")&&s.includes("isNone")){const t=u,s=t.isSome()?h.R.Some:h.R.None;return t.isSome()?e({0:s,1:t.unwrap()},`${i}${p}.`):[[`${i}${p}`,(0,c.AB)(s)]]}if(s.includes("isOk")&&s.includes("isErr")){const t=u,s=t.isOk()?l.B.Ok:l.B.Err;return e({0:s,1:t.unwrap()},`${i}${p}.`)}if(s.includes("variant")&&s.includes("activeVariant")){const t=u,s=t.activeVariant(),r=Object.keys(t.variant).findIndex(t=>t===s);return"object"==typeof t.unwrap()&&0===Object.keys(t.unwrap()).length?[[`${i}${p}`,(0,c.AB)(r)]]:e({0:r,1:t.unwrap()},`${i}${p}.`)}return e(u,`${i}${p}.`)}return[[`${i}${p}`,(0,c.AB)(u)]]})};return Object.fromEntries(e(t))};let i;if(Array.isArray(t)){const s=e({...t});i=Object.values(s)}else{const s=e(t);i=Object.values(s)}return Object.defineProperty(i,"__compiled__",{enumerable:!1,writable:!1,value:!0}),i}parse(t,e){const{outputs:i}=this.abi.find(e=>e.name===t),s=e.flat()[Symbol.iterator](),r=i.flat().reduce((t,e,i)=>{const r=e.name??i;return t[r]=(0,g.A)(s,e,this.structs,this.enums,t),t[r]&&t[`${r}_len`]&&delete t[`${r}_len`],t},{});return 1===Object.keys(r).length&&0 in r?r[0]:r}format(t,e,i){const s=this.parse(t,e);return(0,u.A)(s,i)}static getAbiStruct(t){return t.filter(t=>"struct"===t.type).reduce((t,e)=>({...t,[e.name]:e}),{})}static getAbiEnum(t){const e=t.filter(t=>"enum"===t.type).reduce((t,e)=>({...t,[e.name]:e}),{});return delete e["core::bool"],e}static toCalldata(t=[]){return v.compile(t)}static toHex(t=[]){return v.compile(t).map(t=>(0,a.nj)(t))}decodeParameters(t,e){const i=Array.isArray(t)?t:[t],s=e.flat()[Symbol.iterator](),r=i.map(t=>(0,g.A)(s,{name:"",type:t},this.structs,this.enums));return 1===r.length?r[0]:r}}},7021(t,e,i){"use strict";i.d(e,{KO:()=>s}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const s={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.denom&&e.uint32(10).string(t.denom),""!==t.amount&&e.uint32(18).string(t.amount),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={denom:"",amount:""};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.denom=i.string();break;case 2:r.amount=i.string();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={denom:"",amount:""};return e.denom=t.denom??"",e.amount=t.amount??"",e}}},7171(t,e,i){"use strict";i.r(e),i.d(e,{AuthInfo:()=>y,AuxSignerData:()=>A,Fee:()=>T,ModeInfo:()=>w,ModeInfo_Multi:()=>k,ModeInfo_Single:()=>S,SignDoc:()=>u,SignDocDirectAux:()=>f,SignerInfo:()=>b,Tip:()=>P,Tx:()=>d,TxBody:()=>g,TxRaw:()=>h});var s=i(8166),r=i(497),a=i(7021);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var n=i(1291),o=i.n(n);const d={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.body&&g.encode(t.body,e.uint32(10).fork()).ldelim(),void 0!==t.authInfo&&y.encode(t.authInfo,e.uint32(18).fork()).ldelim();for(const i of t.signatures)e.uint32(26).bytes(i);return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={body:void 0,authInfo:void 0,signatures:[]};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.body=g.decode(i,i.uint32());break;case 2:r.authInfo=y.decode(i,i.uint32());break;case 3:r.signatures.push(i.bytes());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={body:void 0,authInfo:void 0,signatures:[]};return e.body=void 0!==t.body&&null!==t.body?g.fromPartial(t.body):void 0,e.authInfo=void 0!==t.authInfo&&null!==t.authInfo?y.fromPartial(t.authInfo):void 0,e.signatures=t.signatures?.map(t=>t)||[],e}};function c(){return{bodyBytes:new Uint8Array,authInfoBytes:new Uint8Array,signatures:[]}}const h={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){0!==t.bodyBytes.length&&e.uint32(10).bytes(t.bodyBytes),0!==t.authInfoBytes.length&&e.uint32(18).bytes(t.authInfoBytes);for(const i of t.signatures)e.uint32(26).bytes(i);return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=c();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.bodyBytes=i.bytes();break;case 2:r.authInfoBytes=i.bytes();break;case 3:r.signatures.push(i.bytes());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=c();return e.bodyBytes=t.bodyBytes??new Uint8Array,e.authInfoBytes=t.authInfoBytes??new Uint8Array,e.signatures=t.signatures?.map(t=>t)||[],e}};function l(){return{bodyBytes:new Uint8Array,authInfoBytes:new Uint8Array,chainId:"",accountNumber:o().UZERO}}const u={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.bodyBytes.length&&e.uint32(10).bytes(t.bodyBytes),0!==t.authInfoBytes.length&&e.uint32(18).bytes(t.authInfoBytes),""!==t.chainId&&e.uint32(26).string(t.chainId),t.accountNumber.isZero()||e.uint32(32).uint64(t.accountNumber),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=l();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.bodyBytes=i.bytes();break;case 2:r.authInfoBytes=i.bytes();break;case 3:r.chainId=i.string();break;case 4:r.accountNumber=i.uint64();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=l();return e.bodyBytes=t.bodyBytes??new Uint8Array,e.authInfoBytes=t.authInfoBytes??new Uint8Array,e.chainId=t.chainId??"",e.accountNumber=void 0!==t.accountNumber&&null!==t.accountNumber?o().fromValue(t.accountNumber):o().UZERO,e}};function p(){return{bodyBytes:new Uint8Array,publicKey:void 0,chainId:"",accountNumber:o().UZERO,sequence:o().UZERO,tip:void 0}}const f={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.bodyBytes.length&&e.uint32(10).bytes(t.bodyBytes),void 0!==t.publicKey&&s.F.encode(t.publicKey,e.uint32(18).fork()).ldelim(),""!==t.chainId&&e.uint32(26).string(t.chainId),t.accountNumber.isZero()||e.uint32(32).uint64(t.accountNumber),t.sequence.isZero()||e.uint32(40).uint64(t.sequence),void 0!==t.tip&&P.encode(t.tip,e.uint32(50).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=p();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.bodyBytes=i.bytes();break;case 2:a.publicKey=s.F.decode(i,i.uint32());break;case 3:a.chainId=i.string();break;case 4:a.accountNumber=i.uint64();break;case 5:a.sequence=i.uint64();break;case 6:a.tip=P.decode(i,i.uint32());break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=p();return e.bodyBytes=t.bodyBytes??new Uint8Array,e.publicKey=void 0!==t.publicKey&&null!==t.publicKey?s.F.fromPartial(t.publicKey):void 0,e.chainId=t.chainId??"",e.accountNumber=void 0!==t.accountNumber&&null!==t.accountNumber?o().fromValue(t.accountNumber):o().UZERO,e.sequence=void 0!==t.sequence&&null!==t.sequence?o().fromValue(t.sequence):o().UZERO,e.tip=void 0!==t.tip&&null!==t.tip?P.fromPartial(t.tip):void 0,e}};function m(){return{messages:[],memo:"",timeoutHeight:o().UZERO,extensionOptions:[],nonCriticalExtensionOptions:[]}}const g={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.messages)s.F.encode(i,e.uint32(10).fork()).ldelim();""!==t.memo&&e.uint32(18).string(t.memo),t.timeoutHeight.isZero()||e.uint32(24).uint64(t.timeoutHeight);for(const i of t.extensionOptions)s.F.encode(i,e.uint32(8186).fork()).ldelim();for(const i of t.nonCriticalExtensionOptions)s.F.encode(i,e.uint32(16378).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=m();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.messages.push(s.F.decode(i,i.uint32()));break;case 2:a.memo=i.string();break;case 3:a.timeoutHeight=i.uint64();break;case 1023:a.extensionOptions.push(s.F.decode(i,i.uint32()));break;case 2047:a.nonCriticalExtensionOptions.push(s.F.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=m();return e.messages=t.messages?.map(t=>s.F.fromPartial(t))||[],e.memo=t.memo??"",e.timeoutHeight=void 0!==t.timeoutHeight&&null!==t.timeoutHeight?o().fromValue(t.timeoutHeight):o().UZERO,e.extensionOptions=t.extensionOptions?.map(t=>s.F.fromPartial(t))||[],e.nonCriticalExtensionOptions=t.nonCriticalExtensionOptions?.map(t=>s.F.fromPartial(t))||[],e}};const y={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.signerInfos)b.encode(i,e.uint32(10).fork()).ldelim();return void 0!==t.fee&&T.encode(t.fee,e.uint32(18).fork()).ldelim(),void 0!==t.tip&&P.encode(t.tip,e.uint32(26).fork()).ldelim(),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={signerInfos:[],fee:void 0,tip:void 0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.signerInfos.push(b.decode(i,i.uint32()));break;case 2:r.fee=T.decode(i,i.uint32());break;case 3:r.tip=P.decode(i,i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={signerInfos:[],fee:void 0,tip:void 0};return e.signerInfos=t.signerInfos?.map(t=>b.fromPartial(t))||[],e.fee=void 0!==t.fee&&null!==t.fee?T.fromPartial(t.fee):void 0,e.tip=void 0!==t.tip&&null!==t.tip?P.fromPartial(t.tip):void 0,e}};function v(){return{publicKey:void 0,modeInfo:void 0,sequence:o().UZERO}}const b={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.publicKey&&s.F.encode(t.publicKey,e.uint32(10).fork()).ldelim(),void 0!==t.modeInfo&&w.encode(t.modeInfo,e.uint32(18).fork()).ldelim(),t.sequence.isZero()||e.uint32(24).uint64(t.sequence),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=v();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.publicKey=s.F.decode(i,i.uint32());break;case 2:a.modeInfo=w.decode(i,i.uint32());break;case 3:a.sequence=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=v();return e.publicKey=void 0!==t.publicKey&&null!==t.publicKey?s.F.fromPartial(t.publicKey):void 0,e.modeInfo=void 0!==t.modeInfo&&null!==t.modeInfo?w.fromPartial(t.modeInfo):void 0,e.sequence=void 0!==t.sequence&&null!==t.sequence?o().fromValue(t.sequence):o().UZERO,e}};const w={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.single&&S.encode(t.single,e.uint32(10).fork()).ldelim(),void 0!==t.multi&&k.encode(t.multi,e.uint32(18).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={single:void 0,multi:void 0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.single=S.decode(i,i.uint32());break;case 2:r.multi=k.decode(i,i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={single:void 0,multi:void 0};return e.single=void 0!==t.single&&null!==t.single?S.fromPartial(t.single):void 0,e.multi=void 0!==t.multi&&null!==t.multi?k.fromPartial(t.multi):void 0,e}};const S={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.mode&&e.uint32(8).int32(t.mode),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={mode:0};for(;i.pos<s;){const t=i.uint32();if(t>>>3==1)r.mode=i.int32();else i.skipType(7&t)}return r},fromPartial(t){const e={mode:0};return e.mode=t.mode??0,e}};const k={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){void 0!==t.bitarray&&r.s.encode(t.bitarray,e.uint32(10).fork()).ldelim();for(const i of t.modeInfos)w.encode(i,e.uint32(18).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a={bitarray:void 0,modeInfos:[]};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.bitarray=r.s.decode(i,i.uint32());break;case 2:a.modeInfos.push(w.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={bitarray:void 0,modeInfos:[]};return e.bitarray=void 0!==t.bitarray&&null!==t.bitarray?r.s.fromPartial(t.bitarray):void 0,e.modeInfos=t.modeInfos?.map(t=>w.fromPartial(t))||[],e}};function O(){return{amount:[],gasLimit:o().UZERO,payer:"",granter:""}}const T={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.amount)a.KO.encode(i,e.uint32(10).fork()).ldelim();return t.gasLimit.isZero()||e.uint32(16).uint64(t.gasLimit),""!==t.payer&&e.uint32(26).string(t.payer),""!==t.granter&&e.uint32(34).string(t.granter),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=O();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.amount.push(a.KO.decode(i,i.uint32()));break;case 2:r.gasLimit=i.uint64();break;case 3:r.payer=i.string();break;case 4:r.granter=i.string();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=O();return e.amount=t.amount?.map(t=>a.KO.fromPartial(t))||[],e.gasLimit=void 0!==t.gasLimit&&null!==t.gasLimit?o().fromValue(t.gasLimit):o().UZERO,e.payer=t.payer??"",e.granter=t.granter??"",e}};const P={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.amount)a.KO.encode(i,e.uint32(10).fork()).ldelim();return""!==t.tipper&&e.uint32(18).string(t.tipper),e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={amount:[],tipper:""};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.amount.push(a.KO.decode(i,i.uint32()));break;case 2:r.tipper=i.string();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={amount:[],tipper:""};return e.amount=t.amount?.map(t=>a.KO.fromPartial(t))||[],e.tipper=t.tipper??"",e}};function _(){return{address:"",signDoc:void 0,mode:0,sig:new Uint8Array}}const A={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.address&&e.uint32(10).string(t.address),void 0!==t.signDoc&&f.encode(t.signDoc,e.uint32(18).fork()).ldelim(),0!==t.mode&&e.uint32(24).int32(t.mode),0!==t.sig.length&&e.uint32(34).bytes(t.sig),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=_();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.address=i.string();break;case 2:r.signDoc=f.decode(i,i.uint32());break;case 3:r.mode=i.int32();break;case 4:r.sig=i.bytes();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=_();return e.address=t.address??"",e.signDoc=void 0!==t.signDoc&&null!==t.signDoc?f.fromPartial(t.signDoc):void 0,e.mode=t.mode??0,e.sig=t.sig??new Uint8Array,e}}},7196(t,e,i){"use strict";i.d(e,{p:()=>a});var s=i(1279),r=i(6378),a={};void 0!==a.asn1&&a.asn1||(a.asn1={}),a.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var i=e.substr(1).length;i%2==1?i+=1:e.match(/^[0-7]/)||(i+=2);for(var r="",a=0;a<i;a++)r+="f";e=new s.jZ(r,16).xor(t).add(s.jZ.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return hextopem(t,e)},this.newObject=function(t){var e=a.asn1,i=e.DERBoolean,s=e.DERInteger,r=e.DERBitString,n=e.DEROctetString,o=e.DERNull,d=e.DERObjectIdentifier,c=e.DEREnumerated,h=e.DERUTF8String,l=e.DERNumericString,u=e.DERPrintableString,p=e.DERTeletexString,f=e.DERIA5String,m=e.DERUTCTime,g=e.DERGeneralizedTime,y=e.DERSequence,v=e.DERSet,b=e.DERTaggedObject,w=e.ASN1Util.newObject,S=Object.keys(t);if(1!=S.length)throw"key of param shall be only one.";var k=S[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+k+":"))throw"undefined key: "+k;if("bool"==k)return new i(t[k]);if("int"==k)return new s(t[k]);if("bitstr"==k)return new r(t[k]);if("octstr"==k)return new n(t[k]);if("null"==k)return new o(t[k]);if("oid"==k)return new d(t[k]);if("enum"==k)return new c(t[k]);if("utf8str"==k)return new h(t[k]);if("numstr"==k)return new l(t[k]);if("prnstr"==k)return new u(t[k]);if("telstr"==k)return new p(t[k]);if("ia5str"==k)return new f(t[k]);if("utctime"==k)return new m(t[k]);if("gentime"==k)return new g(t[k]);if("seq"==k){for(var O=t[k],T=[],P=0;P<O.length;P++){var _=w(O[P]);T.push(_)}return new y({array:T})}if("set"==k){for(O=t[k],T=[],P=0;P<O.length;P++){_=w(O[P]);T.push(_)}return new v({array:T})}if("tag"==k){var A=t[k];if("[object Array]"===Object.prototype.toString.call(A)&&3==A.length){var I=w(A[2]);return new b({tag:A[0],explicit:A[1],obj:I})}var x={};if(void 0!==A.explicit&&(x.explicit=A.explicit),void 0!==A.tag&&(x.tag=A.tag),void 0===A.obj)throw"obj shall be specified for 'tag'.";return x.obj=w(A.obj),new b(x)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},a.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",i=parseInt(t.substr(0,2),16),r=(e=Math.floor(i/40)+"."+i%40,""),a=2;a<t.length;a+=2){var n=("00000000"+parseInt(t.substr(a,2),16).toString(2)).slice(-8);if(r+=n.substr(1,7),"0"==n.substr(0,1))e=e+"."+new s.jZ(r,2).toString(10),r=""}return e},a.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",r=new s.jZ(t,10).toString(2),a=7-r.length%7;7==a&&(a=0);for(var n="",o=0;o<a;o++)n+="0";r=n+r;for(o=0;o<r.length-1;o+=7){var d=r.substr(o,7);o!=r.length-7&&(d="1"+d),i+=e(parseInt(d,2))}return i};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",a=t.split("."),n=40*parseInt(a[0])+parseInt(a[1]);r+=e(n),a.splice(0,2);for(var o=0;o<a.length;o++)r+=i(a[o]);return r},a.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n=0,v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var i=e.length/2;if(i>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+i).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},a.asn1.DERAbstractString=function(t){a.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},r.b.lang.extend(a.asn1.DERAbstractString,a.asn1.ASN1Object),a.asn1.DERAbstractTime=function(t){a.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,i){var s=this.zeroPadding,r=this.localDateToUTC(t),a=String(r.getFullYear());"utc"==e&&(a=a.substr(2,2));var n=a+s(String(r.getMonth()+1),2)+s(String(r.getDate()),2)+s(String(r.getHours()),2)+s(String(r.getMinutes()),2)+s(String(r.getSeconds()),2);if(!0===i){var o=r.getMilliseconds();if(0!=o){var d=s(String(o),3);n=n+"."+(d=d.replace(/[0]+$/,""))}}return n+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(t)},this.setByDateValue=function(t,e,i,s,r,a){var n=new Date(Date.UTC(t,e-1,i,s,r,a,0));this.setByDate(n)},this.getFreshValueHex=function(){return this.hV}},r.b.lang.extend(a.asn1.DERAbstractTime,a.asn1.ASN1Object),a.asn1.DERAbstractStructured=function(t){a.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},r.b.lang.extend(a.asn1.DERAbstractStructured,a.asn1.ASN1Object),a.asn1.DERBoolean=function(){a.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},r.b.lang.extend(a.asn1.DERBoolean,a.asn1.ASN1Object),a.asn1.DERInteger=function(t){a.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=a.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new s.jZ(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},r.b.lang.extend(a.asn1.DERInteger,a.asn1.ASN1Object),a.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=a.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}a.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var i=0;i<=e;i++)t+="0";var s="";for(i=0;i<t.length-1;i+=8){var r=t.substr(i,8),a=parseInt(r,2).toString(16);1==a.length&&(a="0"+a),s+=a}this.hTLV=null,this.isModified=!0,this.hV="0"+e+s},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)1==t[i]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},r.b.lang.extend(a.asn1.DERBitString,a.asn1.ASN1Object),a.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=a.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}a.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},r.b.lang.extend(a.asn1.DEROctetString,a.asn1.DERAbstractString),a.asn1.DERNull=function(){a.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},r.b.lang.extend(a.asn1.DERNull,a.asn1.ASN1Object),a.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",r=new s.jZ(t,10).toString(2),a=7-r.length%7;7==a&&(a=0);for(var n="",o=0;o<a;o++)n+="0";r=n+r;for(o=0;o<r.length-1;o+=7){var d=r.substr(o,7);o!=r.length-7&&(d="1"+d),i+=e(parseInt(d,2))}return i};a.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var s="",r=t.split("."),a=40*parseInt(r[0])+parseInt(r[1]);s+=e(a),r.splice(0,2);for(var n=0;n<r.length;n++)s+=i(r[n]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=s},this.setValueName=function(t){var e=a.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},r.b.lang.extend(a.asn1.DERObjectIdentifier,a.asn1.ASN1Object),a.asn1.DEREnumerated=function(t){a.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=a.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new s.jZ(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},r.b.lang.extend(a.asn1.DEREnumerated,a.asn1.ASN1Object),a.asn1.DERUTF8String=function(t){a.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},r.b.lang.extend(a.asn1.DERUTF8String,a.asn1.DERAbstractString),a.asn1.DERNumericString=function(t){a.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},r.b.lang.extend(a.asn1.DERNumericString,a.asn1.DERAbstractString),a.asn1.DERPrintableString=function(t){a.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},r.b.lang.extend(a.asn1.DERPrintableString,a.asn1.DERAbstractString),a.asn1.DERTeletexString=function(t){a.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},r.b.lang.extend(a.asn1.DERTeletexString,a.asn1.DERAbstractString),a.asn1.DERIA5String=function(t){a.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},r.b.lang.extend(a.asn1.DERIA5String,a.asn1.DERAbstractString),a.asn1.DERUTCTime=function(t){a.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},r.b.lang.extend(a.asn1.DERUTCTime,a.asn1.DERAbstractTime),a.asn1.DERGeneralizedTime=function(t){a.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},r.b.lang.extend(a.asn1.DERGeneralizedTime,a.asn1.DERAbstractTime),a.asn1.DERSequence=function(t){a.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},r.b.lang.extend(a.asn1.DERSequence,a.asn1.DERAbstractStructured),a.asn1.DERSet=function(t){a.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},r.b.lang.extend(a.asn1.DERSet,a.asn1.DERAbstractStructured),a.asn1.DERTaggedObject=function(t){a.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},r.b.lang.extend(a.asn1.DERTaggedObject,a.asn1.ASN1Object)},7288(t,e,i){"use strict";i.d(e,{A:()=>l});var s=i(1591),r=i.n(s),a=i(934),n=i(7597),o=i(8403),d=i(6238),c=i(3206);const h=n.Ll||!(0,d.Se)()?r():self.WebSocket;class l extends a.A{constructor(){super(...arguments),this.startedConnecting=!1}createConnection(){this.verbose&&this.log(new Date,"connecting to",this.url),this.connectionStarted=(0,o.Rz)(),this.setConnectionTimeout();const t={};if(void 0!==this.cookies){let e="";const i=Object.keys(this.cookies);for(let t=0;t<i.length;t++){const s=i[t];e+=s+"="+this.cookies[s],t<i.length-1&&(e+="; ")}t.Cookie=e,this.options.headers=Object.assign(this.options.headers||{},t)}n.Ll?this.connection=new h(this.url,this.protocols,this.options):this.connection=new h(this.url,this.protocols),this.connection.onopen=this.onOpen.bind(this),this.connection.onmessage=this.onMessage.bind(this),this.connection.onerror=this.onError.bind(this),this.connection.onclose=this.onClose.bind(this),n.Ll&&this.connection.on("ping",this.onPing.bind(this)).on("pong",this.onPong.bind(this)).on("upgrade",this.onUpgrade.bind(this))}connect(t=0){return this.startedConnecting||(this.startedConnecting=!0,t?(0,o.yy)(t).then(this.createConnection.bind(this)):this.createConnection()),this.connected}isOpen(){return this.connection.readyState===h.OPEN}close(){return this.connection instanceof h&&(void 0===this.disconnected&&(this.disconnected=(0,c.K)()),this.connection.close()),this.disconnected}}},7418(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},7437(t,e,i){"use strict";i.d(e,{$r:()=>p,$z:()=>y,Am:()=>h,Bq:()=>k,CA:()=>m,Ey:()=>O,HP:()=>r,Im:()=>f,Pe:()=>n,RV:()=>u,Sj:()=>c,Ul:()=>w,WP:()=>b,X$:()=>o,ax:()=>l,cJ:()=>T,cz:()=>P,di:()=>g,h1:()=>A,o8:()=>d,sy:()=>S,wQ:()=>v,zu:()=>a,zw:()=>_});var s=i(6834);const r=Object.keys,a=t=>(0,s.cy)(t)?t:Object.values(t),n=t=>new Set(a(t)),o=(...t)=>Object.assign({},...t),d=t=>(0,s.cy)(t)?Array.from(t):o(t),c=t=>t,h=t=>Array.from(n(t)),l=(t,e)=>t.concat(e),u=(t,e)=>e.includes(t),p=t=>Object.values(t),f=t=>!t||(Array.isArray(t)?t:Object.keys(t)).length<1,m=(t,e={})=>{for(const i of r(t).sort())e[i]=t[i];return e},g=t=>{const e=t.slice();return e.sort(),e},y=(t,e,i={})=>{for(const s of a(t))if(e in s){const t=s[e];i[t]=i[t]||[],i[t].push(s)}return i},v=(t,e,i={})=>{for(const s of a(t))e in s&&(i[s[e]]=s);return i},b=(t,e,i=void 0,s=[])=>{for(const r of a(t))r[e]===i&&s.push(r);return s},w=(t,e,i=!1,s=0,r=(i?-1:1))=>t.sort((t,i)=>{const a=e in t?t[e]:s,n=e in i?i[e]:s;return a<n?-r:a>n?r:0}),S=(t,e,i,s=!1,r=(s?-1:1))=>t.sort((t,s)=>t[e]<s[e]?-r:t[e]>s[e]?r:t[i]<s[i]?-r:t[i]>s[i]?r:0),k=function t(e,i=[]){for(const r of e)(0,s.cy)(r)?t(r,i):i.push(r);return i},O=(t,e)=>a(t).filter(t=>e in t).map(t=>t[e]),T=(t,...e)=>{if(!Array.isArray(t)){const i=d(t);for(const t of e)if((0,s.cy)(t))for(const e of t)delete i[e];else delete i[t];return i}return t},P=(...t)=>{const e=t.filter(s.Et);return e.length>0?e.reduce((t,e)=>t+e,0):void 0},_=function t(...e){let i;for(const r of e)if((0,s.Hf)(r)){(0,s.Hf)(i)||(i={});for(const e in r)i[e]=t(i[e],r[e])}else i=r;return i},A=(t,...e)=>{const i={},s=Object.assign({},...e),r=Object.keys(s);for(let e=0;e<r.length;e++){const a=r[e];void 0===t[a]&&(i[a]=s[a])}return Object.assign({},t,i)}},7481(t,e,i){"use strict";i.d(e,{Zf:()=>f});var s=i(230),r=i(6157),a=i(1094);const[n,o]=r.Ay.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),d=new Uint32Array(80),c=new Uint32Array(80);class h extends s.D{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:i,Bl:s,Ch:r,Cl:a,Dh:n,Dl:o,Eh:d,El:c,Fh:h,Fl:l,Gh:u,Gl:p,Hh:f,Hl:m}=this;return[t,e,i,s,r,a,n,o,d,c,h,l,u,p,f,m]}set(t,e,i,s,r,a,n,o,d,c,h,l,u,p,f,m){this.Ah=0|t,this.Al=0|e,this.Bh=0|i,this.Bl=0|s,this.Ch=0|r,this.Cl=0|a,this.Dh=0|n,this.Dl=0|o,this.Eh=0|d,this.El=0|c,this.Fh=0|h,this.Fl=0|l,this.Gh=0|u,this.Gl=0|p,this.Hh=0|f,this.Hl=0|m}process(t,e){for(let i=0;i<16;i++,e+=4)d[i]=t.getUint32(e),c[i]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|d[t-15],i=0|c[t-15],s=r.Ay.rotrSH(e,i,1)^r.Ay.rotrSH(e,i,8)^r.Ay.shrSH(e,i,7),a=r.Ay.rotrSL(e,i,1)^r.Ay.rotrSL(e,i,8)^r.Ay.shrSL(e,i,7),n=0|d[t-2],o=0|c[t-2],h=r.Ay.rotrSH(n,o,19)^r.Ay.rotrBH(n,o,61)^r.Ay.shrSH(n,o,6),l=r.Ay.rotrSL(n,o,19)^r.Ay.rotrBL(n,o,61)^r.Ay.shrSL(n,o,6),u=r.Ay.add4L(a,l,c[t-7],c[t-16]),p=r.Ay.add4H(u,s,h,d[t-7],d[t-16]);d[t]=0|p,c[t]=0|u}let{Ah:i,Al:s,Bh:a,Bl:h,Ch:l,Cl:u,Dh:p,Dl:f,Eh:m,El:g,Fh:y,Fl:v,Gh:b,Gl:w,Hh:S,Hl:k}=this;for(let t=0;t<80;t++){const e=r.Ay.rotrSH(m,g,14)^r.Ay.rotrSH(m,g,18)^r.Ay.rotrBH(m,g,41),O=r.Ay.rotrSL(m,g,14)^r.Ay.rotrSL(m,g,18)^r.Ay.rotrBL(m,g,41),T=m&y^~m&b,P=g&v^~g&w,_=r.Ay.add5L(k,O,P,o[t],c[t]),A=r.Ay.add5H(_,S,e,T,n[t],d[t]),I=0|_,x=r.Ay.rotrSH(i,s,28)^r.Ay.rotrBH(i,s,34)^r.Ay.rotrBH(i,s,39),E=r.Ay.rotrSL(i,s,28)^r.Ay.rotrBL(i,s,34)^r.Ay.rotrBL(i,s,39),M=i&a^i&l^a&l,C=s&h^s&u^h&u;S=0|b,k=0|w,b=0|y,w=0|v,y=0|m,v=0|g,({h:m,l:g}=r.Ay.add(0|p,0|f,0|A,0|I)),p=0|l,f=0|u,l=0|a,u=0|h,a=0|i,h=0|s;const B=r.Ay.add3L(I,E,C);i=r.Ay.add3H(B,A,x,M),s=0|B}({h:i,l:s}=r.Ay.add(0|this.Ah,0|this.Al,0|i,0|s)),({h:a,l:h}=r.Ay.add(0|this.Bh,0|this.Bl,0|a,0|h)),({h:l,l:u}=r.Ay.add(0|this.Ch,0|this.Cl,0|l,0|u)),({h:p,l:f}=r.Ay.add(0|this.Dh,0|this.Dl,0|p,0|f)),({h:m,l:g}=r.Ay.add(0|this.Eh,0|this.El,0|m,0|g)),({h:y,l:v}=r.Ay.add(0|this.Fh,0|this.Fl,0|y,0|v)),({h:b,l:w}=r.Ay.add(0|this.Gh,0|this.Gl,0|b,0|w)),({h:S,l:k}=r.Ay.add(0|this.Hh,0|this.Hl,0|S,0|k)),this.set(i,s,a,h,l,u,p,f,m,g,y,v,b,w,S,k)}roundClean(){d.fill(0),c.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class l extends h{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class u extends h{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class p extends h{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const f=(0,a.ld)(()=>new h);(0,a.ld)(()=>new l),(0,a.ld)(()=>new u),(0,a.ld)(()=>new p)},7504(t,e,i){"use strict";i.d(e,{A:()=>c});var s=i(5661),r=i(2079),a=i(5147),n=i(1579),o=i(4852),d=i(5354);class c extends s.A{describe(){return this.deepExtend(super.describe(),{id:"coinbase",name:"Coinbase Advanced",countries:["US"],pro:!0,certified:!1,rateLimit:34,version:"v2",userAgent:this.userAgents.chrome,headers:{"CB-VERSION":"2018-05-30"},has:{CORS:!0,spot:!0,margin:!1,swap:!1,future:!1,option:!1,addMargin:!1,borrowCrossMargin:!1,borrowIsolatedMargin:!1,borrowMargin:!1,cancelOrder:!0,cancelOrders:!0,closeAllPositions:!1,closePosition:!0,createConvertTrade:!0,createDepositAddress:!0,createLimitBuyOrder:!0,createLimitSellOrder:!0,createMarketBuyOrder:!0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!1,createMarketSellOrder:!0,createMarketSellOrderWithCost:!1,createOrder:!0,createOrderWithTakeProfitAndStopLoss:!1,createOrderWithTakeProfitAndStopLossWs:!1,createPostOnlyOrder:!0,createReduceOnlyOrder:!1,createStopLimitOrder:!0,createStopMarketOrder:!1,createStopOrder:!0,deposit:!0,editOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchBidsAsks:!0,fetchBorrowInterest:!1,fetchBorrowRate:!1,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchBorrowRates:!1,fetchBorrowRatesPerSymbol:!1,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchConvertQuote:!0,fetchConvertTrade:!0,fetchConvertTradeHistory:!1,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:!0,fetchDepositAddress:"emulated",fetchDepositAddresses:!0,fetchDepositAddressesByNetwork:!0,fetchDepositMethodId:!0,fetchDepositMethodIds:!0,fetchDeposits:!0,fetchDepositsWithdrawals:!0,fetchFundingHistory:!1,fetchFundingInterval:!1,fetchFundingIntervals:!1,fetchFundingRate:!1,fetchFundingRateHistory:!1,fetchFundingRates:!1,fetchGreeks:!1,fetchIndexOHLCV:!1,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchIsolatedPositions:!1,fetchL2OrderBook:!1,fetchLedger:!0,fetchLeverage:!1,fetchLeverages:!1,fetchLeverageTiers:!1,fetchLiquidations:!1,fetchLongShortRatio:!1,fetchLongShortRatioHistory:!1,fetchMarginAdjustmentHistory:!1,fetchMarginMode:!1,fetchMarginModes:!1,fetchMarketLeverageTiers:!1,fetchMarkets:!0,fetchMarkOHLCV:!1,fetchMarkPrices:!1,fetchMyBuys:!0,fetchMyLiquidations:!1,fetchMySells:!0,fetchMySettlementHistory:!1,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!1,fetchOpenInterestHistory:!1,fetchOpenInterests:!1,fetchOpenOrders:!0,fetchOption:!1,fetchOptionChain:!1,fetchOrder:!0,fetchOrderBook:!0,fetchOrders:!0,fetchPosition:!0,fetchPositionHistory:!1,fetchPositionMode:!1,fetchPositions:!0,fetchPositionsForSymbol:!1,fetchPositionsHistory:!1,fetchPositionsRisk:!1,fetchPremiumIndexOHLCV:!1,fetchSettlementHistory:!1,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:"emulated",fetchTradingFees:!0,fetchVolatilityHistory:!1,fetchWithdrawals:!0,reduceMargin:!1,repayCrossMargin:!1,repayIsolatedMargin:!1,repayMargin:!1,setLeverage:!1,setMargin:!1,setMarginMode:!1,setPositionMode:!1,withdraw:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/40811661-b6eceae2-653a-11e8-829e-10bfadb078cf.jpg",api:{rest:"https://api.coinbase.com"},www:"https://www.coinbase.com",doc:["https://developers.coinbase.com/api/v2","https://docs.cloud.coinbase.com/advanced-trade/docs/welcome"],fees:["https://support.coinbase.com/customer/portal/articles/2109597-buy-sell-bank-transfer-fees","https://www.coinbase.com/advanced-fees"],referral:"https://www.coinbase.com/join/58cbe25a355148797479dbd2"},requiredCredentials:{apiKey:!0,secret:!0},api:{v2:{public:{get:{currencies:10.6,"currencies/crypto":10.6,time:10.6,"exchange-rates":10.6,"users/{user_id}":10.6,"prices/{symbol}/buy":10.6,"prices/{symbol}/sell":10.6,"prices/{symbol}/spot":10.6}},private:{get:{accounts:10.6,"accounts/{account_id}":10.6,"accounts/{account_id}/addresses":10.6,"accounts/{account_id}/addresses/{address_id}":10.6,"accounts/{account_id}/addresses/{address_id}/transactions":10.6,"accounts/{account_id}/transactions":10.6,"accounts/{account_id}/transactions/{transaction_id}":10.6,"accounts/{account_id}/buys":10.6,"accounts/{account_id}/buys/{buy_id}":10.6,"accounts/{account_id}/sells":10.6,"accounts/{account_id}/sells/{sell_id}":10.6,"accounts/{account_id}/deposits":10.6,"accounts/{account_id}/deposits/{deposit_id}":10.6,"accounts/{account_id}/withdrawals":10.6,"accounts/{account_id}/withdrawals/{withdrawal_id}":10.6,"payment-methods":10.6,"payment-methods/{payment_method_id}":10.6,user:10.6,"user/auth":10.6},post:{accounts:10.6,"accounts/{account_id}/primary":10.6,"accounts/{account_id}/addresses":10.6,"accounts/{account_id}/transactions":10.6,"accounts/{account_id}/transactions/{transaction_id}/complete":10.6,"accounts/{account_id}/transactions/{transaction_id}/resend":10.6,"accounts/{account_id}/buys":10.6,"accounts/{account_id}/buys/{buy_id}/commit":10.6,"accounts/{account_id}/sells":10.6,"accounts/{account_id}/sells/{sell_id}/commit":10.6,"accounts/{account_id}/deposits":10.6,"accounts/{account_id}/deposits/{deposit_id}/commit":10.6,"accounts/{account_id}/withdrawals":10.6,"accounts/{account_id}/withdrawals/{withdrawal_id}/commit":10.6},put:{"accounts/{account_id}":10.6,user:10.6},delete:{"accounts/{id}":10.6,"accounts/{account_id}/transactions/{transaction_id}":10.6}}},v3:{public:{get:{"brokerage/time":3,"brokerage/market/product_book":3,"brokerage/market/products":3,"brokerage/market/products/{product_id}":3,"brokerage/market/products/{product_id}/candles":3,"brokerage/market/products/{product_id}/ticker":3}},private:{get:{"brokerage/accounts":1,"brokerage/accounts/{account_uuid}":1,"brokerage/orders/historical/batch":1,"brokerage/orders/historical/fills":1,"brokerage/orders/historical/{order_id}":1,"brokerage/products":3,"brokerage/products/{product_id}":3,"brokerage/products/{product_id}/candles":3,"brokerage/products/{product_id}/ticker":3,"brokerage/best_bid_ask":3,"brokerage/product_book":3,"brokerage/transaction_summary":3,"brokerage/portfolios":1,"brokerage/portfolios/{portfolio_uuid}":1,"brokerage/convert/trade/{trade_id}":1,"brokerage/cfm/balance_summary":1,"brokerage/cfm/positions":1,"brokerage/cfm/positions/{product_id}":1,"brokerage/cfm/sweeps":1,"brokerage/intx/portfolio/{portfolio_uuid}":1,"brokerage/intx/positions/{portfolio_uuid}":1,"brokerage/intx/positions/{portfolio_uuid}/{symbol}":1,"brokerage/payment_methods":1,"brokerage/payment_methods/{payment_method_id}":1,"brokerage/key_permissions":1},post:{"brokerage/orders":1,"brokerage/orders/batch_cancel":1,"brokerage/orders/edit":1,"brokerage/orders/edit_preview":1,"brokerage/orders/preview":1,"brokerage/portfolios":1,"brokerage/portfolios/move_funds":1,"brokerage/convert/quote":1,"brokerage/convert/trade/{trade_id}":1,"brokerage/cfm/sweeps/schedule":1,"brokerage/intx/allocate":1,"brokerage/orders/close_position":1},put:{"brokerage/portfolios/{portfolio_uuid}":1},delete:{"brokerage/portfolios/{portfolio_uuid}":1,"brokerage/cfm/sweeps":1}}}},fees:{trading:{taker:this.parseNumber("0.012"),maker:this.parseNumber("0.006"),tierBased:!0,percentage:!0,tiers:{taker:[[this.parseNumber("0"),this.parseNumber("0.006")],[this.parseNumber("10000"),this.parseNumber("0.004")],[this.parseNumber("50000"),this.parseNumber("0.0025")],[this.parseNumber("100000"),this.parseNumber("0.002")],[this.parseNumber("1000000"),this.parseNumber("0.0018")],[this.parseNumber("15000000"),this.parseNumber("0.0016")],[this.parseNumber("75000000"),this.parseNumber("0.0012")],[this.parseNumber("250000000"),this.parseNumber("0.0008")],[this.parseNumber("400000000"),this.parseNumber("0.0005")]],maker:[[this.parseNumber("0"),this.parseNumber("0.004")],[this.parseNumber("10000"),this.parseNumber("0.0025")],[this.parseNumber("50000"),this.parseNumber("0.0015")],[this.parseNumber("100000"),this.parseNumber("0.001")],[this.parseNumber("1000000"),this.parseNumber("0.0008")],[this.parseNumber("15000000"),this.parseNumber("0.0006")],[this.parseNumber("75000000"),this.parseNumber("0.0003")],[this.parseNumber("250000000"),this.parseNumber("0.0")],[this.parseNumber("400000000"),this.parseNumber("0.0")]]}}},precisionMode:n.kb,exceptions:{exact:{two_factor_required:r.AuthenticationError,param_required:r.ExchangeError,validation_error:r.ExchangeError,invalid_request:r.ExchangeError,personal_details_required:r.AuthenticationError,identity_verification_required:r.AuthenticationError,jumio_verification_required:r.AuthenticationError,jumio_face_match_verification_required:r.AuthenticationError,unverified_email:r.AuthenticationError,authentication_error:r.AuthenticationError,invalid_authentication_method:r.AuthenticationError,invalid_token:r.AuthenticationError,revoked_token:r.AuthenticationError,expired_token:r.AuthenticationError,invalid_scope:r.AuthenticationError,not_found:r.ExchangeError,rate_limit_exceeded:r.RateLimitExceeded,internal_server_error:r.ExchangeError,UNSUPPORTED_ORDER_CONFIGURATION:r.BadRequest,INSUFFICIENT_FUND:r.InsufficientFunds,PERMISSION_DENIED:r.PermissionDenied,INVALID_ARGUMENT:r.BadRequest,PREVIEW_STOP_PRICE_ABOVE_LAST_TRADE_PRICE:r.InvalidOrder,PREVIEW_INSUFFICIENT_FUND:r.InsufficientFunds},broad:{"Insufficient balance in source account":r.InsufficientFunds,"request timestamp expired":r.InvalidNonce,"order with this orderID was not found":r.OrderNotFound}},timeframes:{"1m":"ONE_MINUTE","5m":"FIVE_MINUTE","15m":"FIFTEEN_MINUTE","30m":"THIRTY_MINUTE","1h":"ONE_HOUR","2h":"TWO_HOUR","6h":"SIX_HOUR","1d":"ONE_DAY"},commonCurrencies:{CGLD:"CELO"},options:{usePrivate:!1,brokerId:"ccxt",stablePairs:["BUSD-USD","CBETH-ETH","DAI-USD","GUSD-USD","GYEN-USD","PAX-USD","PAX-USDT","USDC-EUR","USDC-GBP","USDT-EUR","USDT-GBP","USDT-USD","USDT-USDC","WBTC-BTC"],fetchCurrencies:{expires:5e3},accounts:["wallet","fiat"],v3Accounts:["ACCOUNT_TYPE_CRYPTO","ACCOUNT_TYPE_FIAT"],networks:{ERC20:"ethereum",XLM:"stellar"},createMarketBuyOrderRequiresPrice:!0,advanced:!0,fetchMarkets:"fetchMarketsV3",timeDifference:0,adjustForTimeDifference:!1,fetchTicker:"fetchTickerV3",fetchTickers:"fetchTickersV3",fetchAccounts:"fetchAccountsV3",fetchBalance:"v2PrivateGetAccounts",fetchTime:"v2PublicGetTime",user_native_currency:"USD"},features:{default:{sandbox:!1,createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:void 0,triggerDirection:!0,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!0},hedged:!1,trailing:!1,leverage:!0,marketBuyByCost:!0,marketBuyRequiresPrice:!0,selfTradePrevention:!1,iceberg:!1},createOrders:void 0,fetchMyTrades:{marginMode:!1,limit:3e3,daysBack:void 0,untilDays:1e4,symbolRequired:!1},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!1},fetchOpenOrders:{marginMode:!1,limit:void 0,trigger:!1,trailing:!1,symbolRequired:!1},fetchOrders:{marginMode:!1,limit:void 0,daysBack:void 0,untilDays:1e4,trigger:!1,trailing:!1,symbolRequired:!1},fetchClosedOrders:{marginMode:!1,limit:void 0,daysBack:void 0,daysBackCanceled:void 0,untilDays:1e4,trigger:!1,trailing:!1,symbolRequired:!1},fetchOHLCV:{limit:300}},spot:{extends:"default"},swap:{linear:{extends:"default"},inverse:void 0},future:{linear:{extends:"default"},inverse:void 0}}})}async fetchTime(t={}){const e=this.safeString(this.options,"fetchTime","v2PublicGetTime"),i=this.safeString(t,"method",e);let s;return t=this.omit(t,"method"),"v2PublicGetTime"===i?(s=await this.v2PublicGetTime(t),s=this.safeDict(s,"data",{})):s=await this.v3PublicGetBrokerageTime(t),this.safeTimestamp2(s,"epoch","epochSeconds")}async fetchAccounts(t={}){return"fetchAccountsV3"===this.safeString(this.options,"fetchAccounts","fetchAccountsV3")?await this.fetchAccountsV3(t):await this.fetchAccountsV2(t)}async fetchAccountsV2(t={}){await this.loadMarkets();let e=!1;if([e,t]=this.handleOptionAndParams(t,"fetchAccounts","paginate"),e)return await this.fetchPaginatedCallCursor("fetchAccounts",void 0,void 0,void 0,t,"next_starting_after","starting_after",void 0,100);const i=await this.v2PrivateGetAccounts(this.extend({limit:100},t)),s=this.safeList(i,"data",[]),r=this.safeDict(i,"pagination",{}),a=this.safeString(r,"next_starting_after"),n=this.safeList(i,"data",[]),o=n.length-1,d=this.safeDict(n,o);return void 0!==a&&""!==a&&(d.next_starting_after=a,n[o]=d),this.parseAccounts(s,t)}async fetchAccountsV3(t={}){await this.loadMarkets();let e=!1;if([e,t]=this.handleOptionAndParams(t,"fetchAccounts","paginate"),e)return await this.fetchPaginatedCallCursor("fetchAccounts",void 0,void 0,void 0,t,"cursor","cursor",void 0,250);const i=await this.v3PrivateGetBrokerageAccounts(this.extend({limit:250},t)),s=this.safeList(i,"accounts",[]),r=s.length-1,a=this.safeDict(s,r),n=this.safeString(i,"cursor");return void 0!==n&&""!==n&&(a.cursor=n,s[r]=a),this.parseAccounts(s,t)}async fetchPortfolios(t={}){const e=await this.v3PrivateGetBrokeragePortfolios(t),i=this.safeList(e,"portfolios",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t];s.push({id:this.safeString(e,"uuid"),type:this.safeString(e,"type"),code:void 0,info:e})}return s}parseAccount(t){const e=this.safeBool(t,"active"),i=this.safeString(t,"currency"),s=this.safeDict(t,"currency",{}),r=this.safeString(s,"code",i),a=this.safeString(t,"name"),n=this.safeString(t,"type"),o=a.split(" ");return{id:this.safeString2(t,"id","uuid"),type:void 0!==e?this.safeStringLower(o,1):n,code:this.safeCurrencyCode(r),info:t}}async createDepositAddress(t,e={}){let i=this.safeString(e,"account_id");if(e=this.omit(e,"account_id"),void 0===i){await this.loadAccounts();for(let e=0;e<this.accounts.length;e++){const s=this.accounts[e];if(s.code===t&&"wallet"===s.type){i=s.id;break}}}if(void 0===i)throw new r.ExchangeError(this.id+" createDepositAddress() could not find the account with matching currency code "+t+", specify an `account_id` extra param to target specific wallet");const s={account_id:i},a=await this.v2PrivatePostAccountsAccountIdAddresses(this.extend(s,e)),n=this.safeDict(a,"data",{});return{currency:t,tag:this.safeString(n,"destination_tag"),address:this.safeString(n,"address"),network:void 0,info:a}}async fetchMySells(t=void 0,e=void 0,i=void 0,s={}){const r=this.prepareAccountRequest(i,s);await this.loadMarkets();const a=this.omit(s,["account_id","accountId"]),n=await this.v2PrivateGetAccountsAccountIdSells(this.extend(r,a));return this.parseTrades(n.data,void 0,e,i)}async fetchMyBuys(t=void 0,e=void 0,i=void 0,s={}){const r=this.prepareAccountRequest(i,s);await this.loadMarkets();const a=this.omit(s,["account_id","accountId"]),n=await this.v2PrivateGetAccountsAccountIdBuys(this.extend(r,a));return this.parseTrades(n.data,void 0,e,i)}async fetchTransactionsWithMethod(t,e=void 0,i=void 0,s=void 0,r={}){let a;[a,r]=await this.prepareAccountRequestWithCurrencyCode(e,s,r),await this.loadMarkets();const n=await this[t](this.extend(a,r));return this.parseTransactions(n.data,void 0,i,s)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){let r;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","currencyType"),"crypto"===r){const r=await this.fetchTransactionsWithMethod("v2PrivateGetAccountsAccountIdTransactions",t,e,i,s);return this.filterByArray(r,"type","withdrawal",!1)}return await this.fetchTransactionsWithMethod("v2PrivateGetAccountsAccountIdWithdrawals",t,e,i,s)}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){let r;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","currencyType"),"crypto"===r){const r=await this.fetchTransactionsWithMethod("v2PrivateGetAccountsAccountIdTransactions",t,e,i,s);return this.filterByArray(r,"type","deposit",!1)}return await this.fetchTransactionsWithMethod("v2PrivateGetAccountsAccountIdDeposits",t,e,i,s)}async fetchDepositsWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.fetchTransactionsWithMethod("v2PrivateGetAccountsAccountIdTransactions",t,e,i,s);return this.filterByArray(r,"type",["deposit","withdrawal"],!1)}parseTransactionStatus(t){return this.safeString({created:"pending",completed:"ok",canceled:"canceled"},t,t)}parseTransaction(t,e=void 0){const i=this.safeString(t,"type");let s,r;const n=this.safeDict(t,"network",{});"send"===i?(s=this.safeDict(n,"transaction_amount"),r=this.safeDict(n,"transaction_fee",{})):(s=this.safeDict(t,"subtotal"),r=this.safeDict(t,"fee",{})),void 0===s&&(s=this.safeDict(t,"amount"));const o=this.safeString(s,"amount"),d=a.Y.stringAbs(o);let c=this.parseTransactionStatus(this.safeString(t,"status"));if(void 0===c){c=this.safeBool(t,"committed")?"ok":"pending"}const h=this.safeString(t,"id"),l=this.safeString(s,"currency"),u=this.safeString(r,"currency"),p=this.safeString(t,"created_at");let f=this.safeString(t,"resource");this.inArray(f,["deposit","withdrawal"])||(a.Y.stringGt(o,"0")?f="deposit":a.Y.stringLt(o,"0")&&(f="withdrawal"));const m=this.safeDict(t,"to"),g=this.safeString(m,"address"),y=this.safeString(n,"network_name");return{info:t,id:h,txid:this.safeString(n,"hash",h),timestamp:this.parse8601(p),datetime:p,network:this.networkIdToCode(y),address:g,addressTo:g,addressFrom:void 0,tag:void 0,tagTo:void 0,tagFrom:void 0,type:f,amount:this.parseNumber(d),currency:this.safeCurrencyCode(l,e),status:c,updated:this.parse8601(this.safeString(t,"updated_at")),fee:{cost:this.safeNumber(r,"amount"),currency:this.safeCurrencyCode(u)}}}parseTrade(t,e=void 0){let i;const s=this.safeDict(t,"total",{}),r=this.safeDict(t,"amount",{}),n=this.safeDict(t,"subtotal",{}),o=this.safeDict(t,"fee",{}),d=this.safeString(t,"product_id");if(void 0!==(e=this.safeMarket(d,e,"-")))i=e.symbol;else{const t=this.safeString(r,"currency"),e=this.safeString(s,"currency");if(void 0!==t&&void 0!==e){i=this.safeCurrencyCode(t)+"/"+this.safeCurrencyCode(e)}}const c=this.safeBool(t,"size_in_quote"),h=this.safeString(t,"price");let l,u=this.safeString(t,"size");c&&(l=u,u=a.Y.stringDiv(u,h));const p=this.safeString(t,"commission"),f=this.safeString(r,"amount",u),m=this.safeString(n,"amount",l);let g,y;g=void 0!==m&&void 0!==f?a.Y.stringDiv(m,f):h,y=void 0!==g&&void 0!==f?a.Y.stringMul(g,f):m;let v=this.safeString(o,"currency");const b=this.safeNumber(o,"amount",this.parseNumber(p));void 0===v&&void 0!==e&&void 0!==b&&(v=e.quote);const w=this.safeStringN(t,["created_at","trade_time","time"]),S=this.safeStringLower2(t,"resource","side"),k=this.safeStringLower(t,"liquidity_indicator");return this.safeTrade({info:t,id:this.safeString2(t,"id","trade_id"),order:this.safeString(t,"order_id"),timestamp:this.parse8601(w),datetime:w,symbol:i,type:void 0,side:"unknown_order_side"===S?void 0:S,takerOrMaker:"unknown_liquidity_indicator"===k?void 0:k,price:g,amount:f,cost:y,fee:{cost:b,currency:this.safeCurrencyCode(v)}})}async fetchMarkets(t={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference();return"fetchMarketsV3"===this.safeString(this.options,"fetchMarkets","fetchMarketsV3")?await this.fetchMarketsV3(t):await this.fetchMarketsV2(t)}async fetchMarketsV2(t={}){const e=await this.fetchCurrenciesFromCache(t),i=this.safeDict(e,"currencies",{}),s=this.safeDict(e,"exchangeRates",{}),r=this.safeList(i,"data",[]),a=this.indexBy(r,"id"),n=this.safeDict(this.safeDict(s,"data",{}),"rates",{}),o=Object.keys(n),d=[];for(let t=0;t<o.length;t++){const e=o[t],i=this.safeCurrencyCode(e);if("crypto"===(e in a?"fiat":"crypto"))for(let t=0;t<r.length;t++){const s=r[t],a=this.safeString(s,"id"),n=this.safeCurrencyCode(a);d.push(this.safeMarketStructure({id:e+"-"+a,symbol:i+"/"+n,base:i,quote:n,settle:void 0,baseId:e,quoteId:a,settleId:void 0,type:"spot",spot:!0,margin:!1,swap:!1,future:!1,option:!1,active:void 0,contract:!1,linear:void 0,inverse:void 0,contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:void 0,price:void 0},limits:{leverage:{min:void 0,max:void 0},amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(s,"min_size"),max:void 0}},info:s}))}}return d}async fetchMarketsV3(t={}){let e=!1;[e,t]=this.handleOptionAndParams(t,"fetchMarkets","usePrivate",!1);const i=[];e?i.push(this.v3PrivateGetBrokerageProducts(t)):i.push(this.v3PublicGetBrokerageMarketProducts(t)),this.checkRequiredCredentials(!1)&&i.push(this.v3PrivateGetBrokerageTransactionSummary(t));let s=[];try{s=[this.v3PublicGetBrokerageMarketProducts(this.extend(t,{product_type:"FUTURE"})),this.v3PublicGetBrokerageMarketProducts(this.extend(t,{product_type:"FUTURE",contract_expiry_type:"PERPETUAL"}))]}catch(t){s=[]}const r=await Promise.all(i);let a;try{a=await Promise.all(s)}catch(t){a=[]}const n=this.safeDict(r,0,{}),o=this.safeDict(r,1,{}),d=this.safeDict(a,0,{}),c=this.safeDict(a,1,{}),h=this.safeDict(a,0,{}),l=this.safeDict(a,1,{}),u=this.safeDict(o,"fee_tier",{}),p=this.safeDict(h,"fee_tier",{}),f=this.safeDict(l,"fee_tier",{}),m=this.safeList(n,"products",[]),g=[];for(let t=0;t<m.length;t++)g.push(this.parseSpotMarket(m[t],u));const y=this.safeList(d,"products",[]);for(let t=0;t<y.length;t++)g.push(this.parseContractMarket(y[t],p));const v=this.safeList(c,"products",[]);for(let t=0;t<v.length;t++)g.push(this.parseContractMarket(v[t],f));const b=[];for(let t=0;t<g.length;t++){const e=g[t],i=this.safeValue(e,"info",{}),s=this.safeList(i,"alias_to",[]),r=s.length;e.alias=r>0?s[0]:void 0,b.push(e)}return b}parseSpotMarket(t,e){const i=this.safeString(t,"product_id"),s=this.safeString(t,"base_currency_id"),r=this.safeString(t,"quote_currency_id"),a=this.safeCurrencyCode(s),n=this.safeCurrencyCode(r),o=this.safeStringLower(t,"product_type"),d=this.safeBool(t,"trading_disabled"),c=this.safeList(this.options,"stablePairs",[]),h=this.safeNumber(this.fees.trading,"taker"),l=this.safeNumber(this.fees.trading,"maker"),u=this.inArray(i,c)?1e-5:this.safeNumber(e,"taker_fee_rate",h),p=this.inArray(i,c)?0:this.safeNumber(e,"maker_fee_rate",l);return this.safeMarketStructure({id:i,symbol:a+"/"+n,base:a,quote:n,settle:void 0,baseId:s,quoteId:r,settleId:void 0,type:o,spot:"spot"===o,margin:void 0,swap:!1,future:!1,option:!1,active:!d,contract:!1,linear:void 0,inverse:void 0,taker:u,maker:p,contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(t,"base_increment"),price:this.safeNumber2(t,"price_increment","quote_increment")},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(t,"base_min_size"),max:this.safeNumber(t,"base_max_size")},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"quote_min_size"),max:this.safeNumber(t,"quote_max_size")}},created:void 0,info:t})}parseContractMarket(t,e){const i=this.safeString(t,"product_id"),s=this.safeDict(t,"future_product_details",{}),r=this.safeString(s,"contract_expiry_type"),a=this.safeNumber(s,"contract_size"),n=this.safeString(s,"contract_expiry"),o=this.parse8601(n),d=this.iso8601(o),c="PERPETUAL"===r,h=this.safeString(s,"contract_root_unit"),l=this.safeString(t,"quote_currency_id"),u=this.safeCurrencyCode(h),p=this.safeCurrencyCode(l),f=this.safeBool(t,"is_disabled");let m,g=u+"/"+p;c?(m="swap",g=g+":"+p):(m="future",g=g+":"+p+"-"+this.yymmdd(o));const y=this.safeNumber(e,"taker_fee_rate"),v=this.safeNumber(e,"maker_fee_rate"),b=y||this.parseNumber("0.06"),w=v||this.parseNumber("0.04");return this.safeMarketStructure({id:i,symbol:g,base:u,quote:p,settle:p,baseId:h,quoteId:l,settleId:l,type:m,spot:!1,margin:!1,swap:c,future:!c,option:!1,active:!f,contract:!0,linear:!0,inverse:!1,taker:b,maker:w,contractSize:a,expiry:o,expiryDatetime:d,strike:void 0,optionType:void 0,precision:{amount:this.safeNumber(t,"base_increment"),price:this.safeNumber2(t,"price_increment","quote_increment")},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(t,"base_min_size"),max:this.safeNumber(t,"base_max_size")},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(t,"quote_min_size"),max:this.safeNumber(t,"quote_max_size")}},created:void 0,info:t})}async fetchCurrenciesFromCache(t={}){const e=this.safeDict(this.options,"fetchCurrencies",{}),i=this.safeInteger(e,"timestamp"),s=this.safeInteger(e,"expires",1e3),r=this.milliseconds();if(void 0===i||r-i>s){const i=[this.v2PublicGetCurrencies(t),this.v2PublicGetCurrenciesCrypto(t)],s=await Promise.all(i),a=this.safeDict(s,0,{}),n=this.safeDict(s,1,{}),o=this.safeList(a,"data",[]),d=this.safeList(n,"data",[]),c=await this.v2PublicGetExchangeRates(t);this.options.fetchCurrencies=this.extend(e,{currencies:this.arrayConcat(o,d),exchangeRates:c,timestamp:r})}return this.safeDict(this.options,"fetchCurrencies",{})}async fetchCurrencies(t={}){const e=[this.v2PublicGetCurrencies(t),this.v2PublicGetCurrenciesCrypto(t),this.v2PublicGetExchangeRates(t)],i=await Promise.all(e),s=this.safeDict(i,0,{}),r=this.safeDict(i,1,{}),a=this.safeDict(i,2,{}),n=this.safeList(s,"data",[]),o=this.safeList(r,"data",[]),d=this.safeDict(a,"data",{}),c=this.safeDict(d,"rates",{}),h=Object.keys(c),l=this.arrayConcat(n,o),u={},p={},f={};for(let t=0;t<l.length;t++){const e=l[t],i=this.safeString(e,"asset_id"),s=this.safeString2(e,"id","code"),r=this.safeCurrencyCode(s),a=this.safeString(e,"name");this.options.networks[r]=a.toLowerCase(),this.options.networksById[r]=a.toLowerCase();const n=void 0!==i?"crypto":"fiat";if(u[r]=this.safeCurrencyStructure({info:e,id:s,code:r,type:n,name:a,active:!0,deposit:void 0,withdraw:void 0,fee:void 0,precision:void 0,networks:{},limits:{amount:{min:this.safeNumber(e,"min_size"),max:void 0},withdraw:{min:void 0,max:void 0}}}),void 0!==i){const t=a.toLowerCase();p[r]=t,f[t]=r}}for(let t=0;t<h.length;t++){const e=h[t],i=this.safeCurrencyCode(e);i in u||(u[i]=this.safeCurrencyStructure({info:{},id:e,code:i,type:"crypto",networks:{}}))}return this.options.networks=this.extend(p,this.options.networks),this.options.networksById=this.extend(f,this.options.networksById),u}async fetchTickers(t=void 0,e={}){return"fetchTickersV3"===this.safeString(this.options,"fetchTickers","fetchTickersV3")?await this.fetchTickersV3(t,e):await this.fetchTickersV2(t,e)}async fetchTickersV2(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=await this.v2PublicGetExchangeRates(this.extend({},e)),s=this.safeDict(i,"data",{}),r=this.safeDict(s,"rates",{}),a=this.safeString(s,"currency"),n={},o=Object.keys(r);for(let t=0;t<o.length;t++){const e=o[t],i=e+"-"+a,s=this.safeMarket(i,void 0,"-");n[s.symbol]=this.parseTicker(r[e],s)}return this.filterByArrayTickers(n,"symbol",t)}async fetchTickersV3(t=void 0,e={}){await this.loadMarkets();const i={};let s,r;void 0!==(t=this.marketSymbols(t))&&(i.product_ids=this.marketIds(t)),[s,e]=this.handleMarketTypeAndParams("fetchTickers",this.getMarketFromSymbols(t),e,"default"),void 0!==s&&"default"!==s&&(i.product_type="swap"===s?"FUTURE":"SPOT");let a=!1;[a,e]=this.handleOptionAndParams(e,"fetchTickers","usePrivate",!1),r=a?await this.v3PrivateGetBrokerageProducts(this.extend(i,e)):await this.v3PublicGetBrokerageMarketProducts(this.extend(i,e));const n=this.safeList(r,"products",[]),o={};for(let t=0;t<n.length;t++){const e=n[t],i=this.safeString(e,"product_id"),s=this.safeMarket(i,void 0,"-");o[s.symbol]=this.parseTicker(e,s)}return this.filterByArrayTickers(o,"symbol",t)}async fetchTicker(t,e={}){return"fetchTickerV3"===this.safeString(this.options,"fetchTicker","fetchTickerV3")?await this.fetchTickerV3(t,e):await this.fetchTickerV2(t,e)}async fetchTickerV2(t,e={}){await this.loadMarkets();const i=this.market(t),s=this.extend({symbol:i.id},e),r=await this.v2PublicGetPricesSymbolSpot(s),a=await this.v2PublicGetPricesSymbolBuy(s),n=await this.v2PublicGetPricesSymbolSell(s),o=this.safeDict(r,"data",{}),d=this.safeDict(a,"data",{}),c=this.safeDict(n,"data",{}),h={bid:this.safeNumber(c,"amount"),ask:this.safeNumber(d,"amount"),price:this.safeNumber(o,"amount")};return this.parseTicker(h,i)}async fetchTickerV3(t,e={}){await this.loadMarkets();const i=this.market(t),s={product_id:i.id,limit:1};let r,a=!1;[a,e]=this.handleOptionAndParams(e,"fetchTicker","usePrivate",!1),r=a?await this.v3PrivateGetBrokerageProductsProductIdTicker(this.extend(s,e)):await this.v3PublicGetBrokerageMarketProductsProductIdTicker(this.extend(s,e));const n=this.safeList(r,"trades",[]),o=this.parseTicker(n[0],i);return o.bid=this.safeNumber(r,"best_bid"),o.ask=this.safeNumber(r,"best_ask"),o}parseTicker(t,e=void 0){let i,s,r=this.safeNumber(t,"bid"),a=this.safeNumber(t,"ask");if("bids"in t){const e=this.safeList(t,"bids",[]),n=this.safeList(t,"asks",[]),o=this.safeDict(e,0,{}),d=this.safeDict(n,0,{});r=this.safeNumber(o,"price"),i=this.safeNumber(o,"size"),a=this.safeNumber(d,"price"),s=this.safeNumber(d,"size")}const n=this.safeString(t,"product_id");e=this.safeMarket(n,e);const o=this.safeNumber(t,"price"),d=this.safeString(t,"time");return this.safeTicker({symbol:e.symbol,timestamp:this.parse8601(d),datetime:d,bid:r,ask:a,last:o,high:void 0,low:void 0,bidVolume:i,askVolume:s,vwap:void 0,open:void 0,close:o,previousClose:void 0,change:void 0,percentage:this.safeNumber(t,"price_percentage_change_24h"),average:void 0,baseVolume:this.safeNumber(t,"volume_24h"),quoteVolume:this.safeNumber(t,"approximate_quote_24h_volume"),info:t},e)}parseCustomBalance(t,e={}){const i=this.safeList2(t,"data","accounts",[]),s=this.safeList(e,"type",this.options.accounts),r=this.safeList(e,"type",this.options.v3Accounts),n={info:t};for(let t=0;t<i.length;t++){const e=i[t],o=this.safeString(e,"type");if(this.inArray(o,s)){const t=this.safeDict(e,"balance");if(void 0!==t){const e=this.safeString(t,"currency"),i=this.safeCurrencyCode(e),s=this.safeString(t,"amount"),r=s;let o=this.safeDict(n,i);void 0===o?(o=this.account(),o.free=r,o.total=s):(o.free=a.Y.stringAdd(o.free,s),o.total=a.Y.stringAdd(o.total,s)),n[i]=o}}else if(this.inArray(o,r)){const t=this.safeDict(e,"available_balance"),i=this.safeDict(e,"hold");if(void 0!==t&&void 0!==i){const e=this.safeString(t,"currency"),s=this.safeCurrencyCode(e),r=this.safeString(i,"value"),o=this.safeString(t,"value"),d=a.Y.stringAdd(r,o);let c=this.safeDict(n,s);void 0===c?(c=this.account(),c.free=o,c.used=r,c.total=d):(c.free=a.Y.stringAdd(c.free,o),c.used=a.Y.stringAdd(c.used,r),c.total=a.Y.stringAdd(c.total,d)),n[s]=c}}}return this.safeBalance(n)}async fetchBalance(t={}){await this.loadMarkets();const e={};let i;const s=this.safeBool(t,"v3",!1);let r;t=this.omit(t,["v3"]),[r,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t);const a=this.safeString(this.options,"fetchBalance","v3PrivateGetBrokerageAccounts");return"future"===r?i=await this.v3PrivateGetBrokerageCfmBalanceSummary(this.extend(e,t)):s||"v3PrivateGetBrokerageAccounts"===a?(e.limit=250,i=await this.v3PrivateGetBrokerageAccounts(this.extend(e,t))):(e.limit=250,i=await this.v2PrivateGetAccounts(this.extend(e,t))),t.type=r,this.parseCustomBalance(i,t)}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n=!1;if([n,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),n)return await this.fetchPaginatedCallCursor("fetchLedger",t,e,i,s,"next_starting_after","starting_after",void 0,100);void 0!==t&&(r=this.currency(t)),[a,s]=await this.prepareAccountRequestWithCurrencyCode(t,i,s);const o=await this.v2PrivateGetAccountsAccountIdTransactions(this.extend(a,s)),d=this.parseLedger(o.data,r,e,i),c=d.length;if(0===c)return d;const h=c-1,l=this.safeDict(d,h),u=this.safeDict(o,"pagination",{}),p=this.safeString(u,"next_starting_after");return void 0!==p&&""!==p&&(l.info.next_starting_after=p,d[h]=l),d}parseLedgerEntryStatus(t){return this.safeString({completed:"ok"},t,t)}parseLedgerEntryType(t){return this.safeString({buy:"trade",sell:"trade",fiat_deposit:"transaction",fiat_withdrawal:"transaction",exchange_deposit:"transaction",exchange_withdrawal:"transaction",send:"transaction",pro_deposit:"transaction",pro_withdrawal:"transaction"},t,t)}parseLedgerEntry(t,e=void 0){const i=this.safeDict(t,"amount",{});let s,r=this.safeString(i,"amount");a.Y.stringLt(r,"0")?(s="out",r=a.Y.stringNeg(r)):s="in";const n=this.safeString(i,"currency"),o=this.safeCurrencyCode(n,e);let d;e=this.safeCurrency(n,e);const c=this.safeDict(t,"network",{}),h=this.safeDict(c,"transaction_fee");if(void 0!==h){const t=this.safeString(h,"currency"),i=this.safeCurrencyCode(t,e);d={cost:this.safeNumber(h,"amount"),currency:i}}const l=this.parse8601(this.safeString(t,"created_at")),u=this.safeString(t,"id"),p=this.parseLedgerEntryType(this.safeString(t,"type")),f=this.parseLedgerEntryStatus(this.safeString(t,"status")),m=this.safeString(t,"resource_path");let g;if(void 0!==m){const t=m.split("/");t.length>3&&(g=t[3])}return this.safeLedgerEntry({info:t,id:u,timestamp:l,datetime:this.iso8601(l),direction:s,account:g,referenceId:void 0,referenceAccount:void 0,type:p,currency:o,amount:this.parseNumber(r),before:void 0,after:void 0,status:f,fee:d},e)}async findAccountId(t,e={}){await this.loadMarkets(),await this.loadAccounts(!1,e);for(let e=0;e<this.accounts.length;e++){const i=this.accounts[e];if(i.code===t)return i.id}}prepareAccountRequest(t=void 0,e={}){const i=this.safeString2(e,"account_id","accountId");if(void 0===i)throw new r.ArgumentsRequired(this.id+" prepareAccountRequest() method requires an account_id (or accountId) parameter");const s={account_id:i};return void 0!==t&&(s.limit=t),s}async prepareAccountRequestWithCurrencyCode(t=void 0,e=void 0,i={}){let s=this.safeString2(i,"account_id","accountId");if(i=this.omit(i,["account_id","accountId"]),void 0===s){if(void 0===t)throw new r.ArgumentsRequired(this.id+" prepareAccountRequestWithCurrencyCode() method requires an account_id (or accountId) parameter OR a currency code argument");if(s=await this.findAccountId(t,i),void 0===s)throw new r.ExchangeError(this.id+" prepareAccountRequestWithCurrencyCode() could not find account id for "+t+". You might try to generate the deposit address in the website for that coin first.")}const a={account_id:s};return void 0!==e&&(a.limit=e),[a,i]}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");return i.createMarketBuyOrderRequiresPrice=!1,await this.createOrder(t,"market","buy",e,void 0,i)}async createOrder(t,e,i,s,n=void 0,o={}){await this.loadMarkets();const d=this.market(t);let c={client_order_id:this.safeString(this.options,"brokerId","ccxt")+"-"+this.uuid(),product_id:d.id,side:i.toUpperCase()};const h=this.safeNumberN(o,["stopPrice","stop_price","triggerPrice"]),l=this.safeNumber(o,"stopLossPrice"),u=this.safeNumber(o,"takeProfitPrice"),p=void 0!==h,f=void 0!==l,m=void 0!==u,g=this.safeString(o,"timeInForce"),y="PO"===g||this.safeBool2(o,"postOnly","post_only",!1),v=this.safeString(o,"end_time");let b=this.safeString(o,"stop_direction");if("limit"===e)if(p)if(void 0===b&&(b="buy"===i?"STOP_DIRECTION_STOP_DOWN":"STOP_DIRECTION_STOP_UP"),"GTD"===g||void 0!==v){if(void 0===v)throw new r.ExchangeError(this.id+" createOrder() requires an end_time parameter for a GTD order");c.order_configuration={stop_limit_stop_limit_gtd:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n),stop_price:this.priceToPrecision(t,h),stop_direction:b,end_time:v}}}else c.order_configuration={stop_limit_stop_limit_gtc:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n),stop_price:this.priceToPrecision(t,h),stop_direction:b}};else if(f||m){let e;f?(void 0===b&&(b="buy"===i?"STOP_DIRECTION_STOP_UP":"STOP_DIRECTION_STOP_DOWN"),e=this.priceToPrecision(t,l)):(void 0===b&&(b="buy"===i?"STOP_DIRECTION_STOP_DOWN":"STOP_DIRECTION_STOP_UP"),e=this.priceToPrecision(t,u)),c.order_configuration={stop_limit_stop_limit_gtc:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n),stop_price:e,stop_direction:b}}}else if("GTD"===g||void 0!==v){if(void 0===v)throw new r.ExchangeError(this.id+" createOrder() requires an end_time parameter for a GTD order");c.order_configuration={limit_limit_gtd:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n),end_time:v,post_only:y}}}else c.order_configuration="IOC"===g?{sor_limit_ioc:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n)}}:"FOK"===g?{limit_limit_fok:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n)}}:{limit_limit_gtc:{base_size:this.amountToPrecision(t,s),limit_price:this.priceToPrecision(t,n),post_only:y}};else{if(p||f||m)throw new r.NotSupported(this.id+" createOrder() only stop limit orders are supported");if(d.spot&&"buy"===i){let e,i=!0;[i,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0);const d=this.safeNumber(o,"cost");if(o=this.omit(o,"cost"),void 0!==d)e=this.costToPrecision(t,d);else if(i){if(void 0===n)throw new r.InvalidOrder(this.id+" createOrder() requires a price argument for market buy orders on spot markets to calculate the total amount to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend in the amount argument");{const i=this.numberToString(s),r=this.numberToString(n),o=a.Y.stringMul(i,r);e=this.costToPrecision(t,o)}}else e=this.costToPrecision(t,s);c.order_configuration={market_market_ioc:{quote_size:e}}}else c.order_configuration={market_market_ioc:{base_size:this.amountToPrecision(t,s)}}}const w=this.safeString(o,"marginMode");void 0!==w&&("isolated"===w?c.margin_type="ISOLATED":"cross"===w&&(c.margin_type="CROSS")),o=this.omit(o,["timeInForce","triggerPrice","stopLossPrice","takeProfitPrice","stopPrice","stop_price","stopDirection","stop_direction","clientOrderId","postOnly","post_only","end_time","marginMode"]);let S;this.safeBool2(o,"preview","test",!1)?(o=this.omit(o,["preview","test"]),c=this.omit(c,"client_order_id"),S=await this.v3PrivatePostBrokerageOrdersPreview(this.extend(c,o))):S=await this.v3PrivatePostBrokerageOrders(this.extend(c,o));if(!0!==this.safeBool(S,"success")){const t=this.safeDict(S,"error_response"),e=this.safeString(t,"error"),i=this.safeString(t,"message");if(void 0!==t)throw this.throwExactlyMatchedException(this.exceptions.exact,e,i),this.throwBroadlyMatchedException(this.exceptions.broad,e,i),new r.ExchangeError(i)}const k=this.safeDict(S,"success_response",{});return this.parseOrder(k,d)}parseOrder(t,e=void 0){const i=this.safeString(t,"product_id"),s=this.safeSymbol(i,e,"-");void 0!==s&&(e=this.safeMarket(s,e));const r=this.safeDict(t,"order_configuration",{}),a=this.safeDict(r,"limit_limit_gtc"),n=this.safeDict(r,"limit_limit_gtd"),o=this.safeDict(r,"sor_limit_ioc"),d=this.safeDict(r,"stop_limit_stop_limit_gtc"),c=this.safeDict(r,"stop_limit_stop_limit_gtd"),h=this.safeDict(r,"market_market_ioc"),l=void 0!==d||void 0!==c;let u,p,f,m;if(void 0!==a||void 0!==n||void 0!==o){let t;t=void 0!==a?a:void 0!==n?n:o,u=this.safeString(t,"limit_price"),p=this.safeString(t,"base_size"),f=this.safeBool(t,"post_only")}else if(l){const t=void 0!==d?d:c;u=this.safeString(t,"limit_price"),p=this.safeString(t,"base_size"),f=this.safeBool(t,"post_only"),m=this.safeString(t,"stop_price")}else p=this.safeString(h,"base_size");const g=this.safeString(t,"created_time");let y;return void 0!==this.safeString(t,"total_fees")&&void 0!==e&&(y=e.quote),this.safeOrder({info:t,id:this.safeString(t,"order_id"),clientOrderId:this.safeString(t,"client_order_id"),timestamp:this.parse8601(g),datetime:g,lastTradeTimestamp:void 0,symbol:s,type:this.parseOrderType(this.safeString(t,"order_type")),timeInForce:this.parseTimeInForce(this.safeString(t,"time_in_force")),postOnly:f,side:this.safeStringLower(t,"side"),price:u,triggerPrice:m,amount:p,filled:this.safeString(t,"filled_size"),remaining:void 0,cost:void 0,average:this.safeString(t,"average_filled_price"),status:this.parseOrderStatus(this.safeString(t,"status")),fee:{cost:this.safeString(t,"total_fees"),currency:y},trades:void 0},e)}parseOrderStatus(t){const e={OPEN:"open",FILLED:"closed",CANCELLED:"canceled",EXPIRED:"canceled",FAILED:"canceled",UNKNOWN_ORDER_STATUS:void 0};return this.safeString(e,t,t)}parseOrderType(t){if("UNKNOWN_ORDER_TYPE"===t)return;return this.safeString({MARKET:"market",LIMIT:"limit",STOP:"limit",STOP_LIMIT:"limit"},t,t)}parseTimeInForce(t){const e={GOOD_UNTIL_CANCELLED:"GTC",GOOD_UNTIL_DATE_TIME:"GTD",IMMEDIATE_OR_CANCEL:"IOC",FILL_OR_KILL:"FOK",UNKNOWN_TIME_IN_FORCE:void 0};return this.safeString(e,t,t)}async cancelOrder(t,e=void 0,i={}){await this.loadMarkets();const s=await this.cancelOrders([t],e,i);return this.safeDict(s,0,{})}async cancelOrders(t,e=void 0,i={}){let s;await this.loadMarkets(),void 0!==e&&(s=this.market(e));const a={order_ids:t},n=await this.v3PrivatePostBrokerageOrdersBatchCancel(this.extend(a,i)),o=this.safeList(n,"results",[]);for(let t=0;t<o.length;t++){if(!0!==this.safeBool(o[t],"success"))throw new r.BadRequest(this.id+" cancelOrders() has failed, check your arguments and parameters")}return this.parseOrders(o,s)}async editOrder(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.market(e),d={order_id:t};void 0!==r&&(d.size=this.amountToPrecision(e,r)),void 0!==a&&(d.price=this.priceToPrecision(e,a));let c;return this.safeBool2(n,"preview","test",!1)?(n=this.omit(n,["preview","test"]),c=await this.v3PrivatePostBrokerageOrdersEditPreview(this.extend(d,n))):c=await this.v3PrivatePostBrokerageOrdersEdit(this.extend(d,n)),this.parseOrder(c,o)}async fetchOrder(t,e=void 0,i={}){let s;await this.loadMarkets(),void 0!==e&&(s=this.market(e));const r={order_id:t},a=await this.v3PrivateGetBrokerageOrdersHistoricalOrderId(this.extend(r,i)),n=this.safeDict(a,"order",{});return this.parseOrder(n,s)}async fetchOrders(t=void 0,e=void 0,i=100,s={}){await this.loadMarkets();let r,a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchOrders","paginate"),a)return await this.fetchPaginatedCallCursor("fetchOrders",t,e,i,s,"cursor","cursor",void 0,1e3);void 0!==t&&(r=this.market(t));const n={};void 0!==r&&(n.product_id=r.id),void 0!==i&&(n.limit=i),void 0!==e&&(n.start_date=this.iso8601(e));const o=this.safeIntegerN(s,["until"]);void 0!==o&&(s=this.omit(s,["until"]),n.end_date=this.iso8601(o));const d=await this.v3PrivateGetBrokerageOrdersHistoricalBatch(this.extend(n,s)),c=this.safeList(d,"orders",[]),h=this.safeDict(c,0),l=this.safeString(d,"cursor");return void 0!==l&&""!==l&&(h.cursor=l,c[0]=h),this.parseOrders(c,r,e,i)}async fetchOrdersByStatus(t,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),void 0!==e&&(a=this.market(e));const n={order_status:t};void 0!==a&&(n.product_id=a.id),void 0===s&&(s=100),n.limit=s,void 0!==i&&(n.start_date=this.iso8601(i));const o=this.safeIntegerN(r,["until"]);void 0!==o&&(r=this.omit(r,["until"]),n.end_date=this.iso8601(o));const d=await this.v3PrivateGetBrokerageOrdersHistoricalBatch(this.extend(n,r)),c=this.safeList(d,"orders",[]),h=this.safeDict(c,0),l=this.safeString(d,"cursor");return void 0!==l&&""!==l&&(h.cursor=l,c[0]=h),this.parseOrders(c,a,i,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;return[r,s]=this.handleOptionAndParams(s,"fetchOpenOrders","paginate"),r?await this.fetchPaginatedCallCursor("fetchOpenOrders",t,e,i,s,"cursor","cursor",void 0,100):await this.fetchOrdersByStatus("OPEN",t,e,i,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;return[r,s]=this.handleOptionAndParams(s,"fetchClosedOrders","paginate"),r?await this.fetchPaginatedCallCursor("fetchClosedOrders",t,e,i,s,"cursor","cursor",void 0,100):await this.fetchOrdersByStatus("FILLED",t,e,i,s)}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByStatus("CANCELLED",t,e,i,s)}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();s=void 0===s?300:Math.min(s,300);let n=!1;if([n,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate",!1),n)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,299);const o=this.market(t),d={product_id:o.id,granularity:this.safeString(this.timeframes,e,e)},c=this.safeIntegerN(r,["until","end"]);r=this.omit(r,["until"]);const h=s*this.parseTimeframe(e);let l,u;if(void 0!==i)l=this.numberToString(this.parseToInt(i/1e3));else{const t=this.seconds().toString();l=a.Y.stringSub(t,h.toString())}d.start=l,d.end=void 0!==c?this.numberToString(this.parseToInt(c/1e3)):a.Y.stringAdd(l,h.toString());let p=!1;[p,r]=this.handleOptionAndParams(r,"fetchOHLCV","usePrivate",!1),u=p?await this.v3PrivateGetBrokerageProductsProductIdCandles(this.extend(d,r)):await this.v3PublicGetBrokerageMarketProductsProductIdCandles(this.extend(d,r));const f=this.safeList(u,"candles",[]);return this.parseOHLCVs(f,o,e,i,s)}parseOHLCV(t,e=void 0){return[this.safeTimestamp(t,"start"),this.safeNumber(t,"open"),this.safeNumber(t,"high"),this.safeNumber(t,"low"),this.safeNumber(t,"close"),this.safeNumber(t,"volume")]}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=this.market(t),n={product_id:a.id};let o,d;if(void 0!==e&&(n.start=this.numberToString(this.parseToInt(e/1e3))),void 0!==i&&(n.limit=Math.min(i,1e3)),[o,s]=this.handleOptionAndParams(s,"fetchTrades","until"),void 0!==o)n.end=this.numberToString(this.parseToInt(o/1e3));else if(void 0!==e)throw new r.ArgumentsRequired(this.id+" fetchTrades() requires a `until` parameter when you use `since` argument");let c=!1;[c,s]=this.handleOptionAndParams(s,"fetchTrades","usePrivate",!1),d=c?await this.v3PrivateGetBrokerageProductsProductIdTicker(this.extend(n,s)):await this.v3PublicGetBrokerageMarketProductsProductIdTicker(this.extend(n,s));const h=this.safeList(d,"trades",[]);return this.parseTrades(h,a,e,i)}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),a)return await this.fetchPaginatedCallCursor("fetchMyTrades",t,e,i,s,"cursor","cursor",void 0,250);void 0!==t&&(r=this.market(t));const n={};void 0!==r&&(n.product_id=r.id),void 0!==i&&(n.limit=i),void 0!==e&&(n.start_sequence_timestamp=this.iso8601(e));const o=this.safeIntegerN(s,["until"]);void 0!==o&&(s=this.omit(s,["until"]),n.end_sequence_timestamp=this.iso8601(o));const d=await this.v3PrivateGetBrokerageOrdersHistoricalFills(this.extend(n,s)),c=this.safeList(d,"fills",[]),h=this.safeDict(c,0),l=this.safeString(d,"cursor");return void 0!==l&&""!==l&&(h.cursor=l,c[0]=h),this.parseTrades(c,r,e,i)}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s={product_id:this.market(t).id};let r;void 0!==e&&(s.limit=e);let a=!1;[a,i]=this.handleOptionAndParams(i,"fetchOrderBook","usePrivate",!1),r=a?await this.v3PrivateGetBrokerageProductBook(this.extend(s,i)):await this.v3PublicGetBrokerageMarketProductBook(this.extend(s,i));const n=this.safeDict(r,"pricebook",{}),o=this.safeString(n,"time"),d=this.parse8601(o);return this.parseOrderBook(n,t,d,"bids","asks","price","size")}async fetchBidsAsks(t=void 0,e={}){await this.loadMarkets();const i={};void 0!==(t=this.marketSymbols(t))&&(i.product_ids=this.marketIds(t));const s=await this.v3PrivateGetBrokerageBestBidAsk(this.extend(i,e)),r=this.safeList(s,"pricebooks",[]);return this.parseTickers(r,t)}async withdraw(t,e,i,s=void 0,a={}){[s,a]=this.handleWithdrawTagAndParams(s,a),this.checkAddress(i),await this.loadMarkets();const n=this.currency(t);let o=this.safeString2(a,"account_id","accountId");if(a=this.omit(a,["account_id","accountId"]),void 0===o){if(void 0===t)throw new r.ArgumentsRequired(this.id+" withdraw() requires an account_id (or accountId) parameter OR a currency code argument");if(o=await this.findAccountId(t,a),void 0===o)throw new r.ExchangeError(this.id+" withdraw() could not find account id for "+t)}const d={account_id:o,type:"send",to:i,amount:e,currency:n.id};void 0!==s&&(d.destination_tag=s);const c=await this.v2PrivatePostAccountsAccountIdTransactions(this.extend(d,a)),h=this.safeDict(c,"data",{});return this.parseTransaction(h,n)}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();const i=this.currency(t);let s;[s,e]=await this.prepareAccountRequestWithCurrencyCode(i.code,void 0,e);const r=await this.v2PrivateGetAccountsAccountIdAddresses(this.extend(s,e)),a=this.safeList(r,"data",[]),n=this.parseDepositAddresses(a,void 0,!1);return this.indexBy(n,"network")}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"address");this.checkAddress(i);const s=this.safeString(t,"network"),r=this.safeCurrencyCode(void 0,e),a=this.safeString(t,"address_label");let n;if(void 0!==a){const t=a.split(" ");n=this.safeString(t,0)}else n=this.safeString(t,"currency");const o=this.safeDict(t,"address_info");return{info:t,currency:this.safeCurrencyCode(n,e),network:this.networkIdToCode(s,r),address:i,tag:this.safeString(o,"destination_tag")}}async deposit(t,e,i,s={}){await this.loadMarkets();let a=this.safeString2(s,"account_id","accountId");if(s=this.omit(s,["account_id","accountId"]),void 0===a){if(void 0===t)throw new r.ArgumentsRequired(this.id+" deposit() requires an account_id (or accountId) parameter OR a currency code argument");if(a=await this.findAccountId(t,s),void 0===a)throw new r.ExchangeError(this.id+" deposit() could not find account id for "+t)}const n={account_id:a,amount:this.numberToString(e),currency:t.toUpperCase(),payment_method:i,commit:!0},o=await this.v2PrivatePostAccountsAccountIdDeposits(this.extend(n,s)),d=this.safeDict2(o,"data","transfer",{});return this.parseTransaction(d)}async fetchDeposit(t,e=void 0,i={}){await this.loadMarkets();let s=this.safeString2(i,"account_id","accountId");if(i=this.omit(i,["account_id","accountId"]),void 0===s){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchDeposit() requires an account_id (or accountId) parameter OR a currency code argument");if(s=await this.findAccountId(e,i),void 0===s)throw new r.ExchangeError(this.id+" fetchDeposit() could not find account id for "+e)}const a={account_id:s,deposit_id:t},n=await this.v2PrivateGetAccountsAccountIdDepositsDepositId(this.extend(a,i)),o=this.safeDict2(n,"data","transfer",{});return this.parseTransaction(o)}async fetchDepositMethodIds(t={}){await this.loadMarkets();const e=await this.v3PrivateGetBrokeragePaymentMethods(t),i=this.safeList(e,"payment_methods",[]);return this.parseDepositMethodIds(i)}async fetchDepositMethodId(t,e={}){await this.loadMarkets();const i={payment_method_id:t},s=await this.v3PrivateGetBrokeragePaymentMethodsPaymentMethodId(this.extend(i,e)),r=this.safeDict(s,"payment_method",{});return this.parseDepositMethodId(r)}parseDepositMethodIds(t,e={}){const i=[];for(let s=0;s<t.length;s++){const r=this.extend(this.parseDepositMethodId(t[s]),e);i.push(r)}return i}parseDepositMethodId(t){return{info:t,id:this.safeString(t,"id"),currency:this.safeString(t,"currency"),verified:this.safeBool(t,"verified"),tag:this.safeString(t,"name")}}async fetchConvertQuote(t,e,i=void 0,s={}){await this.loadMarkets();const r={from_account:t,to_account:e,amount:this.numberToString(i)},a=await this.v3PrivatePostBrokerageConvertQuote(this.extend(r,s)),n=this.safeDict(a,"trade",{});return this.parseConversion(n)}async createConvertTrade(t,e,i,s=void 0,r={}){await this.loadMarkets();const a={trade_id:t,from_account:e,to_account:i},n=await this.v3PrivatePostBrokerageConvertTradeTradeId(this.extend(a,r)),o=this.safeDict(n,"trade",{});return this.parseConversion(o)}async fetchConvertTrade(t,e=void 0,i={}){if(await this.loadMarkets(),void 0===e)throw new r.ArgumentsRequired(this.id+" fetchConvertTrade() requires a code argument");const s=this.safeString(i,"toCode");if(void 0===s)throw new r.ArgumentsRequired(this.id+" fetchConvertTrade() requires a toCode parameter");i=this.omit(i,"toCode");const a={trade_id:t,from_account:e,to_account:s},n=await this.v3PrivateGetBrokerageConvertTradeTradeId(this.extend(a,i)),o=this.safeDict(n,"trade",{});return this.parseConversion(o)}parseConversion(t,e=void 0,i=void 0){const s=this.safeString(t,"source_currency"),r=this.safeCurrencyCode(s,e),a=this.safeString(t,"target_currency"),n=this.safeCurrencyCode(a,i),o=this.safeDict(t,"user_entered_amount"),d=this.safeDict(t,"total_fee"),c=this.safeDict(d,"amount");return{info:t,timestamp:void 0,datetime:void 0,id:this.safeString(t,"id"),fromCurrency:r,fromAmount:this.safeNumber(o,"value"),toCurrency:n,toAmount:void 0,price:void 0,fee:this.safeNumber(c,"value")}}async closePosition(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),a=this.safeString2(i,"client_order_id","clientOrderId");i=this.omit(i,"clientOrderId");const n={product_id:s.id};if(void 0===a)throw new r.ArgumentsRequired(this.id+" closePosition() requires a clientOrderId parameter");n.client_order_id=a;const o=await this.v3PrivatePostBrokerageOrdersClosePosition(this.extend(n,i)),d=this.safeDict(o,"success_response",{});return this.parseOrder(d)}async fetchPositions(t=void 0,e={}){let i,s,a;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t))&&(i=this.market(t[0])),[s,e]=this.handleMarketTypeAndParams("fetchPositions",i,e),"future"===s)a=await this.v3PrivateGetBrokerageCfmPositions(e);else{let t;if([t,e]=this.handleOptionAndParams(e,"fetchPositions","portfolio"),void 0===t)throw new r.ArgumentsRequired(this.id+' fetchPositions() requires a "portfolio" value in params (eg: dbcb91e7-2bc9-515), or set as exchange.options["portfolio"]. You can get a list of portfolios with fetchPortfolios()');const i={portfolio_uuid:t};a=await this.v3PrivateGetBrokerageIntxPositionsPortfolioUuid(this.extend(i,e))}const n=this.safeList(a,"positions",[]);return this.parsePositions(n,t)}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t);let s;if(i.future){const t=this.safeString(i,"product_id");if(void 0===t)throw new r.ArgumentsRequired(this.id+' fetchPosition() requires a "product_id" in params');const a={product_id:t};s=await this.v3PrivateGetBrokerageCfmPositionsProductId(this.extend(a,e))}else{let t;if([t,e]=this.handleOptionAndParams(e,"fetchPositions","portfolio"),void 0===t)throw new r.ArgumentsRequired(this.id+' fetchPosition() requires a "portfolio" value in params (eg: dbcb91e7-2bc9-515), or set as exchange.options["portfolio"]. You can get a list of portfolios with fetchPortfolios()');const a={symbol:i.id,portfolio_uuid:t};s=await this.v3PrivateGetBrokerageIntxPositionsPortfolioUuidSymbol(this.extend(a,e))}const a=this.safeDict(s,"position",{});return this.parsePosition(a,i)}parsePosition(t,e=void 0){const i=this.safeString(t,"symbol","");e=this.safeMarket(i,e);const s=this.safeString(t,"margin_type");let r;void 0!==s&&(r="MARGIN_TYPE_CROSS"===s?"cross":"isolated");const a=this.safeDict(t,"position_notional",{}),n="POSITION_SIDE_LONG"===this.safeString(t,"position_side")?"long":"short",o=this.safeDict(t,"unrealized_pnl",{}),d=this.safeDict(t,"liquidation_price",{}),c=this.safeNumber(d,"value"),h=this.safeDict(t,"vwap",{}),l=this.safeDict(t,"portfolio_summary",{});return this.safePosition({info:t,id:this.safeString(t,"product_id"),symbol:this.safeSymbol(i,e),notional:this.safeNumber(a,"value"),marginMode:r,liquidationPrice:c,entryPrice:this.safeNumber(h,"value"),unrealizedPnl:this.safeNumber(o,"value"),realizedPnl:void 0,percentage:void 0,contracts:this.safeNumber(t,"net_size"),contractSize:e.contractSize,markPrice:void 0,lastPrice:void 0,side:n,hedged:void 0,timestamp:void 0,datetime:void 0,lastUpdateTimestamp:void 0,maintenanceMargin:void 0,maintenanceMarginPercentage:void 0,collateral:this.safeNumber(l,"collateral"),initialMargin:void 0,initialMarginPercentage:void 0,leverage:this.safeNumber(t,"leverage"),marginRatio:void 0,stopLossPrice:void 0,takeProfitPrice:void 0})}async fetchTradingFees(t={}){let e;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchTradingFees",void 0,t);const i="spot"===e,s={product_type:i?"SPOT":"FUTURE"},r=await this.v3PrivateGetBrokerageTransactionSummary(this.extend(s,t)),a=this.safeDict(r,"fee_tier",{}),n=this.safeNumber(a,"taker_fee_rate"),o=this.safeNumber(a,"maker_fee_rate"),d={};for(let t=0;t<this.symbols.length;t++){const e=this.symbols[t],s=this.market(e);(i&&s.spot||!i&&!s.spot)&&(d[e]={info:r,symbol:e,maker:n,taker:o,percentage:!0})}return d}async fetchPortfolioDetails(t,e={}){await this.loadMarkets();const i={portfolio_uuid:t},s=await this.v3PrivateGetBrokeragePortfoliosPortfolioUuid(this.extend(i,e));return this.parsePortfolioDetails(s)}parsePortfolioDetails(t){const e=t.breakdown,i=this.safeDict(e,"portfolio",{}),s=this.safeString(i,"name","Unknown"),r=this.safeString(i,"uuid",""),a=this.safeList(e,"spot_positions",[]),n=[];for(let t=0;t<a.length;t++){const e=a[t],i=this.safeString(e,"asset","Unknown"),o=this.safeString(e,"available_to_trade_fiat","0"),d=this.parseNumber(o),c=this.safeString(e,"total_balance_fiat","0"),h=this.parseNumber(c),l=h-d,u=this.safeDict(e,"cost_basis",{}),p=this.safeString(u,"value","0"),f=this.safeDict(e,"average_entry_price",{}),m=this.safeString(f,"value","0"),g={currency:i,available_balance:d,hold_amount:l>0?l:0,wallet_name:s,account_id:r,account_uuid:this.safeString(e,"account_uuid",""),total_balance_fiat:h,total_balance_crypto:this.parseNumber(this.safeString(e,"total_balance_crypto","0")),available_to_trade_fiat:this.parseNumber(this.safeString(e,"available_to_trade_fiat","0")),available_to_trade_crypto:this.parseNumber(this.safeString(e,"available_to_trade_crypto","0")),available_to_transfer_fiat:this.parseNumber(this.safeString(e,"available_to_transfer_fiat","0")),available_to_transfer_crypto:this.parseNumber(this.safeString(e,"available_to_trade_crypto","0")),allocation:this.parseNumber(this.safeString(e,"allocation","0")),cost_basis:this.parseNumber(p),cost_basis_currency:this.safeString(u,"currency","USD"),is_cash:this.safeBool(e,"is_cash",!1),average_entry_price:this.parseNumber(m),average_entry_price_currency:this.safeString(f,"currency","USD"),asset_uuid:this.safeString(e,"asset_uuid",""),unrealized_pnl:this.parseNumber(this.safeString(e,"unrealized_pnl","0")),asset_color:this.safeString(e,"asset_color",""),account_type:this.safeString(e,"account_type","")};n.push(g)}return n}createAuthToken(t,e=void 0,i=void 0,s=!1){let r;if(void 0!==i){r=e+" "+i.replace("https://","");const t=r.indexOf("?");t>0&&(r=r.slice(0,t))}const a=this.randomBytes(16),n={aud:[s?"cdp_service":"retail_rest_api_proxy"],iss:s?"cdp":"coinbase-cloud",nbf:t,exp:t+120,sub:this.apiKey,iat:t};if(void 0!==r&&(s?n.uris=[r]:n.uri=r),s){const t=this.base64ToBinary(this.secret),e=this.arraySlice(t,0,32);return(0,d.a)(n,e,o.s,!1,{kid:this.apiKey,nonce:a,alg:"EdDSA"})}return(0,d.a)(n,this.encode(this.secret),o.s,!1,{kid:this.apiKey,nonce:a,alg:"ES256"})}nonce(){return this.milliseconds()-this.options.timeDifference}sign(t,e=[],i="GET",s={},a=void 0,n=void 0){const d=e[0],c="private"===e[1],h="v3"===d;let l="/"+(h?"api/v3":"v2")+"/"+this.implodeParams(t,s);const u=this.omit(s,this.extractParams(t)),p=l;"GET"===i&&Object.keys(u).length&&(l+="?"+this.urlencodeWithArrayRepeat(u));const f=this.urls.api.rest+l;if(c){const t=this.safeString(this.headers,"Authorization");let e;if(void 0!==t)e=t;else if(this.token&&!this.checkRequiredCredentials(!1))e="Bearer "+this.token;else{this.checkRequiredCredentials();const t=this.seconds();let s="";"GET"!==i?Object.keys(u).length&&(s=n=this.json(u)):h||Object.keys(u).length&&(s+="?"+this.urlencode(u));const d=this.apiKey.indexOf("organizations/")>=0||this.secret.startsWith("-----BEGIN"),c=88===this.secret.length||this.safeBool(this.options,"v2CloudAPiKey",!1)||this.secret.endsWith("=");if(d||c){if(d&&this.apiKey.startsWith("-----BEGIN"))throw new r.ArgumentsRequired(this.id+" apiKey should contain the name (eg: organizations/3b910e93....) and not the public key");e="Bearer "+this.createAuthToken(t,i,f,c)}else{const t=this.nonce(),e=this.parseToInt(t/1e3).toString(),r=e+i+p+s,n=this.hmac(this.encode(r),this.encode(this.secret),o.s);a={"CB-ACCESS-KEY":this.apiKey,"CB-ACCESS-SIGN":n,"CB-ACCESS-TIMESTAMP":e,"Content-Type":"application/json"}}}void 0!==e&&(a={Authorization:e,"Content-Type":"application/json"},"GET"!==i&&Object.keys(u).length&&(n=this.json(u)))}return{url:f,method:i,body:n,headers:a}}handleErrors(t,e,i,s,a,n,o,d,c){if(void 0===o)return;const h=this.id+" "+n;let l=this.safeString(o,"error");if(void 0!==l){const t=this.safeString2(o,"error_description","error");throw this.throwExactlyMatchedException(this.exceptions.exact,l,h),this.throwBroadlyMatchedException(this.exceptions.broad,t,h),new r.ExchangeError(h)}const u=this.safeDict(o,"error_response");if(void 0!==u){const t=this.safeString2(u,"preview_failure_reason","preview_failure_reason");throw this.throwExactlyMatchedException(this.exceptions.exact,t,h),this.throwBroadlyMatchedException(this.exceptions.broad,t,h),new r.ExchangeError(h)}const p=this.safeList(o,"errors");if(void 0!==p&&Array.isArray(p)){if(p.length>0){l=this.safeString(p[0],"id");const t=this.safeString(p[0],"message");if(void 0!==l)throw this.throwExactlyMatchedException(this.exceptions.exact,l,h),this.throwBroadlyMatchedException(this.exceptions.broad,t,h),new r.ExchangeError(h)}}const f=this.options.advanced;if(!("data"in o)&&!f)throw new r.ExchangeError(this.id+" failed due to a malformed response "+this.json(o))}async fetchDepositAddresses(t=void 0,e={}){await this.loadMarkets();const i=this.prepareAccountRequest(void 0,e),s=await this.v2PrivateGetAccountsAccountIdAddresses(this.extend(i,e)),r=this.safeList(s,"data",[]);return this.parseDepositAddresses(r,t,!1,{})}}},7517(t,e,i){"use strict";i.d(e,{A:()=>o,h:()=>d});var s=i(1064),r=i(191);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const a=BigInt(0),n=BigInt(1);function o(t,e){const i=(t,e)=>{const i=e.negate();return t?i:e},s=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:i,unsafeLadder(e,i){let s=t.ZERO,r=e;for(;i>a;)i&n&&(s=s.add(r)),r=r.double(),i>>=n;return s},precomputeWindow(t,e){const{windows:i,windowSize:r}=s(e),a=[];let n=t,o=n;for(let t=0;t<i;t++){o=n,a.push(o);for(let t=1;t<r;t++)o=o.add(n),a.push(o);n=o.double()}return a},wNAF(e,r,a){const{windows:o,windowSize:d}=s(e);let c=t.ZERO,h=t.BASE;const l=BigInt(2**e-1),u=2**e,p=BigInt(e);for(let t=0;t<o;t++){const e=t*d;let s=Number(a&l);a>>=p,s>d&&(s-=u,a+=n);const o=e,f=e+Math.abs(s)-1,m=t%2!=0,g=s<0;0===s?h=h.add(i(m,r[o])):c=c.add(i(g,r[f]))}return{p:c,f:h}},wNAFCached(t,e,i,s){const r=t._WINDOW_SIZE||1;let a=e.get(t);return a||(a=this.precomputeWindow(t,r),1!==r&&e.set(t,s(a))),this.wNAF(r,a,i)}}}function d(t){return(0,s.jr)(t.Fp),(0,r.Q5)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,s.LH)(t.n,t.nBitLength),...t})}},7525(t,e,i){"use strict";i.d(e,{e3:()=>c,pH:()=>l});var s=i(9806);i(9999);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var r,a=i(1291),n=i.n(a);!function(t){t[t.SIDE_UNSPECIFIED=0]="SIDE_UNSPECIFIED",t[t.SIDE_BUY=1]="SIDE_BUY",t[t.SIDE_SELL=2]="SIDE_SELL",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(r||(r={}));var o;!function(t){t[t.TIME_IN_FORCE_UNSPECIFIED=0]="TIME_IN_FORCE_UNSPECIFIED",t[t.TIME_IN_FORCE_IOC=1]="TIME_IN_FORCE_IOC",t[t.TIME_IN_FORCE_POST_ONLY=2]="TIME_IN_FORCE_POST_ONLY",t[t.TIME_IN_FORCE_FILL_OR_KILL=3]="TIME_IN_FORCE_FILL_OR_KILL",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(o||(o={}));var d;!function(t){t[t.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",t[t.CONDITION_TYPE_STOP_LOSS=1]="CONDITION_TYPE_STOP_LOSS",t[t.CONDITION_TYPE_TAKE_PROFIT=2]="CONDITION_TYPE_TAKE_PROFIT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"}(d||(d={}));const c={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.subaccountId&&s.D.encode(t.subaccountId,e.uint32(10).fork()).ldelim(),0!==t.clientId&&e.uint32(21).fixed32(t.clientId),0!==t.orderFlags&&e.uint32(24).uint32(t.orderFlags),0!==t.clobPairId&&e.uint32(32).uint32(t.clobPairId),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={subaccountId:void 0,clientId:0,orderFlags:0,clobPairId:0};for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.subaccountId=s.D.decode(i,i.uint32());break;case 2:a.clientId=i.fixed32();break;case 3:a.orderFlags=i.uint32();break;case 4:a.clobPairId=i.uint32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={subaccountId:void 0,clientId:0,orderFlags:0,clobPairId:0};return e.subaccountId=void 0!==t.subaccountId&&null!==t.subaccountId?s.D.fromPartial(t.subaccountId):void 0,e.clientId=t.clientId??0,e.orderFlags=t.orderFlags??0,e.clobPairId=t.clobPairId??0,e}};function h(){return{orderId:void 0,side:0,quantums:n().UZERO,subticks:n().UZERO,goodTilBlock:void 0,goodTilBlockTime:void 0,timeInForce:0,reduceOnly:!1,clientMetadata:0,conditionType:0,conditionalOrderTriggerSubticks:n().UZERO,twapParameters:void 0,builderCodeParameters:void 0,orderRouterAddress:""}}const l={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.orderId&&c.encode(t.orderId,e.uint32(10).fork()).ldelim(),0!==t.side&&e.uint32(16).int32(t.side),t.quantums.isZero()||e.uint32(24).uint64(t.quantums),t.subticks.isZero()||e.uint32(32).uint64(t.subticks),void 0!==t.goodTilBlock&&e.uint32(40).uint32(t.goodTilBlock),void 0!==t.goodTilBlockTime&&e.uint32(53).fixed32(t.goodTilBlockTime),0!==t.timeInForce&&e.uint32(56).int32(t.timeInForce),!0===t.reduceOnly&&e.uint32(64).bool(t.reduceOnly),0!==t.clientMetadata&&e.uint32(72).uint32(t.clientMetadata),0!==t.conditionType&&e.uint32(80).int32(t.conditionType),t.conditionalOrderTriggerSubticks.isZero()||e.uint32(88).uint64(t.conditionalOrderTriggerSubticks),void 0!==t.twapParameters&&u.encode(t.twapParameters,e.uint32(98).fork()).ldelim(),void 0!==t.builderCodeParameters&&p.encode(t.builderCodeParameters,e.uint32(106).fork()).ldelim(),""!==t.orderRouterAddress&&e.uint32(114).string(t.orderRouterAddress),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=h();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.orderId=c.decode(i,i.uint32());break;case 2:r.side=i.int32();break;case 3:r.quantums=i.uint64();break;case 4:r.subticks=i.uint64();break;case 5:r.goodTilBlock=i.uint32();break;case 6:r.goodTilBlockTime=i.fixed32();break;case 7:r.timeInForce=i.int32();break;case 8:r.reduceOnly=i.bool();break;case 9:r.clientMetadata=i.uint32();break;case 10:r.conditionType=i.int32();break;case 11:r.conditionalOrderTriggerSubticks=i.uint64();break;case 12:r.twapParameters=u.decode(i,i.uint32());break;case 13:r.builderCodeParameters=p.decode(i,i.uint32());break;case 14:r.orderRouterAddress=i.string();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=h();return e.orderId=void 0!==t.orderId&&null!==t.orderId?c.fromPartial(t.orderId):void 0,e.side=t.side??0,e.quantums=void 0!==t.quantums&&null!==t.quantums?n().fromValue(t.quantums):n().UZERO,e.subticks=void 0!==t.subticks&&null!==t.subticks?n().fromValue(t.subticks):n().UZERO,e.goodTilBlock=t.goodTilBlock??void 0,e.goodTilBlockTime=t.goodTilBlockTime??void 0,e.timeInForce=t.timeInForce??0,e.reduceOnly=t.reduceOnly??!1,e.clientMetadata=t.clientMetadata??0,e.conditionType=t.conditionType??0,e.conditionalOrderTriggerSubticks=void 0!==t.conditionalOrderTriggerSubticks&&null!==t.conditionalOrderTriggerSubticks?n().fromValue(t.conditionalOrderTriggerSubticks):n().UZERO,e.twapParameters=void 0!==t.twapParameters&&null!==t.twapParameters?u.fromPartial(t.twapParameters):void 0,e.builderCodeParameters=void 0!==t.builderCodeParameters&&null!==t.builderCodeParameters?p.fromPartial(t.builderCodeParameters):void 0,e.orderRouterAddress=t.orderRouterAddress??"",e}};const u={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.duration&&e.uint32(8).uint32(t.duration),0!==t.interval&&e.uint32(16).uint32(t.interval),0!==t.priceTolerance&&e.uint32(24).uint32(t.priceTolerance),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={duration:0,interval:0,priceTolerance:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.duration=i.uint32();break;case 2:r.interval=i.uint32();break;case 3:r.priceTolerance=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={duration:0,interval:0,priceTolerance:0};return e.duration=t.duration??0,e.interval=t.interval??0,e.priceTolerance=t.priceTolerance??0,e}};const p={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.builderAddress&&e.uint32(10).string(t.builderAddress),0!==t.feePpm&&e.uint32(16).uint32(t.feePpm),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={builderAddress:"",feePpm:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.builderAddress=i.string();break;case 2:r.feePpm=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={builderAddress:"",feePpm:0};return e.builderAddress=t.builderAddress??"",e.feePpm=t.feePpm??0,e}}},7593(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(5307);function r(t,e,i){for(let s=0,r=0;s<t.length;s++)if(t[s]===e)r++;else if(t[s]===i&&0===--r)return s;return Number.POSITIVE_INFINITY}function a(t){return(0,s.s8)(t)?function(t){const e=t.slice(1,-1),i=[];let s,a=0;for(;a<e.length;){switch(!0){case"("===e[a]:s=a+r(e.slice(a),"(",")")+1;break;case e.startsWith("core::result::Result::<",a)||e.startsWith("core::array::Array::<",a)||e.startsWith("core::option::Option::<",a):s=a+r(e.slice(a),"<",">")+1;break;default:{const t=e.indexOf(",",a);s=-1!==t?t:Number.POSITIVE_INFINITY}}i.push(e.slice(a,s)),a=s+2}return i}(t):function(t){const e=t.replace(/\s/g,"").slice(1,-1),{subTuple:i,result:r}=function(t){if(!t.includes("("))return{subTuple:[],result:t};const e=[];let i="",s=0;for(;s<t.length;){if("("===t[s]){let r=1;const a=s;for(s++;r;)")"===t[s]&&r--,"("===t[s]&&r++,s++;e.push(t.substring(a,s)),i+=" ",s--}else i+=t[s];s++}return{subTuple:e,result:i}}(e);let a=r.split(",").map(t=>i.length?t.replace(" ",i.shift()):t);return(0,s.mQ)(t)&&(a=a.reduce((t,e)=>t.concat(function(t){const e=t.substring(0,t.indexOf(":"));return{name:e,type:t.substring(e.length+1)}}(e)),[])),a}(t)}},7597(t,e,i){"use strict";i.d(e,{Bd:()=>s,Ll:()=>d,N6:()=>o,b8:()=>r,p7:()=>a,uF:()=>n});const s="undefined"!=typeof window,r="undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.electron,a="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,n="undefined"!=typeof process&&"win32"===process.platform,o="undefined"!=typeof Deno,d=!(s||a||o)},7618(t,e,i){"use strict";i.d(e,{x:()=>r});var s=i(8403);class r{constructor(t){this.config={refillRate:1,delay:.001,capacity:1,tokens:0,cost:1,algorithm:"leakyBucket",windowSize:6e4,maxWeight:void 0},Object.assign(this.config,t),"leakyBucket"!==this.config.algorithm&&(this.config.maxWeight=this.config.windowSize/this.config.rateLimit),this.queue=[],this.running=!1,this.timestamps=[]}async leakyBucketLoop(){let t=(0,s.tB)();for(;this.running;){const{resolver:e,cost:i}=this.queue[0];if(this.config.tokens>=0)this.config.tokens-=i,e(),this.queue.shift(),await Promise.resolve(),0===this.queue.length&&(this.running=!1);else{await(0,s.yy)(1e3*this.config.delay);const e=(0,s.tB)(),i=e-t;t=e;const r=this.config.tokens+this.config.refillRate*i;this.config.tokens=Math.min(r,this.config.capacity)}}}async rollingWindowLoop(){for(;this.running;){const{resolver:t,cost:e}=this.queue[0],i=(0,s.tB)(),r=i-this.config.windowSize;let a=0;const n=[];for(let t=0;t<this.timestamps.length;t++){const e=this.timestamps[t];e.timestamp>r&&(a+=e.cost,n.push(e))}if(this.timestamps=n,a+e<=this.config.maxWeight)this.timestamps.push({timestamp:i,cost:e}),t(),this.queue.shift(),await Promise.resolve(),0===this.queue.length&&(this.running=!1);else{const t=this.timestamps[0].timestamp+this.config.windowSize-i;t>0&&await(0,s.yy)(t)}}}async loop(){"leakyBucket"===this.config.algorithm?await this.leakyBucketLoop():await this.rollingWindowLoop()}throttle(t=void 0){let e;const i=new Promise((t,i)=>{e=t});return t=void 0===t?this.config.cost:t,this.queue.push({resolver:e,cost:t}),this.running||(this.running=!0,this.loop()),i}}},7648(t,e,i){"use strict";i.d(e,{J_:()=>a}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());var s=i(1291),r=i.n(s);const a={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.maxLiquidationFeePpm&&e.uint32(8).uint32(t.maxLiquidationFeePpm),void 0!==t.positionBlockLimits&&o.encode(t.positionBlockLimits,e.uint32(18).fork()).ldelim(),void 0!==t.subaccountBlockLimits&&c.encode(t.subaccountBlockLimits,e.uint32(26).fork()).ldelim(),void 0!==t.fillablePriceConfig&&h.encode(t.fillablePriceConfig,e.uint32(34).fork()).ldelim(),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={maxLiquidationFeePpm:0,positionBlockLimits:void 0,subaccountBlockLimits:void 0,fillablePriceConfig:void 0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.maxLiquidationFeePpm=i.uint32();break;case 2:r.positionBlockLimits=o.decode(i,i.uint32());break;case 3:r.subaccountBlockLimits=c.decode(i,i.uint32());break;case 4:r.fillablePriceConfig=h.decode(i,i.uint32());break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={maxLiquidationFeePpm:0,positionBlockLimits:void 0,subaccountBlockLimits:void 0,fillablePriceConfig:void 0};return e.maxLiquidationFeePpm=t.maxLiquidationFeePpm??0,e.positionBlockLimits=void 0!==t.positionBlockLimits&&null!==t.positionBlockLimits?o.fromPartial(t.positionBlockLimits):void 0,e.subaccountBlockLimits=void 0!==t.subaccountBlockLimits&&null!==t.subaccountBlockLimits?c.fromPartial(t.subaccountBlockLimits):void 0,e.fillablePriceConfig=void 0!==t.fillablePriceConfig&&null!==t.fillablePriceConfig?h.fromPartial(t.fillablePriceConfig):void 0,e}};function n(){return{minPositionNotionalLiquidated:r().UZERO,maxPositionPortionLiquidatedPpm:0}}const o={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(t.minPositionNotionalLiquidated.isZero()||e.uint32(8).uint64(t.minPositionNotionalLiquidated),0!==t.maxPositionPortionLiquidatedPpm&&e.uint32(16).uint32(t.maxPositionPortionLiquidatedPpm),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=n();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.minPositionNotionalLiquidated=i.uint64();break;case 2:r.maxPositionPortionLiquidatedPpm=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=n();return e.minPositionNotionalLiquidated=void 0!==t.minPositionNotionalLiquidated&&null!==t.minPositionNotionalLiquidated?r().fromValue(t.minPositionNotionalLiquidated):r().UZERO,e.maxPositionPortionLiquidatedPpm=t.maxPositionPortionLiquidatedPpm??0,e}};function d(){return{maxNotionalLiquidated:r().UZERO,maxQuantumsInsuranceLost:r().UZERO}}const c={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(t.maxNotionalLiquidated.isZero()||e.uint32(8).uint64(t.maxNotionalLiquidated),t.maxQuantumsInsuranceLost.isZero()||e.uint32(16).uint64(t.maxQuantumsInsuranceLost),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r=d();for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.maxNotionalLiquidated=i.uint64();break;case 2:r.maxQuantumsInsuranceLost=i.uint64();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e=d();return e.maxNotionalLiquidated=void 0!==t.maxNotionalLiquidated&&null!==t.maxNotionalLiquidated?r().fromValue(t.maxNotionalLiquidated):r().UZERO,e.maxQuantumsInsuranceLost=void 0!==t.maxQuantumsInsuranceLost&&null!==t.maxQuantumsInsuranceLost?r().fromValue(t.maxQuantumsInsuranceLost):r().UZERO,e}};const h={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.bankruptcyAdjustmentPpm&&e.uint32(8).uint32(t.bankruptcyAdjustmentPpm),0!==t.spreadToMaintenanceMarginRatioPpm&&e.uint32(16).uint32(t.spreadToMaintenanceMarginRatioPpm),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={bankruptcyAdjustmentPpm:0,spreadToMaintenanceMarginRatioPpm:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.bankruptcyAdjustmentPpm=i.uint32();break;case 2:r.spreadToMaintenanceMarginRatioPpm=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={bankruptcyAdjustmentPpm:0,spreadToMaintenanceMarginRatioPpm:0};return e.bankruptcyAdjustmentPpm=t.bankruptcyAdjustmentPpm??0,e.spreadToMaintenanceMarginRatioPpm=t.spreadToMaintenanceMarginRatioPpm??0,e}}},7661(t,e,i){"use strict";let s;i.d(e,{$s:()=>A,Ay:()=>gt,H3:()=>nt,JF:()=>M,KR:()=>V,qj:()=>E});const r=new Array(128).fill(void 0);function a(t){return r[t]}r.push(void 0,null,!0,!1);let n=r.length;function o(t){const e=a(t);return function(t){t<132||(r[t]=n,n=t)}(t),e}function d(t){n===r.length&&r.push(r.length+1);const e=n;return n=r[e],r[e]=t,e}const c="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&c.decode();let h=null;function l(){return null!==h&&0!==h.byteLength||(h=new Uint8Array(s.memory.buffer)),h}function u(t,e){return t>>>=0,c.decode(l().subarray(t,t+e))}function p(t){return null==t}let f=null;let m=null;function g(){return null!==m&&0!==m.byteLength||(m=new Int32Array(s.memory.buffer)),m}let y=0;const v="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},b="function"==typeof v.encodeInto?function(t,e){return v.encodeInto(t,e)}:function(t,e){const i=v.encode(t);return e.set(i),{read:t.length,written:i.length}};function w(t,e,i){if(void 0===i){const i=v.encode(t),s=e(i.length,1)>>>0;return l().subarray(s,s+i.length).set(i),y=i.length,s}let s=t.length,r=e(s,1)>>>0;const a=l();let n=0;for(;n<s;n++){const e=t.charCodeAt(n);if(e>127)break;a[r+n]=e}if(n!==s){0!==n&&(t=t.slice(n)),r=i(r,s,s=n+3*t.length,1)>>>0;const e=l().subarray(r+n,r+s);n+=b(t,e).written,r=i(r,s,n,1)>>>0}return y=n,r}let S=null;function k(t){const e=typeof t;if("number"==e||"boolean"==e||null==t)return`${t}`;if("string"==e)return`"${t}"`;if("symbol"==e){const e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==e){const e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){const e=t.length;let i="[";e>0&&(i+=k(t[0]));for(let s=1;s<e;s++)i+=", "+k(t[s]);return i+="]",i}const i=/\[object ([^\]]+)\]/.exec(toString.call(t));let s;if(!(i.length>1))return toString.call(t);if(s=i[1],"Object"==s)try{return"Object("+JSON.stringify(t)+")"}catch(t){return"Object"}return t instanceof Error?`${t.name}: ${t.message}\n${t.stack}`:s}const O="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>{s.__wbindgen_export_2.get(t.dtor)(t.a,t.b)});function T(t,e,i,r){const a={a:t,b:e,cnt:1,dtor:i},n=(...t)=>{a.cnt++;const e=a.a;a.a=0;try{return r(e,a.b,...t)}finally{0===--a.cnt?(s.__wbindgen_export_2.get(a.dtor)(e,a.b),O.unregister(a)):a.a=e}};return n.original=a,O.register(n,a,a),n}function P(t,e){s.__wbindgen_export_3(t,e)}function _(t,e,i){s.__wbindgen_export_4(t,e,d(i))}function A(t){try{const r=s.__wbindgen_add_to_stack_pointer(-16);s.newRpcSignerWithProvider(r,d(t));var e=g()[r/4+0],i=g()[r/4+1];if(g()[r/4+2])throw o(i);return $.__wrap(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}function I(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}let x=null;function E(t){I(t,nt);var e=t.__destroy_into_raw();const i=s.newTransfer(e);return rt.__wrap(i)}function M(t){I(t,V);var e=t.__destroy_into_raw();const i=s.newContract(e);return q.__wrap(i)}function C(t,e){try{return t.apply(this,e)}catch(t){s.__wbindgen_export_6(d(t))}}Object.freeze({Success:0,0:"Success",Failed:1,1:"Failed",Pending:2,2:"Pending"}),Object.freeze({OnChain:0,0:"OnChain",EthECDSA:1,1:"EthECDSA",EthCREATE2:2,2:"EthCREATE2"}),Object.freeze({Eth:0,0:"Eth",Eip1271:1,1:"Eip1271",Stark:2,2:"Stark"}),Object.freeze({Deposit:1,1:"Deposit",FullExit:5,5:"FullExit",ChangePubKey:6,6:"ChangePubKey",Transfer:4,4:"Transfer",Withdraw:3,3:"Withdraw",ForcedExit:7,7:"ForcedExit",OrderMatching:8,8:"OrderMatching",AutoDeleveraging:11,11:"AutoDeleveraging",ContractMatching:9,9:"ContractMatching",Funding:13,13:"Funding",Liquidation:10,10:"Liquidation",UpdateGlobalVar:12,12:"UpdateGlobalVar"}),Object.freeze({Latest:0,0:"Latest",Finalized:1,1:"Finalized",Safe:2,2:"Safe",Earliest:3,3:"Earliest",Pending:4,4:"Pending",Number:5,5:"Number"}),Object.freeze({FeeAccount:0,0:"FeeAccount",InsuranceFundAccount:1,1:"InsuranceFundAccount",MarginInfo:2,2:"MarginInfo",FundingInfos:3,3:"FundingInfos",ContractInfo:4,4:"ContractInfo"}),Object.freeze({AccountId:0,0:"AccountId",Address:1,1:"Address"}),"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_accountquery_free(t>>>0));const B="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_autodeleveraging_free(t>>>0));class N{static __wrap(t){t>>>=0;const e=Object.create(N.prototype);return e.__wbg_ptr=t,B.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,B.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_autodeleveraging_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.autodeleveraging_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.autodeleveraging_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_autodeleveragingbuilder_free(t>>>0));const R="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_changepubkey_free(t>>>0));class L{static __wrap(t){t>>>=0;const e=Object.create(L.prototype);return e.__wbg_ptr=t,R.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,R.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_changepubkey_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.changepubkey_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}getChangePubkeyMessage(t,e){let i,r;try{const p=s.__wbindgen_add_to_stack_pointer(-16),f=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),m=y;s.changepubkey_getChangePubkeyMessage(p,this.__wbg_ptr,t,f,m);var a=g()[p/4+0],n=g()[p/4+1],d=g()[p/4+2],c=g()[p/4+3],h=a,l=n;if(c)throw h=0,l=0,o(d);return i=h,r=l,u(h,l)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(i,r,1)}}getEthSignMsg(t,e){let i,r;try{const o=s.__wbindgen_add_to_stack_pointer(-16);s.changepubkey_getEthSignMsg(o,this.__wbg_ptr,t,e);var a=g()[o/4+0],n=g()[o/4+1];return i=a,r=n,u(a,n)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(i,r,1)}}setEthAuthData(t){try{const r=s.__wbindgen_add_to_stack_pointer(-16),a=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),n=y;s.changepubkey_setEthAuthData(r,this.__wbg_ptr,a,n);var e=g()[r/4+0],i=g()[r/4+1];if(g()[r/4+2])throw o(i);return o(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.changepubkey_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_changepubkeybuilder_free(t>>>0));const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_contract_free(t>>>0));class q{static __wrap(t){t>>>=0;const e=Object.create(q.prototype);return e.__wbg_ptr=t,D.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_contract_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.contract_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.contract_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}const F="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_contractbuilder_free(t>>>0));class V{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,F.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_contractbuilder_free(t)}constructor(t,e,i,r,a,n,d,c,h,l,u){try{const m=s.__wbindgen_add_to_stack_pointer(-16),v=w(n,s.__wbindgen_export_0,s.__wbindgen_export_1),b=y,S=w(d,s.__wbindgen_export_0,s.__wbindgen_export_1),k=y;s.contractbuilder_new(m,t,e,i,r,a,v,b,S,k,c,h,l,u);var p=g()[m/4+0],f=g()[m/4+1];if(g()[m/4+2])throw o(f);return this.__wbg_ptr=p>>>0,this}finally{s.__wbindgen_add_to_stack_pointer(16)}}build(){const t=this.__destroy_into_raw(),e=s.contractbuilder_build(t);return q.__wrap(e)}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_contractinfo_free(t>>>0));const U="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_contractmatching_free(t>>>0));class j{static __wrap(t){t>>>=0;const e=Object.create(j.prototype);return e.__wbg_ptr=t,U.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,U.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_contractmatching_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.contractmatching_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.contractmatching_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_contractmatchingbuilder_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_contractprice_free(t>>>0));const G="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_create2data_free(t>>>0));class H{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_create2data_free(t)}constructor(t,e,i){try{const n=s.__wbindgen_add_to_stack_pointer(-16),d=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),c=y,h=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),l=y,u=w(i,s.__wbindgen_export_0,s.__wbindgen_export_1),p=y;s.create2data_new(n,d,c,h,l,u,p);var r=g()[n/4+0],a=g()[n/4+1];if(g()[n/4+2])throw o(a);return this.__wbg_ptr=r>>>0,this}finally{s.__wbindgen_add_to_stack_pointer(16)}}salt(t){let e,i;try{const n=s.__wbindgen_add_to_stack_pointer(-16),o=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),d=y;s.create2data_salt(n,this.__wbg_ptr,o,d);var r=g()[n/4+0],a=g()[n/4+1];return e=r,i=a,u(r,a)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(e,i,1)}}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.create2data_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_ethtxoption_free(t>>>0));const W="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_forcedexit_free(t>>>0));class z{static __wrap(t){t>>>=0;const e=Object.create(z.prototype);return e.__wbg_ptr=t,W.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,W.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_forcedexit_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.forcedexit_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.forcedexit_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_forcedexitbuilder_free(t>>>0));const K="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_funding_free(t>>>0));class Y{static __wrap(t){t>>>=0;const e=Object.create(Y.prototype);return e.__wbg_ptr=t,K.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_funding_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.funding_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.funding_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_fundingbuilder_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_fundinginfo_free(t>>>0));const Z="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_jsonrpcsigner_free(t>>>0));class ${static __wrap(t){t>>>=0;const e=Object.create($.prototype);return e.__wbg_ptr=t,Z.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Z.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_jsonrpcsigner_free(t)}initZklinkSigner(t){var e=p(t)?0:w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),i=y;return o(s.jsonrpcsigner_initZklinkSigner(this.__wbg_ptr,e,i))}getPubkey(){let t,e;try{const a=s.__wbindgen_add_to_stack_pointer(-16);s.jsonrpcsigner_getPubkey(a,this.__wbg_ptr);var i=g()[a/4+0],r=g()[a/4+1];return t=i,e=r,u(i,r)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(t,e,1)}}pubkeyHash(){let t,e;try{const a=s.__wbindgen_add_to_stack_pointer(-16);s.jsonrpcsigner_pubkeyHash(a,this.__wbg_ptr);var i=g()[a/4+0],r=g()[a/4+1];return t=i,e=r,u(i,r)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(t,e,1)}}address(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.jsonrpcsigner_address(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];let r;return 0!==t&&(r=u(t,e).slice(),s.__wbindgen_export_5(t,1*e,1)),r}finally{s.__wbindgen_add_to_stack_pointer(16)}}signatureSeed(){let t,e;try{const a=s.__wbindgen_add_to_stack_pointer(-16);s.jsonrpcsigner_signatureSeed(a,this.__wbg_ptr);var i=g()[a/4+0],r=g()[a/4+1];return t=i,e=r,u(i,r)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(t,e,1)}}signChangePubkeyWithOnchain(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,L);var e=t.__destroy_into_raw();s.jsonrpcsigner_signChangePubkeyWithOnchain(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signChangePubkeyWithEthEcdsaAuth(t){I(t,L);var e=t.__destroy_into_raw();return o(s.jsonrpcsigner_signChangePubkeyWithEthEcdsaAuth(this.__wbg_ptr,e))}signChangePubkeyWithCreate2DataAuth(t,e){try{const d=s.__wbindgen_add_to_stack_pointer(-16);I(t,L);var i=t.__destroy_into_raw();I(e,H);var r=e.__destroy_into_raw();s.jsonrpcsigner_signChangePubkeyWithCreate2DataAuth(d,this.__wbg_ptr,i,r);var a=g()[d/4+0],n=g()[d/4+1];if(g()[d/4+2])throw o(n);return o(a)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signTransfer(t,e){I(t,rt);var i=t.__destroy_into_raw();const r=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),a=y;return o(s.jsonrpcsigner_signTransfer(this.__wbg_ptr,i,r,a))}createSignedOrder(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,tt);var e=t.__destroy_into_raw();s.jsonrpcsigner_createSignedOrder(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signOrderMatching(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,it);var e=t.__destroy_into_raw();s.jsonrpcsigner_signOrderMatching(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signWithdraw(t,e){I(t,ht);var i=t.__destroy_into_raw();const r=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),a=y;return o(s.jsonrpcsigner_signWithdraw(this.__wbg_ptr,i,r,a))}signForcedExit(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,z);var e=t.__destroy_into_raw();s.jsonrpcsigner_signForcedExit(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signAutoDeleveraging(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,N);var e=t.__destroy_into_raw();s.jsonrpcsigner_signAutoDeleveraging(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}createSignedContract(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,q);var e=t.__destroy_into_raw();s.jsonrpcsigner_createSignedContract(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signContractMatching(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,j);var e=t.__destroy_into_raw();s.jsonrpcsigner_signContractMatching(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signFunding(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,Y);var e=t.__destroy_into_raw();s.jsonrpcsigner_signFunding(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signLiquidation(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,X);var e=t.__destroy_into_raw();s.jsonrpcsigner_signLiquidation(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}signMusig(t){try{const r=s.__wbindgen_add_to_stack_pointer(-16),a=function(t,e){const i=e(1*t.length,1)>>>0;return l().set(t,i/1),y=t.length,i}(t,s.__wbindgen_export_0),n=y;s.jsonrpcsigner_signMusig(r,this.__wbg_ptr,a,n);var e=g()[r/4+0],i=g()[r/4+1];if(g()[r/4+2])throw o(i);return dt.__wrap(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}getZkLinkSigner(){const t=s.jsonrpcsigner_getZkLinkSigner(this.__wbg_ptr);return ut.__wrap(t)}}const Q="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_liquidation_free(t>>>0));class X{static __wrap(t){t>>>=0;const e=Object.create(X.prototype);return e.__wbg_ptr=t,Q.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Q.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_liquidation_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.liquidation_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.liquidation_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_liquidationbuilder_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_margininfo_free(t>>>0));const J="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_order_free(t>>>0));class tt{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,J.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_order_free(t)}constructor(t,e,i,r,a,n,d,c,h,l,u,p){try{const v=s.__wbindgen_add_to_stack_pointer(-16),b=w(d,s.__wbindgen_export_0,s.__wbindgen_export_1),S=y,k=w(c,s.__wbindgen_export_0,s.__wbindgen_export_1),O=y;s.order_new(v,t,e,i,r,a,n,b,S,k,O,h,l,u,p);var f=g()[v/4+0],m=g()[v/4+1];if(g()[v/4+2])throw o(m);return this.__wbg_ptr=f>>>0,this}finally{s.__wbindgen_add_to_stack_pointer(16)}}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.order_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.order_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}const et="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_ordermatching_free(t>>>0));class it{static __wrap(t){t>>>=0;const e=Object.create(it.prototype);return e.__wbg_ptr=t,et.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,et.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_ordermatching_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.ordermatching_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_ordermatchingbuilder_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_parameter_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_requestarguments_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_rpcclient_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_spotpriceinfo_free(t>>>0));const st="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_transfer_free(t>>>0));class rt{static __wrap(t){t>>>=0;const e=Object.create(rt.prototype);return e.__wbg_ptr=t,st.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,st.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_transfer_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.transfer_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}getEthSignMsg(t){let e,i;try{const n=s.__wbindgen_add_to_stack_pointer(-16),o=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),d=y;s.transfer_getEthSignMsg(n,this.__wbg_ptr,o,d);var r=g()[n/4+0],a=g()[n/4+1];return e=r,i=a,u(r,a)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(e,i,1)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.transfer_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}const at="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_transferbuilder_free(t>>>0));class nt{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,at.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_transferbuilder_free(t)}constructor(t,e,i,r,a,n,d,c,h){try{const f=s.__wbindgen_add_to_stack_pointer(-16),m=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),v=y,b=w(n,s.__wbindgen_export_0,s.__wbindgen_export_1),S=y,k=w(d,s.__wbindgen_export_0,s.__wbindgen_export_1),O=y;s.transferbuilder_new(f,t,m,v,i,r,a,b,S,k,O,c,!p(h),p(h)?0:h);var l=g()[f/4+0],u=g()[f/4+1];if(g()[f/4+2])throw o(u);return this.__wbg_ptr=l>>>0,this}finally{s.__wbindgen_add_to_stack_pointer(16)}}build(){const t=this.__destroy_into_raw(),e=s.transferbuilder_build(t);return rt.__wrap(e)}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_txlayer1signature_free(t>>>0));const ot="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_txzklinksignature_free(t>>>0));class dt{static __wrap(t){t>>>=0;const e=Object.create(dt.prototype);return e.__wbg_ptr=t,ot.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ot.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_txzklinksignature_free(t)}constructor(t,e){try{const a=s.__wbindgen_add_to_stack_pointer(-16),n=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),d=y,c=w(e,s.__wbindgen_export_0,s.__wbindgen_export_1),h=y;s.txzklinksignature_new(a,n,d,c,h);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return this.__wbg_ptr=i>>>0,this}finally{s.__wbindgen_add_to_stack_pointer(16)}}pubKey(){let t,e;try{const a=s.__wbindgen_add_to_stack_pointer(-16);s.txzklinksignature_pubKey(a,this.__wbg_ptr);var i=g()[a/4+0],r=g()[a/4+1];return t=i,e=r,u(i,r)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(t,e,1)}}signature(){let t,e;try{const a=s.__wbindgen_add_to_stack_pointer(-16);s.txzklinksignature_signature(a,this.__wbg_ptr);var i=g()[a/4+0],r=g()[a/4+1];return t=i,e=r,u(i,r)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(t,e,1)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_updateglobalvar_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_updateglobalvarbuilder_free(t>>>0));"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_wallet_free(t>>>0));const ct="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_withdraw_free(t>>>0));class ht{static __wrap(t){t>>>=0;const e=Object.create(ht.prototype);return e.__wbg_ptr=t,ct.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ct.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_withdraw_free(t)}jsValue(){try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.withdraw_jsValue(i,this.__wbg_ptr);var t=g()[i/4+0],e=g()[i/4+1];if(g()[i/4+2])throw o(e);return o(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}getEthSignMsg(t){let e,i;try{const n=s.__wbindgen_add_to_stack_pointer(-16),o=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),d=y;s.withdraw_getEthSignMsg(n,this.__wbg_ptr,o,d);var r=g()[n/4+0],a=g()[n/4+1];return e=r,i=a,u(r,a)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_export_5(e,i,1)}}sign(t){try{const a=s.__wbindgen_add_to_stack_pointer(-16);I(t,ut);var e=t.__destroy_into_raw();s.withdraw_sign(a,this.__wbg_ptr,e);var i=g()[a/4+0],r=g()[a/4+1];if(g()[a/4+2])throw o(r);return o(i)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_withdrawbuilder_free(t>>>0));const lt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_zklinksigner_free(t>>>0));class ut{static __wrap(t){t>>>=0;const e=Object.create(ut.prototype);return e.__wbg_ptr=t,lt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,lt.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_zklinksigner_free(t)}static ethSig(t){try{const r=s.__wbindgen_add_to_stack_pointer(-16),a=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),n=y;s.zklinksigner_ethSig(r,a,n);var e=g()[r/4+0],i=g()[r/4+1];if(g()[r/4+2])throw o(i);return ut.__wrap(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}static starknetSig(t){try{const r=s.__wbindgen_add_to_stack_pointer(-16),a=w(t,s.__wbindgen_export_0,s.__wbindgen_export_1),n=y;s.zklinksigner_starknetSig(r,a,n);var e=g()[r/4+0],i=g()[r/4+1];if(g()[r/4+2])throw o(i);return ut.__wrap(e)}finally{s.__wbindgen_add_to_stack_pointer(16)}}}"undefined"==typeof FinalizationRegistry||new FinalizationRegistry(t=>s.__wbg_zklinktx_free(t>>>0));function pt(){const t={wbg:{}};return t.wbg.__wbindgen_object_drop_ref=function(t){o(t)},t.wbg.__wbg_request_aa80f2dd90291bcc=function(){return C(function(t,e){return d(a(t).request(o(e)))},arguments)},t.wbg.__wbg_signMessage_31620e519ceecf94=function(){return C(function(t,e){return d(a(t).signMessage(a(e)))},arguments)},t.wbg.__wbindgen_number_new=function(t){return d(t)},t.wbg.__wbindgen_string_new=function(t,e){return d(u(t,e))},t.wbg.__wbindgen_is_undefined=function(t){return void 0===a(t)},t.wbg.__wbindgen_in=function(t,e){return a(t)in a(e)},t.wbg.__wbindgen_boolean_get=function(t){const e=a(t);return"boolean"==typeof e?e?1:0:2},t.wbg.__wbindgen_is_bigint=function(t){return"bigint"==typeof a(t)},t.wbg.__wbindgen_number_get=function(t,e){const i=a(e),r="number"==typeof i?i:void 0;(null!==f&&0!==f.byteLength||(f=new Float64Array(s.memory.buffer)),f)[t/8+1]=p(r)?0:r,g()[t/4+0]=!p(r)},t.wbg.__wbindgen_bigint_from_i64=function(t){return d(t)},t.wbg.__wbindgen_jsval_eq=function(t,e){return a(t)===a(e)},t.wbg.__wbindgen_string_get=function(t,e){const i=a(e),r="string"==typeof i?i:void 0;var n=p(r)?0:w(r,s.__wbindgen_export_0,s.__wbindgen_export_1),o=y;g()[t/4+1]=o,g()[t/4+0]=n},t.wbg.__wbindgen_is_object=function(t){const e=a(t);return"object"==typeof e&&null!==e},t.wbg.__wbindgen_bigint_from_u64=function(t){return d(BigInt.asUintN(64,t))},t.wbg.__wbindgen_object_clone_ref=function(t){return d(a(t))},t.wbg.__wbindgen_as_number=function(t){return+a(t)},t.wbg.__wbindgen_error_new=function(t,e){return d(new Error(u(t,e)))},t.wbg.__wbg_performance_eeefc685c9bc38b4=function(t){return d(a(t).performance)},t.wbg.__wbg_now_e0d8ec93dd25766a=function(t){return a(t).now()},t.wbg.__wbg_selectedAddress_e88960714bb47d11=function(t,e){const i=a(e).selectedAddress;var r=p(i)?0:w(i,s.__wbindgen_export_0,s.__wbindgen_export_1),n=y;g()[t/4+1]=n,g()[t/4+0]=r},t.wbg.__wbg_address_b7ff4a10022d02d8=function(t,e){const i=w(a(e).address,s.__wbindgen_export_0,s.__wbindgen_export_1),r=y;g()[t/4+1]=r,g()[t/4+0]=i},t.wbg.__wbindgen_jsval_loose_eq=function(t,e){return a(t)==a(e)},t.wbg.__wbg_String_389b54bd9d25375f=function(t,e){const i=w(String(a(e)),s.__wbindgen_export_0,s.__wbindgen_export_1),r=y;g()[t/4+1]=r,g()[t/4+0]=i},t.wbg.__wbg_getwithrefkey_4a92a5eca60879b9=function(t,e){return d(a(t)[a(e)])},t.wbg.__wbg_set_9182712abebf82ef=function(t,e,i){a(t)[o(e)]=o(i)},t.wbg.__wbindgen_cb_drop=function(t){const e=o(t).original;if(1==e.cnt--)return e.a=0,!0;return!1},t.wbg.__wbg_clearTimeout_76877dbc010e786d=function(t){return d(clearTimeout(o(t)))},t.wbg.__wbg_setTimeout_75cb9b6991a4031d=function(){return C(function(t,e){return d(setTimeout(a(t),e))},arguments)},t.wbg.__wbg_fetch_6a2624d7f767e331=function(t){return d(fetch(a(t)))},t.wbg.__wbg_fetch_693453ca3f88c055=function(t,e){return d(a(t).fetch(a(e)))},t.wbg.__wbg_new_7a20246daa6eec7e=function(){return C(function(){return d(new Headers)},arguments)},t.wbg.__wbg_append_aa3f462f9e2b5ff2=function(){return C(function(t,e,i,s,r){a(t).append(u(e,i),u(s,r))},arguments)},t.wbg.__wbg_newwithstrandinit_f581dff0d19a8b03=function(){return C(function(t,e,i){return d(new Request(u(t,e),a(i)))},arguments)},t.wbg.__wbg_signal_3c701f5f40a5f08d=function(t){return d(a(t).signal)},t.wbg.__wbg_new_0ae46f44b7485bb2=function(){return C(function(){return d(new AbortController)},arguments)},t.wbg.__wbg_abort_2c4fb490d878d2b2=function(t){a(t).abort()},t.wbg.__wbg_instanceof_Response_4c3b1446206114d1=function(t){let e;try{e=a(t)instanceof Response}catch(t){e=!1}return e},t.wbg.__wbg_url_83a6a4f65f7a2b38=function(t,e){const i=w(a(e).url,s.__wbindgen_export_0,s.__wbindgen_export_1),r=y;g()[t/4+1]=r,g()[t/4+0]=i},t.wbg.__wbg_status_d6d47ad2837621eb=function(t){return a(t).status},t.wbg.__wbg_headers_24def508a7518df9=function(t){return d(a(t).headers)},t.wbg.__wbg_arrayBuffer_5b2688e3dd873fed=function(){return C(function(t){return d(a(t).arrayBuffer())},arguments)},t.wbg.__wbg_queueMicrotask_481971b0d87f3dd4=function(t){queueMicrotask(a(t))},t.wbg.__wbg_queueMicrotask_3cbae2ec6b6cd3d6=function(t){return d(a(t).queueMicrotask)},t.wbg.__wbindgen_is_function=function(t){return"function"==typeof a(t)},t.wbg.__wbg_crypto_58f13aa23ffcb166=function(t){return d(a(t).crypto)},t.wbg.__wbg_process_5b786e71d465a513=function(t){return d(a(t).process)},t.wbg.__wbg_versions_c2ab80650590b6a2=function(t){return d(a(t).versions)},t.wbg.__wbg_node_523d7bd03ef69fba=function(t){return d(a(t).node)},t.wbg.__wbindgen_is_string=function(t){return"string"==typeof a(t)},t.wbg.__wbg_require_2784e593a4674877=function(){return C(function(){return d(module.require)},arguments)},t.wbg.__wbg_msCrypto_abcb1295e768d1f2=function(t){return d(a(t).msCrypto)},t.wbg.__wbg_randomFillSync_a0d98aa11c81fe89=function(){return C(function(t,e){a(t).randomFillSync(o(e))},arguments)},t.wbg.__wbg_getRandomValues_504510b5564925af=function(){return C(function(t,e){a(t).getRandomValues(a(e))},arguments)},t.wbg.__wbg_get_bd8e338fbd5f5cc8=function(t,e){return d(a(t)[e>>>0])},t.wbg.__wbg_length_cd7af8117672b8b8=function(t){return a(t).length},t.wbg.__wbg_new_16b304a2cfa7ff4a=function(){return d(new Array)},t.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(t,e){return d(new Function(u(t,e)))},t.wbg.__wbg_new_d9bc3a0147634640=function(){return d(new Map)},t.wbg.__wbg_next_40fc327bfc8770e6=function(t){return d(a(t).next)},t.wbg.__wbg_next_196c84450b364254=function(){return C(function(t){return d(a(t).next())},arguments)},t.wbg.__wbg_done_298b57d23c0fc80c=function(t){return a(t).done},t.wbg.__wbg_value_d93c65011f51a456=function(t){return d(a(t).value)},t.wbg.__wbg_iterator_2cee6dadfd956dfa=function(){return d(Symbol.iterator)},t.wbg.__wbg_get_e3c254076557e348=function(){return C(function(t,e){return d(Reflect.get(a(t),a(e)))},arguments)},t.wbg.__wbg_call_27c0f87801dedf93=function(){return C(function(t,e){return d(a(t).call(a(e)))},arguments)},t.wbg.__wbg_new_72fb9a18b5ae2624=function(){return d(new Object)},t.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return C(function(){return d(self.self)},arguments)},t.wbg.__wbg_window_c6fb939a7f436783=function(){return C(function(){return d(window.window)},arguments)},t.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return C(function(){return d(globalThis.globalThis)},arguments)},t.wbg.__wbg_global_207b558942527489=function(){return C(function(){return d(i.g.global)},arguments)},t.wbg.__wbg_set_d4638f722068f043=function(t,e,i){a(t)[e>>>0]=o(i)},t.wbg.__wbg_isArray_2ab64d95e09ea0ae=function(t){return Array.isArray(a(t))},t.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(t){let e;try{e=a(t)instanceof ArrayBuffer}catch(t){e=!1}return e},t.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return C(function(t,e,i){return d(a(t).call(a(e),a(i)))},arguments)},t.wbg.__wbg_set_8417257aaedc936b=function(t,e,i){return d(a(t).set(a(e),a(i)))},t.wbg.__wbg_isSafeInteger_f7b04ef02296c4d2=function(t){return Number.isSafeInteger(a(t))},t.wbg.__wbg_entries_95cc2c823b285a09=function(t){return d(Object.entries(a(t)))},t.wbg.__wbg_new_81740750da40724f=function(t,e){try{var i={a:t,b:e};const r=new Promise((t,e)=>{const r=i.a;i.a=0;try{return function(t,e,i,r){s.__wbindgen_export_7(t,e,d(i),d(r))}(r,i.b,t,e)}finally{i.a=r}});return d(r)}finally{i.a=i.b=0}},t.wbg.__wbg_resolve_b0083a7967828ec8=function(t){return d(Promise.resolve(a(t)))},t.wbg.__wbg_then_0c86a60e8fcfe9f6=function(t,e){return d(a(t).then(a(e)))},t.wbg.__wbg_then_a73caa9a87991566=function(t,e,i){return d(a(t).then(a(e),a(i)))},t.wbg.__wbg_buffer_12d079cc21e14bdb=function(t){return d(a(t).buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb=function(t,e,i){return d(new Uint8Array(a(t),e>>>0,i>>>0))},t.wbg.__wbg_new_63b92bc8671ed464=function(t){return d(new Uint8Array(a(t)))},t.wbg.__wbg_set_a47bac70306a19a7=function(t,e,i){a(t).set(a(e),i>>>0)},t.wbg.__wbg_length_c20a40f15020d68a=function(t){return a(t).length},t.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(t){let e;try{e=a(t)instanceof Uint8Array}catch(t){e=!1}return e},t.wbg.__wbg_newwithlength_e9b4878cebadb3d3=function(t){return d(new Uint8Array(t>>>0))},t.wbg.__wbg_subarray_a1f73cd4b5b42fe1=function(t,e,i){return d(a(t).subarray(e>>>0,i>>>0))},t.wbg.__wbg_has_0af94d20077affa2=function(){return C(function(t,e){return Reflect.has(a(t),a(e))},arguments)},t.wbg.__wbg_set_1f9b04f170055d33=function(){return C(function(t,e,i){return Reflect.set(a(t),a(e),a(i))},arguments)},t.wbg.__wbg_stringify_8887fe74e1c50d81=function(){return C(function(t){return d(JSON.stringify(a(t)))},arguments)},t.wbg.__wbindgen_bigint_get_as_i64=function(t,e){const i=a(e),r="bigint"==typeof i?i:void 0;(null!==S&&0!==S.byteLength||(S=new BigInt64Array(s.memory.buffer)),S)[t/8+1]=p(r)?BigInt(0):r,g()[t/4+0]=!p(r)},t.wbg.__wbindgen_debug_string=function(t,e){const i=w(k(a(e)),s.__wbindgen_export_0,s.__wbindgen_export_1),r=y;g()[t/4+1]=r,g()[t/4+0]=i},t.wbg.__wbindgen_throw=function(t,e){throw new Error(u(t,e))},t.wbg.__wbindgen_memory=function(){return d(s.memory)},t.wbg.__wbindgen_closure_wrapper3897=function(t,e,i){return d(T(t,e,699,P))},t.wbg.__wbindgen_closure_wrapper7350=function(t,e,i){return d(T(t,e,1724,_))},t}function ft(t,e){return s=t.exports,mt.__wbindgen_wasm_module=e,S=null,f=null,m=null,x=null,h=null,s}async function mt(t){if(void 0!==s)return s;void 0===t&&(t="https://qa.omni.apex.exchange/api/v3/download/zklink-sdk-web_bg.wasm");const e=pt();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:i,module:r}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const i=await t.arrayBuffer();return await WebAssembly.instantiate(i,e)}{const i=await WebAssembly.instantiate(t,e);return i instanceof WebAssembly.Instance?{instance:i,module:t}:i}}(await t,e);return ft(i,r)}const gt=mt},7757(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(9152),r=i(2079),a=i(5147),n=i(1579),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"bitget",name:"Bitget",countries:["SG"],version:"v2",rateLimit:50,certified:!0,pro:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!0,option:!1,addMargin:!0,borrowCrossMargin:!0,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,closeAllPositions:!0,closePosition:!0,createConvertTrade:!0,createDepositAddress:!1,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!1,createMarketSellOrderWithCost:!1,createOrder:!0,createOrders:!0,createOrderWithTakeProfitAndStopLoss:!0,createPostOnlyOrder:!0,createReduceOnlyOrder:!1,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTakeProfitOrder:!0,createTrailingAmountOrder:!1,createTrailingPercentOrder:!0,createTriggerOrder:!0,editOrder:!0,fetchAccounts:!1,fetchBalance:!0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchCanceledAndClosedOrders:!0,fetchCanceledOrders:!0,fetchClosedOrders:!0,fetchConvertCurrencies:!0,fetchConvertQuote:!0,fetchConvertTrade:!1,fetchConvertTradeHistory:!0,fetchCrossBorrowRate:!0,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:!1,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!1,fetchDeposits:!0,fetchDepositsWithdrawals:!1,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingInterval:!0,fetchFundingIntervals:!0,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!0,fetchIsolatedBorrowRates:!1,fetchLedger:!0,fetchLeverage:!0,fetchLeverageTiers:!1,fetchLiquidations:!1,fetchLongShortRatio:!1,fetchLongShortRatioHistory:!0,fetchMarginAdjustmentHistory:!1,fetchMarginMode:!0,fetchMarketLeverageTiers:!0,fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMarkPrice:!0,fetchMyLiquidations:!0,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!0,fetchOpenInterestHistory:!1,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:!1,fetchOrders:!1,fetchOrderTrades:!1,fetchPosition:!0,fetchPositionHistory:"emulated",fetchPositionMode:!1,fetchPositions:!0,fetchPositionsHistory:!0,fetchPositionsRisk:!1,fetchPremiumIndexOHLCV:!1,fetchStatus:!1,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactions:!1,fetchTransfer:!1,fetchTransfers:!0,fetchWithdrawAddresses:!1,fetchWithdrawal:!1,fetchWithdrawals:!0,reduceMargin:!0,repayCrossMargin:!0,repayIsolatedMargin:!0,setLeverage:!0,setMargin:!1,setMarginMode:!0,setPositionMode:!0,signIn:!1,transfer:!0,withdraw:!0},timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","12h":"12h","1d":"1d","3d":"3d","1w":"1w","1M":"1m"},hostname:"bitget.com",urls:{logo:"https://github.com/user-attachments/assets/fbaa10cc-a277-441d-a5b7-997dd9a87658",api:{spot:"https://api.{hostname}",mix:"https://api.{hostname}",user:"https://api.{hostname}",p2p:"https://api.{hostname}",broker:"https://api.{hostname}",margin:"https://api.{hostname}",common:"https://api.{hostname}",tax:"https://api.{hostname}",convert:"https://api.{hostname}",copy:"https://api.{hostname}",earn:"https://api.{hostname}",uta:"https://api.{hostname}"},www:"https://www.bitget.com",doc:["https://www.bitget.com/api-doc/common/intro","https://www.bitget.com/api-doc/spot/intro","https://www.bitget.com/api-doc/contract/intro","https://www.bitget.com/api-doc/broker/intro","https://www.bitget.com/api-doc/margin/intro","https://www.bitget.com/api-doc/copytrading/intro","https://www.bitget.com/api-doc/earn/intro","https://bitgetlimited.github.io/apidoc/en/mix","https://bitgetlimited.github.io/apidoc/en/spot","https://bitgetlimited.github.io/apidoc/en/broker","https://bitgetlimited.github.io/apidoc/en/margin"],fees:"https://www.bitget.cc/zh-CN/rate?tab=1",referral:"https://www.bitget.com/expressly?languageType=0&channelCode=ccxt&vipCode=tg9j"},api:{public:{common:{get:{"v2/public/annoucements":1,"v2/public/time":1}},spot:{get:{"spot/v1/notice/queryAllNotices":1,"spot/v1/public/time":1,"spot/v1/public/currencies":6.6667,"spot/v1/public/products":1,"spot/v1/public/product":1,"spot/v1/market/ticker":1,"spot/v1/market/tickers":1,"spot/v1/market/fills":2,"spot/v1/market/fills-history":2,"spot/v1/market/candles":1,"spot/v1/market/depth":1,"spot/v1/market/spot-vip-level":2,"spot/v1/market/merge-depth":1,"spot/v1/market/history-candles":1,"spot/v1/public/loan/coinInfos":2,"spot/v1/public/loan/hour-interest":2,"v2/spot/public/coins":6.6667,"v2/spot/public/symbols":1,"v2/spot/market/vip-fee-rate":2,"v2/spot/market/tickers":1,"v2/spot/market/merge-depth":1,"v2/spot/market/orderbook":1,"v2/spot/market/candles":1,"v2/spot/market/history-candles":1,"v2/spot/market/fills":2,"v2/spot/market/fills-history":2}},mix:{get:{"mix/v1/market/contracts":1,"mix/v1/market/depth":1,"mix/v1/market/ticker":1,"mix/v1/market/tickers":1,"mix/v1/market/contract-vip-level":2,"mix/v1/market/fills":1,"mix/v1/market/fills-history":2,"mix/v1/market/candles":1,"mix/v1/market/index":1,"mix/v1/market/funding-time":1,"mix/v1/market/history-fundRate":1,"mix/v1/market/current-fundRate":1,"mix/v1/market/open-interest":1,"mix/v1/market/mark-price":1,"mix/v1/market/symbol-leverage":1,"mix/v1/market/queryPositionLever":1,"mix/v1/market/open-limit":1,"mix/v1/market/history-candles":1,"mix/v1/market/history-index-candles":1,"mix/v1/market/history-mark-candles":1,"mix/v1/market/merge-depth":1,"v2/mix/market/vip-fee-rate":2,"v2/mix/market/union-interest-rate-history":4,"v2/mix/market/exchange-rate":4,"v2/mix/market/discount-rate":4,"v2/mix/market/merge-depth":1,"v2/mix/market/ticker":1,"v2/mix/market/tickers":1,"v2/mix/market/fills":1,"v2/mix/market/fills-history":2,"v2/mix/market/candles":1,"v2/mix/market/history-candles":1,"v2/mix/market/history-index-candles":1,"v2/mix/market/history-mark-candles":1,"v2/mix/market/open-interest":1,"v2/mix/market/funding-time":1,"v2/mix/market/symbol-price":1,"v2/mix/market/history-fund-rate":1,"v2/mix/market/current-fund-rate":1,"v2/mix/market/oi-limit":2,"v2/mix/market/contracts":1,"v2/mix/market/query-position-lever":2,"v2/mix/market/account-long-short":20}},margin:{get:{"margin/v1/cross/public/interestRateAndLimit":2,"margin/v1/isolated/public/interestRateAndLimit":2,"margin/v1/cross/public/tierData":2,"margin/v1/isolated/public/tierData":2,"margin/v1/public/currencies":1,"v2/margin/currencies":2,"v2/margin/market/long-short-ratio":20}},earn:{get:{"v2/earn/loan/public/coinInfos":2,"v2/earn/loan/public/hour-interest":2}},uta:{get:{"v3/market/instruments":1,"v3/market/tickers":1,"v3/market/orderbook":1,"v3/market/fills":1,"v3/market/open-interest":1,"v3/market/candles":1,"v3/market/history-candles":1,"v3/market/current-fund-rate":1,"v3/market/history-fund-rate":1,"v3/market/risk-reserve":1,"v3/market/discount-rate":1,"v3/market/margin-loans":1,"v3/market/position-tier":1,"v3/market/oi-limit":2}}},private:{spot:{get:{"spot/v1/wallet/deposit-address":4,"spot/v1/wallet/withdrawal-list":1,"spot/v1/wallet/deposit-list":1,"spot/v1/account/getInfo":20,"spot/v1/account/assets":2,"spot/v1/account/assets-lite":2,"spot/v1/account/transferRecords":1,"spot/v1/convert/currencies":2,"spot/v1/convert/convert-record":2,"spot/v1/loan/ongoing-orders":2,"spot/v1/loan/repay-history":2,"spot/v1/loan/revise-history":2,"spot/v1/loan/borrow-history":2,"spot/v1/loan/debts":2,"v2/spot/trade/orderInfo":1,"v2/spot/trade/unfilled-orders":1,"v2/spot/trade/history-orders":1,"v2/spot/trade/fills":2,"v2/spot/trade/current-plan-order":1,"v2/spot/trade/history-plan-order":1,"v2/spot/account/info":20,"v2/spot/account/assets":2,"v2/spot/account/subaccount-assets":2,"v2/spot/account/bills":2,"v2/spot/account/transferRecords":1,"v2/account/funding-assets":2,"v2/account/bot-assets":2,"v2/account/all-account-balance":20,"v2/spot/wallet/deposit-address":2,"v2/spot/wallet/deposit-records":2,"v2/spot/wallet/withdrawal-records":2},post:{"spot/v1/wallet/transfer":4,"spot/v1/wallet/transfer-v2":4,"spot/v1/wallet/subTransfer":10,"spot/v1/wallet/withdrawal":4,"spot/v1/wallet/withdrawal-v2":4,"spot/v1/wallet/withdrawal-inner":4,"spot/v1/wallet/withdrawal-inner-v2":4,"spot/v1/account/sub-account-spot-assets":200,"spot/v1/account/bills":2,"spot/v1/trade/orders":2,"spot/v1/trade/batch-orders":4,"spot/v1/trade/cancel-order":2,"spot/v1/trade/cancel-order-v2":2,"spot/v1/trade/cancel-symbol-order":2,"spot/v1/trade/cancel-batch-orders":4,"spot/v1/trade/cancel-batch-orders-v2":4,"spot/v1/trade/orderInfo":1,"spot/v1/trade/open-orders":1,"spot/v1/trade/history":1,"spot/v1/trade/fills":1,"spot/v1/plan/placePlan":1,"spot/v1/plan/modifyPlan":1,"spot/v1/plan/cancelPlan":1,"spot/v1/plan/currentPlan":1,"spot/v1/plan/historyPlan":1,"spot/v1/plan/batchCancelPlan":2,"spot/v1/convert/quoted-price":4,"spot/v1/convert/trade":4,"spot/v1/loan/borrow":2,"spot/v1/loan/repay":2,"spot/v1/loan/revise-pledge":2,"spot/v1/trace/order/orderCurrentList":2,"spot/v1/trace/order/orderHistoryList":2,"spot/v1/trace/order/closeTrackingOrder":2,"spot/v1/trace/order/updateTpsl":2,"spot/v1/trace/order/followerEndOrder":2,"spot/v1/trace/order/spotInfoList":2,"spot/v1/trace/config/getTraderSettings":2,"spot/v1/trace/config/getFollowerSettings":2,"spot/v1/trace/user/myTraders":2,"spot/v1/trace/config/setFollowerConfig":2,"spot/v1/trace/user/myFollowers":2,"spot/v1/trace/config/setProductCode":2,"spot/v1/trace/user/removeTrader":2,"spot/v1/trace/getRemovableFollower":2,"spot/v1/trace/user/removeFollower":2,"spot/v1/trace/profit/totalProfitInfo":2,"spot/v1/trace/profit/totalProfitList":2,"spot/v1/trace/profit/profitHisList":2,"spot/v1/trace/profit/profitHisDetailList":2,"spot/v1/trace/profit/waitProfitDetailList":2,"spot/v1/trace/user/getTraderInfo":2,"v2/spot/trade/place-order":2,"v2/spot/trade/cancel-order":2,"v2/spot/trade/batch-orders":20,"v2/spot/trade/batch-cancel-order":2,"v2/spot/trade/cancel-symbol-order":4,"v2/spot/trade/place-plan-order":1,"v2/spot/trade/modify-plan-order":1,"v2/spot/trade/cancel-plan-order":1,"v2/spot/trade/cancel-replace-order":2,"v2/spot/trade/batch-cancel-plan-order":2,"v2/spot/wallet/transfer":2,"v2/spot/wallet/subaccount-transfer":2,"v2/spot/wallet/withdrawal":2,"v2/spot/wallet/cancel-withdrawal":2,"v2/spot/wallet/modify-deposit-account":2}},mix:{get:{"mix/v1/account/account":2,"mix/v1/account/accounts":2,"mix/v1/position/singlePosition":2,"mix/v1/position/singlePosition-v2":2,"mix/v1/position/allPosition":4,"mix/v1/position/allPosition-v2":4,"mix/v1/position/history-position":1,"mix/v1/account/accountBill":2,"mix/v1/account/accountBusinessBill":4,"mix/v1/order/current":1,"mix/v1/order/marginCoinCurrent":1,"mix/v1/order/history":2,"mix/v1/order/historyProductType":4,"mix/v1/order/detail":2,"mix/v1/order/fills":2,"mix/v1/order/allFills":2,"mix/v1/plan/currentPlan":1,"mix/v1/plan/historyPlan":2,"mix/v1/trace/currentTrack":2,"mix/v1/trace/followerOrder":2,"mix/v1/trace/followerHistoryOrders":2,"mix/v1/trace/historyTrack":2,"mix/v1/trace/summary":1,"mix/v1/trace/profitSettleTokenIdGroup":1,"mix/v1/trace/profitDateGroupList":1,"mix/v1/trade/profitDateList":2,"mix/v1/trace/waitProfitDateList":1,"mix/v1/trace/traderSymbols":1,"mix/v1/trace/traderList":2,"mix/v1/trace/traderDetail":2,"mix/v1/trace/queryTraceConfig":2,"v2/mix/account/account":2,"v2/mix/account/accounts":2,"v2/mix/account/sub-account-assets":200,"v2/mix/account/interest-history":4,"v2/mix/account/max-open":1,"v2/mix/account/liq-price":1,"v2/mix/account/open-count":2,"v2/mix/account/bill":2,"v2/mix/account/transfer-limits":20,"v2/mix/account/union-config":20,"v2/mix/account/switch-union-usdt":20,"v2/mix/account/isolated-symbols":2,"v2/mix/market/query-position-lever":2,"v2/mix/position/single-position":2,"v2/mix/position/all-position":4,"v2/mix/position/adlRank":4,"v2/mix/position/history-position":1,"v2/mix/order/detail":2,"v2/mix/order/fills":2,"v2/mix/order/fill-history":2,"v2/mix/order/orders-pending":2,"v2/mix/order/orders-history":2,"v2/mix/order/plan-sub-order":2,"v2/mix/order/orders-plan-pending":2,"v2/mix/order/orders-plan-history":2,"v2/mix/market/position-long-short":20},post:{"mix/v1/account/sub-account-contract-assets":200,"mix/v1/account/open-count":1,"mix/v1/account/setLeverage":4,"mix/v1/account/setMargin":4,"mix/v1/account/setMarginMode":4,"mix/v1/account/setPositionMode":4,"mix/v1/order/placeOrder":2,"mix/v1/order/batch-orders":2,"mix/v1/order/cancel-order":2,"mix/v1/order/cancel-batch-orders":2,"mix/v1/order/modifyOrder":2,"mix/v1/order/cancel-symbol-orders":2,"mix/v1/order/cancel-all-orders":2,"mix/v1/order/close-all-positions":20,"mix/v1/plan/placePlan":2,"mix/v1/plan/modifyPlan":2,"mix/v1/plan/modifyPlanPreset":2,"mix/v1/plan/placeTPSL":2,"mix/v1/plan/placeTrailStop":2,"mix/v1/plan/placePositionsTPSL":2,"mix/v1/plan/modifyTPSLPlan":2,"mix/v1/plan/cancelPlan":2,"mix/v1/plan/cancelSymbolPlan":2,"mix/v1/plan/cancelAllPlan":2,"mix/v1/trace/closeTrackOrder":2,"mix/v1/trace/modifyTPSL":2,"mix/v1/trace/closeTrackOrderBySymbol":2,"mix/v1/trace/setUpCopySymbols":2,"mix/v1/trace/followerSetBatchTraceConfig":2,"mix/v1/trace/followerCloseByTrackingNo":2,"mix/v1/trace/followerCloseByAll":2,"mix/v1/trace/followerSetTpsl":2,"mix/v1/trace/cancelCopyTrader":4,"mix/v1/trace/traderUpdateConfig":2,"mix/v1/trace/myTraderList":2,"mix/v1/trace/myFollowerList":2,"mix/v1/trace/removeFollower":2,"mix/v1/trace/public/getFollowerConfig":2,"mix/v1/trace/report/order/historyList":2,"mix/v1/trace/report/order/currentList":2,"mix/v1/trace/queryTraderTpslRatioConfig":2,"mix/v1/trace/traderUpdateTpslRatioConfig":2,"v2/mix/account/set-auto-margin":4,"v2/mix/account/set-leverage":4,"v2/mix/account/set-all-leverage":4,"v2/mix/account/set-margin":4,"v2/mix/account/set-asset-mode":10,"v2/mix/account/set-margin-mode":4,"v2/mix/account/union-convert":20,"v2/mix/account/set-position-mode":4,"v2/mix/order/place-order":2,"v2/mix/order/click-backhand":20,"v2/mix/order/batch-place-order":20,"v2/mix/order/modify-order":2,"v2/mix/order/cancel-order":2,"v2/mix/order/batch-cancel-orders":2,"v2/mix/order/close-positions":20,"v2/mix/order/cancel-all-orders":20,"v2/mix/order/place-tpsl-order":2,"v2/mix/order/place-pos-tpsl":2,"v2/mix/order/place-plan-order":2,"v2/mix/order/modify-tpsl-order":2,"v2/mix/order/modify-plan-order":2,"v2/mix/order/cancel-plan-order":2}},user:{get:{"user/v1/fee/query":2,"user/v1/sub/virtual-list":2,"user/v1/sub/virtual-api-list":2,"user/v1/tax/spot-record":1,"user/v1/tax/future-record":1,"user/v1/tax/margin-record":1,"user/v1/tax/p2p-record":1,"v2/user/virtual-subaccount-list":2,"v2/user/virtual-subaccount-apikey-list":2},post:{"user/v1/sub/virtual-create":4,"user/v1/sub/virtual-modify":4,"user/v1/sub/virtual-api-batch-create":20,"user/v1/sub/virtual-api-create":4,"user/v1/sub/virtual-api-modify":4,"v2/user/create-virtual-subaccount":4,"v2/user/modify-virtual-subaccount":4,"v2/user/batch-create-subaccount-and-apikey":20,"v2/user/create-virtual-subaccount-apikey":4,"v2/user/modify-virtual-subaccount-apikey":4}},p2p:{get:{"p2p/v1/merchant/merchantList":2,"p2p/v1/merchant/merchantInfo":2,"p2p/v1/merchant/advList":2,"p2p/v1/merchant/orderList":2,"v2/p2p/merchantList":2,"v2/p2p/merchantInfo":2,"v2/p2p/orderList":2,"v2/p2p/advList":2}},broker:{get:{"broker/v1/account/info":2,"broker/v1/account/sub-list":20,"broker/v1/account/sub-email":20,"broker/v1/account/sub-spot-assets":2,"broker/v1/account/sub-future-assets":2,"broker/v1/account/subaccount-transfer":1,"broker/v1/account/subaccount-deposit":1,"broker/v1/account/subaccount-withdrawal":1,"broker/v1/account/sub-api-list":2,"v2/broker/account/info":2,"v2/broker/account/subaccount-list":20,"v2/broker/account/subaccount-email":2,"v2/broker/account/subaccount-spot-assets":2,"v2/broker/account/subaccount-future-assets":2,"v2/broker/manage/subaccount-apikey-list":2},post:{"broker/v1/account/sub-create":20,"broker/v1/account/sub-modify":20,"broker/v1/account/sub-modify-email":20,"broker/v1/account/sub-address":2,"broker/v1/account/sub-withdrawal":2,"broker/v1/account/sub-auto-transfer":4,"broker/v1/account/sub-api-create":2,"broker/v1/account/sub-api-modify":2,"v2/broker/account/modify-subaccount-email":2,"v2/broker/account/create-subaccount":20,"v2/broker/account/modify-subaccount":20,"v2/broker/account/subaccount-address":2,"v2/broker/account/subaccount-withdrawal":2,"v2/broker/account/set-subaccount-autotransfer":2,"v2/broker/manage/create-subaccount-apikey":2,"v2/broker/manage/modify-subaccount-apikey":2}},margin:{get:{"margin/v1/cross/account/riskRate":2,"margin/v1/cross/account/maxTransferOutAmount":2,"margin/v1/isolated/account/maxTransferOutAmount":2,"margin/v1/isolated/order/openOrders":2,"margin/v1/isolated/order/history":2,"margin/v1/isolated/order/fills":2,"margin/v1/isolated/loan/list":2,"margin/v1/isolated/repay/list":2,"margin/v1/isolated/interest/list":2,"margin/v1/isolated/liquidation/list":2,"margin/v1/isolated/fin/list":2,"margin/v1/cross/order/openOrders":2,"margin/v1/cross/order/history":2,"margin/v1/cross/order/fills":2,"margin/v1/cross/loan/list":2,"margin/v1/cross/repay/list":2,"margin/v1/cross/interest/list":2,"margin/v1/cross/liquidation/list":2,"margin/v1/cross/fin/list":2,"margin/v1/cross/account/assets":2,"margin/v1/isolated/account/assets":2,"v2/margin/crossed/borrow-history":2,"v2/margin/crossed/repay-history":2,"v2/margin/crossed/interest-history":2,"v2/margin/crossed/liquidation-history":2,"v2/margin/crossed/financial-records":2,"v2/margin/crossed/account/assets":2,"v2/margin/crossed/account/risk-rate":2,"v2/margin/crossed/account/max-borrowable-amount":2,"v2/margin/crossed/account/max-transfer-out-amount":2,"v2/margin/crossed/interest-rate-and-limit":2,"v2/margin/crossed/tier-data":2,"v2/margin/crossed/open-orders":2,"v2/margin/crossed/history-orders":2,"v2/margin/crossed/fills":2,"v2/margin/isolated/borrow-history":2,"v2/margin/isolated/repay-history":2,"v2/margin/isolated/interest-history":2,"v2/margin/isolated/liquidation-history":2,"v2/margin/isolated/financial-records":2,"v2/margin/isolated/account/assets":2,"v2/margin/isolated/account/risk-rate":2,"v2/margin/isolated/account/max-borrowable-amount":2,"v2/margin/isolated/account/max-transfer-out-amount":2,"v2/margin/isolated/interest-rate-and-limit":2,"v2/margin/isolated/tier-data":2,"v2/margin/isolated/open-orders":2,"v2/margin/isolated/history-orders":2,"v2/margin/isolated/fills":2},post:{"margin/v1/cross/account/borrow":2,"margin/v1/isolated/account/borrow":2,"margin/v1/cross/account/repay":2,"margin/v1/isolated/account/repay":2,"margin/v1/isolated/account/riskRate":2,"margin/v1/cross/account/maxBorrowableAmount":2,"margin/v1/isolated/account/maxBorrowableAmount":2,"margin/v1/isolated/account/flashRepay":2,"margin/v1/isolated/account/queryFlashRepayStatus":2,"margin/v1/cross/account/flashRepay":2,"margin/v1/cross/account/queryFlashRepayStatus":2,"margin/v1/isolated/order/placeOrder":4,"margin/v1/isolated/order/batchPlaceOrder":4,"margin/v1/isolated/order/cancelOrder":2,"margin/v1/isolated/order/batchCancelOrder":2,"margin/v1/cross/order/placeOrder":2,"margin/v1/cross/order/batchPlaceOrder":2,"margin/v1/cross/order/cancelOrder":2,"margin/v1/cross/order/batchCancelOrder":2,"v2/margin/crossed/account/borrow":2,"v2/margin/crossed/account/repay":2,"v2/margin/crossed/account/flash-repay":2,"v2/margin/crossed/account/query-flash-repay-status":2,"v2/margin/crossed/place-order":2,"v2/margin/crossed/batch-place-order":2,"v2/margin/crossed/cancel-order":2,"v2/margin/crossed/batch-cancel-order":2,"v2/margin/isolated/account/borrow":2,"v2/margin/isolated/account/repay":2,"v2/margin/isolated/account/flash-repay":2,"v2/margin/isolated/account/query-flash-repay-status":2,"v2/margin/isolated/place-order":2,"v2/margin/isolated/batch-place-order":2,"v2/margin/isolated/cancel-order":2,"v2/margin/isolated/batch-cancel-order":2}},copy:{get:{"v2/copy/mix-trader/order-current-track":2,"v2/copy/mix-trader/order-history-track":2,"v2/copy/mix-trader/order-total-detail":2,"v2/copy/mix-trader/profit-history-summarys":1,"v2/copy/mix-trader/profit-history-details":1,"v2/copy/mix-trader/profit-details":1,"v2/copy/mix-trader/profits-group-coin-date":1,"v2/copy/mix-trader/config-query-symbols":1,"v2/copy/mix-trader/config-query-followers":2,"v2/copy/mix-follower/query-current-orders":2,"v2/copy/mix-follower/query-history-orders":1,"v2/copy/mix-follower/query-settings":2,"v2/copy/mix-follower/query-traders":2,"v2/copy/mix-follower/query-quantity-limit":2,"v2/copy/mix-broker/query-traders":2,"v2/copy/mix-broker/query-history-traces":2,"v2/copy/mix-broker/query-current-traces":2,"v2/copy/spot-trader/profit-summarys":2,"v2/copy/spot-trader/profit-history-details":2,"v2/copy/spot-trader/profit-details":2,"v2/copy/spot-trader/order-total-detail":2,"v2/copy/spot-trader/order-history-track":2,"v2/copy/spot-trader/order-current-track":2,"v2/copy/spot-trader/config-query-settings":2,"v2/copy/spot-trader/config-query-followers":2,"v2/copy/spot-follower/query-traders":2,"v2/copy/spot-follower/query-trader-symbols":2,"v2/copy/spot-follower/query-settings":2,"v2/copy/spot-follower/query-history-orders":2,"v2/copy/spot-follower/query-current-orders":2},post:{"v2/copy/mix-trader/order-modify-tpsl":2,"v2/copy/mix-trader/order-close-positions":2,"v2/copy/mix-trader/config-setting-symbols":2,"v2/copy/mix-trader/config-setting-base":2,"v2/copy/mix-trader/config-remove-follower":2,"v2/copy/mix-follower/setting-tpsl":1,"v2/copy/mix-follower/settings":2,"v2/copy/mix-follower/close-positions":2,"v2/copy/mix-follower/cancel-trader":4,"v2/copy/spot-trader/order-modify-tpsl":2,"v2/copy/spot-trader/order-close-tracking":2,"v2/copy/spot-trader/config-setting-symbols":2,"v2/copy/spot-trader/config-remove-follower":2,"v2/copy/spot-follower/stop-order":2,"v2/copy/spot-follower/settings":2,"v2/copy/spot-follower/setting-tpsl":2,"v2/copy/spot-follower/order-close-tracking":2,"v2/copy/spot-follower/cancel-trader":2}},tax:{get:{"v2/tax/spot-record":20,"v2/tax/future-record":20,"v2/tax/margin-record":20,"v2/tax/p2p-record":20}},convert:{get:{"v2/convert/currencies":2,"v2/convert/quoted-price":2,"v2/convert/convert-record":2,"v2/convert/bgb-convert-coin-list":2,"v2/convert/bgb-convert-records":2},post:{"v2/convert/trade":2,"v2/convert/bgb-convert":2}},earn:{get:{"v2/earn/savings/product":2,"v2/earn/savings/account":2,"v2/earn/savings/assets":2,"v2/earn/savings/records":2,"v2/earn/savings/subscribe-info":2,"v2/earn/savings/subscribe-result":2,"v2/earn/savings/redeem-result":2,"v2/earn/sharkfin/product":2,"v2/earn/sharkfin/account":2,"v2/earn/sharkfin/assets":2,"v2/earn/sharkfin/records":2,"v2/earn/sharkfin/subscribe-info":2,"v2/earn/sharkfin/subscribe-result":4,"v2/earn/loan/ongoing-orders":2,"v2/earn/loan/repay-history":2,"v2/earn/loan/revise-history":2,"v2/earn/loan/borrow-history":2,"v2/earn/loan/debts":2,"v2/earn/loan/reduces":2,"v2/earn/account/assets":2},post:{"v2/earn/savings/subscribe":2,"v2/earn/savings/redeem":2,"v2/earn/sharkfin/subscribe":2,"v2/earn/loan/borrow":2,"v2/earn/loan/repay":2,"v2/earn/loan/revise-pledge":2}},common:{get:{"v2/common/trade-rate":2}},uta:{get:{"v3/account/assets":1,"v3/account/settings":1,"v3/account/deposit-records":2,"v3/account/financial-records":1,"v3/account/repayable-coins":2,"v3/account/payment-coins":2,"v3/account/convert-records":1,"v3/account/transferable-coins":2,"v3/account/sub-transfer-record":4,"v3/ins-loan/transfered":6.6667,"v3/ins-loan/symbols":6.6667,"v3/ins-loan/risk-unit":6.6667,"v3/ins-loan/repaid-history":6.6667,"v3/ins-loan/product-infos":6.6667,"v3/ins-loan/loan-order":6.6667,"v3/ins-loan/ltv-convert":6.6667,"v3/ins-loan/ensure-coins-convert":6.6667,"v3/position/current-position":1,"v3/position/history-position":1,"v3/trade/order-info":1,"v3/trade/unfilled-orders":1,"v3/trade/unfilled-strategy-orders":1,"v3/trade/history-orders":1,"v3/trade/history-strategy-orders":1,"v3/trade/fills":1,"v3/user/sub-list":2,"v3/user/sub-api-list":2},post:{"v3/account/set-leverage":2,"v3/account/set-hold-mode":2,"v3/account/repay":4,"v3/account/transfer":4,"v3/account/sub-transfer":4,"v3/account/max-open-available":4,"v3/ins-loan/bind-uid":6.6667,"v3/trade/place-order":2,"v3/trade/place-strategy-order":2,"v3/trade/modify-order":2,"v3/trade/modify-strategy-order":2,"v3/trade/cancel-order":2,"v3/trade/cancel-strategy-order":2,"v3/trade/place-batch":4,"v3/trade/batch-modify-order":2,"v3/trade/cancel-batch":4,"v3/trade/cancel-symbol-order":4,"v3/trade/close-positions":4,"v3/user/create-sub":2,"v3/user/freeze-sub":2,"v3/user/create-sub-api":2,"v3/user/update-sub-api":2,"v3/user/delete-sub-api":2}}}},fees:{spot:{taker:this.parseNumber("0.002"),maker:this.parseNumber("0.002")},swap:{taker:this.parseNumber("0.0006"),maker:this.parseNumber("0.0004")}},requiredCredentials:{apiKey:!0,secret:!0,password:!0},exceptions:{exact:{1:r.ExchangeError,"failure to get a peer from the ring-balancer":r.ExchangeNotAvailable,4010:r.PermissionDenied,4001:r.ExchangeError,4002:r.ExchangeError,40020:r.BadRequest,30001:r.AuthenticationError,30002:r.AuthenticationError,30003:r.AuthenticationError,30004:r.AuthenticationError,30005:r.InvalidNonce,30006:r.AuthenticationError,30007:r.BadRequest,30008:r.RequestTimeout,30009:r.ExchangeError,30010:r.AuthenticationError,30011:r.PermissionDenied,30012:r.AuthenticationError,30013:r.AuthenticationError,30014:r.DDoSProtection,30015:r.AuthenticationError,30016:r.ExchangeError,30017:r.ExchangeError,30018:r.ExchangeError,30019:r.ExchangeNotAvailable,30020:r.BadRequest,30021:r.BadRequest,30022:r.PermissionDenied,30023:r.BadRequest,30024:r.BadSymbol,30025:r.BadRequest,30026:r.DDoSProtection,30027:r.AuthenticationError,30028:r.PermissionDenied,30029:r.AccountSuspended,30030:r.ExchangeError,30031:r.BadRequest,30032:r.BadSymbol,30033:r.BadRequest,30034:r.ExchangeError,30035:r.ExchangeError,30036:r.ExchangeError,30037:r.ExchangeNotAvailable,30038:r.OnMaintenance,32001:r.AccountSuspended,32002:r.PermissionDenied,32003:r.CancelPending,32004:r.ExchangeError,32005:r.InvalidOrder,32006:r.InvalidOrder,32007:r.InvalidOrder,32008:r.InvalidOrder,32009:r.InvalidOrder,32010:r.ExchangeError,32011:r.ExchangeError,32012:r.ExchangeError,32013:r.ExchangeError,32014:r.ExchangeError,32015:r.ExchangeError,32016:r.ExchangeError,32017:r.ExchangeError,32018:r.ExchangeError,32019:r.ExchangeError,32020:r.ExchangeError,32021:r.ExchangeError,32022:r.ExchangeError,32023:r.ExchangeError,32024:r.ExchangeError,32025:r.ExchangeError,32026:r.ExchangeError,32027:r.ExchangeError,32028:r.AccountSuspended,32029:r.ExchangeError,32030:r.InvalidOrder,32031:r.ArgumentsRequired,32038:r.AuthenticationError,32040:r.ExchangeError,32044:r.ExchangeError,32045:r.ExchangeError,32046:r.ExchangeError,32047:r.ExchangeError,32048:r.InvalidOrder,32049:r.ExchangeError,32050:r.InvalidOrder,32051:r.InvalidOrder,32052:r.ExchangeError,32053:r.ExchangeError,32057:r.ExchangeError,32054:r.ExchangeError,32055:r.InvalidOrder,32056:r.ExchangeError,32058:r.ExchangeError,32059:r.InvalidOrder,32060:r.InvalidOrder,32061:r.InvalidOrder,32062:r.InvalidOrder,32063:r.InvalidOrder,32064:r.ExchangeError,32065:r.ExchangeError,32066:r.ExchangeError,32067:r.ExchangeError,32068:r.ExchangeError,32069:r.ExchangeError,32070:r.ExchangeError,32071:r.ExchangeError,32072:r.ExchangeError,32073:r.ExchangeError,32074:r.ExchangeError,32075:r.ExchangeError,32076:r.ExchangeError,32077:r.ExchangeError,32078:r.ExchangeError,32079:r.ExchangeError,32080:r.ExchangeError,32083:r.ExchangeError,33001:r.PermissionDenied,33002:r.AccountSuspended,33003:r.InsufficientFunds,33004:r.ExchangeError,33005:r.ExchangeError,33006:r.ExchangeError,33007:r.ExchangeError,33008:r.InsufficientFunds,33009:r.ExchangeError,33010:r.ExchangeError,33011:r.ExchangeError,33012:r.ExchangeError,33013:r.InvalidOrder,33014:r.OrderNotFound,33015:r.InvalidOrder,33016:r.ExchangeError,33017:r.InsufficientFunds,33018:r.ExchangeError,33020:r.ExchangeError,33021:r.BadRequest,33022:r.InvalidOrder,33023:r.ExchangeError,33024:r.InvalidOrder,33025:r.InvalidOrder,33026:r.ExchangeError,33027:r.InvalidOrder,33028:r.InvalidOrder,33029:r.InvalidOrder,33034:r.ExchangeError,33035:r.ExchangeError,33036:r.ExchangeError,33037:r.ExchangeError,33038:r.ExchangeError,33039:r.ExchangeError,33040:r.ExchangeError,33041:r.ExchangeError,33042:r.ExchangeError,33043:r.ExchangeError,33044:r.ExchangeError,33045:r.ExchangeError,33046:r.ExchangeError,33047:r.ExchangeError,33048:r.ExchangeError,33049:r.ExchangeError,33050:r.ExchangeError,33051:r.ExchangeError,33059:r.BadRequest,33060:r.BadRequest,33061:r.ExchangeError,33062:r.ExchangeError,33063:r.ExchangeError,33064:r.ExchangeError,33065:r.ExchangeError,21009:r.ExchangeError,34001:r.PermissionDenied,34002:r.InvalidAddress,34003:r.ExchangeError,34004:r.ExchangeError,34005:r.ExchangeError,34006:r.ExchangeError,34007:r.ExchangeError,34008:r.InsufficientFunds,34009:r.ExchangeError,34010:r.ExchangeError,34011:r.ExchangeError,34012:r.ExchangeError,34013:r.ExchangeError,34014:r.ExchangeError,34015:r.ExchangeError,34016:r.PermissionDenied,34017:r.AccountSuspended,34018:r.AuthenticationError,34019:r.PermissionDenied,34020:r.PermissionDenied,34021:r.InvalidAddress,34022:r.ExchangeError,34023:r.PermissionDenied,34026:r.ExchangeError,34036:r.ExchangeError,34037:r.ExchangeError,34038:r.ExchangeError,34039:r.ExchangeError,35001:r.ExchangeError,35002:r.ExchangeError,35003:r.ExchangeError,35004:r.ExchangeError,35005:r.AuthenticationError,35008:r.InvalidOrder,35010:r.InvalidOrder,35012:r.InvalidOrder,35014:r.InvalidOrder,35015:r.InvalidOrder,35017:r.ExchangeError,35019:r.InvalidOrder,35020:r.InvalidOrder,35021:r.InvalidOrder,35022:r.ExchangeError,35024:r.ExchangeError,35025:r.InsufficientFunds,35026:r.ExchangeError,35029:r.OrderNotFound,35030:r.InvalidOrder,35031:r.InvalidOrder,35032:r.ExchangeError,35037:r.ExchangeError,35039:r.ExchangeError,35040:r.InvalidOrder,35044:r.ExchangeError,35046:r.InsufficientFunds,35047:r.InsufficientFunds,35048:r.ExchangeError,35049:r.InvalidOrder,35050:r.InvalidOrder,35052:r.InsufficientFunds,35053:r.ExchangeError,35055:r.InsufficientFunds,35057:r.ExchangeError,35058:r.ExchangeError,35059:r.BadRequest,35060:r.BadRequest,35061:r.BadRequest,35062:r.InvalidOrder,35063:r.InvalidOrder,35064:r.InvalidOrder,35066:r.InvalidOrder,35067:r.InvalidOrder,35068:r.InvalidOrder,35069:r.InvalidOrder,35070:r.InvalidOrder,35071:r.InvalidOrder,35072:r.InvalidOrder,35073:r.InvalidOrder,35074:r.InvalidOrder,35075:r.InvalidOrder,35076:r.InvalidOrder,35077:r.InvalidOrder,35078:r.InvalidOrder,35079:r.InvalidOrder,35080:r.InvalidOrder,35081:r.InvalidOrder,35082:r.InvalidOrder,35083:r.InvalidOrder,35084:r.InvalidOrder,35085:r.InvalidOrder,35086:r.InvalidOrder,35087:r.InvalidOrder,35088:r.InvalidOrder,35089:r.InvalidOrder,35090:r.ExchangeError,35091:r.ExchangeError,35092:r.ExchangeError,35093:r.ExchangeError,35094:r.ExchangeError,35095:r.BadRequest,35096:r.ExchangeError,35097:r.ExchangeError,35098:r.ExchangeError,35099:r.ExchangeError,36001:r.BadRequest,36002:r.BadRequest,36005:r.ExchangeError,36101:r.AuthenticationError,36102:r.PermissionDenied,36103:r.AccountSuspended,36104:r.PermissionDenied,36105:r.PermissionDenied,36106:r.AccountSuspended,36107:r.PermissionDenied,36108:r.InsufficientFunds,36109:r.PermissionDenied,36201:r.PermissionDenied,36202:r.PermissionDenied,36203:r.InvalidOrder,36204:r.ExchangeError,36205:r.BadRequest,36206:r.BadRequest,36207:r.InvalidOrder,36208:r.InvalidOrder,36209:r.InvalidOrder,36210:r.InvalidOrder,36211:r.InvalidOrder,36212:r.InvalidOrder,36213:r.InvalidOrder,36214:r.ExchangeError,36216:r.OrderNotFound,36217:r.InvalidOrder,36218:r.InvalidOrder,36219:r.InvalidOrder,36220:r.InvalidOrder,36221:r.InvalidOrder,36222:r.InvalidOrder,36223:r.InvalidOrder,36224:r.InvalidOrder,36225:r.InvalidOrder,36226:r.InvalidOrder,36227:r.InvalidOrder,36228:r.InvalidOrder,36229:r.InvalidOrder,36230:r.InvalidOrder,400:r.BadRequest,401:r.AuthenticationError,403:r.PermissionDenied,404:r.BadRequest,405:r.BadRequest,415:r.BadRequest,429:r.DDoSProtection,500:r.ExchangeNotAvailable,1001:r.RateLimitExceeded,1002:r.ExchangeError,1003:r.ExchangeError,40001:r.AuthenticationError,40002:r.AuthenticationError,40003:r.AuthenticationError,40004:r.InvalidNonce,40005:r.InvalidNonce,40006:r.AuthenticationError,40007:r.BadRequest,40008:r.InvalidNonce,40009:r.AuthenticationError,40010:r.AuthenticationError,40011:r.AuthenticationError,40012:r.AuthenticationError,40013:r.ExchangeError,40014:r.PermissionDenied,40015:r.ExchangeError,40016:r.PermissionDenied,40017:r.ExchangeError,40018:r.PermissionDenied,40019:r.BadRequest,40031:r.AccountSuspended,40037:r.AuthenticationError,40102:r.BadRequest,40103:r.BadRequest,40104:r.ExchangeError,40105:r.ExchangeError,40106:r.ExchangeError,40107:r.ExchangeError,40108:r.InvalidOrder,40109:r.OrderNotFound,40200:r.OnMaintenance,40201:r.InvalidOrder,40202:r.ExchangeError,40203:r.BadRequest,40204:r.BadRequest,40205:r.BadRequest,40206:r.BadRequest,40207:r.BadRequest,40208:r.BadRequest,40209:r.BadRequest,40300:r.ExchangeError,40301:r.PermissionDenied,40302:r.BadRequest,40303:r.BadRequest,40304:r.BadRequest,40305:r.BadRequest,40306:r.ExchangeError,40308:r.OnMaintenance,40309:r.BadSymbol,40400:r.ExchangeError,40401:r.ExchangeError,40402:r.BadRequest,40403:r.BadRequest,40404:r.BadRequest,40405:r.BadRequest,40406:r.BadRequest,40407:r.ExchangeError,40408:r.ExchangeError,40409:r.ExchangeError,40500:r.InvalidOrder,40501:r.ExchangeError,40502:r.ExchangeError,40503:r.ExchangeError,40504:r.ExchangeError,40505:r.ExchangeError,40506:r.AuthenticationError,40507:r.AuthenticationError,40508:r.ExchangeError,40509:r.ExchangeError,40600:r.ExchangeError,40601:r.ExchangeError,40602:r.ExchangeError,40603:r.ExchangeError,40604:r.ExchangeNotAvailable,40605:r.ExchangeError,40606:r.ExchangeError,40607:r.ExchangeError,40608:r.ExchangeError,40609:r.ExchangeError,40700:r.BadRequest,40701:r.ExchangeError,40702:r.ExchangeError,40703:r.ExchangeError,40704:r.ExchangeError,40705:r.BadRequest,40706:r.InvalidOrder,40707:r.BadRequest,40708:r.BadRequest,40709:r.ExchangeError,40710:r.ExchangeError,40711:r.InsufficientFunds,40712:r.InsufficientFunds,40713:r.ExchangeError,40714:r.ExchangeError,40762:r.InsufficientFunds,40768:r.OrderNotFound,40808:r.InvalidOrder,41103:r.InvalidOrder,41114:r.OnMaintenance,43011:r.InvalidOrder,43001:r.OrderNotFound,43012:r.InsufficientFunds,43025:r.InvalidOrder,43115:r.OnMaintenance,45110:r.InvalidOrder,40774:r.InvalidOrder,45122:r.InvalidOrder,"invalid sign":r.AuthenticationError,"invalid currency":r.BadSymbol,"invalid symbol":r.BadSymbol,"invalid period":r.BadRequest,"invalid user":r.ExchangeError,"invalid amount":r.InvalidOrder,"invalid type":r.InvalidOrder,"invalid orderId":r.InvalidOrder,"invalid record":r.ExchangeError,"invalid accountId":r.BadRequest,"invalid address":r.BadRequest,"accesskey not null":r.AuthenticationError,"illegal accesskey":r.AuthenticationError,"sign not null":r.AuthenticationError,"req_time is too much difference from server time":r.InvalidNonce,"permissions not right":r.PermissionDenied,"illegal sign invalid":r.AuthenticationError,"user locked":r.AccountSuspended,"Request Frequency Is Too High":r.RateLimitExceeded,"more than a daily rate of cash":r.BadRequest,"more than the maximum daily withdrawal amount":r.BadRequest,"need to bind email or mobile":r.ExchangeError,"user forbid":r.PermissionDenied,"User Prohibited Cash Withdrawal":r.PermissionDenied,"Cash Withdrawal Is Less Than The Minimum Value":r.BadRequest,"Cash Withdrawal Is More Than The Maximum Value":r.BadRequest,"the account with in 24 hours ban coin":r.PermissionDenied,"order cancel fail":r.BadRequest,"base symbol error":r.BadSymbol,"base date error":r.ExchangeError,"api signature not valid":r.AuthenticationError,"gateway internal error":r.ExchangeError,"audit failed":r.ExchangeError,"order queryorder invalid":r.BadRequest,"market no need price":r.InvalidOrder,"limit need price":r.InvalidOrder,"userid not equal to account_id":r.ExchangeError,"your balance is low":r.InsufficientFunds,"address invalid cointype":r.ExchangeError,"system exception":r.ExchangeError,50003:r.ExchangeError,50004:r.BadSymbol,50006:r.PermissionDenied,50007:r.PermissionDenied,50008:r.RequestTimeout,50009:r.RateLimitExceeded,50010:r.ExchangeError,50014:r.InvalidOrder,50015:r.InvalidOrder,50016:r.InvalidOrder,50017:r.InvalidOrder,50018:r.InvalidOrder,50019:r.InvalidOrder,50020:r.InsufficientFunds,50021:r.InvalidOrder,50026:r.InvalidOrder,"invalid order query time":r.ExchangeError,"invalid start time":r.BadRequest,"invalid end time":r.BadRequest,20003:r.ExchangeError,"01001":r.ExchangeError,40024:r.RestrictedLocation,43111:r.PermissionDenied},broad:{"invalid size, valid range":r.ExchangeError}},precisionMode:n.kb,commonCurrencies:{APX:"AstroPepeX",DEGEN:"DegenReborn",EVA:"Evadore",JADE:"Jade Protocol",OMNI:"omni",TONCOIN:"TON"},options:{uta:!1,timeDifference:0,adjustForTimeDifference:!1,timeframes:{spot:{"1m":"1min","5m":"5min","3m":"3min","15m":"15min","30m":"30min","1h":"1h","4h":"4h","6h":"6Hutc","12h":"12Hutc","1d":"1Dutc","3d":"3Dutc","1w":"1Wutc","1M":"1Mutc"},swap:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1H","2h":"2H","4h":"4H","6h":"6Hutc","12h":"12Hutc","1d":"1Dutc","3d":"3Dutc","1w":"1Wutc","1M":"1Mutc"},uta:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1H","2h":"2H","4h":"4H","6h":"6H","12h":"12H","1d":"1D"}},fetchMarkets:{types:["spot","swap"]},defaultType:"spot",defaultSubType:"linear",createMarketBuyOrderRequiresPrice:!0,broker:"p4sve",withdraw:{fillResponseFromRequest:!0},fetchOHLCV:{maxRecentDaysPerTimeframe:{"1m":30,"3m":30,"5m":30,"15m":30,"30m":30,"1h":60,"2h":120,"4h":240,"6h":360,"12h":720,"1d":1440,"3d":4320,"1w":10080,"1M":43200},spot:{maxLimitPerTimeframe:{"1d":300,"3d":100,"1w":100,"1M":100},method:"publicSpotGetV2SpotMarketCandles"},swap:{maxLimitPerTimeframe:{"4h":540,"6h":360,"12h":180,"1d":90,"3d":30,"1w":13,"1M":4},method:"publicMixGetV2MixMarketCandles"}},fetchTrades:{spot:{method:"publicSpotGetV2SpotMarketFillsHistory"},swap:{method:"publicMixGetV2MixMarketFillsHistory"}},fetchFundingRate:{method:"publicMixGetV2MixMarketCurrentFundRate"},accountsByType:{spot:"spot",cross:"crossed_margin",isolated:"isolated_margin",swap:"usdt_futures",usdc_swap:"usdc_futures",future:"coin_futures",p2p:"p2p"},accountsById:{spot:"spot",crossed_margin:"cross",isolated_margin:"isolated",usdt_futures:"swap",usdc_futures:"usdc_swap",coin_futures:"future",p2p:"p2p"},sandboxMode:!1,networks:{TRC20:"TRC20",ERC20:"ERC20",BEP20:"BSC",ATOM:"ATOM",ACA:"AcalaToken",APT:"Aptos",ARBONE:"ArbitrumOne",ARBNOVA:"ArbitrumNova",AVAXC:"C-Chain",AVAXX:"X-Chain",AR:"Arweave",BCH:"BCH",BCHA:"BCHA",BITCI:"BITCI",BTC:"BTC",CELO:"CELO",CSPR:"CSPR",ADA:"Cardano",CHZ:"ChilizChain",CRC20:"CronosChain",DOGE:"DOGE",DOT:"DOT",EOS:"EOS",ETHF:"ETHFAIR",ETHW:"ETHW",ETC:"ETC",EGLD:"Elrond",FIL:"FIL",FIO:"FIO",FTM:"Fantom",HRC20:"HECO",ONE:"Harmony",HNT:"Helium",ICP:"ICP",IOTX:"IoTeX",KARDIA:"KAI",KAVA:"KAVA",KDA:"KDA",KLAY:"Klaytn",KSM:"Kusama",LAT:"LAT",LTC:"LTC",MINA:"MINA",MOVR:"MOVR",METIS:"MetisToken",GLMR:"Moonbeam",NEAR:"NEARProtocol",NULS:"NULS",OASYS:"OASYS",OASIS:"ROSE",OMNI:"OMNI",ONT:"Ontology",OPTIMISM:"Optimism",OSMO:"Osmosis",POKT:"PocketNetwork",MATIC:"Polygon",QTUM:"QTUM",REEF:"REEF",SOL:"SOL",SYS:"SYS",SXP:"Solar",XYM:"Symbol",TON:"TON",TT:"TT",TLOS:"Telos",THETA:"ThetaToken",VITE:"VITE",WAVES:"WAVES",WAX:"WAXP",WEMIX:"WEMIXMainnet",XDC:"XDCNetworkXDC",XRP:"XRP",FET:"FETCH",NEM:"NEM",REI:"REINetwork",ZIL:"ZIL",ABBC:"ABBCCoin",RSK:"RSK",AZERO:"AZERO",TRC10:"TRC10",JUNO:"JUNO",ZKSYNC:"zkSyncEra",STARKNET:"Starknet",VIC:"VICTION"},networksById:{},fetchPositions:{method:"privateMixGetV2MixPositionAllPosition"},defaultTimeInForce:"GTC",fiatCurrencies:["EUR","VND","PLN","CZK","HUF","DKK","AUD","CAD","NOK","SEK","CHF","MXN","COP","ARS","GBP","BRL","UAH","ZAR"]},rollingWindowSize:1e3,features:{spot:{sandbox:!0,createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:{last:!0,mark:!0,index:!1},triggerDirection:!1,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:{triggerPriceType:{last:!1,mark:!1,index:!1},price:!0},timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!1,trailing:!1,marketBuyRequiresPrice:!0,marketBuyByCost:!0},createOrders:{max:50},fetchMyTrades:{marginMode:!0,limit:100,daysBack:void 0,untilDays:90,symbolRequired:!0},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:100,trigger:!0,trailing:!1,symbolRequired:!1},fetchOrders:void 0,fetchClosedOrders:{marginMode:!0,limit:100,daysBack:void 0,daysBackCanceled:void 0,untilDays:90,trigger:!0,trailing:!1,symbolRequired:!1},fetchOHLCV:{limit:200}},forPerps:{extends:"spot",createOrder:{triggerPrice:!0,triggerPriceType:{last:!0,mark:!0,index:!1},triggerDirection:!1,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:{triggerPriceType:{last:!0,mark:!0,index:!0},price:!1},timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!0,trailing:!0,marketBuyRequiresPrice:!1,marketBuyByCost:!1},fetchMyTrades:{untilDays:7},fetchClosedOrders:{trailing:!0}},swap:{linear:{extends:"forPerps"},inverse:{extends:"forPerps"}},future:{linear:{extends:"forPerps"},inverse:{extends:"forPerps"}}}})}setSandboxMode(t){this.options.sandboxMode=t}enableDemoTrading(t){this.setSandboxMode(t)}handleProductTypeAndParams(t=void 0,e={}){let i,s;[i,e]=this.handleSubTypeAndParams("handleProductTypeAndParams",void 0,e),void 0!==i&&void 0===t&&(s="linear"===i?"USDT-FUTURES":"COIN-FUTURES");let a=this.safeString2(e,"productType","category",s);if(void 0===a&&void 0!==t){const i=t.settle;if(t.spot){let t;[t,e]=this.handleMarginModeAndParams("handleProductTypeAndParams",e),a=void 0!==t?"MARGIN":"SPOT"}else a="USDT"===i?"USDT-FUTURES":"USDC"===i?"USDC-FUTURES":"SUSDT"===i?"SUSDT-FUTURES":"SUSDC"===i?"SUSDC-FUTURES":"SBTC"===i||"SETH"===i||"SEOS"===i?"SCOIN-FUTURES":"COIN-FUTURES"}if(void 0===a)throw new r.ArgumentsRequired(this.id+' requires a productType param, one of "USDT-FUTURES", "USDC-FUTURES", "COIN-FUTURES", "SUSDT-FUTURES", "SUSDC-FUTURES", "SCOIN-FUTURES" or for uta only "SPOT"');return[a,e=this.omit(e,["productType","category"])]}async fetchTime(t={}){const e=await this.publicCommonGetV2PublicTime(t),i=this.safeValue(e,"data",{});return this.safeInteger(i,"serverTime")}async fetchMarkets(t={}){let e;return this.options.adjustForTimeDifference&&await this.loadTimeDifference(),[e,t]=this.handleOptionAndParams(t,"fetchMarkets","uta",!1),e?await this.fetchUtaMarkets(t):await this.fetchDefaultMarkets(t)}async fetchDefaultMarkets(t){let e;const i=this.safeDict(this.options,"fetchMarkets"),s=["spot","swap"];e=void 0!==i?this.safeList(i,"types",s):this.safeList(this.options,"fetchMarkets",s);const n=[];let o=!1;for(let i=0;i<e.length;i++){const s=e[i];if("swap"===s||"future"===s){const e=["USDT-FUTURES","COIN-FUTURES","USDC-FUTURES","SUSDT-FUTURES","SCOIN-FUTURES","SUSDC-FUTURES"];for(let i=0;i<e.length;i++)n.push(this.publicMixGetV2MixMarketContracts(this.extend(t,{productType:e[i]})))}else{if("spot"!==s)throw new r.NotSupported(this.id+" does not support "+s+" market");n.push(this.publicSpotGetV2SpotPublicSymbols(t)),o=!0,n.push(this.publicMarginGetV2MarginCurrencies(t))}}const d=await Promise.all(n);let c=[];this.options.crossMarginPairsData=[],this.options.isolatedMarginPairsData=[];for(let t=0;t<d.length;t++){const e=this.safeDict(d,t),i=this.safeList(e,"data",[]),s=this.safeDict(i,0,{}),r=this.safeBool(s,"isBorrowable");if(o&&void 0!==r){const t=Object.keys(this.indexBy(i,"symbol"));this.options.crossMarginPairsData=t,this.options.isolatedMarginPairsData=t}else c=this.arrayConcat(c,i)}const h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeString(e,"symbol"),s=this.safeString(e,"quoteCoin"),r=this.safeString(e,"baseCoin"),n=this.safeCurrencyCode(s),o=this.safeCurrencyCode(r),d=this.safeValue(e,"supportMarginCoins",[]);let l;l=this.inArray(r,d)?r:this.inArray(s,d)?s:this.safeString(d,0);const u=this.safeCurrencyCode(l);let p,f,m,g,y,v,b,w=o+"/"+n,S=!1,k=!1,O=!1,T=!1;const P=this.safeString(e,"symbolType");let _,A=!1;if(void 0===P){p="spot",k=!0,f=this.parseNumber(this.parsePrecision(this.safeString(e,"pricePrecision"))),m=this.parseNumber(this.parsePrecision(this.safeString(e,"quantityPrecision")));const t=this.inArray(i,this.options.crossMarginPairsData),s=this.inArray(i,this.options.isolatedMarginPairsData);_={cross:t,isolated:s},A=t||s}else{if("perpetual"===P)p="swap",S=!0,w=w+":"+u;else if("delivery"===P){v=this.safeInteger(e,"deliveryTime"),b=this.iso8601(v);const t=b.split("-"),i=this.safeString(t,0),s=this.safeString(t,2);p="future",O=!0,w=w+":"+u+"-"+(i.slice(2,4)+this.safeString(t,1)+s.slice(0,2))}T=!0,y=o===u,g=!y;const t=this.safeInteger(e,"pricePlace"),i=this.safeInteger(e,"volumePlace"),s=this.safeString(e,"priceEndStep"),r=this.safeString(e,"sizeMultiplier"),n=new a.Y(s);n.decimals=Math.max(n.decimals,t),n.reduce();const d=n.toString();f=this.parseNumber(d);const c=new a.Y(r);c.decimals=Math.max(c.decimals,i),c.reduce();const h=c.toString();m=this.parseNumber(h),_={cross:!0,isolated:!0}}const I=this.safeString2(e,"status","symbolStatus");let x,E;void 0!==I&&(x="online"===I||"normal"===I),"USDT"===n&&(E=this.safeNumber(e,"minTradeUSDT"));const M=T?1:void 0;h.push(this.safeMarketStructure({id:i,symbol:w,base:o,quote:n,settle:u,baseId:r,quoteId:s,settleId:l,type:p,spot:k,margin:k&&A,marginModes:_,swap:S,future:O,option:!1,active:x,contract:T,linear:g,inverse:y,taker:this.safeNumber(e,"takerFeeRate"),maker:this.safeNumber(e,"makerFeeRate"),contractSize:M,expiry:v,expiryDatetime:b,strike:void 0,optionType:void 0,precision:{amount:m,price:f},limits:{leverage:{min:this.safeNumber(e,"minLever"),max:this.safeNumber(e,"maxLever")},amount:{min:this.safeNumber2(e,"minTradeNum","minTradeAmount"),max:this.safeNumber(e,"maxTradeAmount")},price:{min:void 0,max:void 0},cost:{min:E,max:void 0}},created:this.safeInteger(e,"launchTime"),info:e}))}return h}async fetchUtaMarkets(t){const e=["SPOT","USDT-FUTURES","COIN-FUTURES","USDC-FUTURES"],i=[];for(let s=0;s<e.length;s++){const r=this.extend(t,{category:e[s]});i.push(this.publicUtaGetV3MarketInstruments(r))}const s=await Promise.all(i);let r=[];for(let t=0;t<s.length;t++){const e=this.safeDict(s,t),i=this.safeList(e,"data",[]);r=this.arrayConcat(r,i)}const a=[];for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString(e,"category"),s=this.safeString(e,"symbol"),n=this.safeString(e,"quoteCoin"),o=this.safeString(e,"baseCoin"),d=this.safeCurrencyCode(n),c=this.safeCurrencyCode(o);let h,l;"USDT-FUTURES"===i?h="USDT":"USDC-FUTURES"===i?h="USDC":"COIN-FUTURES"===i&&(h=c),void 0!==h&&(l=this.safeCurrencyCode(h));let u,p,f,m,g,y,v,b=c+"/"+d,w=!1,S=!1,k=!1,O=!1;const T=this.safeString(e,"type");let P,_=!1;const A="MARGIN"===i;if(A||"SPOT"===i){if(u="spot",S=!0,A){const t=this.safeString(e,"isIsolatedBaseBorrowable"),i=this.safeString(e,"isIsolatedQuotedBorrowable"),s="YES"===t||"YES"===i;P={cross:"0"!==this.safeString(e,"maxCrossedLeverage"),isolated:s},_=!0}}else{if("perpetual"===T)u="swap",w=!0,b=b+":"+l;else if("delivery"===T){y=this.safeInteger(e,"deliveryTime"),v=this.iso8601(y);const t=v.split("-"),i=this.safeString(t,0),s=this.safeString(t,2);u="future",k=!0,b=b+":"+l+"-"+(i.slice(2,4)+this.safeString(t,1)+s.slice(0,2))}O=!0,g=c===l,m=!g,P={cross:!0,isolated:!0}}p=this.parseNumber(this.parsePrecision(this.safeString(e,"pricePrecision"))),f=this.parseNumber(this.parsePrecision(this.safeString(e,"quantityPrecision")));const I=this.safeString(e,"status");let x;void 0!==I&&(x="online"===I||"normal"===I);const E=O?1:void 0;a.push(this.safeMarketStructure({id:s,symbol:b,base:c,quote:d,settle:l,baseId:o,quoteId:n,settleId:h,type:u,spot:S,margin:S&&_,marginModes:P,swap:w,future:k,option:!1,active:x,contract:O,linear:m,inverse:g,taker:this.safeNumber(e,"takerFeeRate"),maker:this.safeNumber(e,"makerFeeRate"),contractSize:E,expiry:y,expiryDatetime:v,strike:void 0,optionType:void 0,precision:{amount:f,price:p},limits:{leverage:{min:this.safeNumber(e,"minLeverage"),max:this.safeNumber(e,"maxLeverage")},amount:{min:this.safeNumber(e,"minOrderQty"),max:this.safeNumber(e,"maxOrderQty")},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},created:this.safeInteger(e,"launchTime"),info:e}))}return a}async fetchCurrencies(t={}){const e=await this.publicSpotGetV2SpotPublicCoins(t),i={},s=this.safeValue(e,"data",[]),r=this.safeList(this.options,"fiatCurrencies",[]);for(let t=0;t<s.length;t++){const e=s[t],a=this.safeString(e,"coin"),n=this.safeCurrencyCode(a),o=this.safeValue(e,"chains",[]),d={};let c,h;const l=o.length;0===l&&(c=!1,h=!1);for(let t=0;t<l;t++){const e=o[t],i=this.safeString(e,"chain");let s=this.networkIdToCode(i,n);s=s.toUpperCase();const r="true"===this.safeString(e,"withdrawable"),a="true"===this.safeString(e,"rechargeable");c=void 0===c?r:c||r,h=void 0===h?a:h||a,d[s]={info:e,id:i,network:s,limits:{withdraw:{min:this.safeNumber(e,"minWithdrawAmount"),max:void 0},deposit:{min:this.safeNumber(e,"minDepositAmount"),max:void 0}},active:void 0,withdraw:r,deposit:a,fee:this.safeNumber(e,"withdrawFee"),precision:this.parseNumber(this.parsePrecision(this.safeString(e,"withdrawMinScale")))}}const u=c&&h,p=this.inArray(n,r);i[n]=this.safeCurrencyStructure({info:e,id:a,code:n,networks:d,type:p?"fiat":"crypto",name:void 0,active:u,deposit:h,withdraw:c,fee:void 0,precision:void 0,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},created:void 0})}return i}async fetchMarketLeverageTiers(t,e={}){await this.loadMarkets();const i=this.market(t),s={};let a,n,o,d;if([n,e]=this.handleMarginModeAndParams("fetchMarketLeverageTiers",e,"isolated"),[o,e]=this.handleProductTypeAndParams(i,e),[d,e]=this.handleOptionAndParams(e,"fetchMarketLeverageTiers","uta",!1),d)"SPOT"===o&&void 0!==n&&(o="MARGIN"),s.symbol=i.id,s.category=o,a=await this.publicUtaGetV3MarketPositionTier(this.extend(s,e));else if(i.swap||i.future)s.productType=o,s.symbol=i.id,a=await this.publicMixGetV2MixMarketQueryPositionLever(this.extend(s,e));else if("isolated"===n)s.symbol=i.id,a=await this.privateMarginGetV2MarginIsolatedTierData(this.extend(s,e));else{if("cross"!==n)throw new r.BadRequest(this.id+" fetchMarketLeverageTiers() symbol does not support market "+i.symbol);{const t=this.safeString(e,"code");if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMarketLeverageTiers() requires a code argument");e=this.omit(e,"code");const i=this.currency(t);s.coin=i.id,a=await this.privateMarginGetV2MarginCrossedTierData(this.extend(s,e))}}const c=this.safeValue(a,"data",[]);return this.parseMarketLeverageTiers(c,i)}parseMarketLeverageTiers(t,e=void 0){const i=[];let s=0;for(let r=0;r<t.length;r++){const a=t[r],n=this.safeNumber2(a,"startUnit","minTierValue");void 0!==n&&(s=n);const o=this.safeNumberN(a,["endUnit","maxBorrowableAmount","baseMaxBorrowableAmount","maxTierValue"]),d=this.safeString2(a,"coin","baseCoin"),c=void 0!==d?d:e.base,h=this.safeString(a,"symbol");i.push({tier:this.safeInteger2(a,"level","tier"),symbol:this.safeSymbol(h,e),currency:this.safeCurrencyCode(c),minNotional:s,maxNotional:o,maintenanceMarginRate:this.safeNumberN(a,["keepMarginRate","maintainMarginRate","mmr"]),maxLeverage:this.safeNumber(a,"leverage"),info:a}),s=o}return i}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),r)return await this.fetchPaginatedCallCursor("fetchDeposits",void 0,e,i,s,"idLessThan","idLessThan",void 0,100);void 0===e&&(e=this.milliseconds()-7776e6);let a,n={startTime:e,endTime:this.milliseconds()};void 0!==t&&(a=this.currency(t),n.coin=a.id),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("endTime",n,s);const o=await this.privateSpotGetV2SpotWalletDepositRecords(this.extend(n,s)),d=this.safeList(o,"data",[]);return this.parseTransactions(d,void 0,e,i)}async withdraw(t,e,i,s=void 0,a={}){let n;if(this.checkAddress(i),[n,a]=this.handleNetworkCodeAndParams(a),void 0===n)throw new r.ArgumentsRequired(this.id+' withdraw() requires a "network" parameter');await this.loadMarkets();const o=this.currency(t),d=this.networkCodeToId(n),c={coin:o.id,address:i,chain:d,size:this.currencyToPrecision(t,e,n),transferType:"on_chain"};void 0!==s&&(c.tag=s);const h=await this.privateSpotPostV2SpotWalletWithdrawal(this.extend(c,a)),l=this.safeValue(h,"data",{}),u=this.parseTransaction(l,o);u.type="withdrawal";const p=this.safeValue(this.options,"withdraw",{});return this.safeBool(p,"fillResponseFromRequest",!0)&&(u.currency=t,u.amount=e,u.tag=s,u.address=i,u.addressTo=i,u.network=n),u}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),a)return await this.fetchPaginatedCallCursor("fetchWithdrawals",void 0,e,i,s,"idLessThan","idLessThan",void 0,100);void 0!==t&&(r=this.currency(t)),void 0===e&&(e=this.milliseconds()-7776e6);let n={startTime:e,endTime:this.milliseconds()};void 0!==r&&(n.coin=r.id),[n,s]=this.handleUntilOption("endTime",n,s),void 0!==i&&(n.limit=i);const o=await this.privateSpotGetV2SpotWalletWithdrawalRecords(this.extend(n,s)),d=this.safeList(o,"data",[]);return this.parseTransactions(d,r,e,i)}parseTransaction(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeCurrencyCode(i,e),r=this.safeInteger(t,"cTime"),n=this.safeString(t,"chain"),o=this.safeString(t,"status"),d=this.safeString(t,"tag"),c=this.safeString(t,"fee");let h,l;void 0!==c&&(h=a.Y.stringAbs(c));let u=this.safeString(t,"size");return void 0!==h&&(l={currency:s,cost:this.parseNumber(h)},u=a.Y.stringSub(u,h)),{id:this.safeString(t,"orderId"),info:t,txid:this.safeString(t,"tradeId"),timestamp:r,datetime:this.iso8601(r),network:this.networkIdToCode(n),addressFrom:this.safeString(t,"fromAddress"),address:this.safeString(t,"toAddress"),addressTo:this.safeString(t,"toAddress"),amount:this.parseNumber(u),type:this.safeString(t,"type"),currency:s,status:this.parseTransactionStatus(o),updated:this.safeInteger(t,"uTime"),tagFrom:void 0,tag:d,tagTo:d,comment:void 0,internal:void 0,fee:l}}parseTransactionStatus(t){return this.safeString({success:"ok",Pending:"pending",pending_review:"pending",pending_review_fail:"failed",reject:"failed"},t,t)}async fetchDepositAddress(t,e={}){let i;await this.loadMarkets(),[i,e]=this.handleNetworkCodeAndParams(e);const s=this.currency(t),r={coin:s.id};void 0!==i&&(r.chain=this.networkCodeToId(i,t));const a=await this.privateSpotGetV2SpotWalletDepositAddress(this.extend(r,e)),n=this.safeDict(a,"data",{});return this.parseDepositAddress(n,s)}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeString(t,"chain"),r=this.safeCurrencyCode(i,e);let a;return void 0!==s&&(a=this.networkIdToCode(s,r)),{info:t,currency:r,network:a,address:this.safeString(t,"address"),tag:this.safeString(t,"tag")}}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r={symbol:s.id};let a,n,o;void 0!==e&&(r.limit=e),[a,i]=this.handleProductTypeAndParams(s,i),[o,i]=this.handleOptionAndParams(i,"fetchOrderBook","uta",!1),o?(r.category=a,n=await this.publicUtaGetV3MarketOrderbook(this.extend(r,i))):s.spot?n=await this.publicSpotGetV2SpotMarketOrderbook(this.extend(r,i)):(r.productType=a,n=await this.publicMixGetV2MixMarketMergeDepth(this.extend(r,i)));const d=this.safeValue(n,"data",{}),c=o?"b":"bids",h=o?"a":"asks",l=this.safeInteger(d,"ts");return this.parseOrderBook(d,s.symbol,l,c,h)}parseTicker(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeString2(t,"lastPr","lastPrice"),r=this.safeIntegerOmitZero(t,"ts"),n=this.safeString(t,"change24h"),o=this.safeString(t,"category"),d=this.safeString(t,"markPrice");let c;c=void 0!==d&&"SPOT"!==o?"contract":"spot";let h=this.safeString(t,"price24hPcnt");return void 0===h&&(h=a.Y.stringMul(n,"100")),this.safeTicker({symbol:this.safeSymbol(i,e,void 0,c),timestamp:r,datetime:this.iso8601(r),high:this.safeString2(t,"high24h","highPrice24h"),low:this.safeString2(t,"low24h","lowPrice24h"),bid:this.safeString2(t,"bidPr","bid1Price"),bidVolume:this.safeString2(t,"bidSz","bid1Size"),ask:this.safeString2(t,"askPr","ask1Price"),askVolume:this.safeString2(t,"askSz","ask1Size"),vwap:void 0,open:this.safeStringN(t,["open","open24h","openPrice24h"]),close:s,last:s,previousClose:void 0,change:n,percentage:h,average:void 0,baseVolume:this.safeString2(t,"baseVolume","volume24h"),quoteVolume:this.safeString2(t,"quoteVolume","turnover24h"),indexPrice:this.safeString(t,"indexPrice"),markPrice:d,info:t},e)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r,a,n;[r,e]=this.handleProductTypeAndParams(i,e),[n,e]=this.handleOptionAndParams(e,"fetchTicker","uta",!1),n?(s.category=r,a=await this.publicUtaGetV3MarketTickers(this.extend(s,e))):i.spot?a=await this.publicSpotGetV2SpotMarketTickers(this.extend(s,e)):(s.productType=r,a=await this.publicMixGetV2MixMarketTicker(this.extend(s,e)));const o=this.safeList(a,"data",[]);return this.parseTicker(o[0],i)}async fetchMarkPrice(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let a;if(i.spot)throw new r.NotSupported(this.id+" fetchMarkPrice() is not supported for spot markets");{let t;[t,e]=this.handleProductTypeAndParams(i,e),s.productType=t,a=await this.publicMixGetV2MixMarketSymbolPrice(this.extend(s,e))}const n=this.safeList(a,"data",[]);return this.parseTicker(n[0],i)}async fetchTickers(t=void 0,e={}){let i,s;if(await this.loadMarkets(),void 0!==t){const e=this.safeValue(t,0);i=this.market(e)}const r={};let a;[a,e]=this.handleMarketTypeAndParams("fetchTickers",i,e);const n=this.safeString(e,"subType");let o,d;if([o,e]=this.handleProductTypeAndParams(i,e),[d,e]=this.handleOptionAndParams(e,"fetchTickers","uta",!1),d){const a=t.length;void 0!==t&&1===a&&(r.symbol=i.id),r.category=o,s=await this.publicUtaGetV3MarketTickers(this.extend(r,e))}else"spot"===a&&void 0===n?s=await this.publicSpotGetV2SpotMarketTickers(this.extend(r,e)):(r.productType=o,s=await this.publicMixGetV2MixMarketTickers(this.extend(r,e)));const c=this.safeList(s,"data",[]);return this.parseTickers(c,t)}parseTrade(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeSymbol(i,e),r=this.safeIntegerN(t,["cTime","ts","createdTime"]);let n;const o=this.safeValue(t,"feeDetail"),d=this.safeString(t,"posMode"),c=this.safeString(t,"category"),h=void 0!==d||void 0!==c?o[0]:o;if(void 0!==h){n={currency:this.safeCurrencyCode(this.safeString(h,"feeCoin"))};const t=this.safeString2(h,"totalFee","fee"),e="yes"===this.safeString(h,"deduction");n.cost=e?t:a.Y.stringNeg(t)}return this.safeTrade({info:t,id:this.safeString2(t,"tradeId","execId"),order:this.safeString(t,"orderId"),symbol:s,side:this.safeStringLower(t,"side"),type:this.safeString(t,"orderType"),takerOrMaker:this.safeString(t,"tradeScope"),price:this.safeStringN(t,["priceAvg","price","execPrice"]),amount:this.safeStringN(t,["baseVolume","size","execQty"]),cost:this.safeStringN(t,["quoteVolume","amount","execValue"]),timestamp:r,datetime:this.iso8601(r),fee:n},e)}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchTrades","paginate"),r)return await this.fetchPaginatedCallCursor("fetchTrades",t,e,i,s,"idLessThan","idLessThan");const a=this.market(t);let n,o={symbol:a.id};[n,s]=this.handleOptionAndParams(s,"fetchTrades","uta",!1),void 0!==i&&(n?o.limit=Math.min(i,100):a.contract?o.limit=Math.min(i,1e3):o.limit=i);const d=this.safeValue(this.options,"fetchTrades",{});let c,h;if([h,s]=this.handleProductTypeAndParams(a,s),n){if("SPOT"===h){let t;[t,s]=this.handleMarginModeAndParams("fetchTrades",s),void 0!==t&&(h="MARGIN")}o.category=h,c=await this.publicUtaGetV3MarketFills(this.extend(o,s))}else if(a.spot){const t=this.safeValue(d,"spot",{}),i=this.safeString(t,"method","publicSpotGetV2SpotMarketFillsHistory"),r=this.safeString(s,"method",i);s=this.omit(s,"method"),"publicSpotGetV2SpotMarketFillsHistory"===r?([o,s]=this.handleUntilOption("endTime",o,s),void 0!==e&&(o.startTime=e),c=await this.publicSpotGetV2SpotMarketFillsHistory(this.extend(o,s))):"publicSpotGetV2SpotMarketFills"===r&&(c=await this.publicSpotGetV2SpotMarketFills(this.extend(o,s)))}else{const t=this.safeValue(d,"swap",{}),i=this.safeString(t,"method","publicMixGetV2MixMarketFillsHistory"),r=this.safeString(s,"method",i);s=this.omit(s,"method"),o.productType=h,"publicMixGetV2MixMarketFillsHistory"===r?([o,s]=this.handleUntilOption("endTime",o,s),void 0!==e&&(o.startTime=e),c=await this.publicMixGetV2MixMarketFillsHistory(this.extend(o,s))):"publicMixGetV2MixMarketFills"===r&&(c=await this.publicMixGetV2MixMarketFills(this.extend(o,s)))}const l=this.safeList(c,"data",[]);return this.parseTrades(l,a,e,i)}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id};let r;[r,e]=this.handleMarginModeAndParams("fetchTradingFee",e),i.spot?s.businessType=void 0!==r?"margin":"spot":s.businessType="mix";const a=await this.privateCommonGetV2CommonTradeRate(this.extend(s,e)),n=this.safeValue(a,"data",{});return this.parseTradingFee(n,i)}async fetchTradingFees(t={}){let e,i,s;if(await this.loadMarkets(),[i,t]=this.handleMarginModeAndParams("fetchTradingFees",t),[s,t]=this.handleMarketTypeAndParams("fetchTradingFees",void 0,t),"spot"===s){const s=this.safeBool(t,"margin",!1);t=this.omit(t,"margin"),e=void 0!==i||s?await this.publicMarginGetV2MarginCurrencies(t):await this.publicSpotGetV2SpotPublicSymbols(t)}else{if("swap"!==s&&"future"!==s)throw new r.NotSupported(this.id+" does not support "+s+" market");{let i;[i,t]=this.handleProductTypeAndParams(void 0,t),t.productType=i,e=await this.publicMixGetV2MixMarketContracts(t)}}const a=this.safeValue(e,"data",[]),n={};for(let t=0;t<a.length;t++){const e=a[t],i=this.safeString(e,"symbol"),r=this.safeSymbol(i,void 0,void 0,s),o=this.market(r),d=this.parseTradingFee(e,o);n[r]=d}return n}parseTradingFee(t,e=void 0){const i=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(i,e),maker:this.safeNumber(t,"makerFeeRate"),taker:this.safeNumber(t,"takerFeeRate"),percentage:void 0,tierBased:void 0}}parseOHLCV(t,e=void 0){const i=this.safeBool(e,"inverse")?6:5;return[this.safeInteger(t,0),this.safeNumber(t,1),this.safeNumber(t,2),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,i)]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.safeBool(r,"useHistoryEndpoint",!1),n=this.safeBool(r,"useHistoryEndpointForPagination",!0);let o=!1;if([o,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate"),o){const a=n?200:1e3;return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,a)}const d=this.market(t),c={symbol:d.id};let h,l,u;[u,r]=this.handleOptionAndParams(r,"fetchOHLCV","uta",!1),u?(l=this.options.timeframes.uta,c.interval=this.safeString(l,e,e)):(h=d.spot?"spot":"swap",l=this.options.timeframes[h],c.granularity=this.safeString(l,e,e));const p=864e5,f=this.milliseconds(),m=1e3*this.parseTimeframe(e),g=this.safeInteger(r,"until"),y=void 0!==s,v=void 0!==i,b=void 0!==g;r=this.omit(r,["until"]);const w=d.spot?"spot":"swap",S=this.safeDict(this.options.fetchOHLCV,w,{}),k=this.safeDict(S,"maxLimitPerTimeframe",{}),O=this.safeInteger(k,e,s),T=this.safeDict(this.options.fetchOHLCV,"maxRecentDaysPerTimeframe",{}),P=f-(this.safeInteger(T,e)-1)*p;y?(s=Math.min(s,1e3),s=Math.min(s,O)):s=100;let _,A,I=s*m;v&&(_=i,c.startTime=i,b||(A=this.sum(_,I),A>f&&(A=f),c.endTime=A)),b&&(A=g,A>f&&(A=f),c.endTime=A,v||(_=A-I));let x,E,M,C=!1;if((void 0!==_&&_<=P||a)&&(C=!0,I=(s=Math.min(s,200))*m,_=A-I,c.startTime=_,!d.spot)){const t=90;A-_>t*p&&(A=this.sum(_,t*p),c.endTime=A)}if(c.limit=s,[M,r]=this.handleParamString(r,"price"),[E,r]=this.handleProductTypeAndParams(d,r),u)void 0!==M&&("mark"===M?c.type="MARK":"index"===M&&(c.type="INDEX")),c.category=E,x=await this.publicUtaGetV3MarketCandles(this.extend(c,r));else if(d.spot)C?x=await this.publicSpotGetV2SpotMarketHistoryCandles(this.extend(c,r)):(y||(c.limit=1e3,s=1e3),x=await this.publicSpotGetV2SpotMarketCandles(this.extend(c,r)));else{c.productType=E;const t=this.extend(c,r);C||"mark"!==M&&"index"!==M?"mark"===M?x=await this.publicMixGetV2MixMarketHistoryMarkCandles(t):"index"===M?x=await this.publicMixGetV2MixMarketHistoryIndexCandles(t):C?x=await this.publicMixGetV2MixMarketHistoryCandles(t):(y||(t.limit=1e3,s=1e3),x=await this.publicMixGetV2MixMarketCandles(t)):(y||(t.limit=1e3,s=1e3),x=await this.publicMixGetV2MixMarketCandles(this.extend({kLineType:M},t)))}if(""===x)return[];const B=this.safeList(x,"data",x);return this.parseOHLCVs(B,d,e,i,s)}async fetchBalance(t={}){await this.loadMarkets();const e={};let i,s,a,n;if([n,t]=this.handleOptionAndParams(t,"fetchBalance","uta",!1),[i,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t),[s,t]=this.handleMarginModeAndParams("fetchBalance",t),n){a=await this.privateUtaGetV3AccountAssets(this.extend(e,t));const i=this.safeDict(a,"data",{}),s=this.safeList(i,"assets",[]);return this.parseUtaBalance(s)}if("swap"===i||"future"===i){let i;[i,t]=this.handleProductTypeAndParams(void 0,t),e.productType=i,a=await this.privateMixGetV2MixAccountAccounts(this.extend(e,t))}else if("isolated"===s)a=await this.privateMarginGetV2MarginIsolatedAccountAssets(this.extend(e,t));else if("cross"===s)a=await this.privateMarginGetV2MarginCrossedAccountAssets(this.extend(e,t));else{if("spot"!==i)throw new r.NotSupported(this.id+" fetchBalance() does not support "+i+" accounts");a=await this.privateSpotGetV2SpotAccountAssets(this.extend(e,t))}const o=this.safeValue(a,"data",[]);return this.parseBalance(o)}parseUtaBalance(t){const e={info:t};for(let i=0;i<t.length;i++){const s=t[i],r=this.account(),a=this.safeString(s,"coin"),n=this.safeCurrencyCode(a);r.debt=this.safeString(s,"debt"),r.used=this.safeString(s,"locked"),r.free=this.safeString(s,"available"),r.total=this.safeString(s,"balance"),e[n]=r}return this.safeBalance(e)}parseBalance(t){const e={info:t};for(let i=0;i<t.length;i++){const s=t[i],r=this.account(),n=this.safeString2(s,"marginCoin","coin"),o=this.safeCurrencyCode(n),d=this.safeString(s,"borrow");if(void 0!==d){const t=this.safeString(s,"interest");r.free=this.safeString(s,"transferable"),r.total=this.safeString(s,"totalAmount"),r.debt=a.Y.stringAdd(d,t)}else{const t=this.safeString(s,"available"),e=this.safeString(s,"maxTransferOut");if(void 0!==e)r.free=e,r.total=this.safeString(s,"accountEquity");else{r.free=t;const e=this.safeString(s,"frozen"),i=this.safeString(s,"locked");r.used=a.Y.stringAdd(e,i)}}e[o]=r}return this.safeBalance(e)}parseOrderStatus(t){return this.safeString({new:"open",init:"open",not_trigger:"open",partial_fill:"open",partially_fill:"open",partially_filled:"open",triggered:"closed",full_fill:"closed",filled:"closed",fail_trigger:"rejected",cancel:"canceled",cancelled:"canceled",canceled:"canceled",live:"open",fail_execute:"rejected",executed:"closed"},t,t)}parseOrder(t,e=void 0){if(void 0!==this.safeString(t,"errorMsg"))return this.safeOrder({info:t,id:this.safeString(t,"orderId"),clientOrderId:this.safeString2(t,"clientOrderId","clientOid"),status:"rejected"},e);let i=void 0!==this.safeString(t,"posSide")?"contract":"spot";void 0!==e&&(i=e.type);const s=this.safeString(t,"symbol");e=this.safeMarket(s,e,void 0,i);const r=this.safeIntegerN(t,["cTime","ctime","createdTime"]),n=this.safeInteger2(t,"uTime","updatedTime"),o=this.safeStringN(t,["status","state","orderStatus","planStatus"]);let d;const c=this.safeString(t,"fee");void 0!==c&&(d={cost:this.parseNumber(a.Y.stringNeg(c)),currency:e.settle});const h=this.safeValue(t,"feeDetail");if(void 0!==this.safeString(t,"category")){const t=this.safeDict(h,0,{}),i=this.safeString(t,"fee");d={cost:this.parseNumber(a.Y.stringNeg(i)),currency:e.settle}}else if(void 0!==h){const t=JSON.parse(h),e=Object.values(t);let i;for(let t=0;t<e.length;t++){const s=e[t];if(void 0!==this.safeValue(s,"feeCoinCode")){i=s;break}}d={cost:this.parseNumber(a.Y.stringNeg(this.safeString(i,"totalFee"))),currency:this.safeCurrencyCode(this.safeString(i,"feeCoinCode"))}}let l,u,p=this.safeStringUpper2(t,"force","timeInForce");"POST_ONLY"===p&&(l=!0,p="PO");const f=this.safeString(t,"reduceOnly");let m,g;void 0!==f&&(u="NO"!==f);let y,v;void 0!==this.safeString(t,"basePrice")?(m=this.safeString(t,"priceAvg"),g=this.safeString(t,"basePrice")):(m=this.safeStringN(t,["price","executePrice","slLimitPrice","tpLimitPrice"]),g=this.safeString(t,"priceAvg"));const b=this.safeString(t,"baseSize");void 0!==b?(y=b,v=this.safeString(t,"size")):(y=this.safeString2(t,"size","qty"),v=this.safeString2(t,"baseVolume","cumExecQty"));let w=this.safeString(t,"side");"hedge_mode"===this.safeString(t,"posMode")&&u&&(w="buy"===w?"sell":"buy");const S=this.safeString(t,"orderType"),k="buy"===w&&"market"===S;return e.spot&&k&&(y=this.safeString(t,"baseVolume")),this.safeOrder({info:t,id:this.safeString2(t,"orderId","data"),clientOrderId:this.safeString2(t,"clientOrderId","clientOid"),timestamp:r,datetime:this.iso8601(r),lastTradeTimestamp:n,lastUpdateTimestamp:n,symbol:e.symbol,type:S,side:w,price:m,amount:y,cost:this.safeString2(t,"quoteVolume","quoteSize"),average:g,filled:v,remaining:void 0,timeInForce:p,postOnly:l,reduceOnly:u,triggerPrice:this.safeNumber(t,"triggerPrice"),takeProfitPrice:this.safeNumberN(t,["presetStopSurplusPrice","stopSurplusTriggerPrice","takeProfit"]),stopLossPrice:this.safeNumberN(t,["presetStopLossPrice","stopLossTriggerPrice","stopLoss"]),status:this.parseOrderStatus(o),fee:d,trades:void 0},e)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");return await this.createOrder(t,"market","buy",e,void 0,this.extend({createMarketBuyOrderRequiresPrice:!1},i))}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=this.handleMarginModeAndParams("createOrder",a)[0],d=this.safeValue2(a,"stopPrice","triggerPrice"),c=this.safeValue(a,"stopLossPrice"),h=this.safeValue(a,"takeProfitPrice"),l=void 0!==this.safeString2(a,"trailingPercent","callbackRatio"),u=void 0!==d,p=void 0!==c||void 0!==h;let f,m;if([m,a]=this.handleOptionAndParams(a,"createOrder","uta",!1),m){const n=this.createUtaOrderRequest(t,e,i,s,r,a);f=p?await this.privateUtaPostV3TradePlaceStrategyOrder(n):await this.privateUtaPostV3TradePlaceOrder(n)}else{const d=this.createOrderRequest(t,e,i,s,r,a);f=n.spot?u?await this.privateSpotPostV2SpotTradePlacePlanOrder(d):"isolated"===o?await this.privateMarginPostV2MarginIsolatedPlaceOrder(d):"cross"===o?await this.privateMarginPostV2MarginCrossedPlaceOrder(d):await this.privateSpotPostV2SpotTradePlaceOrder(d):u||l?await this.privateMixPostV2MixOrderPlacePlanOrder(d):p?await this.privateMixPostV2MixOrderPlaceTpslOrder(d):await this.privateMixPostV2MixOrderPlaceOrder(d)}const g=this.safeDict(f,"data",{});return this.parseOrder(g,n)}createUtaOrderRequest(t,e,i,s,r=void 0,a={}){const n=this.market(t);let o;if([o,a]=this.handleProductTypeAndParams(n,a),"SPOT"===o){let t;[t,a]=this.handleMarginModeAndParams("createOrder",a),void 0!==t&&(o="MARGIN")}const d={category:o,symbol:n.id,qty:this.amountToPrecision(t,s),side:i},c=this.safeString2(a,"clientOid","clientOrderId");void 0!==c&&(d.clientOid=c,a=this.omit(a,"clientOrderId"));const h=this.safeNumber(a,"stopLossPrice"),l=this.safeNumber(a,"takeProfitPrice"),u=this.safeValue(a,"stopLoss"),p=this.safeValue(a,"takeProfit"),f=void 0!==u,m=void 0!==p,g=void 0!==h,y=void 0!==l,v=g||y;if(v){if(g){const e=this.safeString(a,"slTriggerBy","mark");d.slTriggerBy=e,d.stopLoss=this.priceToPrecision(t,h),void 0!==r?(d.slLimitPrice=this.priceToPrecision(t,r),d.slOrderType=this.safeString(a,"slOrderType","limit")):d.slOrderType=this.safeString(a,"slOrderType","market")}else if(y){const e=this.safeString(a,"tpTriggerBy","mark");d.tpTriggerBy=e,d.takeProfit=this.priceToPrecision(t,l),void 0!==r?(d.tpLimitPrice=this.priceToPrecision(t,r),d.tpOrderType=this.safeString(a,"tpOrderType","limit")):d.tpOrderType=this.safeString(a,"tpOrderType","market")}a=this.omit(a,["stopLossPrice","takeProfitPrice"])}else{if(f){const e=this.safeNumber2(u,"triggerPrice","stopPrice"),i=this.safeNumber(u,"price");d.stopLoss=this.priceToPrecision(t,e),void 0!==i?(d.slLimitPrice=this.priceToPrecision(t,i),d.slOrderType=this.safeString(a,"slOrderType","limit")):d.slOrderType=this.safeString(a,"slOrderType","market")}if(m){const e=this.safeNumber2(p,"triggerPrice","stopPrice"),i=this.safeNumber(p,"price");d.takeProfit=this.priceToPrecision(t,e),void 0!==i?(d.tpLimitPrice=this.priceToPrecision(t,i),d.tpOrderType=this.safeString(a,"tpOrderType","limit")):d.tpOrderType=this.safeString(a,"tpOrderType","market")}const i="market"===e;i||(d.price=this.priceToPrecision(t,r)),d.orderType=e;const s=this.safeString(a,"timeInForce");let n;[n,a]=this.handlePostOnly(i,"post_only"===s,a);const o=this.safeStringUpper(this.options,"defaultTimeInForce"),c=this.safeStringUpper(a,"timeInForce",o);n?d.timeInForce="post_only":"GTC"===c?d.timeInForce="gtc":"FOK"===c?d.timeInForce="fok":"IOC"===c&&(d.timeInForce="ioc")}const b=this.safeBool(a,"reduceOnly",!1);let w;if([w,a]=this.handleParamBool(a,"hedged",!1),b)if(w||v){const t="sell"===i?"long":"short";d.posSide=t}else v||(d.reduceOnly="yes");else if(w){const t="buy"===i?"long":"short";d.posSide=t}return a=this.omit(a,["stopLoss","takeProfit","postOnly","reduceOnly","hedged"]),this.extend(d,a)}createOrderRequest(t,e,i,s,n=void 0,o={}){const d=this.market(t);let c,h;[c,o]=this.handleMarketTypeAndParams("createOrder",d,o),[h,o]=this.handleMarginModeAndParams("createOrder",o);const l={symbol:d.id,orderType:e};let u,p;[u,o]=this.handleParamBool(o,"hedged",!1),[p,o]=this.handleParamBool(o,"oneWayMode"),void 0!==p&&(u=!p);const f="market"===e,m=this.safeValue2(o,"stopPrice","triggerPrice"),g=this.safeValue(o,"stopLossPrice"),y=this.safeValue(o,"takeProfitPrice"),v=this.safeValue(o,"stopLoss"),b=this.safeValue(o,"takeProfit"),w=void 0!==m,S=void 0!==g,k=void 0!==y,O=void 0!==v,T=void 0!==b,P=S||k,_=O||T,A=this.safeString(o,"trailingTriggerPrice",this.numberToString(n)),I=this.safeString2(o,"trailingPercent","callbackRatio"),x=void 0!==I;if(this.sum(w,S,k,x)>1)throw new r.ExchangeError(this.id+" createOrder() params can only contain one of triggerPrice, stopLossPrice, takeProfitPrice, trailingPercent");"limit"===e&&(l.price=this.priceToPrecision(t,n));const E=this.safeString2(o,"triggerPriceType","triggerType","mark_price"),M=this.safeBool(o,"reduceOnly",!1),C=this.safeString2(o,"clientOid","clientOrderId"),B=this.safeString2(o,"force","timeInForce");let N;[N,o]=this.handlePostOnly(f,"post_only"===B,o);const R=this.safeStringUpper(this.options,"defaultTimeInForce"),L=this.safeStringUpper(o,"timeInForce",R);if(N?l.force="post_only":"GTC"===L?l.force="GTC":"FOK"===L?l.force="FOK":"IOC"===L&&(l.force="IOC"),o=this.omit(o,["stopPrice","triggerType","stopLossPrice","takeProfitPrice","stopLoss","takeProfit","postOnly","reduceOnly","clientOrderId","trailingPercent","trailingTriggerPrice"]),"swap"===c||"future"===c){let e;if(l.marginCoin=d.settleId,l.size=this.amountToPrecision(t,s),[e,o]=this.handleProductTypeAndParams(d,o),l.productType=e,void 0!==C&&(l.clientOid=C),(w||P||x)&&(l.triggerType=E),x){if(!f)throw new r.BadRequest(this.id+" createOrder() bitget trailing orders must be market orders");if(void 0===A)throw new r.ArgumentsRequired(this.id+" createOrder() bitget trailing orders must have a trailingTriggerPrice param");l.planType="track_plan",l.triggerPrice=this.priceToPrecision(t,A),l.callbackRatio=I}else if(w){if(l.planType="normal_plan",l.triggerPrice=this.priceToPrecision(t,m),void 0!==n&&(l.executePrice=this.priceToPrecision(t,n)),O){const e=this.safeString2(v,"triggerPrice","stopPrice");l.stopLossTriggerPrice=this.priceToPrecision(t,e);const i=this.safeString(v,"price");l.stopLossExecutePrice=this.priceToPrecision(t,i);const s=this.safeString(v,"type","mark_price");l.stopLossTriggerType=s}if(T){const e=this.safeString2(b,"triggerPrice","stopPrice");l.stopSurplusTriggerPrice=this.priceToPrecision(t,e);const i=this.safeString(b,"price");l.stopSurplusExecutePrice=this.priceToPrecision(t,i);const s=this.safeString(b,"type","mark_price");l.stopSurplusTriggerType=s}}else if(P){if(!f)throw new r.ExchangeError(this.id+" createOrder() bitget stopLoss or takeProfit orders must be market orders");l.holdSide=u?"sell"===i?"long":"short":"sell"===i?"buy":"sell",S?(l.triggerPrice=this.priceToPrecision(t,g),l.planType="pos_loss"):k&&(l.triggerPrice=this.priceToPrecision(t,y),l.planType="pos_profit")}else{if(O){const e=this.safeValue2(v,"triggerPrice","stopPrice");l.presetStopLossPrice=this.priceToPrecision(t,e)}if(T){const e=this.safeValue2(b,"triggerPrice","stopPrice");l.presetStopSurplusPrice=this.priceToPrecision(t,e)}}if(!P){void 0===h&&(h="cross");const t="cross"===h?"crossed":"isolated";l.marginMode=t;let e=i;M?u?(e="buy"===i?"sell":"buy",l.tradeSide="Close"):l.reduceOnly="YES":u&&(l.tradeSide="Open"),l.side=e}}else{if("spot"!==c)throw new r.NotSupported(this.id+" createOrder() does not support "+c+" orders");{if(P||_)throw new r.InvalidOrder(this.id+" createOrder() does not support stop loss/take profit orders on spot markets, only swap markets");let e,d;l.side=i;let c=!0;if([c,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0),f&&"buy"===i){d="total";const i=this.safeNumber(o,"cost");if(o=this.omit(o,"cost"),void 0!==i)e=this.costToPrecision(t,i);else if(c){if(void 0===n)throw new r.InvalidOrder(this.id+" createOrder() requires the price argument for market buy orders to calculate the total cost to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend in the amount argument");{const i=this.numberToString(s),r=this.numberToString(n),o=a.Y.stringMul(i,r);e=this.costToPrecision(t,o)}}else e=this.costToPrecision(t,s)}else d="amount",e=this.amountToPrecision(t,s);void 0!==C&&(l.clientOid=C),void 0!==h?(l.loanType="normal",f&&"buy"===i?l.quoteSize=e:l.baseSize=e):(void 0!==e&&(l.size=e),void 0!==m&&(l.planType=d,l.triggerType=E,l.triggerPrice=this.priceToPrecision(t,m),void 0!==n&&(l.executePrice=this.priceToPrecision(t,n))))}}return this.extend(l,o)}async createUtaOrders(t,e={}){await this.loadMarkets();const i=[];let s,a;for(let e=0;e<t.length;e++){const n=t[e],o=this.safeString(n,"symbol");if(void 0===s)s=o;else if(s!==o)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const d=this.safeString(n,"type"),c=this.safeString(n,"side"),h=this.safeValue(n,"amount"),l=this.safeValue(n,"price"),u=this.safeValue(n,"params",{}),p=this.handleMarginModeAndParams("createOrders",u)[0];if(void 0!==p)if(void 0===a)a=p;else if(a!==p)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same margin mode (isolated or cross)");const f=this.createUtaOrderRequest(o,d,c,h,l,u);i.push(f)}const n=this.market(s),o=await this.privateUtaPostV3TradePlaceBatch(i),d=this.safeList(o,"data",[]);return this.parseOrders(d,n)}async createOrders(t,e={}){let i;if(await this.loadMarkets(),[i,e]=this.handleOptionAndParams(e,"createOrders","uta",!1),i)return await this.createUtaOrders(t,e);const s=[];let a,n;for(let e=0;e<t.length;e++){const i=t[e],o=this.safeString(i,"symbol");if(void 0===a)a=o;else if(a!==o)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const d=this.safeString(i,"type"),c=this.safeString(i,"side"),h=this.safeValue(i,"amount"),l=this.safeValue(i,"price"),u=this.safeValue(i,"params",{}),p=this.handleMarginModeAndParams("createOrders",u)[0];if(void 0!==p)if(void 0===n)n=p;else if(n!==p)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same margin mode (isolated or cross)");const f=this.createOrderRequest(o,d,c,h,l,u);s.push(f)}const o=this.market(a),d={symbol:o.id,orderList:s};let c;if(o.swap||o.future){void 0===n&&(n="cross");const t="cross"===n?"crossed":"isolated";let i;d.marginMode=t,d.marginCoin=o.settleId,[i,e]=this.handleProductTypeAndParams(o,e),d.productType=i,c=await this.privateMixPostV2MixOrderBatchPlaceOrder(d)}else c="isolated"===n?await this.privateMarginPostV2MarginIsolatedBatchPlaceOrder(d):"cross"===n?await this.privateMarginPostV2MarginCrossedBatchPlaceOrder(d):await this.privateSpotPostV2SpotTradeBatchOrders(d);const h=this.safeValue(c,"data",{}),l=this.safeValue(h,"failureList",[]),u=this.safeValue(h,"successList",[]),p=this.arrayConcat(u,l);return this.parseOrders(p,o)}async editOrder(t,e,i,s,n=void 0,o=void 0,d={}){await this.loadMarkets();const c=this.market(e),h={},l=this.safeString2(d,"clientOrderId","clientOid");void 0!==l?(d=this.omit(d,["clientOrderId"]),h.clientOid=l):h.orderId=t;const u="market"===i,p=this.safeValue2(d,"stopPrice","triggerPrice"),f=void 0!==p,m=this.safeValue(d,"stopLossPrice"),g=void 0!==m,y=this.safeValue(d,"takeProfitPrice"),v=void 0!==y,b=this.safeValue(d,"stopLoss"),w=this.safeValue(d,"takeProfit"),S=void 0!==b,k=void 0!==w,O=this.safeString(d,"trailingTriggerPrice",this.numberToString(o)),T=this.safeString2(d,"trailingPercent","newCallbackRatio"),P=void 0!==T;if(this.sum(f,g,v,P)>1)throw new r.ExchangeError(this.id+" editOrder() params can only contain one of triggerPrice, stopLossPrice, takeProfitPrice, trailingPercent");let _,A,I;if(d=this.omit(d,["stopPrice","triggerType","stopLossPrice","takeProfitPrice","stopLoss","takeProfit","clientOrderId","trailingTriggerPrice","trailingPercent"]),[A,d]=this.handleProductTypeAndParams(c,d),[I,d]=this.handleOptionAndParams(d,"editOrder","uta",!1),I)if(void 0!==n&&(h.qty=this.amountToPrecision(e,n)),g||v){if(g){const t=this.safeString(d,"slTriggerBy","mark");h.slTriggerBy=t,h.stopLoss=this.priceToPrecision(e,m),void 0!==o?(h.slLimitPrice=this.priceToPrecision(e,o),h.slOrderType=this.safeString(d,"slOrderType","limit")):h.slOrderType=this.safeString(d,"slOrderType","market")}else if(v){const t=this.safeString(d,"tpTriggerBy","mark");h.tpTriggerBy=t,h.takeProfit=this.priceToPrecision(e,y),void 0!==o?(h.tpLimitPrice=this.priceToPrecision(e,o),h.tpOrderType=this.safeString(d,"tpOrderType","limit")):h.tpOrderType=this.safeString(d,"tpOrderType","market")}d=this.omit(d,["stopLossPrice","takeProfitPrice"]),_=await this.privateUtaPostV3TradeModifyStrategyOrder(this.extend(h,d))}else void 0!==o&&(h.price=this.priceToPrecision(e,o)),_=await this.privateUtaPostV3TradeModifyOrder(this.extend(h,d));else if(c.spot){const t=this.safeString(d,"cost");d=this.omit(d,"cost");if((this.safeBool(this.options,"editMarketBuyOrderRequiresPrice",!0)||void 0!==t)&&u&&"buy"===s){if(void 0===o&&void 0===t)throw new r.InvalidOrder(this.id+" editOrder() requires price argument for market buy orders on spot markets to calculate the total amount to spend (amount * price), alternatively provide `cost` in the params");{const i=this.numberToString(n),s=this.numberToString(o),r=void 0===t?a.Y.stringMul(i,s):t;h.size=this.priceToPrecision(e,r)}}else h.size=this.amountToPrecision(e,n);h.orderType=i,void 0!==p?(h.triggerPrice=this.priceToPrecision(e,p),h.executePrice=this.priceToPrecision(e,o)):h.price=this.priceToPrecision(e,o),void 0!==p?_=await this.privateSpotPostV2SpotTradeModifyPlanOrder(this.extend(h,d)):(h.symbol=c.id,_=await this.privateSpotPostV2SpotTradeCancelReplaceOrder(this.extend(h,d)))}else{if(!c.swap&&!c.future)throw new r.NotSupported(this.id+" editOrder() does not support "+c.type+" orders");if(h.symbol=c.id,h.productType=A,v||g||(h.newSize=this.amountToPrecision(e,n),void 0===o||P||(h.newPrice=this.priceToPrecision(e,o))),P){if(!u)throw new r.BadRequest(this.id+" editOrder() bitget trailing orders must be market orders");void 0!==O&&(h.newTriggerPrice=this.priceToPrecision(e,O)),h.newCallbackRatio=T,_=await this.privateMixPostV2MixOrderModifyPlanOrder(this.extend(h,d))}else if(v||g)h.marginCoin=c.settleId,h.size=this.amountToPrecision(e,n),void 0!==o&&(h.executePrice=this.priceToPrecision(e,o)),g?h.triggerPrice=this.priceToPrecision(e,m):v&&(h.triggerPrice=this.priceToPrecision(e,y)),_=await this.privateMixPostV2MixOrderModifyTpslOrder(this.extend(h,d));else if(f){if(h.newTriggerPrice=this.priceToPrecision(e,p),S){const t=this.safeNumber2(b,"triggerPrice","stopPrice");h.newStopLossTriggerPrice=this.priceToPrecision(e,t);const i=this.safeNumber(b,"price");h.newStopLossExecutePrice=this.priceToPrecision(e,i);const s=this.safeString(b,"type","mark_price");h.newStopLossTriggerType=s}if(k){const t=this.safeNumber2(w,"triggerPrice","stopPrice");h.newSurplusTriggerPrice=this.priceToPrecision(e,t);const i=this.safeNumber(w,"price");h.newStopSurplusExecutePrice=this.priceToPrecision(e,i);const s=this.safeString(w,"type","mark_price");h.newStopSurplusTriggerType=s}_=await this.privateMixPostV2MixOrderModifyPlanOrder(this.extend(h,d))}else{const t=this.uuid(),i=this.safeString2(d,"newClientOid","newClientOrderId",t);if(d=this.omit(d,"newClientOrderId"),h.newClientOid=i,S){const t=this.safeValue2(b,"triggerPrice","stopPrice");h.newPresetStopLossPrice=this.priceToPrecision(e,t)}if(k){const t=this.safeValue2(w,"triggerPrice","stopPrice");h.newPresetStopSurplusPrice=this.priceToPrecision(e,t)}_=await this.privateMixPostV2MixOrderModifyOrder(this.extend(h,d))}}const x=this.safeDict(_,"data",{});return this.parseOrder(x,c)}async cancelOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e);let a,n;[a,i]=this.handleMarginModeAndParams("cancelOrder",i);const o={},d=this.safeValue(i,"trailing"),c=this.safeValue2(i,"stop","trigger");let h;i=this.omit(i,["stop","trigger","trailing"]),s.spot&&c||(o.symbol=s.id),[h,i]=this.handleOptionAndParams(i,"cancelOrder","uta",!1);const l=c||d,u=(s.swap||s.future)&&l&&!h,p=this.safeString2(i,"clientOrderId","clientOid");if(u){const e=[],s={};void 0!==p?(i=this.omit(i,"clientOrderId"),s.clientOid=p):s.orderId=t,e.push(s),o.orderIdList=e}else void 0!==p?(i=this.omit(i,"clientOrderId"),o.clientOid=p):o.orderId=t;if(h)n=c?await this.privateUtaPostV3TradeCancelStrategyOrder(this.extend(o,i)):await this.privateUtaPostV3TradeCancelOrder(this.extend(o,i));else if(s.swap||s.future){let t;if([t,i]=this.handleProductTypeAndParams(s,i),o.productType=t,d){const t=this.safeString(i,"planType","track_plan");o.planType=t,n=await this.privateMixPostV2MixOrderCancelPlanOrder(this.extend(o,i))}else n=c?await this.privateMixPostV2MixOrderCancelPlanOrder(this.extend(o,i)):await this.privateMixPostV2MixOrderCancelOrder(this.extend(o,i))}else{if(!s.spot)throw new r.NotSupported(this.id+" cancelOrder() does not support "+s.type+" orders");void 0!==a?"isolated"===a?n=await this.privateMarginPostV2MarginIsolatedCancelOrder(this.extend(o,i)):"cross"===a&&(n=await this.privateMarginPostV2MarginCrossedCancelOrder(this.extend(o,i))):n=c?await this.privateSpotPostV2SpotTradeCancelPlanOrder(this.extend(o,i)):await this.privateSpotPostV2SpotTradeCancelOrder(this.extend(o,i))}const f=this.safeValue(n,"data",{});let m;if(u){m=this.safeValue(f,"successList",[])[0]}else m=h&&c?n:f;return this.parseOrder(m,s)}async cancelUtaOrders(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e);let a;[a,i]=this.handleProductTypeAndParams(s,i);const n=[];for(let e=0;e<t.length;e++){const i={orderId:t[e],symbol:s.id,category:a};n.push(i)}const o=await this.privateUtaPostV3TradeCancelBatch(n),d=this.safeList(o,"data",[]);return this.parseOrders(d,s)}async cancelOrders(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e);let a,n;if([a,i]=this.handleOptionAndParams(i,"cancelOrders","uta",!1),a)return await this.cancelUtaOrders(t,e,i);[n,i]=this.handleMarginModeAndParams("cancelOrders",i);const o=this.safeValue2(i,"stop","trigger");i=this.omit(i,["stop","trigger"]);const d=[];for(let e=0;e<t.length;e++){const i={orderId:t[e]};d.push(i)}const c={symbol:s.id};let h;if(s.spot&&void 0===n?c.orderList=d:c.orderIdList=d,s.spot)h=void 0!==n?"cross"===n?await this.privateMarginPostV2MarginCrossedBatchCancelOrder(this.extend(c,i)):await this.privateMarginPostV2MarginIsolatedBatchCancelOrder(this.extend(c,i)):await this.privateSpotPostV2SpotTradeBatchCancelOrder(this.extend(c,i));else{let t;[t,i]=this.handleProductTypeAndParams(s,i),c.productType=t,h=o?await this.privateMixPostV2MixOrderCancelPlanOrder(this.extend(c,i)):await this.privateMixPostV2MixOrderBatchCancelOrders(this.extend(c,i))}const l=this.safeValue(h,"data",{}),u=this.safeList(l,"successList",[]);return this.parseOrders(u,s)}async cancelAllOrders(t=void 0,e={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const i=this.market(t);let s,a;[s,e]=this.handleMarginModeAndParams("cancelAllOrders",e),[a,e]=this.handleProductTypeAndParams(i,e);const n={symbol:i.id},o=this.safeBool2(e,"stop","trigger");let d,c;if(e=this.omit(e,["stop","trigger"]),[c,e]=this.handleOptionAndParams(e,"cancelAllOrders","uta",!1),c)"SPOT"===a&&void 0!==s&&(a="MARGIN"),n.category=a,d=await this.privateUtaPostV3TradeCancelSymbolOrder(this.extend(n,e));else{if(i.spot){if(void 0!==s)throw new r.NotSupported(this.id+" cancelAllOrders() does not support margin markets, you can use cancelOrders() instead");{if(o){const t={symbolList:[i.id]};d=await this.privateSpotPostV2SpotTradeBatchCancelPlanOrder(this.extend(t,e))}else d=await this.privateSpotPostV2SpotTradeCancelSymbolOrder(this.extend(n,e));const t=this.safeInteger(d,"requestTime"),s=this.safeDict(d,"data"),r=this.safeString(s,"symbol");return[this.safeOrder({info:d,symbol:this.safeSymbol(r,void 0,void 0,"spot"),timestamp:t,datetime:this.iso8601(t)})]}}n.productType=a,d=o?await this.privateMixPostV2MixOrderCancelPlanOrder(this.extend(n,e)):await this.privateMixPostV2MixOrderBatchCancelOrders(this.extend(n,e))}const h=this.safeDict(d,"data"),l=this.safeListN(h,["resultList","successList","list"]),u=this.safeList2(h,"failure","failureList");let p;return p=void 0!==l&&void 0!==u?this.arrayConcat(l,u):l,this.parseOrders(p)}async fetchOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={},n=this.safeString2(i,"clientOrderId","clientOid");let o,d;if(void 0!==n?(i=this.omit(i,["clientOrderId"]),a.clientOid=n):a.orderId=t,[d,i]=this.handleOptionAndParams(i,"fetchOrder","uta",!1),d)o=await this.privateUtaGetV3TradeOrderInfo(this.extend(a,i));else if(s.spot)o=await this.privateSpotGetV2SpotTradeOrderInfo(this.extend(a,i));else{if(!s.swap&&!s.future)throw new r.NotSupported(this.id+" fetchOrder() does not support "+s.type+" orders");{let t;a.symbol=s.id,[t,i]=this.handleProductTypeAndParams(s,i),a.productType=t,o=await this.privateMixGetV2MixOrderDetail(this.extend(a,i))}}d||"string"!=typeof o||(o=JSON.parse(o));const c=this.safeDict(o,"data");if(void 0!==c&&!Array.isArray(c))return this.parseOrder(c,s);const h=this.safeList(o,"data",[]);if(0===h.length)throw new r.OrderNotFound(this.id+" fetchOrder() could not find order id "+t+" in "+this.json(o));const l=this.safeDict(h,0,{});return this.parseOrder(l,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){let r,a;await this.loadMarkets();let n,o,d={};if([n,s]=this.handleMarginModeAndParams("fetchOpenOrders",s),[o,s]=this.handleOptionAndParams(s,"fetchOpenOrders","uta",!1),void 0!==t){r=this.market(t),d.symbol=r.id;const e=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot"),i="type"in r?r.type:e;a=this.safeString(s,"type",i)}else{const t=this.safeString2(this.options,"fetchOpenOrders","defaultType","spot");a=this.safeString(s,"type",t)}let c,h=!1;if([h,s]=this.handleOptionAndParams(s,"fetchOpenOrders","paginate"),h){let r,d;return o?(r="cursor",d="cursor"):"spot"===a?void 0!==n&&(r="minId",d="idLessThan"):(r="endId",d="idLessThan"),await this.fetchPaginatedCallCursor("fetchOpenOrders",t,e,i,s,r,d)}const l=this.safeBool(s,"trailing"),u=this.safeBool2(s,"stop","trigger"),p=void 0!==this.safeString(s,"planType"),f=u||p;if([d,s]=this.handleUntilOption("endTime",d,s),void 0!==e&&(d.startTime=e),void 0!==i&&(d.limit=i),!o&&("swap"===a||"future"===a||void 0!==n)){const t=this.safeString2(s,"clientOid","clientOrderId");s=this.omit(s,"clientOrderId"),void 0!==t&&(d.clientOid=t)}let m;if([m,s]=this.handleProductTypeAndParams(r,s),s=this.omit(s,["type","stop","trigger","trailing"]),o)"spot"===a&&void 0!==n&&(m="MARGIN"),d.category=m,c=u?await this.privateUtaGetV3TradeUnfilledStrategyOrders(this.extend(d,s)):await this.privateUtaGetV3TradeUnfilledOrders(this.extend(d,s));else if("spot"===a)void 0!==n?(void 0===e&&(e=this.milliseconds()-7776e6,d.startTime=e),"isolated"===n?c=await this.privateMarginGetV2MarginIsolatedOpenOrders(this.extend(d,s)):"cross"===n&&(c=await this.privateMarginGetV2MarginCrossedOpenOrders(this.extend(d,s)))):c=u?await this.privateSpotGetV2SpotTradeCurrentPlanOrder(this.extend(d,s)):await this.privateSpotGetV2SpotTradeUnfilledOrders(this.extend(d,s));else if(d.productType=m,l){const t=this.safeString(s,"planType","track_plan");d.planType=t,c=await this.privateMixGetV2MixOrderOrdersPlanPending(this.extend(d,s))}else if(f){const t=this.safeString(s,"planType","normal_plan");d.planType=t,c=await this.privateMixGetV2MixOrderOrdersPlanPending(this.extend(d,s))}else c=await this.privateMixGetV2MixOrderOrdersPending(this.extend(d,s));const g=this.safeValue(c,"data");if(o){let t;return t=u?this.safeList(c,"data",[]):this.safeList(g,"list",[]),this.parseOrders(t,r,e,i)}if("spot"!==a){const t=this.safeList(g,"entrustedList",[]);return this.parseOrders(t,r,e,i)}if(void 0!==n||u){const t=this.safeList(g,"orderList",[]);return this.parseOrders(t,r,e,i)}return this.parseOrders(g,r,e,i)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.fetchCanceledAndClosedOrders(t,e,i,s);return this.filterBy(r,"status","closed")}async fetchCanceledOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.fetchCanceledAndClosedOrders(t,e,i,s);return this.filterBy(r,"status","canceled")}async fetchCanceledAndClosedOrders(t=void 0,e=void 0,i=void 0,s={}){let a,n;if([a,s]=this.handleOptionAndParams(s,"fetchCanceledAndClosedOrders","uta",!1),a)return await this.fetchUtaCanceledAndClosedOrders(t,e,i,s);await this.loadMarkets();let o,d,c={};void 0!==t&&(n=this.market(t),c.symbol=n.id),[o,s]=this.handleMarketTypeAndParams("fetchCanceledAndClosedOrders",n,s),[d,s]=this.handleMarginModeAndParams("fetchCanceledAndClosedOrders",s);let h,l=!1;if([l,s]=this.handleOptionAndParams(s,"fetchCanceledAndClosedOrders","paginate"),l){let r;return"spot"===o?void 0!==d&&(r="minId"):r="endId",await this.fetchPaginatedCallCursor("fetchCanceledAndClosedOrders",t,e,i,s,r,"idLessThan")}const u=this.safeBool(s,"trailing"),p=this.safeBool2(s,"stop","trigger");if(s=this.omit(s,["stop","trigger","trailing"]),[c,s]=this.handleUntilOption("endTime",c,s),void 0!==e&&(c.startTime=e),void 0!==i&&(c.limit=i),"swap"===o||"future"===o||void 0!==d){const t=this.safeString2(s,"clientOid","clientOrderId");s=this.omit(s,"clientOrderId"),void 0!==t&&(c.clientOid=t)}const f=this.milliseconds();if("spot"===o)if(void 0!==d)void 0===e&&(e=f-7776e6,c.startTime=e),"isolated"===d?h=await this.privateMarginGetV2MarginIsolatedHistoryOrders(this.extend(c,s)):"cross"===d&&(h=await this.privateMarginGetV2MarginCrossedHistoryOrders(this.extend(c,s)));else if(p){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchCanceledAndClosedOrders() requires a symbol argument");const i=this.safeIntegerN(s,["endTime","until"]);s=this.omit(s,["until"]),void 0===e&&(e=f-7776e6,c.startTime=e),void 0===i&&(c.endTime=f),h=await this.privateSpotGetV2SpotTradeHistoryPlanOrder(this.extend(c,s))}else h=await this.privateSpotGetV2SpotTradeHistoryOrders(this.extend(c,s));else{let t;[t,s]=this.handleProductTypeAndParams(n,s),c.productType=t;const e=void 0!==this.safeString(s,"planType");if(u){const t=this.safeString(s,"planType","track_plan");c.planType=t,h=await this.privateMixGetV2MixOrderOrdersPlanHistory(this.extend(c,s))}else if(p||e){const t=this.safeString(s,"planType","normal_plan");c.planType=t,h=await this.privateMixGetV2MixOrderOrdersPlanHistory(this.extend(c,s))}else h=await this.privateMixGetV2MixOrderOrdersHistory(this.extend(c,s))}const m=this.safeValue(h,"data",{});if("spot"!==o)return this.parseOrders(this.safeValue(m,"entrustedList",[]),n,e,i);if(void 0!==d||p)return this.parseOrders(this.safeValue(m,"orderList",[]),n,e,i);"string"==typeof h&&(h=JSON.parse(h));const g=this.safeList(h,"data",[]);return this.parseOrders(g,n,e,i)}async fetchUtaCanceledAndClosedOrders(t=void 0,e=void 0,i=void 0,s={}){let r,a;if(await this.loadMarkets(),void 0!==t&&(r=this.market(t)),[a,s]=this.handleProductTypeAndParams(r,s),"SPOT"===a){let t;[t,s]=this.handleMarginModeAndParams("fetchCanceledAndClosedOrders",s),void 0!==t&&(a="MARGIN")}let n,o={category:a},d=!1;if([d,s]=this.handleOptionAndParams(s,"fetchCanceledAndClosedOrders","paginate"),d)return await this.fetchPaginatedCallCursor("fetchCanceledAndClosedOrders",t,e,i,s,"cursor","cursor");[o,s]=this.handleUntilOption("endTime",o,s),void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i);const c=this.safeBool2(s,"stop","trigger");s=this.omit(s,["stop","trigger"]),n=c?await this.privateUtaGetV3TradeHistoryStrategyOrders(this.extend(o,s)):await this.privateUtaGetV3TradeHistoryOrders(this.extend(o,s));const h=this.safeDict(n,"data",{}),l=this.safeList(h,"list",[]);return this.parseOrders(l,r,e,i)}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.safeString(s,"symbol");let a,n;s=this.omit(s,"symbol"),void 0!==r&&(a=this.market(r)),[n,s]=this.handleMarketTypeAndParams("fetchLedger",a,s);let o,d=!1;if([d,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),d){let t;return"spot"!==n&&(t="endId"),await this.fetchPaginatedCallCursor("fetchLedger",r,e,i,s,t,"idLessThan")}let c,h={};if(void 0!==t&&(o=this.currency(t),h.coin=o.id),[h,s]=this.handleUntilOption("endTime",h,s),void 0!==e&&(h.startTime=e),void 0!==i&&(h.limit=i),"spot"===n)c=await this.privateSpotGetV2SpotAccountBills(this.extend(h,s));else{let t;void 0!==r&&(h.symbol=a.id),[t,s]=this.handleProductTypeAndParams(a,s),h.productType=t,c=await this.privateMixGetV2MixAccountBill(this.extend(h,s))}const l=this.safeValue(c,"data");if("swap"===n||"future"===n){const t=this.safeValue(l,"bills",[]);return this.parseLedger(t,o,e,i)}return this.parseLedger(l,o,e,i)}parseLedgerEntry(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeCurrencyCode(i,e);e=this.safeCurrency(i,e);const r=this.safeInteger(t,"cTime"),n=this.safeNumber(t,"balance"),o=this.safeNumber2(t,"fees","fee"),d=this.safeString2(t,"size","amount"),c=this.parseNumber(a.Y.stringAbs(d));let h="in";return d.indexOf("-")>=0&&(h="out"),this.safeLedgerEntry({info:t,id:this.safeString(t,"billId"),timestamp:r,datetime:this.iso8601(r),direction:h,account:void 0,referenceId:void 0,referenceAccount:void 0,type:this.parseLedgerType(this.safeString(t,"businessType")),currency:s,amount:c,before:void 0,after:n,status:void 0,fee:{currency:s,cost:o}},e)}parseLedgerType(t){return this.safeString({trans_to_cross:"transfer",trans_from_cross:"transfer",trans_to_exchange:"transfer",trans_from_exchange:"transfer",trans_to_isolated:"transfer",trans_from_isolated:"transfer",trans_to_contract:"transfer",trans_from_contract:"transfer",trans_to_otc:"transfer",trans_from_otc:"transfer",open_long:"trade",close_long:"trade",open_short:"trade",close_short:"trade",force_close_long:"trade",force_close_short:"trade",burst_long_loss_query:"trade",burst_short_loss_query:"trade",force_buy:"trade",force_sell:"trade",burst_buy:"trade",burst_sell:"trade",delivery_long:"settlement",delivery_short:"settlement",contract_settle_fee:"fee",append_margin:"transaction",adjust_down_lever_append_margin:"transaction",reduce_margin:"transaction",auto_append_margin:"transaction",cash_gift_issue:"cashback",cash_gift_recycle:"cashback",bonus_issue:"rebate",bonus_recycle:"rebate",bonus_expired:"rebate",transfer_in:"transfer",transfer_out:"transfer",deposit:"deposit",withdraw:"withdrawal",buy:"trade",sell:"trade"},t,t)}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let a;if([a,s]=this.handleOptionAndParams(s,"fetchMyTrades","uta",!1),!a&&void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const n=this.market(t);let o={};[o,s]=this.handleUntilOption("endTime",o,s),void 0!==e&&(o.startTime=e),void 0!==i&&(o.limit=i);let d,c,h=!1;if([h,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),[d,s]=this.handleMarginModeAndParams("fetchMyTrades",s),h){let r,o;return a?(r="cursor",o="cursor"):n.spot?void 0!==d&&(r="minId",o="idLessThan"):(r="endId",o="idLessThan"),await this.fetchPaginatedCallCursor("fetchMyTrades",t,e,i,s,r,o)}if(a)c=await this.privateUtaGetV3TradeFills(this.extend(o,s));else if(o.symbol=n.id,n.spot)void 0!==d?(void 0===e&&(o.startTime=this.milliseconds()-7776e6),"isolated"===d?c=await this.privateMarginGetV2MarginIsolatedFills(this.extend(o,s)):"cross"===d&&(c=await this.privateMarginGetV2MarginCrossedFills(this.extend(o,s)))):c=await this.privateSpotGetV2SpotTradeFills(this.extend(o,s));else{let t;[t,s]=this.handleProductTypeAndParams(n,s),o.productType=t,c=await this.privateMixGetV2MixOrderFills(this.extend(o,s))}const l=this.safeValue(c,"data");if(a){const t=this.safeList(l,"list",[]);return this.parseTrades(t,n,e,i)}if(n.swap||n.future){const t=this.safeList(l,"fillList",[]);return this.parseTrades(t,n,e,i)}if(void 0!==d){const t=this.safeList(l,"fills",[]);return this.parseTrades(t,n,e,i)}return this.parseTrades(l,n,e,i)}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t);let s;[s,e]=this.handleProductTypeAndParams(i,e);const r={symbol:i.id};let a,n,o;if([n,e]=this.handleOptionAndParams(e,"fetchPosition","uta",!1),n){r.category=s,a=await this.privateUtaGetV3PositionCurrentPosition(this.extend(r,e));const t=this.safeDict(a,"data",{});o=this.safeList(t,"list",[])}else r.marginCoin=i.settleId,r.productType=s,a=await this.privateMixGetV2MixPositionSinglePosition(this.extend(r,e)),o=this.safeList(a,"data",[]);const d=this.safeDict(o,0,{});return this.parsePosition(d,i)}async fetchPositions(t=void 0,e={}){await this.loadMarkets();let i,s=!1;if([s,e]=this.handleOptionAndParams(e,"fetchPositions","paginate"),s)return await this.fetchPaginatedCallCursor("fetchPositions",void 0,void 0,void 0,e,"endId","idLessThan");let a,n;if(this.safeBool(e,"useHistoryEndpoint",!1)?i="privateMixGetV2MixPositionHistoryPosition":[i,e]=this.handleOptionAndParams(e,"fetchPositions","method","privateMixGetV2MixPositionAllPosition"),void 0!==t){const e=this.safeString(t,0);void 0!==e&&(a=this.market(e))}[n,e]=this.handleProductTypeAndParams(a,e);const o={};let d,c,h=!1;if([c,e]=this.handleOptionAndParams(e,"fetchPositions","uta",!1),c)o.category=n,d=await this.privateUtaGetV3PositionCurrentPosition(this.extend(o,e));else if("privateMixGetV2MixPositionAllPosition"===i){let t=this.safeString(e,"marginCoin","USDT");if(void 0!==a)t=a.settleId;else if("USDT-FUTURES"===n)t="USDT";else if("USDC-FUTURES"===n)t="USDC";else if("SUSDT-FUTURES"===n)t="SUSDT";else if("SUSDC-FUTURES"===n)t="SUSDC";else if(("SCOIN-FUTURES"===n||"COIN-FUTURES"===n)&&void 0===t)throw new r.ArgumentsRequired(this.id+" fetchPositions() requires a marginCoin parameter that matches the productType");o.marginCoin=t,o.productType=n,d=await this.privateMixGetV2MixPositionAllPosition(this.extend(o,e))}else h=!0,void 0!==a&&(o.symbol=a.id),o.productType=n,d=await this.privateMixGetV2MixPositionHistoryPosition(this.extend(o,e));let l=[];if(c||h){const t=this.safeDict(d,"data",{});l=this.safeList(t,"list",[])}else l=this.safeList(d,"data",[]);const u=[];for(let t=0;t<l.length;t++)u.push(this.parsePosition(l[t],a));return t=this.marketSymbols(t),this.filterByArrayPositions(u,"symbol",t,!1)}parsePosition(t,e=void 0){const i=this.safeString(t,"symbol"),s=(e=this.safeMarket(i,e,void 0,"contract")).symbol,r=this.safeIntegerN(t,["cTime","ctime","createdTime"]);let n,o,d=this.safeString(t,"marginMode");const c=this.safeString2(t,"unrealizedPL","unrealisedPnl"),h=this.safeString2(t,"marginSize","positionBalance");"isolated"===d?n=a.Y.stringAdd(h,c):"crossed"===d&&(d="cross",o=h);const l=this.safeString2(t,"posMode","holdMode");let u;"hedge_mode"===l?u=!0:"one_way_mode"===l&&(u=!1);const p=this.safeString2(t,"holdSide","posSide"),f=this.safeString(t,"leverage"),m=this.safeValue(e,"contractSize"),g=this.numberToString(m),y=this.safeString2(t,"total","openTotalPos"),v=this.safeStringN(t,["openPriceAvg","openAvgPrice","avgPrice"]),b=this.safeString(t,"keepMarginRate"),w=a.Y.stringMul(v,y);void 0===o&&(o=a.Y.stringDiv(w,f));let S=this.parseNumber(a.Y.stringDiv(y,g));void 0===S&&(S=this.safeNumber(t,"closeTotalPos"));const k=this.safeString(t,"markPrice"),O=a.Y.stringMul(y,k),T=a.Y.stringDiv(o,O);let P=this.parseNumber(this.omitZero(this.safeString(t,"liquidationPrice")));const _="0.9994";if(void 0===P&&"isolated"===d&&a.Y.stringGt(y,"0")){let t=a.Y.stringDiv(h,y),e=b;"short"===p&&(t=a.Y.stringNeg(t),e=a.Y.stringNeg(e));let i=a.Y.stringSub("1",e),s=a.Y.stringSub(v,t);"long"===p?i=a.Y.stringMul(i,_):s=a.Y.stringMul(s,_),P=this.parseNumber(a.Y.stringDiv(s,i))}const A=a.Y.stringMul(O,"0.0006"),I=a.Y.stringAdd(a.Y.stringMul(b,O),A),x=a.Y.stringMul(a.Y.stringDiv(c,o,4),"100");return this.safePosition({info:t,id:this.safeString2(t,"orderId","positionId"),symbol:s,notional:this.parseNumber(O),marginMode:d,liquidationPrice:P,entryPrice:this.parseNumber(v),unrealizedPnl:this.parseNumber(c),realizedPnl:this.safeNumberN(t,["pnl","curRealisedPnl","cumRealisedPnl"]),percentage:this.parseNumber(x),contracts:S,contractSize:m,markPrice:this.parseNumber(k),lastPrice:this.safeNumber2(t,"closeAvgPrice","closePriceAvg"),side:p,hedged:u,timestamp:r,datetime:this.iso8601(r),lastUpdateTimestamp:this.safeInteger2(t,"utime","updatedTime"),maintenanceMargin:this.parseNumber(I),maintenanceMarginPercentage:this.parseNumber(b),collateral:this.parseNumber(n),initialMargin:this.parseNumber(o),initialMarginPercentage:this.parseNumber(T),leverage:this.parseNumber(f),marginRatio:this.safeNumber2(t,"marginRatio","mmr"),stopLossPrice:void 0,takeProfitPrice:void 0})}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();const a=this.market(t),n={symbol:a.id};let o,d,c,h;if([o,s]=this.handleProductTypeAndParams(a,s),[d,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","uta",!1),d){void 0!==i&&(n.limit=i),n.category=o,c=await this.publicUtaGetV3MarketHistoryFundRate(this.extend(n,s));const t=this.safeDict(c,"data",{});h=this.safeList(t,"resultList",[])}else{let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),r)return await this.fetchPaginatedCallIncremental("fetchFundingRateHistory",t,e,i,s,"pageNo",100);void 0!==i&&(n.pageSize=i),n.productType=o,c=await this.publicMixGetV2MixMarketHistoryFundRate(this.extend(n,s)),h=this.safeList(c,"data",[])}const l=[];for(let t=0;t<h.length;t++){const e=h[t],i=this.safeString(e,"symbol"),s=this.safeSymbol(i,a),r=this.safeInteger2(e,"fundingTime","fundingRateTimestamp");l.push({info:e,symbol:s,fundingRate:this.safeNumber(e,"fundingRate"),timestamp:r,datetime:this.iso8601(r)})}const u=this.sortBy(l,"timestamp");return this.filterBySymbolSinceLimit(u,a.symbol,e,i)}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.swap)throw new r.BadSymbol(this.id+" fetchFundingRate() supports swap contracts only");let s;[s,e]=this.handleProductTypeAndParams(i,e);const a={symbol:i.id};let n,o;if([n,e]=this.handleOptionAndParams(e,"fetchFundingRate","uta",!1),n)o=await this.publicUtaGetV3MarketCurrentFundRate(this.extend(a,e));else{let t;a.productType=s,[t,e]=this.handleOptionAndParams(e,"fetchFundingRate","method","publicMixGetV2MixMarketCurrentFundRate"),"publicMixGetV2MixMarketCurrentFundRate"===t?o=await this.publicMixGetV2MixMarketCurrentFundRate(this.extend(a,e)):"publicMixGetV2MixMarketFundingTime"===t&&(o=await this.publicMixGetV2MixMarketFundingTime(this.extend(a,e)))}const d=this.safeList(o,"data",[]);return this.parseFundingRate(d[0],i)}async fetchFundingRates(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0!==t){const e=this.safeValue(t,0);i=this.market(e)}const s={};let r;[r,e]=this.handleProductTypeAndParams(i,e);let a,n="publicMixGetV2MixMarketTickers";[n,e]=this.handleOptionAndParams(e,"fetchFundingRates","method",n),s.productType=r,"publicMixGetV2MixMarketTickers"===n?a=await this.publicMixGetV2MixMarketTickers(this.extend(s,e)):"publicMixGetV2MixMarketCurrentFundRate"===n&&(a=await this.publicMixGetV2MixMarketCurrentFundRate(this.extend(s,e))),t=this.marketSymbols(t);const o=this.safeList(a,"data",[]);return this.parseFundingRates(o,t)}async fetchFundingIntervals(t=void 0,e={}){return await this.loadMarkets(),e=this.extend({method:"publicMixGetV2MixMarketCurrentFundRate"},e),await this.fetchFundingRates(t,e)}parseFundingRate(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeSymbol(i,e,void 0,"swap"),r=this.safeInteger2(t,"nextFundingTime","nextUpdate"),a=this.safeString2(t,"ratePeriod","fundingRateInterval"),n=this.safeInteger(t,"ts");let o;return void 0!==a&&(o=a+"h"),{info:t,symbol:s,markPrice:this.safeNumber(t,"markPrice"),indexPrice:this.safeNumber(t,"indexPrice"),interestRate:void 0,estimatedSettlePrice:void 0,timestamp:n,datetime:this.iso8601(n),fundingRate:this.safeNumber(t,"fundingRate"),fundingTimestamp:r,fundingDatetime:this.iso8601(r),nextFundingRate:void 0,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:o}}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){if(await this.loadMarkets(),void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingHistory() requires a symbol argument");let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchFundingHistory","paginate"),a)return await this.fetchPaginatedCallCursor("fetchFundingHistory",t,e,i,s,"endId","idLessThan");const n=this.market(t);if(!n.swap)throw new r.BadSymbol(this.id+" fetchFundingHistory() supports swap contracts only");let o;[o,s]=this.handleProductTypeAndParams(n,s);let d={symbol:n.id,marginCoin:n.settleId,businessType:"contract_settle_fee",productType:o};[d,s]=this.handleUntilOption("endTime",d,s),void 0!==e&&(d.startTime=e),void 0!==i&&(d.limit=i);const c=await this.privateMixGetV2MixAccountBill(this.extend(d,s)),h=this.safeValue(c,"data",{}),l=this.safeValue(h,"bills",[]);return this.parseFundingHistories(l,n,e,i)}parseFundingHistory(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeString(t,"coin"),r=this.safeInteger(t,"cTime");return{info:t,symbol:this.safeSymbol(i,e,void 0,"swap"),timestamp:r,datetime:this.iso8601(r),code:this.safeCurrencyCode(s),amount:this.safeNumber(t,"amount"),id:this.safeString(t,"billId")}}parseFundingHistories(t,e=void 0,i=void 0,s=void 0){const r=[];for(let i=0;i<t.length;i++){const s=t[i];"contract_settle_fee"===this.safeString(s,"businessType")&&r.push(this.parseFundingHistory(s,e))}const a=this.sortBy(r,"timestamp");let n;return void 0!==e&&(n=e.symbol),this.filterBySymbolSinceLimit(a,n,i,s)}async modifyMarginHelper(t,e,i,s={}){await this.loadMarkets();const r=this.safeString(s,"holdSide"),a=this.market(t);let n;[n,s]=this.handleProductTypeAndParams(a,s);const o={symbol:a.id,marginCoin:a.settleId,amount:this.amountToPrecision(t,e),holdSide:r,productType:n};s=this.omit(s,"holdSide");const d=await this.privateMixPostV2MixAccountSetMargin(this.extend(o,s));return this.extend(this.parseMarginModification(d,a),{amount:this.parseNumber(e),type:i})}parseMarginModification(t,e=void 0){const i="00000"===this.safeString(t,"code")?"ok":"failed";return{info:t,symbol:e.symbol,type:void 0,marginMode:"isolated",amount:void 0,total:void 0,code:e.settle,status:i,timestamp:void 0,datetime:void 0}}async reduceMargin(t,e,i={}){if(e>0)throw new r.BadRequest(this.id+" reduceMargin() amount parameter must be a negative value");if(void 0===this.safeString(i,"holdSide"))throw new r.ArgumentsRequired(this.id+" reduceMargin() requires a holdSide parameter, either long or short");return await this.modifyMarginHelper(t,e,"reduce",i)}async addMargin(t,e,i={}){if(void 0===this.safeString(i,"holdSide"))throw new r.ArgumentsRequired(this.id+" addMargin() requires a holdSide parameter, either long or short");return await this.modifyMarginHelper(t,e,"add",i)}async fetchLeverage(t,e={}){await this.loadMarkets();const i=this.market(t);let s;[s,e]=this.handleProductTypeAndParams(i,e);const r={symbol:i.id,marginCoin:i.settleId,productType:s},a=await this.privateMixGetV2MixAccountAccount(this.extend(r,e)),n=this.safeDict(a,"data",{});return this.parseLeverage(n,i)}parseLeverage(t,e=void 0){const i="crossed"===this.safeString(t,"marginMode"),s=i?"crossedMarginLeverage":"isolatedLongLever",r=i?"crossedMarginLeverage":"isolatedShortLever";return{info:t,symbol:e.symbol,marginMode:i?"cross":"isolated",longLeverage:this.safeInteger(t,s),shortLeverage:this.safeInteger(t,r)}}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");await this.loadMarkets();const s=this.market(e);let a;[a,i]=this.handleProductTypeAndParams(s,i);const n={symbol:s.id,leverage:this.numberToString(t)};let o,d;if([o,i]=this.handleOptionAndParams(i,"setLeverage","uta",!1),o){if("SPOT"===a){let t;[t,i]=this.handleMarginModeAndParams("fetchTrades",i),void 0!==t&&(a="MARGIN")}n.coin=s.settleId,n.category=a,d=await this.privateUtaPostV3AccountSetLeverage(this.extend(n,i))}else n.marginCoin=s.settleId,n.productType=a,d=await this.privateMixPostV2MixAccountSetLeverage(this.extend(n,i));return d}async setMarginMode(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a symbol argument");if("cross"===(t=t.toLowerCase())&&(t="crossed"),"isolated"!==t&&"crossed"!==t)throw new r.ArgumentsRequired(this.id+" setMarginMode() marginMode must be either isolated or crossed (cross)");await this.loadMarkets();const s=this.market(e);let a;[a,i]=this.handleProductTypeAndParams(s,i);const n={symbol:s.id,marginCoin:s.settleId,marginMode:t,productType:a};return await this.privateMixPostV2MixAccountSetMarginMode(this.extend(n,i))}async setPositionMode(t,e=void 0,i={}){await this.loadMarkets();const s=t?"hedge_mode":"one_way_mode",r={};let a,n,o,d;return void 0!==e&&(a=this.market(e)),[n,i]=this.handleProductTypeAndParams(a,i),[o,i]=this.handleOptionAndParams(i,"setPositionMode","uta",!1),o?(r.holdMode=s,d=await this.privateUtaPostV3AccountSetHoldMode(this.extend(r,i))):(r.posMode=s,r.productType=n,d=await this.privateMixPostV2MixAccountSetPositionMode(this.extend(r,i))),d}async fetchOpenInterest(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.contract)throw new r.BadRequest(this.id+" fetchOpenInterest() supports contract markets only");let s;[s,e]=this.handleProductTypeAndParams(i,e);const a={symbol:i.id};let n,o;[n,e]=this.handleOptionAndParams(e,"fetchOpenInterest","uta",!1),n?(a.category=s,o=await this.publicUtaGetV3MarketOpenInterest(this.extend(a,e))):(a.productType=s,o=await this.publicMixGetV2MixMarketOpenInterest(this.extend(a,e)));const d=this.safeDict(o,"data",{});return this.parseOpenInterest(d,i)}parseOpenInterest(t,e=void 0){const i=this.safeList2(t,"openInterestList","list",[]),s=this.safeInteger(t,"ts"),r=this.safeString(i[0],"symbol");return this.safeOpenInterest({symbol:this.safeSymbol(r,e,void 0,"contract"),openInterestAmount:this.safeNumber2(i[0],"size","openInterest"),openInterestValue:void 0,timestamp:s,datetime:this.iso8601(s),info:t},e)}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchTransfers() requires a code argument");let a;await this.loadMarkets(),[a,s]=this.handleMarketTypeAndParams("fetchTransfers",void 0,s);const n=this.safeString(s,"fromAccount",a);s=this.omit(s,"fromAccount");const o=this.safeValue(this.options,"accountsByType",{});a=this.safeString(o,n);const d=this.currency(t);let c={coin:d.id,fromType:a};void 0!==e&&(c.startTime=e),void 0!==i&&(c.limit=i),[c,s]=this.handleUntilOption("endTime",c,s);const h=await this.privateSpotGetV2SpotAccountTransferRecords(this.extend(c,s)),l=this.safeList(h,"data",[]);return this.parseTransfers(l,d,e,i)}async transfer(t,e,i,s,r={}){await this.loadMarkets();const a=this.currency(t),n=this.safeValue(this.options,"accountsByType",{}),o={fromType:this.safeString(n,i),toType:this.safeString(n,s),amount:e,coin:a.id},d=this.safeString(r,"symbol");let c;r=this.omit(r,"symbol"),void 0!==d&&(c=this.market(d),o.symbol=c.id);const h=await this.privateSpotPostV2SpotWalletTransfer(this.extend(o,r)),l=this.safeValue(h,"data",{});return l.ts=this.safeInteger(h,"requestTime"),this.parseTransfer(l,a)}parseTransfer(t,e=void 0){const i=this.safeInteger(t,"ts"),s=this.safeStringLower(t,"status"),r=this.safeString(t,"coin"),a=this.safeString(t,"fromType"),n=this.safeValue(this.options,"accountsById",{}),o=this.safeString(n,a,a),d=this.safeString(t,"toType"),c=this.safeString(n,d,d);return{info:t,id:this.safeString(t,"transferId"),timestamp:i,datetime:this.iso8601(i),currency:this.safeCurrencyCode(r,e),amount:this.safeNumber(t,"size"),fromAccount:o,toAccount:c,status:this.parseTransferStatus(s)}}parseTransferStatus(t){return this.safeString({successful:"ok"},t,t)}parseDepositWithdrawFee(t,e=void 0){const i=this.safeValue(t,"chains",[]),s=i.length,r={info:t,withdraw:{fee:void 0,percentage:void 0},deposit:{fee:void 0,percentage:void 0},networks:{}};for(let t=0;t<s;t++){const a=i[t],n=this.safeString(a,"chain"),o=this.safeString(e,"code"),d=this.networkIdToCode(n,o);r.networks[d]={deposit:{fee:void 0,percentage:void 0},withdraw:{fee:this.safeNumber(a,"withdrawFee"),percentage:!1}},1===s&&(r.withdraw.fee=this.safeNumber(a,"withdrawFee"),r.withdraw.percentage=!1)}return r}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.publicSpotGetV2SpotPublicCoins(e),s=this.safeList(i,"data",[]);return this.parseDepositWithdrawFees(s,t,"coin")}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={coin:s.id,borrowAmount:this.currencyToPrecision(t,e)},a=await this.privateMarginPostV2MarginCrossedAccountBorrow(this.extend(r,i)),n=this.safeValue(a,"data",{});return this.parseMarginLoan(n,s)}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=this.market(t),n={coin:r.id,borrowAmount:this.currencyToPrecision(e,i),symbol:a.id},o=await this.privateMarginPostV2MarginIsolatedAccountBorrow(this.extend(n,s)),d=this.safeValue(o,"data",{});return this.parseMarginLoan(d,r,a)}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=this.market(t),n={coin:r.id,repayAmount:this.currencyToPrecision(e,i),symbol:a.id},o=await this.privateMarginPostV2MarginIsolatedAccountRepay(this.extend(n,s)),d=this.safeValue(o,"data",{});return this.parseMarginLoan(d,r,a)}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={coin:s.id,repayAmount:this.currencyToPrecision(t,e)},a=await this.privateMarginPostV2MarginCrossedAccountRepay(this.extend(r,i)),n=this.safeValue(a,"data",{});return this.parseMarginLoan(n,s)}parseMarginLoan(t,e=void 0,i=void 0){const s=this.safeString(t,"coin"),r=this.safeString(t,"symbol");let a;return void 0!==r&&(a=this.safeSymbol(r,i,void 0,"spot")),{id:this.safeString2(t,"loanId","repayId"),currency:this.safeCurrencyCode(s,e),amount:this.safeNumber2(t,"borrowAmount","repayAmount"),symbol:a,timestamp:void 0,datetime:void 0,info:t}}async fetchMyLiquidations(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a,n,o=!1;if([o,s]=this.handleOptionAndParams(s,"fetchMyLiquidations","paginate"),o)return await this.fetchPaginatedCallCursor("fetchMyLiquidations",t,e,i,s,"minId","idLessThan");if(void 0!==t&&(a=this.market(t)),[n,s]=this.handleMarketTypeAndParams("fetchMyLiquidations",a,s),"spot"!==n)throw new r.NotSupported(this.id+" fetchMyLiquidations() supports spot margin markets only");let d,c,h={};if([h,s]=this.handleUntilOption("endTime",h,s),h.startTime=void 0!==e?e:this.milliseconds()-7776e6,void 0!==i&&(h.limit=i),[c,s]=this.handleMarginModeAndParams("fetchMyLiquidations",s,"cross"),"isolated"===c){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyLiquidations() requires a symbol argument");h.symbol=a.id,d=await this.privateMarginGetV2MarginIsolatedLiquidationHistory(this.extend(h,s))}else"cross"===c&&(d=await this.privateMarginGetV2MarginCrossedLiquidationHistory(this.extend(h,s)));const l=this.safeValue(d,"data",{}),u=this.safeList(l,"resultList",[]);return this.parseLiquidations(u,a,e,i)}parseLiquidation(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeInteger(t,"liqEndTime"),r=this.safeString2(t,"LiqFee","liqFee"),n=this.safeString(t,"totalDebt"),o=a.Y.stringAdd(r,n);return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:void 0,contractSize:void 0,price:void 0,baseValue:void 0,quoteValue:this.parseNumber(o),timestamp:s,datetime:this.iso8601(s)})}async fetchIsolatedBorrowRate(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=await this.privateMarginGetV2MarginIsolatedInterestRateAndLimit(this.extend(s,e)),a=this.safeInteger(r,"requestTime"),n=this.safeValue(r,"data",[]),o=this.safeValue(n,0,{});return o.timestamp=a,this.parseIsolatedBorrowRate(o,i)}parseIsolatedBorrowRate(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeSymbol(i,e,void 0,"spot"),r=this.safeString(t,"baseCoin"),a=this.safeString(t,"quoteCoin"),n=this.safeInteger(t,"timestamp");return{symbol:s,base:this.safeCurrencyCode(r),baseRate:this.safeNumber(t,"baseDailyInterestRate"),quote:this.safeCurrencyCode(a),quoteRate:this.safeNumber(t,"quoteDailyInterestRate"),period:864e5,timestamp:n,datetime:this.iso8601(n),info:t}}async fetchCrossBorrowRate(t,e={}){await this.loadMarkets();const i=this.currency(t),s={coin:i.id};let r,a,n;if([r,e]=this.handleOptionAndParams(e,"fetchCrossBorrowRate","uta",!1),r)a=await this.publicUtaGetV3MarketMarginLoans(this.extend(s,e)),n=this.safeDict(a,"data",{});else{a=await this.privateMarginGetV2MarginCrossedInterestRateAndLimit(this.extend(s,e));const t=this.safeValue(a,"data",[]);n=this.safeValue(t,0,{})}const o=this.safeInteger(a,"requestTime");return n.timestamp=o,this.parseBorrowRate(n,i)}parseBorrowRate(t,e=void 0){const i=this.safeString(t,"coin"),s=this.safeInteger(t,"timestamp");return{currency:this.safeCurrencyCode(i,e),rate:this.safeNumber2(t,"dailyInterestRate","dailyInterest"),period:864e5,timestamp:s,datetime:this.iso8601(s),info:t}}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,a={}){await this.loadMarkets();let n,o=!1;if([o,a]=this.handleOptionAndParams(a,"fetchBorrowInterest","paginate"),o)return await this.fetchPaginatedCallCursor("fetchBorrowInterest",e,i,s,a,"minId","idLessThan");void 0!==e&&(n=this.market(e));const d={};let c,h,l;if(void 0!==t&&(c=this.currency(t),d.coin=c.id),d.startTime=void 0!==i?i:this.milliseconds()-7776e6,void 0!==s&&(d.limit=s),[l,a]=this.handleMarginModeAndParams("fetchBorrowInterest",a,"cross"),"isolated"===l){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchBorrowInterest() requires a symbol argument");d.symbol=n.id,h=await this.privateMarginGetV2MarginIsolatedInterestHistory(this.extend(d,a))}else"cross"===l&&(h=await this.privateMarginGetV2MarginCrossedInterestHistory(this.extend(d,a)));const u=this.safeValue(h,"data",{}),p=this.safeValue(u,"resultList",[]),f=this.parseBorrowInterests(p,n);return this.filterByCurrencySinceLimit(f,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"symbol");e=this.safeMarket(i,e);const s=void 0!==i?"isolated":"cross",r=this.safeInteger(t,"cTime");return{info:t,symbol:this.safeString(e,"symbol"),currency:this.safeCurrencyCode(this.safeString(t,"interestCoin")),interest:this.safeNumber(t,"interestAmount"),interestRate:this.safeNumber(t,"dailyInterestRate"),amountBorrowed:void 0,marginMode:s,timestamp:r,datetime:this.iso8601(r)}}async closePosition(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r={symbol:s.id};let a,n,o;[a,i]=this.handleProductTypeAndParams(s,i),[n,i]=this.handleOptionAndParams(i,"closePosition","uta",!1),n?(void 0!==e&&(r.posSide=e),r.category=a,o=await this.privateUtaPostV3TradeClosePositions(this.extend(r,i))):(void 0!==e&&(r.holdSide=e),r.productType=a,o=await this.privateMixPostV2MixOrderClosePositions(this.extend(r,i)));const d=this.safeValue(o,"data",{}),c=this.safeList2(d,"successList","list",[]);return this.parseOrder(c[0],s)}async closeAllPositions(t={}){await this.loadMarkets();const e={};let i,s,r;[i,t]=this.handleProductTypeAndParams(void 0,t),[s,t]=this.handleOptionAndParams(t,"closeAllPositions","uta",!1),s?(e.category=i,r=await this.privateUtaPostV3TradeClosePositions(this.extend(e,t))):(e.productType=i,r=await this.privateMixPostV2MixOrderClosePositions(this.extend(e,t)));const a=this.safeValue(r,"data",{}),n=this.safeList2(a,"successList","list",[]);return this.parsePositions(n,void 0,t)}async fetchMarginMode(t,e={}){await this.loadMarkets();const i=this.market(t);let s;[s,e]=this.handleProductTypeAndParams(i,e);const r={symbol:i.id,marginCoin:i.settleId,productType:s},a=await this.privateMixGetV2MixAccountAccount(this.extend(r,e)),n=this.safeDict(a,"data",{});return this.parseMarginMode(n,i)}parseMarginMode(t,e=void 0){let i=this.safeString(t,"marginMode");return i="crossed"===i?"cross":i,{info:t,symbol:e.symbol,marginMode:i}}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n,o,d={};if(void 0!==t){t.length>0&&(r=this.market(t[0]),d.symbol=r.id)}void 0!==e&&(d.startTime=e),void 0!==i&&(d.limit=i),[d,s]=this.handleUntilOption("endTime",d,s),[a,s]=this.handleProductTypeAndParams(r,s),[n,s]=this.handleOptionAndParams(s,"fetchPositionsHistory","uta",!1),n?(d.category=a,o=await this.privateUtaGetV3PositionHistoryPosition(this.extend(d,s))):o=await this.privateMixGetV2MixPositionHistoryPosition(this.extend(d,s));const c=this.safeDict(o,"data",{}),h=this.safeList(c,"list",[]),l=this.parsePositions(h,t,s);return this.filterBySinceLimit(l,e,i)}async fetchConvertQuote(t,e,i=void 0,s={}){await this.loadMarkets();const r={fromCoin:t,toCoin:e,fromCoinSize:this.numberToString(i)},a=await this.privateConvertGetV2ConvertQuotedPrice(this.extend(r,s)),n=this.safeDict(a,"data",{}),o=this.safeString(n,"fromCoin",t),d=this.currency(o),c=this.safeString(n,"toCoin",e),h=this.currency(c);return this.parseConversion(n,d,h)}async createConvertTrade(t,e,i,s=void 0,a={}){await this.loadMarkets();const n=this.safeString2(a,"price","cnvtPrice");if(void 0===n)throw new r.ArgumentsRequired(this.id+" createConvertTrade() requires a price parameter");const o=this.safeString2(a,"toAmount","toCoinSize");if(void 0===o)throw new r.ArgumentsRequired(this.id+" createConvertTrade() requires a toAmount parameter");a=this.omit(a,["price","toAmount"]);const d={traceId:t,fromCoin:e,toCoin:i,fromCoinSize:this.numberToString(s),toCoinSize:o,cnvtPrice:n},c=await this.privateConvertPostV2ConvertTrade(this.extend(d,a)),h=this.safeDict(c,"data",{}),l=this.safeString(h,"toCoin",i),u=this.currency(l);return this.parseConversion(h,void 0,u)}async fetchConvertTradeHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={},a=this.milliseconds();r.startTime=void 0!==e?e:a-864e5;const n=this.safeString2(s,"endTime","until");r.endTime=void 0!==n?n:a,void 0!==i&&(r.limit=i),s=this.omit(s,"until");const o=await this.privateConvertGetV2ConvertConvertRecord(this.extend(r,s)),d=this.safeDict(o,"data",{}),c=this.safeList(d,"dataList",[]);return this.parseConversions(c,t,"fromCoin","toCoin",e,i)}parseConversion(t,e=void 0,i=void 0){const s=this.safeInteger(t,"ts"),r=this.safeString(t,"fromCoin"),a=this.safeCurrencyCode(r,e),n=this.safeString(t,"toCoin"),o=this.safeCurrencyCode(n,i);return{info:t,timestamp:s,datetime:this.iso8601(s),id:this.safeString2(t,"id","traceId"),fromCurrency:a,fromAmount:this.safeNumber(t,"fromCoinSize"),toCurrency:o,toAmount:this.safeNumber(t,"toCoinSize"),price:this.safeNumber(t,"cnvtPrice"),fee:this.safeNumber(t,"fee")}}async fetchConvertCurrencies(t={}){await this.loadMarkets();const e=await this.privateConvertGetV2ConvertCurrencies(t),i={},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeString(e,"coin"),a=this.safeCurrencyCode(r);i[a]={info:e,id:r,code:a,networks:void 0,type:void 0,name:void 0,active:void 0,deposit:void 0,withdraw:this.safeNumber(e,"available"),fee:void 0,precision:void 0,limits:{amount:{min:this.safeNumber(e,"minAmount"),max:this.safeNumber(e,"maxAmount")},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},created:void 0}}return i}async fetchFundingInterval(t,e={}){await this.loadMarkets();const i=this.market(t);let s;[s,e]=this.handleProductTypeAndParams(i,e);const r={symbol:i.id};let a,n;[n,e]=this.handleOptionAndParams(e,"fetchFundingInterval","uta",!1),n?a=await this.publicUtaGetV3MarketCurrentFundRate(this.extend(r,e)):(r.productType=s,a=await this.publicMixGetV2MixMarketFundingTime(this.extend(r,e)));const o=this.safeList(a,"data",[]),d=this.safeDict(o,0,{});return this.parseFundingRate(d,i)}async fetchLongShortRatioHistory(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t),n={symbol:a.id};let o;void 0!==e&&(n.period=e),o=a.swap||a.future?await this.publicMixGetV2MixMarketAccountLongShort(this.extend(n,r)):await this.publicMarginGetV2MarginMarketLongShortRatio(this.extend(n,r));const d=this.safeList(o,"data",[]);return this.parseLongShortRatioHistory(d,a)}parseLongShortRatio(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeIntegerOmitZero(t,"ts");return{info:t,symbol:this.safeSymbol(i,e,void 0,"contract"),timestamp:s,datetime:this.iso8601(s),timeframe:void 0,longShortRatio:this.safeNumber2(t,"longShortRatio","longShortAccountRatio")}}handleErrors(t,e,i,s,a,n,o,d,c){if(!o)return;const h=this.safeString2(o,"err_msg","msg"),l=this.id+" "+n,u=void 0!==h&&""!==h&&"success"!==h;u&&(this.throwExactlyMatchedException(this.exceptions.exact,h,l),this.throwBroadlyMatchedException(this.exceptions.broad,h,l));const p=this.safeString2(o,"code","err_code"),f=void 0!==p&&"00000"!==p;if(f&&this.throwExactlyMatchedException(this.exceptions.exact,p,l),f||u)throw new r.ExchangeError(l)}nonce(){return this.milliseconds()-this.options.timeDifference}sign(t,e=[],i="GET",s={},r=void 0,a=void 0){const n="private"===e[0],d=e[1],c="/api"+("/"+this.implodeParams(t,s));let h=this.implodeHostname(this.urls.api[d])+c;const l=this.omit(s,this.extractParams(t));if(!n&&"GET"===i){Object.keys(l).length>0&&(h=h+"?"+this.urlencode(l))}if(n){this.checkRequiredCredentials();const t=this.nonce().toString();let e=t+i+c;if("POST"===i)e+=a=this.json(s);else if(Object.keys(s).length){let t="?"+this.urlencode(this.keysort(s));t.indexOf("%24")>-1&&(t=t.replace("%24","$")),h+=t,e+=t}const n=this.hmac(this.encode(e),this.encode(this.secret),o.s,"base64"),d=this.safeString(this.options,"broker");r={"ACCESS-KEY":this.apiKey,"ACCESS-SIGN":n,"ACCESS-TIMESTAMP":t,"ACCESS-PASSPHRASE":this.password,"X-CHANNEL-API-CODE":d},"POST"===i&&(r["Content-Type"]="application/json")}if(this.safeBool2(this.options,"sandboxMode","sandbox",!1)&&"v2/public/time"!==t&&"v3/market/current-fund-rate"!==t){void 0===r&&(r={});const t=this.safeString(s,"productType");"SCOIN-FUTURES"!==t&&"SUSDT-FUTURES"!==t&&"SUSDC-FUTURES"!==t&&(r.PAPTRADING="1")}return{url:h,method:i,body:a,headers:r}}}},7799(t,e,i){"use strict";i.d(e,{O:()=>s});class s{constructor(t){this.abi=t}methodInputsLength(t){return t.inputs.length}getMethod(t){return this.abi.find(t=>"interface"===t.type).items.find(e=>e.name===t)}getLegacyFormat(){return this.abi.flatMap(t=>"interface"===t.type?t.items:t)}}},7925(t,e,i){"use strict";i.d(e,{IN:()=>h,KH:()=>c,Kg:()=>d,Mu:()=>u,O4:()=>o,Wb:()=>p,mE:()=>l});var s=i(8325),r=i(178),a=i(1686);function n(t){return/^[\x00-\x7F]*$/.test(t)}function o(t){return t.length<=s.p7}function d(t){return"string"==typeof t}function c(t){return d(t)&&!(0,a.qv)(t)&&!(0,a.A6)(t)}const h=t=>c(t)&&!o(t);function l(t){const e=RegExp(`[^]{1,${s.p7}}`,"g");return t.match(e)||[]}function u(t){if(!n(t))throw new Error(`${t} is not an ASCII string`);if(!o(t))throw new Error(`${t} is too long`);return(0,r.VO)(t.replace(/./g,t=>t.charCodeAt(0).toString(16)))}function p(t){if(!n(t))throw new Error(`${t} is not an ASCII string`);if((0,a.qv)(t))return(0,r.ow)(t).replace(/.{2}/g,t=>String.fromCharCode(parseInt(t,16)));if(function(t){return/^[0-9]*$/i.test(t)}(t))return p("0X".concat(BigInt(t).toString(16)));throw new Error(`${t} is not Hex or decimal`)}},7942(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(700),r=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:s.D4,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},n=function(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},o=function(t,e,i){if(t){var s=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/g,n=/(\[[^[\]]*])/.exec(s),o=n?s.slice(0,n.index):s,d=[];if(o){if(!i.plainObjects&&r.call(Object.prototype,o)&&!i.allowPrototypes)return;d.push(o)}for(var c=0;null!==(n=a.exec(s))&&c<i.depth;){if(c+=1,!i.plainObjects&&r.call(Object.prototype,n[1].slice(1,-1))&&!i.allowPrototypes)return;d.push(n[1])}return n&&d.push("["+s.slice(n.index)+"]"),function(t,e,i){for(var s=e,r=t.length-1;r>=0;--r){var a,n=t[r];if("[]"===n&&i.parseArrays)a=[].concat(s);else{a=i.plainObjects?Object.create(null):{};var o="["===n.charAt(0)&&"]"===n.charAt(n.length-1)?n.slice(1,-1):n,d=parseInt(o,10);i.parseArrays||""!==o?!isNaN(d)&&n!==o&&String(d)===o&&d>=0&&i.parseArrays&&d<=i.arrayLimit?(a=[])[d]=s:a[o]=s:a={0:s}}s=a}return s}(d,e,i)}};function d(t,e){var i=function(t){if(!t)return a;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var e=void 0===t.charset?a.charset:t.charset;return{allowDots:void 0===t.allowDots?a.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:a.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:a.comma,decoder:"function"==typeof t.decoder?t.decoder:a.decoder,delimiter:"string"==typeof t.delimiter||s.gd(t.delimiter)?t.delimiter:a.delimiter,depth:"number"==typeof t.depth?t.depth:a.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:a.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:a.strictNullHandling}}(e);if(""===t||null==t)return i.plainObjects?Object.create(null):{};for(var d="string"==typeof t?function(t,e){var i,o={},d=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,c=e.parameterLimit===1/0?void 0:e.parameterLimit,h=d.split(e.delimiter,c),l=-1,u=e.charset;if(e.charsetSentinel)for(i=0;i<h.length;++i)0===h[i].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[i]?u="utf-8":"utf8=%26%2310003%3B"===h[i]&&(u="iso-8859-1"),l=i,i=h.length);for(i=0;i<h.length;++i)if(i!==l){var p,f,m=h[i],g=m.indexOf("]="),y=-1===g?m.indexOf("="):g+1;-1===y?(p=e.decoder(m,a.decoder,u),f=e.strictNullHandling?null:""):(p=e.decoder(m.slice(0,y),a.decoder,u),f=e.decoder(m.slice(y+1),a.decoder,u)),f&&e.interpretNumericEntities&&"iso-8859-1"===u&&(f=n(f)),f&&e.comma&&f.indexOf(",")>-1&&(f=f.split(",")),r.call(o,p)?o[p]=s.kg(o[p],f):o[p]=f}return o}(t,i):t,c=i.plainObjects?Object.create(null):{},h=Object.keys(d),l=0;l<h.length;++l){var u=h[l],p=o(u,d[u],i);c=s.h1(c,p,i)}return s.oE(c)}},8160(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(7504),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,cancelAllOrdersWs:!1,cancelOrdersWs:!1,cancelOrderWs:!1,createOrderWs:!1,editOrderWs:!1,fetchBalanceWs:!1,fetchOpenOrdersWs:!1,fetchOrderWs:!1,fetchTradesWs:!1,watchBalance:!1,watchMyTrades:!1,watchOHLCV:!1,watchOrderBook:!0,watchOrderBookForSymbols:!0,watchOrders:!0,watchTicker:!0,watchTickers:!0,watchTrades:!0,watchTradesForSymbols:!0,unWatchTicker:!0,unWatchTickers:!0,unWatchTrades:!0,unWatchOrders:!0,unWatchTradesForSymbols:!0},urls:{api:{ws:"wss://advanced-trade-ws.coinbase.com"}},options:{tradesLimit:1e3,ordersLimit:1e3,myTradesLimit:1e3,sides:{bid:"bids",offer:"asks"}}})}async subscribe(t,e,i=void 0,s={}){let r;await this.loadMarkets();let a=t,n=[];if(Array.isArray(i)){const t=this.marketSymbols(i);n=this.marketIds(t),a=a+"::"+i.join(",")}else void 0!==i&&(r=this.market(i),a=t+"::"+i,n=[r.id]);const o=this.urls.api.ws;let d={type:"subscribe",product_ids:n,channel:t};return e&&(d=this.extend(d,this.createWSAuth(t,n))),await this.watch(o,a,d,a)}async unSubscribe(t,e,i,s=void 0){if(await this.loadMarkets(),this.safeBool(this.options,"unSubscriptionPending",!1))throw new r.ExchangeError(this.id+" another unSubscription is pending, coinbase does not support concurrent unSubscriptions");let a;this.options.unSubscriptionPending=!0;let n=e,o="unsubscribe:"+e,d=[];if(Array.isArray(s)){const t=this.marketSymbols(s);d=this.marketIds(t),n=n+"::"+s.join(","),o=o+"::"+s.join(",")}else void 0!==s&&(a=this.market(s),n=e+"::"+s,o=o+"::"+s,d=[a.id]);const c=this.urls.api.ws;let h={type:"unsubscribe",product_ids:d,channel:e};const l={messageHashes:[o],subMessageHashes:[n],topic:t,unsubscribe:!0,symbols:[s]};i&&(h=this.extend(h,this.createWSAuth(e,d))),this.options.unSubscription=l;const u=await this.watch(c,o,h,o,l);return this.options.unSubscriptionPending=!1,this.options.unSubscription=void 0,u}async subscribeMultiple(t,e,i=void 0,s={}){await this.loadMarkets();const r=[],a=[];i=this.marketSymbols(i,void 0,!1);for(let e=0;e<i.length;e++){const s=i[e],n=this.market(s).id;r.push(n),a.push(t+"::"+s)}const n=this.urls.api.ws;let o={type:"subscribe",product_ids:r,channel:t};return e&&(o=this.extend(o,this.createWSAuth(t,r))),await this.watchMultiple(n,a,o,a)}async unSubscribeMultiple(t,e,i,s=void 0,a={}){if(this.safeBool(this.options,"unSubscriptionPending",!1))throw new r.ExchangeError(this.id+" another unSubscription is pending, coinbase does not support concurrent unSubscriptions");this.options.unSubscriptionPending=!0,await this.loadMarkets();const n=[],o=[],d=[];s=this.marketSymbols(s,void 0,!1);for(let t=0;t<s.length;t++){const i=s[t],r=this.market(i).id;n.push(r),o.push(e+"::"+i),d.push("unsubscribe:"+e+"::"+i)}const c=this.urls.api.ws;let h={type:"unsubscribe",product_ids:n,channel:e};i&&(h=this.extend(h,this.createWSAuth(e,n)));const l={messageHashes:d,subMessageHashes:o,topic:t,unsubscribe:!0,symbols:s};this.options.unSubscription=l;const u=await this.watchMultiple(c,d,h,d,l);return this.options.unSubscriptionPending=!1,this.options.unSubscription=void 0,u}createWSAuth(t,e){const i={},s=this.numberToString(this.seconds());this.checkRequiredCredentials();const a=this.apiKey.indexOf("organizations/")>=0||this.secret.startsWith("-----BEGIN"),o=s+t+e.join(",");if(a){if(this.apiKey.startsWith("-----BEGIN"))throw new r.ArgumentsRequired(this.id+" apiKey should contain the name (eg: organizations/3b910e93....) and not the public key");const t=this.safeString(this.options,"wsToken"),e=this.safeInteger(this.options,"wsTokenTimestamp",0),s=this.seconds();if(void 0===t||e+120<s){const t=this.createAuthToken(s);this.options.wsToken=t,this.options.wsTokenTimestamp=s}i.jwt=this.safeString(this.options,"wsToken")}else i.api_key=this.apiKey,i.timestamp=s,i.signature=this.hmac(this.encode(o),this.encode(this.secret),n.s);return i}async watchTicker(t,e={}){await this.loadMarkets();return await this.subscribe("ticker",!1,t,e)}async unWatchTicker(t,e={}){await this.loadMarkets();return await this.unSubscribe("ticker","ticker",!1,t)}async watchTickers(t=void 0,e={}){await this.loadMarkets(),void 0===t&&(t=this.symbols);const i=await this.subscribeMultiple("ticker_batch",!1,t,e);if(this.newUpdates){const t={};return t[i.symbol]=i,t}return this.tickers}async unWatchTickers(t=void 0,e={}){return await this.loadMarkets(),void 0===t&&(t=this.symbols),await this.unSubscribeMultiple("ticker","ticker_batch",!1,t)}handleTickers(t,e){const i=this.safeString(e,"channel"),s=this.safeList(e,"events",[]),r=this.safeString(e,"timestamp"),a=this.parse8601(r),n=[];for(let e=0;e<s.length;e++){const o=s[e],d=this.safeList(o,"tickers",[]);for(let e=0;e<d.length;e++){const s=d[e];if(void 0===this.safeString(s,"product_id"))continue;const o=this.parseWsTicker(s);o.timestamp=a,o.datetime=r;const c=o.symbol;this.tickers[c]=o,n.push(o);const h=i+"::"+c;t.resolve(o,h),this.tryResolveUsdc(t,h,o)}}}parseWsTicker(t,e=void 0){const i=this.safeString(t,"product_id"),s=void 0,r=this.safeNumber(t,"price");return this.safeTicker({info:t,symbol:this.safeSymbol(i,e,"-"),timestamp:s,datetime:this.iso8601(s),high:this.safeString(t,"high_24_h"),low:this.safeString(t,"low_24_h"),bid:this.safeString(t,"best_bid"),bidVolume:this.safeString(t,"best_bid_quantity"),ask:this.safeString(t,"best_ask"),askVolume:this.safeString(t,"best_ask_quantity"),vwap:void 0,open:void 0,close:r,last:r,previousClose:void 0,change:void 0,percentage:this.safeString(t,"price_percent_chg_24_h"),average:void 0,baseVolume:this.safeString(t,"volume_24_h"),quoteVolume:void 0})}async watchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets(),t=this.symbol(t);const r=await this.subscribe("market_trades",!1,t,s);return this.newUpdates&&(i=r.getLimit(t,i)),this.filterBySinceLimit(r,e,i,"timestamp",!0)}async unWatchTrades(t,e={}){await this.loadMarkets();return await this.unSubscribe("trades","market_trades",!1,t)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.subscribeMultiple("market_trades",!1,t,s);if(this.newUpdates){const t=this.safeDict(r,0),e=this.safeString(t,"symbol");i=r.getLimit(e,i)}return this.filterBySinceLimit(r,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){await this.loadMarkets();return await this.unSubscribeMultiple("trades","market_trades",!1,t,e)}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=await this.subscribe("user",!0,t,s);return this.newUpdates&&(i=r.getLimit(t,i)),this.filterBySinceLimit(r,e,i,"timestamp",!0)}async unWatchOrders(t=void 0,e={}){await this.loadMarkets();return await this.unSubscribe("orders","user",!0,this.symbol(t))}async watchOrderBook(t,e=void 0,i={}){await this.loadMarkets();t=this.market(t).symbol;return(await this.subscribe("level2",!1,t,i)).limit()}async unWatchOrderBook(t,e={}){await this.loadMarkets(),t=this.symbol(t);return await this.unSubscribe("orderbook","level2",!1,t)}async watchOrderBookForSymbols(t,e=void 0,i={}){await this.loadMarkets();return(await this.subscribeMultiple("level2",!1,t,i)).limit()}handleTrade(t,e){const i=this.safeList(e,"events"),s=this.safeValue(i,0),r=this.safeList(s,"trades"),n=this.safeDict(r,0),o=this.safeString(n,"product_id"),d=this.safeSymbol(o),c="market_trades::"+d;let h=this.safeValue(this.trades,d);if(void 0===h){const t=this.safeInteger(this.options,"tradesLimit",1e3);h=new a.Pt(t),this.trades[d]=h}for(let t=0;t<i.length;t++){const e=i[t],s=this.safeList(e,"trades");for(let e=0;e<s.length;e++){const e=s[t];h.append(this.parseTrade(e))}}t.resolve(h,c),this.tryResolveUsdc(t,c,h)}handleOrder(t,e){const i=this.safeList(e,"events"),s=[];if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a.Pt(t)}for(let t=0;t<i.length;t++){const e=i[t],r=this.safeList(e,"orders");for(let t=0;t<r.length;t++){const e=r[t],i=this.parseWsOrder(e),a=this.orders,n=this.safeString(e,"product_id");n in s||s.push(n),a.append(i)}}for(let e=0;e<s.length;e++){const i=s[e],r="user::"+this.safeSymbol(i);t.resolve(this.orders,r),this.tryResolveUsdc(t,r,this.orders)}t.resolve(this.orders,"user")}parseWsOrder(t,e=void 0){const i=this.safeString(t,"order_id"),s=this.safeString(t,"client_order_id"),r=this.safeString(t,"product_id"),a=this.safeString2(t,"time","creation_time");e=this.safeMarket(r,e);const n=this.safeString(t,"stop_price");return this.safeOrder({info:t,symbol:this.safeString(e,"symbol"),id:i,clientOrderId:s,timestamp:this.parse8601(a),datetime:a,lastTradeTimestamp:void 0,type:this.safeString(t,"order_type"),timeInForce:void 0,postOnly:void 0,side:this.safeStringLower2(t,"side","order_side"),price:this.safeString(t,"limit_price"),stopPrice:n,triggerPrice:n,amount:this.safeString(t,"cumulative_quantity"),cost:this.omitZero(this.safeString(t,"filled_value")),average:this.safeString(t,"avg_price"),filled:this.safeString(t,"cumulative_quantity"),remaining:this.safeString(t,"leaves_quantity"),status:this.parseOrderStatus(this.safeString(t,"status")),fee:{amount:this.safeString(t,"total_fees"),currency:this.safeString(e,"quote")},trades:void 0})}handleOrderBookHelper(t,e){for(let i=0;i<e.length;i++){const s=e[i],r=this.safeString(s,"side"),a=this.safeString(this.options.sides,r),n=this.safeNumber(s,"price_level"),o=this.safeNumber(s,"new_quantity");t[a].store(n,o)}}handleOrderBook(t,e){const i=this.safeList(e,"events"),s=this.safeString(e,"timestamp");for(let e=0;e<i.length;e++){const r=i[e],a=this.safeList(r,"updates",[]),n=this.safeString(r,"product_id"),o=this.safeMarket(n).symbol,d="level2::"+o,c=this.safeValue(t.subscriptions,d,{}),h=this.safeInteger(c,"limit");if("snapshot"===this.safeString(r,"type")&&(this.orderbooks[o]=this.orderBook({},h)),!(o in this.orderbooks)&&void 0===this.orderbooks[o])continue;const l=this.orderbooks[o];this.handleOrderBookHelper(l,a),l.timestamp=this.parse8601(s),l.datetime=s,l.symbol=o,t.resolve(l,d),this.tryResolveUsdc(t,d,l)}}tryResolveUsdc(t,e,i){(e.endsWith("/USD")||e.endsWith("-USD"))&&t.resolve(i,e+"C")}handleSubscriptionStatus(t,e){const i=this.safeList(e,"events",[]),s=this.safeValue(i,0,{}),r="subscriptions"in s,a=Object.keys(s.subscriptions).length;if(r&&0===a){const e=this.safeDict(this.options,"unSubscription",{}),i=this.safeList(e,"messageHashes",[]),s=this.safeList(e,"subMessageHashes",[]);for(let e=0;e<i.length;e++){const r=i[e],a=s[e];this.cleanUnsubscription(t,a,r)}this.cleanCache(e)}return e}handleHeartbeats(t,e){return e}handleMessage(t,e){const i=this.safeString(e,"channel"),s={subscriptions:this.handleSubscriptionStatus,ticker:this.handleTickers,ticker_batch:this.handleTickers,market_trades:this.handleTrade,user:this.handleOrder,l2_data:this.handleOrderBook,heartbeats:this.handleHeartbeats};if("error"===this.safeString(e,"type")){const t=this.safeString(e,"message");throw new r.ExchangeError(t)}const a=this.safeValue(s,i);a&&a.call(this,t,e)}}},8166(t,e,i){"use strict";function s(){return{typeUrl:"",value:new Uint8Array}}i.d(e,{F:()=>r}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.typeUrl&&e.uint32(10).string(t.typeUrl),0!==t.value.length&&e.uint32(18).bytes(t.value),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=s();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.typeUrl=i.string();break;case 2:a.value=i.bytes();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=s();return e.typeUrl=t.typeUrl??"",e.value=t.value??new Uint8Array,e}}},8283(t,e,i){"use strict";i.d(e,{QR:()=>y,Sw:()=>m,h1:()=>f,q4:()=>g,tW:()=>u,w8:()=>p});var s=i(712),r=i(4710),a=i(5268),n=i(890),o=i(987),d=i(8342),c=i(191);const h={binary:t=>t,hex:r.xn.encode,base64:r.K3.encode},l={"1.3.132.0.10":o.bI,"1.2.840.10045.3.1.7":d.Qj},u=(t,e,i="hex")=>{const s=e(t);return h[i](s)},p=(t,e,i,r="hex")=>{const a=(0,s.w)(i,e,t);return h[r](a)};function f(t,e,i,s=null,r=!1){if(s&&(t=u(t,s,"hex")),"string"==typeof e&&e.length>64){if(!e.startsWith("-----BEGIN EC PRIVATE KEY-----"))throw new Error("Unsupported key format");{const t=a.o.unarmor(e);let s=n.Ge.decode(t);if(4!==s.sub.length)throw new Error("Unsupported key format");if(null!==typeof s.sub[2].sub&&s.sub[2].sub.length>0){const t=s.sub[2].sub[0].content(void 0);if(void 0===l[t])throw new Error("Unsupported curve");i=l[t]}e=s.sub[1].getHexStringValue()}}let o=i.sign(t,e,{lowS:!0});const d=(BigInt(1)<<BigInt(8)*BigInt(31))-BigInt(1),h=i.CURVE.n/BigInt(2);let p=0;for(;r&&(o.r>h||o.r<=d||o.s<=d);)o=i.sign(t,e,{lowS:!0,extraEntropy:(0,c.z)(BigInt(p),32)}),p+=1;return{r:o.r.toString(16),s:o.s.toString(16),v:o.recovery}}function m(t,e,i){const s=i.signModified(t,e);return r.tw.encode(s)}function g(t,e,i){let s;32===e.length?s=e:"string"==typeof e&&(s=new Uint8Array(a.o.unarmor(e).slice(16)));const n=i.sign(t,s);return r.K3.encode(n)}function y(t,e=!1){void 0===y.table&&(y.table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(" ").map(t=>parseInt(t,16)));let i=-1;for(let e=0;e<t.length;e++)i=i>>>8^y.table[255&(i^t.charCodeAt(e))];const s=(-1^i)>>>0;return e&&s>=2147483648?s-4294967296:s}},8325(t,e,i){"use strict";i.d(e,{He:()=>c,Kp:()=>d,Vi:()=>n,bE:()=>h,n$:()=>r,p7:()=>s,s9:()=>a});const s=31,r=2n**250n-1n,a=2n**251n+17n*2n**192n+1n,n=2n**251n-256n,o=(t,e)=>({min:t,max:e}),d=o(0n,a-1n),c=o(-(2n**127n),2n**127n-1n),h=o(0n,2n**128n-1n);var l,u,p,f;!function(t){t.SN_MAIN="https://alpha-mainnet.starknet.io",t.SN_SEPOLIA="https://alpha-sepolia.starknet.io"}(l||(l={})),function(t){t.SN_MAIN="SN_MAIN",t.SN_SEPOLIA="SN_SEPOLIA"}(u||(u={})),function(t){t.SN_MAIN="0x534e5f4d41494e",t.SN_SEPOLIA="0x534e5f5345504f4c4941"}(p||(p={})),function(t){t.DECLARE="0x6465636c617265",t.DEPLOY="0x6465706c6f79",t.DEPLOY_ACCOUNT="0x6465706c6f795f6163636f756e74",t.INVOKE="0x696e766f6b65",t.L1_HANDLER="0x6c315f68616e646c6572"}(f||(f={}))},8342(t,e,i){"use strict";i.d(e,{Qj:()=>u});var s=i(1999),r=i(4852),a=i(1064),n=i(2442),o=i(4506);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const d=(0,a.Fp)(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),c=d.create(BigInt("-3")),h=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),l=(0,n.Is)(d,{A:c,B:h,Z:d.create(BigInt("-10"))}),u=(0,s.s)({a:c,b:h,Fp:d,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},r.s),p=u,{hashToCurve:f,encodeToCurve:m}=o.qj(p.ProjectivePoint,t=>l(t[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:d.ORDER,m:1,k:128,expand:"xmd",hash:r.s})},8354(t,e,i){"use strict";i.d(e,{v:()=>r});var s=i(9491);class r{constructor(t,e=s.CL){this.branches=[],this.hashMethod=e,this.leaves=t,this.root=this.build(t)}build(t){if(1===t.length)return t[0];t.length!==this.leaves.length&&this.branches.push(t);const e=[];for(let i=0;i<t.length;i+=2)i+1===t.length?e.push(r.hash(t[i],"0x0",this.hashMethod)):e.push(r.hash(t[i],t[i+1],this.hashMethod));return this.build(e)}static hash(t,e,i=s.CL){const[r,a]=[BigInt(t),BigInt(e)].sort((t,e)=>t>=e?1:-1);return i(r,a)}getProof(t,e=this.leaves,i=[]){const s=e.indexOf(t);if(-1===s)throw new Error("leaf not found");if(1===e.length)return i;const a=s%2==0,n=(a?e[s+1]:e[s-1])??"0x0",o=[...i,n],d=this.leaves.length===e.length?-1:this.branches.findIndex(t=>t.length===e.length),c=this.branches[d+1]??[this.root];return this.getProof(r.hash(a?t:n,a?n:t,this.hashMethod),c,o)}}},8403(t,e,i){"use strict";i.d(e,{D9:()=>f,Dj:()=>u,EZ:()=>r,GA:()=>h,LC:()=>l,RR:()=>b,Rn:()=>v,Rz:()=>a,Th:()=>g,YA:()=>n,_U:()=>p,k4:()=>c,nm:()=>o,rE:()=>m,tB:()=>s,wR:()=>S,x_:()=>y,yy:()=>w});const s=Date.now,r=()=>1e3*s(),a=s,n=()=>Math.floor(s()/1e3),o=()=>{const t=(10*r()+122192928e9).toString(16);return t.slice(7,15)+t.slice(3,7)+"1"+t.slice(0,3)+"9696"+"ff".repeat(6)},d=setTimeout,c=(t,e,i=d,r=s()+e)=>{if(e>=2147483647)throw new Error("setTimeout() function was called with unrealistic value of "+e.toString());let a=()=>{},n=!0;const o=i(()=>{n=!0;const e=r-s();e>0?a=c(t,e,i,r):t()},e);return function(){n&&(n=!1,clearTimeout(o)),a()}};class h extends Error{constructor(){const t="timed out";super(t),this.constructor=h,this.__proto__=h.prototype,this.message=t}}const l=t=>{let e;if(e="number"==typeof t?Math.floor(t):parseInt(t,10),!(Number.isNaN(e)||e<0))try{return new Date(e).toISOString()}catch(t){return}},u=t=>{if("string"==typeof t&&t&&!t.match(/^[0-9]+$/)&&!(t.indexOf("-")<0||t.indexOf(":")<0))try{const e=Date.parse(t.indexOf("+")>=0||"Z"===t.slice(-1)?t:(t+"Z").replace(/\s(\d\d):/,"T$1:"));if(Number.isNaN(e))return;return e}catch(t){return}},p=t=>{if("string"==typeof t&&t){if(t.indexOf("GMT")>=0)try{return Date.parse(t)}catch(t){return}return u(t)}},f=(t=void 0)=>new Date(t).toUTCString(),m=(t,e="-")=>{e=e||"";const i=new Date(t),s=i.getUTCFullYear().toString();let r=i.getUTCMonth()+1,a=i.getUTCDate();return r=r<10?"0"+r:r.toString(),a=a<10?"0"+a:a.toString(),r+e+a+e+s},g=(t,e,i=!0)=>{e=e||"";const s=new Date(t),r=s.getUTCFullYear(),a=(i?r:r-2e3).toString();let n=s.getUTCMonth()+1,o=s.getUTCDate();return n=n<10?"0"+n:n.toString(),o=o<10?"0"+o:o.toString(),a+e+n+e+o},y=(t,e="")=>g(t,e,!1),v=(t,e="-")=>g(t,e,!0),b=(t,e=" ")=>{const i=new Date(t),s=i.getUTCFullYear();let r=i.getUTCMonth()+1,a=i.getUTCDate(),n=i.getUTCHours(),o=i.getUTCMinutes(),d=i.getUTCSeconds();return r=r<10?"0"+r:r,a=a<10?"0"+a:a,n=n<10?"0"+n:n,o=o<10?"0"+o:o,d=d<10?"0"+d:d,s+"-"+r+"-"+a+e+n+":"+o+":"+d},w=t=>new Promise(e=>c(e,t)),S=async(t,e)=>{let i=()=>{};const s=new Promise(e=>i=c(e,t));try{return await Promise.race([e,s.then(()=>{throw new h})])}finally{i()}}},8432(t,e,i){"use strict";i.d(e,{lY:()=>S});var s=i(9024),r=i(6157),a=i(1094);const[n,o,d]=[[],[],[]],c=BigInt(0),h=BigInt(1),l=BigInt(2),u=BigInt(7),p=BigInt(256),f=BigInt(113);for(let t=0,e=h,i=1,s=0;t<24;t++){[i,s]=[s,(2*i+3*s)%5],n.push(2*(5*s+i)),o.push((t+1)*(t+2)/2%64);let r=c;for(let t=0;t<7;t++)e=(e<<h^(e>>u)*f)%p,e&l&&(r^=h<<(h<<BigInt(t))-h);d.push(r)}const[m,g]=r.Ay.split(d,!0),y=(t,e,i)=>i>32?r.Ay.rotlBH(t,e,i):r.Ay.rotlSH(t,e,i),v=(t,e,i)=>i>32?r.Ay.rotlBL(t,e,i):r.Ay.rotlSL(t,e,i);class b extends a.Vw{constructor(t,e,i,r=!1,n=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=i,this.enableXOF=r,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,s.Ay.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,a.DH)(this.state)}keccak(){!function(t,e=24){const i=new Uint32Array(10);for(let s=24-e;s<24;s++){for(let e=0;e<10;e++)i[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const s=(e+8)%10,r=(e+2)%10,a=i[r],n=i[r+1],o=y(a,n,1)^i[s],d=v(a,n,1)^i[s+1];for(let i=0;i<50;i+=10)t[e+i]^=o,t[e+i+1]^=d}let e=t[2],r=t[3];for(let i=0;i<24;i++){const s=o[i],a=y(e,r,s),d=v(e,r,s),c=n[i];e=t[c],r=t[c+1],t[c]=a,t[c+1]=d}for(let e=0;e<50;e+=10){for(let s=0;s<10;s++)i[s]=t[e+s];for(let s=0;s<10;s++)t[e+s]^=~i[(s+2)%10]&i[(s+4)%10]}t[0]^=m[s],t[1]^=g[s]}i.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){s.Ay.exists(this);const{blockLen:e,state:i}=this,r=(t=(0,a.ZJ)(t)).length;for(let s=0;s<r;){const a=Math.min(e-this.pos,r-s);for(let e=0;e<a;e++)i[this.pos++]^=t[s++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:i,blockLen:s}=this;t[i]^=e,128&e&&i===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){s.Ay.exists(this,!1),s.Ay.bytes(t),this.finish();const e=this.state,{blockLen:i}=this;for(let s=0,r=t.length;s<r;){this.posOut>=i&&this.keccak();const a=Math.min(i-this.posOut,r-s);t.set(e.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return s.Ay.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(s.Ay.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:i,outputLen:s,rounds:r,enableXOF:a}=this;return t||=new b(e,i,s,a,r),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=r,t.suffix=i,t.outputLen=s,t.enableXOF=a,t.destroyed=this.destroyed,t}}const w=(t,e,i)=>(0,a.ld)(()=>new b(e,t,i)),S=(w(6,144,28),w(6,136,32),w(6,104,48),w(6,72,64),w(1,144,28),w(1,136,32)),k=(w(1,104,48),w(1,72,64),(t,e,i)=>(0,a.t6)((s={})=>new b(e,t,void 0===s.dkLen?i:s.dkLen,!0)));k(31,168,16),k(31,136,32)},8464(t,e,i){"use strict";i.d(e,{p:()=>s});const s="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n")},8483(t,e,i){"use strict";i.d(e,{V:()=>r});const s=1e13;class r{constructor(t){this.buf=[+t||0]}mulAdd(t,e){const i=this.buf,r=i.length;let a,n;for(a=0;a<r;++a)n=i[a]*t+e,n<s?e=0:n-=(e=0|n/s)*s,i[a]=n;e>0&&(i[a]=e)}sub(t){const e=this.buf,i=e.length;let r,a;for(r=0;r<i;++r)a=e[r]-t,a<0?(a+=s,t=1):t=0,e[r]=a;for(;0===e[e.length-1];)e.pop()}toString(t){if(10!=(t||10))throw new Error("only base 10 is supported");const e=this.buf;let i=e[e.length-1].toString();for(let t=e.length-2;t>=0;--t)i+=(s+e[t]).toString().substring(1);return i}valueOf(){const t=this.buf;let e=0;for(let i=t.length-1;i>=0;--i)e=e*s+t[i];return e}simplify(){const t=this.buf;return 1==t.length?t[0]:this}}},8518(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(5462),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,createOrderWs:!0,editOrderWs:!0,fetchOpenOrdersWs:!1,fetchOrderWs:!1,cancelOrderWs:!0,cancelOrdersWs:!1,cancelAllOrdersWs:!1,fetchTradesWs:!1,fetchBalanceWs:!1,watchBalance:!0,watchBidsAsks:!0,watchLiquidations:!0,watchLiquidationsForSymbols:!1,watchMyLiquidations:!1,watchMyLiquidationsForSymbols:!1,watchMyTrades:!0,watchOHLCV:!0,watchOHLCVForSymbols:!0,watchOrderBook:!0,watchOrderBookForSymbols:!0,watchOrders:!0,watchTicker:!0,watchTickers:!0,watchTrades:!0,watchPositions:!0,watchTradesForSymbols:!0,unWatchTicker:!0,unWatchTickers:!0,unWatchOHLCV:!0,unWatchOHLCVForSymbols:!0,unWatchOrderBook:!0,unWatchOrderBookForSymbols:!0,unWatchTrades:!0,unWatchTradesForSymbols:!0,unWatchMyTrades:!0,unWatchOrders:!0,unWatchPositions:!0},urls:{api:{ws:{public:{spot:"wss://stream.{hostname}/v5/public/spot",inverse:"wss://stream.{hostname}/v5/public/inverse",option:"wss://stream.{hostname}/v5/public/option",linear:"wss://stream.{hostname}/v5/public/linear"},private:{spot:{unified:"wss://stream.{hostname}/v5/private",nonUnified:"wss://stream.{hostname}/spot/private/v3"},contract:"wss://stream.{hostname}/v5/private",usdc:"wss://stream.{hostname}/trade/option/usdc/private/v1",trade:"wss://stream.bybit.com/v5/trade"}}},test:{ws:{public:{spot:"wss://stream-testnet.{hostname}/v5/public/spot",inverse:"wss://stream-testnet.{hostname}/v5/public/inverse",linear:"wss://stream-testnet.{hostname}/v5/public/linear",option:"wss://stream-testnet.{hostname}/v5/public/option"},private:{spot:{unified:"wss://stream-testnet.{hostname}/v5/private",nonUnified:"wss://stream-testnet.{hostname}/spot/private/v3"},contract:"wss://stream-testnet.{hostname}/v5/private",usdc:"wss://stream-testnet.{hostname}/trade/option/usdc/private/v1",trade:"wss://stream-testnet.bybit.com/v5/trade"}}},demotrading:{ws:{public:{spot:"wss://stream.{hostname}/v5/public/spot",inverse:"wss://stream.{hostname}/v5/public/inverse",option:"wss://stream.{hostname}/v5/public/option",linear:"wss://stream.{hostname}/v5/public/linear"},private:{spot:{unified:"wss://stream-demo.{hostname}/v5/private",nonUnified:"wss://stream-demo.{hostname}/spot/private/v3"},contract:"wss://stream-demo.{hostname}/v5/private",usdc:"wss://stream-demo.{hostname}/trade/option/usdc/private/v1",trade:"wss://stream-demo.bybit.com/v5/trade"}}}},options:{watchTicker:{name:"tickers"},watchPositions:{fetchPositionsSnapshot:!0,awaitPositionsSnapshot:!0},watchMyTrades:{filterExecTypes:["Trade","AdlTrade","BustTrade","Settle"]},spot:{timeframes:{"1m":"1m","3m":"3m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","6h":"6h","12h":"12h","1d":"1d","1w":"1w","1M":"1M"}},contract:{timeframes:{"1m":"1","3m":"3","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","6h":"360","12h":"720","1d":"D","1w":"W","1M":"M"}}},streaming:{ping:this.ping,keepAlive:18e3}})}requestId(){this.lockId();const t=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=t,this.unlockId(),t}async getUrlByMarketType(t=void 0,e=!1,i=void 0,s={}){const r=e?"private":"public";let a,n,o,d,c=this.urls.api.ws;if(void 0!==t)d=this.market(t),a="USDC"===d.settle,o=d.type;else{[o,s]=this.handleMarketTypeAndParams(i,void 0,s);let t=this.safeString(this.options,"defaultSettle");t=this.safeString2(s,"settle","defaultSettle",t),a="USDC"===t}if(n="spot"===o,e){const t=await this.isUnifiedEnabled(),e=this.safeBool(t,0,!1),i=this.safeBool(t,1,!1);c=!a||e||i?c[r].contract:c[r].usdc}else if(n)c=c[r].spot;else if("swap"===o||"future"===o){let t;[t,s]=this.handleSubTypeAndParams(i,d,s,"linear"),c=c[r][t]}else c=c[r].option;return c=this.implodeHostname(c),c}cleanParams(t){return t=this.omit(t,["type","subType","settle","defaultSettle","unifiedMargin"])}async createOrderWs(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.createOrderRequest(t,e,i,s,r,a,!0),o=this.urls.api.ws.private.trade;await this.authenticate(o);const d=this.requestId().toString(),c={op:"order.create",reqId:d,args:[n],header:{"X-BAPI-TIMESTAMP":this.milliseconds().toString(),"X-BAPI-RECV-WINDOW":this.options.recvWindow.toString()}};return await this.watch(o,d,c,d,!0)}async editOrderWs(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.editOrderRequest(t,e,i,s,r,a,n),d=this.urls.api.ws.private.trade;await this.authenticate(d);const c=this.requestId().toString(),h={op:"order.amend",reqId:c,args:[o],header:{"X-BAPI-TIMESTAMP":this.milliseconds().toString(),"X-BAPI-RECV-WINDOW":this.options.recvWindow.toString()}};return await this.watch(d,c,h,c,!0)}async cancelOrderWs(t,e=void 0,i={}){if(await this.loadMarkets(),void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrderWs() requires a symbol argument");const s=this.cancelOrderRequest(t,e,i),a=this.urls.api.ws.private.trade;await this.authenticate(a);const n=this.requestId().toString();"orderFilter"in s&&delete s.orderFilter;const o={op:"order.cancel",reqId:n,args:[s],header:{"X-BAPI-TIMESTAMP":this.milliseconds().toString(),"X-BAPI-RECV-WINDOW":this.options.recvWindow.toString()}};return await this.watch(a,n,o,n,!0)}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s="ticker:"+(t=i.symbol),a=await this.getUrlByMarketType(t,!1,"watchTicker",e);e=this.cleanParams(e);const n=this.safeValue(this.options,"watchTicker",{});let o=this.safeString(n,"name","tickers");if(!i.spot&&"tickers"!==o)throw new r.BadRequest(this.id+" watchTicker() only supports name tickers for contract markets");o+="."+i.id;const d=[o];return await this.watchTopics(a,[s],d,e)}async watchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=[],s=await this.getUrlByMarketType(t[0],!1,"watchTickers",e);e=this.cleanParams(e);const r=this.safeValue(this.options,"watchTickers",{}),a=this.safeString(r,"name","tickers"),n=this.marketIds(t),o=[];for(let e=0;e<n.length;e++){const s=n[e];o.push(a+"."+s),i.push("ticker:"+t[e])}const d=await this.watchTopics(s,i,o,e);if(this.newUpdates){const t={};return t[d.symbol]=d,t}return this.filterByArray(this.tickers,"symbol",t)}async unWatchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=this.safeValue(this.options,"watchTickers",{}),s=this.safeString(i,"name","tickers"),r=[],a=[],n=this.marketIds(t),o=[];for(let e=0;e<n.length;e++){const i=n[e],d=t[e];o.push(s+"."+i),a.push("ticker:"+d),r.push("unsubscribe:ticker:"+d)}const d=await this.getUrlByMarketType(t[0],!1,"watchTickers",e);return await this.unWatchTopics(d,"ticker",t,r,a,o,e)}async unWatchTicker(t,e={}){return await this.loadMarkets(),await this.unWatchTickers([t],e)}handleTicker(t,e){const i=this.safeString(e,"topic",""),s=this.safeString(e,"type",""),r=this.safeDict(e,"data",{}),a=void 0!==this.safeString(r,"usdIndexPrice")?"spot":"contract";let n,o;if("snapshot"===s)o=this.parseTicker(r),n=o.symbol;else if("delta"===s){const t=i.split("."),e=t.length,s=this.safeString(t,e-1);n=this.safeMarket(s,void 0,void 0,a).symbol;const d=this.safeDict(this.tickers,n,{}),c=this.safeDict(d,"info",{}),h=this.extend(c,r);o=this.parseTicker(h)}const d=this.safeInteger(e,"ts");o.timestamp=d,o.datetime=this.iso8601(d),this.tickers[n]=o;const c="ticker:"+n;t.resolve(this.tickers[n],c)}async watchBidsAsks(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);const i=[],s=await this.getUrlByMarketType(t[0],!1,"watchBidsAsks",e);e=this.cleanParams(e);const r=this.marketIds(t),a=[];for(let e=0;e<r.length;e++){const s="orderbook.1."+r[e];a.push(s),i.push("bidask:"+t[e])}const n=await this.watchTopics(s,i,a,e);return this.newUpdates?n:this.filterByArray(this.bidsasks,"symbol",t)}parseWsBidAsk(t,e=void 0){const i=this.safeInteger(t,"timestamp"),s=this.sortBy(this.aggregate(t.bids),0),r=this.sortBy(this.aggregate(t.asks),0),a=this.safeList(s,0,[]),n=this.safeList(r,0,[]);return this.safeTicker({symbol:e.symbol,timestamp:i,datetime:this.iso8601(i),ask:this.safeNumber(n,0),askVolume:this.safeNumber(n,1),bid:this.safeNumber(a,0),bidVolume:this.safeNumber(a,1),info:t},e)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){r.callerMethodName="watchOHLCV";return(await this.watchOHLCVForSymbols([[t,e]],i,s,r))[t][e]}async watchOHLCVForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.getListFromObjectValues(t,0),a=this.marketSymbols(r,void 0,!1,!0,!0)[0],n=await this.getUrlByMarketType(a,!1,"watchOHLCVForSymbols",s),o=[],d=[];for(let e=0;e<t.length;e++){const i=t[e];let s=this.safeString(i,0);const r=this.market(s);s=r.symbol;const a=this.safeString(i,1),n=this.safeString(this.timeframes,a,a);o.push("kline."+n+"."+r.id),d.push("ohlcv::"+s+"::"+a)}const[c,h,l]=await this.watchTopics(n,d,o,s);this.newUpdates&&(i=l.getLimit(c,i));const u=this.filterBySinceLimit(l,e,i,0,!0);return this.createOHLCVObject(c,h,u)}async unWatchOHLCVForSymbols(t,e={}){await this.loadMarkets();const i=this.getListFromObjectValues(t,0),s=this.marketSymbols(i,void 0,!1,!0,!0)[0],r=await this.getUrlByMarketType(s,!1,"watchOHLCVForSymbols",e),a=[],n=[],o=[];for(let e=0;e<t.length;e++){const i=t[e];let s=this.safeString(i,0);const r=this.market(s);s=r.symbol;const d=this.safeString(i,1),c=this.safeString(this.timeframes,d,d);a.push("kline."+c+"."+r.id),n.push("ohlcv::"+s+"::"+d),o.push("unsubscribe::ohlcv::"+s+"::"+d)}const d={symbolsAndTimeframes:t};return await this.unWatchTopics(r,"ohlcv",i,o,n,a,e,d)}async unWatchOHLCV(t,e="1m",i={}){return i.callerMethodName="watchOHLCV",await this.unWatchOHLCVForSymbols([[t,e]],i)}handleOHLCV(t,e){const i=this.safeValue(e,"data",{}),s=this.safeString(e,"topic").split("."),r=s.length,n=this.safeString(s,1),o=this.findTimeframe(n),d=this.safeString(s,r-1),c=t.url.indexOf("spot")>-1?"spot":"contract",h=this.safeMarket(d,void 0,void 0,c),l=h.symbol,u=this.safeValue(this.ohlcvs,l);if(void 0===u&&(this.ohlcvs[l]={}),void 0===this.safeValue(u,o)){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);this.ohlcvs[l][o]=new a.TG(t)}const p=this.ohlcvs[l][o];for(let t=0;t<i.length;t++){const e=this.parseWsOHLCV(i[t],h);p.append(e)}const f="ohlcv::"+l+"::"+o,m=[l,o,p];t.resolve(m,f)}parseWsOHLCV(t,e=void 0){const i=e.inverse?"turnover":"volume";return[this.safeInteger(t,"start"),this.safeNumber(t,"open"),this.safeNumber(t,"high"),this.safeNumber(t,"low"),this.safeNumber(t,"close"),this.safeNumber(t,i)]}async watchOrderBook(t,e=void 0,i={}){return await this.watchOrderBookForSymbols([t],e,i)}async watchOrderBookForSymbols(t,e=void 0,i={}){await this.loadMarkets();if(0===t.length)throw new r.ArgumentsRequired(this.id+" watchOrderBookForSymbols() requires a non-empty array of symbols");t=this.marketSymbols(t);const s=await this.getUrlByMarketType(t[0],!1,"watchOrderBook",i);i=this.cleanParams(i);const a=this.market(t[0]);if(void 0===e)e=50,a.option&&(e=100);else{const t={spot:[1,50,200,1e3],option:[25,100],default:[1,50,200,1e3]},i=this.safeList2(t,a.type,"default");if(!this.inArray(e,i))throw new r.BadRequest(this.id+" watchOrderBookForSymbols(): for "+a.type+" markets limit can be one of: "+this.json(i))}const n=[],o=[];for(let i=0;i<t.length;i++){const s=t[i],r=this.marketId(s),a="orderbook."+e.toString()+"."+r;n.push(a);const d="orderbook:"+s;o.push(d)}return(await this.watchTopics(s,o,n,i)).limit()}async unWatchOrderBookForSymbols(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1);let i="orderbook.",s=this.safeInteger(e,"limit");if(void 0!==s)e=this.omit(e,"limit");else{s=this.market(t[0]).spot?50:500}i+=s.toString();const r=[],a=[],n=[];for(let e=0;e<t.length;e++){const s=t[e],o=i+"."+this.market(s).id;a.push("unsubscribe:orderbook:"+s),r.push("orderbook:"+s),n.push(o)}const o=await this.getUrlByMarketType(t[0],!1,"watchOrderBook",e);return await this.unWatchTopics(o,"orderbook",t,a,r,n,e)}async unWatchOrderBook(t,e={}){return await this.loadMarkets(),await this.unWatchOrderBookForSymbols([t],e)}handleOrderBook(t,e){const i=this.safeString(e,"topic").split(".")[1],s=t.url.indexOf("spot")>=0,r="snapshot"===this.safeString(e,"type"),a=this.safeDict(e,"data",{}),n=this.safeString(a,"s"),o=s?"spot":"contract",d=this.safeMarket(n,void 0,void 0,o),c=d.symbol,h=this.safeInteger(e,"ts");c in this.orderbooks||(this.orderbooks[c]=this.orderBook());const l=this.orderbooks[c];if(l.symbol=c,r){const t=this.parseOrderBook(a,c,h,"b","a");l.reset(t)}else{const t=this.safeList(a,"a",[]),e=this.safeList(a,"b",[]);this.handleDeltas(l.asks,t),this.handleDeltas(l.bids,e),l.timestamp=h,l.datetime=this.iso8601(h)}const u="orderbook:"+c;if(this.orderbooks[c]=l,t.resolve(l,u),"1"===i){const e=this.parseWsBidAsk(this.orderbooks[c],d),i={};i[c]=e,this.bidsasks[c]=e,t.resolve(i,"bidask:"+c)}}handleDelta(t,e){const i=this.parseBidAsk(e,0,1);t.storeArray(i)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}async watchTrades(t,e=void 0,i=void 0,s={}){return await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();if(0===(t=this.marketSymbols(t)).length)throw new r.ArgumentsRequired(this.id+" watchTradesForSymbols() requires a non-empty array of symbols");s=this.cleanParams(s);const a=await this.getUrlByMarketType(t[0],!1,"watchTrades",s),n=[],o=[];for(let e=0;e<t.length;e++){const i=t[e],s="publicTrade."+this.market(i).id;n.push(s);const r="trade:"+i;o.push(r)}const d=await this.watchTopics(a,o,n,s);if(this.newUpdates){const t=this.safeValue(d,0),e=this.safeString(t,"symbol");i=d.getLimit(e,i)}return this.filterBySinceLimit(d,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1,!0);const i=await this.getUrlByMarketType(t[0],!1,"unWatchTradesForSymbols",e),s=[],r=[],a=[];for(let e=0;e<t.length;e++){const i=t[e],n="publicTrade."+this.market(i).id;r.push(n);const o="unsubscribe:trade:"+i;s.push(o),a.push("trade:"+i)}return await this.unWatchTopics(i,"trades",t,s,a,r,e)}async unWatchTrades(t,e={}){return await this.loadMarkets(),await this.unWatchTradesForSymbols([t],e)}handleTrades(t,e){const i=this.safeValue(e,"data",{}),s=this.safeString(e,"topic").split("."),r=t.url.indexOf("spot")>=0?"spot":"contract",n=this.safeString(s,1),o=this.safeMarket(n,void 0,void 0,r),d=o.symbol;let c=this.safeValue(this.trades,d);if(void 0===c){const t=this.safeInteger(this.options,"tradesLimit",1e3);c=new a.I3(t),this.trades[d]=c}for(let t=0;t<i.length;t++){const e=this.parseWsTrade(i[t],o);c.append(e)}const h="trade:"+d;t.resolve(c,h)}parseWsTrade(t,e=void 0){const i=this.safeStringN(t,["i","T","v"]);let s="BT"in t?"contract":"spot";void 0!==e&&(s=e.type);const r=this.safeString(t,"s"),a=(e=this.safeMarket(r,e,void 0,s)).symbol,n=this.safeInteger2(t,"t","T");let o,d=this.safeStringLower(t,"S");const c=this.safeValue(t,"m");void 0===d?d=c?"buy":"sell":o=c;const h=this.safeString(t,"p"),l=this.safeString2(t,"q","v"),u=this.safeString(t,"o");return this.safeTrade({id:i,info:t,timestamp:n,datetime:this.iso8601(n),symbol:a,order:u,type:void 0,side:d,takerOrMaker:o,price:h,amount:l,cost:void 0,fee:void 0},e)}getPrivateType(t){return t.indexOf("spot")>=0?"spot":t.indexOf("v5/private")>=0?"unified":"usdc"}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r="myTrades";await this.loadMarkets(),void 0!==t&&(r+=":"+(t=this.symbol(t)));const a=await this.getUrlByMarketType(t,!0,"watchMyTrades",s);await this.authenticate(a);let n=this.safeValue({spot:"ticketInfo",unified:"execution",usdc:"user.openapi.perp.trade"},this.getPrivateType(a)),o=!1;[o,s]=this.handleOptionAndParams(s,"watchMyTrades","executionFast",!1),o&&(n="execution.fast");const d=await this.watchTopics(a,[r],[n],s);return this.newUpdates&&(i=d.getLimit(t,i)),this.filterBySymbolSinceLimit(d,t,e,i,!0)}async unWatchMyTrades(t=void 0,e={}){if(await this.loadMarkets(),void 0!==t)throw new r.NotSupported(this.id+" unWatchMyTrades() does not support a symbol parameter, you must unwatch all my trades");const i=await this.getUrlByMarketType(t,!0,"watchMyTrades",e);await this.authenticate(i);let s=this.safeValue({spot:"ticketInfo",unified:"execution",usdc:"user.openapi.perp.trade"},this.getPrivateType(i)),a=!1;return[a,e]=this.handleOptionAndParams(e,"watchMyTrades","executionFast",!1),a&&(s="execution.fast"),await this.unWatchTopics(i,"myTrades",[],["unsubscribe:myTrades"],["myTrades"],[s],e)}handleMyTrades(t,e){const i=this.safeString(e,"topic"),s="ticketInfo"===i,r="execution.fast"===i;let n=this.safeValue(e,"data",[]);if(Array.isArray(n)||(n=this.safeValue(n,"result",[])),void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new a.Pt(t)}const o=this.myTrades,d={},c=this.handleOption("watchMyTrades","filterExecTypes",[]);for(let t=0;t<n.length;t++){const e=n[t];let i;if(s&&!r)i=this.parseWsTrade(e);else{let t=this.safeString(e,"execType","");if(r&&(t="Trade"),!this.inArray(t,c))continue;i=this.parseTrade(e)}d[i.symbol]=!0,o.append(i)}const h=Object.keys(d);for(let e=0;e<h.length;e++){const i="myTrades:"+h[e];t.resolve(o,i)}t.resolve(o,"myTrades")}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r="";this.isEmpty(t)||(r="::"+(t=this.marketSymbols(t)).join(","));const a=this.safeString(t,0),n=await this.getUrlByMarketType(a,!0,"watchPositions",s);r="positions"+r;const o=this.client(n);await this.authenticate(n),this.setPositionsCache(o,t);const d=this.positions,c=this.handleOption("watchPositions","fetchPositionsSnapshot",!0),h=this.handleOption("watchPositions","awaitPositionsSnapshot",!0);if(c&&h&&void 0===d){const s=await o.future("fetchPositionsSnapshot");return this.filterBySymbolsSinceLimit(s,t,e,i,!0)}const l=await this.watchTopics(n,[r],["position"],s);return this.newUpdates?l:this.filterBySymbolsSinceLimit(d,t,e,i,!0)}setPositionsCache(t,e=void 0){if(void 0!==this.positions)return;if(this.handleOption("watchPositions","fetchPositionsSnapshot",!0)){const e="fetchPositionsSnapshot";e in t.futures||(t.future(e),this.spawn(this.loadPositionsSnapshot,t,e))}else this.positions=new a.Hk}async loadPositionsSnapshot(t,e){const i=[this.fetchPositions(void 0,{type:"swap",subType:"linear"}),this.fetchPositions(void 0,{type:"swap",subType:"inverse"})],s=await Promise.all(i);this.positions=new a.Hk;const r=this.positions;for(let t=0;t<s.length;t++){const e=s[t];for(let t=0;t<e.length;t++){const i=e[t];r.append(i)}}if(e in t.futures){t.futures[e].resolve(r),t.resolve(r,"position")}}handlePositions(t,e){void 0===this.positions&&(this.positions=new a.Hk);const i=this.positions,s=[],r=this.safeValue(e,"data",[]);for(let t=0;t<r.length;t++){const e=r[t],a=this.parsePosition(e),n=this.safeString(a,"side");s.push(a),void 0===n||""===n?(a.side="long",i.append(a),a.side="short",i.append(a),a.side=void 0):i.append(a)}const n=this.findMessageHashes(t,"positions::");for(let e=0;e<n.length;e++){const i=n[e],r=i.split("::")[1].split(","),a=this.filterByArray(s,"symbol",r,!1);this.isEmpty(a)||t.resolve(a,i)}t.resolve(s,"positions")}async unWatchPositions(t=void 0,e={}){await this.loadMarkets();if(!this.isEmpty(t))throw new r.NotSupported(this.id+" unWatchPositions() does not support a symbol parameter, you must unwatch all orders");const i=await this.getUrlByMarketType(void 0,!0,"watchPositions",e);await this.authenticate(i);return await this.unWatchTopics(i,"positions",t,["unsubscribe:positions"],["positions"],["position"],e)}async watchLiquidations(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t);t=r.symbol;const a=await this.getUrlByMarketType(t,!1,"watchLiquidations",s);let n;s=this.cleanParams(s),[n,s]=this.handleOptionAndParams(s,"watchLiquidations","method","liquidation");const o="liquidations::"+t,d=n+"."+r.id,c=await this.watchTopics(a,[o],[d],s);return this.newUpdates?c:this.filterBySymbolsSinceLimit(this.liquidations,[t],e,i,!0)}handleLiquidation(t,e){if(Array.isArray(e.data)){const i=this.safeList(e,"data",[]);for(let e=0;e<i.length;e++){const s=i[e],r=this.safeString(s,"s"),n=this.safeMarket(r,void 0,"","contract"),o=n.symbol,d=this.parseWsLiquidation(s,n);let c=this.safeValue(this.liquidations,o);if(void 0===c){const t=this.safeInteger(this.options,"liquidationsLimit",1e3);c=new a.I3(t)}c.append(d),this.liquidations[o]=c,t.resolve([d],"liquidations"),t.resolve([d],"liquidations::"+o)}}else{const i=this.safeDict(e,"data",{}),s=this.safeString(i,"symbol"),r=this.safeMarket(s,void 0,"","contract"),n=r.symbol,o=this.parseWsLiquidation(i,r);let d=this.safeValue(this.liquidations,n);if(void 0===d){const t=this.safeInteger(this.options,"liquidationsLimit",1e3);d=new a.I3(t)}d.append(o),this.liquidations[n]=d,t.resolve([o],"liquidations"),t.resolve([o],"liquidations::"+n)}}parseWsLiquidation(t,e=void 0){const i=this.safeString2(t,"symbol","s");e=this.safeMarket(i,e,"","contract");const s=this.safeInteger2(t,"updatedTime","T");return this.safeLiquidation({info:t,symbol:e.symbol,contracts:this.safeNumber2(t,"size","v"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber2(t,"price","p"),side:this.safeStringLower(t,"side","S"),baseValue:void 0,quoteValue:void 0,timestamp:s,datetime:this.iso8601(s)})}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r="orders";void 0!==t&&(r+=":"+(t=this.symbol(t)));const a=await this.getUrlByMarketType(t,!0,"watchOrders",s);await this.authenticate(a);const n=this.safeValue({spot:["order","stopOrder"],unified:["order"],usdc:["user.openapi.perp.order"]},this.getPrivateType(a)),o=await this.watchTopics(a,[r],n,s);return this.newUpdates&&(i=o.getLimit(t,i)),this.filterBySymbolSinceLimit(o,t,e,i,!0)}async unWatchOrders(t=void 0,e={}){await this.loadMarkets();if(void 0!==t)throw new r.NotSupported(this.id+" unWatchOrders() does not support a symbol parameter, you must unwatch all orders");const i=await this.getUrlByMarketType(t,!0,"watchOrders",e);await this.authenticate(i);const s=this.safeValue({spot:["order","stopOrder"],unified:["order"],usdc:["user.openapi.perp.order"]},this.getPrivateType(i));return await this.unWatchTopics(i,"orders",[],["unsubscribe:orders"],["orders"],s,e)}handleOrderWs(t,e){const i=this.safeString(e,"reqId"),s=this.safeDict(e,"data"),r=this.parseOrder(s);t.resolve(r,i)}handleOrder(t,e){if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a.Pt(t)}const i=this.orders;let s=this.safeValue(e,"data",[]);const r=this.safeValue(s,0,{});"spot"===this.safeString(r,"category")||(s=this.safeValue(s,"result",s));const n={};for(let t=0;t<s.length;t++){const e=this.parseOrder(s[t]);n[e.symbol]=!0,i.append(e)}const o=Object.keys(n);for(let e=0;e<o.length;e++){const s="orders:"+o[e];t.resolve(i,s)}t.resolve(i,"orders")}async watchBalance(t={}){await this.loadMarkets();let e,i,s="balances";[e,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t),[i,t]=this.handleSubTypeAndParams("watchBalance",void 0,t);const r=await this.isUnifiedEnabled(),a=this.safeBool(r,0,!1),n=this.safeBool(r,1,!1),o=await this.getUrlByMarketType(void 0,!0,"watchBalance",t);await this.authenticate(o);n&&(s+="inverse"===i?":contract":":unified"),a||n||(s+="spot"===e?":spot":":contract"),a&&(s+="spot"===e?":spot":"linear"===i?":unified":":contract");const d=[this.safeValue({spot:"outboundAccountInfo",unified:"wallet"},this.getPrivateType(o))];return await this.watchTopics(o,[s],d,t)}handleBalance(t,e){void 0===this.balance&&(this.balance={});let i="balance";const s=this.safeValue(e,"topic");let r,a,n=[];if("outboundAccountInfo"===s){a="spot";const t=this.safeValue(e,"data",[]);for(let e=0;e<t.length;e++){const i=this.safeValue(t[e],"B",[]);n=this.arrayConcat(n,i)}r=n}if("wallet"===s){const t=this.safeValue(e,"data",{});for(let e=0;e<t.length;e++){const e=this.safeValue(t,0,{});a=this.safeStringLower(e,"accountType"),n=this.arrayConcat(n,this.safeValue(e,"coin",[]))}r=t}for(let t=0;t<n.length;t++)this.parseWsBalance(n[t],a);if(void 0!==a){void 0===this.safeValue(this.balance,a)&&(this.balance[a]={}),this.balance[a].info=r;const s=this.safeInteger(e,"ts");this.balance[a].timestamp=s,this.balance[a].datetime=this.iso8601(s),this.balance[a]=this.safeBalance(this.balance[a]),i="balances:"+a,t.resolve(this.balance[a],i)}else{this.balance.info=r;const s=this.safeInteger(e,"ts");this.balance.timestamp=s,this.balance.datetime=this.iso8601(s),this.balance=this.safeBalance(this.balance),i="balances",t.resolve(this.balance,i)}}parseWsBalance(t,e=void 0){const i=this.account(),s=this.safeString2(t,"a","coin"),r=this.safeCurrencyCode(s);i.free=this.safeStringN(t,["availableToWithdraw","f","free","availableToWithdraw"]),i.used=this.safeString2(t,"l","locked"),i.total=this.safeString(t,"walletBalance"),void 0!==e?(void 0===this.safeValue(this.balance,e)&&(this.balance[e]={}),this.balance[e][r]=i):this.balance[r]=i}async watchTopics(t,e,i,s={}){const r={op:"subscribe",req_id:this.requestId(),args:i},a=this.extend(r,s);return await this.watchMultiple(t,e,a,e)}async unWatchTopics(t,e,i,s,r,a,n={},o={}){const d=this.requestId(),c={op:"unsubscribe",req_id:d,args:a},h={id:d,topic:e,messageHashes:s,subMessageHashes:r,symbols:i},l=this.extend(c,n);return await this.watchMultiple(t,s,l,s,this.extend(h,o))}async authenticate(t,e={}){this.checkRequiredCredentials();const i="authenticated",s=this.client(t),r=s.reusableFuture(i);if(void 0===this.safeValue(s.subscriptions,i)){const s=this.milliseconds()+1e4,r=this.numberToString(s),a="GET/realtime"+r,o=this.hmac(this.encode(a),this.encode(this.secret),n.s,"hex"),d={op:"auth",args:[this.apiKey,r,o]},c=this.extend(d,e);this.watch(t,i,c,i)}return await r}handleErrorMessage(t,e){const i=this.safeStringN(e,["code","ret_code","retCode"]);try{if(void 0!==i&&"0"!==i){const t=this.id+" "+this.json(e);this.throwExactlyMatchedException(this.exceptions.exact,i,t);const s=this.safeString2(e,"retMsg","ret_msg");throw this.throwBroadlyMatchedException(this.exceptions.broad,s,t),new r.ExchangeError(t)}const t=this.safeValue(e,"success");if(void 0!==t&&!t){const t=this.safeString(e,"ret_msg"),i=this.safeValue(e,"request",{});throw"auth"===this.safeString(i,"op")?new r.AuthenticationError("Authentication failed: "+t):new r.ExchangeError(this.id+" "+t)}return!1}catch(i){if(i instanceof r.AuthenticationError){const e="authenticated";t.reject(i,e),e in t.subscriptions&&delete t.subscriptions[e]}else{const s=this.safeString(e,"reqId");t.reject(i,s)}return!0}}handleMessage(t,e){const i=this.safeString2(e,"topic","op","");if(this.handleErrorMessage(t,e))return;if("pong"===this.safeString(e,"ret_msg")||"pong"===i)return void this.handlePong(t,e);if(void 0!==this.safeInteger(e,"pong"))return void this.handlePong(t,e);if("sub"===this.safeString(e,"event")||"subscribe"===i)return void this.handleSubscriptionStatus(t,e);const s={orderbook:this.handleOrderBook,kline:this.handleOHLCV,order:this.handleOrder,stopOrder:this.handleOrder,ticker:this.handleTicker,trade:this.handleTrades,publicTrade:this.handleTrades,depth:this.handleOrderBook,wallet:this.handleBalance,outboundAccountInfo:this.handleBalance,execution:this.handleMyTrades,"execution.fast":this.handleMyTrades,ticketInfo:this.handleMyTrades,"user.openapi.perp.trade":this.handleMyTrades,position:this.handlePositions,liquidation:this.handleLiquidation,allLiquidation:this.handleLiquidation,pong:this.handlePong,"order.create":this.handleOrderWs,"order.amend":this.handleOrderWs,"order.cancel":this.handleOrderWs,auth:this.handleAuthenticate,unsubscribe:this.handleUnSubscribe},r=this.safeValue(s,i);if(void 0!==r)return void r.call(this,t,e);const a=Object.keys(s);for(let r=0;r<a.length;r++){const n=a[r];if(i.indexOf(a[r])>=0){return void s[n].call(this,t,e)}}"AUTH_RESP"===this.safeString(e,"type")&&this.handleAuthenticate(t,e)}ping(t){return{req_id:this.requestId(),op:"ping"}}handlePong(t,e){return t.lastPong=this.safeInteger(e,"pong"),e}handleAuthenticate(t,e){const i=this.safeValue(e,"success"),s=this.safeInteger(e,"retCode"),a="authenticated";if(i||0===s){this.safeValue(t.futures,a).resolve(!0)}else{const i=new r.AuthenticationError(this.id+" "+this.json(e));t.reject(i,a),a in t.subscriptions&&delete t.subscriptions[a]}return e}handleSubscriptionStatus(t,e){return e}handleUnSubscribe(t,e){const i=this.safeString(e,"req_id"),s=Object.keys(t.subscriptions);for(let e=0;e<s.length;e++){const r=s[e];if(r in t.subscriptions&&r.startsWith("unsubscribe")){const e=t.subscriptions[r];if(i!==this.safeString(e,"id"))continue;const s=this.safeList(e,"messageHashes",[]),a=this.safeList(e,"subMessageHashes",[]);for(let e=0;e<s.length;e++){const i=s[e],r=a[e],n="orders"===r||"myTrades"===r||"positions"===r;this.cleanUnsubscription(t,r,i,n)}this.cleanCache(e)}}return e}}},8588(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(3660),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchTicker:!0,watchMarkPrice:!0,watchMarkPrices:!0,watchTickers:!0,watchBidsAsks:!0,watchOrderBook:!0,watchTrades:!0,watchTradesForSymbols:!0,watchOrderBookForSymbols:!0,watchBalance:!0,watchLiquidations:"emulated",watchLiquidationsForSymbols:!0,watchMyLiquidations:"emulated",watchMyLiquidationsForSymbols:!0,watchOHLCV:!0,watchOHLCVForSymbols:!0,watchOrders:!0,watchMyTrades:!0,watchPositions:!0,watchFundingRate:!0,watchFundingRates:!0,createOrderWs:!0,editOrderWs:!0,cancelOrderWs:!0,cancelOrdersWs:!0,cancelAllOrdersWs:!0},urls:{api:{ws:"wss://ws.okx.com:8443/ws/v5"},test:{ws:"wss://wspap.okx.com:8443/ws/v5"}},options:{watchOrderBook:{checksum:!0,depth:"books"},watchBalance:"spot",watchTicker:{channel:"tickers"},watchTickers:{channel:"tickers"},watchOrders:{type:"ANY"},watchMyTrades:{type:"ANY"},createOrderWs:{op:"batch-orders"},editOrderWs:{op:"amend-order"},ws:{}},streaming:{ping:this.ping,keepAlive:18e3}})}getUrl(t,e="public"){const i=this.options.sandboxMode?"?brokerId=9999":"",s="business"===e,r="public"===e,a=this.urls.api.ws;return s||t.indexOf("candle")>-1||"orders-algo"===t?a+"/business"+i:r?a+"/public"+i:a+"/private"+i}async subscribeMultiple(t,e,i=void 0,s={}){await this.loadMarkets(),void 0===i&&(i=this.symbols),i=this.marketSymbols(i);const r=this.getUrl(e,t),a=[],n=[];for(let t=0;t<i.length;t++){const r={channel:e,instId:this.marketId(i[t])};n.push(this.extend(r,s)),a.push(e+"::"+i[t])}const o={op:"subscribe",args:n};return await this.watchMultiple(r,a,o,a)}async subscribe(t,e,i,s,r={}){await this.loadMarkets();const a=this.getUrl(i,t),n={channel:i};if(void 0!==s){const t=this.market(s);e+=":"+t.id,n.instId=t.id}const o={op:"subscribe",args:[this.deepExtend(n,r)]};return await this.watch(a,e,o,e)}async watchTrades(t,e=void 0,i=void 0,s={}){return await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){if(0===t.length)throw new r.ArgumentsRequired(this.id+" watchTradesForSymbols() requires a non-empty array of symbols");let a;await this.loadMarkets(),t=this.marketSymbols(t),[a,s]=this.handleOptionAndParams(s,"watchTrades","channel","trades");const n=[],o=[];for(let e=0;e<t.length;e++){const i=t[e];o.push(a+":"+i);const s={channel:a,instId:this.marketId(i)};n.push(s)}const d={op:"subscribe",args:n};let c="public";"trades-all"===a&&(c="business",await this.authenticate({access:c}));const h=this.getUrl(a,c),l=await this.watchMultiple(h,o,d,o);if(this.newUpdates){const t=this.safeValue(l,0),e=this.safeString(t,"symbol");i=l.getLimit(e,i)}return this.filterBySinceLimit(l,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchTrades","channel","trades");const s=[],r=[];for(let e=0;e<t.length;e++){const a=t[e];r.push("unsubscribe:"+i+a);const n={channel:i,instId:this.marketId(a)};s.push(n)}const a={op:"unsubscribe",args:s};let n="public";"trades-all"===i&&(n="business",await this.authenticate({access:n}));const o=this.getUrl(i,n);return await this.watchMultiple(o,r,a,r)}async unWatchTrades(t,e={}){return await this.unWatchTradesForSymbols([t],e)}handleTrades(t,e){const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"channel"),r=this.safeString(i,"instId"),n=this.safeSymbol(r),o=this.safeValue(e,"data",[]),d=this.safeInteger(this.options,"tradesLimit",1e3);for(let e=0;e<o.length;e++){const i=this.parseTrade(o[e]),r=s+":"+n;let c=this.safeValue(this.trades,n);void 0===c&&(c=new a.I3(d),this.trades[n]=c),c.append(i),t.resolve(c,r)}}async watchFundingRate(t,e={}){t=this.symbol(t);return(await this.watchFundingRates([t],e))[t]}async watchFundingRates(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i="funding-rate",s=[],r=[];for(let e=0;e<t.length;e++){const a=t[e];r.push(i+":"+a);const n={channel:i,instId:this.marketId(a)};s.push(n)}const a={op:"subscribe",args:s},n=this.getUrl(i,"public"),o=await this.watchMultiple(n,r,a,r);if(this.newUpdates){const t={};return t[this.safeString(o,"symbol")]=o,t}return this.filterByArray(this.fundingRates,"symbol",t)}handleFundingRate(t,e){const i=this.safeList(e,"data",[]);for(let e=0;e<i.length;e++){const s=i[e],r=this.parseFundingRate(s),a=r.symbol;this.fundingRates[a]=r,t.resolve(r,"funding-rate:"+r.symbol)}}async watchTicker(t,e={}){let i;[i,e]=this.handleOptionAndParams(e,"watchTicker","channel","tickers"),e.channel=i;t=this.market(t).symbol;const s=await this.watchTickers([t],e);return this.safeValue(s,t)}async unWatchTicker(t,e={}){return await this.unWatchTickers([t],e)}async watchTickers(t=void 0,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchTickers","channel","tickers");const s=await this.subscribeMultiple("public",i,t,e);return this.newUpdates?s:this.filterByArray(this.tickers,"symbol",t)}async watchMarkPrice(t,e={}){let i;[i,e]=this.handleOptionAndParams(e,"watchMarkPrice","channel","mark-price"),e.channel=i;t=this.market(t).symbol;return(await this.watchMarkPrices([t],e))[t]}async watchMarkPrices(t=void 0,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchMarkPrices","channel","mark-price");const s=await this.subscribeMultiple("public",i,t,e);return this.newUpdates?s:this.filterByArray(this.tickers,"symbol",t)}async unWatchTickers(t=void 0,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchTickers","channel","tickers");const s=[],r=[];for(let e=0;e<t.length;e++){const a=t[e];r.push("unsubscribe:ticker:"+a);const n={channel:i,instId:this.marketId(a)};s.push(n)}const a={op:"unsubscribe",args:s},n=this.getUrl(i,"public");return await this.watchMultiple(n,r,a,r)}handleTicker(t,e){this.handleBidAsk(t,e);const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"instId"),r=this.safeMarket(s,void 0,"-").symbol,a=this.safeString(i,"channel"),n=this.safeValue(e,"data",[]),o={};for(let t=0;t<n.length;t++){const e=this.parseTicker(n[t]);this.tickers[r]=e,o[r]=e}const d=a+"::"+r;t.resolve(o,d)}async watchBidsAsks(t=void 0,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchBidsAsks","channel","tickers");const s=this.getUrl(i,"public"),r=[],a=[];for(let s=0;s<t.length;s++){const n={channel:i,instId:this.marketId(t[s])};a.push(this.extend(n,e)),r.push("bidask::"+t[s])}const n={op:"subscribe",args:a},o=await this.watchMultiple(s,r,n,r);if(this.newUpdates){const t={};return t[o.symbol]=o,t}return this.filterByArray(this.bidsasks,"symbol",t)}handleBidAsk(t,e){const i=this.safeList(e,"data",[]),s=this.safeDict(i,0,{}),r=this.parseWsBidAsk(s),a=r.symbol;this.bidsasks[a]=r;const n="bidask::"+a;t.resolve(r,n)}parseWsBidAsk(t,e=void 0){const i=this.safeString(t,"instId");e=this.safeMarket(i,e);const s=this.safeString(e,"symbol"),r=this.safeInteger(t,"ts");return this.safeTicker({symbol:s,timestamp:r,datetime:this.iso8601(r),ask:this.safeString(t,"askPx"),askVolume:this.safeString(t,"askSz"),bid:this.safeString(t,"bidPx"),bidVolume:this.safeString(t,"bidSz"),info:t},e)}async watchLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r="liquidations",a=[];if(void 0!==(t=this.marketSymbols(t,void 0,!0,!0)))for(let e=0;e<t.length;e++){const i=t[e];a.push(r+"::"+i)}else a.push(r);const n=this.getMarketFromSymbols(t);let o;[o,s]=this.handleMarketTypeAndParams("watchliquidationsForSymbols",n,s);const d="liquidation-orders";"spot"===o?o="SWAP":"future"===o&&(o="futures");const c={op:"subscribe",args:[{channel:d,instType:o.toUpperCase()}]},h=this.getUrl(d,"public"),l=await this.watchMultiple(h,a,c,a);return this.newUpdates?l:this.filterBySymbolsSinceLimit(this.liquidations,t,e,i,!0)}handleLiquidation(t,e){const i=this.safeList(e,"data",[]);for(let e=0;e<i.length;e++){const s=i[e],r=this.parseWsLiquidation(s),n=this.safeString(r,"symbol");let o=this.safeValue(this.liquidations,n);if(void 0===o){const t=this.safeInteger(this.options,"liquidationsLimit",1e3);o=new a.I3(t)}o.append(r),this.liquidations[n]=o,t.resolve([r],"liquidations"),t.resolve([r],"liquidations::"+n)}}async watchMyLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.safeValue2(s,"stop","trigger",!1);s=this.omit(s,["stop","trigger"]),await this.authenticate({access:r?"business":"private"});const a="myLiquidations",n=[];if(void 0!==(t=this.marketSymbols(t,void 0,!0,!0)))for(let e=0;e<t.length;e++){const i=t[e];n.push(a+"::"+i)}else n.push(a);const o="balance_and_position",d={op:"subscribe",args:[{channel:o}]},c=this.getUrl(o,"private"),h=await this.watchMultiple(c,n,this.deepExtend(d,s),n);return this.newUpdates?h:this.filterBySymbolsSinceLimit(this.liquidations,t,e,i,!0)}handleMyLiquidation(t,e){const i=this.safeList(e,"data",[]);for(let e=0;e<i.length;e++){const s=i[e];if("liquidation"!==this.safeString(s,"eventType"))return;const r=this.parseWsMyLiquidation(s),n=this.safeString(r,"symbol");let o=this.safeValue(this.liquidations,n);if(void 0===o){const t=this.safeInteger(this.options,"myLiquidationsLimit",1e3);o=new a.I3(t)}o.append(r),this.liquidations[n]=o,t.resolve([r],"myLiquidations"),t.resolve([r],"myLiquidations::"+n)}}parseWsMyLiquidation(t,e=void 0){const i=this.safeList(t,"posData",[]),s=this.safeDict(i,0,{}),r=this.safeString(s,"instId");e=this.safeMarket(r,e);const a=this.safeInteger(s,"uTIme");return this.safeLiquidation({info:t,symbol:this.safeSymbol(r,e),contracts:this.safeNumber(s,"pos"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(t,"avgPx"),baseValue:void 0,quoteValue:void 0,timestamp:a,datetime:this.iso8601(a)})}parseWsLiquidation(t,e=void 0){const i=this.safeList(t,"details",[]),s=this.safeDict(i,0,{}),r=this.safeString(t,"instId");e=this.safeMarket(r,e);const a=this.safeInteger(s,"ts");return this.safeLiquidation({info:t,symbol:this.safeSymbol(r,e),contracts:this.safeNumber(s,"sz"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(s,"bkPx"),side:this.safeString(s,"side"),baseValue:void 0,quoteValue:void 0,timestamp:a,datetime:this.iso8601(a)})}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets(),t=this.symbol(t);const a="candle"+this.safeString(this.timeframes,e,e),n=await this.subscribe("public",a,a,t,r);return this.newUpdates&&(s=n.getLimit(t,s)),this.filterBySinceLimit(n,i,s,0,!0)}async unWatchOHLCV(t,e="1m",i={}){return await this.loadMarkets(),await this.unWatchOHLCVForSymbols([[t,e]],i)}async watchOHLCVForSymbols(t,e=void 0,i=void 0,s={}){if(0===t.length||!Array.isArray(t[0]))throw new r.ArgumentsRequired(this.id+" watchOHLCVForSymbols() requires a an array of symbols and timeframes, like  [['BTC/USDT', '1m'], ['LTC/USDT', '5m']]");await this.loadMarkets();const a=[],n=[];for(let e=0;e<t.length;e++){const i=t[e],s=i[0],r=i[1],o=this.marketId(s),d="candle"+this.safeString(this.timeframes,r,r),c={channel:d,instId:o};a.push(c),n.push("multi:"+d+":"+s)}const o={op:"subscribe",args:a},d=this.getUrl("candle","public"),[c,h,l]=await this.watchMultiple(d,n,o,n);this.newUpdates&&(i=l.getLimit(c,i));const u=this.filterBySinceLimit(l,e,i,0,!0);return this.createOHLCVObject(c,h,u)}async unWatchOHLCVForSymbols(t,e={}){if(0===t.length||!Array.isArray(t[0]))throw new r.ArgumentsRequired(this.id+" watchOHLCVForSymbols() requires a an array of symbols and timeframes, like  [['BTC/USDT', '1m'], ['LTC/USDT', '5m']]");await this.loadMarkets();const i=[],s=[];for(let e=0;e<t.length;e++){const r=t[e],a=r[0],n=r[1],o=this.marketId(a),d="candle"+this.safeString(this.timeframes,n,n),c={channel:d,instId:o};i.push(c),s.push("unsubscribe:multi:"+d+":"+a)}const a={op:"unsubscribe",args:i},n=this.getUrl("candle","public");return await this.watchMultiple(n,s,a,s)}handleOHLCV(t,e){const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"channel"),r=this.safeValue(e,"data",[]),n=this.safeString(i,"instId"),o=this.safeMarket(n),d=o.symbol,c=s.replace("candle",""),h=this.findTimeframe(c);for(let e=0;e<r.length;e++){const i=this.parseOHLCV(r[e],o);this.ohlcvs[d]=this.safeValue(this.ohlcvs,d,{});let n=this.safeValue(this.ohlcvs[d],h);if(void 0===n){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);n=new a.TG(t),this.ohlcvs[d][h]=n}n.append(i);const c=s+":"+o.id;t.resolve(n,c);const l="multi:"+s+":"+d;t.resolve([d,h,n],l)}}async watchOrderBook(t,e=void 0,i={}){return await this.watchOrderBookForSymbols([t],e,i)}async watchOrderBookForSymbols(t,e=void 0,i={}){let s;if(await this.loadMarkets(),t=this.marketSymbols(t),[s,i]=this.handleOptionAndParams(i,"watchOrderBook","depth","books"),void 0!==e&&(1===e?s="bbo-tbt":e>1&&e<=5?s="books5":50===e?s="books50-l2-tbt":400===e&&(s="books")),"books-l2-tbt"===s||"books50-l2-tbt"===s){if(!this.checkRequiredCredentials(!1))throw new r.AuthenticationError(this.id+" watchOrderBook/watchOrderBookForSymbols requires authentication for this depth. Add credentials or change the depth option to books or books5");await this.authenticate({access:"public"})}const a=[],n=[];for(let e=0;e<t.length;e++){const i=t[e];n.push(s+":"+i);const r={channel:s,instId:this.marketId(i)};a.push(r)}const o={op:"subscribe",args:a},d=this.getUrl(s,"public");return(await this.watchMultiple(d,n,o,n)).limit()}async unWatchOrderBookForSymbols(t,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1),[i,e]=this.handleOptionAndParams(e,"watchOrderBook","depth","books");const s=this.safeInteger(e,"limit");void 0!==s&&(1===s?i="bbo-tbt":s>1&&s<=5?i="books5":50===s?i="books50-l2-tbt":400===s&&(i="books"));const r=[],a=[],n=[];for(let e=0;e<t.length;e++){const s=t[e];a.push(i+":"+s),n.push("unsubscribe:orderbook:"+s);const o={channel:i,instId:this.marketId(s)};r.push(o)}const o={op:"unsubscribe",args:r},d=this.getUrl(i,"public");return await this.watchMultiple(d,n,o,n)}async unWatchOrderBook(t,e={}){return await this.unWatchOrderBookForSymbols([t],e)}handleDelta(t,e){const i=this.safeFloat(e,0),s=this.safeFloat(e,1);t.store(i,s)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}handleOrderBookMessage(t,e,i,s,a=void 0){const n=this.safeValue(e,"asks",[]),o=this.safeValue(e,"bids",[]),d=i.asks,c=i.bids;this.handleDeltas(d,n),this.handleDeltas(c,o);const h=this.safeString(e,"instId"),l=this.safeSymbol(h,a),u=this.handleOption("watchOrderBook","checksum",!0),p=this.safeInteger(e,"seqId");if(u){const a=this.safeInteger(e,"prevSeqId"),n=i.nonce,o=d.length,h=c.length,u=[];for(let t=0;t<25;t++)t<h&&(u.push(this.numberToString(c[t][0])),u.push(this.numberToString(c[t][1]))),t<o&&(u.push(this.numberToString(d[t][0])),u.push(this.numberToString(d[t][1])));const p=u.join(":"),f=this.safeInteger(e,"checksum"),m=this.crc32(p,!0);let g;-1!==a&&n!==a&&(g=new r.InvalidNonce(this.id+" watchOrderBook received invalid nonce")),f!==m&&(g=new r.ChecksumError(this.id+" "+this.orderbookChecksumMessage(l))),void 0!==g&&(delete t.subscriptions[s],void 0!==l&&delete this.orderbooks[l],t.reject(g,s))}const f=this.safeInteger(e,"ts");return i.nonce=p,i.timestamp=f,i.datetime=this.iso8601(f),i}handleOrderBook(t,e){const i=this.safeDict(e,"arg",{}),s=this.safeString(i,"channel"),r=this.safeString(e,"action"),a=this.safeList(e,"data",[]),n=this.safeString(i,"instId"),o=this.safeMarket(n),d=o.symbol,c=this.safeInteger({"bbo-tbt":1,books:400,books5:5,"books-l2-tbt":400,"books50-l2-tbt":50},s),h=s+":"+d;if("snapshot"===r)for(let e=0;e<a.length;e++){const i=a[e],s=this.orderBook({},c);this.orderbooks[d]=s,s.symbol=d,this.handleOrderBookMessage(t,i,s,h),t.resolve(s,h)}else if("update"===r){if(d in this.orderbooks){const e=this.orderbooks[d];for(let i=0;i<a.length;i++){const s=a[i];this.handleOrderBookMessage(t,s,e,h,o),t.resolve(e,h)}}}else if("books5"===s||"bbo-tbt"===s){d in this.orderbooks||(this.orderbooks[d]=this.orderBook({},c));const e=this.orderbooks[d];for(let i=0;i<a.length;i++){const s=a[i],r=this.safeInteger(s,"ts"),n=this.parseOrderBook(s,d,r,"bids","asks",0,1);e.reset(n),t.resolve(e,h)}}return e}async authenticate(t={}){this.checkRequiredCredentials();const e=this.safeString(t,"access","private");t=this.omit(t,["access"]);const i=this.getUrl("users",e),s="authenticated",r=this.client(i),a=r.reusableFuture(s);if(void 0===this.safeValue(r.subscriptions,s)){const e=this.seconds().toString(),r=e+"GET"+"/users/self/verify",a=this.hmac(this.encode(r),this.encode(this.secret),n.s,"base64"),o={op:"login",args:[{apiKey:this.apiKey,passphrase:this.password,timestamp:e,sign:a}]};"access"in t&&(o.access=t.access),this.watch(i,s,o,s)}return await a}async watchBalance(t={}){return await this.loadMarkets(),await this.authenticate(),await this.subscribe("private","account","account",void 0,t)}handleBalanceAndPosition(t,e){this.handleMyLiquidation(t,e)}handleBalance(t,e){const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"channel"),r="spot",a=this.parseTradingBalance(e),n=this.safeValue(this.balance,r,{}),o=this.deepExtend(n,a);this.balance[r]=this.safeBalance(o),t.resolve(this.balance[r],s)}orderToTrade(t,e=void 0){const i=this.safeValue(t,"info",{}),s=this.safeInteger(i,"fillTime"),r=this.safeString(i,"fillFeeCcy"),a="T"===this.safeString(i,"execType","");return this.safeTrade({info:i,timestamp:s,datetime:this.iso8601(s),symbol:this.safeString(t,"symbol"),id:this.safeString(i,"tradeId"),order:this.safeString(t,"id"),type:this.safeString(t,"type"),takerOrMaker:a?"taker":"maker",side:this.safeString(t,"side"),price:this.safeNumber(i,"fillPx"),amount:this.safeNumber(i,"fillSz"),cost:this.safeNumber(t,"cost"),fee:{cost:this.safeNumber(i,"fillFee"),currency:this.safeCurrencyCode(r)}},e)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r;[r,s]=this.handleOptionAndParams(s,"watchMyTrades","type","ANY");const a=this.safeBool2(s,"trigger","stop",!1);s=this.omit(s,["trigger","stop"]),await this.loadMarkets(),await this.authenticate({access:a?"business":"private"});const n=a?"orders-algo":"orders";let o,d=n+"::myTrades";void 0!==t&&(o=this.market(t),t=o.symbol,r=o.type,d=d+"::"+t),"future"===r&&(r="futures");let c,h=r.toUpperCase();[c,s]=this.handleMarginModeAndParams("watchMyTrades",s),"SPOT"===h&&void 0!==c&&(h="MARGIN");const l={instType:h},u=await this.subscribe("private",d,n,void 0,this.extend(l,s));return this.newUpdates&&(i=u.getLimit(t,i)),this.filterBySymbolSinceLimit(u,t,e,i,!0)}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets(),await this.authenticate(s);const r={instType:"ANY"},a="positions";let n;if(void 0===(t=this.marketSymbols(t))){const t={channel:"positions",instType:"ANY"},e={op:"subscribe",args:[this.extend(t,s)]},i=this.getUrl(a,"private");n=await this.watch(i,a,e,a)}else n=await this.subscribeMultiple("private",a,t,this.extend(r,s));return this.newUpdates?n:this.filterBySymbolsSinceLimit(this.positions,t,e,i,!0)}handlePositions(t,e){const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"instId"),r=this.safeMarket(s,void 0,"-").symbol,n=this.safeString(i,"channel",""),o=this.safeValue(e,"data",[]);void 0===this.positions&&(this.positions=new a.Hk);const d=this.positions,c=[];for(let t=0;t<o.length;t++){const e=o[t],i=this.parsePosition(e);if(0===i.contracts){i.side="long";const t=this.clone(i);t.side="short",d.append(t),c.push(t)}c.push(i),d.append(i)}let h=n;void 0!==r&&(h=n+"::"+r),t.resolve(c,h)}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){let r;[r,s]=this.handleOptionAndParams(s,"watchOrders","type","ANY");const a=this.safeValue2(s,"stop","trigger",!1);let n;s=this.omit(s,["stop","trigger"]),await this.loadMarkets(),await this.authenticate({access:a?"business":"private"}),void 0!==t&&(n=this.market(t),t=n.symbol,r=n.type),"future"===r&&(r="futures");let o,d=r.toUpperCase();[o,s]=this.handleMarginModeAndParams("watchOrders",s),"SPOT"===d&&void 0!==o&&(d="MARGIN");const c={instType:d},h=a?"orders-algo":"orders",l=await this.subscribe("private",h,h,t,this.extend(c,s));return this.newUpdates&&(i=l.getLimit(t,i)),this.filterBySymbolSinceLimit(l,t,e,i,!0)}handleOrders(t,e,i=void 0){this.handleMyTrades(t,e);const s=this.safeValue(e,"arg",{}),r=this.safeString(s,"channel"),n=this.safeValue(e,"data",[]);if(n.length>0){const e=this.safeInteger(this.options,"ordersLimit",1e3);void 0===this.orders&&(this.orders=new a.Pt(e),this.triggerOrders=new a.Pt(e));const i="orders-algo"===r?this.triggerOrders:this.orders,s=[],o=this.parseOrders(n);for(let t=0;t<o.length;t++){const e=o[t];i.append(e);const r=e.symbol,a=this.market(r);s.push(a.id)}t.resolve(i,r);for(let e=0;e<s.length;e++){const a=r+":"+s[e];t.resolve(i,a)}}}handleMyTrades(t,e){const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"channel"),r=this.safeValue(e,"data",[]),n=[];for(let t=0;t<r.length;t++){const e=r[t];if(this.safeString(e,"tradeId","").length>0){const t=this.parseOrder(e);n.push(t)}}if(0===n.length)return;if(void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new a.Pt(t)}const o=this.myTrades,d={};for(let t=0;t<n.length;t++){const e=n[t],i=this.orderToTrade(e);o.append(i);d[i.symbol]=!0}const c=s+"::myTrades";t.resolve(this.myTrades,c);const h=Object.keys(d);for(let e=0;e<h.length;e++){const i=c+"::"+h[e];t.resolve(this.myTrades,i)}}requestId(){return this.milliseconds().toString()+this.randNumber(4).toString()}async createOrderWs(t,e,i,s,a=void 0,n={}){await this.loadMarkets(),await this.authenticate();const o=this.getUrl("private","private"),d=this.requestId();let c;[c,n]=this.handleOptionAndParams(n,"createOrderWs","op","batch-orders");const h=this.createOrderRequest(t,e,i,s,a,n),l=this.safeString(h,"ordType");if("trigger"===l||"conditional"===l||"oco"===e||"move_order_stop"===e||"iceberg"===e||"twap"===e)throw new r.BadRequest(this.id+' createOrderWs() does not support algo trading. this.options["createOrderWs"]["op"] must be either order or batch-order');if("order"!==c&&"batch-orders"!==c)throw new r.BadRequest(this.id+' createOrderWs() does not support algo trading. this.options["createOrderWs"]["op"] must be either order or privatePostTradeOrder or privatePostTradeOrderAlgo');const u={id:d,op:c,args:[h]};return await this.watch(o,d,u,d)}handlePlaceOrders(t,e){const i=this.safeString(e,"id");let s=this.safeValue(e,"data",[]);if(s=this.filterBy(s,"sCode","0"),this.isEmpty(s)){const i=this.safeString(e,"op"),s=this.json(e);this.handleErrors(1,"",t.url,i,{},s,e,{},{})}const r=this.parseOrders(s,void 0,void 0,void 0),a=this.safeDict(r,0,{});t.resolve(a,i)}async editOrderWs(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets(),await this.authenticate();const o=this.getUrl("private","private"),d=this.requestId();let c;[c,n]=this.handleOptionAndParams(n,"editOrderWs","op","amend-order");const h={id:d,op:c,args:[this.editOrderRequest(t,e,i,s,r,a,n)]};return await this.watch(o,d,this.extend(h,n),d)}async cancelOrderWs(t,e=void 0,i={}){if(void 0===e)throw new r.BadRequest(this.id+" cancelOrderWs() requires a symbol argument");await this.loadMarkets(),await this.authenticate();const s=this.getUrl("private","private"),a=this.requestId(),n=this.safeString2(i,"clOrdId","clientOrderId");i=this.omit(i,["clientOrderId","clOrdId"]);const o={instId:this.marketId(e)};void 0!==n?o.clOrdId=n:o.ordId=t;const d={id:a,op:"cancel-order",args:[this.extend(o,i)]};return await this.watch(s,a,d,a)}async cancelOrdersWs(t,e=void 0,i={}){const s=t.length;if(s>20)throw new r.BadRequest(this.id+" cancelOrdersWs() accepts up to 20 ids at a time");if(void 0===e)throw new r.BadRequest(this.id+" cancelOrdersWs() requires a symbol argument");await this.loadMarkets(),await this.authenticate();const a=this.getUrl("private","private"),n=this.requestId(),o=[];for(let i=0;i<s;i++){const s={instId:this.marketId(e),ordId:t[i]};o.push(s)}const d={id:n,op:"batch-cancel-orders",args:o};return await this.watch(a,n,this.deepExtend(d,i),n)}async cancelAllOrdersWs(t=void 0,e={}){if(void 0===t)throw new r.BadRequest(this.id+" cancelAllOrdersWs() requires a symbol argument");await this.loadMarkets(),await this.authenticate();const i=this.market(t);if("option"!==i.type)throw new r.BadRequest(this.id+" cancelAllOrdersWs is only applicable to Option in Portfolio Margin mode, and MMP privilege is required.");const s=this.getUrl("private","private"),a=this.requestId(),n={id:a,op:"mass-cancel",args:[this.extend({instType:"OPTION",instFamily:i.id},e)]};return await this.watch(s,a,n,a)}handleCancelAllOrders(t,e){const i=this.safeString(e,"id"),s=this.safeValue(e,"data",[]);t.resolve(s,i)}handleSubscriptionStatus(t,e){return e}handleAuthenticate(t,e){this.safeValue(t.futures,"authenticated").resolve(!0)}ping(t){return"ping"}handlePong(t,e){return t.lastPong=this.milliseconds(),e}handleErrorMessage(t,e){let i=this.safeString(e,"code");try{if(i&&"0"!==i){const t=this.id+" "+this.json(e);"1"!==i&&this.throwExactlyMatchedException(this.exceptions.exact,i,t);let s=this.safeValue(e,"msg");if(void 0!==s)this.throwBroadlyMatchedException(this.exceptions.broad,s,t);else{const r=this.safeList(e,"data",[]);for(let a=0;a<r.length;a++){const n=r[a];i=this.safeString(n,"sCode"),void 0!==i&&this.throwExactlyMatchedException(this.exceptions.exact,i,t),s=this.safeValue(e,"sMsg"),void 0!==s&&this.throwBroadlyMatchedException(this.exceptions.broad,s,t)}}throw new r.ExchangeError(t)}}catch(i){let s=this.safeString(e,"id");if(void 0===s){const t=this.safeString(e,"msg");if(void 0!==t&&t.startsWith("Illegal request: {")){const e=t.replace("Illegal request: ",""),i=this.parseJson(e);s=this.safeString(i,"id")}}return void 0!==s?(t.reject(i,s),!1):(t.reject(i),!1)}return!0}handleMessage(t,e){if(!this.handleErrorMessage(t,e))return;if("pong"===e)return void this.handlePong(t,e);const i=this.safeString2(e,"event","op");if(void 0!==i){const s={login:this.handleAuthenticate,subscribe:this.handleSubscriptionStatus,unsubscribe:this.handleUnsubscription,order:this.handlePlaceOrders,"batch-orders":this.handlePlaceOrders,"amend-order":this.handlePlaceOrders,"batch-amend-orders":this.handlePlaceOrders,"cancel-order":this.handlePlaceOrders,"mass-cancel":this.handleCancelAllOrders},r=this.safeValue(s,i);void 0!==r&&r.call(this,t,e)}else{const i=this.safeValue(e,"arg",{}),s=this.safeString(i,"channel"),r={"bbo-tbt":this.handleOrderBook,books:this.handleOrderBook,books5:this.handleOrderBook,"books50-l2-tbt":this.handleOrderBook,"books-l2-tbt":this.handleOrderBook,tickers:this.handleTicker,"mark-price":this.handleTicker,positions:this.handlePositions,"index-tickers":this.handleTicker,"sprd-tickers":this.handleTicker,"block-tickers":this.handleTicker,trades:this.handleTrades,"trades-all":this.handleTrades,account:this.handleBalance,"funding-rate":this.handleFundingRate,orders:this.handleOrders,"orders-algo":this.handleOrders,"liquidation-orders":this.handleLiquidation,balance_and_position:this.handleBalanceAndPosition},a=this.safeValue(r,s);void 0===a?0===s.indexOf("candle")&&this.handleOHLCV(t,e):a.call(this,t,e)}}handleUnSubscriptionTrades(t,e,i){const s=i+":"+e,r="unsubscribe:"+s;this.cleanUnsubscription(t,s,r),e in this.trades&&delete this.trades[e]}handleUnsubscriptionOrderBook(t,e,i){const s=i+":"+e,r="unsubscribe:orderbook:"+e;this.cleanUnsubscription(t,s,r),e in this.orderbooks&&delete this.orderbooks[e]}handleUnsubscriptionOHLCV(t,e,i){const s=i.replace("candle",""),r=this.findTimeframe(s),a="multi:"+i+":"+e,n="unsubscribe:"+a;this.cleanUnsubscription(t,a,n),r in this.ohlcvs[e]&&delete this.ohlcvs[e][r]}handleUnsubscriptionTicker(t,e,i){const s=i+"::"+e,r="unsubscribe:ticker:"+e;this.cleanUnsubscription(t,s,r),e in this.tickers&&delete this.tickers[e]}handleUnsubscription(t,e){const i=this.safeDict(e,"arg",{}),s=this.safeString(i,"channel",""),r=this.safeString(i,"instId"),a=this.safeSymbol(r);"trades"===s||"trades-all"===s?this.handleUnSubscriptionTrades(t,a,s):s.startsWith("bbo")||s.startsWith("book")?this.handleUnsubscriptionOrderBook(t,a,s):s.indexOf("tickers")>-1?this.handleUnsubscriptionTicker(t,a,s):s.startsWith("candle")&&this.handleUnsubscriptionOHLCV(t,a,s)}}},8595(t,e,i){"use strict";i.d(e,{y:()=>O});var s,r,a=i(1420),n=i(4176),o=i(6768),d=i(9489),c=i(3168),h=i(3287),l=i(300),u=i(9671),p=i(1475),f=i(4599),m=i(9426),g=i(9428),y=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};const v=new Map;v.set(0,"GENERIC_PANIC"),v.set(1,"ASSERT_FALSE"),v.set(17,"OVERFLOW"),v.set(18,"DIVIDE_BY_ZERO"),v.set(33,"ENUM_RANGE_ERROR"),v.set(34,"BAD_STORAGE_DATA"),v.set(49,"STACK_UNDERFLOW"),v.set(50,"ARRAY_RANGE_ERROR"),v.set(65,"OUT_OF_MEMORY"),v.set(81,"UNINITIALIZED_FUNCTION_CALL");const b=new RegExp(/^bytes([0-9]*)$/),w=new RegExp(/^(u?int)([0-9]*)$/);let S=null,k=1024;class O{constructor(){s.add(this)}getDefaultValue(t){const e=t.map(t=>y(this,s,"m",r).call(this,g.aX.from(t)));return new m.y(e,"_").defaultValue()}encode(t,e){(0,a.dd)(e.length,t.length,"types/values length mismatch");const i=t.map(t=>y(this,s,"m",r).call(this,g.aX.from(t))),o=new m.y(i,"_"),d=new n.AU;return o.encode(d,e),d.data}decode(t,e,i){const a=t.map(t=>y(this,s,"m",r).call(this,g.aX.from(t)));return new m.y(a,"_").decode(new n.mP(e,i,k))}static _setDefaultMaxInflation(t){(0,a.MR)("number"==typeof t&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),k=t}static defaultAbiCoder(){return null==S&&(S=new O),S}}s=new WeakSet,r=function t(e){if(e.isArray())return new d.fA(y(this,s,"m",t).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new m.y(e.components.map(e=>y(this,s,"m",t).call(this,e)),e.name);switch(e.baseType){case"address":return new o.S(e.name);case"bool":return new c.k(e.name);case"string":return new f.v(e.name);case"bytes":return new h.z(e.name);case"":return new u.h(e.name)}let i=e.type.match(w);if(i){let t=parseInt(i[2]||"256");return(0,a.MR)(0!==t&&t<=256&&t%8==0,"invalid "+i[1]+" bit length","param",e),new p.p(t/8,"int"===i[1],e.name)}if(i=e.type.match(b),i){let t=parseInt(i[1]);return(0,a.MR)(0!==t&&t<=32,"invalid bytes length","param",e),new l.J(t,e.name)}(0,a.MR)(!1,"invalid type","type",e.type)}},8617(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},8846(t,e,i){"use strict";i.d(e,{f:()=>s}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const s={encode(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create()){for(const i of t.maxShortTermOrdersPerNBlocks)r.encode(i,e.uint32(10).fork()).ldelim();for(const i of t.maxStatefulOrdersPerNBlocks)r.encode(i,e.uint32(18).fork()).ldelim();for(const i of t.maxShortTermOrderCancellationsPerNBlocks)r.encode(i,e.uint32(26).fork()).ldelim();for(const i of t.maxShortTermOrdersAndCancelsPerNBlocks)r.encode(i,e.uint32(34).fork()).ldelim();return e},decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const a={maxShortTermOrdersPerNBlocks:[],maxStatefulOrdersPerNBlocks:[],maxShortTermOrderCancellationsPerNBlocks:[],maxShortTermOrdersAndCancelsPerNBlocks:[]};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:a.maxShortTermOrdersPerNBlocks.push(r.decode(i,i.uint32()));break;case 2:a.maxStatefulOrdersPerNBlocks.push(r.decode(i,i.uint32()));break;case 3:a.maxShortTermOrderCancellationsPerNBlocks.push(r.decode(i,i.uint32()));break;case 4:a.maxShortTermOrdersAndCancelsPerNBlocks.push(r.decode(i,i.uint32()));break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={maxShortTermOrdersPerNBlocks:[],maxStatefulOrdersPerNBlocks:[],maxShortTermOrderCancellationsPerNBlocks:[],maxShortTermOrdersAndCancelsPerNBlocks:[]};return e.maxShortTermOrdersPerNBlocks=t.maxShortTermOrdersPerNBlocks?.map(t=>r.fromPartial(t))||[],e.maxStatefulOrdersPerNBlocks=t.maxStatefulOrdersPerNBlocks?.map(t=>r.fromPartial(t))||[],e.maxShortTermOrderCancellationsPerNBlocks=t.maxShortTermOrderCancellationsPerNBlocks?.map(t=>r.fromPartial(t))||[],e.maxShortTermOrdersAndCancelsPerNBlocks=t.maxShortTermOrdersAndCancelsPerNBlocks?.map(t=>r.fromPartial(t))||[],e}};const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.numBlocks&&e.uint32(8).uint32(t.numBlocks),0!==t.limit&&e.uint32(16).uint32(t.limit),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={numBlocks:0,limit:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.numBlocks=i.uint32();break;case 2:r.limit=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={numBlocks:0,limit:0};return e.numBlocks=t.numBlocks??0,e.limit=t.limit??0,e}}},8854(t,e,i){"use strict";function s(){return{key:new Uint8Array}}i.d(e,{r:()=>r}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.key.length&&e.uint32(10).bytes(t.key),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=s();for(;i.pos<r;){const t=i.uint32();if(t>>>3==1)a.key=i.bytes();else i.skipType(7&t)}return a},fromPartial(t){const e=s();return e.key=t.key??new Uint8Array,e}}},8995(t,e,i){"use strict";i.d(e,{O:()=>n});var s=i(4710),r=i(3466),a=i(8283);function n(t){const e=t=>parseInt(t,16);t=t.replace(" ","");const i=Math.round((new Date).getTime()/1e3),n=((t,e)=>(e+t).slice(-e.length))(((o=Math.floor(i/30))<15.5?"0":"")+Math.round(o).toString(16),"0000000000000000");var o;const d=(0,a.w8)(s.xn.decode(n),s.RG.decode(t),r.e,"hex"),c=e(d.substring(d.length-1));let h=(e(d.substr(2*c,8))&e("7fffffff"))+"";return h.substring(h.length-6,h.length)}},9024(t,e,i){"use strict";function s(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}i.d(e,{Ay:()=>n});const a={number:s,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:r,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");s(t.outputLen),s(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){r(t);const i=e.outputLen;if(t.length<i)throw new Error(`digestInto() expects output buffer of length at least ${i}`)}},n=a},9073(t,e,i){"use strict";i.d(e,{V:()=>l});var s,r=i(9654),a=function(t,e,i,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(t,i):r?r.value=i:e.set(t,i),i},n=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};const o={};function d(t,e){let i=!1;return e<0&&(i=!0,e*=-1),new l(o,`${i?"":"u"}int${e}`,t,{signed:i,width:e})}function c(t,e){return new l(o,`bytes${e||""}`,t,{size:e})}const h=Symbol.for("_ethers_typed");class l{constructor(t,e,i,n){s.set(this,void 0),null==n&&(n=null),(0,r.n)(this,{_typedSymbol:h,type:e,value:i}),a(this,s,n,"f"),this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map(t=>t.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return n(this,s,"f")}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===n(this,s,"f")?-1:!1===n(this,s,"f")?this.value.length:null}static from(t,e){return new l(o,t,e)}static uint8(t){return d(t,8)}static uint16(t){return d(t,16)}static uint24(t){return d(t,24)}static uint32(t){return d(t,32)}static uint40(t){return d(t,40)}static uint48(t){return d(t,48)}static uint56(t){return d(t,56)}static uint64(t){return d(t,64)}static uint72(t){return d(t,72)}static uint80(t){return d(t,80)}static uint88(t){return d(t,88)}static uint96(t){return d(t,96)}static uint104(t){return d(t,104)}static uint112(t){return d(t,112)}static uint120(t){return d(t,120)}static uint128(t){return d(t,128)}static uint136(t){return d(t,136)}static uint144(t){return d(t,144)}static uint152(t){return d(t,152)}static uint160(t){return d(t,160)}static uint168(t){return d(t,168)}static uint176(t){return d(t,176)}static uint184(t){return d(t,184)}static uint192(t){return d(t,192)}static uint200(t){return d(t,200)}static uint208(t){return d(t,208)}static uint216(t){return d(t,216)}static uint224(t){return d(t,224)}static uint232(t){return d(t,232)}static uint240(t){return d(t,240)}static uint248(t){return d(t,248)}static uint256(t){return d(t,256)}static uint(t){return d(t,256)}static int8(t){return d(t,-8)}static int16(t){return d(t,-16)}static int24(t){return d(t,-24)}static int32(t){return d(t,-32)}static int40(t){return d(t,-40)}static int48(t){return d(t,-48)}static int56(t){return d(t,-56)}static int64(t){return d(t,-64)}static int72(t){return d(t,-72)}static int80(t){return d(t,-80)}static int88(t){return d(t,-88)}static int96(t){return d(t,-96)}static int104(t){return d(t,-104)}static int112(t){return d(t,-112)}static int120(t){return d(t,-120)}static int128(t){return d(t,-128)}static int136(t){return d(t,-136)}static int144(t){return d(t,-144)}static int152(t){return d(t,-152)}static int160(t){return d(t,-160)}static int168(t){return d(t,-168)}static int176(t){return d(t,-176)}static int184(t){return d(t,-184)}static int192(t){return d(t,-192)}static int200(t){return d(t,-200)}static int208(t){return d(t,-208)}static int216(t){return d(t,-216)}static int224(t){return d(t,-224)}static int232(t){return d(t,-232)}static int240(t){return d(t,-240)}static int248(t){return d(t,-248)}static int256(t){return d(t,-256)}static int(t){return d(t,-256)}static bytes1(t){return c(t,1)}static bytes2(t){return c(t,2)}static bytes3(t){return c(t,3)}static bytes4(t){return c(t,4)}static bytes5(t){return c(t,5)}static bytes6(t){return c(t,6)}static bytes7(t){return c(t,7)}static bytes8(t){return c(t,8)}static bytes9(t){return c(t,9)}static bytes10(t){return c(t,10)}static bytes11(t){return c(t,11)}static bytes12(t){return c(t,12)}static bytes13(t){return c(t,13)}static bytes14(t){return c(t,14)}static bytes15(t){return c(t,15)}static bytes16(t){return c(t,16)}static bytes17(t){return c(t,17)}static bytes18(t){return c(t,18)}static bytes19(t){return c(t,19)}static bytes20(t){return c(t,20)}static bytes21(t){return c(t,21)}static bytes22(t){return c(t,22)}static bytes23(t){return c(t,23)}static bytes24(t){return c(t,24)}static bytes25(t){return c(t,25)}static bytes26(t){return c(t,26)}static bytes27(t){return c(t,27)}static bytes28(t){return c(t,28)}static bytes29(t){return c(t,29)}static bytes30(t){return c(t,30)}static bytes31(t){return c(t,31)}static bytes32(t){return c(t,32)}static address(t){return new l(o,"address",t)}static bool(t){return new l(o,"bool",!!t)}static bytes(t){return new l(o,"bytes",t)}static string(t){return new l(o,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new l(o,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===h}static dereference(t,e){if(l.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}s=new WeakMap},9088(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(9344),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,watchBalance:!0,watchBidsAsks:!0,watchTicker:!0,watchTickers:!0,watchTrades:!0,watchTradesForSymbols:!0,watchMyTrades:!0,watchOrders:!0,watchOrderBook:!0,watchOrderBookForSymbols:!0,watchOHLCV:!1,fetchOHLCVWs:!1},urls:{api:{ws:{spot:"wss://socket.coinex.com/v2/spot/",swap:"wss://socket.coinex.com/v2/futures/"}}},options:{ws:{gunzip:!0},timeframes:{"1m":60,"3m":180,"5m":300,"15m":900,"30m":1800,"1h":3600,"2h":7200,"4h":14400,"6h":21600,"12h":43200,"1d":86400,"3d":259200,"1w":604800},account:"spot",watchOrderBook:{limits:[5,10,20,50],defaultLimit:50,aggregations:["1000","100","10","1","0","0.1","0.01","0.001","0.0001","0.00001","0.000001","0.0000001","0.00000001","0.000000001","0.0000000001","0.00000000001"],defaultAggregation:"0"}},streaming:{},exceptions:{exact:{20001:r.BadRequest,20002:r.NotSupported,21001:r.AuthenticationError,21002:r.AuthenticationError,23001:r.RequestTimeout,23002:r.RateLimitExceeded,24001:r.ExchangeError,24002:r.ExchangeNotAvailable,30001:r.BadRequest,30002:r.NotSupported,31001:r.AuthenticationError,31002:r.AuthenticationError,33001:r.RequestTimeout,33002:r.RateLimitExceeded,34001:r.ExchangeError,34002:r.ExchangeNotAvailable},broad:{}}})}requestId(){this.lockId();const t=this.sum(this.safeInteger(this.options,"requestId",0),1);return this.options.requestId=t,this.unlockId(),t}handleTicker(t,e){const i=this.safeString(this.options,"defaultType"),s=this.safeDict(e,"data",{}),r=this.safeList(s,"state_list",[]),a={};for(let t=0;t<r.length;t++){const e=r[t],s=this.safeString(e,"market"),n=this.safeSymbol(s,void 0,void 0,i),o=this.safeMarket(s,void 0,void 0,i),d=this.parseWSTicker(e,o);this.tickers[n]=d,a[n]=d}const n=this.findMessageHashes(t,"tickers::");for(let e=0;e<n.length;e++){const i=n[e],s=i.split("::")[1].split(","),r=this.filterByArray(a,"symbol",s);Object.keys(r).length>0&&t.resolve(r,i)}t.resolve(a,"tickers")}parseWSTicker(t,e=void 0){const i=this.safeString(this.options,"defaultType"),s=this.safeString(t,"market");return this.safeTicker({symbol:this.safeSymbol(s,e,void 0,i),timestamp:void 0,datetime:void 0,high:this.safeString(t,"high"),low:this.safeString(t,"low"),bid:void 0,bidVolume:this.safeString(t,"volume_buy"),ask:void 0,askVolume:this.safeString(t,"volume_sell"),vwap:void 0,open:this.safeString(t,"open"),close:this.safeString(t,"close"),last:this.safeString(t,"last"),previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeString(t,"volume"),quoteVolume:this.safeString(t,"value"),info:t},e)}async watchBalance(t={}){let e;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t,"spot"),await this.authenticate(e);const i=this.urls.api.ws[e],s=this.filterBy(this.currencies_by_id,"active",!0),r=this.indexBy(s,"id");let a=Object.keys(r);void 0===a&&(a=[]);let n="balances";n+="spot"===e?":spot":":swap";const o={method:"balance.subscribe",params:{ccy_list:a},id:this.requestId()},d=this.deepExtend(o,t);return await this.watch(i,n,d,n)}handleBalance(t,e){void 0===this.balance&&(this.balance={});const i=this.safeDict(e,"data",{}),s=this.safeList(i,"balance_list",[]),r=s[0],a=this.safeInteger(r,"updated_at"),n=void 0!==this.safeString(r,"unrealized_pnl");let o,d,c,h=[];if(void 0!==a){d="spot";for(let t=0;t<s.length;t++)h=this.arrayConcat(h,s);o=h}if(n){d="swap";for(let t=0;t<s.length;t++)h=this.arrayConcat(h,s);o=h}for(let t=0;t<h.length;t++){const e=h[t];this.parseWsBalance(e,d)}void 0!==d&&(void 0===this.safeValue(this.balance,d)&&(this.balance[d]={}),this.balance[d].info=o,this.balance[d]=this.safeBalance(this.balance[d]),c="balances:"+d,t.resolve(this.balance[d],c))}parseWsBalance(t,e=void 0){const i=this.account(),s=this.safeString(t,"ccy"),r=this.safeCurrencyCode(s);i.free=this.safeString(t,"available"),i.used=this.safeString(t,"frozen"),void 0!==e?(void 0===this.safeValue(this.balance,e)&&(this.balance[e]={}),this.balance[e][r]=i):this.balance[r]=i}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r,a;await this.loadMarkets(),void 0!==t&&(r=this.market(t),t=r.symbol),[a,s]=this.handleMarketTypeAndParams("watchMyTrades",r,s,"spot"),await this.authenticate(a);const n=this.urls.api.ws[a],o=[];let d="myTrades";void 0!==r?(d+=":"+t,o.push(r.id)):d+="spot"===a?":spot":":swap";const c={method:"user_deals.subscribe",params:{market_list:o},id:this.requestId()},h=this.deepExtend(c,s),l=await this.watch(n,d,h,d);return this.newUpdates&&(i=l.getLimit(t,i)),this.filterBySymbolSinceLimit(l,t,e,i,!0)}handleMyTrades(t,e){const i=this.safeDict(e,"data",{}),s=this.safeString(i,"market"),r=t.url.indexOf("spot")>-1?"spot":"swap",n=this.safeMarket(s,void 0,void 0,r),o=n.symbol,d="myTrades:"+o,c="myTrades:"+n.type;let h=this.safeValue(this.trades,o);if(void 0===h){const t=this.safeInteger(this.options,"tradesLimit",1e3);h=new a.I3(t),this.trades[o]=h}const l=this.parseWsTrade(i,n);h.append(l),this.trades[o]=h,t.resolve(this.trades[o],c),t.resolve(this.trades[o],d)}handleTrades(t,e){const i=this.safeDict(e,"data",{}),s=this.safeList(i,"deal_list",[]),r=this.safeString(i,"market"),n=t.url.indexOf("spot")>-1?"spot":"swap",o=this.safeMarket(r,void 0,void 0,n),d=o.symbol,c="trades:"+d;let h=this.safeValue(this.trades,d);if(void 0===h){const t=this.safeInteger(this.options,"tradesLimit",1e3);h=new a.I3(t),this.trades[d]=h}for(let t=0;t<s.length;t++){const e=s[t],i=this.parseWsTrade(e,o);h.append(i)}this.trades[d]=h,t.resolve(this.trades[d],c)}parseWsTrade(t,e=void 0){const i=this.safeInteger(t,"created_at"),s="margin_market"in t?"spot":"swap",r=this.safeString(t,"market");e=this.safeMarket(r,e,void 0,s);let a={};const n=this.omitZero(this.safeString(t,"fee"));if(void 0!==n){const i=this.safeString(t,"fee_ccy",e.quote);a={currency:this.safeCurrencyCode(i),cost:n}}return this.safeTrade({id:this.safeString(t,"deal_id"),info:t,timestamp:i,datetime:this.iso8601(i),symbol:this.safeSymbol(r,e,void 0,s),order:this.safeString(t,"order_id"),type:void 0,side:this.safeString(t,"side"),takerOrMaker:this.safeString(t,"role"),price:this.safeString(t,"price"),amount:this.safeString(t,"amount"),cost:void 0,fee:a},e)}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t);return(await this.watchTickers([t],e))[i.symbol]}async watchTickers(t=void 0,e={}){await this.loadMarkets();let i,s=this.marketIds(t);const r=[];if(void 0!==t)for(let e=0;e<t.length;e++){const s=t[e];i=this.market(s),r.push("tickers::"+i.symbol)}else s=[],r.push("tickers");let a;[a,e]=this.handleMarketTypeAndParams("watchTickers",i,e);const n=this.urls.api.ws[a],o={method:"state.subscribe",params:{market_list:s},id:this.requestId()},d=await this.watchMultiple(n,r,this.deepExtend(o,e),["all@ticker"]);return this.newUpdates?d:this.filterByArray(this.tickers,"symbol",t)}async watchTrades(t,e=void 0,i=void 0,s={}){return s.callerMethodName="watchTrades",await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=[],a=[];let n,o;[o,s]=this.handleParamString(s,"callerMethodName","watchTradesForSymbols");if(void 0!==t)for(let e=0;e<t.length;e++){const i=t[e];n=this.market(i),r.push(n.id),a.push("trades:"+n.symbol)}else a.push("trades");let d;[d,s]=this.handleMarketTypeAndParams(o,n,s);const c=this.urls.api.ws[d],h={method:"deals.subscribe",params:{market_list:r},id:this.requestId()},l=await this.watchMultiple(c,a,this.deepExtend(h,s),a);return this.newUpdates?l:this.filterBySinceLimit(l,e,i,"timestamp",!0)}async watchOrderBookForSymbols(t,e=void 0,i={}){await this.loadMarkets();const s={},a=[];let n,o,d;[d,i]=this.handleParamString(i,"callerMethodName","watchOrderBookForSymbols");const c=this.safeDict(this.options,"watchOrderBook",{}),h=this.safeList(c,"limits",[]);if(void 0===e&&(e=this.safeInteger(c,"defaultLimit",50)),!this.inArray(e,h))throw new r.NotSupported(this.id+" watchOrderBookForSymbols() limit must be one of "+h.join(", "));const l=this.safeString(c,"defaultAggregation","0"),u=this.safeList(c,"aggregations",[]),p=this.safeString(i,"aggregation",l);if(!this.inArray(p,u))throw new r.NotSupported(this.id+" watchOrderBookForSymbols() aggregation must be one of "+u.join(", "));i=this.omit(i,"aggregation");if(!(void 0!==t))throw new r.ArgumentsRequired(this.id+" watchOrderBookForSymbols() requires a symbol argument");for(let i=0;i<t.length;i++){const r=t[i];n=this.market(r),a.push("orderbook:"+n.symbol),s[r]=[n.id,e,p,!0]}[o,i]=this.handleMarketTypeAndParams(d,n,i);const f={method:"depth.subscribe",params:{market_list:Object.values(s)},id:this.requestId()},m=this.urls.api.ws[o],g=await this.watchMultiple(m,a,this.deepExtend(f,i),a);return this.newUpdates?g:g.limit()}async watchOrderBook(t,e=void 0,i={}){return i.callerMethodName="watchOrderBook",await this.watchOrderBookForSymbols([t],e,i)}handleDelta(t,e){const i=this.parseBidAsk(e,0,1);t.storeArray(i)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}handleOrderBook(t,e){const i=t.url.indexOf("spot")>-1?"spot":"swap",s=this.safeDict(e,"data",{}),r=this.safeDict(s,"depth",{}),a=this.safeString(s,"market"),n=this.safeMarket(a,void 0,void 0,i).symbol,o="orderbook:"+n,d=this.safeInteger(r,"updated_at"),c=this.safeValue(this.orderbooks,n);if(this.safeBool(s,"is_full",!1)){const t=this.parseOrderBook(r,n,d);if(void 0===c)this.orderbooks[n]=this.orderBook(t);else{this.orderbooks[n].reset(t)}}else{const t=this.safeList(r,"asks",[]),e=this.safeList(r,"bids",[]);this.handleDeltas(c.asks,t),this.handleDeltas(c.bids,e),c.nonce=d,c.timestamp=d,c.datetime=this.iso8601(d),this.orderbooks[n]=c}t.resolve(this.orderbooks[n],o)}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.safeBool2(s,"trigger","stop");s=this.omit(s,["trigger","stop"]);let a,n,o,d,c="orders";void 0!==t&&(a=this.market(t),t=a.symbol),[o,s]=this.handleMarketTypeAndParams("watchOrders",a,s,"spot"),await this.authenticate(o),void 0!==t?(n=[a.id],c+=":"+t):(n=[],c+="spot"===o?":spot":":swap"),d=r?"stop.subscribe":"order.subscribe";const h={method:d,params:{market_list:n},id:this.requestId()},l=this.urls.api.ws[o],u=this.deepExtend(h,s),p=await this.watch(l,c,u,c,u);return this.newUpdates&&(i=p.getLimit(t,i)),this.filterBySymbolSinceLimit(p,t,e,i,!0)}handleOrders(t,e){const i=this.safeDict(e,"data",{}),s=this.safeDict2(i,"order","stop",{}),r=this.parseWsOrder(s),n=r.symbol,o=this.market(n);if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new a.Pt(t)}this.orders.append(r);let d="orders";const c=d+":"+o.type;t.resolve(this.orders,c),d+=":"+n,t.resolve(this.orders,d)}parseWsOrder(t,e=void 0){const i=this.safeInteger(t,"created_at"),s=this.safeString(t,"market"),r=this.safeString(t,"status"),a="margin_market"in t?"spot":"swap";let n;e=this.safeMarket(s,e,void 0,a);const o=this.omitZero(this.safeString2(t,"fee","quote_ccy_fee"));if(void 0!==o){const i=this.safeString(t,"fee_ccy",e.quote);n={currency:this.safeCurrencyCode(i),cost:o}}return this.safeOrder({info:t,id:this.safeString2(t,"order_id","stop_id"),clientOrderId:this.safeString(t,"client_id"),datetime:this.iso8601(i),timestamp:i,lastTradeTimestamp:this.safeInteger(t,"updated_at"),symbol:e.symbol,type:this.safeString(t,"type"),timeInForce:void 0,postOnly:void 0,side:this.safeString(t,"side"),price:this.safeString(t,"price"),stopPrice:this.safeString(t,"trigger_price"),triggerPrice:this.safeString(t,"trigger_price"),amount:this.safeString(t,"amount"),filled:this.safeString2(t,"filled_amount","fill_value"),remaining:this.safeString2(t,"unfilled_amount","unfill_amount"),cost:void 0,average:void 0,status:this.parseWsOrderStatus(r),fee:n,trades:void 0},e)}parseWsOrderStatus(t){return this.safeString({active_success:"open",active_fail:"canceled",cancel:"canceled"},t,t)}async watchBidsAsks(t=void 0,e={}){await this.loadMarkets();const i=this.marketIds(t),s=[];let r;if(void 0!==t)for(let e=0;e<t.length;e++){const i=t[e];r=this.market(i),s.push("bidsasks:"+r.symbol)}else s.push("bidsasks");let a;[a,e]=this.handleMarketTypeAndParams("watchBidsAsks",r,e);const n=this.urls.api.ws[a],o={method:"bbo.subscribe",params:{market_list:i},id:this.requestId()},d=await this.watchMultiple(n,s,this.deepExtend(o,e),["all@bidsasks"]);return this.newUpdates?d:this.filterByArray(this.bidsasks,"symbol",t)}handleBidAsk(t,e){const i=this.safeDict(e,"data",{}),s=this.parseWsBidAsk(i),r=s.symbol;this.bidsasks[r]=s;const a="bidsasks:"+r;t.resolve(s,a)}parseWsBidAsk(t,e=void 0){const i=this.safeString(this.options,"defaultType"),s=this.safeString(t,"market");e=this.safeMarket(s,e,void 0,i);const r=this.safeInteger(t,"updated_at");return this.safeTicker({symbol:this.safeSymbol(s,e,void 0,i),timestamp:r,datetime:this.iso8601(r),ask:this.safeNumber(t,"best_ask_price"),askVolume:this.safeNumber(t,"best_ask_size"),bid:this.safeNumber(t,"best_bid_price"),bidVolume:this.safeNumber(t,"best_bid_size"),info:t},e)}handleMessage(t,e){const i=this.safeString(e,"method"),s=this.safeString(e,"message");void 0!==s&&this.handleErrors(1,"",t.url,i,{},this.json(s),e,{},{});const r={"state.update":this.handleTicker,"balance.update":this.handleBalance,"deals.update":this.handleTrades,"user_deals.update":this.handleMyTrades,"depth.update":this.handleOrderBook,"order.update":this.handleOrders,"stop.update":this.handleOrders,"bbo.update":this.handleBidAsk},a=this.safeValue(r,i);void 0===a?this.handleSubscriptionStatus(t,e):a.call(this,t,e)}handleErrors(t,e,i,s,a,n,o,d,c){if(void 0===o)return;const h=this.safeStringLower(o,"message"),l=void 0!==h&&"ok"!==h,u=this.safeString(o,"code");if(void 0!==u&&"0"!==u||l){const t=this.id+" "+n;throw this.throwExactlyMatchedException(this.exceptions.exact,u,t),this.throwBroadlyMatchedException(this.exceptions.broad,h,t),new r.ExchangeError(t)}}handleAuthenticationMessage(t,e){const i=this.safeStringLower(e,"message"),s=this.safeString(e,"code"),a="authenticated";if("ok"===i||"0"===s){this.safeValue(t.futures,a).resolve(!0)}else{const i=new r.AuthenticationError(this.json(e));t.reject(i,a),a in t.subscriptions&&delete t.subscriptions[a]}}handleSubscriptionStatus(t,e){const i=this.safeInteger(e,"id"),s=this.safeValue(t.subscriptions,i);if(void 0!==s){const e=this.safeString(s,"future"),r=this.safeValue(t.futures,e);void 0!==r&&r.resolve(!0),delete t.subscriptions[i]}}async authenticate(t){const e=this.urls.api.ws[t],i=this.client(e),s=this.milliseconds(),r=s.toString(),a="authenticated",o=i.reusableFuture(a);if(void 0!==this.safeValue(i.subscriptions,a))return await o;const d=this.requestId(),c={id:d,future:a},h=this.hmac(this.encode(r),this.encode(this.secret),n.s,"hex"),l={id:d,method:"server.sign",params:{access_id:this.apiKey,signed_str:h.toLowerCase(),timestamp:s}};return this.watch(e,a,l,d,c),i.subscriptions[a]=!0,await o}}},9152(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},9161(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(1686),r=i(7925);const a=(t,e,i)=>{if(!(0,s.sI)(t[i]))throw new Error(`Data and formatter mismatch on ${i}:${e[i]}, expected response data ${i}:${t[i]} to be BN instead it is ${typeof t[i]}`)},n=(t,e,i)=>{throw new Error(`Unhandled formatter type on ${i}:${e[i]} for data ${i}:${t[i]}`)};function o(t,e,i){return Object.entries(t).reduce((s,[d,c])=>{const h=i??e[d];if(!(d in e)&&!i)return s[d]=c,s;if("string"===h){if(Array.isArray(t[d])){const e=o(t[d],t[d].map(t=>h));return s[d]=Object.values(e).join(""),s}return a(t,e,d),s[d]=(0,r.Wb)(c),s}if("number"===h)return a(t,e,d),s[d]=Number(c),s;if("function"==typeof h)return s[d]=h(c),s;if(Array.isArray(h)){const e=o(t[d],h,h[0]);return s[d]=Object.values(e),s}return"object"==typeof h?(s[d]=o(t[d],h),s):(n(t,e,d),s)},{})}},9171(t,e,i){"use strict";function s(){return{perpetualId:0,quantums:new Uint8Array,fundingIndex:new Uint8Array,quoteBalance:new Uint8Array}}i.d(e,{c:()=>r}),Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(0!==t.perpetualId&&e.uint32(8).uint32(t.perpetualId),0!==t.quantums.length&&e.uint32(18).bytes(t.quantums),0!==t.fundingIndex.length&&e.uint32(26).bytes(t.fundingIndex),0!==t.quoteBalance.length&&e.uint32(34).bytes(t.quoteBalance),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=s();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.perpetualId=i.uint32();break;case 2:a.quantums=i.bytes();break;case 3:a.fundingIndex=i.bytes();break;case 4:a.quoteBalance=i.bytes();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=s();return e.perpetualId=t.perpetualId??0,e.quantums=t.quantums??new Uint8Array,e.fundingIndex=t.fundingIndex??new Uint8Array,e.quoteBalance=t.quoteBalance??new Uint8Array,e}}},9174(t,e,i){"use strict";i.d(e,{A:()=>a});var s=i(2961);class r extends s.k{}const a=r},9187(t,e,i){"use strict";i.d(e,{e:()=>n,t:()=>o});var s=i(39),r=i(9962),a=i(8464);const n=(t,e="m/44'/118'/0'/0/0")=>{const i=(0,r.VF)(t,a.p),{privateKey:s,publicKey:n}=o(i,e);return{mnemonic:i,privateKey:s,publicKey:n}},o=(t,e="m/44'/118'/0'/0/0")=>{const i=(0,r.kw)(t),a=s.c.fromMasterSeed(i),n=a.derive(e);if(!a.privateKey)throw new Error("null hd key");return{privateKey:n.privateKey,publicKey:n.publicKey}}},9195(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(9403),r=i(2079),a=i(2931),n=i(7481),o=i(5147);class d extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,cancelAllOrdersWs:!0,cancelOrderWs:!0,createMarketBuyOrderWithCostWs:!0,createMarketOrderWs:!0,createMarketOrderWithCostWs:!1,createMarketSellOrderWithCostWs:!1,createOrderWs:!0,createOrdersWs:!0,createPostOnlyOrderWs:!0,createReduceOnlyOrderWs:!0,createStopLimitOrderWs:!0,createStopLossOrderWs:!0,createStopMarketOrderWs:!1,createStopOrderWs:!0,createTakeProfitOrderWs:!0,createTriggerOrderWs:!0,editOrderWs:!0,fetchOrderWs:!0,fetchOrdersWs:!1,fetchOpenOrdersWs:!0,fetchClosedOrdersWs:!0,watchOrderBook:!0,watchBidsAsks:!0,watchTicker:!0,watchTickers:!0,watchTrades:!0,watchTradesForSymbols:!0,watchMyTrades:!0,watchOHLCV:!0,watchBalance:!0,watchOrders:!0,watchLiquidations:!1,watchLiquidationsForSymbols:!1,watchMyLiquidations:!0,watchMyLiquidationsForSymbols:!0,watchPositions:!0},urls:{api:{ws:"wss://ws.gate.io/v4",spot:"wss://api.gateio.ws/ws/v4/",swap:{usdt:"wss://fx-ws.gateio.ws/v4/ws/usdt",btc:"wss://fx-ws.gateio.ws/v4/ws/btc"},future:{usdt:"wss://fx-ws.gateio.ws/v4/ws/delivery/usdt",btc:"wss://fx-ws.gateio.ws/v4/ws/delivery/btc"},option:{usdt:"wss://op-ws.gateio.live/v4/ws/usdt",btc:"wss://op-ws.gateio.live/v4/ws/btc"}},test:{swap:{usdt:"wss://fx-ws-testnet.gateio.ws/v4/ws/usdt",btc:"wss://fx-ws-testnet.gateio.ws/v4/ws/btc"},future:{usdt:"wss://fx-ws-testnet.gateio.ws/v4/ws/usdt",btc:"wss://fx-ws-testnet.gateio.ws/v4/ws/btc"},option:{usdt:"wss://op-ws-testnet.gateio.live/v4/ws/usdt",btc:"wss://op-ws-testnet.gateio.live/v4/ws/btc"}}},options:{tradesLimit:1e3,OHLCVLimit:1e3,watchTradesSubscriptions:{},watchTickerSubscriptions:{},watchOrderBookSubscriptions:{},watchTicker:{name:"tickers"},watchOrderBook:{interval:"100ms",snapshotDelay:10,snapshotMaxRetries:3,checksum:!0},watchBalance:{settle:"usdt",spot:"spot.balances"},watchPositions:{fetchPositionsSnapshot:!0,awaitPositionsSnapshot:!0}},exceptions:{ws:{exact:{1:r.BadRequest,2:r.BadRequest,4:r.AuthenticationError,6:r.AuthenticationError,11:r.AuthenticationError},broad:{}}}})}async createOrderWs(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t);t=n.symbol;const o=this.getTypeByMarket(n),d=o+".order_place",c=this.getUrlByMarket(n);a.textIsRequired=!0;const h=this.createOrderRequest(t,e,i,s,r,a);await this.authenticate(c,o);const l=await this.requestPrivate(c,h,d);return this.parseOrder(l,n)}async createOrdersWs(t,e={}){await this.loadMarkets();const i=this.createOrdersRequest(t,e),s=t[0],a=this.market(s.symbol);if(!0!==a.swap)throw new r.NotSupported(this.id+" createOrdersWs is not supported for swap markets");const n=this.getTypeByMarket(a),o=n+".order_batch_place",d=this.getUrlByMarket(a);await this.authenticate(d,n);const c=await this.requestPrivate(d,i,o);return this.parseOrders(c,a)}async cancelAllOrdersWs(t=void 0,e={}){await this.loadMarkets();const i=void 0===t?void 0:this.market(t),s=this.safeBool2(e,"stop","trigger"),r=this.getTypeByMarket(i);let a=r+".order_cancel_cp";[a,e]=this.handleOptionAndParams(e,"cancelAllOrdersWs","channel",a);const n=this.getUrlByMarket(i);e=this.omit(e,["stop","trigger"]);const[o,d]=this.handleMarketTypeAndParams("cancelAllOrders",i,e),[c,h]="spot"===o?this.multiOrderSpotPrepareRequest(i,s,d):this.prepareRequest(i,o,d);await this.authenticate(n,r);const l=await this.requestPrivate(n,this.extend(c,h),a);return this.parseOrders(l,i)}async cancelOrderWs(t,e=void 0,i={}){await this.loadMarkets();const s=void 0===e?void 0:this.market(e),r=this.safeValueN(i,["is_stop_order","stop","trigger"],!1);i=this.omit(i,["is_stop_order","stop","trigger"]);const[a,n]=this.handleMarketTypeAndParams("cancelOrder",s,i),[o,d]="spot"===a||"margin"===a?this.spotOrderPrepareRequest(s,r,n):this.prepareRequest(s,a,n),c=this.getTypeByMarket(s),h=c+".order_cancel",l=this.getUrlByMarket(s);await this.authenticate(l,c),o.order_id=t.toString();const u=await this.requestPrivate(l,this.extend(o,d),h);return this.parseOrder(u,s)}async editOrderWs(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets();const o=this.market(e),d=this.editOrderRequest(t,e,i,s,r,a,n),c=this.getTypeByMarket(o),h=c+".order_amend",l=this.getUrlByMarket(o);await this.authenticate(l,c);const u=await this.requestPrivate(l,d,h);return this.parseOrder(u,o)}async fetchOrderWs(t,e=void 0,i={}){await this.loadMarkets();const s=void 0===e?void 0:this.market(e),[r,a]=this.fetchOrderRequest(t,e,i),n=this.getTypeByMarket(s),o=n+".order_status",d=this.getUrlByMarket(s);await this.authenticate(d,n);const c=await this.requestPrivate(d,this.extend(r,a),o);return this.parseOrder(c,s)}async fetchOpenOrdersWs(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByStatusWs("open",t,e,i,s)}async fetchClosedOrdersWs(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByStatusWs("finished",t,e,i,s)}async fetchOrdersByStatusWs(t,e=void 0,i=void 0,s=void 0,a={}){let n;if(await this.loadMarkets(),void 0!==e&&(n=this.market(e),e=n.symbol,!0!==n.swap))throw new r.NotSupported(this.id+" fetchOrdersByStatusWs is only supported by swap markets. Use rest API for other markets");const[o,d]=this.prepareOrdersByStatusRequest(t,e,i,s,a),c=this.omit(o,["settle"]),h=this.getTypeByMarket(n),l=h+".order_list",u=this.getUrlByMarket(n);await this.authenticate(u,h);const p=await this.requestPrivate(u,this.extend(c,d),l),f=this.parseOrders(p,n);return this.filterBySymbolSinceLimit(f,e,i,s)}async watchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t);t=s.symbol;const r=s.id,[a,n]=this.handleOptionAndParams(i,"watchOrderBook","interval","100ms"),o=this.getTypeByMarket(s)+".order_book_update",d="orderbook:"+t,c=this.getUrlByMarket(s),h=[r,a];if(void 0===e&&(e=100),s.contract){const t=e.toString();h.push(t)}const l={symbol:t,limit:e};return(await this.subscribePublic(c,d,h,o,n,l)).limit()}async unWatchOrderBook(t,e={}){await this.loadMarkets();const i=this.market(t);t=i.symbol;const s=i.id;let r="100ms";[r,e]=this.handleOptionAndParams(e,"watchOrderBook","interval",r);const a=this.getTypeByMarket(i)+".order_book_update",n="orderbook:"+t,o="unsubscribe:orderbook:"+t,d=this.getUrlByMarket(i),c=[s,r],h=this.safeInteger(e,"limit",100);if(i.contract){const t=h.toString();c.push(t)}return await this.unSubscribePublicMultiple(d,"orderbook",[t],[o],[n],c,a,e)}handleOrderBookSubscription(t,e,i){const s=this.safeString(i,"symbol"),r=this.safeInteger(i,"limit");this.orderbooks[s]=this.orderBook({},r)}handleOrderBook(t,e){const i=this.safeString(e,"channel").split("."),s="spot"===this.safeString(i,0),a=s?"spot":"contract",n=this.safeValue(e,"result"),o=this.safeInteger(n,"U"),d=this.safeInteger(n,"u"),c=this.safeString(n,"s"),h=this.safeSymbol(c,void 0,"_",a),l="orderbook:"+h,u=this.safeValue(this.orderbooks,h,this.orderBook({})),p=this.safeInteger(u,"nonce");if(void 0===p){let e=0;void 0!==u&&(e=u.cache.length);const i=this.handleOption("watchOrderBook","snapshotDelay",10);if(e===(s?i:0)){const e=t.subscriptions[l],i=this.safeInteger(e,"limit");this.spawn(this.loadOrderBook,t,l,h,i,{})}return void u.cache.push(n)}if(!(p>=d)){if(p>=o-1)this.handleDelta(u,n);else{delete t.subscriptions[l],delete this.orderbooks[h];if(this.handleOption("watchOrderBook","checksum",!0)){const e=new r.ChecksumError(this.id+" "+this.orderbookChecksumMessage(h));t.reject(e,l)}}t.resolve(u,l)}}getCacheIndex(t,e){const i=this.safeInteger(t,"nonce"),s=e[0];if(i<this.safeInteger(s,"U"))return-1;for(let t=0;t<e.length;t++){const s=e[t],r=this.safeInteger(s,"U"),a=this.safeInteger(s,"u");if(i>=r-1&&i<a)return t}return e.length}handleBidAsks(t,e){for(let i=0;i<e.length;i++){const s=e[i];if(Array.isArray(s))t.storeArray(this.parseBidAsk(s));else{const e=this.safeFloat(s,"p"),i=this.safeFloat(s,"s");t.store(e,i)}}}handleDelta(t,e){const i=this.safeInteger(e,"t");t.timestamp=i,t.datetime=this.iso8601(i),t.nonce=this.safeInteger(e,"u");const s=this.safeValue(e,"b",[]),r=this.safeValue(e,"a",[]),a=t.bids,n=t.asks;this.handleBidAsks(a,s),this.handleBidAsks(n,r)}async watchTicker(t,e={}){await this.loadMarkets();t=this.market(t).symbol,e.callerMethodName="watchTicker";const i=await this.watchTickers([t],e);return this.safeValue(i,t)}async watchTickers(t=void 0,e={}){return await this.subscribeWatchTickersAndBidsAsks(t,"watchTickers",this.extend({method:"tickers"},e))}handleTicker(t,e){this.handleTickerAndBidAsk("ticker",t,e)}async watchBidsAsks(t=void 0,e={}){return await this.subscribeWatchTickersAndBidsAsks(t,"watchBidsAsks",this.extend({method:"book_ticker"},e))}handleBidAsk(t,e){this.handleTickerAndBidAsk("bidask",t,e)}async subscribeWatchTickersAndBidsAsks(t=void 0,e=void 0,i={}){await this.loadMarkets(),[e,i]=this.handleParamString(i,"callerMethodName",e),t=this.marketSymbols(t,void 0,!1);const s=this.market(t[0]),r=this.getTypeByMarket(s),a=this.marketIds(t);let n;[n,i]=this.handleOptionAndParams(i,e,"method");const o=this.getUrlByMarket(s),d=r+"."+n,c=e.indexOf("watchTicker")>=0,h=c?"ticker":"bidask",l=[];for(let e=0;e<t.length;e++){const i=t[e];l.push(h+":"+i)}const u=await this.subscribePublicMultiple(o,l,a,d,i);if(this.newUpdates){const t={};return t[u.symbol]=u,t}const p=c?this.tickers:this.bidsasks;return this.filterByArray(p,"symbol",t,!0)}handleTickerAndBidAsk(t,e,i){const s=this.safeString(i,"channel").split("."),r="futures"===this.safeString(s,0)?"contract":"spot",a=this.safeValue(i,"result");let n=[];if(Array.isArray(a))n=this.safeList(i,"result",[]);else{n=[this.safeDict(i,"result",{})]}const o="ticker"===t;for(let i=0;i<n.length;i++){const s=n[i],a=this.safeString(s,"s"),d=this.safeMarket(a,void 0,"_",r),c=this.parseTicker(s,d),h=c.symbol;o?this.tickers[h]=c:this.bidsasks[h]=c;const l=t+":"+h;e.resolve(c,l)}}async watchTrades(t,e=void 0,i=void 0,s={}){return await this.watchTradesForSymbols([t],e,i,s)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets(),t=this.marketSymbols(t);const r=this.marketIds(t),a=this.market(t[0]),n=this.getTypeByMarket(a)+".trades",o=[];for(let e=0;e<t.length;e++){const i=t[e];o.push("trades:"+i)}const d=this.getUrlByMarket(a),c=await this.subscribePublicMultiple(d,o,r,n,s);if(this.newUpdates){const t=this.safeValue(c,0),e=this.safeString(t,"symbol");i=c.getLimit(e,i)}return this.filterBySinceLimit(c,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.marketIds(t),s=this.market(t[0]),r=this.getTypeByMarket(s)+".trades",a=[],n=[];for(let e=0;e<t.length;e++){const i=t[e];a.push("trades:"+i),n.push("unsubscribe:trades:"+i)}const o=this.getUrlByMarket(s);return await this.unSubscribePublicMultiple(o,"trades",t,n,a,i,r,e)}async unWatchTrades(t,e={}){return await this.unWatchTradesForSymbols([t],e)}handleTrades(t,e){let i=this.safeValue(e,"result");Array.isArray(i)||(i=[i]);const s=this.parseTrades(i);for(let e=0;e<s.length;e++){const i=s[e],r=i.symbol;let n=this.safeValue(this.trades,r);if(void 0===n){const t=this.safeInteger(this.options,"tradesLimit",1e3);n=new a.I3(t),this.trades[r]=n}n.append(i);const o="trades:"+r;t.resolve(n,o)}}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);t=a.symbol;const n=a.id,o=this.safeString(this.timeframes,e,e),d=this.getTypeByMarket(a)+".candlesticks",c="candles:"+o+":"+a.symbol,h=this.getUrlByMarket(a),l=[o,n],u=await this.subscribePublic(h,c,l,d,r);return this.newUpdates&&(s=u.getLimit(t,s)),this.filterBySinceLimit(u,i,s,0,!0)}handleOHLCV(t,e){const i=this.safeString(e,"channel").split("."),s="spot"===this.safeString(i,0)?"spot":"contract";let r=this.safeValue(e,"result");Array.isArray(r)||(r=[r]);const n={};for(let t=0;t<r.length;t++){const e=r[t],i=this.safeString(e,"n",""),o=i.split("_"),d=this.safeString(o,0),c=this.findTimeframe(d),h=c+"_",l=i.replace(h,""),u=this.safeSymbol(l,void 0,"_",s),p=this.parseOHLCV(e);this.ohlcvs[u]=this.safeValue(this.ohlcvs,u,{});let f=this.safeValue(this.ohlcvs[u],c);if(void 0===f){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);f=new a.TG(t),this.ohlcvs[u][c]=f}f.append(p),n[u]=c}const o=Object.keys(n);for(let e=0;e<o.length;e++){const i=o[e],s=n[i],r=this.findTimeframe(s),a="candles:"+r+":"+i,d=this.safeValue(this.ohlcvs[i],r);t.resolve(d,a)}}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r,a;await this.loadMarkets();let n,o="!all";void 0!==t&&(n=this.market(t),o=n.id),[a,s]=this.handleMarketTypeAndParams("watchMyTrades",n,s),[r,s]=this.handleSubTypeAndParams("watchMyTrades",n,s);const d=this.getSupportedMapping(a,{spot:"spot",margin:"spot",future:"futures",swap:"futures",option:"options"})+".usertrades";let c="myTrades";void 0!==t&&(c+=":"+t);const h="inverse"===r,l=this.getUrlByMarketType(a,h),u=[o],p="spot"!==a,f=await this.subscribePrivate(l,c,u,d,s,p);return this.newUpdates&&(i=f.getLimit(t,i)),this.filterBySymbolSinceLimit(f,t,e,i,!0)}handleMyTrades(t,e){const i=this.safeValue(e,"result",[]);if(0===i.length)return;let s=this.myTrades;if(void 0===s){const t=this.safeInteger(this.options,"tradesLimit",1e3);s=new a.Pt(t),this.myTrades=s}const r=this.parseTrades(i),n={};for(let t=0;t<r.length;t++){const e=r[t];s.append(e);n[e.symbol]=!0}const o=Object.keys(n);for(let e=0;e<o.length;e++){const i="myTrades:"+o[e];t.resolve(s,i)}t.resolve(s,"myTrades")}async watchBalance(t={}){let e,i;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t),[i,t]=this.handleSubTypeAndParams("watchBalance",void 0,t);const s="inverse"===i,r=this.getUrlByMarketType(e,s),a="spot"!==e,n=this.getSupportedMapping(e,{spot:"spot",margin:"spot",future:"futures",swap:"futures",option:"options"})+".balances",o=e+".balance";return await this.subscribePrivate(r,o,void 0,n,t,a)}handleBalance(t,e){const i=this.safeValue(e,"result",[]),s=this.safeInteger(e,"time_ms");this.balance.info=i,this.balance.timestamp=s,this.balance.datetime=this.iso8601(s);for(let t=0;t<i.length;t++){const e=i[t],s=this.account(),r=this.safeString(e,"currency","USDT"),a=this.safeCurrencyCode(r);s.free=this.safeString(e,"available"),s.total=this.safeString2(e,"total","balance"),this.balance[a]=s}const r=this.safeString(e,"channel").split("."),a=this.safeString(r,0),n=this.getSupportedMapping(a,{spot:"spot",futures:"swap",options:"option"})+".balance";this.balance=this.safeBalance(this.balance),t.resolve(this.balance,n)}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets(),t=this.marketSymbols(t);let a,n;this.isEmpty(t)||(r=this.getMarketFromSymbols(t)),[a,n]=this.handleMarketTypeAndParams("watchPositions",r,s),"spot"===a&&(a="swap");const o=this.getSupportedMapping(a,{future:"futures",swap:"futures",option:"options"});let d=a+":positions";this.isEmpty(t)||(d+="::"+t.join(","));const c=o+".positions";let h;[h,n]=this.handleSubTypeAndParams("watchPositions",r,n);const l="inverse"===h,u=this.getUrlByMarketType(a,l),p=this.client(u);this.setPositionsCache(p,a,t);const f=this.handleOption("watchPositions","fetchPositionsSnapshot",!0),m=this.handleOption("watchPositions","awaitPositionsSnapshot",!0),g=this.safeValue(this.positions,a);if(f&&m&&void 0===g)return await p.future(a+":fetchPositionsSnapshot");const y=await this.subscribePrivate(u,d,["!all"],c,n,!0);return this.newUpdates?y:this.filterBySymbolsSinceLimit(this.positions[a],t,e,i,!0)}setPositionsCache(t,e,i=void 0){if(void 0===this.positions&&(this.positions={}),e in this.positions)return;if(this.handleOption("watchPositions","fetchPositionsSnapshot",!1)){const i=e+":fetchPositionsSnapshot";i in t.futures||(t.future(i),this.spawn(this.loadPositionsSnapshot,t,i,e))}else this.positions[e]=new a.Hk}async loadPositionsSnapshot(t,e,i){const s=await this.fetchPositions(void 0,{type:i});this.positions[i]=new a.Hk;const r=this.positions[i];for(let t=0;t<s.length;t++){const e=s[t];this.safeNumber(e,"contracts",0)>0&&r.append(e)}if(e in t.futures){t.futures[e].resolve(r),t.resolve(r,i+":position")}}handlePositions(t,e){const i=this.getMarketTypeByUrl(t.url),s=this.safeValue(e,"result",[]),r=this.positions[i],a=[];for(let t=0;t<s.length;t++){const e=s[t],i=this.parsePosition(e),n=this.safeString(i,"symbol");if(void 0===this.safeString(i,"side")){const t=this.safeDict(r,n+"long");void 0!==t&&(i.side=t.side,a.push(i),r.append(i));const e=this.safeDict(r,n+"short");void 0!==e&&(i.side=e.side,a.push(i),r.append(i)),void 0===t&&void 0===e&&(i.side="long",a.push(i),r.append(i))}else a.push(i),r.append(i)}const n=this.findMessageHashes(t,i+":positions::");for(let e=0;e<n.length;e++){const i=n[e],s=i.split("::")[1].split(","),r=this.filterByArray(a,"symbol",s,!1);this.isEmpty(r)||t.resolve(r,i)}t.resolve(a,i+":positions")}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){let r,a,n;await this.loadMarkets(),void 0!==t&&(r=this.market(t),t=r.symbol),[a,n]=this.handleMarketTypeAndParams("watchOrders",r,s);const o=this.getSupportedMapping(a,{spot:"spot",margin:"spot",future:"futures",swap:"futures",option:"options"})+".orders";let d,c="orders",h=["!all"];void 0!==t&&(c+=":"+r.id,h=[r.id]),[d,n]=this.handleSubTypeAndParams("watchOrders",r,n);const l="inverse"===d,u=this.getUrlByMarketType(a,l),p="spot"!==a,f=await this.subscribePrivate(u,c,h,o,n,p);return this.newUpdates&&(i=f.getLimit(t,i)),this.filterBySinceLimit(f,e,i,"timestamp",!0)}handleOrder(t,e){const i=this.safeValue(e,"result",[]),s=this.safeInteger(this.options,"ordersLimit",1e3);void 0===this.orders&&(this.orders=new a.Pt(s));const r=this.orders,n={},o=this.parseOrders(i);for(let t=0;t<o.length;t++){const e=o[t],i=this.safeValue(e,"info"),s=this.safeString(i,"event");if("put"===s||"update"===s)e.status="open";else if("finish"===s){if(void 0===this.safeString(e,"status")){const t=this.safeInteger(i,"left");e.status=0===t?"closed":"canceled"}}r.append(e);const a=e.symbol;n[this.market(a).id]=!0}const d=Object.keys(n);for(let e=0;e<d.length;e++){const i="orders:"+d[e];t.resolve(this.orders,i)}t.resolve(this.orders,"orders")}async watchMyLiquidations(t,e=void 0,i=void 0,s={}){return this.watchMyLiquidationsForSymbols([t],e,i,s)}async watchMyLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0);const a=this.getMarketFromSymbols(t);let n,o;[n,o]=this.handleMarketTypeAndParams("watchMyLiquidationsForSymbols",a,s);const d=this.getSupportedMapping(n,{future:"futures",swap:"futures",option:"options"});let c;[c,o]=this.handleSubTypeAndParams("watchMyLiquidationsForSymbols",a,o);const h="inverse"===c,l=this.getUrlByMarketType(n,h),u=[];let p="";if(this.isEmpty(t)){if("futures"!==d&&!h)throw new r.BadRequest(this.id+" watchMyLiquidationsForSymbols() does not support listening to all symbols, you must call watchMyLiquidations() instead for each symbol you wish to watch.");p="myLiquidations",u.push("!all")}else{if(1!==t.length)throw new r.BadRequest(this.id+" watchMyLiquidationsForSymbols() only allows one symbol at a time. To listen to several symbols call watchMyLiquidationsForSymbols() several times.");p="myLiquidations::"+t[0],u.push(a.id)}const f=d+".liquidates",m=await this.subscribePrivate(l,p,u,f,o,!0);return this.newUpdates?m:this.filterBySymbolsSinceLimit(this.liquidations,t,e,i,!0)}handleLiquidation(t,e){const i=this.safeList(e,"result",[]);for(let e=0;e<i.length;e++){const s=i[e],r=this.parseWsLiquidation(s),n=this.safeString(r,"symbol");let o=this.safeValue(this.liquidations,n);if(void 0===o){const t=this.safeInteger(this.options,"liquidationsLimit",1e3);o=new a.I3(t)}o.append(r),this.liquidations[n]=o,t.resolve(o,"myLiquidations::"+n)}t.resolve([],"myLiquidations")}parseWsLiquidation(t,e=void 0){const i=this.safeString(t,"contract");e=this.safeMarket(i,e);const s=this.safeInteger(t,"time_ms"),r=this.safeString(t,"size"),a=this.safeString(t,"left"),n=o.Y.stringAbs(o.Y.stringSub(r,a));return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:this.parseNumber(n),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(t,"fill_price"),baseValue:void 0,quoteValue:void 0,timestamp:s,datetime:this.iso8601(s)})}handleErrorMessage(t,e){const i=this.safeDict(e,"data"),s=this.safeDict(i,"errs"),a=this.safeDict(e,"error",s),n=this.safeString2(a,"code","label"),o=this.safeStringN(e,["id","requestId","request_id"]);if(void 0!==a){const i=this.safeString(t.subscriptions,o);try{this.throwExactlyMatchedException(this.exceptions.ws.exact,n,this.json(e)),this.throwExactlyMatchedException(this.exceptions.exact,n,this.json(s));const t=this.safeString(a,"message",this.safeString(s,"message"));throw this.throwBroadlyMatchedException(this.exceptions.ws.broad,t,this.json(e)),new r.ExchangeError(this.json(e))}catch(s){t.reject(s,i),void 0!==i&&i in t.subscriptions&&delete t.subscriptions[i];const r=this.safeString(e,"channel");if(void 0!==r&&r.indexOf(".")>0){const i=r.split("."),s=this.safeList(e,"payload",[]);for(let e=0;e<s.length;e++){const r="futures"===i[0]?"swap":i[0],a=this.safeSymbol(s[e],void 0,"_",r),n=i[1]+":"+a;void 0!==n&&n in t.subscriptions&&delete t.subscriptions[n]}}}return void 0!==o&&o in t.subscriptions&&delete t.subscriptions[o],!0}return!1}handleBalanceSubscription(t,e,i=void 0){this.balance={}}handleSubscriptionStatus(t,e){const i=this.safeString(e,"channel"),s={balance:this.handleBalanceSubscription,"spot.order_book_update":this.handleOrderBookSubscription,"futures.order_book_update":this.handleOrderBookSubscription},r=this.safeString(e,"id");if(i in s){const a=this.safeString(t.subscriptions,r),n=this.safeValue(t.subscriptions,a);s[i].call(this,t,e,n)}r in t.subscriptions&&delete t.subscriptions[r]}handleUnSubscribe(t,e){const i=this.safeString(e,"id"),s=Object.keys(t.subscriptions);for(let e=0;e<s.length;e++){const r=s[e];if(r in t.subscriptions&&r.startsWith("unsubscribe")){const e=t.subscriptions[r];if(i!==this.safeString(e,"id"))continue;const s=this.safeList(e,"messageHashes",[]),a=this.safeList(e,"subMessageHashes",[]);for(let e=0;e<s.length;e++){const i=s[e],r=a[e];this.cleanUnsubscription(t,r,i)}this.cleanCache(e)}}}handleMessage(t,e){if(this.handleErrorMessage(t,e))return;const i=this.safeString(e,"event");if("subscribe"===i)return void this.handleSubscriptionStatus(t,e);if("unsubscribe"===i)return void this.handleUnSubscribe(t,e);const s=this.safeString(e,"channel","").split("."),r=this.safeValue(s,1),a={usertrades:this.handleMyTrades,candlesticks:this.handleOHLCV,orders:this.handleOrder,positions:this.handlePositions,tickers:this.handleTicker,book_ticker:this.handleBidAsk,trades:this.handleTrades,order_book_update:this.handleOrderBook,balances:this.handleBalance,liquidates:this.handleLiquidation},n=this.safeValue(a,r);void 0!==n&&n.call(this,t,e);const o=this.safeString(e,"request_id");if("authenticated"!==o){if(void 0!==o){const i=this.safeDict(e,"data"),s=this.safeValue(i,"result");!0!==this.safeBool(e,"ack")&&t.resolve(s,o)}}else this.handleAuthenticationMessage(t,e)}getUrlByMarket(t){const e=this.urls.api[t.type];return t.contract?t.linear?e.usdt:e.btc:e}getTypeByMarket(t){return t.spot?"spot":t.option?"options":"futures"}getUrlByMarketType(t,e=!1){const i=this.urls.api[t];return"swap"===t||"future"===t?e?i.btc:i.usdt:i}getMarketTypeByUrl(t){const e={"op-":"option",delivery:"future",fx:"swap"},i=Object.keys(e);for(let s=0;s<i.length;s++){const r=i[s],a=e[r];if(t.indexOf(r)>=0)return a}return"spot"}requestId(){this.lockId();const t=this.sum(this.safeInteger(this.options,"reqid",0),1);return this.options.reqid=t,this.unlockId(),t}async subscribePublic(t,e,i,s,r={},a=void 0){const n=this.requestId(),o={id:n,time:this.seconds(),channel:s,event:"subscribe",payload:i};if(void 0!==a){const i=this.client(t);if(!(e in i.subscriptions)){const t=n.toString();i.subscriptions[t]=e}}const d=this.extend(o,r);return await this.watch(t,e,d,e,a)}async subscribePublicMultiple(t,e,i,s,r={}){const a={id:this.requestId(),time:this.seconds(),channel:s,event:"subscribe",payload:i},n=this.extend(a,r);return await this.watchMultiple(t,e,n,e)}async unSubscribePublicMultiple(t,e,i,s,r,a,n,o={}){const d=this.requestId(),c={id:d,time:this.seconds(),channel:n,event:"unsubscribe",payload:a},h={id:d.toString(),topic:e,unsubscribe:!0,messageHashes:s,subMessageHashes:r,symbols:i},l=this.extend(c,o);return await this.watchMultiple(t,s,l,s,h)}async authenticate(t,e){const i=e+".login",s=this.client(t),r="authenticated",a=s.reusableFuture(r);return void 0===this.safeValue(s.subscriptions,r)?await this.requestPrivate(t,{},i,r):a}handleAuthenticationMessage(t,e){this.safeValue(t.futures,"authenticated").resolve(!0)}async requestPrivate(t,e,i,s=void 0){this.checkRequiredCredentials();const r="api";if(void 0===s){s=this.requestId().toString()}const a=s,o=this.seconds(),d=[r,i,this.json(e),o.toString()].join("\n"),c=this.hmac(this.encode(d),this.encode(this.secret),n.Zf,"hex"),h={req_id:s,timestamp:o.toString(),api_key:this.apiKey,signature:c,req_param:e};"spot.order_place"!==i&&"futures.order_place"!==i||(h.req_header={"X-Gate-Channel-Id":"ccxt"});const l={id:s,time:o,channel:i,event:r,payload:h};return await this.watch(t,a,l,a,s)}async subscribePrivate(t,e,i,s,a,o=!1){if(this.checkRequiredCredentials(),o){if(void 0===this.uid||0===this.uid.length)throw new r.ArgumentsRequired(this.id+" requires uid to subscribe");const t=[this.uid];i=void 0===i?t:this.arrayConcat(t,i)}const d=this.seconds(),c="subscribe",h="channel="+s+"&event="+c+"&time="+d.toString(),l=this.hmac(this.encode(h),this.encode(this.secret),n.Zf,"hex"),u={method:"api_key",KEY:this.apiKey,SIGN:l},p=this.requestId(),f={id:p,time:d,channel:s,event:c,auth:u};void 0!==i&&(f.payload=i);const m=this.client(t);if(!(e in m.subscriptions)){const t=p.toString();m.subscriptions[t]=e}const g=this.extend(f,a);return await this.watch(t,e,g,e,e)}}},9219(t,e,i){"use strict";i.d(e,{A:()=>o});var s=i(2403),r=i(2079),a=i(2931),n=i(4852);class o extends s.A{describe(){return this.deepExtend(super.describe(),{has:{ws:!0,cancelAllOrdersWs:!1,cancelOrdersWs:!1,cancelOrderWs:!1,createOrderWs:!1,editOrderWs:!1,fetchBalanceWs:!1,fetchOpenOrdersWs:!1,fetchOrderWs:!1,fetchTradesWs:!1,watchBalance:!0,watchMyTrades:!0,watchOHLCV:!0,watchOrderBook:!0,watchOrders:!0,watchTicker:!0,watchTickers:!0,watchBidsAsks:!0,watchTrades:!0,watchTradesForSymbols:!1,unWatchTicker:!0,unWatchTickers:!0,unWatchBidsAsks:!0,unWatchOHLCV:!0,unWatchOrderBook:!0,unWatchTrades:!0},urls:{api:{ws:{spot:"wss://wbs-api.mexc.com/ws",swap:"wss://contract.mexc.com/edge"}}},options:{listenKeyRefreshRate:12e5,decompressBinary:!1,timeframes:{"1m":"Min1","5m":"Min5","15m":"Min15","30m":"Min30","1h":"Min60","4h":"Hour4","8h":"Hour8","1d":"Day1","1w":"Week1","1M":"Month1"},watchOrderBook:{snapshotDelay:25,snapshotMaxRetries:3},listenKey:void 0},streaming:{ping:this.ping,keepAlive:8e3},exceptions:{}})}async watchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s="ticker:"+i.symbol;if(i.spot){const t="spot@public.aggre.bookTicker.v3.api.pb@100ms@"+i.id;return await this.watchSpotPublic(t,s,e)}{const t="sub.ticker",r={symbol:i.id};return await this.watchSwapPublic(t,s,r,e)}}handleTicker(t,e){this.handleBidAsk(t,e);const i=this.safeDictN(e,["d","data","publicAggreBookTicker"]),s=this.safeString2(e,"s","symbol"),r=this.safeInteger2(e,"t","sendTime"),a=this.safeMarket(s),n=a.symbol;let o;a.spot?(o=this.parseWsTicker(i,a),o.timestamp=r,o.datetime=this.iso8601(r)):o=this.parseTicker(i,a),this.tickers[n]=o;const d="ticker:"+n;t.resolve(o,d)}async watchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0);const i=[],s=this.safeString(t,0);let a,n;void 0!==s&&(a=this.market(s)),[n,e]=this.handleMarketTypeAndParams("watchTickers",a,e);const o="spot"===n,d=o?this.urls.api.ws.spot:this.urls.api.ws.swap,c={};if(o)throw new r.NotSupported(this.id+" watchTickers does not support spot markets");c.method="sub.tickers",c.params={},i.push("ticker");const h=await this.watchMultiple(d,i,this.extend(c,e),i);if(o&&this.newUpdates){const t={};return t[h.symbol]=h,t}return this.filterByArray(this.tickers,"symbol",t)}handleTickers(t,e){const i=this.safeList2(e,"data","d"),s=this.safeString(e,"c",""),r=this.safeString(e,"s"),a=this.safeMarket(r),n=s.startsWith("spot"),o=void 0===r?n:a.spot,d=(o?"spot:":"")+"ticker",c=[];for(let e=0;e<i.length;e++){const s=i[e];let r;r=o?this.parseWsTicker(s,a):this.parseTicker(s);const n=r.symbol;this.tickers[n]=r,c.push(r);const d="ticker:"+n;t.resolve(r,d)}t.resolve(c,d)}parseWsTicker(t,e=void 0){const i=this.safeString(t,"s"),s=this.safeInteger(t,"t"),r=this.safeString(t,"p");return this.safeTicker({info:t,symbol:this.safeSymbol(i,e),timestamp:s,datetime:this.iso8601(s),open:void 0,high:this.safeNumber(t,"h"),low:this.safeNumber(t,"l"),close:r,last:r,bid:this.safeNumber2(t,"b","bidPrice"),bidVolume:this.safeNumber2(t,"B","bidQuantity"),ask:this.safeNumber2(t,"a","askPrice"),askVolume:this.safeNumber2(t,"A","askQuantity"),vwap:void 0,previousClose:void 0,change:void 0,percentage:this.safeNumber(t,"tr"),average:void 0,baseVolume:this.safeNumber(t,"v"),quoteVolume:this.safeNumber(t,"q")},e)}async watchBidsAsks(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0===(t=this.marketSymbols(t,void 0,!0,!1,!0)))throw new r.ArgumentsRequired(this.id+" watchBidsAsks required symbols argument");const s=this.marketsForSymbols(t);[i,e]=this.handleMarketTypeAndParams("watchBidsAsks",s[0],e);const a="spot"===i;if(!a)throw new r.NotSupported(this.id+" watchBidsAsks only support spot market");const n=[],o=[];for(let e=0;e<t.length;e++){if(a){const i=this.market(t[e]);o.push("spot@public.aggre.bookTicker.v3.api.pb@100ms@"+i.id)}n.push("bidask:"+t[e])}const d=this.urls.api.ws.spot,c={method:"SUBSCRIPTION",params:o},h=await this.watchMultiple(d,n,this.extend(c,e),n);if(this.newUpdates){const t={};return t[h.symbol]=h,t}return this.filterByArray(this.bidsasks,"symbol",t)}handleBidAsk(t,e){const i=this.parseWsBidAsk(e),s=this.safeString(i,"symbol");if(void 0===s)return;this.bidsasks[s]=i;const r="bidask:"+s;t.resolve(i,r)}parseWsBidAsk(t,e=void 0){const i=this.safeDict(t,"d"),s=this.safeString(t,"s");e=this.safeMarket(s,e);const r=this.safeString(e,"symbol"),a=this.safeInteger(t,"t");return this.safeTicker({symbol:r,timestamp:a,datetime:this.iso8601(a),ask:this.safeNumber(i,"a"),askVolume:this.safeNumber(i,"A"),bid:this.safeNumber(i,"b"),bidVolume:this.safeNumber(i,"B"),info:t},e)}async watchSpotPublic(t,e,i={}){const s=this.safeBool(i,"unsubscribed",!1);i=this.omit(i,["unsubscribed"]);const r=this.urls.api.ws.spot,a={method:s?"UNSUBSCRIPTION":"SUBSCRIPTION",params:[t]};return await this.watch(r,e,this.extend(a,i),e)}async watchSpotPrivate(t,e,i={}){this.checkRequiredCredentials();const s=await this.authenticate(t),r=this.urls.api.ws.spot+"?listenKey="+s,a={method:"SUBSCRIPTION",params:[t]};return await this.watch(r,e,this.extend(a,i),t)}async watchSwapPublic(t,e,i,s={}){const r=this.urls.api.ws.swap,a={method:t,param:i},n=this.extend(a,s);return await this.watch(r,e,n,e)}async watchSwapPrivate(t,e={}){this.checkRequiredCredentials();const i="login",s=this.urls.api.ws.swap,r=this.milliseconds().toString(),a=this.apiKey+r,o=this.hmac(this.encode(a),this.encode(this.secret),n.s),d={method:i,param:{apiKey:this.apiKey,signature:o,reqTime:r}},c=this.extend(d,e);return await this.watch(s,t,c,i)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);t=a.symbol;const n=this.safeValue(this.options,"timeframes",{}),o=this.safeString(n,e),d="candles:"+t+":"+e;let c;if(a.spot){const t="spot@public.kline.v3.api.pb@"+a.id+"@"+o;c=await this.watchSpotPublic(t,d,r)}else{const t="sub.kline",e={symbol:a.id,interval:o};c=await this.watchSwapPublic(t,d,e,r)}return this.newUpdates&&(s=c.getLimit(t,s)),this.filterBySinceLimit(c,i,s,0,!0)}handleOHLCV(t,e){let i,s,r;if("publicSpotKline"in e){s=this.symbol(this.safeString(e,"symbol"));const t=this.safeDict(e,"publicSpotKline",{}),a=this.safeString(t,"interval");r=this.findTimeframe(a,this.options.timeframes),i=this.parseWsOHLCV(t,this.safeMarket(s))}else{const t=this.safeValue2(e,"d","data",{}),a=this.safeValue(t,"k",t),n=this.safeString2(a,"i","interval"),o=this.safeValue(this.options,"timeframes",{});r=this.findTimeframe(n,o);const d=this.safeString2(e,"s","symbol"),c=this.safeMarket(d);s=c.symbol,i=this.parseWsOHLCV(a,c)}const n="candles:"+s+":"+r;this.ohlcvs[s]=this.safeValue(this.ohlcvs,s,{});let o=this.safeValue(this.ohlcvs[s],r);if(void 0===o){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);o=new a.TG(t),this.ohlcvs[s][r]=o}o.append(i),t.resolve(o,n)}parseWsOHLCV(t,e=void 0){return[this.safeTimestamp2(t,"t","windowStart"),this.safeNumber2(t,"o","openingPrice"),this.safeNumber2(t,"h","highestPrice"),this.safeNumber2(t,"l","lowestPrice"),this.safeNumber2(t,"c","closingPrice"),this.safeNumber2(t,"v","volume")]}async watchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r="orderbook:"+(t=s.symbol);let a;if(s.spot){let t;[t,i]=this.handleOptionAndParams(i,"watchOrderBook","frequency","100ms");const e="spot@public.aggre.depth.v3.api.pb@"+t+"@"+s.id;a=await this.watchSpotPublic(e,r,i)}else{const t="sub.depth",e={symbol:s.id};a=await this.watchSwapPublic(t,r,e,i)}return a.limit()}handleOrderBookSubscription(t,e){const i=this.safeString(e,"msg").split("@"),s=this.safeString(i,2),r=this.safeSymbol(s);this.orderbooks[r]=this.orderBook({})}getCacheIndex(t,e){const i=this.safeInteger(t,"nonce"),s=this.safeValue(e,0);if(i<this.safeIntegerN(s,["r","version","fromVersion"])-1)return-1;for(let t=0;t<e.length;t++){const s=e[t];if(this.safeIntegerN(s,["r","version","fromVersion"])>=i)return t}return e.length}handleOrderBook(t,e){const i=this.safeDictN(e,["d","data","publicAggreDepths"]),s=this.safeString2(e,"s","symbol"),r=this.safeSymbol(s),a="orderbook:"+r,n=this.safeValue(t.subscriptions,a),o=this.safeInteger(n,"limit");r in this.orderbooks||(this.orderbooks[r]=this.orderBook());const d=this.orderbooks[r];let c=!1;if(void 0===this.safeInteger(d,"nonce")){return d.cache.length===this.handleOption("watchOrderBook","snapshotDelay",25)&&this.spawn(this.loadOrderBook,t,a,r,o,{}),void d.cache.push(i)}try{this.handleDelta(d,i);const t=this.safeIntegerN(e,["t","ts","sendTime"]);d.timestamp=t,d.datetime=this.iso8601(t)}catch(e){delete t.subscriptions[a],t.reject(e,a),c=!0}c||t.resolve(d,a)}handleBooksideDelta(t,e){for(let i=0;i<e.length;i++){const s=e[i];if(Array.isArray(s))t.storeArray(s);else{const e=this.safeFloat2(s,"p","price"),i=this.safeFloat2(s,"v","quantity");t.store(e,i)}}}handleDelta(t,e){const i=this.safeInteger(t,"nonce"),s=this.safeIntegerN(e,["r","version","fromVersion"]);if(s<i)return;t.nonce=s;const r=this.safeList(e,"asks",[]),a=this.safeList(e,"bids",[]),n=t.asks,o=t.bids;this.handleBooksideDelta(n,r),this.handleBooksideDelta(o,a)}async watchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),a="trades:"+(t=r.symbol);let n;if(r.spot){const t="spot@public.aggre.deals.v3.api.pb@100ms@"+r.id;n=await this.watchSpotPublic(t,a,s)}else{const t="sub.deal",e={symbol:r.id};n=await this.watchSwapPublic(t,a,e,s)}return this.newUpdates&&(i=n.getLimit(t,i)),this.filterBySinceLimit(n,e,i,"timestamp",!0)}handleTrades(t,e){const i=this.safeString2(e,"s","symbol"),s=this.safeMarket(i),r=s.symbol,n="trades:"+r;let o=this.safeValue(this.trades,r);if(void 0===o){const t=this.safeInteger(this.options,"tradesLimit",1e3);o=new a.I3(t),this.trades[r]=o}const d=this.safeDictN(e,["d","publicAggreDeals"]);let c=this.safeList2(d,"deals","dealsList",[d]);void 0===d&&(c=this.safeList(e,"data",[]));for(let t=0;t<c.length;t++){let e;e=s.spot?this.parseWsTrade(c[t],s):this.parseTrade(c[t],s),o.append(e)}t.resolve(o,n)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n,o="myTrades";if(void 0!==t&&(r=this.market(t),o=o+":"+(t=r.symbol)),[a,s]=this.handleMarketTypeAndParams("watchMyTrades",r,s),"spot"===a){const t="spot@private.deals.v3.api.pb";n=await this.watchSpotPrivate(t,o,s)}else n=await this.watchSwapPrivate(o,s);return this.newUpdates&&(i=n.getLimit(t,i)),this.filterBySymbolSinceLimit(n,t,e,i,!0)}handleMyTrade(t,e,i=void 0){const s="myTrades",r=this.safeDictN(e,["d","data","privateDeals"]),n=this.safeString(r,"symbol"),o=this.safeString2(e,"s","symbol",n),d=this.safeMarket(o),c=d.symbol;let h;h=d.spot?this.parseWsTrade(r,d):this.parseTrade(r,d);let l=this.myTrades;if(void 0===l){const t=this.safeInteger(this.options,"tradesLimit",1e3);l=new a.Pt(t),this.myTrades=l}l.append(h),t.resolve(l,s);const u=s+":"+c;t.resolve(l,u)}parseWsTrade(t,e=void 0){let i=this.safeInteger2(t,"T","time"),s=this.safeString2(t,"t","tradeId");void 0===i&&(i=this.safeInteger(t,"t"),s=void 0);const r=this.safeString2(t,"p","price"),a=this.safeString2(t,"v","quantity"),n="1"===this.safeString2(t,"S","tradeType")?"buy":"sell",o=this.safeInteger(t,"m"),d=this.safeString2(t,"n","feeAmount"),c=this.safeString2(t,"N","feeCurrency");return this.safeTrade({info:t,id:s,order:this.safeString2(t,"i","orderId"),timestamp:i,datetime:this.iso8601(i),symbol:this.safeSymbol(void 0,e),type:void 0,side:n,takerOrMaker:o?"maker":"taker",price:r,amount:a,cost:this.safeString(t,"amount"),fee:{cost:d,currency:this.safeCurrencyCode(c)}},e)}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n,o="orders";if(void 0!==t&&(r=this.market(t),o=o+":"+(t=r.symbol)),[a,s]=this.handleMarketTypeAndParams("watchOrders",r,s),"spot"===a){const t="spot@private.orders.v3.api.pb";n=await this.watchSpotPrivate(t,o,s)}else n=await this.watchSwapPrivate(o,s);return this.newUpdates&&(i=n.getLimit(t,i)),this.filterBySymbolSinceLimit(n,t,e,i,!0)}handleOrder(t,e){const i="orders",s=this.safeDictN(e,["d","data","privateOrders"]),r=this.safeString(s,"symbol"),n=this.safeString2(e,"s","symbol",r),o=this.safeMarket(n),d=o.symbol;let c;c=o.spot?this.parseWsOrder(s,o):this.parseOrder(s,o);let h=this.orders;if(void 0===h){const t=this.safeInteger(this.options,"ordersLimit",1e3);h=new a.Pt(t),this.orders=h}h.append(c),t.resolve(h,i);const l=i+":"+d;t.resolve(h,l)}parseWsOrder(t,e=void 0){const i=this.safeInteger(t,"createTime"),s=this.safeString(t,"tradeType"),r=this.safeString(t,"status"),a=this.safeString(t,"orderType");let n;const o=this.safeString(t,"N");return void 0!==o&&(n={currency:o,cost:void 0}),this.safeOrder({id:this.safeString(t,"id"),clientOrderId:this.safeString(t,"clientId"),timestamp:i,datetime:this.iso8601(i),lastTradeTimestamp:void 0,status:this.parseWsOrderStatus(r,e),symbol:this.safeSymbol(void 0,e),type:this.parseWsOrderType(a),timeInForce:this.parseWsTimeInForce(a),side:"1"===s?"buy":"sell",price:this.safeString(t,"price"),stopPrice:void 0,triggerPrice:void 0,average:this.safeString(t,"avgPrice"),amount:this.safeString(t,"quantity"),cost:this.safeString(t,"amount"),filled:this.safeString(t,"cumulativeQuantity"),remaining:this.safeString(t,"remainQuantity"),fee:n,trades:void 0,info:t},e)}parseWsOrderStatus(t,e=void 0){return this.safeString({1:"open",2:"closed",3:"open",4:"canceled",5:"closed",NEW:"open",CANCELED:"canceled",EXECUTED:"closed",FAILED:"rejected"},t,t)}parseWsOrderType(t){const e={1:"limit",2:"limit",3:void 0,4:void 0,5:"market",100:"limit"};return this.safeString(e,t)}parseWsTimeInForce(t){return this.safeString({1:"GTC",2:"PO",3:"IOC",4:"FOK",5:"GTC",100:"GTC"},t)}async watchBalance(t={}){let e;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("watchBalance",void 0,t);const i="balance:"+e;if("spot"===e){const e="spot@private.account.v3.api.pb";return await this.watchSpotPrivate(e,i,t)}return await this.watchSwapPrivate(i,t)}handleBalance(t,e){const i="spot@private.account.v3.api.pb"===this.safeString(e,"channel")?"spot":"swap",s="balance:"+i,r=this.safeDictN(e,["data","privateAccount"]),a=this.safeInteger2(e,"ts","createTime"),n=this.safeInteger2(r,"time",a);i in this.balance||(this.balance[i]={}),this.balance[i].info=r,this.balance[i].timestamp=n,this.balance[i].datetime=this.iso8601(n);const o=this.safeStringN(r,["currency","vcoinName"]),d=this.safeCurrencyCode(o),c=this.account();c.free=this.safeString2(r,"balanceAmount","availableBalance"),c.used=this.safeStringN(r,["frozenBalance","frozenAmount"]),this.balance[i][d]=c,this.balance[i]=this.safeBalance(this.balance[i]),t.resolve(this.balance[i],s)}async unWatchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s="unsubscribe:ticker:"+i.symbol;let r,a;if(i.spot)a="spot@public.aggre.bookTicker.v3.api.pb@100ms@"+i.id,r=this.urls.api.ws.spot,e.unsubscribed=!0,this.watchSpotPublic(a,s,e);else{a="unsub.ticker";const t={symbol:i.id};r=this.urls.api.ws.swap,this.watchSwapPublic(a,s,t,e)}const n=this.client(r);this.handleUnsubscriptions(n,[s])}async unWatchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0);const i=[],s=this.safeString(t,0);let a,n;void 0!==s&&(a=this.market(s)),[n,e]=this.handleMarketTypeAndParams("watchTickers",a,e);const o="spot"===n,d=o?this.urls.api.ws.spot:this.urls.api.ws.swap,c={};if(o)throw new r.NotSupported(this.id+" watchTickers does not support spot markets");c.method="unsub.tickers",c.params={},i.push("unsubscribe:ticker");const h=this.client(d);this.watchMultiple(d,i,this.extend(c,e),i),this.handleUnsubscriptions(h,i)}async unWatchBidsAsks(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0===(t=this.marketSymbols(t,void 0,!0,!1,!0)))throw new r.ArgumentsRequired(this.id+" watchBidsAsks required symbols argument");const s=this.marketsForSymbols(t);[i,e]=this.handleMarketTypeAndParams("watchBidsAsks",s[0],e);const a="spot"===i;if(!a)throw new r.NotSupported(this.id+" watchBidsAsks only support spot market");const n=[],o=[];for(let e=0;e<t.length;e++){if(a){const i=this.market(t[e]);o.push("spot@public.aggre.bookTicker.v3.api.pb@100ms@"+i.id)}n.push("unsubscribe:bidask:"+t[e])}const d=this.urls.api.ws.spot,c={method:"UNSUBSCRIPTION",params:o},h=this.client(d);this.watchMultiple(d,n,this.extend(c,e),n),this.handleUnsubscriptions(h,n)}async unWatchOHLCV(t,e="1m",i={}){await this.loadMarkets();const s=this.market(t);t=s.symbol;const r=this.safeValue(this.options,"timeframes",{}),a=this.safeString(r,e),n="unsubscribe:candles:"+t+":"+e;let o;if(s.spot){o=this.urls.api.ws.spot;const t="spot@public.kline.v3.api.pb@"+s.id+"@"+a;i.unsubscribed=!0,this.watchSpotPublic(t,n,i)}else{o=this.urls.api.ws.swap;const t="unsub.kline",e={symbol:s.id,interval:a};this.watchSwapPublic(t,n,e,i)}const d=this.client(o);this.handleUnsubscriptions(d,[n])}async unWatchOrderBook(t,e={}){await this.loadMarkets();const i=this.market(t),s="unsubscribe:orderbook:"+(t=i.symbol);let r;if(i.spot){let t;r=this.urls.api.ws.spot,[t,e]=this.handleOptionAndParams(e,"watchOrderBook","frequency","100ms");const a="spot@public.aggre.depth.v3.api.pb@"+t+"@"+i.id;e.unsubscribed=!0,this.watchSpotPublic(a,s,e)}else{r=this.urls.api.ws.swap;const t="unsub.depth",a={symbol:i.id};this.watchSwapPublic(t,s,a,e)}const a=this.client(r);this.handleUnsubscriptions(a,[s])}async unWatchTrades(t,e={}){await this.loadMarkets();const i=this.market(t),s="unsubscribe:trades:"+(t=i.symbol);let r;if(i.spot){r=this.urls.api.ws.spot;const t="spot@public.aggre.deals.v3.api.pb@100ms@"+i.id;e.unsubscribed=!0,this.watchSpotPublic(t,s,e)}else{r=this.urls.api.ws.swap;const t="unsub.deal",a={symbol:i.id};this.watchSwapPublic(t,s,a,e)}const a=this.client(r);this.handleUnsubscriptions(a,[s])}handleUnsubscriptions(t,e){for(let i=0;i<e.length;i++){const s=e[i],r=s.replace("unsubscribe:","");if(this.cleanUnsubscription(t,r,s),s.indexOf("ticker")>=0){const t=s.replace("unsubscribe:ticker:","");if(t.indexOf("unsubscribe")>=0){const t=Object.keys(this.tickers);for(let e=0;e<t.length;e++)delete this.tickers[t[e]]}else t in this.tickers&&delete this.tickers[t]}else if(s.indexOf("bidask")>=0){const t=s.replace("unsubscribe:bidask:","");t in this.bidsasks&&delete this.bidsasks[t]}else if(s.indexOf("candles")>=0){const t=s.split(":");let e=this.safeString(t,2);t.length>4&&(e+=":"+this.safeString(t,3)),e in this.ohlcvs&&delete this.ohlcvs[e]}else if(s.indexOf("orderbook")>=0){const t=s.replace("unsubscribe:orderbook:","");t in this.orderbooks&&delete this.orderbooks[t]}else if(s.indexOf("trades")>=0){const t=s.replace("unsubscribe:trades:","");t in this.trades&&delete this.trades[t]}}}async authenticate(t,e={}){let i=this.safeString(this.options,"listenKey");if(void 0!==i)return i;const s=await this.spotPrivatePostUserDataStream(e);i=this.safeString(s,"listenKey"),this.options.listenKey=i;const r=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);return this.delay(r,this.keepAliveListenKey,i,e),i}async keepAliveListenKey(t,e={}){if(void 0===t)return;const i={listenKey:t};try{await this.spotPrivatePutUserDataStream(this.extend(i,e));const s=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);this.delay(s,this.keepAliveListenKey,t,e)}catch(e){const i=this.urls.api.ws.spot+"?listenKey="+t,s=this.client(i);this.options.listenKey=void 0,s.reject(e),delete this.clients[i]}}handlePong(t,e){return t.lastPong=this.milliseconds(),e}handleSubscriptionStatus(t,e){const i=this.safeString(e,"msg","");if("PONG"===i)this.handlePong(t,e);else if(i.indexOf("@")>-1){const s=i.split("@"),r=this.safeString(s,1),a={"public.increase.depth.v3.api":this.handleOrderBookSubscription,"public.aggre.depth.v3.api.pb":this.handleOrderBookSubscription},n=this.safeValue(a,r);void 0!==n&&n.call(this,t,e)}}handleProtobufMessage(t,e){const i=this.safeString(e,"channel").split("@"),s=this.safeString(i,1);return"public.kline.v3.api.pb"===s?this.handleOHLCV(t,e):"public.aggre.deals.v3.api.pb"===s?this.handleTrades(t,e):"public.aggre.bookTicker.v3.api.pb"===s?this.handleTicker(t,e):"public.aggre.depth.v3.api.pb"===s?this.handleOrderBook(t,e):"private.account.v3.api.pb"===s?this.handleBalance(t,e):"private.deals.v3.api.pb"===s?this.handleMyTrade(t,e):"private.orders.v3.api.pb"===s&&this.handleOrder(t,e),!0}handleMessage(t,e){if("string"==typeof e&&"Invalid listen key"===e){const e=new r.AuthenticationError(this.id+" invalid listen key");return void t.reject(e)}if(this.isBinaryMessage(e))return e=this.decodeProtoMsg(e),void this.handleProtobufMessage(t,e);if("msg"in e)return void this.handleSubscriptionStatus(t,e);const i=this.safeString(e,"c");let s;if(void 0===i)s=this.safeString(e,"channel");else{const t=i.split("@");s=this.safeString(t,1)}const a={"public.deals.v3.api":this.handleTrades,"push.deal":this.handleTrades,"public.kline.v3.api":this.handleOHLCV,"push.kline":this.handleOHLCV,"public.bookTicker.v3.api":this.handleTicker,"public.miniTicker.v3.api":this.handleTicker,"public.miniTickers.v3.api":this.handleTickers,"push.ticker":this.handleTicker,"push.tickers":this.handleTickers,"public.increase.depth.v3.api":this.handleOrderBook,"push.depth":this.handleOrderBook,"private.orders.v3.api":this.handleOrder,"push.personal.order":this.handleOrder,"private.account.v3.api":this.handleBalance,"push.personal.asset":this.handleBalance,"private.deals.v3.api":this.handleMyTrade,"push.personal.order.deal":this.handleMyTrade,pong:this.handlePong};if(s in a){a[s].call(this,t,e)}}ping(t){return{method:"ping"}}}},9332(t,e,i){"use strict";i.d(e,{bT:()=>l,mr:()=>o,wD:()=>c});var s=i(9806),r=(i(7021),i(1291)),a=i.n(r);function n(){return{sender:void 0,recipient:void 0,assetId:0,amount:a().UZERO}}Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const o={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.sender&&s.D.encode(t.sender,e.uint32(10).fork()).ldelim(),void 0!==t.recipient&&s.D.encode(t.recipient,e.uint32(18).fork()).ldelim(),0!==t.assetId&&e.uint32(24).uint32(t.assetId),t.amount.isZero()||e.uint32(32).uint64(t.amount),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=n();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.sender=s.D.decode(i,i.uint32());break;case 2:a.recipient=s.D.decode(i,i.uint32());break;case 3:a.assetId=i.uint32();break;case 4:a.amount=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=n();return e.sender=void 0!==t.sender&&null!==t.sender?s.D.fromPartial(t.sender):void 0,e.recipient=void 0!==t.recipient&&null!==t.recipient?s.D.fromPartial(t.recipient):void 0,e.assetId=t.assetId??0,e.amount=void 0!==t.amount&&null!==t.amount?a().fromValue(t.amount):a().UZERO,e}};function d(){return{sender:"",recipient:void 0,assetId:0,quantums:a().UZERO}}const c={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.sender&&e.uint32(10).string(t.sender),void 0!==t.recipient&&s.D.encode(t.recipient,e.uint32(18).fork()).ldelim(),0!==t.assetId&&e.uint32(24).uint32(t.assetId),t.quantums.isZero()||e.uint32(32).uint64(t.quantums),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=d();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.sender=i.string();break;case 2:a.recipient=s.D.decode(i,i.uint32());break;case 3:a.assetId=i.uint32();break;case 4:a.quantums=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=d();return e.sender=t.sender??"",e.recipient=void 0!==t.recipient&&null!==t.recipient?s.D.fromPartial(t.recipient):void 0,e.assetId=t.assetId??0,e.quantums=void 0!==t.quantums&&null!==t.quantums?a().fromValue(t.quantums):a().UZERO,e}};function h(){return{sender:void 0,recipient:"",assetId:0,quantums:a().UZERO}}const l={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.sender&&s.D.encode(t.sender,e.uint32(18).fork()).ldelim(),""!==t.recipient&&e.uint32(10).string(t.recipient),0!==t.assetId&&e.uint32(24).uint32(t.assetId),t.quantums.isZero()||e.uint32(32).uint64(t.quantums),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a=h();for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 2:a.sender=s.D.decode(i,i.uint32());break;case 1:a.recipient=i.string();break;case 3:a.assetId=i.uint32();break;case 4:a.quantums=i.uint64();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e=h();return e.sender=void 0!==t.sender&&null!==t.sender?s.D.fromPartial(t.sender):void 0,e.recipient=t.recipient??"",e.assetId=t.assetId??0,e.quantums=void 0!==t.quantums&&null!==t.quantums?a().fromValue(t.quantums):a().UZERO,e}}},9344(t,e,i){"use strict";i.d(e,{A:()=>c});var s=i(5277),r=i(2079),a=i(5147),n=i(1579),o=i(4852),d=i(4035);class c extends s.A{describe(){return this.deepExtend(super.describe(),{id:"coinex",name:"CoinEx",version:"v2",countries:["CN"],rateLimit:2.5,pro:!0,certified:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!1,option:!1,addMargin:!0,borrowCrossMargin:!1,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,closeAllPositions:!1,closePosition:!0,createDepositAddress:!0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!1,createMarketSellOrderWithCost:!1,createOrder:!0,createOrders:!0,createReduceOnlyOrder:!0,createStopLossOrder:!0,createStopOrder:!0,createTakeProfitOrder:!0,createTriggerOrder:!0,editOrder:!0,editOrders:!0,fetchBalance:!0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchClosedOrders:!0,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!1,fetchDeposits:!0,fetchDepositWithdrawFee:!0,fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingInterval:!0,fetchFundingIntervals:!1,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchIndexOHLCV:!1,fetchIsolatedBorrowRate:!0,fetchIsolatedBorrowRates:!1,fetchLeverage:!0,fetchLeverages:!1,fetchLeverageTiers:!0,fetchMarginAdjustmentHistory:!0,fetchMarketLeverageTiers:"emulated",fetchMarkets:!0,fetchMarkOHLCV:!1,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchPosition:!0,fetchPositionHistory:!0,fetchPositions:!0,fetchPositionsHistory:!1,fetchPositionsRisk:!1,fetchPremiumIndexOHLCV:!1,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransfer:!1,fetchTransfers:!0,fetchWithdrawal:!1,fetchWithdrawals:!0,reduceMargin:!0,repayCrossMargin:!1,repayIsolatedMargin:!0,setLeverage:!0,setMarginMode:!0,setPositionMode:!1,transfer:!0,withdraw:!0},timeframes:{"1m":"1min","3m":"3min","5m":"5min","15m":"15min","30m":"30min","1h":"1hour","2h":"2hour","4h":"4hour","6h":"6hour","12h":"12hour","1d":"1day","3d":"3day","1w":"1week"},urls:{logo:"https://user-images.githubusercontent.com/51840849/87182089-1e05fa00-c2ec-11ea-8da9-cc73b45abbbc.jpg",api:{public:"https://api.coinex.com",private:"https://api.coinex.com",perpetualPublic:"https://api.coinex.com/perpetual",perpetualPrivate:"https://api.coinex.com/perpetual"},www:"https://www.coinex.com",doc:"https://docs.coinex.com/api/v2",fees:"https://www.coinex.com/fees",referral:"https://www.coinex.com/register?refer_code=yw5fz"},api:{v1:{public:{get:{"amm/market":1,"common/currency/rate":1,"common/asset/config":1,"common/maintain/info":1,"common/temp-maintain/info":1,"margin/market":1,"market/info":1,"market/list":1,"market/ticker":1,"market/ticker/all":1,"market/depth":1,"market/deals":1,"market/kline":1,"market/detail":1}},private:{get:{"account/amm/balance":40,"account/investment/balance":40,"account/balance/history":40,"account/market/fee":40,"balance/coin/deposit":40,"balance/coin/withdraw":40,"balance/info":40,"balance/deposit/address/{coin_type}":40,"contract/transfer/history":40,"credit/info":40,"credit/balance":40,"investment/transfer/history":40,"margin/account":1,"margin/config":1,"margin/loan/history":40,"margin/transfer/history":40,"order/deals":40,"order/finished":40,"order/pending":8,"order/status":8,"order/status/batch":8,"order/user/deals":40,"order/stop/finished":40,"order/stop/pending":8,"order/user/trade/fee":1,"order/market/trade/info":1,"sub_account/balance":1,"sub_account/transfer/history":40,"sub_account/auth/api":40,"sub_account/auth/api/{user_auth_id}":40},post:{"balance/coin/withdraw":40,"contract/balance/transfer":40,"margin/flat":40,"margin/loan":40,"margin/transfer":40,"order/limit/batch":40,"order/ioc":13.334,"order/limit":13.334,"order/market":13.334,"order/modify":13.334,"order/stop/limit":13.334,"order/stop/market":13.334,"order/stop/modify":13.334,"sub_account/transfer":40,"sub_account/register":1,"sub_account/unfrozen":40,"sub_account/frozen":40,"sub_account/auth/api":40},put:{"balance/deposit/address/{coin_type}":40,"sub_account/unfrozen":40,"sub_account/frozen":40,"sub_account/auth/api/{user_auth_id}":40,"v1/account/settings":40},delete:{"balance/coin/withdraw":40,"order/pending/batch":40,"order/pending":13.334,"order/stop/pending":40,"order/stop/pending/{id}":13.334,"order/pending/by_client_id":40,"order/stop/pending/by_client_id":40,"sub_account/auth/api/{user_auth_id}":40,"sub_account/authorize/{id}":40}},perpetualPublic:{get:{ping:1,time:1,"market/list":1,"market/limit_config":1,"market/ticker":1,"market/ticker/all":1,"market/depth":1,"market/deals":1,"market/funding_history":1,"market/kline":1}},perpetualPrivate:{get:{"market/user_deals":1,"asset/query":40,"order/pending":8,"order/finished":40,"order/stop_finished":40,"order/stop_pending":8,"order/status":8,"order/stop_status":8,"position/finished":40,"position/pending":40,"position/funding":40,"position/adl_history":40,"market/preference":40,"position/margin_history":40,"position/settle_history":40},post:{"market/adjust_leverage":1,"market/position_expect":1,"order/put_limit":20,"order/put_market":20,"order/put_stop_limit":20,"order/put_stop_market":20,"order/modify":20,"order/modify_stop":20,"order/cancel":20,"order/cancel_all":40,"order/cancel_batch":40,"order/cancel_stop":20,"order/cancel_stop_all":40,"order/close_limit":20,"order/close_market":20,"position/adjust_margin":20,"position/stop_loss":20,"position/take_profit":20,"position/market_close":20,"order/cancel/by_client_id":20,"order/cancel_stop/by_client_id":20,"market/preference":20}}},v2:{public:{get:{"maintain/info":1,ping:1,time:1,"spot/market":1,"spot/ticker":1,"spot/depth":1,"spot/deals":1,"spot/kline":1,"spot/index":1,"futures/market":1,"futures/ticker":1,"futures/depth":1,"futures/deals":1,"futures/kline":1,"futures/index":1,"futures/funding-rate":1,"futures/funding-rate-history":1,"futures/premium-index-history":1,"futures/position-level":1,"futures/liquidation-history":1,"futures/basis-history":1,"assets/deposit-withdraw-config":1,"assets/all-deposit-withdraw-config":1}},private:{get:{"account/subs":1,"account/subs/api-detail":40,"account/subs/info":1,"account/subs/api":40,"account/subs/transfer-history":40,"account/subs/balance":1,"account/subs/spot-balance":1,"account/trade-fee-rate":40,"account/futures-market-settings":1,"account/info":1,"assets/spot/balance":40,"assets/futures/balance":40,"assets/margin/balance":1,"assets/financial/balance":40,"assets/amm/liquidity":40,"assets/credit/info":40,"assets/spot/transcation-history":1,"assets/margin/borrow-history":40,"assets/margin/interest-limit":1,"assets/deposit-address":40,"assets/deposit-history":40,"assets/withdraw":40,"assets/transfer-history":40,"assets/amm/liquidity-pool":40,"assets/amm/income-history":40,"spot/order-status":8,"spot/batch-order-status":8,"spot/pending-order":8,"spot/finished-order":40,"spot/pending-stop-order":8,"spot/finished-stop-order":40,"spot/user-deals":40,"spot/order-deals":40,"futures/order-status":8,"futures/batch-order-status":1,"futures/pending-order":8,"futures/finished-order":40,"futures/pending-stop-order":8,"futures/finished-stop-order":40,"futures/user-deals":1,"futures/order-deals":1,"futures/pending-position":40,"futures/finished-position":1,"futures/position-margin-history":1,"futures/position-funding-history":40,"futures/position-adl-history":1,"futures/position-settle-history":1,"refer/referee":1,"refer/referee-rebate/record":1,"refer/referee-rebate/detail":1,"refer/agent-referee":1,"refer/agent-rebate/record":1,"refer/agent-rebate/detail":1},post:{"account/subs":40,"account/subs/frozen":40,"account/subs/unfrozen":40,"account/subs/api":40,"account/subs/edit-api":40,"account/subs/delete-api":40,"account/subs/transfer":40,"account/settings":40,"account/futures-market-settings":40,"assets/margin/borrow":40,"assets/margin/repay":40,"assets/renewal-deposit-address":40,"assets/withdraw":40,"assets/cancel-withdraw":40,"assets/transfer":40,"assets/amm/add-liquidity":1,"assets/amm/remove-liquidity":1,"spot/order":13.334,"spot/stop-order":13.334,"spot/batch-order":40,"spot/batch-stop-order":1,"spot/modify-order":13.334,"spot/modify-stop-order":13.334,"spot/batch-modify-order":13.334,"spot/cancel-all-order":1,"spot/cancel-order":6.667,"spot/cancel-stop-order":6.667,"spot/cancel-batch-order":10,"spot/cancel-batch-stop-order":10,"spot/cancel-order-by-client-id":1,"spot/cancel-stop-order-by-client-id":1,"futures/order":20,"futures/stop-order":20,"futures/batch-order":1,"futures/batch-stop-order":1,"futures/modify-order":20,"futures/modify-stop-order":20,"futures/batch-modify-order":20,"futures/cancel-all-order":1,"futures/cancel-order":10,"futures/cancel-stop-order":10,"futures/cancel-batch-order":20,"futures/cancel-batch-stop-order":20,"futures/cancel-order-by-client-id":1,"futures/cancel-stop-order-by-client-id":1,"futures/close-position":20,"futures/adjust-position-margin":20,"futures/adjust-position-leverage":20,"futures/set-position-stop-loss":20,"futures/set-position-take-profit":20}}}},fees:{trading:{maker:.001,taker:.001},funding:{withdraw:{BCH:0,BTC:.001,LTC:.001,ETH:.001,ZEC:1e-4,DASH:1e-4}}},limits:{amount:{min:.001,max:void 0}},options:{brokerId:"x-167673045",createMarketBuyOrderRequiresPrice:!0,defaultType:"spot",defaultSubType:"linear",fetchDepositAddress:{fillResponseFromRequest:!0},accountsByType:{spot:"SPOT",margin:"MARGIN",swap:"FUTURES"},accountsById:{SPOT:"spot",MARGIN:"margin",FUTURES:"swap"},networks:{BTC:"BTC",BEP20:"BSC",TRC20:"TRC20",ERC20:"ERC20",BRC20:"BRC20",SOL:"SOL",TON:"TON",BSV:"BSV",AVAXC:"AVA_C",AVAXX:"AVA",SUI:"SUI",ACA:"ACA",CHZ:"CHILIZ",ADA:"ADA",ARB:"ARBITRUM",ARBNOVA:"ARBITRUM_NOVA",OP:"OPTIMISM",APT:"APTOS",ATOM:"ATOM",FTM:"FTM",BCH:"BCH",ASTR:"ASTR",LTC:"LTC",MATIC:"MATIC",CRONOS:"CRONOS",DASH:"DASH",DOT:"DOT",ETC:"ETC",ETHW:"ETHPOW",FIL:"FIL",ZIL:"ZIL",DOGE:"DOGE",TIA:"CELESTIA",SEI:"SEI",XRP:"XRP",XMR:"XMR"}},features:{spot:{sandbox:!1,createOrder:{marginMode:!0,triggerPrice:!0,triggerPriceType:void 0,triggerDirection:!1,stopLossPrice:!1,takeProfitPrice:!1,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!1,trailing:!1,leverage:!1,marketBuyByCost:!0,marketBuyRequiresPrice:!0,selfTradePrevention:!0,iceberg:!0},createOrders:{max:5},fetchMyTrades:{marginMode:!0,limit:1e3,daysBack:void 0,untilDays:1e5,symbolRequired:!0},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,limit:1e3,trigger:!0,trailing:!1,symbolRequired:!1},fetchOrders:void 0,fetchClosedOrders:{marginMode:!0,limit:1e3,daysBack:void 0,daysBackCanceled:void 0,untilDays:void 0,trigger:!0,trailing:!1,symbolRequired:!1},fetchOHLCV:{limit:1e3}},forDerivatives:{extends:"spot",createOrder:{marginMode:!0,stopLossPrice:!0,takeProfitPrice:!0},fetchOpenOrders:{marginMode:!1},fetchClosedOrders:{marginMode:!1}},swap:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}},future:{linear:void 0,inverse:void 0}},commonCurrencies:{ACM:"Actinium"},precisionMode:n.kb,exceptions:{exact:{23:r.PermissionDenied,24:r.AuthenticationError,25:r.AuthenticationError,34:r.AuthenticationError,35:r.ExchangeNotAvailable,36:r.RequestTimeout,213:r.RateLimitExceeded,107:r.InsufficientFunds,158:r.PermissionDenied,600:r.OrderNotFound,601:r.InvalidOrder,602:r.InvalidOrder,606:r.InvalidOrder,3008:r.RequestTimeout,3109:r.InsufficientFunds,3127:r.InvalidOrder,3600:r.OrderNotFound,3606:r.InvalidOrder,3610:r.ExchangeError,3612:r.InvalidOrder,3613:r.InvalidOrder,3614:r.InvalidOrder,3615:r.InvalidOrder,3616:r.InvalidOrder,3617:r.InvalidOrder,3618:r.InvalidOrder,3619:r.InvalidOrder,3620:r.InvalidOrder,3621:r.InvalidOrder,3622:r.InvalidOrder,3627:r.InvalidOrder,3628:r.InvalidOrder,3629:r.InvalidOrder,3632:r.InvalidOrder,3633:r.InvalidOrder,3634:r.InvalidOrder,3635:r.InvalidOrder,4001:r.ExchangeNotAvailable,4002:r.RequestTimeout,4003:r.ExchangeError,4004:r.BadRequest,4005:r.AuthenticationError,4006:r.AuthenticationError,4007:r.PermissionDenied,4008:r.AuthenticationError,4009:r.ExchangeError,4010:r.ExchangeError,4011:r.PermissionDenied,4017:r.ExchangeError,4115:r.AccountSuspended,4117:r.BadSymbol,4123:r.RateLimitExceeded,4130:r.ExchangeError,4158:r.ExchangeError,4213:r.RateLimitExceeded,4512:r.PermissionDenied},broad:{"ip not allow visit":r.PermissionDenied,"service too busy":r.ExchangeNotAvailable,"Service is not available during funding fee settlement":r.OperationFailed}}})}async fetchCurrencies(t={}){const e=await this.v2PublicGetAssetsAllDepositWithdrawConfig(t),i=this.safeList(e,"data",[]),s={};for(let t=0;t<i.length;t++){const e=i[t],r=this.safeDict(e,"asset",{}),a=this.safeList(e,"chains",[]),n=this.safeString(r,"ccy");if(void 0===n)continue;const o=this.safeCurrencyCode(n),d=this.safeBool(r,"deposit_enabled"),c=this.safeBool(r,"withdraw_enabled"),h=this.safeDict(a,0,{}),l=this.parsePrecision(this.safeString(h,"withdrawal_precision")),u={};for(let t=0;t<a.length;t++){const e=a[t],i=this.safeString(e,"chain"),s=this.networkIdToCode(i,o);if(void 0===i)continue;const r=this.parsePrecision(this.safeString(e,"withdrawal_precision")),n=this.safeString(e,"withdrawal_fee"),d=this.safeString(e,"min_deposit_amount"),c=this.safeString(e,"min_withdraw_amount"),h=this.safeBool(e,"deposit_enabled"),l=this.safeBool(e,"withdraw_enabled"),p={id:i,network:s,name:void 0,active:h&&l,deposit:h,withdraw:l,fee:this.parseNumber(n),precision:this.parseNumber(r),limits:{amount:{min:void 0,max:void 0},deposit:{min:this.parseNumber(d),max:void 0},withdraw:{min:this.parseNumber(c),max:void 0}},info:e};u[s]=p}s[o]=this.safeCurrencyStructure({id:n,code:o,name:void 0,active:d&&c,deposit:d,withdraw:c,fee:void 0,precision:this.parseNumber(l),limits:{amount:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}},networks:u,type:"crypto",info:e})}return s}async fetchMarkets(t={}){const e=[this.fetchSpotMarkets(t),this.fetchContractMarkets(t)],i=await Promise.all(e),s=i[0],r=i[1];return this.arrayConcat(s,r)}async fetchSpotMarkets(t){const e=await this.v2PublicGetSpotMarket(t),i=this.safeList(e,"data",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"market"),a=this.safeString(e,"base_ccy"),n=this.safeString(e,"quote_ccy"),o=this.safeCurrencyCode(a),d=this.safeCurrencyCode(n),c=o+"/"+d;s.push({id:r,symbol:c,base:o,quote:d,settle:void 0,baseId:a,quoteId:n,settleId:void 0,type:"spot",spot:!0,margin:this.safeBool(e,"is_margin_available"),swap:!1,future:!1,option:!1,active:this.safeBool(e,"is_api_trading_available"),contract:!1,linear:void 0,inverse:void 0,taker:this.safeNumber(e,"taker_fee_rate"),maker:this.safeNumber(e,"maker_fee_rate"),contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.parseNumber(this.parsePrecision(this.safeString(e,"base_ccy_precision"))),price:this.parseNumber(this.parsePrecision(this.safeString(e,"quote_ccy_precision")))},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(e,"min_amount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},created:void 0,info:e})}return s}async fetchContractMarkets(t){const e=await this.v2PublicGetFuturesMarket(t),i=this.safeList(e,"data",[]),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.fees,a=this.safeList(e,"leverage",[]),n=this.safeString(e,"contract_type"),o="linear"===n,d="inverse"===n,c=this.safeString(e,"market"),h=this.safeString(e,"base_ccy"),l=this.safeString(e,"quote_ccy"),u=this.safeCurrencyCode(h),p=this.safeCurrencyCode(l),f="linear"===n?"USDT":h,m=this.safeCurrencyCode(f),g=u+"/"+p+":"+m,y=a.length;s.push({id:c,symbol:g,base:u,quote:p,settle:m,baseId:h,quoteId:l,settleId:f,type:"swap",spot:!1,margin:!1,swap:!0,future:!1,option:!1,active:void 0,contract:!0,linear:o,inverse:d,taker:r.trading.taker,maker:r.trading.maker,contractSize:this.parseNumber("1"),expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:this.parseNumber(this.parsePrecision(this.safeString(e,"base_ccy_precision"))),price:this.parseNumber(this.parsePrecision(this.safeString(e,"quote_ccy_precision")))},limits:{leverage:{min:this.safeNumber(a,0),max:this.safeNumber(a,y-1)},amount:{min:this.safeNumber(e,"min_amount"),max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},created:void 0,info:e})}return s}parseTicker(t,e=void 0){const i="mark_price"in t?"swap":"spot",s=this.safeString(t,"market"),r=this.safeSymbol(s,e,void 0,i);return this.safeTicker({symbol:r,timestamp:void 0,datetime:void 0,high:this.safeString(t,"high"),low:this.safeString(t,"low"),bid:void 0,bidVolume:this.safeString(t,"volume_buy"),ask:void 0,askVolume:this.safeString(t,"volume_sell"),vwap:void 0,open:this.safeString(t,"open"),close:this.safeString(t,"close"),last:this.safeString(t,"last"),previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeString(t,"volume"),quoteVolume:void 0,markPrice:this.safeString(t,"mark_price"),indexPrice:this.safeString(t,"index_price"),info:t},e)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={market:i.id};let r;r=i.swap?await this.v2PublicGetFuturesTicker(this.extend(s,e)):await this.v2PublicGetSpotTicker(this.extend(s,e));const a=this.safeList(r,"data",[]),n=this.safeDict(a,0,{});return this.parseTicker(n,i)}async fetchTickers(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t))){const e=this.safeValue(t,0);i=this.market(e)}const[s,r]=this.handleMarketTypeAndParams("fetchTickers",i,e);let a;a="swap"===s?await this.v2PublicGetFuturesTicker(r):await this.v2PublicGetSpotTicker(r);const n=this.safeList(a,"data",[]);return this.parseTickers(n,t)}async fetchTime(t={}){const e=await this.v2PublicGetTime(t),i=this.safeDict(e,"data",{});return this.safeInteger(i,"timestamp")}async fetchOrderBook(t,e=20,i={}){await this.loadMarkets();const s=this.market(t);void 0===e&&(e=20);const r={market:s.id,limit:e,interval:"0"};let a;a=s.swap?await this.v2PublicGetFuturesDepth(this.extend(r,i)):await this.v2PublicGetSpotDepth(this.extend(r,i));const n=this.safeDict(a,"data",{}),o=this.safeDict(n,"depth",{}),d=this.safeInteger(o,"updated_at");return this.parseOrderBook(o,t,d)}parseTrade(t,e=void 0){const i=this.safeInteger(t,"created_at");let s=this.safeString(this.options,"defaultType");void 0!==e&&(s=e.type);const r=this.safeString(t,"market");e=this.safeMarket(r,e,void 0,s);const a=this.safeString(t,"fee");let n;if(void 0!==a){const e=this.safeString(t,"fee_ccy");n={cost:a,currency:this.safeCurrencyCode(e)}}return this.safeTrade({info:t,timestamp:i,datetime:this.iso8601(i),symbol:e.symbol,id:this.safeString(t,"deal_id"),order:this.safeString(t,"order_id"),type:void 0,side:this.safeString(t,"side"),takerOrMaker:this.safeString(t,"role"),price:this.safeString(t,"price"),amount:this.safeString(t,"amount"),cost:this.safeString(t,"deal_money"),fee:n},e)}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),a={market:r.id};let n;return void 0!==i&&(a.limit=i),n=r.swap?await this.v2PublicGetFuturesDeals(this.extend(a,s)):await this.v2PublicGetSpotDeals(this.extend(a,s)),this.parseTrades(n.data,r,e,i)}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={market:i.id};let r;r=i.spot?await this.v2PublicGetSpotMarket(this.extend(s,e)):await this.v2PublicGetFuturesMarket(this.extend(s,e));const a=this.safeList(r,"data",[]),n=this.safeDict(a,0,{});return this.parseTradingFee(n,i)}async fetchTradingFees(t={}){let e,i;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchTradingFees",void 0,t),i="swap"===e?await this.v2PublicGetFuturesMarket(t):await this.v2PublicGetSpotMarket(t);const s=this.safeList(i,"data",[]),r={};for(let t=0;t<s.length;t++){const i=s[t],a=this.safeString(i,"market"),n=this.safeMarket(a,void 0,void 0,e);r[n.symbol]=this.parseTradingFee(i,n)}return r}parseTradingFee(t,e=void 0){const i=this.safeValue(t,"market");return{info:t,symbol:this.safeSymbol(i,e),maker:this.safeNumber(t,"maker_fee_rate"),taker:this.safeNumber(t,"taker_fee_rate"),percentage:!0,tierBased:!0}}parseOHLCV(t,e=void 0){return[this.safeInteger(t,"created_at"),this.safeNumber(t,"open"),this.safeNumber(t,"high"),this.safeNumber(t,"low"),this.safeNumber(t,"close"),this.safeNumber(t,"value")]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t),n={market:a.id,period:this.safeString(this.timeframes,e,e)};let o;void 0!==s&&(n.limit=s),o=a.swap?await this.v2PublicGetFuturesKline(this.extend(n,r)):await this.v2PublicGetSpotKline(this.extend(n,r));const d=this.safeList(o,"data",[]);return this.parseOHLCVs(d,a,e,i,s)}async fetchMarginBalance(t={}){await this.loadMarkets();const e=await this.v2PrivateGetAssetsMarginBalance(t),i={info:e},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeDict(e,"available",{}),n=this.safeDict(e,"frozen",{}),o=this.safeDict(e,"repaid",{}),d=this.safeDict(e,"interest",{}),c=this.account(),h=this.safeString(e,"base_ccy"),l=this.safeCurrencyCode(h);c.free=this.safeString(r,"base_ccy"),c.used=this.safeString(n,"base_ccy");const u=this.safeString(o,"base_ccy"),p=this.safeString(d,"base_ccy");c.debt=a.Y.stringAdd(u,p),i[l]=c}return this.safeBalance(i)}async fetchSpotBalance(t={}){await this.loadMarkets();const e=await this.v2PrivateGetAssetsSpotBalance(t),i={info:e},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeString(e,"ccy"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(e,"available"),n.used=this.safeString(e,"frozen"),i[a]=n}return this.safeBalance(i)}async fetchSwapBalance(t={}){await this.loadMarkets();const e=await this.v2PrivateGetAssetsFuturesBalance(t),i={info:e},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeString(e,"ccy"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(e,"available"),n.used=this.safeString(e,"frozen"),i[a]=n}return this.safeBalance(i)}async fetchFinancialBalance(t={}){await this.loadMarkets();const e=await this.v2PrivateGetAssetsFinancialBalance(t),i={info:e},s=this.safeList(e,"data",[]);for(let t=0;t<s.length;t++){const e=s[t],r=this.safeString(e,"ccy"),a=this.safeCurrencyCode(r),n=this.account();n.free=this.safeString(e,"available"),n.used=this.safeString(e,"frozen"),i[a]=n}return this.safeBalance(i)}async fetchBalance(t={}){let e,i;[e,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t),[i,t]=this.handleMarginModeAndParams("fetchBalance",t);const s=void 0!==i||"margin"===e;return"swap"===e?await this.fetchSwapBalance(t):"financial"===e?await this.fetchFinancialBalance(t):s?await this.fetchMarginBalance(t):await this.fetchSpotBalance(t)}parseOrderStatus(t){return this.safeString({rejected:"rejected",open:"open",not_deal:"open",part_deal:"open",done:"closed",cancel:"canceled"},t,t)}parseOrder(t,e=void 0){const i=this.safeString(t,"status"),s=this.safeInteger(t,"created_at");let r=this.safeInteger(t,"updated_at");0===r&&(r=s);const a=this.safeString(t,"market"),n=this.safeString(this.options,"defaultType");let o=this.safeStringLower(t,"market_type",n);"futures"===o&&(o="swap");const d="swap"===o?"swap":"spot";e=this.safeMarket(a,e,void 0,d);const c=this.safeString(t,"fee_ccy");let h=this.safeCurrencyCode(c);void 0===h&&(h=e.quote);let l=this.safeString(t,"side");"long"===l?l="buy":"short"===l&&(l="sell");let u=this.safeString(t,"client_id");return""===u&&(u=void 0),this.safeOrder({id:this.safeStringN(t,["position_id","order_id","stop_id"]),clientOrderId:u,datetime:this.iso8601(s),timestamp:s,lastTradeTimestamp:r,status:this.parseOrderStatus(i),symbol:e.symbol,type:this.safeString(t,"type"),timeInForce:void 0,postOnly:void 0,reduceOnly:void 0,side:l,price:this.safeString(t,"price"),triggerPrice:this.safeString(t,"trigger_price"),takeProfitPrice:this.safeNumber(t,"take_profit_price"),stopLossPrice:this.safeNumber(t,"stop_loss_price"),cost:this.safeString(t,"filled_value"),average:this.safeString(t,"avg_entry_price"),amount:this.safeString(t,"amount"),filled:this.safeString(t,"filled_amount"),remaining:this.safeString(t,"unfilled_amount"),trades:void 0,fee:{currency:h,cost:this.safeString2(t,"quote_fee","fee")},info:t},e)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");return i.createMarketBuyOrderRequiresPrice=!1,await this.createOrder(t,"market","buy",e,void 0,i)}createOrderRequest(t,e,i,s,n=void 0,o={}){const d=this.market(t),c=d.swap,h=this.safeString2(o,"client_id","clientOrderId"),l=this.safeString2(o,"stopPrice","triggerPrice"),u=this.safeString(o,"stopLossPrice"),p=this.safeString(o,"takeProfitPrice"),f=this.safeString(o,"option"),m="market"===e,g=this.isPostOnly(m,"maker_only"===f,o),y=this.safeStringUpper(o,"timeInForce"),v=this.safeBool(o,"reduceOnly");if(v&&!d.swap)throw new r.InvalidOrder(this.id+" createOrder() does not support reduceOnly for "+d.type+" orders, reduceOnly orders are supported for swap markets only");const b={market:d.id};if(void 0===h){const t="x-167673045",e=this.safeString(this.options,"brokerId",t);b.client_id=e+"-"+this.uuid16()}else b.client_id=h;if(void 0===u&&void 0===p){v||(b.side=i);let s=e;g?s="maker_only":void 0!==y&&("IOC"===y?s="ioc":"FOK"===y&&(s="fok")),m||(b.price=this.priceToPrecision(t,n)),b.type=s}if(c)b.market_type="FUTURES",u||p?u?(b.stop_loss_price=this.priceToPrecision(t,u),b.stop_loss_type=this.safeString(o,"stop_type","latest_price")):p&&(b.take_profit_price=this.priceToPrecision(t,p),b.take_profit_type=this.safeString(o,"stop_type","latest_price")):(b.amount=this.amountToPrecision(t,s),void 0!==l&&(b.trigger_price=this.priceToPrecision(t,l),b.trigger_price_type=this.safeString(o,"stop_type","latest_price")));else{let d;if([d,o]=this.handleMarginModeAndParams("createOrder",o),b.market_type=void 0!==d?"MARGIN":"SPOT","market"===e&&"buy"===i){let e=!0;[e,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0);const i=this.safeNumber(o,"cost");if(o=this.omit(o,"cost"),e){if(void 0===n&&void 0===i)throw new r.InvalidOrder(this.id+" createOrder() requires the price argument for market buy orders to calculate the total cost to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend in the amount argument");{const e=this.numberToString(s),r=this.numberToString(n),o=this.parseToNumeric(a.Y.stringMul(e,r)),d=void 0!==i?i:o;b.amount=this.costToPrecision(t,d)}}else b.amount=this.costToPrecision(t,s)}else b.amount=this.amountToPrecision(t,s);void 0!==l&&(b.trigger_price=this.priceToPrecision(t,l))}return o=this.omit(o,["reduceOnly","timeInForce","postOnly","stopPrice","triggerPrice","stopLossPrice","takeProfitPrice"]),this.extend(b,o)}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets();const n=this.market(t),o=this.safeBool(a,"reduceOnly"),d=void 0!==this.safeString2(a,"stopPrice","triggerPrice"),c=void 0!==this.safeString(a,"stopLossPrice"),h=void 0!==this.safeString(a,"takeProfitPrice"),l=c||h,u=this.createOrderRequest(t,e,i,s,r,a);let p;n.spot?p=d?await this.v2PrivatePostSpotStopOrder(u):await this.v2PrivatePostSpotOrder(u):d?p=await this.v2PrivatePostFuturesStopOrder(u):l?c?p=await this.v2PrivatePostFuturesSetPositionStopLoss(u):h&&(p=await this.v2PrivatePostFuturesSetPositionTakeProfit(u)):p=o?await this.v2PrivatePostFuturesClosePosition(u):await this.v2PrivatePostFuturesOrder(u);const f=this.safeDict(p,"data",{});return this.parseOrder(f,n)}async createOrders(t,e={}){await this.loadMarkets();const i=[];let s,a=!1,n=!1,o=!1;for(let e=0;e<t.length;e++){const d=t[e],c=this.safeString(d,"symbol");if(void 0===s)s=c;else if(s!==c)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const h=this.safeString(d,"type"),l=this.safeString(d,"side"),u=this.safeValue(d,"amount"),p=this.safeValue(d,"price"),f=this.safeValue(d,"params",{});if("limit"!==h)throw new r.NotSupported(this.id+" createOrders() does not support "+h+" orders, only limit orders are accepted");a=this.safeValue(f,"reduceOnly");const m=this.safeNumber2(f,"stopPrice","triggerPrice"),g=this.safeNumber(f,"stopLossPrice"),y=this.safeNumber(f,"takeProfitPrice");n=void 0!==m;o=void 0!==g||void 0!==y;const v=this.createOrderRequest(c,h,l,u,p,f);i.push(v)}const d=this.market(s),c={market:d.id,orders:i};let h;if(d.spot)h=n?await this.v2PrivatePostSpotBatchStopOrder(c):await this.v2PrivatePostSpotBatchOrder(c);else if(n)h=await this.v2PrivatePostFuturesBatchStopOrder(c);else{if(o)throw new r.NotSupported(this.id+" createOrders() does not support stopLossPrice or takeProfitPrice orders");if(a)throw new r.NotSupported(this.id+" createOrders() does not support reduceOnly orders");h=await this.v2PrivatePostFuturesBatchOrder(c)}const l=this.safeList(h,"data",[]),u=[];for(let t=0;t<l.length;t++){const e=l[t];let i;const s=this.safeInteger(e,"code");void 0!==s&&(i=0!==s?"rejected":"open");const r=this.safeDict(e,"data",{});let a;d.spot&&!n?(e.status=i,a=this.parseOrder(e,d)):(r.status=i,a=this.parseOrder(r,d)),u.push(a)}return u}async cancelOrders(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={market:s.id},n=this.safeBool2(i,"stop","trigger");let o;i=this.omit(i,["stop","trigger"]);const d=[];for(let e=0;e<t.length;e++)d.push(parseInt(t[e]));n?a.stop_ids=d:a.order_ids=d,s.spot?o=n?await this.v2PrivatePostSpotCancelBatchStopOrder(this.extend(a,i)):await this.v2PrivatePostSpotCancelBatchOrder(this.extend(a,i)):(a.market_type="FUTURES",o=n?await this.v2PrivatePostFuturesCancelBatchStopOrder(this.extend(a,i)):await this.v2PrivatePostFuturesCancelBatchOrder(this.extend(a,i)));const c=this.safeList(o,"data",[]),h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeDict(e,"data",{}),r=this.parseOrder(i,s);h.push(r)}return h}async editOrder(t,e,i,s,a=void 0,n=void 0,o={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" editOrder() requires a symbol argument");await this.loadMarkets();const d=this.market(e),c={market:d.id};let h;void 0!==a&&(c.amount=this.amountToPrecision(e,a)),void 0!==n&&(c.price=this.priceToPrecision(e,n));const l=this.safeStringN(o,["stopPrice","triggerPrice","trigger_price"]);o=this.omit(o,["stopPrice","triggerPrice"]);const u=void 0!==l;let p;u?(c.trigger_price=this.priceToPrecision(e,l),c.stop_id=this.parseToNumeric(t)):c.order_id=this.parseToNumeric(t),[p,o]=this.handleMarginModeAndParams("editOrder",o),d.spot?(c.market_type=void 0!==p?"MARGIN":"SPOT",h=u?await this.v2PrivatePostSpotModifyStopOrder(this.extend(c,o)):await this.v2PrivatePostSpotModifyOrder(this.extend(c,o))):(c.market_type="FUTURES",h=u?await this.v2PrivatePostFuturesModifyStopOrder(this.extend(c,o)):await this.v2PrivatePostFuturesModifyOrder(this.extend(c,o)));const f=this.safeDict(h,"data",{});return this.parseOrder(f,d)}async editOrders(t,e={}){await this.loadMarkets();const i=[];let s=[];for(let e=0;e<t.length;e++){const r=t[e],a=this.safeString(r,"symbol"),n=this.market(a);s.push(a);const o=this.safeString(r,"id"),d=this.safeValue(r,"amount"),c=this.safeValue(r,"price");let h,l=this.safeDict(r,"params",{});[h,l]=this.handleMarginModeAndParams("editOrders",l);let u="SPOT";n.swap?u="FUTURES":void 0!==h&&(u="MARGIN");const p={order_id:this.parseToNumeric(o),market:n.id,market_type:u};void 0!==d&&(p.amount=this.amountToPrecision(a,d)),void 0!==c&&(p.price=this.priceToPrecision(a,c)),i.push(this.extend(p,l))}s=this.marketSymbols(s,void 0,!1,!0,!0);const a=this.safeString(s,0),n={orders:i};let o;o=this.market(a).spot?await this.v2PrivatePostSpotBatchModifyOrder(this.extend(n,e)):await this.v2PrivatePostFuturesBatchModifyOrder(this.extend(n,e));const d=this.safeList(o,"data",[]),c=[];for(let t=0;t<d.length;t++){const e=d[t],i=this.safeString(e,"code"),s=this.safeString(e,"message");if("0"!==i||"Success"!==s&&"Succeeded"!==s&&"ok"!==s.toLowerCase()&&!d){const t=this.id+" "+s;throw this.throwBroadlyMatchedException(this.exceptions.broad,s,t),this.throwExactlyMatchedException(this.exceptions.exact,i,t),new r.ExchangeError(t)}const a=this.safeDict(e,"data",{}),n=this.parseOrder(a);c.push(n)}return c}async cancelOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a=this.safeBool2(i,"stop","trigger"),n=s.swap,o={market:s.id};let d;[d,i]=this.handleMarginModeAndParams("cancelOrder",i),o.market_type=n?"FUTURES":void 0!==d?"MARGIN":"SPOT";const c=this.safeString2(i,"client_id","clientOrderId");let h,l;if(i=this.omit(i,["stop","trigger","clientOrderId"]),void 0!==c?(o.client_id=c,h=a?n?await this.v2PrivatePostFuturesCancelStopOrderByClientId(this.extend(o,i)):await this.v2PrivatePostSpotCancelStopOrderByClientId(this.extend(o,i)):n?await this.v2PrivatePostFuturesCancelOrderByClientId(this.extend(o,i)):await this.v2PrivatePostSpotCancelOrderByClientId(this.extend(o,i))):a?(o.stop_id=this.parseToNumeric(t),h=n?await this.v2PrivatePostFuturesCancelStopOrder(this.extend(o,i)):await this.v2PrivatePostSpotCancelStopOrder(this.extend(o,i))):(o.order_id=this.parseToNumeric(t),h=n?await this.v2PrivatePostFuturesCancelOrder(this.extend(o,i)):await this.v2PrivatePostSpotCancelOrder(this.extend(o,i))),void 0!==c){const t=this.safeList(h,"data",[]);l=this.safeDict(t[0],"data",{})}else l=this.safeDict(h,"data",{});return this.parseOrder(l,s)}async cancelAllOrders(t=void 0,e={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" cancelAllOrders() requires a symbol argument");await this.loadMarkets();const i=this.market(t),s={market:i.id};let a;if(i.swap)s.market_type="FUTURES",a=await this.v2PrivatePostFuturesCancelAllOrder(this.extend(s,e));else{let t;[t,e]=this.handleMarginModeAndParams("cancelAllOrders",e),s.market_type=void 0!==t?"MARGIN":"SPOT",a=await this.v2PrivatePostSpotCancelAllOrder(this.extend(s,e))}return[this.safeOrder({info:a})]}async fetchOrder(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");await this.loadMarkets();const s=this.market(e),a={market:s.id,order_id:this.parseToNumeric(t)};let n;n=s.swap?await this.v2PrivateGetFuturesOrderStatus(this.extend(a,i)):await this.v2PrivateGetSpotOrderStatus(this.extend(a,i));const o=this.safeDict(n,"data",{});return this.parseOrder(o,s)}async fetchOrdersByStatus(t,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a={};let n;void 0!==e&&(n=this.market(e),a.market=n.id),void 0!==s&&(a.limit=s);const o=this.safeBool2(r,"stop","trigger");let d,c;r=this.omit(r,["stop","trigger"]),[d,r]=this.handleMarketTypeAndParams("fetchOrdersByStatus",n,r);const h="finished"===t||"closed"===t,l="pending"===t||"open"===t;if("swap"===d)a.market_type="FUTURES",h?c=o?await this.v2PrivateGetFuturesFinishedStopOrder(this.extend(a,r)):await this.v2PrivateGetFuturesFinishedOrder(this.extend(a,r)):l&&(c=o?await this.v2PrivateGetFuturesPendingStopOrder(this.extend(a,r)):await this.v2PrivateGetFuturesPendingOrder(this.extend(a,r)));else{let e;[e,r]=this.handleMarginModeAndParams("fetchOrdersByStatus",r),a.market_type=void 0!==e?"MARGIN":"SPOT",h?c=o?await this.v2PrivateGetSpotFinishedStopOrder(this.extend(a,r)):await this.v2PrivateGetSpotFinishedOrder(this.extend(a,r)):"pending"===t&&(c=o?await this.v2PrivateGetSpotPendingStopOrder(this.extend(a,r)):await this.v2PrivateGetSpotPendingOrder(this.extend(a,r)))}const u=this.safeList(c,"data",[]);return this.parseOrders(u,n,i,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){const r=await this.fetchOrdersByStatus("pending",t,e,i,s);for(let t=0;t<r.length;t++)r[t].status="open";return r}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByStatus("finished",t,e,i,s)}async createDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s=this.safeString2(e,"chain","network");if(void 0===s)throw new r.ArgumentsRequired(this.id+" createDepositAddress() requires a network parameter");e=this.omit(e,"network");const a={ccy:i.id,chain:this.networkCodeToId(s,i.code)},n=await this.v2PrivatePostAssetsRenewalDepositAddress(this.extend(a,e)),o=this.safeDict(n,"data",{});return this.parseDepositAddress(o,i)}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),s={ccy:i.id};let a;if([a,e]=this.handleNetworkCodeAndParams(e),void 0===a)throw new r.ArgumentsRequired(this.id+' fetchDepositAddress() requires a "network" parameter');s.chain=this.networkCodeToId(a);const n=await this.v2PrivateGetAssetsDepositAddress(this.extend(s,e)),o=this.safeDict(n,"data",{});return this.parseDepositAddress(o,i)}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"address"),s=i.split(":");let r,a;return s.length>1&&"cfx"!==s[0]?(r=s[0],a=s[1]):r=i,{info:t,currency:this.safeCurrencyCode(void 0,e),network:void 0,address:r,tag:this.safeString(t,"memo",a)}}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n,o={market:a.id};if(void 0!==i&&(o.limit=i),void 0!==e&&(o.start_time=e),[o,s]=this.handleUntilOption("end_time",o,s),a.swap)o.market_type="FUTURES",n=await this.v2PrivateGetFuturesUserDeals(this.extend(o,s));else{let t;[t,s]=this.handleMarginModeAndParams("fetchMyTrades",s),o.market_type=void 0!==t?"MARGIN":"SPOT",n=await this.v2PrivateGetSpotUserDeals(this.extend(o,s))}const d=this.safeList(n,"data",[]);return this.parseTrades(d,a,e,i)}async fetchPositions(t=void 0,e={}){let i;await this.loadMarkets(),[i,e]=this.handleOptionAndParams(e,"fetchPositions","method","v2PrivateGetFuturesPendingPosition");const s={market_type:"FUTURES"};let a,n;if(void 0!==(t=this.marketSymbols(t))){let e;if(Array.isArray(t)){if(t.length>1)throw new r.BadRequest(this.id+" fetchPositions() symbols argument cannot contain more than 1 symbol");e=t[0]}else e=t;a=this.market(e),s.market=a.id}n="v2PrivateGetFuturesPendingPosition"===i?await this.v2PrivateGetFuturesPendingPosition(this.extend(s,e)):await this.v2PrivateGetFuturesFinishedPosition(this.extend(s,e));const o=this.safeList(n,"data",[]),d=[];for(let t=0;t<o.length;t++)d.push(this.parsePosition(o[t],a));return this.filterByArrayPositions(d,"symbol",t,!1)}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t),s={market_type:"FUTURES",market:i.id},r=await this.v2PrivateGetFuturesPendingPosition(this.extend(s,e)),a=this.safeList(r,"data",[]);return this.parsePosition(a[0],i)}parsePosition(t,e=void 0){const i=this.safeString(t,"market");e=this.safeMarket(i,e,void 0,"swap");const s=this.safeInteger(t,"created_at");return this.safePosition({info:t,id:this.safeInteger(t,"position_id"),symbol:e.symbol,notional:this.safeNumber(t,"settle_value"),marginMode:this.safeString(t,"margin_mode"),liquidationPrice:this.safeNumber(t,"liq_price"),entryPrice:this.safeNumber(t,"avg_entry_price"),unrealizedPnl:this.safeNumber(t,"unrealized_pnl"),realizedPnl:this.safeNumber(t,"realized_pnl"),percentage:void 0,contracts:this.safeNumber(t,"close_avbl"),contractSize:this.safeNumber(e,"contractSize"),markPrice:void 0,lastPrice:void 0,side:this.safeString(t,"side"),hedged:void 0,timestamp:s,datetime:this.iso8601(s),lastUpdateTimestamp:this.safeInteger(t,"updated_at"),maintenanceMargin:this.safeNumber(t,"maintenance_margin_value"),maintenanceMarginPercentage:this.safeNumber(t,"maintenance_margin_rate"),collateral:this.safeNumber(t,"margin_avbl"),initialMargin:void 0,initialMarginPercentage:void 0,leverage:this.safeNumber(t,"leverage"),marginRatio:this.safeNumber(t,"position_margin_rate"),stopLossPrice:this.omitZero(this.safeString(t,"stop_loss_price")),takeProfitPrice:this.omitZero(this.safeString(t,"take_profit_price"))})}async setMarginMode(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a symbol argument");if("isolated"!==(t=t.toLowerCase())&&"cross"!==t)throw new r.BadRequest(this.id+" setMarginMode() marginMode argument should be isolated or cross");await this.loadMarkets();const s=this.market(e);if("swap"!==s.type)throw new r.BadSymbol(this.id+" setMarginMode() supports swap contracts only");const a=this.safeInteger(i,"leverage"),n=this.safeInteger(s.limits.leverage,"max",100);if(void 0===a)throw new r.ArgumentsRequired(this.id+" setMarginMode() requires a leverage parameter");if(a<1||a>n)throw new r.BadRequest(this.id+" setMarginMode() leverage should be between 1 and "+n.toString()+" for "+e);const o={market:s.id,market_type:"FUTURES",margin_mode:t,leverage:a};return await this.v2PrivatePostFuturesAdjustPositionLeverage(this.extend(o,i))}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");await this.loadMarkets();const s=this.market(e);if(!s.swap)throw new r.BadSymbol(this.id+" setLeverage() supports swap contracts only");let a;[a,i]=this.handleMarginModeAndParams("setLeverage",i,"cross");const n=this.safeInteger(s.limits.leverage,"min",1),o=this.safeInteger(s.limits.leverage,"max",100);if(t<n||t>o)throw new r.BadRequest(this.id+" setLeverage() leverage should be between "+n.toString()+" and "+o.toString()+" for "+e);const d={market:s.id,market_type:"FUTURES",margin_mode:a,leverage:t};return await this.v2PrivatePostFuturesAdjustPositionLeverage(this.extend(d,i))}async fetchLeverageTiers(t=void 0,e={}){await this.loadMarkets();const i={};if(void 0!==t){const e=this.marketIds(t);i.market=e.join(",")}const s=await this.v2PublicGetFuturesPositionLevel(this.extend(i,e)),r=this.safeList(s,"data",[]);return this.parseLeverageTiers(r,t,"market")}parseMarketLeverageTiers(t,e=void 0){const i=[],s=this.safeList(t,"level",[]);let r=0;for(let a=0;a<s.length;a++){const n=s[a],o=this.safeString(t,"market");e=this.safeMarket(o,e,void 0,"swap");const d=this.safeNumber(n,"amount");i.push({tier:this.sum(a,1),symbol:this.safeSymbol(o,e,void 0,"swap"),currency:e.linear?e.base:e.quote,minNotional:r,maxNotional:d,maintenanceMarginRate:this.safeNumber(n,"maintenance_margin_rate"),maxLeverage:this.safeInteger(n,"leverage"),info:n}),r=d}return i}async modifyMarginHelper(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),n=this.amountToPrecision(t,e);let o=n;"reduce"===i&&(o=a.Y.stringNeg(n));const d={market:r.id,market_type:"FUTURES",amount:o},c=await this.v2PrivatePostFuturesAdjustPositionMargin(this.extend(d,s)),h=this.safeDict(c,"data"),l=this.safeStringLower(c,"message"),u="reduce"===i?"reduce":"add";return this.extend(this.parseMarginModification(h,r),{type:u,amount:this.parseNumber(e),status:l})}parseMarginModification(t,e=void 0){const i=this.safeString(t,"market"),s=this.safeInteger2(t,"updated_at","created_at"),r=this.safeString(t,"margin_change");return{info:t,symbol:this.safeSymbol(i,e,void 0,"swap"),type:void 0,marginMode:"isolated",amount:this.parseNumber(a.Y.stringAbs(r)),total:this.safeNumber(t,"margin_avbl"),code:e.quote,status:void 0,timestamp:s,datetime:this.iso8601(s)}}async addMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"add",i)}async reduceMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,"reduce",i)}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingHistory() requires a symbol argument");await this.loadMarkets();let a={market:this.market(t).id,market_type:"FUTURES"};[a,s]=this.handleUntilOption("end_time",a,s),void 0!==e&&(a.start_time=e),void 0!==i&&(a.limit=i);const n=await this.v2PrivateGetFuturesPositionFundingHistory(this.extend(a,s)),o=this.safeList(n,"data",[]),d=[];for(let e=0;e<o.length;e++){const i=o[e],s=this.safeInteger(i,"created_at"),r=this.safeString(i,"ccy"),a=this.safeCurrencyCode(r);d.push({info:i,symbol:t,code:a,timestamp:s,datetime:this.iso8601(s),id:this.safeNumber(i,"position_id"),amount:this.safeNumber(i,"funding_value")})}return d}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.swap)throw new r.BadSymbol(this.id+" fetchFundingRate() supports swap contracts only");const s={market:i.id},a=await this.v2PublicGetFuturesFundingRate(this.extend(s,e)),n=this.safeList(a,"data",[]),o=this.safeDict(n,0,{});return this.parseFundingRate(o,i)}async fetchFundingInterval(t,e={}){return await this.fetchFundingRate(t,e)}parseFundingRate(t,e=void 0){const i=this.safeInteger(t,"latest_funding_time"),s=this.safeInteger(t,"next_funding_time"),r=this.safeString(t,"latest_funding_time"),n=this.safeString(t,"next_funding_time"),o=a.Y.stringSub(n,r),d=this.safeString(t,"market");return{info:t,symbol:this.safeSymbol(d,e,void 0,"swap"),markPrice:this.safeNumber(t,"mark_price"),indexPrice:void 0,interestRate:void 0,estimatedSettlePrice:void 0,timestamp:void 0,datetime:void 0,fundingRate:this.safeNumber(t,"latest_funding_rate"),fundingTimestamp:i,fundingDatetime:this.iso8601(i),nextFundingRate:this.safeNumber(t,"next_funding_rate"),nextFundingTimestamp:s,nextFundingDatetime:this.iso8601(s),previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:this.parseFundingInterval(o)}}parseFundingInterval(t){return this.safeString({36e5:"1h",144e5:"4h",288e5:"8h",576e5:"16h",864e5:"24h"},t,t)}async fetchFundingRates(t=void 0,e={}){await this.loadMarkets();const i={};let s;if(void 0!==(t=this.marketSymbols(t))){const e=this.safeValue(t,0);if(s=this.market(e),!s.swap)throw new r.BadSymbol(this.id+" fetchFundingRates() supports swap contracts only");const a=this.marketIds(t);i.market=a.join(",")}const a=await this.v2PublicGetFuturesFundingRate(this.extend(i,e)),n=this.safeList(a,"data",[]);return this.parseFundingRates(n,t)}async withdraw(t,e,i,s=void 0,r={}){[s,r]=this.handleWithdrawTagAndParams(s,r),this.checkAddress(i),await this.loadMarkets();const a=this.currency(t),n={ccy:a.id,to_address:i,amount:this.currencyToPrecision(t,e)};let o;void 0!==s&&(n.memo=s),[o,r]=this.handleNetworkCodeAndParams(r),void 0!==o&&(n.chain=this.networkCodeToId(o));const d=await this.v2PrivatePostAssetsWithdraw(this.extend(n,r)),c=this.safeDict(d,"data",{});return this.parseTransaction(c,a)}parseTransactionStatus(t){return this.safeString({audit:"pending",pass:"pending",audit_required:"pending",processing:"pending",confirming:"pending",not_pass:"failed",cancel:"canceled",finish:"ok",finished:"ok",fail:"failed"},t,t)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),a)return await this.fetchPaginatedCallDeterministic("fetchFundingRateHistory",t,e,i,"8h",s,1e3);const n=this.market(t);let o={market:n.id};void 0!==e&&(o.start_time=e),void 0!==i&&(o.limit=i),[o,s]=this.handleUntilOption("end_time",o,s);const d=await this.v2PublicGetFuturesFundingRateHistory(this.extend(o,s)),c=this.safeList(d,"data",[]),h=[];for(let t=0;t<c.length;t++){const e=c[t],i=this.safeString(e,"market"),s=this.safeSymbol(i,n,void 0,"swap"),r=this.safeInteger(e,"funding_time");h.push({info:e,symbol:s,fundingRate:this.safeNumber(e,"actual_funding_rate"),timestamp:r,datetime:this.iso8601(r)})}const l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,n.symbol,e,i)}parseTransaction(t,e=void 0){const i=this.safeString(t,"to_address");let s=this.safeString(t,"memo");void 0!==s&&s.length<1&&(s=void 0);let r=this.safeString(t,"remark");void 0!==r&&r.length<1&&(r=void 0);let a=this.safeString(t,"tx_id");void 0!==a&&a.length<1&&(a=void 0);const n=this.safeString(t,"ccy"),o=this.safeCurrencyCode(n,e),d=this.safeInteger(t,"created_at"),c="withdraw_id"in t?"withdrawal":"deposit",h=this.safeString(t,"chain");let l=this.safeString(t,"tx_fee");const u="local"===this.safeStringLower2(t,"withdraw_method","deposit_method");let p=this.safeNumber(t,"actual_amount");void 0===p&&(p=this.safeNumber(t,"amount")),"deposit"===c&&(l="0");const f=this.safeString(t,"fee_asset"),m={cost:this.parseNumber(l),currency:this.safeCurrencyCode(f)};return{info:t,id:this.safeString2(t,"withdraw_id","deposit_id"),txid:a,timestamp:d,datetime:this.iso8601(d),network:this.networkIdToCode(h),address:i,addressTo:i,addressFrom:void 0,tag:s,tagTo:void 0,tagFrom:void 0,type:c,amount:p,currency:o,status:this.parseTransactionStatus(this.safeString(t,"status")),updated:void 0,fee:m,comment:r,internal:u}}async transfer(t,e,i,s,a={}){await this.loadMarkets();const n=this.currency(t),o=this.currencyToPrecision(t,e),d=this.safeDict(this.options,"accountsByType",{}),c=this.safeString(d,i,i),h=this.safeString(d,s,s),l={ccy:n.id,amount:o,from_account_type:c,to_account_type:h};if("margin"===i||"margin"===s){const t=this.safeString(a,"symbol");if(void 0===t)throw new r.ArgumentsRequired(this.id+" transfer() the symbol parameter must be defined for a margin account");a=this.omit(a,"symbol"),l.market=this.marketId(t)}if("spot"!==i&&"spot"!==s)throw new r.BadRequest(this.id+" transfer() can only be between spot and swap, or spot and margin, either the fromAccount or toAccount must be spot");const u=await this.v2PrivatePostAssetsTransfer(this.extend(l,a));return this.extend(this.parseTransfer(u,n),{amount:this.parseNumber(o),fromAccount:i,toAccount:s})}parseTransferStatus(t){return this.safeString({0:"ok",SUCCESS:"ok",OK:"ok",finished:"ok",FINISHED:"ok"},t,t)}parseTransfer(t,e=void 0){const i=this.safeInteger(t,"created_at"),s=this.safeString(t,"ccy"),r=this.safeString(t,"from_account_type"),a=this.safeString(t,"to_account_type"),n=this.safeValue(this.options,"accountsById",{});return{id:void 0,timestamp:i,datetime:this.iso8601(i),currency:this.safeCurrencyCode(s,e),amount:this.safeNumber(t,"amount"),fromAccount:this.safeString(n,r,r),toAccount:this.safeString(n,a,a),status:this.parseTransferStatus(this.safeString2(t,"code","status"))}}async fetchTransfers(t=void 0,e=void 0,i=void 0,s={}){if(await this.loadMarkets(),void 0===t)throw new r.ArgumentsRequired(this.id+" fetchTransfers() requires a code argument");const a=this.currency(t);let n,o={ccy:a.id};[n,s]=this.handleMarginModeAndParams("fetchTransfers",s),o.transfer_type=void 0!==n?"MARGIN":"FUTURES",void 0!==e&&(o.start_time=e),void 0!==i&&(o.limit=i),[o,s]=this.handleUntilOption("end_time",o,s);const d=await this.v2PrivateGetAssetsTransferHistory(this.extend(o,s)),c=this.safeList(d,"data",[]);return this.parseTransfers(c,a,e,i)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};let a;void 0!==t&&(a=this.currency(t),r.ccy=a.id),void 0!==i&&(r.limit=i);const n=await this.v2PrivateGetAssetsWithdraw(this.extend(r,s)),o=this.safeList(n,"data",[]);return this.parseTransactions(o,a,e,i)}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r={};let a;void 0!==t&&(a=this.currency(t),r.ccy=a.id),void 0!==i&&(r.limit=i);const n=await this.v2PrivateGetAssetsDepositHistory(this.extend(r,s)),o=this.safeList(n,"data",[]);return this.parseTransactions(o,a,e,i)}parseIsolatedBorrowRate(t,e=void 0){const i=this.safeString(t,"market");e=this.safeMarket(i,e,void 0,"spot");const s=this.safeString(t,"ccy"),r=this.safeNumber(t,"daily_interest_rate");let a,n;return s===e.baseId?a=r:s===e.quoteId&&(n=r),{symbol:e.symbol,base:e.base,baseRate:a,quote:e.quote,quoteRate:n,period:864e5,timestamp:void 0,datetime:void 0,info:t}}async fetchIsolatedBorrowRate(t,e={}){await this.loadMarkets();const i=this.safeString(e,"code");if(void 0===i)throw new r.ArgumentsRequired(this.id+" fetchIsolatedBorrowRate() requires a code parameter");e=this.omit(e,"code");const s=this.currency(i),a=this.market(t),n={market:a.id,ccy:s.id},o=await this.v2PrivateGetAssetsMarginInterestLimit(this.extend(n,e)),d=this.safeDict(o,"data",{});return this.parseIsolatedBorrowRate(d,a)}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a={};let n;void 0!==e&&(n=this.market(e),a.market=n.id),void 0!==s&&(a.limit=s);const o=await this.v2PrivateGetAssetsMarginBorrowHistory(this.extend(a,r)),d=this.safeValue(o,"data",[]),c=this.parseBorrowInterests(d,n);return this.filterByCurrencySinceLimit(c,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"market");e=this.safeMarket(i,e,void 0,"spot");const s=this.safeInteger(t,"expired_at");return{info:t,symbol:e.symbol,currency:this.safeCurrencyCode(this.safeString(t,"ccy")),interest:this.safeNumber(t,"to_repaied_amount"),interestRate:this.safeNumber(t,"daily_interest_rate"),amountBorrowed:this.safeNumber(t,"borrow_amount"),marginMode:"isolated",timestamp:s,datetime:this.iso8601(s)}}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a=this.currency(e),n=this.safeBool2(s,"isAutoRenew","is_auto_renew",!1);s=this.omit(s,"isAutoRenew");const o={market:r.id,ccy:a.id,borrow_amount:this.currencyToPrecision(e,i),is_auto_renew:n},d=await this.v2PrivatePostAssetsMarginBorrow(this.extend(o,s)),c=this.safeDict(d,"data",{}),h=this.parseMarginLoan(c,a);return this.extend(h,{amount:i,symbol:t})}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.market(t),a=this.currency(e),n={market:r.id,ccy:a.id,amount:this.currencyToPrecision(e,i)},o=await this.v2PrivatePostAssetsMarginRepay(this.extend(n,s)),d=this.safeDict(o,"data",{}),c=this.parseMarginLoan(d,a);return this.extend(c,{amount:i,symbol:t})}parseMarginLoan(t,e=void 0){const i=this.safeString(t,"ccy"),s=this.safeString(t,"market"),r=this.safeInteger(t,"expired_at");return{id:this.safeInteger(t,"borrow_id"),currency:this.safeCurrencyCode(i,e),amount:this.safeString(t,"borrow_amount"),symbol:this.safeSymbol(s,void 0,void 0,"spot"),timestamp:r,datetime:this.iso8601(r),info:t}}async fetchDepositWithdrawFee(t,e={}){await this.loadMarkets();const i=this.currency(t),s={ccy:i.id},r=await this.v2PublicGetAssetsDepositWithdrawConfig(this.extend(s,e)),a=this.safeDict(r,"data",{});return this.parseDepositWithdrawFee(a,i)}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.v2PublicGetAssetsAllDepositWithdrawConfig(e),s=this.safeList(i,"data",[]),r={};for(let e=0;e<s.length;e++){const i=s[e],a=this.safeDict(i,"asset",{}),n=this.safeString(a,"ccy");if(void 0===n)continue;const o=this.safeCurrencyCode(n);(void 0===t||this.inArray(o,t))&&(r[o]=this.parseDepositWithdrawFee(i))}return r}parseDepositWithdrawFee(t,e=void 0){const i={info:t,withdraw:{fee:void 0,percentage:void 0},deposit:{fee:void 0,percentage:void 0},networks:{}},s=this.safeList(t,"chains",[]),r=this.safeDict(t,"asset",{});for(let t=0;t<s.length;t++){const e=s[t];if(this.safeBool(e,"withdraw_enabled")){i.withdraw.fee=this.safeNumber(e,"withdrawal_fee"),i.withdraw.percentage=!1;const t=this.safeString(e,"chain");if(t){const s=this.networkIdToCode(t,this.safeString(r,"ccy"));i.networks[s]={withdraw:{fee:this.safeNumber(e,"withdrawal_fee"),percentage:!1},deposit:{fee:void 0,percentage:void 0}}}}}return i}async fetchLeverage(t,e={}){await this.loadMarkets();const i=this.safeString(e,"code");if(void 0===i)throw new r.ArgumentsRequired(this.id+" fetchLeverage() requires a code parameter");e=this.omit(e,"code");const s=this.currency(i),a=this.market(t),n={market:a.id,ccy:s.id},o=await this.v2PrivateGetAssetsMarginInterestLimit(this.extend(n,e)),d=this.safeDict(o,"data",{});return this.parseLeverage(d,a)}parseLeverage(t,e=void 0){const i=this.safeString(t,"market"),s=this.safeInteger(t,"leverage");return{info:t,symbol:this.safeSymbol(i,e,void 0,"spot"),marginMode:"isolated",longLeverage:s,shortLeverage:s}}async fetchPositionHistory(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r={market_type:"FUTURES",market:this.market(t).id};void 0!==i&&(r.limit=i),void 0!==e&&(r.start_time=e),[r,s]=this.handleUntilOption("end_time",r,s);const a=await this.v2PrivateGetFuturesFinishedPosition(this.extend(r,s)),n=this.safeList(a,"data",[]),o=this.parsePositions(n);return this.filterBySymbolSinceLimit(o,t,e,i)}async closePosition(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r=this.safeString(i,"type","market"),a={market:s.id,market_type:"FUTURES",type:r},n=this.safeString2(i,"client_id","clientOrderId");void 0!==n&&(a.client_id=n),i=this.omit(i,"clientOrderId");const o=await this.v2PrivatePostFuturesClosePosition(this.extend(a,i)),d=this.safeDict(o,"data",{});return this.parseOrder(d,s)}handleMarginModeAndParams(t,e={},i=void 0){const s=this.safeString(this.options,"defaultType"),r=this.safeBool(e,"margin",!1);let a;return[a,e]=super.handleMarginModeAndParams(t,e,i),void 0===a&&("margin"!==s&&!0!==r||(a="isolated")),[a,e]}nonce(){return this.milliseconds()}sign(t,e=[],i="GET",s={},r=void 0,a=void 0){t=this.implodeParams(t,s);const n=e[0],c=e[1];let h=this.urls.api[c]+"/"+n+"/"+t,l=this.omit(s,this.extractParams(t));const u=this.nonce().toString();if("POST"===i){const e=t.split("/"),i=this.safeString(e,0,""),r=e.length,a=this.safeString(e,r-1,"").split("_"),n=a.length,o=this.safeString(a,n-1,"");if("order"===i&&("limit"===o||"market"===o)){if(void 0===this.safeString(s,"client_id")){const t="x-167673045",e=this.safeValue(this.options,"brokerId",t);l.client_id=e+"_"+this.uuid16()}}}if("perpetualPrivate"===c){this.checkRequiredCredentials(),l=this.extend({access_id:this.apiKey,timestamp:u},l),l=this.keysort(l);const t=this.rawencode(l);r={Authorization:this.hash(this.encode(t+"&secret_key="+this.secret),o.s).toLowerCase(),AccessId:this.apiKey},"GET"===i||"PUT"===i?h+="?"+t:(r["Content-Type"]="application/x-www-form-urlencoded",a=t)}else if("public"===c||"perpetualPublic"===c)Object.keys(l).length&&(h+="?"+this.urlencode(l));else if("v1"===n){this.checkRequiredCredentials(),l=this.extend({access_id:this.apiKey,tonce:u},l),l=this.keysort(l);const t=this.rawencode(l);r={Authorization:this.hash(this.encode(t+"&secret_key="+this.secret),d.F).toUpperCase(),"Content-Type":"application/json"},"GET"===i||"DELETE"===i||"PUT"===i?h+="?"+t:a=this.json(l)}else if("v2"===n){this.checkRequiredCredentials(),l=this.keysort(l);const e=this.rawencode(l);let s=i+"/"+n+"/"+t;"POST"===i?s+=a=this.json(l):e&&(s+="?"+e),s+=u+this.secret;const d=this.hash(this.encode(s),o.s);r={"Content-Type":"application/json",Accept:"application/json","X-COINEX-KEY":this.apiKey,"X-COINEX-SIGN":d,"X-COINEX-TIMESTAMP":u},"POST"!==i&&e&&(h+="?"+e)}return{url:h,method:i,body:a,headers:r}}handleErrors(t,e,i,s,a,n,o,d,c){if(void 0===o)return;const h=this.safeString(o,"code"),l=this.safeValue(o,"data"),u=this.safeString(o,"message");if("0"!==h||"Success"!==u&&"Succeeded"!==u&&"ok"!==u.toLowerCase()&&!l){const t=this.id+" "+u;throw this.throwBroadlyMatchedException(this.exceptions.broad,u,t),this.throwExactlyMatchedException(this.exceptions.exact,h,t),new r.ExchangeError(t)}}async fetchMarginAdjustmentHistory(t=void 0,e=void 0,i=void 0,s=void 0,a={}){if(await this.loadMarkets(),void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMarginAdjustmentHistory() requires a symbol argument");const n=this.safeInteger2(a,"positionId","position_id");if(a=this.omit(a,"positionId"),void 0===n)throw new r.ArgumentsRequired(this.id+" fetchMarginAdjustmentHistory() requires a positionId parameter");let o={market:this.market(t).id,market_type:"FUTURES",position_id:n};[o,a]=this.handleUntilOption("end_time",o,a),void 0!==i&&(o.start_time=i),void 0!==s&&(o.limit=s);const d=await this.v2PrivateGetFuturesPositionMarginHistory(this.extend(o,a)),c=this.safeList(d,"data",[]),h=this.parseMarginModifications(c,void 0,"market","swap");return this.filterBySymbolSinceLimit(h,t,i,s)}}},9403(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(7418),r=i(5147),a=i(1579),n=i(2079),o=i(7481);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"gate",name:"Gate",countries:["KR"],rateLimit:50,version:"v4",certified:!0,pro:!0,urls:{logo:"https://github.com/user-attachments/assets/64f988c5-07b6-4652-b5c1-679a6bf67c85",doc:"https://www.gate.com/docs/developers/apiv4/en/",www:"https://gate.com",api:{public:{wallet:"https://api.gateio.ws/api/v4",futures:"https://api.gateio.ws/api/v4",margin:"https://api.gateio.ws/api/v4",delivery:"https://api.gateio.ws/api/v4",spot:"https://api.gateio.ws/api/v4",options:"https://api.gateio.ws/api/v4",sub_accounts:"https://api.gateio.ws/api/v4",earn:"https://api.gateio.ws/api/v4"},private:{withdrawals:"https://api.gateio.ws/api/v4",wallet:"https://api.gateio.ws/api/v4",futures:"https://api.gateio.ws/api/v4",margin:"https://api.gateio.ws/api/v4",delivery:"https://api.gateio.ws/api/v4",spot:"https://api.gateio.ws/api/v4",options:"https://api.gateio.ws/api/v4",subAccounts:"https://api.gateio.ws/api/v4",unified:"https://api.gateio.ws/api/v4",rebate:"https://api.gateio.ws/api/v4",earn:"https://api.gateio.ws/api/v4",account:"https://api.gateio.ws/api/v4",loan:"https://api.gateio.ws/api/v4"}},test:{public:{futures:"https://api-testnet.gateapi.io/api/v4",delivery:"https://api-testnet.gateapi.io/api/v4",options:"https://api-testnet.gateapi.io/api/v4",spot:"https://api-testnet.gateapi.io/api/v4",wallet:"https://api-testnet.gateapi.io/api/v4",margin:"https://api-testnet.gateapi.io/api/v4",sub_accounts:"https://api-testnet.gateapi.io/api/v4",account:"https://api-testnet.gateapi.io/api/v4"},private:{futures:"https://api-testnet.gateapi.io/api/v4",delivery:"https://api-testnet.gateapi.io/api/v4",options:"https://api-testnet.gateapi.io/api/v4",spot:"https://api-testnet.gateapi.io/api/v4",wallet:"https://api-testnet.gateapi.io/api/v4",margin:"https://api-testnet.gateapi.io/api/v4",sub_accounts:"https://api-testnet.gateapi.io/api/v4",account:"https://api-testnet.gateapi.io/api/v4"}},referral:{url:"https://www.gate.com/share/CCXTGATE",discount:.2}},has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!0,option:!0,addMargin:!0,borrowCrossMargin:!0,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelOrder:!0,cancelOrders:!0,cancelOrdersForSymbols:!0,createMarketBuyOrderWithCost:!0,createMarketOrder:!0,createMarketOrderWithCost:!1,createMarketSellOrderWithCost:!1,createOrder:!0,createOrders:!0,createPostOnlyOrder:!0,createReduceOnlyOrder:!0,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!1,createStopOrder:!0,createTakeProfitOrder:!0,createTriggerOrder:!0,editOrder:!0,fetchBalance:!0,fetchBorrowInterest:!0,fetchBorrowRateHistories:!1,fetchBorrowRateHistory:!1,fetchClosedOrders:!0,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDepositAddress:!0,fetchDepositAddresses:!1,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchGreeks:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!1,fetchLedger:!0,fetchLeverage:!0,fetchLeverages:!0,fetchLeverageTiers:!0,fetchLiquidations:!0,fetchMarginAdjustmentHistory:!1,fetchMarginMode:!1,fetchMarketLeverageTiers:!0,fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMyLiquidations:!0,fetchMySettlementHistory:!0,fetchMyTrades:!0,fetchNetworkDepositAddress:!0,fetchOHLCV:!0,fetchOpenInterest:!1,fetchOpenInterestHistory:!0,fetchOpenOrders:!0,fetchOption:!0,fetchOptionChain:!0,fetchOrder:!0,fetchOrderBook:!0,fetchPosition:!0,fetchPositionHistory:"emulated",fetchPositionMode:!1,fetchPositions:!0,fetchPositionsHistory:!0,fetchPremiumIndexOHLCV:!1,fetchSettlementHistory:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!0,fetchTransactionFees:!0,fetchUnderlyingAssets:!0,fetchVolatilityHistory:!1,fetchWithdrawals:!0,reduceMargin:!0,repayCrossMargin:!0,repayIsolatedMargin:!0,sandbox:!0,setLeverage:!0,setMarginMode:!1,setPositionMode:!0,signIn:!1,transfer:!0,withdraw:!0},api:{public:{wallet:{get:{currency_chains:1}},unified:{get:{currencies:1,history_loan_rate:1}},spot:{get:{currencies:1,"currencies/{currency}":1,currency_pairs:1,"currency_pairs/{currency_pair}":1,tickers:1,order_book:1,trades:1,candlesticks:1,time:1,insurance_history:1}},margin:{get:{"uni/currency_pairs":1,"uni/currency_pairs/{currency_pair}":1,loan_margin_tiers:1,currency_pairs:1,"currency_pairs/{currency_pair}":1,funding_book:1,"cross/currencies":1,"cross/currencies/{currency}":1}},flash_swap:{get:{currency_pairs:1,currencies:1}},futures:{get:{"{settle}/contracts":1,"{settle}/contracts/{contract}":1,"{settle}/order_book":1,"{settle}/trades":1,"{settle}/candlesticks":1,"{settle}/premium_index":1,"{settle}/tickers":1,"{settle}/funding_rate":1,"{settle}/insurance":1,"{settle}/contract_stats":1,"{settle}/index_constituents/{index}":1,"{settle}/liq_orders":1,"{settle}/risk_limit_tiers":1}},delivery:{get:{"{settle}/contracts":1,"{settle}/contracts/{contract}":1,"{settle}/order_book":1,"{settle}/trades":1,"{settle}/candlesticks":1,"{settle}/tickers":1,"{settle}/insurance":1,"{settle}/risk_limit_tiers":1}},options:{get:{underlyings:1,expirations:1,contracts:1,"contracts/{contract}":1,settlements:1,"settlements/{contract}":1,order_book:1,tickers:1,"underlying/tickers/{underlying}":1,candlesticks:1,"underlying/candlesticks":1,trades:1}},earn:{get:{"uni/currencies":1,"uni/currencies/{currency}":1,"dual/investment_plan":1,"structured/products":1}},loan:{get:{"collateral/currencies":1,"multi_collateral/currencies":1,"multi_collateral/ltv":1,"multi_collateral/fixed_rate":1,"multi_collateral/current_rate":1}}},private:{withdrawals:{post:{withdrawals:20,push:1},delete:{"withdrawals/{withdrawal_id}":1}},wallet:{get:{deposit_address:1,withdrawals:1,deposits:1,sub_account_transfers:1,order_status:1,withdraw_status:1,sub_account_balances:2.5,sub_account_margin_balances:2.5,sub_account_futures_balances:2.5,sub_account_cross_margin_balances:2.5,saved_address:1,fee:1,total_balance:2.5,small_balance:1,small_balance_history:1,push:1,getLowCapExchangeList:1},post:{transfers:2.5,sub_account_transfers:2.5,sub_account_to_sub_account:2.5,small_balance:1}},subAccounts:{get:{sub_accounts:2.5,"sub_accounts/{user_id}":2.5,"sub_accounts/{user_id}/keys":2.5,"sub_accounts/{user_id}/keys/{key}":2.5},post:{sub_accounts:2.5,"sub_accounts/{user_id}/keys":2.5,"sub_accounts/{user_id}/lock":2.5,"sub_accounts/{user_id}/unlock":2.5},put:{"sub_accounts/{user_id}/keys/{key}":2.5},delete:{"sub_accounts/{user_id}/keys/{key}":2.5}},unified:{get:{accounts:20/15,borrowable:20/15,transferable:20/15,transferables:20/15,batch_borrowable:20/15,loans:20/15,loan_records:20/15,interest_records:20/15,risk_units:20/15,unified_mode:20/15,estimate_rate:20/15,currency_discount_tiers:20/15,loan_margin_tiers:20/15,"leverage/user_currency_config":20/15,"leverage/user_currency_setting":20/15,account_mode:20/15},post:{loans:200/15,portfolio_calculator:20/15,"leverage/user_currency_setting":20/15,collateral_currencies:20/15,account_mode:20/15},put:{unified_mode:20/15}},spot:{get:{fee:1,batch_fee:1,accounts:1,account_book:1,open_orders:1,orders:1,"orders/{order_id}":1,my_trades:1,price_orders:1,"price_orders/{order_id}":1},post:{batch_orders:.4,cross_liquidate_orders:1,orders:.4,cancel_batch_orders:20/75,countdown_cancel_all:20/75,amend_batch_orders:.4,price_orders:.4},delete:{orders:20/75,"orders/{order_id}":20/75,price_orders:20/75,"price_orders/{order_id}":20/75},patch:{"orders/{order_id}":.4}},margin:{get:{accounts:20/15,account_book:20/15,funding_accounts:20/15,auto_repay:20/15,transferable:20/15,"uni/estimate_rate":20/15,"uni/loans":20/15,"uni/loan_records":20/15,"uni/interest_records":20/15,"uni/borrowable":20/15,"user/loan_margin_tiers":20/15,"user/account":20/15,loans:20/15,"loans/{loan_id}":20/15,"loans/{loan_id}/repayment":20/15,loan_records:20/15,"loan_records/{loan_record_id}":20/15,borrowable:20/15,"cross/accounts":20/15,"cross/account_book":20/15,"cross/loans":20/15,"cross/loans/{loan_id}":20/15,"cross/repayments":20/15,"cross/interest_records":20/15,"cross/transferable":20/15,"cross/estimate_rate":20/15,"cross/borrowable":20/15},post:{auto_repay:20/15,"uni/loans":20/15,"leverage/user_market_setting":20/15,loans:20/15,merged_loans:20/15,"loans/{loan_id}/repayment":20/15,"cross/loans":20/15,"cross/repayments":20/15},patch:{"loans/{loan_id}":20/15,"loan_records/{loan_record_id}":20/15},delete:{"loans/{loan_id}":20/15}},flash_swap:{get:{orders:1,"orders/{order_id}":1},post:{orders:1,"orders/preview":1}},futures:{get:{"{settle}/accounts":1,"{settle}/account_book":1,"{settle}/positions":1,"{settle}/positions/{contract}":1,"{settle}/dual_comp/positions/{contract}":1,"{settle}/orders":1,"{settle}/orders_timerange":1,"{settle}/orders/{order_id}":1,"{settle}/my_trades":1,"{settle}/my_trades_timerange":1,"{settle}/position_close":1,"{settle}/liquidates":1,"{settle}/auto_deleverages":1,"{settle}/fee":1,"{settle}/risk_limit_table":1,"{settle}/price_orders":1,"{settle}/price_orders/{order_id}":1},post:{"{settle}/positions/{contract}/margin":1,"{settle}/positions/{contract}/leverage":1,"{settle}/positions/{contract}/risk_limit":1,"{settle}/positions/cross_mode":1,"{settle}/dual_comp/positions/cross_mode":1,"{settle}/dual_mode":1,"{settle}/dual_comp/positions/{contract}/margin":1,"{settle}/dual_comp/positions/{contract}/leverage":1,"{settle}/dual_comp/positions/{contract}/risk_limit":1,"{settle}/orders":.4,"{settle}/batch_orders":.4,"{settle}/countdown_cancel_all":.4,"{settle}/batch_cancel_orders":.4,"{settle}/batch_amend_orders":.4,"{settle}/bbo_orders":.4,"{settle}/price_orders":.4},put:{"{settle}/orders/{order_id}":1,"{settle}/price_orders/{order_id}":1},delete:{"{settle}/orders":20/75,"{settle}/orders/{order_id}":20/75,"{settle}/price_orders":20/75,"{settle}/price_orders/{order_id}":20/75}},delivery:{get:{"{settle}/accounts":20/15,"{settle}/account_book":20/15,"{settle}/positions":20/15,"{settle}/positions/{contract}":20/15,"{settle}/orders":20/15,"{settle}/orders/{order_id}":20/15,"{settle}/my_trades":20/15,"{settle}/position_close":20/15,"{settle}/liquidates":20/15,"{settle}/settlements":20/15,"{settle}/price_orders":20/15,"{settle}/price_orders/{order_id}":20/15},post:{"{settle}/positions/{contract}/margin":20/15,"{settle}/positions/{contract}/leverage":20/15,"{settle}/positions/{contract}/risk_limit":20/15,"{settle}/orders":20/15,"{settle}/price_orders":20/15},delete:{"{settle}/orders":20/15,"{settle}/orders/{order_id}":20/15,"{settle}/price_orders":20/15,"{settle}/price_orders/{order_id}":20/15}},options:{get:{my_settlements:20/15,accounts:20/15,account_book:20/15,positions:20/15,"positions/{contract}":20/15,position_close:20/15,orders:20/15,"orders/{order_id}":20/15,my_trades:20/15,mmp:20/15},post:{orders:20/15,countdown_cancel_all:20/15,mmp:20/15,"mmp/reset":20/15},delete:{orders:20/15,"orders/{order_id}":20/15}},earn:{get:{"uni/lends":20/15,"uni/lend_records":20/15,"uni/interests/{currency}":20/15,"uni/interest_records":20/15,"uni/interest_status/{currency}":20/15,"uni/chart":20/15,"uni/rate":20/15,"staking/eth2/rate_records":20/15,"dual/orders":20/15,"structured/orders":20/15,"staking/coins":20/15,"staking/order_list":20/15,"staking/award_list":20/15,"staking/assets":20/15,"uni/currencies":20/15,"uni/currencies/{currency}":20/15},post:{"uni/lends":20/15,"staking/eth2/swap":20/15,"dual/orders":20/15,"structured/orders":20/15,"staking/swap":20/15},put:{"uni/interest_reinvest":20/15},patch:{"uni/lends":20/15}},loan:{get:{"collateral/orders":20/15,"collateral/orders/{order_id}":20/15,"collateral/repay_records":20/15,"collateral/collaterals":20/15,"collateral/total_amount":20/15,"collateral/ltv":20/15,"multi_collateral/orders":20/15,"multi_collateral/orders/{order_id}":20/15,"multi_collateral/repay":20/15,"multi_collateral/mortgage":20/15,"multi_collateral/currency_quota":20/15,"collateral/currencies":20/15,"multi_collateral/currencies":20/15,"multi_collateral/ltv":20/15,"multi_collateral/fixed_rate":20/15,"multi_collateral/current_rate":20/15},post:{"collateral/orders":20/15,"collateral/repay":20/15,"collateral/collaterals":20/15,"multi_collateral/orders":20/15,"multi_collateral/repay":20/15,"multi_collateral/mortgage":20/15}},account:{get:{detail:20/15,main_keys:20/15,rate_limit:20/15,stp_groups:20/15,"stp_groups/{stp_id}/users":20/15,"stp_groups/debit_fee":20/15,debit_fee:20/15},post:{stp_groups:20/15,"stp_groups/{stp_id}/users":20/15,debit_fee:20/15},delete:{"stp_groups/{stp_id}/users":20/15}},rebate:{get:{"agency/transaction_history":20/15,"agency/commission_history":20/15,"partner/transaction_history":20/15,"partner/commission_history":20/15,"partner/sub_list":20/15,"broker/commission_history":20/15,"broker/transaction_history":20/15,"user/info":20/15,"user/sub_relation":20/15}}}},timeframes:{"10s":"10s","1m":"1m","5m":"5m","15m":"15m","30m":"30m","1h":"1h","2h":"2h","4h":"4h","8h":"8h","1d":"1d","7d":"7d","1w":"7d"},commonCurrencies:{ORT:"XREATORS",ASS:"ASSF","88MPH":"MPH",AXIS:"AXISDEFI",BIFI:"BITCOINFILE",BOX:"DEFIBOX",BYN:"BEYONDFI",EGG:"GOOSEFINANCE",GTC:"GAMECOM",GTC_HT:"GAMECOM_HT",GTC_BSC:"GAMECOM_BSC",HIT:"HITCHAIN",MM:"MILLION",MPH:"MORPHER",POINT:"GATEPOINT",RAI:"RAIREFLEXINDEX",RED:"RedLang",SBTC:"SUPERBITCOIN",TNC:"TRINITYNETWORKCREDIT",VAI:"VAIOT",TRAC:"TRACO"},requiredCredentials:{apiKey:!0,secret:!0},headers:{"X-Gate-Channel-Id":"ccxt"},options:{timeDifference:0,adjustForTimeDifference:!1,sandboxMode:!1,unifiedAccount:void 0,createOrder:{expiration:86400},createMarketBuyOrderRequiresPrice:!0,networks:{BTC:"BTC",BRC20:"BTCBRC",ETH:"ETH",ERC20:"ETH",TRX:"TRX",TRC20:"TRX",HECO:"HT",HRC20:"HT",BSC:"BSC",BEP20:"BSC",SOL:"SOL",MATIC:"MATIC",OPTIMISM:"OPETH",ADA:"ADA",AVAXC:"AVAX_C",NEAR:"NEAR",ARBONE:"ARBEVM",BASE:"BASEEVM",SUI:"SUI",CRONOS:"CRO",CRO:"CRO",APT:"APT",SCROLL:"SCROLLETH",TAIKO:"TAIKOETH",HYPE:"HYPE",ALGO:"ALGO",LINEA:"LINEAETH",BLAST:"BLASTETH",XLM:"XLM",RSK:"RBTC",TON:"TON",MNT:"MNT",CELO:"CELO",HBAR:"HBAR",ZKSERA:"ZKSERA",KLAY:"KLAY",EOS:"EOS",ACA:"ACA",XTZ:"XTZ",EGLD:"EGLD",GLMR:"GLMR",AURORA:"AURORAEVM",KON:"KONET",GATECHAIN:"GTEVM",KUSAMA:"KSMSM",OKC:"OKT",POLKADOT:"DOTSM",LUNA:"LUNC"},networksById:{OPETH:"OP",ETH:"ERC20",ERC20:"ERC20",TRX:"TRC20",TRC20:"TRC20",HT:"HRC20",HECO:"HRC20",BSC:"BEP20",BEP20:"BEP20",POLYGON:"MATIC",POL:"MATIC"},timeInForce:{GTC:"gtc",IOC:"ioc",PO:"poc",POC:"poc",FOK:"fok"},accountsByType:{funding:"spot",spot:"spot",margin:"margin",cross_margin:"cross_margin",cross:"cross_margin",isolated:"margin",swap:"futures",future:"delivery",futures:"futures",delivery:"delivery",option:"options",options:"options"},fetchMarkets:{types:["spot","swap","future","option"]},swap:{fetchMarkets:{settlementCurrencies:["usdt","btc"]}},future:{fetchMarkets:{settlementCurrencies:["usdt"]}}},features:{default:{sandbox:!0,createOrder:{marginMode:!0,triggerPrice:!0,triggerDirection:!0,triggerPriceType:void 0,stopLossPrice:!0,takeProfitPrice:!0,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!1,trailing:!1,iceberg:!0,selfTradePrevention:!0,leverage:!1,marketBuyByCost:!0,marketBuyRequiresPrice:!0},createOrders:{max:40},fetchMyTrades:{marginMode:!0,limit:1e3,daysBack:void 0,untilDays:30,symbolRequired:!1},fetchOrder:{marginMode:!1,trigger:!0,trailing:!1,symbolRequired:!0},fetchOpenOrders:{marginMode:!0,trigger:!0,trailing:!1,limit:100,symbolRequired:!1},fetchOrders:void 0,fetchClosedOrders:{marginMode:!0,trigger:!0,trailing:!1,limit:100,untilDays:30,daysBack:void 0,daysBackCanceled:void 0,symbolRequired:!1},fetchOHLCV:{limit:1e3}},spot:{extends:"default"},forDerivatives:{extends:"spot",createOrder:{marginMode:!1,triggerPriceType:{last:!0,mark:!0,index:!0}},createOrders:{max:10},fetchMyTrades:{marginMode:!1,untilDays:void 0},fetchOpenOrders:{marginMode:!1},fetchClosedOrders:{marginMode:!1,untilDays:void 0,limit:1e3},fetchOHLCV:{limit:1999}},swap:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}},future:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}}},precisionMode:a.kb,fees:{trading:{tierBased:!0,feeSide:"get",percentage:!0,maker:this.parseNumber("0.002"),taker:this.parseNumber("0.002"),tiers:{maker:[[this.parseNumber("0"),this.parseNumber("0.002")],[this.parseNumber("1.5"),this.parseNumber("0.00185")],[this.parseNumber("3"),this.parseNumber("0.00175")],[this.parseNumber("6"),this.parseNumber("0.00165")],[this.parseNumber("12.5"),this.parseNumber("0.00155")],[this.parseNumber("25"),this.parseNumber("0.00145")],[this.parseNumber("75"),this.parseNumber("0.00135")],[this.parseNumber("200"),this.parseNumber("0.00125")],[this.parseNumber("500"),this.parseNumber("0.00115")],[this.parseNumber("1250"),this.parseNumber("0.00105")],[this.parseNumber("2500"),this.parseNumber("0.00095")],[this.parseNumber("3000"),this.parseNumber("0.00085")],[this.parseNumber("6000"),this.parseNumber("0.00075")],[this.parseNumber("11000"),this.parseNumber("0.00065")],[this.parseNumber("20000"),this.parseNumber("0.00055")],[this.parseNumber("40000"),this.parseNumber("0.00055")],[this.parseNumber("75000"),this.parseNumber("0.00055")]],taker:[[this.parseNumber("0"),this.parseNumber("0.002")],[this.parseNumber("1.5"),this.parseNumber("0.00195")],[this.parseNumber("3"),this.parseNumber("0.00185")],[this.parseNumber("6"),this.parseNumber("0.00175")],[this.parseNumber("12.5"),this.parseNumber("0.00165")],[this.parseNumber("25"),this.parseNumber("0.00155")],[this.parseNumber("75"),this.parseNumber("0.00145")],[this.parseNumber("200"),this.parseNumber("0.00135")],[this.parseNumber("500"),this.parseNumber("0.00125")],[this.parseNumber("1250"),this.parseNumber("0.00115")],[this.parseNumber("2500"),this.parseNumber("0.00105")],[this.parseNumber("3000"),this.parseNumber("0.00095")],[this.parseNumber("6000"),this.parseNumber("0.00085")],[this.parseNumber("11000"),this.parseNumber("0.00075")],[this.parseNumber("20000"),this.parseNumber("0.00065")],[this.parseNumber("40000"),this.parseNumber("0.00065")],[this.parseNumber("75000"),this.parseNumber("0.00065")]]}},swap:{tierBased:!0,feeSide:"base",percentage:!0,maker:this.parseNumber("0.0"),taker:this.parseNumber("0.0005"),tiers:{maker:[[this.parseNumber("0"),this.parseNumber("0.0000")],[this.parseNumber("1.5"),this.parseNumber("-0.00005")],[this.parseNumber("3"),this.parseNumber("-0.00005")],[this.parseNumber("6"),this.parseNumber("-0.00005")],[this.parseNumber("12.5"),this.parseNumber("-0.00005")],[this.parseNumber("25"),this.parseNumber("-0.00005")],[this.parseNumber("75"),this.parseNumber("-0.00005")],[this.parseNumber("200"),this.parseNumber("-0.00005")],[this.parseNumber("500"),this.parseNumber("-0.00005")],[this.parseNumber("1250"),this.parseNumber("-0.00005")],[this.parseNumber("2500"),this.parseNumber("-0.00005")],[this.parseNumber("3000"),this.parseNumber("-0.00008")],[this.parseNumber("6000"),this.parseNumber("-0.01000")],[this.parseNumber("11000"),this.parseNumber("-0.01002")],[this.parseNumber("20000"),this.parseNumber("-0.01005")],[this.parseNumber("40000"),this.parseNumber("-0.02000")],[this.parseNumber("75000"),this.parseNumber("-0.02005")]],taker:[[this.parseNumber("0"),this.parseNumber("0.00050")],[this.parseNumber("1.5"),this.parseNumber("0.00048")],[this.parseNumber("3"),this.parseNumber("0.00046")],[this.parseNumber("6"),this.parseNumber("0.00044")],[this.parseNumber("12.5"),this.parseNumber("0.00042")],[this.parseNumber("25"),this.parseNumber("0.00040")],[this.parseNumber("75"),this.parseNumber("0.00038")],[this.parseNumber("200"),this.parseNumber("0.00036")],[this.parseNumber("500"),this.parseNumber("0.00034")],[this.parseNumber("1250"),this.parseNumber("0.00032")],[this.parseNumber("2500"),this.parseNumber("0.00030")],[this.parseNumber("3000"),this.parseNumber("0.00030")],[this.parseNumber("6000"),this.parseNumber("0.00030")],[this.parseNumber("11000"),this.parseNumber("0.00030")],[this.parseNumber("20000"),this.parseNumber("0.00030")],[this.parseNumber("40000"),this.parseNumber("0.00030")],[this.parseNumber("75000"),this.parseNumber("0.00030")]]}}},exceptions:{exact:{INVALID_PARAM_VALUE:n.BadRequest,INVALID_PROTOCOL:n.BadRequest,INVALID_ARGUMENT:n.BadRequest,INVALID_REQUEST_BODY:n.BadRequest,MISSING_REQUIRED_PARAM:n.ArgumentsRequired,BAD_REQUEST:n.BadRequest,INVALID_CONTENT_TYPE:n.BadRequest,NOT_ACCEPTABLE:n.BadRequest,METHOD_NOT_ALLOWED:n.BadRequest,NOT_FOUND:n.ExchangeError,AUTHENTICATION_FAILED:n.AuthenticationError,INVALID_CREDENTIALS:n.AuthenticationError,INVALID_KEY:n.AuthenticationError,IP_FORBIDDEN:n.AuthenticationError,READ_ONLY:n.PermissionDenied,INVALID_SIGNATURE:n.AuthenticationError,MISSING_REQUIRED_HEADER:n.AuthenticationError,REQUEST_EXPIRED:n.AuthenticationError,ACCOUNT_LOCKED:n.AccountSuspended,FORBIDDEN:n.PermissionDenied,SUB_ACCOUNT_NOT_FOUND:n.ExchangeError,SUB_ACCOUNT_LOCKED:n.AccountSuspended,MARGIN_BALANCE_EXCEPTION:n.ExchangeError,MARGIN_TRANSFER_FAILED:n.ExchangeError,TOO_MUCH_FUTURES_AVAILABLE:n.ExchangeError,FUTURES_BALANCE_NOT_ENOUGH:n.InsufficientFunds,ACCOUNT_EXCEPTION:n.ExchangeError,SUB_ACCOUNT_TRANSFER_FAILED:n.ExchangeError,ADDRESS_NOT_USED:n.ExchangeError,TOO_FAST:n.RateLimitExceeded,WITHDRAWAL_OVER_LIMIT:n.ExchangeError,API_WITHDRAW_DISABLED:n.ExchangeNotAvailable,INVALID_WITHDRAW_ID:n.ExchangeError,INVALID_WITHDRAW_CANCEL_STATUS:n.ExchangeError,INVALID_PRECISION:n.InvalidOrder,INVALID_CURRENCY:n.BadSymbol,INVALID_CURRENCY_PAIR:n.BadSymbol,POC_FILL_IMMEDIATELY:n.OrderImmediatelyFillable,ORDER_NOT_FOUND:n.OrderNotFound,CLIENT_ID_NOT_FOUND:n.OrderNotFound,ORDER_CLOSED:n.InvalidOrder,ORDER_CANCELLED:n.InvalidOrder,QUANTITY_NOT_ENOUGH:n.InvalidOrder,BALANCE_NOT_ENOUGH:n.InsufficientFunds,MARGIN_NOT_SUPPORTED:n.InvalidOrder,MARGIN_BALANCE_NOT_ENOUGH:n.InsufficientFunds,AMOUNT_TOO_LITTLE:n.InvalidOrder,AMOUNT_TOO_MUCH:n.InvalidOrder,REPEATED_CREATION:n.InvalidOrder,LOAN_NOT_FOUND:n.OrderNotFound,LOAN_RECORD_NOT_FOUND:n.OrderNotFound,NO_MATCHED_LOAN:n.ExchangeError,NOT_MERGEABLE:n.ExchangeError,REPAY_TOO_MUCH:n.ExchangeError,TOO_MANY_CURRENCY_PAIRS:n.InvalidOrder,TOO_MANY_ORDERS:n.InvalidOrder,TOO_MANY_REQUESTS:n.RateLimitExceeded,MIXED_ACCOUNT_TYPE:n.InvalidOrder,AUTO_BORROW_TOO_MUCH:n.ExchangeError,TRADE_RESTRICTED:n.InsufficientFunds,USER_NOT_FOUND:n.AccountNotEnabled,CONTRACT_NO_COUNTER:n.ExchangeError,CONTRACT_NOT_FOUND:n.BadSymbol,RISK_LIMIT_EXCEEDED:n.ExchangeError,INSUFFICIENT_AVAILABLE:n.InsufficientFunds,LIQUIDATE_IMMEDIATELY:n.InvalidOrder,LEVERAGE_TOO_HIGH:n.InvalidOrder,LEVERAGE_TOO_LOW:n.InvalidOrder,ORDER_NOT_OWNED:n.ExchangeError,ORDER_FINISHED:n.ExchangeError,POSITION_CROSS_MARGIN:n.ExchangeError,POSITION_IN_LIQUIDATION:n.ExchangeError,POSITION_IN_CLOSE:n.ExchangeError,POSITION_EMPTY:n.InvalidOrder,REMOVE_TOO_MUCH:n.ExchangeError,RISK_LIMIT_NOT_MULTIPLE:n.ExchangeError,RISK_LIMIT_TOO_HIGH:n.ExchangeError,RISK_LIMIT_TOO_lOW:n.ExchangeError,PRICE_TOO_DEVIATED:n.InvalidOrder,SIZE_TOO_LARGE:n.InvalidOrder,SIZE_TOO_SMALL:n.InvalidOrder,PRICE_OVER_LIQUIDATION:n.InvalidOrder,PRICE_OVER_BANKRUPT:n.InvalidOrder,ORDER_POC_IMMEDIATE:n.OrderImmediatelyFillable,INCREASE_POSITION:n.InvalidOrder,CONTRACT_IN_DELISTING:n.ExchangeError,INTERNAL:n.ExchangeNotAvailable,SERVER_ERROR:n.ExchangeNotAvailable,TOO_BUSY:n.ExchangeNotAvailable,CROSS_ACCOUNT_NOT_FOUND:n.ExchangeError,RISK_LIMIT_TOO_LOW:n.BadRequest,AUTO_TRIGGER_PRICE_LESS_LAST:n.InvalidOrder,AUTO_TRIGGER_PRICE_GREATE_LAST:n.InvalidOrder,POSITION_HOLDING:n.BadRequest,USER_LOAN_EXCEEDED:n.BadRequest,NO_CHANGE:n.InvalidOrder},broad:{}}})}setSandboxMode(t){super.setSandboxMode(t),this.options.sandboxMode=t}async loadUnifiedStatus(t={}){if(void 0===this.safeBool(this.options,"unifiedAccount"))try{const e=await this.privateAccountGetDetail(t),i=this.safeDict(e,"key",{});this.options.unifiedAccount=2===this.safeInteger(i,"mode")}catch(t){this.options.unifiedAccount=!1}return this.options.unifiedAccount}async upgradeUnifiedTradeAccount(t={}){return await this.privateUnifiedPutUnifiedMode(t)}async fetchTime(t={}){const e=await this.publicSpotGetTime(t);return this.safeInteger(e,"server_time")}createExpiredOptionMarket(t){const e="USDT",i=e,s=t.split("-"),r=t.split("/"),a=t.split("_");let n,o=this.safeString(s,1);t.indexOf("/")>-1?n=this.safeString(r,0):(n=this.safeString(a,0),o=o.slice(2,8));const d=this.safeString(s,2),c=this.safeString(s,3),h=this.convertExpireDate(o),l=this.parse8601(h);return{id:n+"_"+e+"-20"+o+"-"+d+"-"+c,symbol:n+"/"+e+":"+i+"-"+o+"-"+d+"-"+c,base:n,quote:e,settle:i,baseId:n,quoteId:e,settleId:i,active:!1,type:"option",linear:void 0,inverse:void 0,spot:!1,swap:!1,future:!1,option:!0,margin:!1,contract:!0,contractSize:this.parseNumber("1"),expiry:l,expiryDatetime:h,optionType:"C"===c?"call":"put",strike:this.parseNumber(d),precision:{amount:this.parseNumber("1"),price:void 0},limits:{amount:{min:void 0,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0}},info:void 0}}safeMarket(t=void 0,e=void 0,i=void 0,s=void 0){return void 0!==t&&(t.indexOf("-C")>-1||t.indexOf("-P")>-1)&&!(t in this.markets_by_id)?this.createExpiredOptionMarket(t):super.safeMarket(t,e,i,s)}async fetchMarkets(t={}){this.options.adjustForTimeDifference&&await this.loadTimeDifference(),this.checkRequiredCredentials(!1)&&await this.loadUnifiedStatus();const e=[],i=this.safeDict(this.options,"fetchMarkets"),s=this.safeList(i,"types",["spot","swap","future"]);for(let i=0;i<s.length;i++){const r=s[i];"spot"===r?e.push(this.fetchSpotMarkets(t)):"swap"===r?e.push(this.fetchSwapMarkets(t)):"future"===r?e.push(this.fetchFutureMarkets(t)):"option"===r&&e.push(this.fetchOptionMarkets(t))}const r=await Promise.all(e);return this.arraysConcat(r)}async fetchSpotMarkets(t={}){const e=this.publicMarginGetCurrencyPairs(t),i=this.publicSpotGetCurrencyPairs(t),[s,a]=await Promise.all([e,i]),n=this.indexBy(s,"id"),o=[];for(let t=0;t<a.length;t++){const e=a[t],i=this.safeString(e,"id"),s=this.safeValue(n,i),d=this.deepExtend(s,e),[c,h]=i.split("_"),l=this.safeCurrencyCode(c),u=this.safeCurrencyCode(h),p=this.safeString(d,"fee"),f=this.safeString(d,"maker_fee_rate",p),m=this.parseNumber(this.parsePrecision(this.safeString(d,"amount_precision"))),g=this.safeString(d,"trade_status"),y=void 0!==this.safeNumber(d,"leverage"),v=this.safeIntegerProduct(e,"buy_start",1e3),b=0!==v?v:void 0;o.push({id:i,symbol:l+"/"+u,base:l,quote:u,settle:void 0,baseId:c,quoteId:h,settleId:void 0,type:"spot",spot:!0,margin:y,swap:!1,future:!1,option:!1,active:"tradable"===g,contract:!1,linear:void 0,inverse:void 0,taker:this.parseNumber(r.Y.stringDiv(p,"100")),maker:this.parseNumber(r.Y.stringDiv(f,"100")),contractSize:void 0,expiry:void 0,expiryDatetime:void 0,strike:void 0,optionType:void 0,precision:{amount:m,price:this.parseNumber(this.parsePrecision(this.safeString(d,"precision")))},limits:{leverage:{min:this.parseNumber("1"),max:this.safeNumber(d,"leverage",1)},amount:{min:this.safeNumber(e,"min_base_amount",m),max:void 0},price:{min:void 0,max:void 0},cost:{min:this.safeNumber(d,"min_quote_amount"),max:y?this.safeNumber(d,"max_quote_amount"):void 0}},created:b,info:d})}return o}async fetchSwapMarkets(t={}){const e=[];let i=this.getSettlementCurrencies("swap","fetchMarkets");this.options.sandboxMode&&(i=["usdt"]);for(let s=0;s<i.length;s++){const r=i[s],a={settle:r},n=await this.publicFuturesGetSettleContracts(this.extend(a,t));for(let t=0;t<n.length;t++){const i=this.parseContractMarket(n[t],r);e.push(i)}}return e}async fetchFutureMarkets(t={}){if(this.options.sandboxMode)return[];const e=[],i=this.getSettlementCurrencies("future","fetchMarkets");for(let s=0;s<i.length;s++){const r=i[s],a={settle:r},n=await this.publicDeliveryGetSettleContracts(this.extend(a,t));for(let t=0;t<n.length;t++){const i=this.parseContractMarket(n[t],r);e.push(i)}}return e}parseContractMarket(t,e){const i=this.safeString(t,"name"),s=i.split("_"),a=this.safeString(s,0),n=this.safeString(s,1),o=this.safeString(s,2),d=this.safeCurrencyCode(a),c=this.safeCurrencyCode(n),h=this.safeCurrencyCode(e),l=this.safeTimestamp(t,"expire_time");let u="",p="swap";void 0!==o?(u=d+"/"+c+":"+h+"-"+this.yymmdd(l,""),p="future"):u=d+"/"+c+":"+h;const f=this.safeString(t,"order_price_deviate"),m=this.safeString(t,"mark_price"),g=r.Y.stringSub("1",f),y=r.Y.stringAdd("1",f),v=r.Y.stringMul(g,m),b=r.Y.stringMul(y,m),w=c===h;let S=this.safeString(t,"quanto_multiplier");return"0"===S&&(S="1"),{id:i,symbol:u,base:d,quote:c,settle:h,baseId:a,quoteId:n,settleId:e,type:p,spot:!1,margin:!1,swap:"swap"===p,future:"future"===p,option:"option"===p,active:!0,contract:!0,linear:w,inverse:!w,taker:this.parseNumber("0.0005"),maker:this.parseNumber("0.0002"),contractSize:this.parseNumber(S),expiry:l,expiryDatetime:this.iso8601(l),strike:void 0,optionType:void 0,precision:{amount:this.parseNumber("1"),price:this.safeNumber(t,"order_price_round")},limits:{leverage:{min:this.safeNumber(t,"leverage_min"),max:this.safeNumber(t,"leverage_max")},amount:{min:this.safeNumber(t,"order_size_min"),max:this.safeNumber(t,"order_size_max")},price:{min:this.parseNumber(v),max:this.parseNumber(b)},cost:{min:void 0,max:void 0}},created:this.safeIntegerProduct(t,"create_time",1e3),info:t}}async fetchOptionMarkets(t={}){const e=[],i=await this.fetchOptionUnderlyings();for(let s=0;s<i.length;s++){const a=i[s],n=this.extend({},t);n.underlying=a;const o=await this.publicOptionsGetContracts(n);for(let t=0;t<o.length;t++){const i=o[t],s=this.safeString(i,"name"),n=a.split("_"),d=this.safeString(n,0),c=this.safeString(n,1),h=this.safeCurrencyCode(d),l=this.safeCurrencyCode(c);let u=h+"/"+l;const p=this.safeTimestamp(i,"expiration_time"),f=this.safeString(i,"strike_price"),m=this.safeValue(i,"is_call"),g=m?"C":"P",y=m?"call":"put";u=u+":"+l+"-"+this.yymmdd(p)+"-"+f+"-"+g;const v=this.safeString(i,"order_price_deviate"),b=this.safeString(i,"mark_price"),w=r.Y.stringSub("1",v),S=r.Y.stringAdd("1",v),k=r.Y.stringMul(w,b),O=r.Y.stringMul(S,b);e.push({id:s,symbol:u,base:h,quote:l,settle:l,baseId:d,quoteId:c,settleId:c,type:"option",spot:!1,margin:!1,swap:!1,future:!1,option:!0,active:!0,contract:!0,linear:!0,inverse:!1,taker:this.parseNumber("0.0003"),maker:this.parseNumber("0.0003"),contractSize:this.parseNumber("1"),expiry:p,expiryDatetime:this.iso8601(p),strike:this.parseNumber(f),optionType:y,precision:{amount:this.parseNumber("1"),price:this.safeNumber(i,"order_price_round")},limits:{leverage:{min:void 0,max:void 0},amount:{min:this.safeNumber(i,"order_size_min"),max:this.safeNumber(i,"order_size_max")},price:{min:this.parseNumber(k),max:this.parseNumber(O)},cost:{min:void 0,max:void 0}},created:this.safeTimestamp(i,"create_time"),info:i})}}return e}async fetchOptionUnderlyings(){const t=await this.publicOptionsGetUnderlyings(),e=[];for(let i=0;i<t.length;i++){const s=t[i],r=this.safeString(s,"name");void 0!==r&&e.push(r)}return e}prepareRequest(t=void 0,e=void 0,i={}){const s={};if(void 0!==t)t.contract?(s.contract=t.id,t.option||(s.settle=t.settleId)):s.currency_pair=t.id;else{const t="swap"===e;if(t||"future"===e){const e=t?"usdt":"btc",r=this.safeStringLower(i,"settle",e);i=this.omit(i,"settle"),s.settle=r}}return[s,i]}spotOrderPrepareRequest(t=void 0,e=!1,i={}){const[s,r]=this.getMarginMode(e,i),a={};if(!e){if(void 0===t)throw new n.ArgumentsRequired(this.id+" spotOrderPrepareRequest() requires a market argument for non-trigger orders");a.account=s,a.currency_pair=t.id}return[a,r]}multiOrderSpotPrepareRequest(t=void 0,e=!1,i={}){const[s,r]=this.getMarginMode(e,i),a={account:s};return void 0!==t&&(e?a.market=t.id:a.currency_pair=t.id),[a,r]}getMarginMode(t,e){const i=this.safeStringLower2(this.options,"defaultMarginMode","marginMode","spot");let s=this.safeStringLower2(e,"marginMode","account",i);if(e=this.omit(e,["marginMode","account"]),"cross"===s?s="cross_margin":"isolated"===s?s="margin":""===s&&(s="spot"),t&&("spot"===s&&(s="normal"),"cross_margin"===s))throw new n.BadRequest(this.id+" getMarginMode() does not support trigger orders for cross margin");let r=!1;return[r,e]=this.handleOptionAndParams(e,"getMarginMode","unifiedAccount"),r&&(s="unified"),[s,e]}getSettlementCurrencies(t,e){const i=this.safeValue(this.options,t,{}),s=this.safeValue(i,e,{}),r="swap"===t?["usdt"]:["btc"];return this.safeValue(s,"settlementCurrencies",r)}async fetchCurrencies(t={}){if(void 0!==this.safeValue(this.urls,"apiBackup"))return{};const e=await this.publicSpotGetCurrencies(t),i=this.indexBy(e,"currency"),s={};for(let t=0;t<e.length;t++){const r=e[t],a=this.safeString(r,"currency"),n=this.safeCurrencyCode(a),o=this.isLeveragedCurrency(a,!0,i)?"leveraged":"crypto",d=this.safeList(r,"chains",[]),c={};for(let t=0;t<d.length;t++){const e=d[t],i=this.safeString(e,"name"),s=this.networkIdToCode(i);c[s]={info:e,id:i,network:s,active:void 0,deposit:!this.safeBool(e,"deposit_disabled"),withdraw:!this.safeBool(e,"withdraw_disabled"),fee:void 0,precision:this.parseNumber("0.0001"),limits:{deposit:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}s[n]=this.safeCurrencyStructure({id:a,code:n,name:this.safeString(r,"name"),type:o,active:!this.safeBool(r,"delisted"),deposit:!this.safeBool(r,"deposit_disabled"),withdraw:!this.safeBool(r,"withdraw_disabled"),fee:void 0,networks:c,precision:this.parseNumber("0.0001"),info:r})}return s}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.swap)throw new n.BadSymbol(this.id+" fetchFundingRate() supports swap contracts only");const[s,r]=this.prepareRequest(i,void 0,e),a=await this.publicFuturesGetSettleContractsContract(this.extend(s,r));return this.parseFundingRate(a)}async fetchFundingRates(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t))){const e=this.safeString(t,0);i=this.market(e)}const[s,r]=this.prepareRequest(i,"swap",e),a=await this.publicFuturesGetSettleContracts(this.extend(s,r));return this.parseFundingRates(a,t)}parseFundingRate(t,e=void 0){const i=this.safeString(t,"name"),s=this.safeSymbol(i,e,"_","swap"),a=this.safeNumber(t,"mark_price"),n=this.safeNumber(t,"index_price"),o=this.safeNumber(t,"interest_rate"),d=this.safeNumber(t,"funding_rate"),c=this.safeTimestamp(t,"funding_next_apply"),h=this.safeNumber(t,"funding_rate_indicative"),l=r.Y.stringMul("1000",this.safeString(t,"funding_interval"));return{info:t,symbol:s,markPrice:a,indexPrice:n,interestRate:o,estimatedSettlePrice:void 0,timestamp:void 0,datetime:void 0,fundingRate:d,fundingTimestamp:c,fundingDatetime:this.iso8601(c),nextFundingRate:h,nextFundingTimestamp:void 0,nextFundingDatetime:void 0,previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:this.parseFundingInterval(l)}}parseFundingInterval(t){return this.safeString({36e5:"1h",144e5:"4h",288e5:"8h",576e5:"16h",864e5:"24h"},t,t)}async fetchNetworkDepositAddress(t,e={}){await this.loadMarkets();const i={currency:this.currency(t).id},s=await this.privateWalletGetDepositAddress(this.extend(i,e)),r=this.safeValue(s,"multichain_addresses"),a=this.safeString(s,"currency");t=this.safeCurrencyCode(a);const n={};for(let e=0;e<r.length;e++){const i=r[e];if(this.safeInteger(i,"obtain_failed"))continue;const s=this.safeString(i,"chain"),a=this.safeString(i,"address"),o=this.safeString(i,"payment_id");n[s]={info:i,code:t,currency:t,address:a,tag:o}}return n}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();let i=this.currency(t);const s={currency:i.id},r=await this.privateWalletGetDepositAddress(this.extend(s,e)),a=this.safeValue(r,"multichain_addresses",[]),n=this.safeString(r,"currency");i=this.safeCurrency(n,i);const o=this.parseDepositAddresses(a,void 0,!1);return this.indexBy(o,"network")}async fetchDepositAddress(t,e={}){let i;await this.loadMarkets(),[i,e]=this.handleNetworkCodeAndParams(e);const s=await this.fetchDepositAddressesByNetwork(t,e);return s[this.selectNetworkCodeFromUnifiedNetworks(t,i,s)]}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"address");return this.checkAddress(i),{info:t,currency:this.safeString(e,"code"),address:i,tag:this.safeString(t,"payment_id"),network:this.networkIdToCode(this.safeString(t,"chain"))}}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={currency_pair:i.id},r=await this.privateWalletGetFee(this.extend(s,e));return this.parseTradingFee(r,i)}async fetchTradingFees(t={}){await this.loadMarkets();const e=await this.privateWalletGetFee(t);return this.parseTradingFees(e)}parseTradingFees(t){const e={};for(let i=0;i<this.symbols.length;i++){const s=this.symbols[i],r=this.market(s);e[s]=this.parseTradingFee(t,r)}return e}parseTradingFee(t,e=void 0){const i=this.safeValue(t,"gt_discount"),s=i?"gt_taker_fee":"taker_fee",r=i?"gt_maker_fee":"maker_fee",a=this.safeValue(e,"contract"),n=a?"futures_taker_fee":s,o=a?"futures_maker_fee":r;return{info:t,symbol:this.safeString(e,"symbol"),maker:this.safeNumber(t,o),taker:this.safeNumber(t,n),percentage:void 0,tierBased:void 0}}async fetchTransactionFees(t=void 0,e={}){await this.loadMarkets();const i=await this.privateWalletGetWithdrawStatus(e),s={};let r={};for(let e=0;e<i.length;e++){r={};const a=i[e],n=this.safeString(a,"currency"),o=this.safeCurrencyCode(n);if(void 0!==t&&!this.inArray(o,t))continue;const d=this.safeValue(a,"withdraw_fix_on_chains");if(void 0===d)r=this.safeNumber(a,"withdraw_fix");else{const t=Object.keys(d);for(let e=0;e<t.length;e++){const i=t[e];r[this.networkIdToCode(i)]=this.parseNumber(d[i])}}s[o]={withdraw:r,deposit:void 0,info:a}}return s}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.privateWalletGetWithdrawStatus(e);return this.parseDepositWithdrawFees(i,t,"currency")}parseDepositWithdrawFee(t,e=void 0){const i=this.safeValue(t,"withdraw_fix_on_chains"),s={info:t,withdraw:{fee:this.safeNumber(t,"withdraw_fix"),percentage:!1},deposit:{fee:this.safeNumber(t,"deposit"),percentage:!1},networks:{}};if(void 0!==i){const e=Object.keys(i);for(let r=0;r<e.length;r++){const a=e[r],n=this.networkIdToCode(a,this.safeString(t,"currency"));s.networks[n]={withdraw:{fee:this.parseNumber(i[a]),percentage:!1},deposit:{fee:void 0,percentage:void 0}}}}return s}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets(),void 0!==t&&(r=this.market(t),t=r.symbol);const[a,o]=this.handleMarketTypeAndParams("fetchFundingHistory",r,s),[d,c]=this.prepareRequest(r,a,o);let h;if(d.type="fund",void 0!==e&&(d.from=this.parseToInt(e/1e3)),void 0!==i&&(d.limit=i),"swap"===a)h=await this.privateFuturesGetSettleAccountBook(this.extend(d,c));else{if("future"!==a)throw new n.NotSupported(this.id+" fetchFundingHistory() only support swap & future market type");h=await this.privateDeliveryGetSettleAccountBook(this.extend(d,c))}return this.parseFundingHistories(h,t,e,i)}parseFundingHistories(t,e,i,s){const r=[];for(let e=0;e<t.length;e++){const i=t[e],s=this.parseFundingHistory(i);r.push(s)}const a=this.sortBy(r,"timestamp");return this.filterBySymbolSinceLimit(a,e,i,s)}parseFundingHistory(t,e=void 0){const i=this.safeTimestamp(t,"time"),s=this.safeString(t,"text");return e=this.safeMarket(s,e,"_","swap"),{info:t,symbol:this.safeString(e,"symbol"),code:this.safeString(e,"settle"),timestamp:i,datetime:this.iso8601(i),id:void 0,amount:this.safeNumber(t,"change")}}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),[r,a]=this.prepareRequest(s,s.type,i);let o;if(void 0!==e&&(e=s.spot?Math.min(e,1e3):Math.min(e,300),r.limit=e),r.with_id=!0,s.spot||s.margin)o=await this.publicSpotGetOrderBook(this.extend(r,a));else if(s.swap)o=await this.publicFuturesGetSettleOrderBook(this.extend(r,a));else if(s.future)o=await this.publicDeliveryGetSettleOrderBook(this.extend(r,a));else{if(!s.option)throw new n.NotSupported(this.id+" fetchOrderBook() not support this market type");o=await this.publicOptionsGetOrderBook(this.extend(r,a))}let d=this.safeInteger(o,"current");s.spot||(d*=1e3);const c=s.spot?0:"p",h=s.spot?1:"s",l=this.safeInteger(o,"id"),u=this.parseOrderBook(o,t,d,"bids","asks",c,h);return u.nonce=l,u}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),[s,r]=this.prepareRequest(i,void 0,e);let a,o;if(i.spot||i.margin)a=await this.publicSpotGetTickers(this.extend(s,r));else if(i.swap)a=await this.publicFuturesGetSettleTickers(this.extend(s,r));else if(i.future)a=await this.publicDeliveryGetSettleTickers(this.extend(s,r));else{if(!i.option)throw new n.NotSupported(this.id+" fetchTicker() not support this market type");{const t=i.id.split("-");s.underlying=this.safeString(t,0),a=await this.publicOptionsGetTickers(this.extend(s,r))}}if(i.option)for(let t=0;t<a.length;t++){const e=a[t];if(e.name===i.id){o=e;break}}else o=this.safeValue(a,0);return this.parseTicker(o,i)}parseTicker(t,e=void 0){const i=this.safeStringN(t,["currency_pair","contract","name"]),s="mark_price"in t?"contract":"spot",r=this.safeSymbol(i,e,"_",s),a=this.safeString2(t,"last","last_price"),n=this.safeStringN(t,["lowest_ask","a","ask1_price"]),o=this.safeStringN(t,["highest_bid","b","bid1_price"]),d=this.safeString(t,"high_24h"),c=this.safeString(t,"low_24h"),h=this.safeString2(t,"B","bid1_size"),l=this.safeString2(t,"A","ask1_size"),u=this.safeInteger(t,"t");let p=this.safeString2(t,"base_volume","volume_24h_base");"nan"===p&&(p="0");let f=this.safeString2(t,"quote_volume","volume_24h_quote");"nan"===f&&(f="0");const m=this.safeString(t,"change_percentage");return this.safeTicker({symbol:r,timestamp:u,datetime:this.iso8601(u),high:d,low:c,bid:o,bidVolume:h,ask:n,askVolume:l,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:m,average:void 0,baseVolume:p,quoteVolume:f,markPrice:this.safeString(t,"mark_price"),indexPrice:this.safeString(t,"index_price"),info:t},e)}async fetchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.safeString(t,0);let s;void 0!==i&&(s=this.market(i));const[r,a]=this.handleMarketTypeAndParams("fetchTickers",s,e),[o,d]=this.prepareRequest(void 0,r,a);let c;if(o.timezone="utc0","spot"===r||"margin"===r)c=await this.publicSpotGetTickers(this.extend(o,d));else if("swap"===r)c=await this.publicFuturesGetSettleTickers(this.extend(o,d));else if("future"===r)c=await this.publicDeliveryGetSettleTickers(this.extend(o,d));else{if("option"!==r)throw new n.NotSupported(this.id+' fetchTickers() not support this market type, provide symbols or set params["defaultType"] to one from spot/margin/swap/future/option');{this.checkRequiredArgument("fetchTickers",t,"symbols");const e=s.id.split("-");o.underlying=this.safeString(e,0),c=await this.publicOptionsGetTickers(this.extend(o,d))}}return this.parseTickers(c,t)}parseBalanceHelper(t){const e=this.account();return e.used=this.safeString2(t,"freeze","locked"),e.free=this.safeString(t,"available"),e.total=this.safeString(t,"total"),"borrowed"in t&&(e.debt=this.safeString(t,"borrowed")),e}async fetchBalance(t={}){await this.loadMarkets(),await this.loadUnifiedStatus();const e=this.safeString(t,"symbol");t=this.omit(t,"symbol");let i=!1;[i,t]=this.handleOptionAndParams(t,"fetchBalance","unifiedAccount");const[s,r]=this.handleMarketTypeAndParams("fetchBalance",void 0,t),[a,o]=this.prepareRequest(void 0,s,r),[d,c]=this.getMarginMode(!1,o);if(void 0!==e){const t=this.market(e);a.currency_pair=t.id}let h;if(i)h=await this.privateUnifiedGetAccounts(this.extend(a,t));else if("spot"===s)if("spot"===d)h=await this.privateSpotGetAccounts(this.extend(a,c));else if("margin"===d)h=await this.privateMarginGetAccounts(this.extend(a,c));else{if("cross_margin"!==d)throw new n.NotSupported(this.id+" fetchBalance() not support this marginMode");h=await this.privateMarginGetCrossAccounts(this.extend(a,c))}else if("funding"===s)h=await this.privateMarginGetFundingAccounts(this.extend(a,c));else if("swap"===s)h=await this.privateFuturesGetSettleAccounts(this.extend(a,c));else if("future"===s)h=await this.privateDeliveryGetSettleAccounts(this.extend(a,c));else{if("option"!==s)throw new n.NotSupported(this.id+" fetchBalance() not support this market type");h=await this.privateOptionsGetAccounts(this.extend(a,c))}("swap"===s||"future"===s||"option"===s)&&(h=[h]);const l={info:h},u="margin"===d&&"spot"===s;let p=h;if("balances"in p){const t=[],e=this.safeValue(p,"balances",[]),i=Object.keys(e);for(let s=0;s<i.length;s++){const r=i[s],a=e[r];a.currency=r,t.push(a)}p=t}for(let t=0;t<p.length;t++){const e=p[t];if(u){const t=this.safeString(e,"currency_pair"),i=this.safeSymbol(t,void 0,"_","margin"),s=this.safeValue(e,"base",{}),r=this.safeValue(e,"quote",{}),a=this.safeCurrencyCode(this.safeString(s,"currency")),n=this.safeCurrencyCode(this.safeString(r,"currency")),o={};o[a]=this.parseBalanceHelper(s),o[n]=this.parseBalanceHelper(r),l[i]=this.safeBalance(o)}else{l[this.safeCurrencyCode(this.safeString(e,"currency"))]=this.parseBalanceHelper(e)}}return u?l:this.safeBalance(l)}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);let n=!1;if([n,r]=this.handleOptionAndParams(r,"fetchOHLCV","paginate"),n)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,r,1e3);if(a.option)return await this.fetchOptionOHLCV(t,e,i,s,r);const o=this.safeString(r,"price");let d={};[d,r]=this.prepareRequest(a,void 0,r),d.interval=this.safeString(this.timeframes,e,e);const c=a.contract?1999:1e3;s=void 0===s?c:Math.min(s,c);let h,l=this.safeInteger(r,"until");if(void 0!==l&&(l=this.parseToInt(l/1e3),r=this.omit(r,"until")),void 0!==i){const t=this.parseTimeframe(e);d.from=this.parseToInt(i/1e3);const r=(s-1)*t,a=this.sum(d.from,r),n=this.seconds(),o=Math.min(a,n);d.to=void 0!==l?Math.min(o,l):o}else void 0!==l&&(d.to=l),d.limit=s;if(a.contract){("mark"===o||"index"===o)&&(d.contract=o+"_"+a.id,r=this.omit(r,"price")),a.future?h=await this.publicDeliveryGetSettleCandlesticks(this.extend(d,r)):a.swap&&(h=await this.publicFuturesGetSettleCandlesticks(this.extend(d,r)))}else h=await this.publicSpotGetCandlesticks(this.extend(d,r));return this.parseOHLCVs(h,a,e,i,s)}async fetchOptionOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const a=this.market(t);let n={};[n,r]=this.prepareRequest(a,void 0,r),n.interval=this.safeString(this.timeframes,e,e);const o=await this.publicOptionsGetCandlesticks(this.extend(n,r));return this.parseOHLCVs(o,a,e,i,s)}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new n.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),r)return await this.fetchPaginatedCallDeterministic("fetchFundingRateHistory",t,e,i,"8h",s);const a=this.market(t);if(!a.swap)throw new n.BadSymbol(this.id+" fetchFundingRateHistory() supports swap contracts only");let o={};[o,s]=this.prepareRequest(a,void 0,s),void 0!==i&&(o.limit=i),void 0!==e&&(o.from=this.parseToInt(e/1e3));const d=this.safeInteger(s,"until");void 0!==d&&(s=this.omit(s,"until"),o.to=this.parseToInt(d/1e3));const c=await this.publicFuturesGetSettleFundingRate(this.extend(o,s)),h=[];for(let e=0;e<c.length;e++){const i=c[e],s=this.safeTimestamp(i,"t");h.push({info:i,symbol:t,fundingRate:this.safeNumber(i,"r"),timestamp:s,datetime:this.iso8601(s)})}const l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,a.symbol,e,i)}parseOHLCV(t,e=void 0){return Array.isArray(t)?[this.safeTimestamp(t,0),this.safeNumber(t,5),this.safeNumber(t,3),this.safeNumber(t,4),this.safeNumber(t,2),this.safeNumber(t,6)]:[this.safeTimestamp(t,"t"),this.safeNumber(t,"o"),this.safeNumber(t,"h"),this.safeNumber(t,"l"),this.safeNumber(t,"c"),this.safeNumber(t,"v")]}async fetchTrades(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchTrades","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchTrades",t,e,i,s);const a=this.market(t),[o,d]=this.prepareRequest(a,void 0,s),c=this.safeInteger2(s,"to","until");let h;if(void 0!==c&&(s=this.omit(s,["until"]),o.to=this.parseToInt(c/1e3)),void 0!==i&&(o.limit=Math.min(i,1e3)),void 0!==e&&a.contract&&(o.from=this.parseToInt(e/1e3)),"spot"===a.type||"margin"===a.type)h=await this.publicSpotGetTrades(this.extend(o,d));else if(a.swap)h=await this.publicFuturesGetSettleTrades(this.extend(o,d));else if(a.future)h=await this.publicDeliveryGetSettleTrades(this.extend(o,d));else{if("option"!==a.type)throw new n.NotSupported(this.id+" fetchTrades() not support this market type.");h=await this.publicOptionsGetTrades(this.extend(o,d))}return this.parseTrades(h,a,e,i)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){if(void 0===e)throw new n.ArgumentsRequired(this.id+" fetchOrderTrades() requires a symbol argument");await this.loadMarkets();return await this.fetchMyTrades(e,i,s,{order_id:t})}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets(),await this.loadUnifiedStatus();let r,a,o=!1;if([o,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),o)return await this.fetchPaginatedCallDynamic("fetchMyTrades",t,e,i,s);let d={};const c=void 0!==t?this.market(t):void 0,h=this.safeInteger(s,"until");s=this.omit(s,["until"]),[r,s]=this.handleMarketTypeAndParams("fetchMyTrades",c,s);let l;if("swap"===r||"future"===r||"option"===r?([d,s]=this.prepareRequest(c,r,s),"option"===r&&(s=this.omit(s,"order_id"))):(void 0!==c&&(d.currency_pair=c.id),[a,s]=this.getMarginMode(!1,s),d.account=a),void 0!==i&&(d.limit=i),void 0!==e&&(d.from=this.parseToInt(e/1e3)),void 0!==h&&(d.to=this.parseToInt(h/1e3)),"spot"===r||"margin"===r)l=await this.privateSpotGetMyTrades(this.extend(d,s));else if("swap"===r)l=await this.privateFuturesGetSettleMyTradesTimerange(this.extend(d,s));else if("future"===r)l=await this.privateDeliveryGetSettleMyTrades(this.extend(d,s));else{if("option"!==r)throw new n.NotSupported(this.id+" fetchMyTrades() not support this market type.");l=await this.privateOptionsGetMyTrades(this.extend(d,s))}return this.parseTrades(l,c,e,i)}parseTrade(t,e=void 0){const i=this.safeString2(t,"id","trade_id");let s,a=this.safeString(t,"create_time_ms");void 0!==a?(a=r.Y.stringMul(a,"1000"),a=a.slice(0,13),s=this.parseToInt(a)):s=this.safeTimestamp2(t,"time","create_time");const n=this.safeString2(t,"currency_pair","contract"),o="contract"in t?"contract":"spot";e=this.safeMarket(n,e,"_",o);let d=this.safeString2(t,"amount","size");const c=this.safeString(t,"price"),h=r.Y.stringLt(d,"0")?"sell":"buy";d=r.Y.stringAbs(d);const l=this.safeString2(t,"side","type",h),u=this.safeString(t,"order_id"),p=this.safeString(t,"fee"),f=this.omitZero(this.safeString(t,"gt_fee")),m=this.omitZero(this.safeString(t,"point_fee")),g=[];if(void 0!==p){const i=this.safeString(t,"fee_currency");let s=this.safeCurrencyCode(i);void 0===s&&(s=this.safeString(e,"settle")),g.push({cost:p,currency:s})}void 0!==f&&g.push({cost:f,currency:"GT"}),void 0!==m&&g.push({cost:m,currency:"GATEPOINT"});const y=this.safeString(t,"role");return this.safeTrade({info:t,id:i,timestamp:s,datetime:this.iso8601(s),symbol:e.symbol,order:u,type:void 0,side:l,takerOrMaker:y,price:c,amount:d,cost:void 0,fee:void 0,fees:g},e)}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchDeposits","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchDeposits",t,e,i,s);let a,n={};if(void 0!==t&&(a=this.currency(t),n.currency=a.id),void 0!==i&&(n.limit=i),void 0!==e){const t=this.parseToInt(e/1e3);n.from=t,n.to=this.sum(t,2592e3)}[n,s]=this.handleUntilOption("to",n,s,.001);const o=await this.privateWalletGetDeposits(this.extend(n,s));return this.parseTransactions(o,a)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchWithdrawals","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchWithdrawals",t,e,i,s);let a,n={};if(void 0!==t&&(a=this.currency(t),n.currency=a.id),void 0!==i&&(n.limit=i),void 0!==e){const t=this.parseToInt(e/1e3);n.from=t,n.to=this.sum(t,2592e3)}[n,s]=this.handleUntilOption("to",n,s,.001);const o=await this.privateWalletGetWithdrawals(this.extend(n,s));return this.parseTransactions(o,a)}async withdraw(t,e,i,s=void 0,r={}){[s,r]=this.handleWithdrawTagAndParams(s,r),this.checkAddress(i),await this.loadMarkets();const a=this.currency(t),n={currency:a.id,address:i,amount:this.currencyToPrecision(t,e)};let o;void 0!==s&&(n.memo=s),[o,r]=this.handleNetworkCodeAndParams(r),void 0!==o&&(n.chain=this.networkCodeToId(o));const d=await this.privateWithdrawalsPostWithdrawals(this.extend(n,r));return this.parseTransaction(d,a)}parseTransactionStatus(t){return this.safeString({PEND:"pending",REQUEST:"pending",DMOVE:"pending",MANUAL:"pending",VERIFY:"pending",PROCES:"pending",EXTPEND:"pending",SPLITPEND:"pending",CANCEL:"canceled",FAIL:"failed",INVALID:"failed",DONE:"ok",BCODE:"ok"},t,t)}parseTransactionType(t){return this.safeString({d:"deposit",w:"withdrawal"},t,t)}parseTransaction(t,e=void 0){const i=this.safeString(t,"id");let s,a=this.safeString(t,"amount");void 0!==i&&("b"===i[0]?(s=r.Y.stringGt(a,"0")?"deposit":"withdrawal",a=r.Y.stringAbs(a)):s=this.parseTransactionType(i[0]));const n=this.safeString2(t,"fee","fee_amount");"withdrawal"===s&&(a=r.Y.stringSub(a,n));const o=this.safeStringUpper(t,"chain"),d=this.safeString(t,"currency"),c=this.safeCurrencyCode(d),h=this.safeString(t,"txid"),l=this.safeString(t,"status"),u=this.parseTransactionStatus(l),p=this.safeString(t,"address"),f=this.safeString(t,"memo"),m=this.safeTimestamp(t,"timestamp");return{info:t,id:i,txid:h,currency:c,amount:this.parseNumber(a),network:this.networkIdToCode(o),address:p,addressTo:void 0,addressFrom:void 0,tag:f,tagTo:void 0,tagFrom:void 0,status:u,type:s,timestamp:m,datetime:this.iso8601(m),updated:void 0,internal:void 0,comment:void 0,fee:{currency:c,cost:this.parseNumber(n)}}}async createOrder(t,e,i,s,r=void 0,a={}){await this.loadMarkets(),await this.loadUnifiedStatus();const n=this.market(t),o=this.safeValue(a,"trigger"),d=this.safeValue2(a,"triggerPrice","stopPrice"),c=this.safeValue(a,"stopLossPrice",d),h=this.safeValue(a,"takeProfitPrice"),l=!(void 0!==c||void 0!==h)&&void 0===o,u=this.createOrderRequest(t,e,i,s,r,a);let p;return p=n.spot||n.margin?l?await this.privateSpotPostOrders(u):await this.privateSpotPostPriceOrders(u):n.swap?l?await this.privateFuturesPostSettleOrders(u):await this.privateFuturesPostSettlePriceOrders(u):n.future?l?await this.privateDeliveryPostSettleOrders(u):await this.privateDeliveryPostSettlePriceOrders(u):await this.privateOptionsPostOrders(u),this.parseOrder(p,n)}createOrdersRequest(t,e={}){const i=[],s=[],r=t.length;if(0===r)throw new n.BadRequest(this.id+" createOrders() requires at least one order");if(r>10)throw new n.BadRequest(this.id+" createOrders() accepts a maximum of 10 orders at a time");for(let r=0;r<t.length;r++){const a=t[r],o=this.safeString(a,"symbol");s.push(o);const d=this.safeString(a,"type"),c=this.safeString(a,"side"),h=this.safeValue(a,"amount"),l=this.safeValue(a,"price"),u=this.safeValue(a,"params",{}),p=this.extend(u,e);if(void 0!==this.safeValueN(u,["triggerPrice","stopPrice","takeProfitPrice","stopLossPrice"]))throw new n.NotSupported(this.id+" createOrders() does not support advanced order properties (stopPrice, takeProfitPrice, stopLossPrice)");p.textIsRequired=!0;const f=this.createOrderRequest(o,d,c,h,l,p);i.push(f)}const a=this.marketSymbols(s,void 0,!1,!0,!0),o=this.market(a[0]);if(o.future||o.option)throw new n.NotSupported(this.id+" createOrders() does not support futures or options markets");return i}async createOrders(t,e={}){await this.loadMarkets(),await this.loadUnifiedStatus();const i=this.createOrdersRequest(t,e),s=t[0],r=this.market(s.symbol);let a;return r.spot?a=await this.privateSpotPostBatchOrders(i):r.swap&&(a=await this.privateFuturesPostSettleBatchOrders(i)),this.parseOrders(a)}createOrderRequest(t,e,i,s,a=void 0,o={}){const d=this.market(t),c=d.contract,h=this.safeValue(o,"trigger"),l=this.safeValue2(o,"triggerPrice","stopPrice"),u=this.safeValue(o,"stopLossPrice",l),p=this.safeValue(o,"takeProfitPrice"),f=void 0!==u,m=void 0!==p,g=f||m;if(f&&m)throw new n.ExchangeError(this.id+" createOrder() stopLossPrice and takeProfitPrice cannot both be defined");const y=this.safeValue(o,"reduceOnly"),v=this.safeStringLowerN(o,["timeInForce","tif","time_in_force"]);let b;[b,o]=this.handlePostOnly("market"===e,"poc"===v,o);let w=this.handleTimeInForce(o);b&&(w="poc"),o=this.omit(o,["stopPrice","triggerPrice","stopLossPrice","takeProfitPrice","reduceOnly","timeInForce","postOnly"]);const S="limit"===e,k="market"===e;if(S&&void 0===a)throw new n.ArgumentsRequired(this.id+" createOrder () requires a price argument for "+e+" orders");if(k){if("poc"===w||"gtc"===w)throw new n.ExchangeError(this.id+' createOrder () timeInForce for market order can only be "FOK" or "IOC"');if(void 0===w){const t=this.safeString(this.options,"defaultTimeInForce","IOC");w=this.safeString(this.options.timeInForce,t,"ioc")}c&&(a=0)}if(c){if(this.safeValue(o,"close"))s=0;else{const e=this.amountToPrecision(t,s),a="sell"===i?r.Y.stringNeg(e):e;s=parseInt(a)}}let O;if(!g&&void 0===h){if(c)O={contract:d.id,size:s},d.option||(O.settle=d.settleId),O.price=k||0===a?"0":this.priceToPrecision(t,a),void 0!==y&&(O.reduce_only=y),void 0!==w&&(O.tif=w);else{let c;if([c,o]=this.getMarginMode(!1,o),O={currency_pair:d.id,type:e,account:c,side:i},k&&"buy"===i){let e,i=!0;[i,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0);const d=this.safeNumber(o,"cost");if(o=this.omit(o,"cost"),void 0!==d)e=this.costToPrecision(t,d);else if(i){if(void 0===a)throw new n.InvalidOrder(this.id+" createOrder() requires the price argument for market buy orders to calculate the total cost to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend (quote quantity) in the amount argument");{const i=this.numberToString(s),n=this.numberToString(a),o=r.Y.stringMul(i,n);e=this.costToPrecision(t,o)}}else e=this.costToPrecision(t,s);O.amount=e}else O.amount=this.amountToPrecision(t,s);S&&(O.price=this.priceToPrecision(t,a)),void 0!==w&&(O.time_in_force=w)}let h=this.safeString2(o,"text","clientOrderId");const l=this.safeBool(o,"textIsRequired",!1);if(void 0!==h){if(h.length>28)throw new n.BadRequest(this.id+" createOrder () clientOrderId or text param must be up to 28 characters");o=this.omit(o,["text","clientOrderId","textIsRequired"]),"t"!==h[0]&&(h="t-"+h),O.text=h}else l&&(O.text="t-"+this.uuid16())}else{if(d.option)throw new n.NotSupported(this.id+" createOrder() conditional option orders are not supported");if(c){if(O={initial:{contract:d.id,size:s},settle:d.settleId},O.initial.price="market"===e||0===a?"0":this.priceToPrecision(t,a),void 0===h){let e,s;f?(e="buy"===i?1:2,s=this.priceToPrecision(t,u)):m&&(e="buy"===i?2:1,s=this.priceToPrecision(t,p));const r=this.safeInteger(o,"price_type",0);if(r<0||r>2)throw new n.BadRequest(this.id+" createOrder () price_type should be 0 latest deal price, 1 mark price, 2 index price");o=this.omit(o,["price_type"]),O.trigger={price_type:r,price:this.priceToPrecision(t,s),rule:e}}void 0!==y&&(O.initial.reduce_only=y),void 0!==w&&(O.initial.tif=w)}else{const r=this.safeValue(this.options,"createOrder",{});let n;if([n,o]=this.getMarginMode(!0,o),void 0===w&&(w="gtc"),O={put:{type:e,side:i,price:this.priceToPrecision(t,a),amount:this.amountToPrecision(t,s),account:n,time_in_force:w},market:d.id},void 0===h){const e=this.safeInteger(r,"expiration"),s=this.safeInteger(o,"expiration",e);let a,n;f?(a="buy"===i?">=":"<=",n=this.priceToPrecision(t,u)):m&&(a="buy"===i?"<=":">=",n=this.priceToPrecision(t,p)),O.trigger={price:this.priceToPrecision(t,n),rule:a,expiration:s}}}}return this.extend(O,o)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets(),await this.loadUnifiedStatus();if(!this.market(t).spot)throw new n.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");return i.createMarketBuyOrderRequiresPrice=!1,await this.createOrder(t,"market","buy",e,void 0,i)}editOrderRequest(t,e,i,s,a=void 0,o=void 0,d={}){const c=this.market(e);let h;[h,d]=this.handleMarketTypeAndParams("editOrder",c,d);let l=this.convertTypeToAccount(h),u=!1;[u,d]=this.handleOptionAndParams(d,"editOrder","unifiedAccount"),u&&(l="unified");if("spot"===l&&!("limit"===i))throw new n.InvalidOrder(this.id+" editOrder() does not support "+i+" orders for "+h+" markets");const p={order_id:t.toString(),currency_pair:c.id,account:l};return void 0!==a&&(c.spot?p.amount=this.amountToPrecision(e,a):p.size="sell"===s?this.parseToNumeric(r.Y.stringNeg(this.amountToPrecision(e,a))):this.parseToNumeric(this.amountToPrecision(e,a))),void 0!==o&&(p.price=this.priceToPrecision(e,o)),c.spot||(p.settle=c.settleId),this.extend(p,d)}async editOrder(t,e,i,s,r=void 0,a=void 0,n={}){await this.loadMarkets(),await this.loadUnifiedStatus();const o=this.market(e),d=this.editOrderRequest(t,e,i,s,r,a,n);let c;return c=o.spot?await this.privateSpotPatchOrdersOrderId(d):await this.privateFuturesPutSettleOrdersOrderId(d),this.parseOrder(c,o)}parseOrderStatus(t){return this.safeString({open:"open",_new:"open",filled:"closed",cancelled:"canceled",liquidated:"closed",ioc:"canceled",failed:"canceled",expired:"canceled",finished:"closed",finish:"closed",succeeded:"closed"},t,t)}parseOrder(t,e=void 0){if(!this.safeBool(t,"succeeded",!0))return this.safeOrder({clientOrderId:this.safeString(t,"text"),info:t,status:"rejected",id:this.safeString(t,"id")});const i=this.safeValue2(t,"put","initial",{}),s=this.safeValue(t,"trigger",{});let a=this.safeString(i,"contract"),n=this.safeString(i,"type"),o=this.safeStringUpper2(i,"time_in_force","tif"),d=this.safeString2(i,"amount","size"),c=this.safeString(i,"side"),h=this.safeString(i,"price");a=this.safeString(t,"contract",a),n=this.safeString(t,"type",n),o=this.safeStringUpper2(t,"time_in_force","tif",o),"POC"===o&&(o="PO");const l="PO"===o;d=this.safeString2(t,"amount","size",d),c=this.safeString(t,"side",c),h=this.safeString(t,"price",h);let u=this.safeString(t,"left"),p=this.safeString(t,"filled_total");const f=this.safeNumber(s,"price");let m=this.safeNumber2(t,"avg_deal_price","fill_price");if(f&&(u=d,p="0"),a){n=r.Y.stringEquals(h,"0")&&"IOC"===o?"market":"limit",c=r.Y.stringGt(d,"0")?"buy":"sell"}const g=this.safeStringN(t,["finish_as","status","open"]);let y=this.safeInteger(t,"create_time_ms");void 0===y&&(y=this.safeTimestamp2(t,"create_time","ctime"));let v=this.safeInteger(t,"update_time_ms");void 0===v&&(v=this.safeTimestamp2(t,"update_time","finish_time"));let b="contract";("currency_pair"in t||"market"in t)&&(b="spot");const w=this.safeString2(t,"currency_pair","market",a),S=this.safeSymbol(w,e,"_",b),k=[],O=this.safeString(t,"gt_fee");void 0!==O&&k.push({currency:"GT",cost:O});const T=this.safeString(t,"fee");void 0!==T&&k.push({currency:this.safeCurrencyCode(this.safeString(t,"fee_currency")),cost:T});const P=this.safeString(t,"rebated_fee");void 0!==P&&k.push({currency:this.safeCurrencyCode(this.safeString(t,"rebated_fee_currency")),cost:r.Y.stringNeg(P)});const _=k.length>1,A=this.parseOrderStatus(g);let I=r.Y.stringAbs(u);if("spot"===this.safeString(t,"account")){const e=this.safeString(t,"avg_deal_price");m=this.parseNumber(e),"market"===n&&"buy"===c&&(I=r.Y.stringDiv(u,e),h=void 0,p=d,d=r.Y.stringDiv(d,e))}return this.safeOrder({id:this.safeString(t,"id"),clientOrderId:this.safeString(t,"text"),timestamp:y,datetime:this.iso8601(y),lastTradeTimestamp:v,status:A,symbol:S,type:n,timeInForce:o,postOnly:l,reduceOnly:this.safeValue(t,"is_reduce_only"),side:c,price:h,triggerPrice:f,average:m,amount:r.Y.stringAbs(d),cost:r.Y.stringAbs(p),filled:void 0,remaining:I,fee:_?void 0:this.safeValue(k,0),fees:_?k:[],trades:void 0,info:t},e)}fetchOrderRequest(t,e=void 0,i={}){const s=void 0===e?void 0:this.market(e),r=this.safeBoolN(i,["trigger","is_stop_order","stop"],!1);i=this.omit(i,["is_stop_order","stop","trigger"]);let a=this.safeString2(i,"text","clientOrderId"),n=t;void 0!==a&&(i=this.omit(i,["text","clientOrderId"]),"t"!==a[0]&&(a="t-"+a),n=a);const[o,d]=this.handleMarketTypeAndParams("fetchOrder",s,i),c="swap"===o||"future"===o||"option"===o,[h,l]=c?this.prepareRequest(s,o,d):this.spotOrderPrepareRequest(s,r,d);return h.order_id=n.toString(),[h,l]}async fetchOrder(t,e=void 0,i={}){await this.loadMarkets(),await this.loadUnifiedStatus();const s=void 0===e?void 0:this.market(e),r=this.handleMarketTypeAndParams("fetchOrder",s,i),a=this.safeString(r,0),o=this.safeBoolN(i,["trigger","is_stop_order","stop"],!1),[d,c]=this.fetchOrderRequest(t,e,i);let h;if("spot"===a||"margin"===a)h=o?await this.privateSpotGetPriceOrdersOrderId(this.extend(d,c)):await this.privateSpotGetOrdersOrderId(this.extend(d,c));else if("swap"===a)h=o?await this.privateFuturesGetSettlePriceOrdersOrderId(this.extend(d,c)):await this.privateFuturesGetSettleOrdersOrderId(this.extend(d,c));else if("future"===a)h=o?await this.privateDeliveryGetSettlePriceOrdersOrderId(this.extend(d,c)):await this.privateDeliveryGetSettleOrdersOrderId(this.extend(d,c));else{if("option"!==a)throw new n.NotSupported(this.id+" fetchOrder() not support this market type");h=await this.privateOptionsGetOrdersOrderId(this.extend(d,c))}return this.parseOrder(h,s)}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchOrdersByStatus("open",t,e,i,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets(),await this.loadUnifiedStatus();const r=this.safeInteger(s,"until");let a;void 0!==t&&(a=this.market(t),t=a.symbol);const n=this.handleMarketTypeAndParams("fetchClosedOrders",a,s),o=this.safeString(n,0);let d=!1;if([d,s]=this.handleOptionAndParams(s,"fetchClosedOrders","historical",!1),!d&&(void 0===e&&void 0===r||"swap"!==o))return await this.fetchOrdersByStatus("finished",t,e,i,s);s=this.omit(s,"type");let c={};[c,s]=this.prepareRequest(a,o,s),void 0!==e&&(c.from=this.parseToInt(e/1e3)),void 0!==r&&(s=this.omit(s,"until"),c.to=this.parseToInt(r/1e3)),void 0!==i&&(c.limit=i);const h=await this.privateFuturesGetSettleOrdersTimerange(this.extend(c,s));return this.parseOrders(h,a,e,i)}prepareOrdersByStatusRequest(t,e=void 0,i=void 0,s=void 0,r={}){let a,n,o;void 0!==e&&(a=this.market(e),e=a.symbol),[n,r]=this.handleParamBool2(r,"trigger","stop"),[o,r]=this.handleMarketTypeAndParams("fetchOrdersByStatus",a,r);const d="spot"===o||"margin"===o;let c={};if([c,r]=d?this.multiOrderSpotPrepareRequest(a,n,r):this.prepareRequest(a,o,r),d&&n&&(c=this.omit(c,"account")),"closed"===t&&(t="finished"),c.status=t,void 0!==s&&(c.limit=s),d){void 0!==i&&(c.from=this.parseToInt(i/1e3));const t=this.safeInteger(r,"until");void 0!==t&&(r=this.omit(r,"until"),c.to=this.parseToInt(t/1e3))}const[h,l]=this.handleParamString2(r,"lastId","last_id");return void 0!==h&&(c.last_id=h),[c,l]}async fetchOrdersByStatus(t,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),await this.loadUnifiedStatus(),void 0!==e&&(a=this.market(e),e=a.symbol);const o=this.safeBool2(r,"trigger","stop"),d=this.handleMarketTypeAndParams("fetchOrdersByStatus",a,r),c=this.safeString(d,0),[h,l]=this.prepareOrdersByStatusRequest(t,e,i,s,r),u="spot"===c||"margin"===c,p="open"===t,f=u&&p&&!o;let m;if(u)m=o?await this.privateSpotGetPriceOrders(this.extend(h,l)):p?await this.privateSpotGetOpenOrders(this.extend(h,l)):await this.privateSpotGetOrders(this.extend(h,l));else if("swap"===c)m=o?await this.privateFuturesGetSettlePriceOrders(this.extend(h,l)):await this.privateFuturesGetSettleOrders(this.extend(h,l));else if("future"===c)m=o?await this.privateDeliveryGetSettlePriceOrders(this.extend(h,l)):await this.privateDeliveryGetSettleOrders(this.extend(h,l));else{if("option"!==c)throw new n.NotSupported(this.id+" fetchOrders() not support this market type");m=await this.privateOptionsGetOrders(this.extend(h,l))}let g=m;if(f){g=[];for(let t=0;t<m.length;t++){const e=this.safeValue(m[t],"orders");g=this.arrayConcat(g,e)}}const y=this.parseOrders(g,a,i,s);return this.filterBySymbolSinceLimit(y,e,i,s)}async cancelOrder(t,e=void 0,i={}){await this.loadMarkets(),await this.loadUnifiedStatus();const s=void 0===e?void 0:this.market(e),r=this.safeBoolN(i,["is_stop_order","stop","trigger"],!1);i=this.omit(i,["is_stop_order","stop","trigger"]);const[a,o]=this.handleMarketTypeAndParams("cancelOrder",s,i),[d,c]="spot"===a||"margin"===a?this.spotOrderPrepareRequest(s,r,o):this.prepareRequest(s,a,o);let h;if(d.order_id=t,"spot"===a||"margin"===a)h=r?await this.privateSpotDeletePriceOrdersOrderId(this.extend(d,c)):await this.privateSpotDeleteOrdersOrderId(this.extend(d,c));else if("swap"===a)h=r?await this.privateFuturesDeleteSettlePriceOrdersOrderId(this.extend(d,c)):await this.privateFuturesDeleteSettleOrdersOrderId(this.extend(d,c));else if("future"===a)h=r?await this.privateDeliveryDeleteSettlePriceOrdersOrderId(this.extend(d,c)):await this.privateDeliveryDeleteSettleOrdersOrderId(this.extend(d,c));else{if("option"!==a)throw new n.NotSupported(this.id+" cancelOrder() not support this market type");h=await this.privateOptionsDeleteOrdersOrderId(this.extend(d,c))}return this.parseOrder(h,s)}async cancelOrders(t,e=void 0,i={}){let s,r;await this.loadMarkets(),await this.loadUnifiedStatus(),void 0!==e&&(s=this.market(e));const a=void 0===s?"usdt":s.settle,o=this.safeStringLower(i,"settle",a);[r,i]=this.handleMarketTypeAndParams("cancelOrders",s,i);const d="spot"===r;if(d&&void 0===e)throw new n.ArgumentsRequired(this.id+" cancelOrders requires a symbol argument for spot markets");if(d){const s=[];for(let i=0;i<t.length;i++){const r={id:t[i],symbol:e};s.push(r)}return await this.cancelOrdersForSymbols(s,i)}const c=[{settle:o}];for(let e=0;e<t.length;e++)c.push(t[e]);const h=await this.privateFuturesPostSettleBatchCancelOrders(c);return this.parseOrders(h)}async cancelOrdersForSymbols(t,e={}){await this.loadMarkets(),await this.loadUnifiedStatus();const i=[];for(let e=0;e<t.length;e++){const s=t[e],r=this.safeString(s,"symbol"),a=this.market(r);if(!a.spot)throw new n.NotSupported(this.id+" cancelOrdersForSymbols() supports only spot markets");const o={id:this.safeString(s,"id"),currency_pair:a.id};i.push(o)}const s=await this.privateSpotPostCancelBatchOrders(i);return this.parseOrders(s)}async cancelAllOrders(t=void 0,e={}){await this.loadMarkets(),await this.loadUnifiedStatus();const i=void 0===t?void 0:this.market(t),s=this.safeBool2(e,"stop","trigger");e=this.omit(e,["stop","trigger"]);const[r,a]=this.handleMarketTypeAndParams("cancelAllOrders",i,e),[o,d]="spot"===r?this.multiOrderSpotPrepareRequest(i,s,a):this.prepareRequest(i,r,a);let c;if("spot"===r||"margin"===r)c=s?await this.privateSpotDeletePriceOrders(this.extend(o,d)):await this.privateSpotDeleteOrders(this.extend(o,d));else if("swap"===r)c=s?await this.privateFuturesDeleteSettlePriceOrders(this.extend(o,d)):await this.privateFuturesDeleteSettleOrders(this.extend(o,d));else if("future"===r)c=s?await this.privateDeliveryDeleteSettlePriceOrders(this.extend(o,d)):await this.privateDeliveryDeleteSettleOrders(this.extend(o,d));else{if("option"!==r)throw new n.NotSupported(this.id+" cancelAllOrders() not support this market type");c=await this.privateOptionsDeleteOrders(this.extend(o,d))}return this.parseOrders(c,i)}async transfer(t,e,i,s,r={}){await this.loadMarkets();const a=this.currency(t),o=this.convertTypeToAccount(i),d=this.convertTypeToAccount(s),c=this.currencyToPrecision(t,e),h={currency:a.id,amount:c};if(o in this.options.accountsByType?h.from=o:(h.from="margin",h.currency_pair=o),d in this.options.accountsByType?h.to=d:(h.to="margin",h.currency_pair=d),"margin"===o||"margin"===d){const t=this.safeString2(r,"symbol","currency_pair");if(void 0===t)throw new n.ArgumentsRequired(this.id+' transfer requires params["symbol"] for isolated margin transfers');const e=this.market(t);h.currency_pair=e.id,r=this.omit(r,"symbol")}"futures"!==d&&"delivery"!==d&&"futures"!==o&&"delivery"!==o||(h.settle=a.id);const l=await this.privateWalletPostTransfers(this.extend(h,r));return this.parseTransfer(l,a)}parseTransfer(t,e=void 0){return{id:this.safeString(t,"tx_id"),timestamp:void 0,datetime:void 0,currency:this.safeCurrencyCode(void 0,e),amount:void 0,fromAccount:void 0,toAccount:void 0,status:void 0,info:t}}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new n.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");if(t<0||t>100)throw new n.BadRequest(this.id+" setLeverage() leverage should be between 1 and 100");await this.loadMarkets();const s=this.market(e),[r,a]=this.prepareRequest(s,void 0,i),o=this.safeString2(this.options,"marginMode","defaultMarginMode"),d=this.safeString(a,"cross_leverage_limit");let c,h=this.safeString(a,"marginMode",o),l=this.numberToString(t);if(void 0!==d&&(h="cross",l=d),"cross"===h||"cross_margin"===h?(r.cross_leverage_limit=l,r.leverage="0"):r.leverage=l,s.swap)c=await this.privateFuturesPostSettlePositionsContractLeverage(this.extend(r,a));else{if(!s.future)throw new n.NotSupported(this.id+" setLeverage() not support this market type");c=await this.privateDeliveryPostSettlePositionsContractLeverage(this.extend(r,a))}return c}parsePosition(t,e=void 0){const i=this.safeString(t,"contract");e=this.safeMarket(i,e,"_","contract");const s=this.safeString2(t,"size","accum_size");let a=this.safeString(t,"side");void 0===a&&(r.Y.stringGt(s,"0")?a="long":r.Y.stringLt(s,"0")&&(a="short"));const n=this.safeString(t,"maintenance_rate"),o=this.safeString(t,"value"),d=this.safeString(t,"leverage");let c;void 0!==d&&(c="0"===d?"cross":"isolated");let h,l=this.safeString(t,"pnl_fee");if(void 0===l){const t="0.00075";l=r.Y.stringMul(t,o),h=r.Y.stringAdd(r.Y.stringDiv(o,d),l)}let u=this.safeTimestamp2(t,"open_time","first_open_time");return 0===u&&(u=void 0),this.safePosition({info:t,id:void 0,symbol:this.safeString(e,"symbol"),timestamp:u,datetime:this.iso8601(u),lastUpdateTimestamp:this.safeTimestamp2(t,"update_time","time"),initialMargin:this.parseNumber(h),initialMarginPercentage:this.parseNumber(r.Y.stringDiv(h,o)),maintenanceMargin:this.parseNumber(r.Y.stringMul(n,o)),maintenanceMarginPercentage:this.parseNumber(n),entryPrice:this.safeNumber(t,"entry_price"),notional:this.parseNumber(o),leverage:this.safeNumber(t,"leverage"),unrealizedPnl:this.safeNumber(t,"unrealised_pnl"),realizedPnl:this.safeNumber2(t,"realised_pnl","pnl"),contracts:this.parseNumber(r.Y.stringAbs(s)),contractSize:this.safeNumber(e,"contractSize"),marginRatio:void 0,liquidationPrice:this.safeNumber(t,"liq_price"),markPrice:this.safeNumber(t,"mark_price"),lastPrice:void 0,collateral:this.safeNumber(t,"margin"),marginMode:c,side:a,percentage:void 0,stopLossPrice:void 0,takeProfitPrice:void 0})}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.contract)throw new n.BadRequest(this.id+" fetchPosition() supports contract markets only");let s={};[s,e]=this.prepareRequest(i,i.type,e);const r=this.extend(s,e);let a;return i.swap?a=await this.privateFuturesGetSettlePositionsContract(r):i.future?a=await this.privateDeliveryGetSettlePositionsContract(r):"option"===i.type&&(a=await this.privateOptionsGetPositionsContract(r)),this.parsePosition(a,i)}async fetchPositions(t=void 0,e={}){let i,s;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t,void 0,!0,!0,!0))){t.length>0&&(i=this.market(t[0]))}let r,a={};if([s,e]=this.handleMarketTypeAndParams("fetchPositions",i,e),void 0!==s&&"spot"!==s||(s="swap"),"option"===s){if(void 0!==t){const t=i.id.split("-");a.underlying=this.safeString(t,0)}}else[a,e]=this.prepareRequest(void 0,s,e);return"swap"===s?r=await this.privateFuturesGetSettlePositions(this.extend(a,e)):"future"===s?r=await this.privateDeliveryGetSettlePositions(this.extend(a,e)):"option"===s&&(r=await this.privateOptionsGetPositions(this.extend(a,e))),this.parsePositions(r,t)}async fetchLeverageTiers(t=void 0,e={}){await this.loadMarkets();const[i,s]=this.handleMarketTypeAndParams("fetchLeverageTiers",void 0,e),[r,a]=this.prepareRequest(void 0,i,s);if("future"!==i&&"swap"!==i)throw new n.BadRequest(this.id+" fetchLeverageTiers only supports swap and future");let o;if("swap"===i)o=await this.publicFuturesGetSettleContracts(this.extend(r,a));else{if("future"!==i)throw new n.NotSupported(this.id+" fetchLeverageTiers() not support this market type");o=await this.publicDeliveryGetSettleContracts(this.extend(r,a))}return this.parseLeverageTiers(o,t,"name")}async fetchMarketLeverageTiers(t,e={}){await this.loadMarkets();const i=this.market(t),[s,r]=this.handleMarketTypeAndParams("fetchMarketLeverageTiers",i,e),[a,o]=this.prepareRequest(i,s,r);if("future"!==s&&"swap"!==s)throw new n.BadRequest(this.id+" fetchMarketLeverageTiers only supports swap and future");const d=await this.publicFuturesGetSettleRiskLimitTiers(this.extend(a,o));return this.parseMarketLeverageTiers(d,i)}parseEmulatedLeverageTiers(t,e=void 0){const i=this.safeString(t,"name"),s=this.safeString(t,"maintenance_rate"),a=this.safeString(t,"leverage_max"),n=this.safeString(t,"risk_limit_step"),o=this.safeString(t,"risk_limit_max"),d=r.Y.stringDiv("1",a);let c=s,h=d,l="0";const u=[];for(;r.Y.stringLt(l,o);){const a=r.Y.stringAdd(l,n);u.push({tier:this.parseNumber(r.Y.stringDiv(a,n)),symbol:this.safeSymbol(i,e,void 0,"contract"),currency:this.safeString(e,"settle"),minNotional:this.parseNumber(l),maxNotional:this.parseNumber(a),maintenanceMarginRate:this.parseNumber(c),maxLeverage:this.parseNumber(r.Y.stringDiv("1",h)),info:t}),c=r.Y.stringAdd(c,s),h=r.Y.stringAdd(h,d),l=a}return u}parseMarketLeverageTiers(t,e=void 0){if(!Array.isArray(t))return this.parseEmulatedLeverageTiers(t,e);let i=0;const s=[];for(let r=0;r<t.length;r++){const a=t[r],n=this.safeNumber(a,"risk_limit");s.push({tier:this.sum(r,1),symbol:e.symbol,currency:e.base,minNotional:i,maxNotional:n,maintenanceMarginRate:this.safeNumber(a,"maintenance_rate"),maxLeverage:this.safeNumber(a,"leverage_max"),info:a}),i=n}return s}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a={currency:r.id.toUpperCase(),amount:this.currencyToPrecision(e,i)},n=this.market(t);a.currency_pair=n.id,a.type="repay";const o=await this.privateMarginPostUniLoans(this.extend(a,s));return this.parseMarginLoan(o,r)}async repayCrossMargin(t,e,i={}){await this.loadMarkets(),await this.loadUnifiedStatus();const s=this.currency(t),r={currency:s.id.toUpperCase(),amount:this.currencyToPrecision(t,e)};let a,n=!1;return[n,i]=this.handleOptionAndParams(i,"repayCrossMargin","unifiedAccount"),n?(r.type="repay",a=await this.privateUnifiedPostLoans(this.extend(r,i))):(a=await this.privateMarginPostCrossRepayments(this.extend(r,i)),a=this.safeDict(a,0)),this.parseMarginLoan(a,s)}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a={currency:r.id.toUpperCase(),amount:this.currencyToPrecision(e,i)};let n;const o=this.market(t);return a.currency_pair=o.id,a.type="borrow",n=await this.privateMarginPostUniLoans(this.extend(a,s)),this.parseMarginLoan(n,r)}async borrowCrossMargin(t,e,i={}){await this.loadMarkets(),await this.loadUnifiedStatus();const s=this.currency(t),r={currency:s.id.toUpperCase(),amount:this.currencyToPrecision(t,e)};let a,n=!1;return[n,i]=this.handleOptionAndParams(i,"borrowCrossMargin","unifiedAccount"),n?(r.type="borrow",a=await this.privateUnifiedPostLoans(this.extend(r,i))):a=await this.privateMarginPostCrossLoans(this.extend(r,i)),this.parseMarginLoan(a,s)}parseMarginLoan(t,e=void 0){const i=this.safeString2(this.options,"defaultMarginMode","marginMode","cross");let s=this.safeInteger(t,"create_time");"isolated"===i&&(s=this.safeTimestamp(t,"create_time"));const r=this.safeString(t,"currency"),a=this.safeString(t,"currency_pair");return{id:this.safeInteger(t,"id"),currency:this.safeCurrencyCode(r,e),amount:this.safeNumber(t,"amount"),symbol:this.safeSymbol(a,void 0,"_","margin"),timestamp:s,datetime:this.iso8601(s),info:t}}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets(),await this.loadUnifiedStatus();let a=!1;[a,r]=this.handleOptionAndParams(r,"fetchBorrowInterest","unifiedAccount");let n,o,d,c,h={};[h,r]=this.handleUntilOption("to",h,r),void 0!==t&&(n=this.currency(t),h.currency=n.id),void 0!==e&&(o=this.market(e)),void 0!==i&&(h.from=i),void 0!==s&&(h.limit=s),[c,r]=this.handleMarginModeAndParams("fetchBorrowInterest",r,"cross"),a?d=await this.privateUnifiedGetInterestRecords(this.extend(h,r)):"isolated"===c?(void 0!==o&&(h.currency_pair=o.id),d=await this.privateMarginGetUniInterestRecords(this.extend(h,r))):"cross"===c&&(d=await this.privateMarginGetCrossInterestRecords(this.extend(h,r)));const l=this.parseBorrowInterests(d,o);return this.filterByCurrencySinceLimit(l,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"currency_pair");e=this.safeMarket(i,e);const s=void 0!==i?"isolated":"cross",r=this.safeInteger(t,"create_time");return{info:t,symbol:this.safeString(e,"symbol"),currency:this.safeCurrencyCode(this.safeString(t,"currency")),interest:this.safeNumber(t,"interest"),interestRate:this.safeNumber(t,"actual_rate"),amountBorrowed:void 0,marginMode:s,timestamp:r,datetime:this.iso8601(r)}}nonce(){return this.milliseconds()-this.options.timeDifference}sign(t,e=[],i="GET",s={},r=void 0,a=void 0){const d=e[0],c=e[1];let h=this.omit(s,this.extractParams(t));if(t.indexOf("settle")>-1&&t.endsWith("batch_cancel_orders")){const e=this.safeDict(s,0);t=this.implodeParams(t,e);const i=[],r=s;for(let t=1;t<r.length;t++)i.push(s[t]);s=i,h=i}else if(Array.isArray(s)){const e=this.safeValue(s,0,{});t=this.implodeParams(t,e)}else t=this.implodeParams(t,s);const l=""===t?"":"/"+t;let u="/"+c+l;"subAccounts"!==c&&"withdrawals"!==c||(u=l);let p=this.urls.api[d][c];if(void 0===p)throw new n.NotSupported(this.id+" does not have a testnet for the "+c+" market type.");if(p+=u,"public"===d)Object.keys(h).length&&(p+="?"+this.urlencode(h));else{this.checkRequiredCredentials();let e="",s=!1;if(("futures"===c||"delivery"===c)&&"POST"===i){const e=t.split("/"),i=this.safeString(e,1,"");s=i.indexOf("dual")>=0||i.indexOf("positions")>=0}if("GET"===i||"DELETE"===i||s||"PATCH"===i)Object.keys(h).length&&(e=this.urlencode(h),e.indexOf("currencies=")>=0&&e.indexOf("%2C")>=0&&(e=e.replaceAll("%2C",",")),p+="?"+e),"PATCH"===i&&(a=this.json(h));else{const t=this.safeValue(h,"query",{});Object.keys(t).length&&(e=this.urlencode(t),p+="?"+e),h=this.omit(h,"query"),a=this.json(h)}const n=void 0===a?"":a,d=this.hash(this.encode(n),o.Zf),l=this.nonce(),f=this.parseToInt(l/1e3).toString(),m="/api/"+this.version+u,g=[i.toUpperCase(),m,e,d,f].join("\n"),y=this.hmac(this.encode(g),this.encode(this.secret),o.Zf);r={KEY:this.apiKey,Timestamp:f,SIGN:y,"Content-Type":"application/json"}}return{url:p,method:i,body:a,headers:r}}async modifyMarginHelper(t,e,i={}){await this.loadMarkets();const s=this.market(t),[r,a]=this.prepareRequest(s,void 0,i);let o;if(r.change=this.numberToString(e),s.swap)o=await this.privateFuturesPostSettlePositionsContractMargin(this.extend(r,a));else{if(!s.future)throw new n.NotSupported(this.id+" modifyMarginHelper() not support this market type");o=await this.privateDeliveryPostSettlePositionsContractMargin(this.extend(r,a))}return this.parseMarginModification(o,s)}parseMarginModification(t,e=void 0){const i=this.safeString(t,"contract");e=this.safeMarket(i,e,"_","contract");const s=this.safeNumber(t,"margin");return{info:t,symbol:e.symbol,type:void 0,marginMode:"isolated",amount:void 0,total:s,code:this.safeValue(e,"quote"),status:"ok",timestamp:void 0,datetime:void 0}}async reduceMargin(t,e,i={}){return await this.modifyMarginHelper(t,-e,i)}async addMargin(t,e,i={}){return await this.modifyMarginHelper(t,e,i)}async fetchOpenInterestHistory(t,e="5m",i=void 0,s=void 0,r={}){await this.loadMarkets();let a=!1;if([a,r]=this.handleOptionAndParams(r,"fetchOpenInterestHistory","paginate",!1),a)return await this.fetchPaginatedCallDeterministic("fetchOpenInterestHistory",t,i,s,e,r,100);const o=this.market(t);if(!o.swap)throw new n.BadRequest(this.id+" fetchOpenInterest() supports swap markets only");const d={contract:o.id,settle:o.settleId,interval:this.safeString(this.timeframes,e,e)};void 0!==s&&(d.limit=s),void 0!==i&&(d.from=i);const c=await this.publicFuturesGetSettleContractStats(this.extend(d,r));return this.parseOpenInterestsHistory(c,o,i,s)}parseOpenInterest(t,e=void 0){const i=this.safeTimestamp(t,"time");return{symbol:this.safeString(e,"symbol"),openInterestAmount:this.safeNumber(t,"open_interest"),openInterestValue:this.safeNumber(t,"open_interest_usd"),timestamp:i,datetime:this.iso8601(i),info:t}}async fetchSettlementHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new n.ArgumentsRequired(this.id+" fetchSettlementHistory() requires a symbol argument");await this.loadMarkets();const r=this.market(t);let a;if([a,s]=this.handleMarketTypeAndParams("fetchSettlementHistory",r,s),"option"!==a)throw new n.NotSupported(this.id+" fetchSettlementHistory() supports option markets only");const o=r.id.split("-"),d={underlying:this.safeString(o,0)};void 0!==e&&(d.from=e),void 0!==i&&(d.limit=i);const c=await this.publicOptionsGetSettlements(this.extend(d,s)),h=this.parseSettlements(c,r),l=this.sortBy(h,"timestamp");return this.filterBySymbolSinceLimit(l,t,e,i)}async fetchMySettlementHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new n.ArgumentsRequired(this.id+" fetchMySettlementHistory() requires a symbol argument");await this.loadMarkets();const r=this.market(t);let a;if([a,s]=this.handleMarketTypeAndParams("fetchMySettlementHistory",r,s),"option"!==a)throw new n.NotSupported(this.id+" fetchMySettlementHistory() supports option markets only");const o=r.id,d=o.split("-"),c={underlying:this.safeString(d,0),contract:o};void 0!==e&&(c.from=e),void 0!==i&&(c.limit=i);const h=await this.privateOptionsGetMySettlements(this.extend(c,s)),l=this.safeValue(h,"result",{}),u=this.safeValue(l,"list",[]),p=this.parseSettlements(u,r),f=this.sortBy(p,"timestamp");return this.filterBySymbolSinceLimit(f,r.symbol,e,i)}parseSettlement(t,e){const i=this.safeTimestamp(t,"time"),s=this.safeString(t,"contract");return{info:t,symbol:this.safeSymbol(s,e),price:this.safeNumber(t,"settle_price"),timestamp:i,datetime:this.iso8601(i)}}parseSettlements(t,e){const i=[];for(let s=0;s<t.length;s++)i.push(this.parseSettlement(t[s],e));return i}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n,o=!1;if([o,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),o)return await this.fetchPaginatedCallDynamic("fetchLedger",t,e,i,s);let d={};if([r,s]=this.handleMarketTypeAndParams("fetchLedger",void 0,s),"spot"!==r&&"margin"!==r||void 0!==t&&(a=this.currency(t),d.currency=a.id),"swap"===r||"future"===r){const t="swap"===r?"usdt":"btc",e=this.safeStringLower(s,"settle",t);s=this.omit(s,"settle"),d.settle=e}return void 0!==e&&(d.from=e),void 0!==i&&(d.limit=i),[d,s]=this.handleUntilOption("to",d,s),"spot"===r?n=await this.privateSpotGetAccountBook(this.extend(d,s)):"margin"===r?n=await this.privateMarginGetAccountBook(this.extend(d,s)):"swap"===r?n=await this.privateFuturesGetSettleAccountBook(this.extend(d,s)):"future"===r?n=await this.privateDeliveryGetSettleAccountBook(this.extend(d,s)):"option"===r&&(n=await this.privateOptionsGetAccountBook(this.extend(d,s))),this.parseLedger(n,a,e,i)}parseLedgerEntry(t,e=void 0){let i,s=this.safeString(t,"change");r.Y.stringLt(s,"0")?(i="out",s=r.Y.stringAbs(s)):i="in";const a=this.safeString(t,"currency");e=this.safeCurrency(a,e);const n=this.safeString(t,"type"),o=this.safeString(t,"time");let d;d=o.length>10?parseInt(o):1e3*parseInt(o);const c=this.safeString(t,"balance"),h=this.safeString(t,"change"),l=this.parseNumber(r.Y.stringSub(c,h));return this.safeLedgerEntry({info:t,id:this.safeString(t,"id"),direction:i,account:void 0,referenceAccount:void 0,referenceId:void 0,type:this.parseLedgerEntryType(n),currency:this.safeCurrencyCode(a,e),amount:this.parseNumber(s),timestamp:d,datetime:this.iso8601(d),before:l,after:this.safeNumber(t,"balance"),status:void 0,fee:void 0},e)}parseLedgerEntryType(t){return this.safeString({deposit:"deposit",withdraw:"withdrawal",sub_account_transfer:"transfer",margin_in:"transfer",margin_out:"transfer",margin_funding_in:"transfer",margin_funding_out:"transfer",cross_margin_in:"transfer",cross_margin_out:"transfer",copy_trading_in:"transfer",copy_trading_out:"transfer",quant_in:"transfer",quant_out:"transfer",futures_in:"transfer",futures_out:"transfer",delivery_in:"transfer",delivery_out:"transfer",new_order:"trade",order_fill:"trade",referral_fee:"rebate",order_fee:"fee",interest:"interest",lend:"loan",redeem:"loan",profit:"interest",flash_swap_buy:"trade",flash_swap_sell:"trade",unknown:"unknown",set:"settlement",prem:"trade",point_refr:"rebate",point_fee:"fee",point_dnw:"deposit/withdraw",fund:"fee",refr:"rebate",fee:"fee",pnl:"trade",dnw:"deposit/withdraw"},t,t)}async setPositionMode(t,e=void 0,i={}){const s=void 0!==e?this.market(e):void 0,[r,a]=this.prepareRequest(s,"swap",i);return r.dual_mode=t,await this.privateFuturesPostSettleDualMode(this.extend(r,a))}async fetchUnderlyingAssets(t={}){let e;if(await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchUnderlyingAssets",void 0,t),void 0!==e&&"spot"!==e||(e="option"),"option"!==e)throw new n.NotSupported(this.id+" fetchUnderlyingAssets() supports option markets only");const i=await this.publicOptionsGetUnderlyings(t),s=[];for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"name");void 0!==r&&s.push(r)}return s}async fetchLiquidations(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t);if(!r.swap)throw new n.NotSupported(this.id+" fetchLiquidations() supports swap markets only");let a={settle:r.settleId,contract:r.id};void 0!==e&&(a.from=e),void 0!==i&&(a.limit=i),[a,s]=this.handleUntilOption("to",a,s);const o=await this.publicFuturesGetSettleLiqOrders(this.extend(a,s));return this.parseLiquidations(o,r,e,i)}async fetchMyLiquidations(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new n.ArgumentsRequired(this.id+" fetchMyLiquidations() requires a symbol argument");await this.loadMarkets();const r=this.market(t),a={contract:r.id};let o;if(r.swap||r.future)void 0!==i&&(a.limit=i),a.settle=r.settleId;else if(r.option){const t=r.id.split("-");a.underlying=this.safeString(t,0)}if(r.swap)o=await this.privateFuturesGetSettleLiquidates(this.extend(a,s));else if(r.future)o=await this.privateDeliveryGetSettleLiquidates(this.extend(a,s));else{if(!r.option)throw new n.NotSupported(this.id+" fetchMyLiquidations() does not support "+r.type+" orders");o=await this.privateOptionsGetPositionClose(this.extend(a,s))}return this.parseLiquidations(o,r,e,i)}parseLiquidation(t,e=void 0){const i=this.safeString(t,"contract"),s=this.safeTimestamp(t,"time"),a=this.safeString2(t,"size","settle_size"),n=this.safeString(t,"left","0"),o=r.Y.stringAbs(r.Y.stringSub(a,n)),d=this.safeString(e,"contractSize"),c=this.safeString2(t,"liq_price","fill_price"),h=r.Y.stringMul(o,d);let l=this.safeString(t,"pnl");void 0===l&&(l=r.Y.stringMul(h,c));const u=this.safeStringLower(t,"side");let p;return"long"===u?p="buy":"short"===u?p="sell":void 0!==a&&(r.Y.stringGt(a,"0")?p="buy":r.Y.stringLt(a,"0")&&(p="sell")),this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:this.parseNumber(o),contractSize:this.parseNumber(d),price:this.parseNumber(c),side:p,baseValue:this.parseNumber(h),quoteValue:this.parseNumber(r.Y.stringAbs(l)),timestamp:s,datetime:this.iso8601(s)})}async fetchGreeks(t,e={}){await this.loadMarkets();const i=this.market(t),s={underlying:i.info.underlying},r=await this.publicOptionsGetTickers(this.extend(s,e)),a=i.id;for(let t=0;t<r.length;t++){const e=r[t];if(this.safeString(e,"name")===a)return this.parseGreeks(e,i)}}parseGreeks(t,e=void 0){const i=this.safeString(t,"name");return{symbol:this.safeSymbol(i,e),timestamp:void 0,datetime:void 0,delta:this.safeNumber(t,"delta"),gamma:this.safeNumber(t,"gamma"),theta:this.safeNumber(t,"theta"),vega:this.safeNumber(t,"vega"),rho:void 0,bidSize:this.safeNumber(t,"bid1_size"),askSize:this.safeNumber(t,"ask1_size"),bidImpliedVolatility:this.safeNumber(t,"bid_iv"),askImpliedVolatility:this.safeNumber(t,"ask_iv"),markImpliedVolatility:this.safeNumber(t,"mark_iv"),bidPrice:this.safeNumber(t,"bid1_price"),askPrice:this.safeNumber(t,"ask1_price"),markPrice:this.safeNumber(t,"mark_price"),lastPrice:this.safeNumber(t,"last_price"),underlyingPrice:this.parseNumber(e.info.underlying_price),info:t}}async closePosition(t,e=void 0,i={}){return i=this.extend({close:!0},i),void 0===e&&(e=""),await this.createOrder(t,"market",e,0,void 0,i)}async fetchLeverage(t,e={}){let i;await this.loadMarkets(),void 0!==t&&(i=this.market(t));const s={};let r;const a=this.safeBool(e,"unified");if(e=this.omit(e,"unified"),i.spot)s.currency_pair=i.id,r=a?await this.publicMarginGetUniCurrencyPairsCurrencyPair(this.extend(s,e)):await this.publicMarginGetCurrencyPairsCurrencyPair(this.extend(s,e));else{if(!a)throw new n.NotSupported(this.id+" fetchLeverage() does not support "+i.type+" markets");r=await this.privateUnifiedGetAccounts(this.extend(s,e))}return this.parseLeverage(r,i)}async fetchLeverages(t=void 0,e={}){let i;await this.loadMarkets(),t=this.marketSymbols(t);const s=this.safeBool(e,"unified");e=this.omit(e,"unified");let r="id";return s?(r="currency_pair",i=await this.publicMarginGetUniCurrencyPairs(e)):i=await this.publicMarginGetCurrencyPairs(e),this.parseLeverages(i,t,r,"spot")}parseLeverage(t,e=void 0){const i=this.safeString2(t,"currency_pair","id"),s=this.safeInteger(t,"leverage");return{info:t,symbol:this.safeSymbol(i,e,"_","spot"),marginMode:void 0,longLeverage:s,shortLeverage:s}}async fetchOption(t,e={}){await this.loadMarkets();const i=this.market(t),s={contract:i.id},r=await this.publicOptionsGetContractsContract(this.extend(s,e));return this.parseOption(r,void 0,i)}async fetchOptionChain(t,e={}){await this.loadMarkets();const i={underlying:this.currency(t).code+"_USDT"},s=await this.publicOptionsGetContracts(this.extend(i,e));return this.parseOptionChain(s,void 0,"name")}parseOption(t,e=void 0,i=void 0){const s=this.safeString(t,"name");i=this.safeMarket(s,i);const r=this.safeTimestamp(t,"create_time");return{info:t,currency:void 0,symbol:i.symbol,timestamp:r,datetime:this.iso8601(r),impliedVolatility:void 0,openInterest:void 0,bidPrice:this.safeNumber(t,"bid1_price"),askPrice:this.safeNumber(t,"ask1_price"),midPrice:void 0,markPrice:this.safeNumber(t,"mark_price"),lastPrice:this.safeNumber(t,"last_price"),underlyingPrice:this.safeNumber(t,"underlying_price"),change:void 0,percentage:void 0,baseVolume:void 0,quoteVolume:void 0}}async fetchPositionsHistory(t=void 0,e=void 0,i=void 0,s={}){let r,a;if(await this.loadMarkets(),void 0!==t){1===t.length&&(r=this.market(t[0]))}[a,s]=this.handleMarketTypeAndParams("fetchPositionsHistory",r,s,"swap");const o=this.safeInteger(s,"until");s=this.omit(s,"until");let d,c={};if([c,s]=this.prepareRequest(r,a,s),void 0!==i&&(c.limit=i),void 0!==e&&(c.from=this.parseToInt(e/1e3)),void 0!==o&&(c.to=this.parseToInt(o/1e3)),"swap"===a)d=await this.privateFuturesGetSettlePositionClose(this.extend(c,s));else{if("future"!==a)throw new n.NotSupported(this.id+" fetchPositionsHistory() does not support markets of type "+a);d=await this.privateDeliveryGetSettlePositionClose(this.extend(c,s))}return this.parsePositions(d,t,s)}handleErrors(t,e,i,s,r,a,o,d,c){if(void 0===o)return;const h=this.safeString(o,"label");if(void 0!==h){const t=this.id+" "+a;throw this.throwExactlyMatchedException(this.exceptions.exact,h,t),new n.ExchangeError(t)}}}},9426(t,e,i){"use strict";i.d(e,{y:()=>o});var s=i(9654),r=i(9073),a=i(4176),n=i(9489);class o extends a.Ue{constructor(t,e){let i=!1;const r=[];t.forEach(t=>{t.dynamic&&(i=!0),r.push(t.type)});super("tuple","tuple("+r.join(",")+")",e,i),(0,s.n)(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(e=>{t.push(e.defaultValue())});const e=this.coders.reduce((t,e)=>{const i=e.localName;return i&&(t[i]||(t[i]=0),t[i]++),t},{});return this.coders.forEach((i,s)=>{let r=i.localName;r&&1===e[r]&&("length"===r&&(r="_length"),null==t[r]&&(t[r]=t[s]))}),Object.freeze(t)}encode(t,e){const i=r.V.dereference(e,"tuple");return(0,n.qq)(t,this.coders,i)}decode(t){return(0,n.l1)(t,this.coders)}}},9428(t,e,i){"use strict";i.d(e,{aX:()=>N});i(4815);var s,r,a,n,o,d,c=i(1420),h=i(1768),l=i(9654),u=function(t,e,i,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(t,i):r?r.value=i:e.set(t,i),i},p=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};function f(t){const e=new Set;return t.forEach(t=>e.add(t)),Object.freeze(e)}f("external public payable".split(" "));const m="constant external internal payable private public pure view",g=(f(m.split(" ")),"constructor error event fallback function receive struct"),y=(f(g.split(" ")),"calldata memory storage payable indexed"),v=f(y.split(" ")),b=f([g,y,"tuple returns",m].join(" ").split(" ")),w={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},S=new RegExp("^(\\s*)"),k=new RegExp("^([0-9]+)"),O=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),T=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),P=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class _{constructor(t){s.add(this),r.set(this,void 0),a.set(this,void 0),u(this,r,0,"f"),u(this,a,t.slice(),"f")}get offset(){return p(this,r,"f")}get length(){return p(this,a,"f").length-p(this,r,"f")}clone(){return new _(p(this,a,"f"))}reset(){u(this,r,0,"f")}popKeyword(t){const e=this.peek();if("KEYWORD"!==e.type||!t.has(e.text))throw new Error(`expected keyword ${e.text}`);return this.pop().text}popType(t){if(this.peek().type!==t)throw new Error(`expected ${t}; got ${JSON.stringify(this.peek())}`);return this.pop().text}popParen(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=p(this,s,"m",n).call(this,p(this,r,"f")+1,t.match+1);return u(this,r,t.match+1,"f"),e}popParams(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=[];for(;p(this,r,"f")<t.match-1;){const t=this.peek().linkNext;e.push(p(this,s,"m",n).call(this,p(this,r,"f")+1,t)),u(this,r,t,"f")}return u(this,r,t.match+1,"f"),e}peek(){if(p(this,r,"f")>=p(this,a,"f").length)throw new Error("out-of-bounds");return p(this,a,"f")[p(this,r,"f")]}peekKeyword(t){const e=this.peekType("KEYWORD");return null!=e&&t.has(e)?e:null}peekType(t){if(0===this.length)return null;const e=this.peek();return e.type===t?e.text:null}pop(){var t;const e=this.peek();return u(this,r,(t=p(this,r,"f"),++t),"f"),e}toString(){const t=[];for(let e=p(this,r,"f");e<p(this,a,"f").length;e++){const i=p(this,a,"f")[e];t.push(`${i.type}:${i.text}`)}return`<TokenString ${t.join(" ")}>`}}function A(t){const e=[],i=e=>{const i=a<t.length?JSON.stringify(t[a]):"$EOI";throw new Error(`invalid token ${i} at ${a}: ${e}`)};let s=[],r=[],a=0;for(;a<t.length;){let n=t.substring(a),o=n.match(S);o&&(a+=o[1].length,n=t.substring(a));const d={depth:s.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};e.push(d);let c=w[n[0]]||"";if(c){if(d.type=c,d.text=n[0],a++,"OPEN_PAREN"===c)s.push(e.length-1),r.push(e.length-1);else if("CLOSE_PAREN"==c)0===s.length&&i("no matching open bracket"),d.match=s.pop(),e[d.match].match=e.length-1,d.depth--,d.linkBack=r.pop(),e[d.linkBack].linkNext=e.length-1;else if("COMMA"===c)d.linkBack=r.pop(),e[d.linkBack].linkNext=e.length-1,r.push(e.length-1);else if("OPEN_BRACKET"===c)d.type="BRACKET";else if("CLOSE_BRACKET"===c){let t=e.pop().text;if(e.length>0&&"NUMBER"===e[e.length-1].type){const i=e.pop().text;t=i+t,e[e.length-1].value=(0,h.WZ)(i)}if(0===e.length||"BRACKET"!==e[e.length-1].type)throw new Error("missing opening bracket");e[e.length-1].text+=t}}else if(o=n.match(O),o){if(d.text=o[1],a+=d.text.length,b.has(d.text)){d.type="KEYWORD";continue}if(d.text.match(P)){d.type="TYPE";continue}d.type="ID"}else{if(o=n.match(k),!o)throw new Error(`unexpected token ${JSON.stringify(n[0])} at position ${a}`);d.text=o[1],d.type="NUMBER",a+=d.text.length}}return new _(e.map(t=>Object.freeze(t)))}function I(t,e){const i=new Set;for(;;){const s=t.peekType("KEYWORD");if(null==s||e&&!e.has(s))break;if(t.pop(),i.has(s))throw new Error(`duplicate keywords: ${JSON.stringify(s)}`);i.add(s)}return Object.freeze(i)}r=new WeakMap,a=new WeakMap,s=new WeakSet,n=function(t=0,e=0){return new _(p(this,a,"f").slice(t,e).map(e=>Object.freeze(Object.assign({},e,{match:e.match-t,linkBack:e.linkBack-t,linkNext:e.linkNext-t}))))};const x=new RegExp(/^(.*)\[([0-9]*)\]$/);function E(t){const e=t.match(P);if((0,c.MR)(e,"invalid type","type",t),"uint"===t)return"uint256";if("int"===t)return"int256";if(e[2]){const i=parseInt(e[2]);(0,c.MR)(0!==i&&i<=32,"invalid bytes length","type",t)}else if(e[3]){const i=parseInt(e[3]);(0,c.MR)(0!==i&&i<=256&&i%8==0,"invalid numeric width","type",t)}return t}const M={},C=Symbol.for("_ethers_internal"),B="_ParamTypeInternal";class N{constructor(t,e,i,s,r,a,n,d){if(o.add(this),(0,c.gk)(t,M,"ParamType"),Object.defineProperty(this,C,{value:B}),a&&(a=Object.freeze(a.slice())),"array"===s){if(null==n||null==d)throw new Error("")}else if(null!=n||null!=d)throw new Error("");if("tuple"===s){if(null==a)throw new Error("")}else if(null!=a)throw new Error("");(0,l.n)(this,{name:e,type:i,baseType:s,indexed:r,components:a,arrayLength:n,arrayChildren:d})}format(t){if(null==t&&(t="sighash"),"json"===t){const e=this.name||"";if(this.isArray()){const t=JSON.parse(this.arrayChildren.format("json"));return t.name=e,t.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(t)}const i={type:"tuple"===this.baseType?"tuple":this.type,name:e};return"boolean"==typeof this.indexed&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(e=>JSON.parse(e.format(t)))),JSON.stringify(i)}let e="";return this.isArray()?(e+=this.arrayChildren.format(t),e+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?e+="("+this.components.map(e=>e.format(t)).join("full"===t?", ":",")+")":e+=this.type,"sighash"!==t&&(!0===this.indexed&&(e+=" indexed"),"full"===t&&this.name&&(e+=" "+this.name)),e}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(t,e){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const i=this;return t.map(t=>i.arrayChildren.walk(t,e))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const i=this;return t.map((t,s)=>i.components[s].walk(t,e))}return e(this.type,t)}async walkAsync(t,e){const i=[],s=[t];return p(this,o,"m",d).call(this,i,t,e,t=>{s[0]=t}),i.length&&await Promise.all(i),s[0]}static from(t,e){if(N.isParamType(t))return t;if("string"==typeof t)try{return N.from(A(t),e)}catch(e){(0,c.MR)(!1,"invalid param type","obj",t)}else if(t instanceof _){let i="",s="",r=null;I(t,f(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(s="tuple",r=t.popParams().map(t=>N.from(t)),i=`tuple(${r.map(t=>t.format()).join(",")})`):(i=E(t.popType("TYPE")),s=i);let a=null,n=null;for(;t.length&&t.peekType("BRACKET");){const e=t.pop();a=new N(M,"",i,s,null,r,n,a),n=e.value,i+=e.text,s="array",r=null}let o=null;if(I(t,v).has("indexed")){if(!e)throw new Error("");o=!0}const d=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new N(M,d,i,s,o,r,n,a)}const i=t.name;(0,c.MR)(!i||"string"==typeof i&&i.match(T),"invalid name","obj.name",i);let s=t.indexed;null!=s&&((0,c.MR)(e,"parameter cannot be indexed","obj.indexed",t.indexed),s=!!s);let r=t.type,a=r.match(x);if(a){const e=parseInt(a[2]||"-1"),n=N.from({type:a[1],components:t.components});return new N(M,i||"",r,"array",s,null,e,n)}if("tuple"===r||r.startsWith("tuple(")||r.startsWith("(")){const e=null!=t.components?t.components.map(t=>N.from(t)):null;return new N(M,i||"",r,"tuple",s,e,null,null)}return r=E(t.type),new N(M,i||"",r,r,s,null,null,null)}static isParamType(t){return t&&t[C]===B}}o=new WeakSet,d=function t(e,i,s,r){if(this.isArray()){if(!Array.isArray(i))throw new Error("invalid array value");if(-1!==this.arrayLength&&i.length!==this.arrayLength)throw new Error("array is wrong length");const a=this.arrayChildren,n=i.slice();return n.forEach((i,r)=>{p(a,o,"m",t).call(a,e,i,s,t=>{n[r]=t})}),void r(n)}if(this.isTuple()){const a=this.components;let n;if(Array.isArray(i))n=i.slice();else{if(null==i||"object"!=typeof i)throw new Error("invalid tuple value");n=a.map(t=>{if(!t.name)throw new Error("cannot use object value with unnamed components");if(!(t.name in i))throw new Error(`missing value for component ${t.name}`);return i[t.name]})}if(n.length!==this.components.length)throw new Error("array is wrong length");return n.forEach((i,r)=>{var d;p(d=a[r],o,"m",t).call(d,e,i,s,t=>{n[r]=t})}),void r(n)}const a=s(this.type,i);a.then?e.push(async function(){r(await a)}()):r(a)}},9436(t,e,i){"use strict";i.d(e,{YW:()=>d,_v:()=>c});var s=i(3867),r=i(1420);function a(t,e,i,s,r){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let s=e+1;s<i.length&&i[s]>>6==2;s++)t++;return t}return"OVERRUN"===t?i.length-e-1:0}const n=Object.freeze({error:function(t,e,i,s,a){(0,r.MR)(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",i)},ignore:a,replace:function(t,e,i,s,n){return"OVERLONG"===t?((0,r.MR)("number"==typeof n,"invalid bad code point for replacement","badCodepoint",n),s.push(n),0):(s.push(65533),a(t,e,i))}});function o(t,e){null==e&&(e=n.error);const i=(0,s.q5)(t,"bytes"),r=[];let a=0;for(;a<i.length;){const t=i[a++];if(!(t>>7)){r.push(t);continue}let s=null,n=null;if(192==(224&t))s=1,n=127;else if(224==(240&t))s=2,n=2047;else{if(240!=(248&t)){a+=e(128==(192&t)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",a-1,i,r);continue}s=3,n=65535}if(a-1+s>=i.length){a+=e("OVERRUN",a-1,i,r);continue}let o=t&(1<<8-s-1)-1;for(let t=0;t<s;t++){let t=i[a];if(128!=(192&t)){a+=e("MISSING_CONTINUE",a,i,r),o=null;break}o=o<<6|63&t,a++}null!==o&&(o>1114111?a+=e("OUT_OF_RANGE",a-1-s,i,r,o):o>=55296&&o<=57343?a+=e("UTF16_SURROGATE",a-1-s,i,r,o):o<=n?a+=e("OVERLONG",a-1-s,i,r,o):r.push(o))}return r}function d(t,e){null!=e&&((0,r.SP)(e),t=t.normalize(e));let i=[];for(let e=0;e<t.length;e++){const s=t.charCodeAt(e);if(s<128)i.push(s);else if(s<2048)i.push(s>>6|192),i.push(63&s|128);else if(55296==(64512&s)){e++;const a=t.charCodeAt(e);(0,r.MR)(e<t.length&&56320==(64512&a),"invalid surrogate pair","str",t);const n=65536+((1023&s)<<10)+(1023&a);i.push(n>>18|240),i.push(n>>12&63|128),i.push(n>>6&63|128),i.push(63&n|128)}else i.push(s>>12|224),i.push(s>>6&63|128),i.push(63&s|128)}return new Uint8Array(i)}function c(t,e){return o(t,e).map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t)))).join("")}},9476(t,e,i){"use strict";i.d(e,{s:()=>a});var s=i(1279),r=i(447);class a{constructor(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}doPublic(t){return t.modPowInt(this.e,this.n)}doPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);let e=t.mod(this.p).modPow(this.dmp1,this.p);const i=t.mod(this.q).modPow(this.dmq1,this.q);for(;e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}setPublic(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=(0,s.Bv)(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")}encrypt(t){const e=this.n.bitLength()+7>>3,i=function(t,e){if(e<t.length+11)return console.error("Message too long for RSA"),null;const i=[];let a=t.length-1;for(;a>=0&&e>0;){const s=t.charCodeAt(a--);s<128?i[--e]=s:s>127&&s<2048?(i[--e]=63&s|128,i[--e]=s>>6|192):(i[--e]=63&s|128,i[--e]=s>>6&63|128,i[--e]=s>>12|224)}i[--e]=0;const n=new r.D,o=[];for(;e>2;){for(o[0]=0;0==o[0];)n.nextBytes(o);i[--e]=o[0]}return i[--e]=2,i[--e]=0,new s.jZ(i)}(t,e);if(null==i)return null;const a=this.doPublic(i);if(null==a)return null;let n=a.toString(16),o=n.length;for(let t=0;t<2*e-o;t++)n="0"+n;return n}setPrivate(t,e,i){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=(0,s.Bv)(t,16),this.e=parseInt(e,16),this.d=(0,s.Bv)(i,16)):console.error("Invalid RSA private key")}setPrivateEx(t,e,i,r,a,n,o,d){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=(0,s.Bv)(t,16),this.e=parseInt(e,16),this.d=(0,s.Bv)(i,16),this.p=(0,s.Bv)(r,16),this.q=(0,s.Bv)(a,16),this.dmp1=(0,s.Bv)(n,16),this.dmq1=(0,s.Bv)(o,16),this.coeff=(0,s.Bv)(d,16)):console.error("Invalid RSA private key")}generate(t,e){const i=new r.D,a=t>>1;this.e=parseInt(e,16);const n=new s.jZ(e,16);for(;;){for(;this.p=new s.jZ(t-a,1,i),0!=this.p.subtract(s.jZ.ONE).gcd(n).compareTo(s.jZ.ONE)||!this.p.isProbablePrime(10););for(;this.q=new s.jZ(a,1,i),0!=this.q.subtract(s.jZ.ONE).gcd(n).compareTo(s.jZ.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){const t=this.p;this.p=this.q,this.q=t}const e=this.p.subtract(s.jZ.ONE),r=this.q.subtract(s.jZ.ONE),o=e.multiply(r);if(0==o.gcd(n).compareTo(s.jZ.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(o),this.dmp1=this.d.mod(e),this.dmq1=this.d.mod(r),this.coeff=this.q.modInverse(this.p);break}}}decrypt(t){const e=(0,s.Bv)(t,16),i=this.doPrivate(e);return null==i?null:function(t,e){const i=t.toByteArray();let s=0;for(;s<i.length&&0==i[s];)++s;if(i.length-s!=e-1||2!=i[s])return null;++s;for(;0!=i[s];)if(++s>=i.length)return null;let r="";for(;++s<i.length;){const t=255&i[s];t<128?r+=String.fromCharCode(t):t>191&&t<224?(r+=String.fromCharCode((31&t)<<6|63&i[s+1]),++s):(r+=String.fromCharCode((15&t)<<12|(63&i[s+1])<<6|63&i[s+2]),s+=2)}return r}(i,this.n.bitLength()+7>>3)}generateAsync(t,e,i){const a=new r.D,n=t>>1;this.e=parseInt(e,16);const o=new s.jZ(e,16),d=this,c=function(){const e=function(){if(d.p.compareTo(d.q)<=0){const t=d.p;d.p=d.q,d.q=t}const t=d.p.subtract(s.jZ.ONE),e=d.q.subtract(s.jZ.ONE),r=t.multiply(e);0==r.gcd(o).compareTo(s.jZ.ONE)?(d.n=d.p.multiply(d.q),d.d=o.modInverse(r),d.dmp1=d.d.mod(t),d.dmq1=d.d.mod(e),d.coeff=d.q.modInverse(d.p),setTimeout(function(){i()},0)):setTimeout(c,0)},r=function(){d.q=(0,s.EB)(),d.q.fromNumberAsync(n,1,a,function(){d.q.subtract(s.jZ.ONE).gcda(o,function(t){0==t.compareTo(s.jZ.ONE)&&d.q.isProbablePrime(10)?setTimeout(e,0):setTimeout(r,0)})})},h=function(){d.p=(0,s.EB)(),d.p.fromNumberAsync(t-n,1,a,function(){d.p.subtract(s.jZ.ONE).gcda(o,function(t){0==t.compareTo(s.jZ.ONE)&&d.p.isProbablePrime(10)?setTimeout(r,0):setTimeout(h,0)})})};setTimeout(h,0)};setTimeout(c,0)}sign(t,e,i){const r=function(t,e){if(e<t.length+22)return console.error("Message too long for RSA"),null;const i=e-t.length-6;let r="";for(let t=0;t<i;t+=2)r+="ff";const a="0001"+r+"00"+t;return(0,s.Bv)(a,16)}((n[i]||"")+e(t).toString(),this.n.bitLength()/4);if(null==r)return null;const a=this.doPrivate(r);if(null==a)return null;const o=a.toString(16);return 1&o.length?"0"+o:o}verify(t,e,i){const r=(0,s.Bv)(e,16),a=this.doPublic(r);if(null==a)return null;return function(t){for(const e in n)if(n.hasOwnProperty(e)){const i=n[e],s=i.length;if(t.substr(0,s)==i)return t.substr(s)}return t}(a.toString(16).replace(/^1f+00/,""))==i(t).toString()}}const n={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"}},9489(t,e,i){"use strict";i.d(e,{fA:()=>h,l1:()=>c,qq:()=>d});var s=i(1420),r=i(9654),a=i(9073),n=i(4176),o=i(1677);function d(t,e,i){let r=[];if(Array.isArray(i))r=i;else if(i&&"object"==typeof i){let t={};r=e.map(e=>{const r=e.localName;return(0,s.vA)(r,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:i}),(0,s.vA)(!t[r],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:i}),t[r]=!0,i[r]})}else(0,s.MR)(!1,"invalid tuple value","tuple",i);(0,s.MR)(e.length===r.length,"types/value length mismatch","tuple",i);let a=new n.AU,o=new n.AU,d=[];e.forEach((t,e)=>{let i=r[e];if(t.dynamic){let e=o.length;t.encode(o,i);let s=a.writeUpdatableValue();d.push(t=>{s(t+e)})}else t.encode(a,i)}),d.forEach(t=>{t(a.length)});let c=t.appendWriter(a);return c+=t.appendWriter(o),c}function c(t,e){let i=[],r=[],a=t.subReader(0);return e.forEach(e=>{let n=null;if(e.dynamic){let i=t.readIndex(),r=a.subReader(i);try{n=e.decode(r)}catch(t){if((0,s.bJ)(t,"BUFFER_OVERRUN"))throw t;n=t,n.baseType=e.name,n.name=e.localName,n.type=e.type}}else try{n=e.decode(t)}catch(t){if((0,s.bJ)(t,"BUFFER_OVERRUN"))throw t;n=t,n.baseType=e.name,n.name=e.localName,n.type=e.type}if(null==n)throw new Error("investigate");i.push(n),r.push(e.localName||null)}),n.Q7.fromItems(i,r)}class h extends n.Ue{constructor(t,e,i){super("array",t.type+"["+(e>=0?e:"")+"]",i,-1===e||t.dynamic),(0,r.n)(this,{coder:t,length:e})}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let i=0;i<this.length;i++)e.push(t);return e}encode(t,e){const i=a.V.dereference(e,"array");Array.isArray(i)||this._throwError("expected array value",i);let r=this.length;-1===r&&(r=i.length,t.writeValue(i.length)),(0,s.dd)(i.length,r,"coder array"+(this.localName?" "+this.localName:""));let n=[];for(let t=0;t<i.length;t++)n.push(this.coder);return d(t,n,i)}decode(t){let e=this.length;-1===e&&(e=t.readIndex(),(0,s.vA)(e*n.Yx<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:e*n.Yx,length:t.dataLength}));let i=[];for(let t=0;t<e;t++)i.push(new o.j(this.coder));return c(t,i)}}},9491(t,e,i){"use strict";i.d(e,{CL:()=>d,dl:()=>u,ez:()=>l,h$:()=>c,r4:()=>p});var s=i(3187),r=i(8325),a=i(6907),n=i(5307),o=i(1686);function d(t,e){return(0,s.NO)(BigInt(t),BigInt(e))}function c(t,e){return(0,o.nj)((0,s.Ef)(BigInt(t),BigInt(e)))}function h(t){return[...t,t.length].reduce((t,e)=>(0,s.NO)(BigInt(t),BigInt(e)),0).toString()}const l=h;function u(t){return(0,o.nj)((0,s.pd)(t.map(t=>BigInt(t))))}function p(t,e,i,s){const d=h(a.fP.compile(i)),c=h([(0,n.AB)("0x535441524b4e45545f434f4e54524143545f41444452455353"),s,t,e,d]);return(0,o.nj)(BigInt(c)%r.Vi)}},9544(t,e,i){"use strict";i.d(e,{A:()=>l});var s=i(3192),r=i(5147),a=i(2079),n=i(2931),o=i(4852),d=i(5354),c=i(8283),h=i(6414);class l extends s.A{describe(){const t=super.describe();return this.deepExtend(t,this.describeData())}describeData(){return{has:{ws:!0,watchBalance:!0,watchLiquidations:!0,watchLiquidationsForSymbols:!0,watchMyLiquidations:!0,watchMyLiquidationsForSymbols:!0,watchBidsAsks:!0,watchMyTrades:!0,watchOHLCV:!0,watchOHLCVForSymbols:!0,watchOrderBook:!0,watchOrderBookForSymbols:!0,watchOrders:!0,watchOrdersForSymbols:!0,watchPositions:!0,watchTicker:!0,watchTickers:!0,watchMarkPrices:!0,watchMarkPrice:!0,watchTrades:!0,watchTradesForSymbols:!0,createOrderWs:!0,editOrderWs:!0,cancelOrderWs:!0,cancelOrdersWs:!1,cancelAllOrdersWs:!0,fetchBalanceWs:!0,fetchDepositsWs:!1,fetchMarketsWs:!1,fetchMyTradesWs:!0,fetchOHLCVWs:!0,fetchOrderBookWs:!0,fetchOpenOrdersWs:!0,fetchOrderWs:!0,fetchOrdersWs:!0,fetchPositionWs:!0,fetchPositionForSymbolWs:!0,fetchPositionsWs:!0,fetchTickerWs:!0,fetchTradesWs:!0,fetchTradingFeesWs:!1,fetchWithdrawalsWs:!1,unWatchTicker:!0,unWatchTickers:!0,unWatchOHLCV:!0,unWatchOHLCVForSymbols:!0,unWatchOrderBook:!0,unWatchOrderBookForSymbols:!0,unWatchTrades:!0,unWatchTradesForSymbols:!0,unWatchMyTrades:!1,unWatchOrders:!1,unWatchPositions:!1,unWatchMarkPrices:!0,unWatchMarkPrice:!0},urls:{test:{ws:{spot:"wss://stream.testnet.binance.vision/ws",margin:"wss://stream.testnet.binance.vision/ws",future:"wss://fstream.binancefuture.com/ws",delivery:"wss://dstream.binancefuture.com/ws","ws-api":{spot:"wss://ws-api.testnet.binance.vision/ws-api/v3",future:"wss://testnet.binancefuture.com/ws-fapi/v1",delivery:"wss://testnet.binancefuture.com/ws-dapi/v1"}}},demo:{ws:{spot:"wss://demo-stream.binance.com/ws",margin:"wss://demo-stream.binance.com/ws",future:"wss://fstream.binancefuture.com/ws",delivery:"wss://dstream.binancefuture.com/ws","ws-api":{spot:"wss://demo-ws-api.binance.com/ws-api/v3",future:"wss://testnet.binancefuture.com/ws-fapi/v1",delivery:"wss://testnet.binancefuture.com/ws-dapi/v1"}}},api:{ws:{spot:"wss://stream.binance.com:9443/ws",margin:"wss://stream.binance.com:9443/ws",future:"wss://fstream.binance.com/ws",delivery:"wss://dstream.binance.com/ws","ws-api":{spot:"wss://ws-api.binance.com:443/ws-api/v3",future:"wss://ws-fapi.binance.com/ws-fapi/v1",delivery:"wss://ws-dapi.binance.com/ws-dapi/v1"},papi:"wss://fstream.binance.com/pm/ws"}},doc:"https://developers.binance.com/en"},streaming:{keepAlive:18e4},options:{returnRateLimits:!1,streamLimits:{spot:50,margin:50,future:50,delivery:50},subscriptionLimitByStream:{spot:200,margin:200,future:200,delivery:200},streamBySubscriptionsHash:this.createSafeDictionary(),streamIndex:-1,watchOrderBookRate:100,liquidationsLimit:1e3,myLiquidationsLimit:1e3,tradesLimit:1e3,ordersLimit:1e3,OHLCVLimit:1e3,requestId:this.createSafeDictionary(),watchOrderBookLimit:1e3,watchTrades:{name:"trade"},watchTicker:{name:"ticker"},watchTickers:{name:"ticker"},watchOHLCV:{name:"kline"},watchOrderBook:{maxRetries:3,checksum:!0},watchBalance:{fetchBalanceSnapshot:!1,awaitBalanceSnapshot:!0},watchLiquidationsForSymbols:{defaultType:"swap"},watchPositions:{fetchPositionsSnapshot:!0,awaitPositionsSnapshot:!0},wallet:"wb",listenKeyRefreshRate:12e5,ws:{cost:5},tickerChannelsMap:{"24hrTicker":"ticker","24hrMiniTicker":"miniTicker",markPriceUpdate:"markPrice","1hTicker":"ticker_1h","4hTicker":"ticker_4h","1dTicker":"ticker_1d",bookTicker:"bookTicker"}}}}requestId(t){const e=this.safeDict(this.options,"requestId",this.createSafeDictionary()),i=this.safeInteger(e,t,0),s=this.sum(i,1);return this.options.requestId[t]=s,s}isSpotUrl(t){return t.url.indexOf("/stream")>-1||t.url.indexOf("demo-stream")>-1}stream(t,e,i=1){const s=this.safeDict(this.options,"streamBySubscriptionsHash",this.createSafeDictionary());let r=this.safeString(s,e);if(void 0===r){let s=this.safeInteger(this.options,"streamIndex",-1);const n=this.safeValue(this.options,"streamLimits");s+=1;const o=s%this.safeInteger(n,t);this.options.streamIndex=s,r=this.numberToString(o),this.options.streamBySubscriptionsHash[e]=r;void 0===this.safeValue(this.options,"numSubscriptionsByStream")&&(this.options.numSubscriptionsByStream=this.createSafeDictionary());const d=this.safeInteger(this.options.numSubscriptionsByStream,r,0);if(d+i>this.safeInteger(this.options.subscriptionLimitByStream,t,200))throw new a.BadRequest(this.id+" reached the limit of subscriptions by stream. Increase the number of streams, or increase the stream limit or subscription limit by stream if the exchange allows.");this.options.numSubscriptionsByStream[r]=d+i}return r}async watchLiquidations(t,e=void 0,i=void 0,s={}){return await this.watchLiquidationsForSymbols([t],e,i,s)}async watchLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=[],n=[];let o="liquidations";if(t=this.marketSymbols(t,void 0,!0,!0),this.isEmpty(t))r.push("!forceOrder@arr"),n.push("liquidations");else{for(let e=0;e<t.length;e++){const i=this.market(t[e]);r.push(i.lowercaseId+"@forceOrder"),n.push("liquidations::"+t[e])}o+="::"+t.join(",")}const d=this.getMarketFromSymbols(t);let c,h;if([c,s]=this.handleMarketTypeAndParams("watchLiquidationsForSymbols",d,s),"spot"===c)throw new a.BadRequest(this.id+" watchLiquidationsForSymbols is not supported for spot symbols");[h,s]=this.handleSubTypeAndParams("watchLiquidationsForSymbols",d,s),this.isLinear(c,h)?c="future":this.isInverse(c,h)&&(c="delivery");const l=r.length,u=this.urls.api.ws[c]+"/"+this.stream(c,o,l),p=this.requestId(u),f={method:"SUBSCRIBE",params:r,id:p},m={id:p},g=await this.watchMultiple(u,n,this.extend(f,s),r,m);return this.newUpdates?g:this.filterBySymbolsSinceLimit(this.liquidations,t,e,i,!0)}handleLiquidation(t,e){const i=this.safeValue(e,"o",{}),s=this.safeString(i,"s"),r=this.safeMarket(s,void 0,"","contract"),a=r.symbol,o=this.parseWsLiquidation(i,r);let d=this.safeValue(this.liquidations,a);if(void 0===d){const t=this.safeInteger(this.options,"liquidationsLimit",1e3);d=new n.I3(t)}d.append(o),this.liquidations[a]=d,t.resolve([o],"liquidations"),t.resolve([o],"liquidations::"+a)}parseWsLiquidation(t,e=void 0){const i=this.safeString(t,"s");e=this.safeMarket(i,e,void 0,"swap");const s=this.safeInteger(t,"T");return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:this.safeNumber(t,"l"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(t,"ap"),side:this.safeStringLower(t,"S"),baseValue:void 0,quoteValue:void 0,timestamp:s,datetime:this.iso8601(s)})}async watchMyLiquidations(t,e=void 0,i=void 0,s={}){return this.watchMyLiquidationsForSymbols([t],e,i,s)}async watchMyLiquidationsForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!0,!0);const r=this.getMarketFromSymbols(t),a=["myLiquidations"];if(!this.isEmpty(t))for(let e=0;e<t.length;e++){const i=t[e];a.push("myLiquidations::"+i)}let n,o;[n,s]=this.handleMarketTypeAndParams("watchMyLiquidationsForSymbols",r,s),[o,s]=this.handleSubTypeAndParams("watchMyLiquidationsForSymbols",r,s),this.isLinear(n,o)?n="future":this.isInverse(n,o)&&(n="delivery"),await this.authenticate(s);const d=this.urls.api.ws[n]+"/"+this.options[n].listenKey,c=await this.watchMultiple(d,a,undefined,[n]);return this.newUpdates?c:this.filterBySymbolsSinceLimit(this.liquidations,t,e,i)}handleMyLiquidation(t,e){if("LIQUIDATION"!==this.safeString(e,"o"))return;const i=this.safeString(e,"s"),s=this.safeMarket(i,void 0,void 0,"swap"),r=this.safeSymbol(i,s),a=this.parseWsLiquidation(e,s);let o=this.safeValue(this.myLiquidations,r);if(void 0===o){const t=this.safeInteger(this.options,"myLiquidationsLimit",1e3);o=new n.I3(t)}o.append(a),this.myLiquidations[r]=o,t.resolve([a],"myLiquidations"),t.resolve([a],"myLiquidations::"+r)}async watchOrderBook(t,e=void 0,i={}){return await this.watchOrderBookForSymbols([t],e,i)}async watchOrderBookForSymbols(t,e=void 0,i={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1,!0,!0);const s=this.market(t[0]);let r=s.type;s.contract&&(r=s.linear?"future":"delivery");let n,o,d="depth",c="multipleOrderbook";if(void 0!==t){if(t.length>200)throw new a.BadRequest(this.id+" watchOrderBookForSymbols() accepts 200 symbols at most. To watch more symbols call watchOrderBookForSymbols() multiple times");c+="::"+t.join(",")}[n,i]=this.handleOptionAndParams(i,"watchOrderBookForSymbols","watchOrderBookRate","100"),[o,i]=this.handleOptionAndParams(i,"watchOrderBookForSymbols","rpi",!1),o&&"future"===r&&(d="rpiDepth",n="500");const h=[],l=[];for(let e=0;e<t.length;e++){const i=t[e],s=this.market(i);l.push("orderbook::"+i);const r=s.lowercaseId+"@"+d+"@"+n.toString()+"ms";h.push(r)}const u=l.length,p=this.urls.api.ws[r]+"/"+this.stream(r,c,u),f=this.requestId(p),m={method:"SUBSCRIBE",params:h,id:f},g={id:f.toString(),name:d,symbols:t,method:this.handleOrderBookSubscription,limit:e,type:r,params:i};return(await this.watchMultiple(p,l,this.extend(m,i),l,g)).limit()}async unWatchOrderBookForSymbols(t,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!1,!0,!0);const i=this.market(t[0]);let s=i.type;i.contract&&(s=i.linear?"future":"delivery");let r="multipleOrderbook";void 0!==t&&(r+="::"+t.join(","));const a=this.safeString(this.options,"watchOrderBookRate","100"),n=[],o=[],d=[];for(let e=0;e<t.length;e++){const i=t[e],s=this.market(i);o.push("orderbook::"+i),d.push("unsubscribe:orderbook:"+i);const r=s.lowercaseId+"@depth"+"@"+a+"ms";n.push(r)}const c=o.length,h=this.urls.api.ws[s]+"/"+this.stream(s,r,c),l=this.requestId(h),u={method:"UNSUBSCRIBE",params:n,id:l},p={unsubscribe:!0,id:l.toString(),symbols:t,subMessageHashes:o,messageHashes:d,topic:"orderbook"};return await this.watchMultiple(h,d,this.extend(u,e),d,p)}async unWatchOrderBook(t,e={}){return await this.unWatchOrderBookForSymbols([t],e)}async fetchOrderBookWs(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),r={symbol:s.id};void 0!==e&&(r.limit=e);const n=this.getMarketType("fetchOrderBookWs",s,i);if("future"!==n)throw new a.BadRequest(this.id+" fetchOrderBookWs only supports swap markets");const o=this.urls.api.ws["ws-api"][n],d=this.requestId(o).toString();let c=!1;[c,i]=this.handleOptionAndParams(i,"createOrderWs","returnRateLimits",!1),r.returnRateLimits=c,i=this.omit(i,"test");const h={id:d,method:"depth",params:this.signParams(this.extend(r,i))},l={method:this.handleFetchOrderBook},u=await this.watch(o,d,h,d,l);return u.symbol=s.symbol,u}handleFetchOrderBook(t,e){const i=this.safeString(e,"id"),s=this.safeDict(e,"result"),r=this.safeInteger(s,"T"),a=this.parseOrderBook(s,void 0,r);a.nonce=this.safeInteger2(s,"lastUpdateId","u"),t.resolve(a,i)}async fetchOrderBookSnapshot(t,e,i){const s=this.safeString(i,"symbol"),r="orderbook::"+s;try{const e=this.safeInteger(this.options,"watchOrderBookLimit",1e3),a=this.safeValue(i,"type"),n=this.safeInteger(i,"limit",e),o=this.safeValue(i,"params"),d=await this.fetchRestOrderBookSafe(s,n,o);if(void 0===this.safeValue(this.orderbooks,s))return;const c=this.orderbooks[s];c.reset(d);const h=c.cache;c.cache=[];for(let e=0;e<h.length;e++){const i=h[e],s=this.safeInteger(i,"U"),r=this.safeInteger(i,"u"),n=this.safeInteger(i,"pu");if("future"===a){if(r<c.nonce)continue;(s<=c.nonce&&r>=c.nonce||n===c.nonce)&&this.handleOrderBookMessage(t,i,c)}else{if(r<=c.nonce)continue;s-1<=c.nonce&&r-1>=c.nonce&&this.handleOrderBookMessage(t,i,c)}}this.orderbooks[s]=c,t.resolve(c,r)}catch(e){delete t.subscriptions[r],t.reject(e,r)}}handleDelta(t,e){const i=this.safeFloat(e,0),s=this.safeFloat(e,1);t.store(i,s)}handleDeltas(t,e){for(let i=0;i<e.length;i++)this.handleDelta(t,e[i])}handleOrderBookMessage(t,e,i){const s=this.safeInteger(e,"u");this.handleDeltas(i.asks,this.safeValue(e,"a",[])),this.handleDeltas(i.bids,this.safeValue(e,"b",[])),i.nonce=s;const r=this.safeInteger(e,"E");return i.timestamp=r,i.datetime=this.iso8601(r),i}handleOrderBook(t,e){const i=this.isSpotUrl(t)?"spot":"swap",s=this.safeString(e,"s"),r=this.safeMarket(s,void 0,void 0,i).symbol,n="orderbook::"+r;if(!(r in this.orderbooks))return;const o=this.orderbooks[r],d=this.safeInteger(o,"nonce");if(void 0===d)o.cache.push(e);else try{const i=this.safeInteger(e,"U"),s=this.safeInteger(e,"u"),c=this.safeInteger(e,"pu");if(void 0===c){if(s>o.nonce){let c;if(c=void 0===this.safeInteger(o,"timestamp")?i-1<=o.nonce&&s-1>=o.nonce:i-1===o.nonce,c)this.handleOrderBookMessage(t,e,o),d<o.nonce&&t.resolve(o,n);else{if(this.handleOption("watchOrderBook","checksum",!0))throw new a.ChecksumError(this.id+" "+this.orderbookChecksumMessage(r))}}}else if(s>=o.nonce)if(i<=o.nonce||c===o.nonce)this.handleOrderBookMessage(t,e,o),d<=o.nonce&&t.resolve(o,n);else{if(this.handleOption("watchOrderBook","checksum",!0))throw new a.ChecksumError(this.id+" "+this.orderbookChecksumMessage(r))}}catch(e){delete this.orderbooks[r],delete t.subscriptions[n],t.reject(e,n)}}handleOrderBookSubscription(t,e,i){const s=this.safeInteger(this.options,"watchOrderBookLimit",1e3),r=this.safeString(i,"symbol"),a=this.safeValue(i,"symbols",[r]),n=this.safeInteger(i,"limit",s);for(let s=0;s<a.length;s++){const r=a[s];r in this.orderbooks&&delete this.orderbooks[r],this.orderbooks[r]=this.orderBook({},n),i=this.extend(i,{symbol:r}),this.spawn(this.fetchOrderBookSnapshot,t,e,i)}}handleSubscriptionStatus(t,e){const i=this.safeString(e,"id"),s=this.indexBy(t.subscriptions,"id"),r=this.safeValue(s,i,{}),a=this.safeValue(r,"method");void 0!==a&&a.call(this,t,e,r);return this.safeBool(r,"unsubscribe",!1)&&this.handleUnSubscription(t,r),e}handleUnSubscription(t,e){const i=this.safeList(e,"messageHashes",[]),s=this.safeList(e,"subMessageHashes",[]);for(let e=0;e<i.length;e++){const r=i[e],a=s[e];this.cleanUnsubscription(t,a,r)}this.cleanCache(e)}async watchTradesForSymbols(t,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,n="multipleTrades";if(void 0!==(t=this.marketSymbols(t,void 0,!1,!0,!0))){if(t.length>200)throw new a.BadRequest(this.id+" watchTradesForSymbols() accepts 200 symbols at most. To watch more symbols call watchTradesForSymbols() multiple times");n+="::"+t.join(",")}[r,s]=this.handleOptionAndParams(s,"watchTradesForSymbols","name","trade"),s=this.omit(s,"callerMethodName");const o=this.market(t[0]);let d=o.type;o.contract&&(d=o.linear?"future":"delivery");const c=[],h=[];for(let e=0;e<t.length;e++){const i=t[e],s=this.market(i);c.push("trade::"+i);const a=s.lowercaseId+"@"+r;h.push(a)}const l=this.omit(s,"type"),u=h.length,p=this.urls.api.ws[d]+"/"+this.stream(d,n,u),f=this.requestId(p),m={method:"SUBSCRIBE",params:h,id:f},g={id:f},y=await this.watchMultiple(p,c,this.extend(m,l),c,g);if(this.newUpdates){const t=this.safeValue(y,0),e=this.safeString(t,"symbol");i=y.getLimit(e,i)}return this.filterBySinceLimit(y,e,i,"timestamp",!0)}async unWatchTradesForSymbols(t,e={}){await this.loadMarkets();let i,s="multipleTrades";if(void 0!==(t=this.marketSymbols(t,void 0,!1,!0,!0))){if(t.length>200)throw new a.BadRequest(this.id+" watchTradesForSymbols() accepts 200 symbols at most. To watch more symbols call watchTradesForSymbols() multiple times");s+="::"+t.join(",")}[i,e]=this.handleOptionAndParams(e,"watchTradesForSymbols","name","trade"),e=this.omit(e,"callerMethodName");const r=this.market(t[0]);let n=r.type;r.contract&&(n=r.linear?"future":"delivery");const o=[],d=[],c=[];for(let e=0;e<t.length;e++){const s=t[e],r=this.market(s);o.push("trade::"+s),c.push("unsubscribe:trade:"+s);const a=r.lowercaseId+"@"+i;d.push(a)}const h=this.omit(e,"type"),l=d.length,u=this.urls.api.ws[n]+"/"+this.stream(n,s,l),p=this.requestId(u),f={method:"UNSUBSCRIBE",params:d,id:p},m={unsubscribe:!0,id:p.toString(),subMessageHashes:o,messageHashes:c,symbols:t,topic:"trades"};return await this.watchMultiple(u,c,this.extend(f,h),c,m)}async unWatchTrades(t,e={}){return await this.loadMarkets(),await this.unWatchTradesForSymbols([t],e)}async watchTrades(t,e=void 0,i=void 0,s={}){return s.callerMethodName="watchTrades",await this.watchTradesForSymbols([t],e,i,s)}parseWsTrade(t,e=void 0){const i="TRADE"===this.safeString(t,"x");if(!i)return this.parseTrade(t,e);const s=this.safeString2(t,"t","a"),a=this.safeInteger(t,"T"),n=this.safeString2(t,"L","p");let o=this.safeString(t,"q");i&&(o=this.safeString(t,"l",o));let d=this.safeString(t,"Y");void 0===d&&void 0!==n&&void 0!==o&&(d=r.Y.stringMul(n,o));const c=this.safeString(t,"s"),h="ps"in t?"contract":"spot",l=this.safeSymbol(c,void 0,void 0,h);let u,p=this.safeStringLower(t,"S");const f=this.safeString(t,"i");let m;"m"in t&&(void 0===p&&(p=t.m?"sell":"buy"),u=t.m?"maker":"taker");const g=this.safeString(t,"n");if(void 0!==g){const e=this.safeString(t,"N");m={cost:g,currency:this.safeCurrencyCode(e)}}const y=this.safeStringLower(t,"o");return this.safeTrade({info:t,timestamp:a,datetime:this.iso8601(a),symbol:l,id:s,order:f,type:y,takerOrMaker:u,side:p,price:n,amount:o,cost:d,fee:m})}handleTrade(t,e){const i=this.isSpotUrl(t)?"spot":"contract",s=this.safeString(e,"s"),r=this.safeMarket(s,void 0,void 0,i),a=r.symbol,o="trade::"+a,d=this.parseWsTrade(e,r);let c=this.safeValue(this.trades,a);if(void 0===c){const t=this.safeInteger(this.options,"tradesLimit",1e3);c=new n.I3(t)}c.append(d),this.trades[a]=c,t.resolve(c,o)}async watchOHLCV(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();t=this.market(t).symbol,r.callerMethodName="watchOHLCV";return(await this.watchOHLCVForSymbols([[t,e]],i,s,r))[t][e]}async watchOHLCVForSymbols(t,e=void 0,i=void 0,s={}){let a;await this.loadMarkets(),[a,s]=this.handleParamString2(s,"channel","name","kline");const n=this.getListFromObjectValues(t,0),o=this.marketSymbols(n,void 0,!1,!1,!0),d=this.market(o[0]);let c=d.type;d.contract&&(c=d.linear?"future":"delivery");const h="spot"===c;let l;[l,s]=this.handleParamString(s,"timezone",void 0);const u=void 0!==l&&("+08:00"===l||r.Y.stringEq(l,"8")),p=[],f=[];for(let e=0;e<t.length;e++){const i=t[e],s=i[0],r=i[1],n=this.safeString(this.timeframes,r,r),o=this.market(s);let d=o.lowercaseId;"indexPriceKline"===a&&(d=d.replace("_perp",""));const c=u&&h?"@+08:00":"";p.push(d+"@"+a+"_"+n+c),f.push("ohlcv::"+o.symbol+"::"+r)}const m=this.urls.api.ws[c]+"/"+this.stream(c,"multipleOHLCV"),g=this.requestId(m),y={method:"SUBSCRIBE",params:p,id:g},v={id:g};s=this.omit(s,"callerMethodName");const b=await this.watchMultiple(m,f,this.extend(y,s),f,v),[w,S,k]=b;this.newUpdates&&(i=k.getLimit(w,i));const O=this.filterBySinceLimit(k,e,i,0,!0);return this.createOHLCVObject(w,S,O)}async unWatchOHLCVForSymbols(t,e={}){let i;await this.loadMarkets(),[i,e]=this.handleParamString2(e,"channel","name","kline");const s=this.getListFromObjectValues(t,0),a=this.marketSymbols(s,void 0,!1,!1,!0),n=this.market(a[0]);let o=n.type;n.contract&&(o=n.linear?"future":"delivery");const d="spot"===o;let c;[c,e]=this.handleParamString(e,"timezone",void 0);const h=void 0!==c&&("+08:00"===c||r.Y.stringEq(c,"8")),l=[],u=[],p=[];for(let e=0;e<t.length;e++){const s=t[e],r=s[0],a=s[1],n=this.safeString(this.timeframes,a,a),o=this.market(r);let c=o.lowercaseId;"indexPriceKline"===i&&(c=c.replace("_perp",""));const f=h&&d?"@+08:00":"";l.push(c+"@"+i+"_"+n+f),u.push("ohlcv::"+o.symbol+"::"+a),p.push("unsubscribe::ohlcv::"+o.symbol+"::"+a)}const f=this.urls.api.ws[o]+"/"+this.stream(o,"multipleOHLCV"),m=this.requestId(f),g={method:"UNSUBSCRIBE",params:l,id:m},y={unsubscribe:!0,id:m.toString(),symbols:s,symbolsAndTimeframes:t,subMessageHashes:u,messageHashes:p,topic:"ohlcv"};return e=this.omit(e,"callerMethodName"),await this.watchMultiple(f,p,this.extend(g,e),p,y)}async unWatchOHLCV(t,e="1m",i={}){await this.loadMarkets();return t=this.market(t).symbol,i.callerMethodName="watchOHLCV",await this.unWatchOHLCVForSymbols([[t,e]],i)}handleOHLCV(t,e){let i=this.safeString(e,"e");i=this.safeString({indexPrice_kline:"indexPriceKline",markPrice_kline:"markPriceKline"},i,i);const s=this.safeValue(e,"k");let r=this.safeString2(s,"s","ps");"indexPriceKline"===i&&(r=this.safeString(e,"ps"));const a=this.safeString(s,"i"),o=this.findTimeframe(a),d=[this.safeInteger(s,"t"),this.safeFloat(s,"o"),this.safeFloat(s,"h"),this.safeFloat(s,"l"),this.safeFloat(s,"c"),this.safeFloat(s,"v")],c=this.isSpotUrl(t)?"spot":"contract",h=this.safeSymbol(r,void 0,void 0,c),l="ohlcv::"+h+"::"+o;this.ohlcvs[h]=this.safeValue(this.ohlcvs,h,{});let u=this.safeValue(this.ohlcvs[h],o);if(void 0===u){const t=this.safeInteger(this.options,"OHLCVLimit",1e3);u=new n.TG(t),this.ohlcvs[h][o]=u}u.append(d);const p=[h,o,u];t.resolve(p,l)}async fetchTickerWs(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbol:i.id},r=this.getMarketType("fetchTickerWs",i,e);if("future"!==r)throw new a.BadRequest(this.id+" fetchTickerWs only supports swap markets");const n=this.urls.api.ws["ws-api"][r],o=this.requestId(n).toString(),d={method:this.handleTickerWs};let c,h=!1;[h,e]=this.handleOptionAndParams(e,"fetchTickerWs","returnRateLimits",!1),s.returnRateLimits=h,e=this.omit(e,"test"),[c,e]=this.handleOptionAndParams(e,"fetchTickerWs","method","ticker.book");const l={id:o,method:c,params:this.signParams(this.extend(s,e))};return await this.watch(n,o,l,o,d)}async fetchOHLCVWs(t,e="1m",i=void 0,s=void 0,r={}){await this.loadMarkets();const n=this.market(t),o=this.getMarketType("fetchOHLCVWs",n,r);if("spot"!==o&&"future"!==o)throw new a.BadRequest(this.id+" fetchOHLCVWs only supports spot or swap markets");const d=this.urls.api.ws["ws-api"][o],c=this.requestId(d).toString();let h=!1;[h,r]=this.handleOptionAndParams(r,"fetchOHLCVWs","returnRateLimits",!1);const l={symbol:this.marketId(t),returnRateLimits:h,interval:this.timeframes[e]},u=this.safeInteger(r,"until");r=this.omit(r,"until"),void 0!==i&&(l.startTime=i),void 0!==s&&(l.limit=s),void 0!==u&&(l.endTime=u);const p={id:c,method:"klines",params:this.extend(l,r)},f={method:this.handleFetchOHLCV};return await this.watch(d,c,p,c,f)}handleFetchOHLCV(t,e){const i=this.safeList(e,"result"),s=this.parseOHLCVs(i),r=this.safeString(e,"id");t.resolve(s,r)}async watchTicker(t,e={}){await this.loadMarkets(),t=this.symbol(t);return(await this.watchTickers([t],this.extend(e,{callerMethodName:"watchTicker"})))[t]}async watchMarkPrice(t,e={}){await this.loadMarkets(),t=this.symbol(t);return(await this.watchMarkPrices([t],this.extend(e,{callerMethodName:"watchMarkPrice"})))[t]}async watchMarkPrices(t=void 0,e={}){let i;[i,e]=this.handleOptionAndParams(e,"watchMarkPrices","name","markPrice");const s=await this.watchMultiTickerHelper("watchMarkPrices",i,t,e);return this.newUpdates?s:this.filterByArray(this.tickers,"symbol",t)}async watchTickers(t=void 0,e={}){let i;if([i,e]=this.handleOptionAndParams(e,"watchTickers","name","ticker"),"bookTicker"===i)throw new a.BadRequest(this.id+" deprecation notice - to subscribe for bids-asks, use watch_bids_asks() method instead");const s=await this.watchMultiTickerHelper("watchTickers",i,t,e);return this.newUpdates?s:this.filterByArray(this.tickers,"symbol",t)}async unWatchTickers(t=void 0,e={}){let i;if([i,e]=this.handleOptionAndParams(e,"watchTickers","name","ticker"),"bookTicker"===i)throw new a.BadRequest(this.id+" deprecation notice - to subscribe for bids-asks, use watch_bids_asks() method instead");return await this.watchMultiTickerHelper("unWatchTickers",i,t,e,!0)}async unWatchMarkPrices(t=void 0,e={}){let i;return[i,e]=this.handleOptionAndParams(e,"watchMarkPrices","name","markPrice"),await this.loadMarkets(),await this.watchMultiTickerHelper("unWatchMarkPrices",i,t,e,!0)}async unWatchMarkPrice(t,e={}){return await this.unWatchMarkPrices([t],e)}async unWatchTicker(t,e={}){return await this.unWatchTickers([t],e)}async watchBidsAsks(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t,void 0,!0,!1,!0);const i=await this.watchMultiTickerHelper("watchBidsAsks","bookTicker",t,e);return this.newUpdates?i:this.filterByArray(this.bidsasks,"symbol",t)}async watchMultiTickerHelper(t,e,i=void 0,s={},r=!1){await this.loadMarkets(),i=this.marketSymbols(i,void 0,!0,!1,!0);const n="bookTicker"===e,o="markPrice"===e,d=this.safeBool(s,"use1sFreq",!0);let c,h;const l=void 0!==i;l&&(c=this.market(i[0]));const u=o?"swap":void 0;let p,f;if([h,s]=this.handleMarketTypeAndParams(t,c,s,u),[p,s]=this.handleSubTypeAndParams(t,c,s),this.isLinear(h,p))f="future";else if(this.isInverse(h,p))f="delivery";else{if("spot"!==h)throw new a.NotSupported(this.id+" "+t+"() does not support options markets");f=h}if(o&&!this.inArray(h,["swap","future"]))throw new a.NotSupported(this.id+" "+t+"() does not support "+h+" markets yet");const m=[],g=[],y=[];let v,b="";if(o&&(b=d?"@1s":""),v=n?"bidask":o?"markPrice":"ticker",l)for(let t=0;t<i.length;t++){const s=i[t],a=this.market(s);m.push(a.lowercaseId+"@"+e+b),g.push(v+":"+e+"@"+s),r&&y.push("unsubscribe::"+v+":"+e+"@"+s)}else{if(n){if("spot"===h)throw new a.ArgumentsRequired(this.id+" "+t+"() requires symbols for this channel for spot markets");m.push("!"+e)}else o?m.push("!"+e+"@arr"+b):m.push("!"+e+"@arr");g.push(v+"s:"+e),y.push("unsubscribe::"+e)}let w=e;l&&(w=e+"::"+i.join(","));const S=this.urls.api.ws[f]+"/"+this.stream(f,w),k=this.requestId(S),O={method:r?"UNSUBSCRIBE":"SUBSCRIBE",params:m,id:k};let T=g,P={id:k};r&&(P={unsubscribe:!0,id:k.toString(),subMessageHashes:g,messageHashes:y,symbols:i,topic:"ticker"},T=y);const _=await this.watchMultiple(S,T,this.deepExtend(O,s),T,P);if(r)return _;if(l){const t={};return t[_.symbol]=_,t}return _}parseWsTicker(t,e){const i=this.safeString2(t,"s","symbol"),s=this.safeSymbol(i,void 0,void 0,e);let r,a=this.safeString(t,"e","bookTicker");if("24hrTicker"===a&&(a="ticker"),"markPriceUpdate"===a)return this.safeTicker({symbol:s,timestamp:this.safeInteger(t,"E"),datetime:this.iso8601(this.safeInteger(t,"E")),info:t,markPrice:this.safeString(t,"p"),indexPrice:this.safeString(t,"i")});r="bookTicker"===a?this.safeInteger2(t,"E","time"):this.safeIntegerN(t,["C","E","time"]);const n=this.safeMarket(i,void 0,void 0,e),o=this.safeString2(t,"c","price");return this.safeTicker({symbol:s,timestamp:r,datetime:this.iso8601(r),high:this.safeString(t,"h"),low:this.safeString(t,"l"),bid:this.safeString2(t,"b","bidPrice"),bidVolume:this.safeString2(t,"B","bidQty"),ask:this.safeString2(t,"a","askPrice"),askVolume:this.safeString2(t,"A","askQty"),vwap:this.safeString(t,"w"),open:this.safeString(t,"o"),close:o,last:o,previousClose:this.safeString(t,"x"),change:this.safeString(t,"p"),percentage:this.safeString(t,"P"),average:void 0,baseVolume:this.safeString(t,"v"),quoteVolume:this.safeString(t,"q"),info:t},n)}handleTickerWs(t,e){const i=this.safeString(e,"id"),s=this.safeValue(e,"result",{}),r=this.parseWsTicker(s,"future");t.resolve(r,i)}handleBidsAsks(t,e){this.handleTickersAndBidsAsks(t,e,"bidasks")}handleTickers(t,e){this.handleTickersAndBidsAsks(t,e,"tickers")}handleMarkPrices(t,e){this.handleTickersAndBidsAsks(t,e,"markPrices")}handleTickersAndBidsAsks(t,e,i){const s=this.isSpotUrl(t)?"spot":"contract",r="bidasks"===i;let a,n;a=r?"bidask":"markPrices"===i?"markPrice":"ticker";const o=[];let d=[];const c={};Array.isArray(e)?d=e:d.push(e);for(let e=0;e<d.length;e++){const i=d[e];let h=this.safeString(i,"e");if(r&&(h="bookTicker"),n=this.safeString(this.options.tickerChannelsMap,h,h),void 0===n)continue;const l=this.parseWsTicker(i,s),u=l.symbol;c[u]=l,r?this.bidsasks[u]=l:this.tickers[u]=l;const p=a+":"+n+"@"+u;o.push(p),t.resolve(l,p)}if(o.length>0){const e=a+"s:"+n;t.resolve(c,e)}}signParams(t={}){this.checkRequiredCredentials();const e=this.safeInteger(this.options,"recvWindow");void 0!==e&&(t.recvWindow=e);const i=this.safeInteger(t,"recvWindow");void 0!==i&&(t.recvWindow=i);let s=this.extend({timestamp:this.nonce(),apiKey:this.apiKey},t);s=this.keysort(s);const r=this.rawencode(s);let a;return a=this.secret.indexOf("PRIVATE KEY")>-1?this.secret.length>120?(0,d.n)(r,this.secret,o.s):(0,c.q4)(this.encode(r),this.secret,h.ev):this.hmac(this.encode(r),this.encode(this.secret),o.s),s.signature=a,s}async ensureUserDataStreamWsSubscribeSignature(t="spot"){const e=this.urls.api.ws["ws-api"][t],i=this.client(e),s=i.subscriptions,r=Object.keys(s);if(this.getAccountTypeFromSubscriptions(r)===t)return;i.subscriptions[t]=!0;const a=this.requestId(e).toString(),n={id:a,method:"userDataStream.subscribe.signature",params:this.signParams({})},o={id:a,method:this.handleUserDataStreamSubscribe,subscription:t};await this.watch(e,a,n,a,o)}handleUserDataStreamSubscribe(t,e){const i=this.safeString(e,"id"),s=t.subscriptions,r=Object.keys(s),a=this.getAccountTypeFromSubscriptions(r),n=this.safeDict(e,"result",{});void 0===this.safeInteger(n,"subscriptionId")&&(delete t.subscriptions[a],t.reject(e,a)),t.resolve(e,i)}async authenticate(t={}){const e=this.milliseconds();let i,s,r,n;if([i,t]=this.handleMarketTypeAndParams("authenticate",void 0,t),[s,t]=this.handleSubTypeAndParams("authenticate",void 0,t),[r,t]=this.handleOptionAndParams2(t,"authenticate","papi","portfolioMargin",!1),this.isLinear(i,s)?i="future":this.isInverse(i,s)&&(i="delivery"),"spot"===i)return void await this.ensureUserDataStreamWsSubscribeSignature("spot");[n,t]=this.handleMarginModeAndParams("authenticate",t);const o="isolated"===n,d="cross"===n||void 0===n,c=this.safeString(t,"symbol");t=this.omit(t,"symbol");const h=this.safeValue(this.options,i,{}),l=this.safeInteger(h,"lastAuthenticatedTime",0),u=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);if(e-l>this.sum(u,1e4)){let s;if(r)s=await this.papiPostListenKey(t),t=this.extend(t,{portfolioMargin:!0});else if("future"===i)s=await this.fapiPrivatePostListenKey(t);else if("delivery"===i)s=await this.dapiPrivatePostListenKey(t);else if("margin"===i&&d)s=await this.sapiPostUserDataStream(t);else if(o){if(void 0===c)throw new a.ArgumentsRequired(this.id+" authenticate() requires a symbol argument for isolated margin mode");const e=this.marketId(c);t=this.extend(t,{symbol:e}),s=await this.sapiPostUserDataStreamIsolated(t)}else s=await this.publicPostUserDataStream(t);this.options[i]=this.extend(h,{listenKey:this.safeString(s,"listenKey"),lastAuthenticatedTime:e}),this.delay(u,this.keepAliveListenKey,t)}}async keepAliveListenKey(t={}){let e,i=this.safeString2(this.options,"defaultType","authenticate","spot");i=this.safeString(t,"type",i),[e,t]=this.handleOptionAndParams2(t,"keepAliveListenKey","papi","portfolioMargin",!1);const s=this.handleSubTypeAndParams("keepAliveListenKey",void 0,t)[0];this.isLinear(i,s)?i="future":this.isInverse(i,s)&&(i="delivery");const r=this.safeValue(this.options,i,{}),a=this.safeString(r,"listenKey");if(void 0===a)return;const n={},o=this.safeString(t,"symbol");t=this.omit(t,["type","symbol"]);const d=this.milliseconds();try{e?(await this.papiPutListenKey(this.extend(n,t)),t=this.extend(t,{portfolioMargin:!0})):"future"===i?await this.fapiPrivatePutListenKey(this.extend(n,t)):"delivery"===i?await this.dapiPrivatePutListenKey(this.extend(n,t)):(n.listenKey=a,"margin"===i?(n.symbol=o,await this.sapiPutUserDataStream(this.extend(n,t))):await this.publicPutUserDataStream(this.extend(n,t)))}catch(t){let s=i;e&&(s="papi");const a=this.urls.api.ws[s]+"/"+this.options[i].listenKey,n=this.client(a),o=Object.keys(n.futures);for(let e=0;e<o.length;e++){const i=o[e];n.reject(t,i)}return void(this.options[i]=this.extend(r,{listenKey:void 0,lastAuthenticatedTime:0}))}this.options[i]=this.extend(r,{listenKey:a,lastAuthenticatedTime:d});const c=Object.values(this.clients),h=this.safeInteger(this.options,"listenKeyRefreshRate",12e5);for(let e=0;e<c.length;e++){const s=c[e],r=Object.keys(s.subscriptions);for(let e=0;e<r.length;e++){if(r[e]===i)return void this.delay(h,this.keepAliveListenKey,t)}}}setBalanceCache(t,e,i=!1){if(e in t.subscriptions&&e in this.balance)return;const s=this.safeValue(this.options,"watchBalance");if(this.safeBool(s,"fetchBalanceSnapshot",!1)){const s=e+":fetchBalanceSnapshot";s in t.futures||(t.future(s),this.spawn(this.loadBalanceSnapshot,t,s,e,i))}else this.balance[e]={}}async loadBalanceSnapshot(t,e,i,s){const r={type:i};s&&(r.portfolioMargin=!0);const a=await this.fetchBalance(r);if(this.balance[i]=this.extend(a,this.safeValue(this.balance,i,{})),e in t.futures){t.futures[e].resolve(),t.resolve(this.balance[i],i+":balance")}}async fetchBalanceWs(t={}){await this.loadMarkets();const e=this.getMarketType("fetchBalanceWs",void 0,t);if("spot"!==e&&"future"!==e&&"delivery"!==e)throw new a.BadRequest(this.id+" fetchBalanceWs only supports spot or swap markets");const i=this.urls.api.ws["ws-api"][e],s=this.requestId(i).toString();let r=!1;[r,t]=this.handleOptionAndParams(t,"fetchBalanceWs","returnRateLimits",!1);const n={returnRateLimits:r};let o;[o,t]=this.handleOptionAndParams(t,"fetchBalanceWs","method","account.status");const d={id:s,method:o,params:this.signParams(this.extend(n,t))},c={method:"account.status"===o?this.handleAccountStatusWs:this.handleBalanceWs};return await this.watch(i,s,d,s,c)}handleBalanceWs(t,e){const i=this.safeString(e,"id");let s;if(Array.isArray(e.result))s=this.safeList(e,"result",[]);else{const t=this.safeDict(e,"result",{});s=this.safeList(t,"assets",[])}const r=this.parseBalanceCustom(s);t.resolve(r,i)}handleAccountStatusWs(t,e){const i=this.safeString(e,"id"),s=this.safeDict(e,"result",{}),r=this.parseBalanceCustom(s);t.resolve(r,i)}async fetchPositionWs(t,e={}){return await this.fetchPositionsWs([t],e)}async fetchPositionsWs(t=void 0,e={}){await this.loadMarkets();const i={};let s;if(void 0!==(t=this.marketSymbols(t,"swap",!0,!0,!0))){1===t.length&&(s=this.market(t[0]),i.symbol=s.id)}const r=this.getMarketType("fetchPositionsWs",s,e);if("future"!==r&&"delivery"!==r)throw new a.BadRequest(this.id+" fetchPositionsWs only supports swap markets");const n=this.urls.api.ws["ws-api"][r],o=this.requestId(n).toString();let d,c=!1;[c,e]=this.handleOptionAndParams(e,"fetchPositionsWs","returnRateLimits",!1),i.returnRateLimits=c,[d,e]=this.handleOptionAndParams(e,"fetchPositionsWs","method","account.position");const h={id:o,method:d,params:this.signParams(this.extend(i,e))},l={method:this.handlePositionsWs},u=await this.watch(n,o,h,o,l);return this.filterByArrayPositions(u,"symbol",t,!1)}handlePositionsWs(t,e){const i=this.safeString(e,"id"),s=this.safeList(e,"result",[]),r=[];for(let t=0;t<s.length;t++){const e=this.parsePositionRisk(s[t]),i=this.safeString(e,"entryPrice");"0"!==i&&"0.0"!==i&&"0.00000000"!==i&&r.push(e)}t.resolve(r,i)}async watchBalance(t={}){await this.loadMarkets(),await this.authenticate(t);const e=this.safeString(this.options,"defaultType","spot");let i,s,r=this.safeString(t,"type",e);[i,t]=this.handleSubTypeAndParams("watchBalance",void 0,t),[s,t]=this.handleOptionAndParams2(t,"watchBalance","papi","portfolioMargin",!1),this.isLinear(r,i)?r="future":this.isInverse(r,i)&&(r="delivery");let a="",n=r;"spot"===r?a=this.urls.api.ws["ws-api"][r]:(s&&(n="papi"),a=this.urls.api.ws[n]+"/"+this.options[r].listenKey);const o=this.client(a);this.setBalanceCache(o,r,s),this.setPositionsCache(o,r,void 0,s);const d=this.safeDict(this.options,"watchBalance"),c=this.safeBool(d,"fetchBalanceSnapshot",!1),h=this.safeBool(d,"awaitBalanceSnapshot",!0);c&&h&&await o.future(r+":fetchBalanceSnapshot");const l=r+":balance";return await this.watch(a,l,undefined,r)}handleBalance(t,e){const i=this.safeString(this.options,"wallet","wb"),s=t.subscriptions,a=Object.keys(s),n=this.getAccountTypeFromSubscriptions(a),o=n+":balance";void 0===this.balance[n]&&(this.balance[n]={}),this.balance[n].info=e;if("balanceUpdate"===this.safeString(e,"e")){const t=this.safeString(e,"a"),i=this.safeCurrencyCode(t),s=this.account(),a=this.safeString(e,"d");if(i in this.balance[n]){let t=this.balance[n][i].free;"string"!=typeof t&&(t=this.numberToString(t)),s.free=r.Y.stringAdd(t,a)}else s.free=a;this.balance[n][i]=s}else{e=this.safeDict(e,"a",e);const t=this.safeList(e,"B");for(let e=0;e<t.length;e++){const s=t[e],r=this.safeString(s,"a"),a=this.safeCurrencyCode(r),o=this.account();o.free=this.safeString(s,"f"),o.used=this.safeString(s,"l"),o.total=this.safeString(s,i),this.balance[n][a]=o}}const d=this.safeInteger(e,"E");this.balance[n].timestamp=d,this.balance[n].datetime=this.iso8601(d),this.balance[n]=this.safeBalance(this.balance[n]),t.resolve(this.balance[n],o)}getAccountTypeFromSubscriptions(t){let e="";for(let i=0;i<t.length;i++){const s=t[i];if("spot"===s||"margin"===s||"future"===s||"delivery"===s){e=s;break}}return e}getMarketType(t,e,i={}){let s,r;return[s,i]=this.handleMarketTypeAndParams(t,e,i),[r,i]=this.handleSubTypeAndParams(t,e,i),this.isLinear(s,r)?s="future":this.isInverse(s,r)&&(s="delivery"),s}async createOrderWs(t,e,i,s,r=void 0,n={}){await this.loadMarkets();const o=this.market(t),d=this.getMarketType("createOrderWs",o,n);if("spot"!==d&&"future"!==d&&"delivery"!==d)throw new a.BadRequest(this.id+" createOrderWs only supports spot or swap markets");const c=this.urls.api.ws["ws-api"][d],h=this.requestId(c).toString(),l=this.safeBool2(n,"sor","SOR",!1);n=this.omit(n,"sor","SOR");const u=this.safeString2(n,"triggerPrice","stopPrice"),p=this.safeString(n,"stopLossPrice",u),f=this.safeString(n,"takeProfitPrice"),m=this.safeString(n,"trailingDelta"),g=this.safeStringN(n,["trailingPercent","callbackRate","trailingDelta"]),y=void 0!==u||void 0!==g||(void 0!==p||void 0!==m)||void 0!==f,v=this.createOrderRequest(t,e,i,s,r,n);let b=!1;[b,n]=this.handleOptionAndParams(n,"createOrderWs","returnRateLimits",!1),v.returnRateLimits=b;const w=this.safeBool(n,"test",!1);n=this.omit(n,"test"),o.linear&&o.swap&&y&&(v.algoType="CONDITIONAL");const S={id:h,method:"order.place",params:this.signParams(this.extend(v,n))};w&&(S.method=l?"sor.order.test":"order.test"),o.linear&&o.swap&&y&&(S.method="algoOrder.place");const k={method:this.handleOrderWs};return await this.watch(c,h,S,h,k)}handleOrderWs(t,e){const i=this.safeString(e,"id"),s=this.safeDict(e,"result",{}),r=this.parseOrder(s);t.resolve(r,i)}handleOrdersWs(t,e){const i=this.safeString(e,"id"),s=this.safeList(e,"result",[]),r=this.parseOrders(s);t.resolve(r,i)}async editOrderWs(t,e,i,s,r=void 0,n=void 0,o={}){await this.loadMarkets();const d=this.market(e),c=this.getMarketType("editOrderWs",d,o);if("spot"!==c&&"future"!==c&&"delivery"!==c)throw new a.BadRequest(this.id+" editOrderWs only supports spot or swap markets");const h=this.urls.api.ws["ws-api"][c],l=this.requestId(h).toString(),u="future"===c||"delivery"===c;let p;"spot"===c?p=this.editSpotOrderRequest(t,e,i,s,r,n,o):u&&(p=this.editContractOrderRequest(t,e,i,s,r,n,o));let f=!1;[f,o]=this.handleOptionAndParams(o,"editOrderWs","returnRateLimits",!1),p.returnRateLimits=f;const m={id:l,method:u?"order.modify":"order.cancelReplace",params:this.signParams(this.extend(p,o))},g={method:this.handleEditOrderWs};return await this.watch(h,l,m,l,g)}handleEditOrderWs(t,e){const i=this.safeString(e,"id"),s=this.safeDict(e,"result",{}),r=this.safeDict(s,"newOrderResponse");let a;a=void 0!==r?this.parseOrder(r):this.parseOrder(s),t.resolve(a,i)}async cancelOrderWs(t,e=void 0,i={}){if(await this.loadMarkets(),void 0===e)throw new a.BadRequest(this.id+" cancelOrderWs requires a symbol");const s=this.market(e),r=this.getMarketType("cancelOrderWs",s,i),n=this.urls.api.ws["ws-api"][r],o=this.requestId(n).toString();let d=!1;[d,i]=this.handleOptionAndParams(i,"cancelOrderWs","returnRateLimits",!1);const c={symbol:this.marketId(e),returnRateLimits:d},h=this.safeBoolN(i,["stop","trigger","conditional"]),l=this.safeStringN(i,["clientAlgoId","origClientOrderId","clientOrderId"]),u=s.linear&&s.swap&&h;void 0!==l?u?c.clientAlgoId=l:c.origClientOrderId=l:u?c.algoId=this.numberToString(t):c.orderId=this.numberToString(t),i=this.omit(i,["origClientOrderId","clientOrderId","stop","trigger","conditional"]);const p={id:o,method:"order.cancel",params:this.signParams(this.extend(c,i))};u&&(p.method="algoOrder.cancel");const f={method:this.handleOrderWs};return await this.watch(n,o,p,o,f)}async cancelAllOrdersWs(t=void 0,e={}){await this.loadMarkets();const i=this.market(t),s=this.getMarketType("cancelAllOrdersWs",i,e);if("spot"!==s)throw new a.BadRequest(this.id+" cancelAllOrdersWs only supports spot markets");const r=this.urls.api.ws["ws-api"][s],n=this.requestId(r).toString();let o=!1;[o,e]=this.handleOptionAndParams(e,"cancelAllOrdersWs","returnRateLimits",!1);const d={symbol:this.marketId(t),returnRateLimits:o},c={id:n,method:"openOrders.cancelAll",params:this.signParams(this.extend(d,e))},h={method:this.handleOrdersWs};return await this.watch(r,n,c,n,h)}async fetchOrderWs(t,e=void 0,i={}){if(await this.loadMarkets(),void 0===e)throw new a.BadRequest(this.id+" cancelOrderWs requires a symbol");const s=this.market(e),r=this.getMarketType("fetchOrderWs",s,i);if("spot"!==r&&"future"!==r&&"delivery"!==r)throw new a.BadRequest(this.id+" fetchOrderWs only supports spot or swap markets");const n=this.urls.api.ws["ws-api"][r],o=this.requestId(n).toString();let d=!1;[d,i]=this.handleOptionAndParams(i,"fetchOrderWs","returnRateLimits",!1);const c={symbol:this.marketId(e),returnRateLimits:d},h=this.safeString2(i,"origClientOrderId","clientOrderId");void 0!==h?c.origClientOrderId=h:c.orderId=this.numberToString(t);const l={id:o,method:"order.status",params:this.signParams(this.extend(c,i))},u={method:this.handleOrderWs};return await this.watch(n,o,l,o,u)}async fetchOrdersWs(t=void 0,e=void 0,i=void 0,s={}){if(await this.loadMarkets(),void 0===t)throw new a.BadRequest(this.id+" fetchOrdersWs requires a symbol");const r=this.market(t),n=this.getMarketType("fetchOrdersWs",r,s);if("spot"!==n)throw new a.BadRequest(this.id+" fetchOrdersWs only supports spot markets");const o=this.urls.api.ws["ws-api"][n],d=this.requestId(o).toString();let c=!1;[c,s]=this.handleOptionAndParams(s,"fetchOrderWs","returnRateLimits",!1);const h={symbol:this.marketId(t),returnRateLimits:c},l={id:d,method:"allOrders",params:this.signParams(this.extend(h,s))},u={method:this.handleOrdersWs},p=await this.watch(o,d,l,d,u);return this.filterBySymbolSinceLimit(p,t,e,i)}async fetchClosedOrdersWs(t=void 0,e=void 0,i=void 0,s={}){const r=await this.fetchOrdersWs(t,e,i,s),a=[];for(let t=0;t<r.length;t++){const e=r[t];"closed"===e.status&&a.push(e)}return a}async fetchOpenOrdersWs(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),n=this.getMarketType("fetchOpenOrdersWs",r,s);if("spot"!==n&&"future"!==n)throw new a.BadRequest(this.id+" fetchOpenOrdersWs only supports spot or swap markets");const o=this.urls.api.ws["ws-api"][n],d=this.requestId(o).toString();let c=!1;[c,s]=this.handleOptionAndParams(s,"fetchOrderWs","returnRateLimits",!1);const h={returnRateLimits:c};void 0!==t&&(h.symbol=this.marketId(t));const l={id:d,method:"openOrders.status",params:this.signParams(this.extend(h,s))},u={method:this.handleOrdersWs},p=await this.watch(o,d,l,d,u);return this.filterBySymbolSinceLimit(p,t,e,i)}async watchOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n,o,d="orders";void 0!==t&&(r=this.market(t),d+=":"+(t=r.symbol)),[a,s]=this.handleMarketTypeAndParams("watchOrders",r,s),[n,s]=this.handleSubTypeAndParams("watchOrders",r,s),this.isLinear(a,n)?a="future":this.isInverse(a,n)&&(a="delivery"),s=this.extend(s,{type:a,symbol:t,subType:n}),await this.authenticate(s),[o,s]=this.handleMarginModeAndParams("watchOrders",s);let c,h=a;("margin"===a||"spot"===a&&void 0!==o)&&(h="spot"),[c,s]=this.handleOptionAndParams2(s,"watchOrders","papi","portfolioMargin",!1);let l="";"spot"===a?l=this.urls.api.ws["ws-api"][a]:(c&&(h="papi"),l=this.urls.api.ws[h]+"/"+this.options[a].listenKey);const u=this.client(l);this.setBalanceCache(u,a,c),this.setPositionsCache(u,a,void 0,c);const p=await this.watch(l,d,undefined,a);return this.newUpdates&&(i=p.getLimit(t,i)),this.filterBySymbolSinceLimit(p,t,e,i,!0)}parseWsOrder(t,e=void 0){const i=this.safeString(t,"x"),s=this.safeString(t,"s"),a="ps"in t?"contract":"spot",n=this.safeSymbol(s,void 0,void 0,a);let o=this.safeInteger(t,"O");const d=this.safeInteger(t,"T");let c;"NEW"===i||"AMENDMENT"===i||"CANCELED"===i?void 0===o&&(o=d):"TRADE"===i&&(c=d);const h=d;let l;const u=this.safeString(t,"n");if(void 0!==u&&r.Y.stringGt(u,"0")){const e=this.safeString(t,"N");l={cost:u,currency:this.safeCurrencyCode(e)}}const p=this.safeString(t,"X"),f=this.parseOrderStatus(p);let m=this.safeString2(t,"C","caid");void 0!==m&&0!==m.length||(m=this.safeString(t,"c"));const g=this.safeStringN(t,["P","sp","tp"]);let y=this.safeString(t,"f");return"GTX"===y&&(y="PO"),this.safeOrder({info:t,symbol:n,id:this.safeString2(t,"i","aid"),clientOrderId:m,timestamp:o,datetime:this.iso8601(o),lastTradeTimestamp:c,lastUpdateTimestamp:h,type:this.parseOrderType(this.safeStringLower(t,"o")),timeInForce:y,postOnly:void 0,reduceOnly:this.safeBool(t,"R"),side:this.safeStringLower(t,"S"),price:this.safeString(t,"p"),stopPrice:g,triggerPrice:g,amount:this.safeString(t,"q"),cost:this.safeString(t,"Z"),average:this.safeString(t,"ap"),filled:this.safeString(t,"z"),remaining:void 0,status:f,fee:l,trades:void 0})}handleOrderUpdate(t,e){const i=this.safeString(e,"e");"ORDER_TRADE_UPDATE"!==i&&"ALGO_UPDATE"!==i||(e=this.safeDict(e,"o",e)),this.handleMyTrade(t,e),this.handleOrder(t,e),this.handleMyLiquidation(t,e)}async watchPositions(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets();let a,n,o="";t=this.marketSymbols(t),this.isEmpty(t)||(r=this.getMarketFromSymbols(t),o="::"+t.join(",")),[a,s]=this.handleMarketTypeAndParams("watchPositions",r,s),"spot"!==a&&"margin"!==a||(a="future"),[n,s]=this.handleSubTypeAndParams("watchPositions",r,s),this.isLinear(a,n)?a="future":this.isInverse(a,n)&&(a="delivery");const d={};let c;d.type=a,d.subType=n,await this.authenticate(this.extend(d,s)),o=a+":positions"+o,[c,s]=this.handleOptionAndParams2(s,"watchPositions","papi","portfolioMargin",!1);let h=a;c&&(h="papi");const l=this.urls.api.ws[h]+"/"+this.options[a].listenKey,u=this.client(l);this.setBalanceCache(u,a,c),this.setPositionsCache(u,a,t,c);const p=this.handleOption("watchPositions","fetchPositionsSnapshot",!0),f=this.handleOption("watchPositions","awaitPositionsSnapshot",!0),m=this.safeValue(this.positions,a);if(p&&f&&void 0===m){const s=await u.future(a+":fetchPositionsSnapshot");return this.filterBySymbolsSinceLimit(s,t,e,i,!0)}const g=await this.watch(l,o,void 0,a);return this.newUpdates?g:this.filterBySymbolsSinceLimit(m,t,e,i,!0)}setPositionsCache(t,e,i=void 0,s=!1){if("spot"===e)return;if(void 0===this.positions&&(this.positions={}),e in this.positions)return;if(this.handleOption("watchPositions","fetchPositionsSnapshot",!1)){const i=e+":fetchPositionsSnapshot";i in t.futures||(t.future(i),this.spawn(this.loadPositionsSnapshot,t,i,e,s))}else this.positions[e]=new n.Hk}async loadPositionsSnapshot(t,e,i,s){const r={type:i};s&&(r.portfolioMargin=!0);const a=await this.fetchPositions(void 0,r);this.positions[i]=new n.Hk;const o=this.positions[i];for(let t=0;t<a.length;t++){const e=a[t];this.safeNumber(e,"contracts",0)>0&&o.append(e)}if(e in t.futures){t.futures[e].resolve(o),t.resolve(o,i+":position")}}handlePositions(t,e){const i=t.subscriptions,s=Object.keys(i),r=this.getAccountTypeFromSubscriptions(s);void 0===this.positions&&(this.positions={}),r in this.positions||(this.positions[r]=new n.Hk);const a=this.positions[r],o=this.safeDict(e,"a",{}),d=this.safeList(o,"P",[]),c=[];for(let t=0;t<d.length;t++){const i=d[t],s=this.parseWsPosition(i),r=this.safeInteger(e,"E");s.timestamp=r,s.datetime=this.iso8601(r),c.push(s),a.append(s)}const h=this.findMessageHashes(t,r+":positions::");for(let e=0;e<h.length;e++){const i=h[e],s=i.split("::")[1].split(","),r=this.filterByArray(c,"symbol",s,!1);this.isEmpty(r)||t.resolve(r,i)}t.resolve(c,r+":positions")}parseWsPosition(t,e=void 0){const i=this.safeString(t,"s"),s=this.safeString(t,"pa"),a=r.Y.stringAbs(this.safeString(t,"pa"));let n=this.safeStringLower(t,"ps"),o=!0;return"both"===n&&(o=!1,r.Y.stringEq(s,"0")||(n=r.Y.stringLt(s,"0")?"short":"long")),this.safePosition({info:t,id:void 0,symbol:this.safeSymbol(i,void 0,void 0,"swap"),notional:void 0,marginMode:this.safeString(t,"mt"),liquidationPrice:void 0,entryPrice:this.safeNumber(t,"ep"),unrealizedPnl:this.safeNumber(t,"up"),percentage:void 0,contracts:this.parseNumber(a),contractSize:void 0,markPrice:void 0,side:n,hedged:o,timestamp:void 0,datetime:void 0,maintenanceMargin:void 0,maintenanceMarginPercentage:void 0,collateral:void 0,initialMargin:void 0,initialMarginPercentage:void 0,leverage:void 0,marginRatio:void 0})}async fetchMyTradesWs(t=void 0,e=void 0,i=void 0,s={}){if(await this.loadMarkets(),void 0===t)throw new a.BadRequest(this.id+" fetchMyTradesWs requires a symbol");const r=this.market(t),n=this.getMarketType("fetchMyTradesWs",r,s);if("spot"!==n&&"future"!==n)throw new a.BadRequest(this.id+" fetchMyTradesWs does not support "+n+" markets");const o=this.urls.api.ws["ws-api"][n],d=this.requestId(o).toString();let c=!1;[c,s]=this.handleOptionAndParams(s,"fetchMyTradesWs","returnRateLimits",!1);const h={symbol:this.marketId(t),returnRateLimits:c};void 0!==e&&(h.startTime=e),void 0!==i&&(h.limit=i);if(void 0!==this.safeInteger(s,"fromId")&&void 0!==e)throw new a.BadRequest(this.id+" fetchMyTradesWs does not support fetching by both fromId and since parameters at the same time");const l={id:d,method:"myTrades",params:this.signParams(this.extend(h,s))},u={method:this.handleTradesWs},p=await this.watch(o,d,l,d,u);return this.filterBySymbolSinceLimit(p,t,e,i)}async fetchTradesWs(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),n=this.getMarketType("fetchTradesWs",r,s);if("spot"!==n&&"future"!==n)throw new a.BadRequest(this.id+" fetchTradesWs does not support "+n+" markets");const o=this.urls.api.ws["ws-api"][n],d=this.requestId(o).toString();let c=!1;[c,s]=this.handleOptionAndParams(s,"fetchTradesWs","returnRateLimits",!1);const h={symbol:this.marketId(t),returnRateLimits:c};void 0!==i&&(h.limit=i);const l={id:d,method:"trades.historical",params:this.extend(h,s)},u={method:this.handleTradesWs},p=await this.watch(o,d,l,d,u);return this.filterBySinceLimit(p,e,i)}handleTradesWs(t,e){const i=this.safeString(e,"id"),s=this.safeList(e,"result",[]),r=this.parseTrades(s);t.resolve(r,i)}async watchMyTrades(t=void 0,e=void 0,i=void 0,s={}){let r,a,n;await this.loadMarkets(),void 0!==t&&(a=this.market(t),t=a.symbol),[r,s]=this.handleMarketTypeAndParams("watchMyTrades",a,s),[n,s]=this.handleSubTypeAndParams("watchMyTrades",a,s),this.isLinear(r,n)?r="future":this.isInverse(r,n)&&(r="delivery");let o="myTrades";void 0!==t&&(o+=":"+(t=this.symbol(t)),s=this.extend(s,{type:a.type,symbol:t})),await this.authenticate(this.extend({type:r,subType:n},s));let d,c=r;"margin"===r&&(c="spot"),[d,s]=this.handleOptionAndParams2(s,"watchMyTrades","papi","portfolioMargin",!1);let h="";"spot"===r?h=this.urls.api.ws["ws-api"][r]:(d&&(c="papi"),h=this.urls.api.ws[c]+"/"+this.options[r].listenKey);const l=this.client(h);this.setBalanceCache(l,r,d),this.setPositionsCache(l,r,void 0,d);const u=await this.watch(h,o,undefined,r);return this.newUpdates&&(i=u.getLimit(t,i)),this.filterBySymbolSinceLimit(u,t,e,i,!0)}handleMyTrade(t,e){const i="myTrades";if("TRADE"===this.safeString(e,"x")){const s=this.parseWsTrade(e),r=this.safeString(s,"order");let a=this.safeDict(s,"fee",{});a=this.extend({},a);const o=this.safeString(s,"symbol");if(void 0!==r&&void 0!==a&&void 0!==o){const t=this.orders;if(void 0!==t){const e=this.safeValue(t.hashmap,o,{}),i=this.safeValue(e,r);if(void 0!==i){const t=this.safeValue(i,"fees"),e=this.safeValue(i,"fee");if(this.isEmpty(t))if(void 0!==e)if(e.currency===a.currency){const t=this.sum(e.cost,a.cost);i.fee.cost=parseFloat(this.currencyToPrecision(a.currency,t))}else void 0===e.currency?i.fee=a:(i.fees=[e,a],i.fee=void 0);else i.fee=a;else{let e=!0;for(let s=0;s<t.length;s++){const r=t[s];if(r.currency===a.currency){const t=this.sum(a.cost,r.cost);i.fees[s].cost=parseFloat(this.currencyToPrecision(a.currency,t)),e=!1;break}}e&&i.fees.push(a)}const r=this.safeList(i,"trades",[]);r.push(s),i.trades=r}}}if(void 0===this.myTrades){const t=this.safeInteger(this.options,"tradesLimit",1e3);this.myTrades=new n.Pt(t)}this.myTrades.append(s),t.resolve(this.myTrades,i);const d=i+":"+o;t.resolve(this.myTrades,d)}}handleOrder(t,e){const i=this.parseWsOrder(e),s=this.safeString(i,"symbol"),r=this.safeString(i,"id");if(void 0!==s){if(void 0===this.orders){const t=this.safeInteger(this.options,"ordersLimit",1e3);this.orders=new n.Pt(t)}const e=this.orders,a=this.safeValue(e.hashmap,s,{}),o=this.safeValue(a,r);if(void 0!==o){const t=this.safeValue(o,"fee");void 0!==t&&(i.fee=t);const e=this.safeValue(o,"fees");void 0!==e&&(i.fees=e),i.trades=this.safeValue(o,"trades");void 0===this.safeInteger(i,"timestamp")&&(i.timestamp=this.safeInteger(o,"timestamp"),i.datetime=this.safeString(o,"datetime"))}e.append(i);const d="orders",c="orders:"+s;t.resolve(e,d),t.resolve(e,c)}}handleAcountUpdate(t,e){this.handleBalance(t,e),this.handlePositions(t,e)}handleWsError(t,e){const i=this.safeString(e,"id");let s=!1;const r=this.safeDict(e,"error",{}),a=this.safeInteger(r,"code"),n=this.safeString(r,"msg");try{this.handleErrors(a,n,t.url,"",{},this.json(r),r,{},{})}catch(e){s=!0,t.reject(e,i);const r=Object.keys(t.subscriptions);for(let s=0;s<r.length;s++){const a=r[s],n=this.safeString(t.subscriptions[a],"id"),o=this.safeString(t.subscriptions[a],"subscription");i===n&&(t.reject(e,a),void 0!==o&&delete t.subscriptions[o])}}s||t.reject(e,i);const o=this.safeString(r,"code");void 0!==o&&"5"===o[0]&&t.reset(e)}handleEventStreamTerminated(t,e){const i=this.safeString(e,"e"),s=t.subscriptions,r=Object.keys(s),a=this.getAccountTypeFromSubscriptions(r);"eventStreamTerminated"===i&&(delete t.subscriptions[a],t.reject(e,a))}handleMessage(t,e){const i=this.safeDict(e,"event");void 0!==i&&(e=i);const s=this.safeString(e,"status");if(void 0!==this.safeValue(e,"error")||void 0!==s&&"200"!==s)return void this.handleWsError(t,e);const r=this.safeString(e,"id"),a=this.safeValue(t.subscriptions,r);let n=this.safeValue(a,"method");if(void 0!==n)return void n.call(this,t,e);const o={depthUpdate:this.handleOrderBook,trade:this.handleTrade,aggTrade:this.handleTrade,kline:this.handleOHLCV,markPrice_kline:this.handleOHLCV,indexPrice_kline:this.handleOHLCV,"1hTicker@arr":this.handleTickers,"4hTicker@arr":this.handleTickers,"1dTicker@arr":this.handleTickers,"24hrTicker@arr":this.handleTickers,"24hrMiniTicker@arr":this.handleTickers,"1hTicker":this.handleTickers,"4hTicker":this.handleTickers,"1dTicker":this.handleTickers,"24hrTicker":this.handleTickers,"24hrMiniTicker":this.handleTickers,markPriceUpdate:this.handleMarkPrices,"markPriceUpdate@arr":this.handleMarkPrices,bookTicker:this.handleBidsAsks,outboundAccountPosition:this.handleBalance,balanceUpdate:this.handleBalance,ACCOUNT_UPDATE:this.handleAcountUpdate,executionReport:this.handleOrderUpdate,ORDER_TRADE_UPDATE:this.handleOrderUpdate,ALGO_UPDATE:this.handleOrderUpdate,forceOrder:this.handleLiquidation,eventStreamTerminated:this.handleEventStreamTerminated,externalLockUpdate:this.handleBalance};let d=this.safeString(e,"e");if(Array.isArray(e)){const t=e[0];d=this.safeString(t,"e")+"@arr"}if(n=this.safeValue(o,d),void 0===n){if(void 0!==this.safeString(e,"id"))return void this.handleSubscriptionStatus(t,e);void 0===d&&"a"in e&&"b"in e&&this.handleBidsAsks(t,e)}else n.call(this,t,e)}}},9550(t,e,i){"use strict";function s(t,e){if(!t)throw new Error(e||"Assertion failure")}i.d(e,{A:()=>s})},9560(t,e,i){"use strict";i.d(e,{Am:()=>E,D4:()=>_,Dy:()=>k,FF:()=>m,LI:()=>A,Pq:()=>o,QM:()=>u,Ry:()=>y,Vw:()=>w,aN:()=>I,bj:()=>v,cg:()=>p,ev:()=>O,kn:()=>c,lF:()=>P,mC:()=>d,mu:()=>S,q3:()=>l,qE:()=>x,qo:()=>b,rO:()=>T,sQ:()=>f,t7:()=>g,wN:()=>h,xg:()=>M});var s=i(4710),r=i(191),a=i(917),n=i(3649);const o=(t,e=void 0)=>JSON.stringify(t),d=t=>"string"==typeof t&&t.length>=2&&("{"===t[0]||"["===t[0]),c=s.As.encode,h=s.As.decode,l=t=>s.K3.encode(s.As.decode(t)),u=t=>s.As.encode(s.K3.decode(t)),p=s.K3.decode,f=s.K3.encode,m=s.xn.decode,g=s.xn.encode,y=s.tw.decode,v=s.tw.encode,b=r.Id,w=t=>(0,r.Id)(...t),S=(t,e=!1)=>n.Ay.stringify(t),k=t=>n.Ay.stringify(t),O=t=>n.Ay.stringify(t,{arrayFormat:"repeat"}),T=(t,e=!1)=>n.Ay.stringify(t,{encode:!1}),P=s.As.decode,_=s.As.encode,A=t=>("string"==typeof t?l(t):f(t)).replace(/[=]+$/,"").replace(/\+/g,"-").replace(/\//g,"_"),I=(t,e)=>(0,r.z)(BigInt(t),e),x=(t,e)=>(0,r.lq)(BigInt(t),e);function E(t){return(0,a.l)(t)}function M(t,e=!0){let i=t.replace(/\+/g,"-").replace(/\//g,"_");return e&&(i=i.replace(/=+$/,"")),i}},9620(t,e,i){"use strict";var s;i.d(e,{R:()=>s,c:()=>r}),function(t){t[t.Some=0]="Some",t[t.None=1]="None"}(s||(s={}));class r{constructor(t,e){if(!(t in s))throw new Error("Wrong variant : should be CairoOptionVariant.Some or .None.");if(t===s.Some){if(void 0===e)throw new Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=e,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){if(!this.None)return this.Some}isSome(){return!(void 0===this.Some)}isNone(){return!0===this.None}}},9654(t,e,i){"use strict";function s(t,e,i){const s=e.split("|").map(t=>t.trim());for(let i=0;i<s.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const r=new Error(`invalid value for type ${e}`);throw r.code="INVALID_ARGUMENT",r.argument=`value.${i}`,r.value=t,r}function r(t,e,i){for(let r in e){let a=e[r];const n=i?i[r]:null;n&&s(a,n,r),Object.defineProperty(t,r,{enumerable:!0,value:a,writable:!1})}}i.d(e,{n:()=>r})},9671(t,e,i){"use strict";i.d(e,{h:()=>a});var s=i(4176);const r=new Uint8Array([]);class a extends s.Ue{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes(r)}decode(t){return t.readBytes(0),null}}},9793(t,e,i){"use strict";i.d(e,{BK:()=>d});var s=i(3187),r=i(8325),a=i(178),n=i(1686);function o(t){const e=BigInt(function(t){return(0,a.VO)((0,s.Dq)((0,a.yw)(t)).toString(16))}(t));return e&r.n$}function d(t){return(0,n.nj)(o(t))}},9806(t,e,i){"use strict";i.d(e,{D:()=>s});i(1265),i(9171);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());const s={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(""!==t.owner&&e.uint32(10).string(t.owner),0!==t.number&&e.uint32(16).uint32(t.number),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let s=void 0===e?i.len:i.pos+e;const r={owner:"",number:0};for(;i.pos<s;){const t=i.uint32();switch(t>>>3){case 1:r.owner=i.string();break;case 2:r.number=i.uint32();break;default:i.skipType(7&t)}}return r},fromPartial(t){const e={owner:"",number:0};return e.owner=t.owner??"",e.number=t.number??0,e}}},9873(t,e,i){"use strict";i.d(e,{A:()=>y});var s=i(40),r=i(9550),a=i(3283),n=i(274),o=i(1686),d=i(7925),c=i(5307);const h=(t,e)=>{if((0,r.A)((0,d.Kg)(t)||(0,o.Et)(t)||(0,o.sI)(t),`Validate: arg ${e.name} should be a felt typed as (String, Number or BigInt)`),(0,d.Kg)(t)&&!(0,o.qv)(t))return;const i=BigInt(t.toString(10));(0,r.A)(i>=0n&&i<=2n**252n-1n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 2^252-1]`)},l=(t,e)=>{let i;switch((0,o.Et)(t)&&(0,r.A)(t<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is to large to be typed as Number use (BigInt or String)"),(0,r.A)((0,d.Kg)(t)||(0,o.Et)(t)||(0,o.sI)(t)||"object"==typeof t&&"low"in t&&"high"in t||"object"==typeof t&&["limb0","limb1","limb2","limb3"].every(e=>e in t),`Validate: arg ${e.name} of cairo type ${e.type} should be type (String, Number or BigInt), but is ${typeof t} ${t}.`),e.type){case s.Fg.u256:i=new a.is(t).toBigInt();break;case s.Fg.u512:i=new n.Ns(t).toBigInt();break;default:i=(0,o.Dg)(t)}switch(e.type){case s.Fg.u8:(0,r.A)(i>=0n&&i<=255n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0 - 255]`);break;case s.Fg.u16:(0,r.A)(i>=0n&&i<=65535n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 65535]`);break;case s.Fg.u32:(0,r.A)(i>=0n&&i<=4294967295n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 4294967295]`);break;case s.Fg.u64:(0,r.A)(i>=0n&&i<=2n**64n-1n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 2^64-1]`);break;case s.Fg.u128:(0,r.A)(i>=0n&&i<=2n**128n-1n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 2^128-1]`);break;case s.Fg.u256:(0,r.A)(i>=0n&&i<=2n**256n-1n,`Validate: arg ${e.name} is ${e.type} 0 - 2^256-1`);break;case s.Fg.u512:(0,r.A)(n.Ns.is(i),`Validate: arg ${e.name} is ${e.type} 0 - 2^512-1`);break;case s.uS.ClassHash:case s.uS.ContractAddress:(0,r.A)(i>=0n&&i<=2n**252n-1n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 2^252-1]`);break;case s.uS.Secp256k1Point:(0,r.A)(i>=0n&&i<=2n**512n-1n,`Validate: arg ${e.name} must be ${e.type} : a 512 bits number.`)}},u=(t,e)=>{(0,r.A)((0,o.Lm)(t),`Validate: arg ${e.name} of cairo type ${e.type} should be type (Boolean)`)},p=(t,e,i)=>{if(e.type!==s.Fg.u256&&e.type!==s.Fg.u512){if("core::starknet::eth_address::EthAddress"===e.type){(0,r.A)("object"!=typeof t,`EthAddress type is waiting a BigNumberish. Got ${t}`);const i=BigInt(t.toString(10));return void(0,r.A)(i>=0n&&i<=2n**160n-1n,`Validate: arg ${e.name} cairo typed ${e.type} should be in range [0, 2^160-1]`)}(0,r.A)("object"==typeof t&&!Array.isArray(t),`Validate: arg ${e.name} is cairo type struct (${e.type}), and should be defined as js object (not array)`),i[e.type].members.forEach(({name:i})=>{(0,r.A)(Object.keys(t).includes(i),`Validate: arg ${e.name} should have a property ${i}`)})}else l(t,e)},f=(t,e)=>{(0,r.A)("object"==typeof t&&!Array.isArray(t),`Validate: arg ${e.name} is cairo type Enum (${e.type}), and should be defined as js object (not array)`);const i=Object.getOwnPropertyNames(Object.getPrototypeOf(t)),s=[...Object.getOwnPropertyNames(t),...i];if(!((0,c.e4)(e.type)&&s.includes("isSome")&&s.includes("isNone")||(0,c.u)(e.type)&&s.includes("isOk")&&s.includes("isErr")||s.includes("variant")&&s.includes("activeVariant")))throw new Error(`Validate Enum: argument ${e.name}, type ${e.type}, value received ${t}, is not an Enum.`)},m=(t,e)=>{(0,r.A)("object"==typeof t&&!Array.isArray(t),`Validate: arg ${e.name} should be a tuple (defined as object)`)},g=(t,e,i,s)=>{const a=(0,c.CS)(e.type);if(!(0,c.sB)(a)||!(0,d.IN)(t))switch((0,r.A)(Array.isArray(t),`Validate: arg ${e.name} should be an Array`),!0){case(0,c.sB)(a):t.forEach(t=>h(t,e));break;case(0,c.Zm)(a):t.forEach(t=>m(t,{name:e.name,type:a}));break;case(0,c.G$)(a):t.forEach(t=>g(t,{name:"",type:a},i,s));break;case(0,c.wJ)(a,i):t.forEach(t=>p(t,{name:e.name,type:a},i));break;case(0,c.iO)(a,s):t.forEach(t=>f(t,{name:e.name,type:a}));break;case(0,c.$H)(a)||(0,c.Gw)(a):t.forEach(t=>l(t,{name:"",type:a}));break;case(0,c.Fi)(a):t.forEach(t=>u(t,e));break;default:throw new Error(`Validate Unhandled: argument ${e.name}, type ${e.type}, value ${t}`)}};function y(t,e,i,s){t.inputs.reduce((t,a)=>{const n=e[t];switch(!0){case(0,c.ct)(a.name):return t;case(0,c.sB)(a.type):h(n,a);break;case(0,c.gr)(a.type):((t,e)=>{(0,r.A)((0,d.Kg)(t),`Validate: arg ${e.name} should be a string.`),(0,r.A)(t.length<32,`Validate: arg ${e.name} cairo typed ${e.type} should be a string of less than 32 characters.`)})(n,a);break;case(0,c.$H)(a.type)||(0,c.Gw)(a.type):l(n,a);break;case(0,c.Fi)(a.type):u(n,a);break;case(0,c.ak)(a.type):((t,e)=>{(0,r.A)((0,d.Kg)(t),`Validate: arg ${e.name} should be a string.`)})(n,a);break;case(0,c.G$)(a.type):g(n,a,i,s);break;case(0,c.wJ)(a.type,i):p(n,a,i);break;case(0,c.iO)(a.type,s):f(n,a);break;case(0,c.Zm)(a.type):m(n,a);break;default:throw new Error(`Validate Unhandled: argument ${a.name}, type ${a.type}, value ${n}`)}return t+1},0)}},9898(t,e,i){"use strict";i.d(e,{YS:()=>r,me:()=>a});class s{constructor(){this.i=0,this.j=0,this.S=[]}init(t){let e,i,s;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,s=this.S[e],this.S[e]=this.S[i],this.S[i]=s;this.i=0,this.j=0}next(){let t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}}function r(){return new s}let a=256},9946(t,e,i){"use strict";i.d(e,{A:()=>d});var s=i(8617),r=i(2079),a=i(5147),n=i(1579),o=i(4852);class d extends s.A{describe(){return this.deepExtend(super.describe(),{id:"htx",name:"HTX",countries:["CN"],rateLimit:100,userAgent:this.userAgents.chrome100,certified:!0,version:"v1",hostname:"api.huobi.pro",pro:!0,has:{CORS:void 0,spot:!0,margin:!0,swap:!0,future:!0,option:void 0,addMargin:void 0,borrowCrossMargin:!0,borrowIsolatedMargin:!0,cancelAllOrders:!0,cancelAllOrdersAfter:!0,cancelOrder:!0,cancelOrders:!0,closeAllPositions:!1,closePosition:!0,createDepositAddress:void 0,createMarketBuyOrderWithCost:!0,createMarketOrderWithCost:!1,createMarketSellOrderWithCost:!1,createOrder:!0,createOrders:!0,createReduceOnlyOrder:!1,createStopLimitOrder:!0,createStopLossOrder:!0,createStopMarketOrder:!0,createStopOrder:!0,createTakeProfitOrder:!0,createTrailingPercentOrder:!0,createTriggerOrder:!0,fetchAccounts:!0,fetchBalance:!0,fetchBidsAsks:void 0,fetchBorrowInterest:!0,fetchBorrowRateHistories:void 0,fetchBorrowRateHistory:void 0,fetchCanceledOrders:void 0,fetchClosedOrder:void 0,fetchClosedOrders:!0,fetchCrossBorrowRate:!1,fetchCrossBorrowRates:!1,fetchCurrencies:!0,fetchDeposit:void 0,fetchDepositAddress:!0,fetchDepositAddresses:void 0,fetchDepositAddressesByNetwork:!0,fetchDeposits:!0,fetchDepositWithdrawFee:"emulated",fetchDepositWithdrawFees:!0,fetchFundingHistory:!0,fetchFundingRate:!0,fetchFundingRateHistory:!0,fetchFundingRates:!0,fetchIndexOHLCV:!0,fetchIsolatedBorrowRate:!1,fetchIsolatedBorrowRates:!0,fetchL3OrderBook:void 0,fetchLastPrices:!0,fetchLedger:!0,fetchLedgerEntry:void 0,fetchLeverage:!1,fetchLeverageTiers:!0,fetchLiquidations:!0,fetchMarginAdjustmentHistory:!1,fetchMarketLeverageTiers:"emulated",fetchMarkets:!0,fetchMarkOHLCV:!0,fetchMyLiquidations:!1,fetchMyTrades:!0,fetchOHLCV:!0,fetchOpenInterest:!0,fetchOpenInterestHistory:!0,fetchOpenInterests:!0,fetchOpenOrder:void 0,fetchOpenOrders:!0,fetchOrder:!0,fetchOrderBook:!0,fetchOrderBooks:void 0,fetchOrders:!0,fetchOrderTrades:!0,fetchPosition:!0,fetchPositionHistory:"emulated",fetchPositions:!0,fetchPositionsHistory:!1,fetchPositionsRisk:!1,fetchPremiumIndexOHLCV:!0,fetchSettlementHistory:!0,fetchStatus:!0,fetchTicker:!0,fetchTickers:!0,fetchTime:!0,fetchTrades:!0,fetchTradingFee:!0,fetchTradingFees:!1,fetchTradingLimits:!0,fetchTransactionFee:void 0,fetchTransactionFees:void 0,fetchTransactions:void 0,fetchTransfers:void 0,fetchWithdrawAddresses:!0,fetchWithdrawal:void 0,fetchWithdrawals:!0,fetchWithdrawalWhitelist:void 0,reduceMargin:void 0,repayCrossMargin:!0,repayIsolatedMargin:!0,setLeverage:!0,setMarginMode:!1,setPositionMode:!0,signIn:void 0,transfer:!0,withdraw:!0},timeframes:{"1m":"1min","5m":"5min","15m":"15min","30m":"30min","1h":"60min","4h":"4hour","1d":"1day","1w":"1week","1M":"1mon","1y":"1year"},urls:{logo:"https://user-images.githubusercontent.com/1294454/76137448-22748a80-604e-11ea-8069-6e389271911d.jpg",hostnames:{contract:"api.hbdm.com",spot:"api.huobi.pro",status:{spot:"status.huobigroup.com",future:{inverse:"status-dm.huobigroup.com",linear:"status-linear-swap.huobigroup.com"},swap:{inverse:"status-swap.huobigroup.com",linear:"status-linear-swap.huobigroup.com"}}},api:{status:"https://{hostname}",contract:"https://{hostname}",spot:"https://{hostname}",public:"https://{hostname}",private:"https://{hostname}",v2Public:"https://{hostname}",v2Private:"https://{hostname}"},www:"https://www.huobi.com",referral:{url:"https://www.htx.com.vc/invite/en-us/1h?invite_code=6rmm2223",discount:.15},doc:["https://huobiapi.github.io/docs/spot/v1/en/","https://huobiapi.github.io/docs/dm/v1/en/","https://huobiapi.github.io/docs/coin_margined_swap/v1/en/","https://huobiapi.github.io/docs/usdt_swap/v1/en/","https://www.huobi.com/en-us/opend/newApiPages/"],fees:"https://www.huobi.com/about/fee/"},api:{v2Public:{get:{"reference/currencies":1,"market-status":1}},v2Private:{get:{"account/ledger":1,"account/withdraw/quota":1,"account/withdraw/address":1,"account/deposit/address":1,"account/repayment":5,"reference/transact-fee-rate":1,"account/asset-valuation":.2,"point/account":5,"sub-user/user-list":1,"sub-user/user-state":1,"sub-user/account-list":1,"sub-user/deposit-address":1,"sub-user/query-deposit":1,"user/api-key":1,"user/uid":1,"algo-orders/opening":1,"algo-orders/history":1,"algo-orders/specific":1,"c2c/offers":1,"c2c/offer":1,"c2c/transactions":1,"c2c/repayment":1,"c2c/account":1,"etp/reference":1,"etp/transactions":5,"etp/transaction":5,"etp/rebalance":1,"etp/limit":1},post:{"account/transfer":1,"account/repayment":5,"point/transfer":5,"sub-user/management":1,"sub-user/creation":1,"sub-user/tradable-market":1,"sub-user/transferability":1,"sub-user/api-key-generation":1,"sub-user/api-key-modification":1,"sub-user/api-key-deletion":1,"sub-user/deduct-mode":1,"algo-orders":1,"algo-orders/cancel-all-after":1,"algo-orders/cancellation":1,"c2c/offer":1,"c2c/cancellation":1,"c2c/cancel-all":1,"c2c/repayment":1,"c2c/transfer":1,"etp/creation":5,"etp/redemption":5,"etp/{transactId}/cancel":10,"etp/batch-cancel":50}},public:{get:{"common/symbols":1,"common/currencys":1,"common/timestamp":1,"common/exchange":1,"settings/currencys":1}},private:{get:{"account/accounts":.2,"account/accounts/{id}/balance":.2,"account/accounts/{sub-uid}":1,"account/history":4,"cross-margin/loan-info":1,"margin/loan-info":1,"fee/fee-rate/get":1,"order/openOrders":.4,"order/orders":.4,"order/orders/{id}":.4,"order/orders/{id}/matchresults":.4,"order/orders/getClientOrder":.4,"order/history":1,"order/matchresults":1,"query/deposit-withdraw":1,"margin/loan-orders":.2,"margin/accounts/balance":.2,"cross-margin/loan-orders":1,"cross-margin/accounts/balance":1,"points/actions":1,"points/orders":1,"subuser/aggregate-balance":10,"stable-coin/exchange_rate":1,"stable-coin/quote":1},post:{"account/transfer":1,"futures/transfer":1,"order/batch-orders":.4,"order/orders/place":.2,"order/orders/submitCancelClientOrder":.2,"order/orders/batchCancelOpenOrders":.4,"order/orders/{id}/submitcancel":.2,"order/orders/batchcancel":.4,"dw/withdraw/api/create":1,"dw/withdraw-virtual/{id}/cancel":1,"dw/transfer-in/margin":10,"dw/transfer-out/margin":10,"margin/orders":10,"margin/orders/{id}/repay":10,"cross-margin/transfer-in":1,"cross-margin/transfer-out":1,"cross-margin/orders":1,"cross-margin/orders/{id}/repay":1,"stable-coin/exchange":1,"subuser/transfer":10}},status:{public:{spot:{get:{"api/v2/summary.json":1}},future:{inverse:{get:{"api/v2/summary.json":1}},linear:{get:{"api/v2/summary.json":1}}},swap:{inverse:{get:{"api/v2/summary.json":1}},linear:{get:{"api/v2/summary.json":1}}}}},spot:{public:{get:{"v2/market-status":1,"v1/common/symbols":1,"v1/common/currencys":1,"v2/settings/common/currencies":1,"v2/reference/currencies":1,"v1/common/timestamp":1,"v1/common/exchange":1,"v1/settings/common/chains":1,"v1/settings/common/currencys":1,"v1/settings/common/symbols":1,"v2/settings/common/symbols":1,"v1/settings/common/market-symbols":1,"market/history/candles":1,"market/history/kline":1,"market/detail/merged":1,"market/tickers":1,"market/detail":1,"market/depth":1,"market/trade":1,"market/history/trade":1,"market/etp":1,"v2/etp/reference":1,"v2/etp/rebalance":1}},private:{get:{"v1/account/accounts":.2,"v1/account/accounts/{account-id}/balance":.2,"v2/account/valuation":1,"v2/account/asset-valuation":.2,"v1/account/history":4,"v2/account/ledger":1,"v2/point/account":5,"v2/account/deposit/address":1,"v2/account/withdraw/quota":1,"v2/account/withdraw/address":1,"v2/reference/currencies":1,"v1/query/deposit-withdraw":1,"v1/query/withdraw/client-order-id":1,"v2/user/api-key":1,"v2/user/uid":1,"v2/sub-user/user-list":1,"v2/sub-user/user-state":1,"v2/sub-user/account-list":1,"v2/sub-user/deposit-address":1,"v2/sub-user/query-deposit":1,"v1/subuser/aggregate-balance":10,"v1/account/accounts/{sub-uid}":1,"v1/order/openOrders":.4,"v1/order/orders/{order-id}":.4,"v1/order/orders/getClientOrder":.4,"v1/order/orders/{order-id}/matchresult":.4,"v1/order/orders/{order-id}/matchresults":.4,"v1/order/orders":.4,"v1/order/history":1,"v1/order/matchresults":1,"v2/reference/transact-fee-rate":1,"v2/algo-orders/opening":1,"v2/algo-orders/history":1,"v2/algo-orders/specific":1,"v1/margin/loan-info":1,"v1/margin/loan-orders":.2,"v1/margin/accounts/balance":.2,"v1/cross-margin/loan-info":1,"v1/cross-margin/loan-orders":1,"v1/cross-margin/accounts/balance":1,"v2/account/repayment":5,"v1/stable-coin/quote":1,"v1/stable_coin/exchange_rate":1,"v2/etp/transactions":5,"v2/etp/transaction":5,"v2/etp/limit":1},post:{"v1/account/transfer":1,"v1/futures/transfer":1,"v2/point/transfer":5,"v2/account/transfer":1,"v1/dw/withdraw/api/create":1,"v1/dw/withdraw-virtual/{withdraw-id}/cancel":1,"v2/sub-user/deduct-mode":1,"v2/sub-user/creation":1,"v2/sub-user/management":1,"v2/sub-user/tradable-market":1,"v2/sub-user/transferability":1,"v2/sub-user/api-key-generation":1,"v2/sub-user/api-key-modification":1,"v2/sub-user/api-key-deletion":1,"v1/subuser/transfer":10,"v1/trust/user/active/credit":10,"v1/order/orders/place":.2,"v1/order/batch-orders":.4,"v1/order/auto/place":.2,"v1/order/orders/{order-id}/submitcancel":.2,"v1/order/orders/submitCancelClientOrder":.2,"v1/order/orders/batchCancelOpenOrders":.4,"v1/order/orders/batchcancel":.4,"v2/algo-orders/cancel-all-after":1,"v2/algo-orders":1,"v2/algo-orders/cancellation":1,"v2/account/repayment":5,"v1/dw/transfer-in/margin":10,"v1/dw/transfer-out/margin":10,"v1/margin/orders":10,"v1/margin/orders/{order-id}/repay":10,"v1/cross-margin/transfer-in":1,"v1/cross-margin/transfer-out":1,"v1/cross-margin/orders":1,"v1/cross-margin/orders/{order-id}/repay":1,"v1/stable-coin/exchange":1,"v2/etp/creation":5,"v2/etp/redemption":5,"v2/etp/{transactId}/cancel":10,"v2/etp/batch-cancel":50}}},contract:{public:{get:{"api/v1/timestamp":1,"heartbeat/":1,"api/v1/contract_contract_info":1,"api/v1/contract_index":1,"api/v1/contract_query_elements":1,"api/v1/contract_price_limit":1,"api/v1/contract_open_interest":1,"api/v1/contract_delivery_price":1,"market/depth":1,"market/bbo":1,"market/history/kline":1,"index/market/history/mark_price_kline":1,"market/detail/merged":1,"market/detail/batch_merged":1,"v2/market/detail/batch_merged":1,"market/trade":1,"market/history/trade":1,"api/v1/contract_risk_info":1,"api/v1/contract_insurance_fund":1,"api/v1/contract_adjustfactor":1,"api/v1/contract_his_open_interest":1,"api/v1/contract_ladder_margin":1,"api/v1/contract_api_state":1,"api/v1/contract_elite_account_ratio":1,"api/v1/contract_elite_position_ratio":1,"api/v1/contract_liquidation_orders":1,"api/v1/contract_settlement_records":1,"index/market/history/index":1,"index/market/history/basis":1,"api/v1/contract_estimated_settlement_price":1,"api/v3/contract_liquidation_orders":1,"swap-api/v1/swap_contract_info":1,"swap-api/v1/swap_index":1,"swap-api/v1/swap_query_elements":1,"swap-api/v1/swap_price_limit":1,"swap-api/v1/swap_open_interest":1,"swap-ex/market/depth":1,"swap-ex/market/bbo":1,"swap-ex/market/history/kline":1,"index/market/history/swap_mark_price_kline":1,"swap-ex/market/detail/merged":1,"v2/swap-ex/market/detail/batch_merged":1,"index/market/history/swap_premium_index_kline":1,"swap-ex/market/detail/batch_merged":1,"swap-ex/market/trade":1,"swap-ex/market/history/trade":1,"swap-api/v1/swap_risk_info":1,"swap-api/v1/swap_insurance_fund":1,"swap-api/v1/swap_adjustfactor":1,"swap-api/v1/swap_his_open_interest":1,"swap-api/v1/swap_ladder_margin":1,"swap-api/v1/swap_api_state":1,"swap-api/v1/swap_elite_account_ratio":1,"swap-api/v1/swap_elite_position_ratio":1,"swap-api/v1/swap_estimated_settlement_price":1,"swap-api/v1/swap_liquidation_orders":1,"swap-api/v1/swap_settlement_records":1,"swap-api/v1/swap_funding_rate":1,"swap-api/v1/swap_batch_funding_rate":1,"swap-api/v1/swap_historical_funding_rate":1,"swap-api/v3/swap_liquidation_orders":1,"index/market/history/swap_estimated_rate_kline":1,"index/market/history/swap_basis":1,"linear-swap-api/v1/swap_contract_info":1,"linear-swap-api/v1/swap_index":1,"linear-swap-api/v1/swap_query_elements":1,"linear-swap-api/v1/swap_price_limit":1,"linear-swap-api/v1/swap_open_interest":1,"linear-swap-ex/market/depth":1,"linear-swap-ex/market/bbo":1,"linear-swap-ex/market/history/kline":1,"index/market/history/linear_swap_mark_price_kline":1,"linear-swap-ex/market/detail/merged":1,"linear-swap-ex/market/detail/batch_merged":1,"v2/linear-swap-ex/market/detail/batch_merged":1,"linear-swap-ex/market/trade":1,"linear-swap-ex/market/history/trade":1,"linear-swap-api/v1/swap_risk_info":1,"swap-api/v1/linear-swap-api/v1/swap_insurance_fund":1,"linear-swap-api/v1/swap_adjustfactor":1,"linear-swap-api/v1/swap_cross_adjustfactor":1,"linear-swap-api/v1/swap_his_open_interest":1,"linear-swap-api/v1/swap_ladder_margin":1,"linear-swap-api/v1/swap_cross_ladder_margin":1,"linear-swap-api/v1/swap_api_state":1,"linear-swap-api/v1/swap_cross_transfer_state":1,"linear-swap-api/v1/swap_cross_trade_state":1,"linear-swap-api/v1/swap_elite_account_ratio":1,"linear-swap-api/v1/swap_elite_position_ratio":1,"linear-swap-api/v1/swap_liquidation_orders":1,"linear-swap-api/v1/swap_settlement_records":1,"linear-swap-api/v1/swap_funding_rate":1,"linear-swap-api/v1/swap_batch_funding_rate":1,"linear-swap-api/v1/swap_historical_funding_rate":1,"linear-swap-api/v3/swap_liquidation_orders":1,"index/market/history/linear_swap_premium_index_kline":1,"index/market/history/linear_swap_estimated_rate_kline":1,"index/market/history/linear_swap_basis":1,"linear-swap-api/v1/swap_estimated_settlement_price":1}},private:{get:{"api/v1/contract_sub_auth_list":1,"api/v1/contract_api_trading_status":1,"swap-api/v1/swap_sub_auth_list":1,"swap-api/v1/swap_api_trading_status":1,"linear-swap-api/v1/swap_sub_auth_list":1,"linear-swap-api/v1/swap_api_trading_status":1,"linear-swap-api/v1/swap_cross_position_side":1,"linear-swap-api/v1/swap_position_side":1,"linear-swap-api/v3/unified_account_info":1,"linear-swap-api/v3/fix_position_margin_change_record":1,"linear-swap-api/v3/swap_unified_account_type":1,"linear-swap-api/v3/linear_swap_overview_account_info":1},post:{"api/v1/contract_balance_valuation":1,"api/v1/contract_account_info":1,"api/v1/contract_position_info":1,"api/v1/contract_sub_auth":1,"api/v1/contract_sub_account_list":1,"api/v1/contract_sub_account_info_list":1,"api/v1/contract_sub_account_info":1,"api/v1/contract_sub_position_info":1,"api/v1/contract_financial_record":1,"api/v1/contract_financial_record_exact":1,"api/v1/contract_user_settlement_records":1,"api/v1/contract_order_limit":1,"api/v1/contract_fee":1,"api/v1/contract_transfer_limit":1,"api/v1/contract_position_limit":1,"api/v1/contract_account_position_info":1,"api/v1/contract_master_sub_transfer":1,"api/v1/contract_master_sub_transfer_record":1,"api/v1/contract_available_level_rate":1,"api/v3/contract_financial_record":1,"api/v3/contract_financial_record_exact":1,"api/v1/contract-cancel-after":1,"api/v1/contract_order":1,"api/v1/contract_batchorder":1,"api/v1/contract_cancel":1,"api/v1/contract_cancelall":1,"api/v1/contract_switch_lever_rate":30,"api/v1/lightning_close_position":1,"api/v1/contract_order_info":1,"api/v1/contract_order_detail":1,"api/v1/contract_openorders":1,"api/v1/contract_hisorders":1,"api/v1/contract_hisorders_exact":1,"api/v1/contract_matchresults":1,"api/v1/contract_matchresults_exact":1,"api/v3/contract_hisorders":1,"api/v3/contract_hisorders_exact":1,"api/v3/contract_matchresults":1,"api/v3/contract_matchresults_exact":1,"api/v1/contract_trigger_order":1,"api/v1/contract_trigger_cancel":1,"api/v1/contract_trigger_cancelall":1,"api/v1/contract_trigger_openorders":1,"api/v1/contract_trigger_hisorders":1,"api/v1/contract_tpsl_order":1,"api/v1/contract_tpsl_cancel":1,"api/v1/contract_tpsl_cancelall":1,"api/v1/contract_tpsl_openorders":1,"api/v1/contract_tpsl_hisorders":1,"api/v1/contract_relation_tpsl_order":1,"api/v1/contract_track_order":1,"api/v1/contract_track_cancel":1,"api/v1/contract_track_cancelall":1,"api/v1/contract_track_openorders":1,"api/v1/contract_track_hisorders":1,"swap-api/v1/swap_balance_valuation":1,"swap-api/v1/swap_account_info":1,"swap-api/v1/swap_position_info":1,"swap-api/v1/swap_account_position_info":1,"swap-api/v1/swap_sub_auth":1,"swap-api/v1/swap_sub_account_list":1,"swap-api/v1/swap_sub_account_info_list":1,"swap-api/v1/swap_sub_account_info":1,"swap-api/v1/swap_sub_position_info":1,"swap-api/v1/swap_financial_record":1,"swap-api/v1/swap_financial_record_exact":1,"swap-api/v1/swap_user_settlement_records":1,"swap-api/v1/swap_available_level_rate":1,"swap-api/v1/swap_order_limit":1,"swap-api/v1/swap_fee":1,"swap-api/v1/swap_transfer_limit":1,"swap-api/v1/swap_position_limit":1,"swap-api/v1/swap_master_sub_transfer":1,"swap-api/v1/swap_master_sub_transfer_record":1,"swap-api/v3/swap_financial_record":1,"swap-api/v3/swap_financial_record_exact":1,"swap-api/v1/swap-cancel-after":1,"swap-api/v1/swap_order":1,"swap-api/v1/swap_batchorder":1,"swap-api/v1/swap_cancel":1,"swap-api/v1/swap_cancelall":1,"swap-api/v1/swap_lightning_close_position":1,"swap-api/v1/swap_switch_lever_rate":30,"swap-api/v1/swap_order_info":1,"swap-api/v1/swap_order_detail":1,"swap-api/v1/swap_openorders":1,"swap-api/v1/swap_hisorders":1,"swap-api/v1/swap_hisorders_exact":1,"swap-api/v1/swap_matchresults":1,"swap-api/v1/swap_matchresults_exact":1,"swap-api/v3/swap_matchresults":1,"swap-api/v3/swap_matchresults_exact":1,"swap-api/v3/swap_hisorders":1,"swap-api/v3/swap_hisorders_exact":1,"swap-api/v1/swap_trigger_order":1,"swap-api/v1/swap_trigger_cancel":1,"swap-api/v1/swap_trigger_cancelall":1,"swap-api/v1/swap_trigger_openorders":1,"swap-api/v1/swap_trigger_hisorders":1,"swap-api/v1/swap_tpsl_order":1,"swap-api/v1/swap_tpsl_cancel":1,"swap-api/v1/swap_tpsl_cancelall":1,"swap-api/v1/swap_tpsl_openorders":1,"swap-api/v1/swap_tpsl_hisorders":1,"swap-api/v1/swap_relation_tpsl_order":1,"swap-api/v1/swap_track_order":1,"swap-api/v1/swap_track_cancel":1,"swap-api/v1/swap_track_cancelall":1,"swap-api/v1/swap_track_openorders":1,"swap-api/v1/swap_track_hisorders":1,"linear-swap-api/v1/swap_lever_position_limit":1,"linear-swap-api/v1/swap_cross_lever_position_limit":1,"linear-swap-api/v1/swap_balance_valuation":1,"linear-swap-api/v1/swap_account_info":1,"linear-swap-api/v1/swap_cross_account_info":1,"linear-swap-api/v1/swap_position_info":1,"linear-swap-api/v1/swap_cross_position_info":1,"linear-swap-api/v1/swap_account_position_info":1,"linear-swap-api/v1/swap_cross_account_position_info":1,"linear-swap-api/v1/swap_sub_auth":1,"linear-swap-api/v1/swap_sub_account_list":1,"linear-swap-api/v1/swap_cross_sub_account_list":1,"linear-swap-api/v1/swap_sub_account_info_list":1,"linear-swap-api/v1/swap_cross_sub_account_info_list":1,"linear-swap-api/v1/swap_sub_account_info":1,"linear-swap-api/v1/swap_cross_sub_account_info":1,"linear-swap-api/v1/swap_sub_position_info":1,"linear-swap-api/v1/swap_cross_sub_position_info":1,"linear-swap-api/v1/swap_financial_record":1,"linear-swap-api/v1/swap_financial_record_exact":1,"linear-swap-api/v1/swap_user_settlement_records":1,"linear-swap-api/v1/swap_cross_user_settlement_records":1,"linear-swap-api/v1/swap_available_level_rate":1,"linear-swap-api/v1/swap_cross_available_level_rate":1,"linear-swap-api/v1/swap_order_limit":1,"linear-swap-api/v1/swap_fee":1,"linear-swap-api/v1/swap_transfer_limit":1,"linear-swap-api/v1/swap_cross_transfer_limit":1,"linear-swap-api/v1/swap_position_limit":1,"linear-swap-api/v1/swap_cross_position_limit":1,"linear-swap-api/v1/swap_master_sub_transfer":1,"linear-swap-api/v1/swap_master_sub_transfer_record":1,"linear-swap-api/v1/swap_transfer_inner":1,"linear-swap-api/v3/swap_financial_record":1,"linear-swap-api/v3/swap_financial_record_exact":1,"linear-swap-api/v1/swap_order":1,"linear-swap-api/v1/swap_cross_order":1,"linear-swap-api/v1/swap_batchorder":1,"linear-swap-api/v1/swap_cross_batchorder":1,"linear-swap-api/v1/swap_cancel":1,"linear-swap-api/v1/swap_cross_cancel":1,"linear-swap-api/v1/swap_cancelall":1,"linear-swap-api/v1/swap_cross_cancelall":1,"linear-swap-api/v1/swap_switch_lever_rate":30,"linear-swap-api/v1/swap_cross_switch_lever_rate":30,"linear-swap-api/v1/swap_lightning_close_position":1,"linear-swap-api/v1/swap_cross_lightning_close_position":1,"linear-swap-api/v1/swap_order_info":1,"linear-swap-api/v1/swap_cross_order_info":1,"linear-swap-api/v1/swap_order_detail":1,"linear-swap-api/v1/swap_cross_order_detail":1,"linear-swap-api/v1/swap_openorders":1,"linear-swap-api/v1/swap_cross_openorders":1,"linear-swap-api/v1/swap_hisorders":1,"linear-swap-api/v1/swap_cross_hisorders":1,"linear-swap-api/v1/swap_hisorders_exact":1,"linear-swap-api/v1/swap_cross_hisorders_exact":1,"linear-swap-api/v1/swap_matchresults":1,"linear-swap-api/v1/swap_cross_matchresults":1,"linear-swap-api/v1/swap_matchresults_exact":1,"linear-swap-api/v1/swap_cross_matchresults_exact":1,"linear-swap-api/v1/linear-cancel-after":1,"linear-swap-api/v1/swap_switch_position_mode":1,"linear-swap-api/v1/swap_cross_switch_position_mode":1,"linear-swap-api/v3/swap_matchresults":1,"linear-swap-api/v3/swap_cross_matchresults":1,"linear-swap-api/v3/swap_matchresults_exact":1,"linear-swap-api/v3/swap_cross_matchresults_exact":1,"linear-swap-api/v3/swap_hisorders":1,"linear-swap-api/v3/swap_cross_hisorders":1,"linear-swap-api/v3/swap_hisorders_exact":1,"linear-swap-api/v3/swap_cross_hisorders_exact":1,"linear-swap-api/v3/fix_position_margin_change":1,"linear-swap-api/v3/swap_switch_account_type":1,"linear-swap-api/v3/linear_swap_fee_switch":1,"linear-swap-api/v1/swap_trigger_order":1,"linear-swap-api/v1/swap_cross_trigger_order":1,"linear-swap-api/v1/swap_trigger_cancel":1,"linear-swap-api/v1/swap_cross_trigger_cancel":1,"linear-swap-api/v1/swap_trigger_cancelall":1,"linear-swap-api/v1/swap_cross_trigger_cancelall":1,"linear-swap-api/v1/swap_trigger_openorders":1,"linear-swap-api/v1/swap_cross_trigger_openorders":1,"linear-swap-api/v1/swap_trigger_hisorders":1,"linear-swap-api/v1/swap_cross_trigger_hisorders":1,"linear-swap-api/v1/swap_tpsl_order":1,"linear-swap-api/v1/swap_cross_tpsl_order":1,"linear-swap-api/v1/swap_tpsl_cancel":1,"linear-swap-api/v1/swap_cross_tpsl_cancel":1,"linear-swap-api/v1/swap_tpsl_cancelall":1,"linear-swap-api/v1/swap_cross_tpsl_cancelall":1,"linear-swap-api/v1/swap_tpsl_openorders":1,"linear-swap-api/v1/swap_cross_tpsl_openorders":1,"linear-swap-api/v1/swap_tpsl_hisorders":1,"linear-swap-api/v1/swap_cross_tpsl_hisorders":1,"linear-swap-api/v1/swap_relation_tpsl_order":1,"linear-swap-api/v1/swap_cross_relation_tpsl_order":1,"linear-swap-api/v1/swap_track_order":1,"linear-swap-api/v1/swap_cross_track_order":1,"linear-swap-api/v1/swap_track_cancel":1,"linear-swap-api/v1/swap_cross_track_cancel":1,"linear-swap-api/v1/swap_track_cancelall":1,"linear-swap-api/v1/swap_cross_track_cancelall":1,"linear-swap-api/v1/swap_track_openorders":1,"linear-swap-api/v1/swap_cross_track_openorders":1,"linear-swap-api/v1/swap_track_hisorders":1,"linear-swap-api/v1/swap_cross_track_hisorders":1}}}},fees:{trading:{feeSide:"get",tierBased:!1,percentage:!0,maker:this.parseNumber("0.002"),taker:this.parseNumber("0.002")}},exceptions:{broad:{"contract is restricted of closing positions on API.  Please contact customer service":r.OnMaintenance,maintain:r.OnMaintenance,"API key has no permission":r.PermissionDenied},exact:{403:r.AuthenticationError,1010:r.AccountNotEnabled,1003:r.AuthenticationError,1013:r.BadSymbol,1017:r.OrderNotFound,1034:r.InvalidOrder,1036:r.InvalidOrder,1039:r.InvalidOrder,1041:r.InvalidOrder,1047:r.InsufficientFunds,1048:r.InsufficientFunds,1061:r.OrderNotFound,1051:r.InvalidOrder,1066:r.BadSymbol,1067:r.InvalidOrder,1094:r.InvalidOrder,1220:r.AccountNotEnabled,1303:r.BadRequest,1461:r.InvalidOrder,4007:r.BadRequest,"bad-request":r.BadRequest,"validation-format-error":r.BadRequest,"validation-constraints-required":r.BadRequest,"base-date-limit-error":r.BadRequest,"api-not-support-temp-addr":r.PermissionDenied,timeout:r.RequestTimeout,"gateway-internal-error":r.ExchangeNotAvailable,"account-frozen-balance-insufficient-error":r.InsufficientFunds,"invalid-amount":r.InvalidOrder,"order-limitorder-amount-min-error":r.InvalidOrder,"order-limitorder-amount-max-error":r.InvalidOrder,"order-marketorder-amount-min-error":r.InvalidOrder,"order-limitorder-price-min-error":r.InvalidOrder,"order-limitorder-price-max-error":r.InvalidOrder,"order-limitorder-price-buy-min-error":r.InvalidOrder,"order-limitorder-price-buy-max-error":r.InvalidOrder,"order-limitorder-price-sell-min-error":r.InvalidOrder,"order-limitorder-price-sell-max-error":r.InvalidOrder,"order-stop-order-hit-trigger":r.InvalidOrder,"order-value-min-error":r.InvalidOrder,"order-invalid-price":r.InvalidOrder,"order-holding-limit-failed":r.InvalidOrder,"order-orderprice-precision-error":r.InvalidOrder,"order-etp-nav-price-max-error":r.InvalidOrder,"order-orderstate-error":r.OrderNotFound,"order-queryorder-invalid":r.OrderNotFound,"order-update-error":r.ExchangeNotAvailable,"api-signature-check-failed":r.AuthenticationError,"api-signature-not-valid":r.AuthenticationError,"base-record-invalid":r.OrderNotFound,"base-symbol-trade-disabled":r.BadSymbol,"base-symbol-error":r.BadSymbol,"system-maintenance":r.OnMaintenance,"base-request-exceed-frequency-limit":r.RateLimitExceeded,"rate-too-many-requests":r.RateLimitExceeded,"invalid symbol":r.BadSymbol,"symbol trade not open now":r.BadSymbol,"require-symbol":r.BadSymbol,"invalid-address":r.BadRequest,"base-currency-chain-error":r.BadRequest,"dw-insufficient-balance":r.InsufficientFunds,"base-withdraw-fee-error":r.BadRequest,"dw-withdraw-min-limit":r.BadRequest,"request limit":r.RateLimitExceeded}},precisionMode:n.kb,options:{include_OS_certificates:!1,fetchMarkets:{types:{spot:!0,linear:!0,inverse:!0}},timeDifference:0,adjustForTimeDifference:!1,fetchOHLCV:{useHistoricalEndpointForSpot:!0},withdraw:{includeFee:!1},defaultType:"spot",defaultSubType:"linear",defaultNetwork:"ERC20",defaultNetworks:{ETH:"ERC20",BTC:"BTC",USDT:"TRC20"},networks:{TRC20:"TRX",BTC:"BTC",ERC20:"ETH",SOL:"SOLANA",HRC20:"HECO",BEP20:"BSC",XMR:"XMR",LTC:"LTC",XRP:"XRP",XLM:"XLM",CRONOS:"CRO",CRO:"CRO",GLMR:"GLMR",POLYGON:"MATIC",MATIC:"MATIC",BTT:"BTT",CUBE:"CUBE",IOST:"IOST",NEO:"NEO",KLAY:"KLAY",EOS:"EOS",THETA:"THETA",NAS:"NAS",NULS:"NULS",QTUM:"QTUM",FTM:"FTM",CELO:"CELO",DOGE:"DOGE",DOGECHAIN:"DOGECHAIN",NEAR:"NEAR",STEP:"STEP",BITCI:"BITCI",CARDANO:"ADA",ADA:"ADA",ETC:"ETC",LUK:"LUK",MINEPLEX:"MINEPLEX",DASH:"DASH",ZEC:"ZEC",IOTA:"IOTA",NEON3:"NEON3",XEM:"XEM",HC:"HC",LSK:"LSK",DCR:"DCR",BTG:"BTG",STEEM:"STEEM",BTS:"BTS",ICX:"ICX",WAVES:"WAVES",CMT:"CMT",BTM:"BTM",VET:"VET",XZC:"XZC",ACT:"ACT",SMT:"SMT",BCD:"BCD",WAX:"WAX1",WICC:"WICC",ELF:"ELF",ZIL:"ZIL",ELA:"ELA",BCX:"BCX",SBTC:"SBTC",BIFI:"BIFI",CTXC:"CTXC",WAN:"WAN",POLYX:"POLYX",PAI:"PAI",WTC:"WTC",DGB:"DGB",XVG:"XVG",AAC:"AAC",AE:"AE",SEELE:"SEELE",BCV:"BCV",GRS:"GRS",ARDR:"ARDR",NANO:"NANO",ZEN:"ZEN",RBTC:"RBTC",BSV:"BSV",GAS:"GAS",XTZ:"XTZ",LAMB:"LAMB",CVNT1:"CVNT1",DOCK:"DOCK",SC:"SC",KMD:"KMD",ETN:"ETN",TOP:"TOP",IRIS:"IRIS",UGAS:"UGAS",TT:"TT",NEWTON:"NEWTON",VSYS:"VSYS",FSN:"FSN",BHD:"BHD",ONE:"ONE",EM:"EM",CKB:"CKB",EOSS:"EOSS",HIVE:"HIVE",RVN:"RVN",DOT:"DOT",KSM:"KSM",BAND:"BAND",OEP4:"OEP4",NBS:"NBS",FIS:"FIS",AR:"AR",HBAR:"HBAR",FIL:"FIL",MASS:"MASS",KAVA:"KAVA",XYM:"XYM",ENJ:"ENJ",CRUST:"CRUST",ICP:"ICP",CSPR:"CSPR",FLOW:"FLOW",IOTX:"IOTX",LAT:"LAT",APT:"APT",XCH:"XCH",MINA:"MINA",XEC:"ECASH",XPRT:"XPRT",CCA:"ACA",AOTI:"COTI",AKT:"AKT",ARS:"ARS",ASTR:"ASTR",AZERO:"AZERO",BLD:"BLD",BRISE:"BRISE",CORE:"CORE",DESO:"DESO",DFI:"DFI",EGLD:"EGLD",ERG:"ERG",ETHF:"ETHFAIR",ETHW:"ETHW",EVMOS:"EVMOS",FIO:"FIO",FLR:"FLR",FINSCHIA:"FINSCHIA",KMA:"KMA",KYVE:"KYVE",MEV:"MEV",MOVR:"MOVR",NODL:"NODL",OAS:"OAS",OSMO:"OSMO",PAYCOIN:"PAYCOIN",POKT:"POKT",PYG:"PYG",REI:"REI",SCRT:"SCRT",SDN:"SDN",SEI:"SEI",SGB:"SGB",SUI:"SUI",SXP:"SOLAR",SYS:"SYS",TENET:"TENET",TON:"TON",UNQ:"UNQ",UYU:"UYU",WEMIX:"WEMIX",XDC:"XDC",XPLA:"XPLA"},fetchOrdersByStatesMethod:"spot_private_get_v1_order_orders",createMarketBuyOrderRequiresPrice:!0,language:"en-US",broker:{id:"AA03022abc"},accountsByType:{spot:"pro",funding:"pro",future:"futures"},accountsById:{spot:"spot",margin:"margin",otc:"otc",point:"point","super-margin":"super-margin",investment:"investment",borrow:"borrow","grid-trading":"grid-trading","deposit-earning":"deposit-earning","otc-options":"otc-options"},typesByAccount:{pro:"spot",futures:"future"},spot:{stopOrderTypes:{"stop-limit":!0,"buy-stop-limit":!0,"sell-stop-limit":!0,"stop-limit-fok":!0,"buy-stop-limit-fok":!0,"sell-stop-limit-fok":!0},limitOrderTypes:{limit:!0,"buy-limit":!0,"sell-limit":!0,ioc:!0,"buy-ioc":!0,"sell-ioc":!0,"limit-maker":!0,"buy-limit-maker":!0,"sell-limit-maker":!0,"stop-limit":!0,"buy-stop-limit":!0,"sell-stop-limit":!0,"limit-fok":!0,"buy-limit-fok":!0,"sell-limit-fok":!0,"stop-limit-fok":!0,"buy-stop-limit-fok":!0,"sell-stop-limit-fok":!0}}},commonCurrencies:{NGL:"GFNGL",GET:"THEMIS",GTC:"GAMECOM",HIT:"HITCHAIN",PNT:"PENTA",SBTC:"SUPERBITCOIN",SOUL:"SOULSAVER",BIFI:"BITCOINFILE",FUD:"FTX Users Debt"},features:{spot:{sandbox:!0,createOrder:{marginMode:!0,triggerPrice:!0,triggerDirection:!0,triggerPriceType:void 0,stopLossPrice:!1,takeProfitPrice:!1,attachedStopLossTakeProfit:void 0,timeInForce:{IOC:!0,FOK:!0,PO:!0,GTD:!1},hedged:!1,trailing:!1,iceberg:!1,selfTradePrevention:!0,leverage:!0,marketBuyByCost:!0,marketBuyRequiresPrice:!0},createOrders:{max:10},fetchMyTrades:{marginMode:!1,limit:500,daysBack:120,untilDays:2,symbolRequired:!1},fetchOrder:{marginMode:!1,trigger:!1,trailing:!1,symbolRequired:!1},fetchOpenOrders:{marginMode:!1,trigger:!0,trailing:!1,limit:500,symbolRequired:!1},fetchOrders:{marginMode:!1,trigger:!0,trailing:!1,limit:500,untilDays:2,daysBack:180,symbolRequired:!1},fetchClosedOrders:{marginMode:!1,trigger:!0,trailing:!1,untilDays:2,limit:500,daysBack:180,daysBackCanceled:1/12,symbolRequired:!1},fetchOHLCV:{limit:1e3}},forDerivatives:{extends:"spot",createOrder:{stopLossPrice:!0,takeProfitPrice:!0,trailing:!0,hedged:!0},createOrders:{max:25},fetchOrder:{marginMode:!0},fetchOpenOrders:{marginMode:!0,trigger:!1,trailing:!1,limit:50},fetchOrders:{marginMode:!0,trigger:!1,trailing:!1,limit:50,daysBack:90},fetchClosedOrders:{marginMode:!0,trigger:!1,trailing:!1,untilDays:2,limit:50,daysBack:90,daysBackCanceled:1/12},fetchOHLCV:{limit:2e3}},swap:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}},future:{linear:{extends:"forDerivatives"},inverse:{extends:"forDerivatives"}}}})}async fetchStatus(t={}){let e;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchStatus",void 0,t);const i=this.handleOption("fetchStatus","enableForContracts",!1);let s,r,a,n;if("spot"!==e&&i){const i=this.safeString(t,"subType",this.options.defaultSubType);"swap"===e?"linear"===i?s=await this.statusPublicSwapLinearGetApiV2SummaryJson():"inverse"===i&&(s=await this.statusPublicSwapInverseGetApiV2SummaryJson()):"future"===e?"linear"===i?s=await this.statusPublicFutureLinearGetApiV2SummaryJson():"inverse"===i&&(s=await this.statusPublicFutureInverseGetApiV2SummaryJson()):"contract"===e&&(s=await this.contractPublicGetHeartbeat())}else"spot"===e&&(s=await this.statusPublicSpotGetApiV2SummaryJson());if("contract"===e){const t=this.safeString(s,"status");r=void 0===t?void 0:"ok"===t?"ok":"maintenance",a=this.safeString(s,"ts")}else{const t=this.safeValue(s,"status",{});r="none"===this.safeString(t,"indicator")?"ok":"maintenance";const e=this.safeValue(s,"page",{}),i=this.safeString(e,"updated_at");a=this.parse8601(i),n=this.safeString(e,"url")}return{status:r,updated:a,eta:void 0,url:n,info:s}}async fetchTime(t={}){const e=this.safeValue(this.options,"fetchTime",{}),i=this.safeString(this.options,"defaultType","spot");let s,r=this.safeString(e,"type",i);return r=this.safeString(t,"type",r),s="future"===r||"swap"===r?await this.contractPublicGetApiV1Timestamp(t):await this.spotPublicGetV1CommonTimestamp(t),this.safeInteger2(s,"data","ts")}parseTradingFee(t,e=void 0){const i=this.safeString(t,"symbol");return{info:t,symbol:this.safeSymbol(i,e),maker:this.safeNumber(t,"actualMakerRate"),taker:this.safeNumber(t,"actualTakerRate"),percentage:void 0,tierBased:void 0}}async fetchTradingFee(t,e={}){await this.loadMarkets();const i=this.market(t),s={symbols:i.id},r=await this.spotPrivateGetV2ReferenceTransactFeeRate(this.extend(s,e)),a=this.safeValue(r,"data",[]),n=this.safeValue(a,0,{});return this.parseTradingFee(n,i)}async fetchTradingLimits(t=void 0,e={}){await this.loadMarkets(),void 0===t&&(t=this.symbols);const i={};for(let s=0;s<t.length;s++){const r=t[s];i[r]=await this.fetchTradingLimitsById(this.marketId(r),e)}return i}async fetchTradingLimitsById(t,e={}){const i={symbol:t},s=await this.spotPublicGetV1CommonExchange(this.extend(i,e));return this.parseTradingLimits(this.safeValue(s,"data",{}))}parseTradingLimits(t,e=void 0,i={}){return{info:t,limits:{amount:{min:this.safeNumber(t,"limit-order-must-greater-than"),max:this.safeNumber(t,"limit-order-must-less-than")}}}}costToPrecision(t,e){return this.decimalToPrecision(e,n.R3,this.markets[t].precision.cost,this.precisionMode)}async fetchMarkets(t={}){let e;this.options.adjustForTimeDifference&&await this.loadTimeDifference(),[e,t]=this.handleOptionAndParams(t,"fetchMarkets","types",{});let i=[],s=[];const r=Object.keys(e);for(let i=0;i<r.length;i++){const a=r[i];this.safeBool(e,a)&&("spot"===a?s.push(this.fetchMarketsByTypeAndSubType("spot",void 0,t)):"linear"===a?s.push(this.fetchMarketsByTypeAndSubType(void 0,"linear",t)):"inverse"===a&&(s.push(this.fetchMarketsByTypeAndSubType("swap","inverse",t)),s.push(this.fetchMarketsByTypeAndSubType("future","inverse",t))))}s=await Promise.all(s);for(let t=0;t<s.length;t++)i=this.arrayConcat(i,s[t]);return i}async fetchMarketsByTypeAndSubType(t,e,i={}){const s={};let n;"spot"===t?n=await this.spotPublicGetV1CommonSymbols(this.extend(s,i)):"linear"===e?(s.business_type="all",n=await this.contractPublicGetLinearSwapApiV1SwapContractInfo(this.extend(s,i))):"inverse"===e&&("future"===t?n=await this.contractPublicGetApiV1ContractContractInfo(this.extend(s,i)):"swap"===t&&(n=await this.contractPublicGetSwapApiV1SwapContractInfo(this.extend(s,i))));const o=this.safeList(n,"data",[]);if(o.length<1)throw new r.OperationFailed(this.id+" fetchMarkets() returned an empty response: "+this.json(n));const d=[];for(let e=0;e<o.length;e++){const i=o[e];let s,r,n,c,h;const l="contract_code"in i,u=!l;let p,f,m=!1,g=!1;if(l){c=this.safeString(i,"contract_code"),h=c.toLowerCase();if(g=void 0!==this.safeString(i,"delivery_date"),m=!g,p=void 0!==this.safeString(i,"business_type"),f=!p,m){t="swap";const e=c.split("-");s=this.safeStringLower(i,"symbol"),r=this.safeStringLower(e,1),n=f?s:r}else if(g)if(t="future",s=this.safeStringLower(i,"symbol"),f)r="USD",n=s;else{const t=this.safeString(i,"pair").split("-");r=this.safeStringLower(t,1),n=r}}else t="spot",s=this.safeString(i,"base-currency"),r=this.safeString(i,"quote-currency"),c=s+r,h=c.toLowerCase();const y=this.safeCurrencyCode(s),v=this.safeCurrencyCode(r),b=this.safeCurrencyCode(n);let w,S=y+"/"+v;l&&(f?S+=":"+y:p&&(S+=":"+v),g&&(w=this.safeInteger(i,"delivery_time"),S+="-"+this.yymmdd(w)));const k=this.safeNumber(i,"contract_size");let O=this.safeNumber(i,"min-order-value");const T=this.safeNumber(i,"max-order-amt");let P,_,A,I,x,E,M=this.safeNumber(i,"min-order-amt");if(l&&(p?M=k:f&&(O=k)),u){P=this.parseNumber(this.parsePrecision(this.safeString(i,"price-precision"))),_=this.parseNumber(this.parsePrecision(this.safeString(i,"amount-precision"))),A=this.parseNumber(this.parsePrecision(this.safeString(i,"value-precision"))),I=this.parseNumber("0.002"),x=this.parseNumber("0.002");E="online"===this.safeString(i,"state")}else{P=this.safeNumber(i,"price_tick"),_=this.parseNumber("1"),I=this.parseNumber("0.0002"),x=this.parseNumber("0.0005");E=1===this.safeInteger(i,"contract_status")}const C=this.safeString(i,"leverage-ratio","1"),B=this.safeString(i,"super-margin-leverage-ratio","1"),N=a.Y.stringGt(C,"1")||a.Y.stringGt(B,"1");let R,L=this.safeString(i,"create_date");if(void 0!==L){const t=this.stringToCharsArray(L);L=t[0]+t[1]+t[2]+t[3]+"-"+t[4]+t[5]+"-"+t[6]+t[7]+" 00:00:00",R=this.parse8601(L)}d.push({id:c,lowercaseId:h,symbol:S,base:y,quote:v,settle:b,baseId:s,quoteId:r,settleId:n,type:t,spot:u,margin:u&&N,swap:m,future:g,option:!1,active:E,contract:l,linear:p,inverse:f,taker:x,maker:I,contractSize:k,expiry:w,expiryDatetime:this.iso8601(w),strike:void 0,optionType:void 0,precision:{amount:_,price:P,cost:A},limits:{leverage:{min:this.parseNumber("1"),max:this.parseNumber(C),superMax:this.parseNumber(B)},amount:{min:M,max:T},price:{min:void 0,max:void 0},cost:{min:O,max:void 0}},created:R,info:i})}return d}tryGetSymbolFromFutureMarkets(t){if(t in this.markets)return t;"futureMarketIdsForSymbols"in this.options||(this.options.futureMarketIdsForSymbols={});const e=this.safeDict(this.options,"futureMarketIdsForSymbols",{});if(t in e)return e[t];const i=this.filterBy(this.markets,"future",!0),s={this_week:"CW",next_week:"NW",quarter:"CQ",next_quarter:"NQ"};for(let e=0;e<i.length;e++){const r=i[e],a=this.safeValue(r,"info",{}),n=s[this.safeString(a,"contract_type")];if((r.linear?r.base+"-"+r.quote+"-"+n:r.base+"_"+n)===t){const e=r.symbol;return this.options.futureMarketIdsForSymbols[t]=e,e}}return this.options.futureMarketIdsForSymbols[t]=t,t}parseTicker(t,e=void 0){const i=this.safeString2(t,"symbol","contract_code");let s=this.safeSymbol(i,e);s=this.tryGetSymbolFromFutureMarkets(s);const r=this.safeInteger2(t,"ts","quoteTime");let a,n,o,d;"bid"in t&&(void 0!==t.bid&&Array.isArray(t.bid)?(a=this.safeString(t.bid,0),n=this.safeString(t.bid,1)):(a=this.safeString(t,"bid"),n=this.safeString(t,"bidSize"))),"ask"in t&&(void 0!==t.ask&&Array.isArray(t.ask)?(o=this.safeString(t.ask,0),d=this.safeString(t.ask,1)):(o=this.safeString(t,"ask"),d=this.safeString(t,"askSize")));const c=this.safeString(t,"open"),h=this.safeString(t,"close"),l=this.safeString(t,"amount"),u=this.safeString(t,"vol");return this.safeTicker({symbol:s,timestamp:r,datetime:this.iso8601(r),high:this.safeString(t,"high"),low:this.safeString(t,"low"),bid:a,bidVolume:n,ask:o,askVolume:d,vwap:void 0,open:c,close:h,last:h,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:l,quoteVolume:u,info:t},e)}async fetchTicker(t,e={}){await this.loadMarkets();const i=this.market(t),s={};let r;i.linear?(s.contract_code=i.id,r=await this.contractPublicGetLinearSwapExMarketDetailMerged(this.extend(s,e))):i.inverse?i.future?(s.symbol=i.id,r=await this.contractPublicGetMarketDetailMerged(this.extend(s,e))):i.swap&&(s.contract_code=i.id,r=await this.contractPublicGetSwapExMarketDetailMerged(this.extend(s,e))):(s.symbol=i.id,r=await this.spotPublicGetMarketDetailMerged(this.extend(s,e)));const a=this.safeValue(r,"tick",{}),n=this.parseTicker(a,i),o=this.safeInteger(r,"ts");return n.timestamp=o,n.datetime=this.iso8601(o),n}async fetchTickers(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.safeString(t,0);let s;void 0!==i&&(s=this.market(i));const a="subType"in e||"business_type"in e;let n,o;[n,e]=this.handleMarketTypeAndParams("fetchTickers",s,e),[o,e]=this.handleSubTypeAndParams("fetchTickers",s,e);const d={},c="future"===n,h="swap"===n,l="inverse"===o;let u;if(!("spot"===n)||a)if("linear"===o)d.business_type=c?"futures":h?"swap":"all",u=await this.contractPublicGetLinearSwapExMarketDetailBatchMerged(this.extend(d,e));else{if(!l)throw new r.NotSupported(this.id+' fetchTickers() you have to set params["subType"] to either "linear" or "inverse" for contracts');if(c)u=await this.contractPublicGetMarketDetailBatchMerged(this.extend(d,e));else{if(!h)throw new r.NotSupported(this.id+' fetchTickers() you have to set params["type"] to either "swap" or "future" for inverse contracts');u=await this.contractPublicGetSwapExMarketDetailBatchMerged(this.extend(d,e))}}else u=await this.spotPublicGetMarketTickers(this.extend(d,e));const p=this.safeList2(u,"data","ticks",[]),f=this.parseTickers(p,t,e);return this.filterByArrayTickers(f,"symbol",t)}async fetchLastPrices(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.getMarketFromSymbols(t);let s,a,n;if([a,e]=this.handleSubTypeAndParams("fetchLastPrices",i,e),[s,e]=this.handleMarketTypeAndParams("fetchLastPrices",i,e),"swap"!==s&&"future"!==s||"linear"!==a)if("swap"===s&&"inverse"===a)n=await this.contractPublicGetSwapExMarketTrade(e);else{if("future"!==s||"inverse"!==a)throw new r.NotSupported(this.id+" fetchLastPrices() does not support "+s+" markets yet");n=await this.contractPublicGetMarketTrade(e)}else n=await this.contractPublicGetLinearSwapExMarketTrade(e);const o=this.safeValue(n,"tick",{}),d=this.safeList(o,"data",[]);return this.parseLastPrices(d,t)}parseLastPrice(t,e=void 0){const i=this.safeString2(t,"symbol","contract_code");e=this.safeMarket(i,e);const s=this.safeNumber(t,"price"),r=this.safeString(t,"direction");return{symbol:e.symbol,timestamp:void 0,datetime:void 0,price:s,side:r,info:t}}async fetchOrderBook(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),a={type:"step0"};let n;if(s.linear)a.contract_code=s.id,n=await this.contractPublicGetLinearSwapExMarketDepth(this.extend(a,i));else if(s.inverse)s.future?(a.symbol=s.id,n=await this.contractPublicGetMarketDepth(this.extend(a,i))):s.swap&&(a.contract_code=s.id,n=await this.contractPublicGetSwapExMarketDepth(this.extend(a,i)));else{if(void 0!==e){if(5!==e&&10!==e&&20!==e&&150!==e)throw new r.BadRequest(this.id+" fetchOrderBook() limit argument must be undefined, 5, 10, 20, or 150, default is 150");150!==e&&(a.depth=e)}a.symbol=s.id,n=await this.spotPublicGetMarketDepth(this.extend(a,i))}if("tick"in n){if(!n.tick)throw new r.BadSymbol(this.id+" fetchOrderBook() returned empty response: "+this.json(n));const e=this.safeValue(n,"tick"),i=this.safeInteger(e,"ts",this.safeInteger(n,"ts")),s=this.parseOrderBook(e,t,i);return s.nonce=this.safeInteger(e,"version"),s}throw new r.ExchangeError(this.id+" fetchOrderBook() returned unrecognized response: "+this.json(n))}parseTrade(t,e=void 0){const i=this.safeString2(t,"contract_code","symbol"),s=(e=this.safeMarket(i,e)).symbol;let r=this.safeInteger2(t,"ts","created-at");r=this.safeInteger2(t,"created_at","create_date",r);const n=this.safeString2(t,"order-id","order_id");let o=this.safeString(t,"direction"),d=this.safeString(t,"type");if(void 0!==d){const t=d.split("-");o=t[0],d=t[1]}const c=this.safeStringLower(t,"role"),h=this.safeString2(t,"price","trade_price");let l=this.safeString2(t,"filled-amount","amount");l=this.safeString(t,"trade_volume",l);const u=this.safeString(t,"trade_turnover");let p,f=this.safeString(t,"filled-fees");void 0===f&&(f=a.Y.stringNeg(this.safeString(t,"trade_fee")));const m=this.safeString2(t,"fee-currency","fee_asset");let g=this.safeCurrencyCode(m);const y=this.safeString(t,"filled-points");if(void 0!==y&&(void 0===f||a.Y.stringEquals(f,"0"))){const e=this.safeString(t,"fee-deduct-currency");void 0!==e&&(f=y,g=this.safeCurrencyCode(e))}let v;void 0!==f&&(p={cost:f,currency:g});const b=this.safeString(t,"id");return v=void 0!==b&&b.indexOf("-")>=0?b:this.safeStringN(t,["trade_id","trade-id","id"]),this.safeTrade({id:v,info:t,order:n,timestamp:r,datetime:this.iso8601(r),symbol:s,type:d,side:o,takerOrMaker:c,price:h,amount:l,cost:u,fee:p},e)}async fetchOrderTrades(t,e=void 0,i=void 0,s=void 0,a={}){let n,o;if(void 0!==e&&(n=this.market(e)),[o,a]=this.handleMarketTypeAndParams("fetchOrderTrades",n,a),"spot"!==o)throw new r.NotSupported(this.id+" fetchOrderTrades() is only supported for spot markets");return await this.fetchSpotOrderTrades(t,e,i,s,a)}async fetchSpotOrderTrades(t,e=void 0,i=void 0,s=void 0,r={}){await this.loadMarkets();const a={"order-id":t},n=await this.spotPrivateGetV1OrderOrdersOrderIdMatchresults(this.extend(a,r));return this.parseTrades(n.data,void 0,i,s)}async fetchMyTrades(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let a,n,o=!1;if([o,s]=this.handleOptionAndParams(s,"fetchMyTrades","paginate"),o)return await this.fetchPaginatedCallDynamic("fetchMyTrades",t,e,i,s);void 0!==t&&(a=this.market(t)),[n,s]=this.handleMarketTypeAndParams("fetchMyTrades",a,s);let d,c={};if("spot"===n)void 0!==t&&(a=this.market(t),c.symbol=a.id),void 0!==i&&(c.size=i),void 0!==e&&(c["start-time"]=e),[c,s]=this.handleUntilOption("end-time",c,s),d=await this.spotPrivateGetV1OrderMatchresults(this.extend(c,s));else{if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchMyTrades() requires a symbol argument");if(c.contract=a.id,c.trade_type=0,void 0!==e&&(c.start_time=e),[c,s]=this.handleUntilOption("end_time",c,s),void 0!==i&&(c.page_size=i),a.linear){let t;[t,s]=this.handleMarginModeAndParams("fetchMyTrades",s),t=void 0===t?"cross":t,"isolated"===t?d=await this.contractPrivatePostLinearSwapApiV3SwapMatchresultsExact(this.extend(c,s)):"cross"===t&&(d=await this.contractPrivatePostLinearSwapApiV3SwapCrossMatchresultsExact(this.extend(c,s)))}else if(a.inverse)if("future"===n)c.symbol=a.settleId,d=await this.contractPrivatePostApiV3ContractMatchresultsExact(this.extend(c,s));else{if("swap"!==n)throw new r.NotSupported(this.id+" fetchMyTrades() does not support "+n+" markets");d=await this.contractPrivatePostSwapApiV3SwapMatchresultsExact(this.extend(c,s))}}let h=this.safeValue(d,"data");return Array.isArray(h)||(h=this.safeValue(h,"trades")),this.parseTrades(h,a,e,i)}async fetchTrades(t,e=void 0,i=1e3,s={}){await this.loadMarkets();const r=this.market(t),a={};let n;void 0!==i&&(a.size=Math.min(i,2e3)),r.future?r.inverse?(a.symbol=r.id,n=await this.contractPublicGetMarketHistoryTrade(this.extend(a,s))):r.linear&&(a.contract_code=r.id,n=await this.contractPublicGetLinearSwapExMarketHistoryTrade(this.extend(a,s))):r.swap?(a.contract_code=r.id,r.inverse?n=await this.contractPublicGetSwapExMarketHistoryTrade(this.extend(a,s)):r.linear&&(n=await this.contractPublicGetLinearSwapExMarketHistoryTrade(this.extend(a,s)))):(a.symbol=r.id,n=await this.spotPublicGetMarketHistoryTrade(this.extend(a,s)));const o=this.safeValue(n,"data",[]);let d=[];for(let t=0;t<o.length;t++){const e=this.safeValue(o[t],"data",[]);for(let t=0;t<e.length;t++){const i=this.parseTrade(e[t],r);d.push(i)}}return d=this.sortBy(d,"timestamp"),this.filterBySymbolSinceLimit(d,r.symbol,e,i)}parseOHLCV(t,e=void 0){return[this.safeTimestamp(t,"id"),this.safeNumber(t,"open"),this.safeNumber(t,"high"),this.safeNumber(t,"low"),this.safeNumber(t,"close"),this.safeNumber(t,"amount")]}async fetchOHLCV(t,e="1m",i=void 0,s=void 0,a={}){await this.loadMarkets();let n=!1;if([n,a]=this.handleOptionAndParams(a,"fetchOHLCV","paginate"),n)return await this.fetchPaginatedCallDeterministic("fetchOHLCV",t,i,s,e,a,1e3);const o=this.market(t),d={period:this.safeString(this.timeframes,e,e)},c=this.safeStringN(a,["priceType","price"]);let h;a=this.omit(a,["priceType","price"]),[h,a]=this.handleParamInteger(a,"until");const l=void 0!==h?this.parseToInt(h/1e3):void 0;if(o.contract&&(void 0!==s?d.size=Math.min(s,2e3):s=2e3,void 0===c)){const t=this.parseTimeframe(e);let r;if(void 0===i){const e=this.seconds();d.from=e-t*(s-1),r=e}else{const e=this.parseToInt(i/1e3);d.from=e,r=this.sum(e,t*(s-1))}d.to=void 0!==l?l:r}let u;if(o.future){if(o.inverse)if(d.symbol=o.id,"mark"===c)u=await this.contractPublicGetIndexMarketHistoryMarkPriceKline(this.extend(d,a));else if("index"===c)u=await this.contractPublicGetIndexMarketHistoryIndex(this.extend(d,a));else{if("premiumIndex"===c)throw new r.BadRequest(this.id+" "+o.type+" has no api endpoint for "+c+" kline data");u=await this.contractPublicGetMarketHistoryKline(this.extend(d,a))}else if(o.linear)if(d.contract_code=o.id,"mark"===c)u=await this.contractPublicGetIndexMarketHistoryLinearSwapMarkPriceKline(this.extend(d,a));else{if("index"===c)throw new r.BadRequest(this.id+" "+o.type+" has no api endpoint for "+c+" kline data");u="premiumIndex"===c?await this.contractPublicGetIndexMarketHistoryLinearSwapPremiumIndexKline(this.extend(d,a)):await this.contractPublicGetLinearSwapExMarketHistoryKline(this.extend(d,a))}}else if(o.swap){if(d.contract_code=o.id,o.inverse)if("mark"===c)u=await this.contractPublicGetIndexMarketHistorySwapMarkPriceKline(this.extend(d,a));else{if("index"===c)throw new r.BadRequest(this.id+" "+o.type+" has no api endpoint for "+c+" kline data");u="premiumIndex"===c?await this.contractPublicGetIndexMarketHistorySwapPremiumIndexKline(this.extend(d,a)):await this.contractPublicGetSwapExMarketHistoryKline(this.extend(d,a))}else if(o.linear)if("mark"===c)u=await this.contractPublicGetIndexMarketHistoryLinearSwapMarkPriceKline(this.extend(d,a));else{if("index"===c)throw new r.BadRequest(this.id+" "+o.type+" has no api endpoint for "+c+" kline data");u="premiumIndex"===c?await this.contractPublicGetIndexMarketHistoryLinearSwapPremiumIndexKline(this.extend(d,a)):await this.contractPublicGetLinearSwapExMarketHistoryKline(this.extend(d,a))}}else{let t;d.symbol=o.id,[t,a]=this.handleOptionAndParams(a,"fetchOHLCV","useHistoricalEndpointForSpot",!0),t?(void 0!==i&&(d.from=this.parseToInt(i/1e3)),void 0!==l&&(d.to=l),void 0!==s&&(d.size=Math.min(1e3,s)),u=await this.spotPublicGetMarketHistoryCandles(this.extend(d,a))):(void 0!==s&&(d.size=Math.min(s,2e3)),u=await this.spotPublicGetMarketHistoryKline(this.extend(d,a)))}const p=this.safeList(u,"data",[]);return this.parseOHLCVs(p,o,e,i,s)}async fetchAccounts(t={}){await this.loadMarkets();const e=await this.spotPrivateGetV1AccountAccounts(t),i=this.safeValue(e,"data");return this.parseAccounts(i)}parseAccount(t){const e=this.safeString(t,"type"),i=this.safeValue(this.options,"accountsById",{}),s=this.safeValue(i,e,e);return{info:t,id:this.safeString(t,"id"),type:s,code:void 0}}async fetchAccountIdByType(t,e=void 0,i=void 0,s={}){const r=await this.loadAccounts(),a=this.safeValue2(s,"accountId","account-id");if(void 0!==a)return a;let n;"spot"===t&&("cross"===e?t="super-margin":"isolated"===e&&(t="margin")),void 0!==i&&(n=this.marketId(i));for(let e=0;e<r.length;e++){const i=r[e],s=this.safeValue(i,"info"),a=this.safeString(s,"subtype",void 0),o=this.safeString(i,"type");if("margin"===t){if(a===n)return this.safeString(i,"id")}else if(t===o)return this.safeString(i,"id")}const o=this.safeValue(r,0,{});return this.safeString(o,"id")}async fetchCurrencies(t={}){const e=await this.spotPublicGetV2ReferenceCurrencies(t),i=this.safeList(e,"data",[]),s={};this.options.networkChainIdsByNames={},this.options.networkNamesByChainIds={};for(let t=0;t<i.length;t++){const e=i[t],r=this.safeString(e,"currency"),a=this.safeCurrencyCode(r),n="1"===this.safeString(e,"assetType")?"crypto":"fiat";this.options.networkChainIdsByNames[a]={};const o=this.safeList(e,"chains",[]),d={};for(let t=0;t<o.length;t++){const e=o[t],i=this.safeString(e,"chain"),s=this.safeString2(e,"baseChain","displayName");this.options.networkChainIdsByNames[a][s]=i,this.options.networkNamesByChainIds[i]=s;const r=this.networkIdToCode(i);d[r]={info:e,id:i,network:r,limits:{deposit:{min:this.safeNumber(e,"minDepositAmt"),max:void 0},withdraw:{min:this.safeNumber(e,"minWithdrawAmt"),max:this.safeNumber(e,"maxWithdrawAmt")}},active:void 0,deposit:"allowed"===this.safeString(e,"depositStatus"),withdraw:"allowed"===this.safeString(e,"withdrawStatus"),fee:this.safeNumber(e,"transactFeeWithdraw"),precision:this.parseNumber(this.parsePrecision(this.safeString(e,"withdrawPrecision")))}}s[a]=this.safeCurrencyStructure({info:e,code:a,id:r,active:"normal"===this.safeString(e,"instStatus"),deposit:void 0,withdraw:void 0,fee:void 0,name:void 0,type:n,limits:{amount:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0},deposit:{min:void 0,max:void 0}},precision:void 0,networks:d})}return s}networkIdToCode(t=void 0,e=void 0){if(0===Object.keys(this.options.networkNamesByChainIds).length)throw new r.ExchangeError(this.id+" networkIdToCode() - markets need to be loaded at first");const i=this.safeValue(this.options.networkNamesByChainIds,t,t);return super.networkIdToCode(i)}networkCodeToId(t,e=void 0){if(void 0===e)throw new r.ArgumentsRequired(this.id+" networkCodeToId() requires a currencyCode argument");if(0===Object.keys(this.options.networkChainIdsByNames).length)throw new r.ExchangeError(this.id+" networkCodeToId() - markets need to be loaded at first");const i=this.safeValue(this.options.networkChainIdsByNames,e,{});if(t in i)return i[t];{const e=super.networkCodeToId(t);return this.safeValue(i,e,e)}}async fetchBalance(t={}){let e;await this.loadMarkets(),[e,t]=this.handleMarketTypeAndParams("fetchBalance",void 0,t);const i=this.safeValue(this.options,"fetchBalance",{}),s=this.safeValue2(t,"isUnifiedAccount","unified",!1);t=this.omit(t,["isUnifiedAccount","unified"]);const r={},a="spot"===e,n="future"===e,o=this.safeString2(this.options,"defaultSubType","subType","linear");let d=this.safeString2(i,"defaultSubType","subType",o);d=this.safeString2(t,"defaultSubType","subType",d);const c="inverse"===d,h="linear"===d;let l;[l,t]=this.handleMarginModeAndParams("fetchBalance",t),t=this.omit(t,["defaultSubType","subType"]);const u="isolated"===l,p="margin"===e||a&&("cross"===l||u);let f;if(a||p)if(p)f=u?await this.spotPrivateGetV1MarginAccountsBalance(this.extend(r,t)):await this.spotPrivateGetV1CrossMarginAccountsBalance(this.extend(r,t));else{await this.loadAccounts();const i=await this.fetchAccountIdByType(e,void 0,void 0,t);r["account-id"]=i,f=await this.spotPrivateGetV1AccountAccountsAccountIdBalance(this.extend(r,t))}else s?f=await this.contractPrivateGetLinearSwapApiV3UnifiedAccountInfo(this.extend(r,t)):h?f=u?await this.contractPrivatePostLinearSwapApiV1SwapAccountInfo(this.extend(r,t)):await this.contractPrivatePostLinearSwapApiV1SwapCrossAccountInfo(this.extend(r,t)):c&&(f=n?await this.contractPrivatePostApiV1ContractAccountInfo(this.extend(r,t)):await this.contractPrivatePostSwapApiV1SwapAccountInfo(this.extend(r,t)));let m={info:f};const g=this.safeValue(f,"data");if(a||p)if(u)for(let t=0;t<g.length;t++){const e=g[t],i=this.safeSymbol(this.safeString(e,"symbol")),s=this.safeValue(e,"list"),r={};for(let t=0;t<s.length;t++){const e=s[t],i=this.safeString(e,"currency"),a=this.safeCurrencyCode(i);r[a]=this.parseMarginBalanceHelper(e,a,r)}m[i]=this.safeBalance(r)}else{const t=this.safeValue(g,"list",[]);for(let e=0;e<t.length;e++){const i=t[e],s=this.safeString(i,"currency"),r=this.safeCurrencyCode(s);m[r]=this.parseMarginBalanceHelper(i,r,m)}m=this.safeBalance(m)}else if(s)for(let t=0;t<g.length;t++){const e=g[t],i=this.safeString(e,"margin_asset"),s=this.safeCurrencyCode(i);if(u){const t=this.safeValue(e,"isolated_swap",{});for(let e=0;e<t.length;e++){const i=t[e],r=this.safeString(i,"contract_code"),a={code:s,free:this.safeNumber(i,"margin_available")};m[this.safeSymbol(r)]=a,m=this.safeBalance(m)}}else{const t=this.account();t.free=this.safeString(e,"margin_static"),t.used=this.safeString(e,"margin_frozen"),m[s]=t,m=this.safeBalance(m)}}else if(h){const t=this.safeValue(g,0,{});if(u)for(let t=0;t<g.length;t++){const e=g[t],i=this.safeString2(e,"contract_code","margin_account"),s=this.safeMarket(i),r=this.safeString(e,"margin_asset"),a=this.safeCurrency(r),n=this.safeString(s,"settle",a.code);if(void 0!==n){const t=this.account();t.free=this.safeString(e,"margin_balance"),t.used=this.safeString(e,"margin_frozen");const i={};i[n]=t;m[s.symbol]=this.safeBalance(i)}}else{const e=this.account();e.free=this.safeString(t,"withdraw_available"),e.total=this.safeString(t,"margin_balance");const i=this.safeString2(t,"margin_asset","symbol");m[this.safeCurrencyCode(i)]=e,m=this.safeBalance(m)}}else if(c){for(let t=0;t<g.length;t++){const e=g[t],i=this.safeString(e,"symbol"),s=this.safeCurrencyCode(i),r=this.account();r.free=this.safeString(e,"margin_available"),r.used=this.safeString(e,"margin_frozen"),m[s]=r}m=this.safeBalance(m)}return m}async fetchOrder(t,e=void 0,i={}){let s,a;await this.loadMarkets(),void 0!==e&&(s=this.market(e)),[a,i]=this.handleMarketTypeAndParams("fetchOrder",s,i);const n={};let o;if("spot"===a){void 0!==this.safeString(i,"clientOrderId")?o=await this.spotPrivateGetV1OrderOrdersGetClientOrder(this.extend(n,i)):(n["order-id"]=t,o=await this.spotPrivateGetV1OrderOrdersOrderId(this.extend(n,i)))}else{if(void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrder() requires a symbol argument");const d=this.safeString2(i,"client_order_id","clientOrderId");if(void 0===d?n.order_id=t:(n.client_order_id=d,i=this.omit(i,["client_order_id","clientOrderId"])),n.contract_code=s.id,s.linear){let t;[t,i]=this.handleMarginModeAndParams("fetchOrder",i),t=void 0===t?"cross":t,"isolated"===t?o=await this.contractPrivatePostLinearSwapApiV1SwapOrderInfo(this.extend(n,i)):"cross"===t&&(o=await this.contractPrivatePostLinearSwapApiV1SwapCrossOrderInfo(this.extend(n,i)))}else if(s.inverse)if("future"===a)n.symbol=s.settleId,o=await this.contractPrivatePostApiV1ContractOrderInfo(this.extend(n,i));else{if("swap"!==a)throw new r.NotSupported(this.id+" fetchOrder() does not support "+a+" markets");o=await this.contractPrivatePostSwapApiV1SwapOrderInfo(this.extend(n,i))}}let d=this.safeValue(o,"data");return Array.isArray(d)&&(d=this.safeValue(d,0)),this.parseOrder(d)}parseMarginBalanceHelper(t,e,i){let s;return s=e in i?i[e]:this.account(),"trade"===t.type&&(s.free=this.safeString(t,"balance")),"frozen"===t.type&&(s.used=this.safeString(t,"balance")),s}async fetchSpotOrdersByStates(t,e=void 0,i=void 0,s=void 0,a={}){const n=this.safeString(this.options,"fetchOrdersByStatesMethod","spot_private_get_v1_order_orders");if("spot_private_get_v1_order_orders"===n&&void 0===e)throw new r.ArgumentsRequired(this.id+" fetchOrders() requires a symbol argument");let o;await this.loadMarkets();let d,c={states:t};void 0!==e&&(o=this.market(e),c.symbol=o.id),void 0!==i&&(c["start-time"]=i,c["end-time"]=this.sum(i,1728e5)),[c,a]=this.handleUntilOption("end-time",c,a),void 0!==s&&(c.size=s),d="spot_private_get_v1_order_orders"===n?await this.spotPrivateGetV1OrderOrders(this.extend(c,a)):await this.spotPrivateGetV1OrderHistory(this.extend(c,a));const h=this.safeList(d,"data",[]);return this.parseOrders(h,o,i,s)}async fetchSpotOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchSpotOrdersByStates("pre-submitted,submitted,partial-filled,filled,partial-canceled,canceled",t,e,i,s)}async fetchClosedSpotOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchSpotOrdersByStates("filled,partial-canceled,canceled",t,e,i,s)}async fetchContractOrders(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchContractOrders() requires a symbol argument");await this.loadMarkets();const a=this.market(t);let n,o={trade_type:0,status:"0"};const d=this.safeBool2(s,"stop","trigger"),c=this.safeValue(s,"stopLossTakeProfit"),h=this.safeBool(s,"trailing",!1);if(s=this.omit(s,["stop","stopLossTakeProfit","trailing","trigger"]),d||c||h?(void 0!==i&&(o.page_size=i),o.contract_code=a.id,o.create_date=90):(void 0!==e&&(o.start_time=e),o.contract=a.id,o.type=1),[o,s]=this.handleUntilOption("end_time",o,s),a.linear){let t;[t,s]=this.handleMarginModeAndParams("fetchContractOrders",s),t=void 0===t?"cross":t,"isolated"===t?n=d?await this.contractPrivatePostLinearSwapApiV1SwapTriggerHisorders(this.extend(o,s)):c?await this.contractPrivatePostLinearSwapApiV1SwapTpslHisorders(this.extend(o,s)):h?await this.contractPrivatePostLinearSwapApiV1SwapTrackHisorders(this.extend(o,s)):await this.contractPrivatePostLinearSwapApiV3SwapHisorders(this.extend(o,s)):"cross"===t&&(n=d?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerHisorders(this.extend(o,s)):c?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslHisorders(this.extend(o,s)):h?await this.contractPrivatePostLinearSwapApiV1SwapCrossTrackHisorders(this.extend(o,s)):await this.contractPrivatePostLinearSwapApiV3SwapCrossHisorders(this.extend(o,s)))}else a.inverse&&(a.swap?n=d?await this.contractPrivatePostSwapApiV1SwapTriggerHisorders(this.extend(o,s)):c?await this.contractPrivatePostSwapApiV1SwapTpslHisorders(this.extend(o,s)):h?await this.contractPrivatePostSwapApiV1SwapTrackHisorders(this.extend(o,s)):await this.contractPrivatePostSwapApiV3SwapHisorders(this.extend(o,s)):a.future&&(o.symbol=a.settleId,n=d?await this.contractPrivatePostApiV1ContractTriggerHisorders(this.extend(o,s)):c?await this.contractPrivatePostApiV1ContractTpslHisorders(this.extend(o,s)):h?await this.contractPrivatePostApiV1ContractTrackHisorders(this.extend(o,s)):await this.contractPrivatePostApiV3ContractHisorders(this.extend(o,s))));let l=this.safeValue(n,"data");return Array.isArray(l)||(l=this.safeValue(l,"orders",[])),this.parseOrders(l,a,e,i)}async fetchClosedContractOrders(t=void 0,e=void 0,i=void 0,s={}){return await this.fetchContractOrders(t,e,i,this.extend({status:"5,6,7"},s))}async fetchOrders(t=void 0,e=void 0,i=void 0,s={}){let a,n;await this.loadMarkets(),void 0!==t&&(a=this.market(t)),[n,s]=this.handleMarketTypeAndParams("fetchOrders",a,s);const o="swap"===n||"future"===n;if(o&&void 0===t)throw new r.ArgumentsRequired(this.id+" fetchOrders() requires a symbol argument for "+n+" orders");return o?await this.fetchContractOrders(t,e,i,s):await this.fetchSpotOrders(t,e,i,s)}async fetchClosedOrders(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r,a,n=!1;return[n,s]=this.handleOptionAndParams(s,"fetchClosedOrders","paginate"),n?await this.fetchPaginatedCallDynamic("fetchClosedOrders",t,e,i,s,100):(void 0!==t&&(r=this.market(t)),[a,s]=this.handleMarketTypeAndParams("fetchClosedOrders",r,s),"spot"===a?await this.fetchClosedSpotOrders(t,e,i,s):await this.fetchClosedContractOrders(t,e,i,s))}async fetchOpenOrders(t=void 0,e=void 0,i=void 0,s={}){let r;await this.loadMarkets(),void 0!==t&&(r=this.market(t));const a={};let n,o,d;if([n,s]=this.handleMarketTypeAndParams("fetchOpenOrders",r,s),[o,s]=this.handleSubTypeAndParams("fetchOpenOrders",r,s,"linear"),"spot"===n){void 0!==t&&(a.symbol=r.id);let e=this.safeString(s,"account-id");if(void 0===e){await this.loadAccounts();for(let t=0;t<this.accounts.length;t++){const i=this.accounts[t];if("spot"===this.safeString(i,"type")&&(e=this.safeString(i,"id"),void 0!==e))break}}a["account-id"]=e,void 0!==i&&(a.size=i),s=this.omit(s,"account-id"),d=await this.spotPrivateGetV1OrderOpenOrders(this.extend(a,s))}else{void 0!==t&&(a.contract_code=r.id),void 0!==i&&(a.page_size=i);const e=this.safeBool2(s,"stop","trigger"),c=this.safeValue(s,"stopLossTakeProfit"),h=this.safeBool(s,"trailing",!1);if(s=this.omit(s,["stop","stopLossTakeProfit","trailing","trigger"]),"linear"===o){let t;[t,s]=this.handleMarginModeAndParams("fetchOpenOrders",s),t=void 0===t?"cross":t,"isolated"===t?d=e?await this.contractPrivatePostLinearSwapApiV1SwapTriggerOpenorders(this.extend(a,s)):c?await this.contractPrivatePostLinearSwapApiV1SwapTpslOpenorders(this.extend(a,s)):h?await this.contractPrivatePostLinearSwapApiV1SwapTrackOpenorders(this.extend(a,s)):await this.contractPrivatePostLinearSwapApiV1SwapOpenorders(this.extend(a,s)):"cross"===t&&(d=e?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerOpenorders(this.extend(a,s)):c?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslOpenorders(this.extend(a,s)):h?await this.contractPrivatePostLinearSwapApiV1SwapCrossTrackOpenorders(this.extend(a,s)):await this.contractPrivatePostLinearSwapApiV1SwapCrossOpenorders(this.extend(a,s)))}else"inverse"===o&&("swap"===n?d=e?await this.contractPrivatePostSwapApiV1SwapTriggerOpenorders(this.extend(a,s)):c?await this.contractPrivatePostSwapApiV1SwapTpslOpenorders(this.extend(a,s)):h?await this.contractPrivatePostSwapApiV1SwapTrackOpenorders(this.extend(a,s)):await this.contractPrivatePostSwapApiV1SwapOpenorders(this.extend(a,s)):"future"===n&&(a.symbol=this.safeString(r,"settleId","usdt"),d=e?await this.contractPrivatePostApiV1ContractTriggerOpenorders(this.extend(a,s)):c?await this.contractPrivatePostApiV1ContractTpslOpenorders(this.extend(a,s)):h?await this.contractPrivatePostApiV1ContractTrackOpenorders(this.extend(a,s)):await this.contractPrivatePostApiV1ContractOpenorders(this.extend(a,s))))}let c=this.safeValue(d,"data");return Array.isArray(c)||(c=this.safeValue(c,"orders",[])),this.parseOrders(c,r,e,i)}parseOrderStatus(t){return this.safeString({"partial-filled":"open","partial-canceled":"canceled",filled:"closed",canceled:"canceled",submitted:"open",created:"open",1:"open",2:"open",3:"open",4:"open",5:"canceled",6:"closed",7:"canceled",11:"canceling"},t,t)}parseOrder(t,e=void 0){const i=this.safeString2(t,"err_code","err-code");let s=this.parseOrderStatus(this.safeString2(t,"state","status"));void 0!==i&&(s="rejected");const r=this.safeStringN(t,["id","order_id_str","order-id"]);let a=this.safeString(t,"direction"),n=this.safeString(t,"order_price_type");if("type"in t){const e=t.type.split("-");a=e[0],n=e[1]}const o=this.safeString2(t,"contract_code","symbol");e=this.safeMarket(o,e);const d=this.safeIntegerN(t,["created_at","created-at","create_date"]),c=this.safeString2(t,"client_order_id","client-order-id");let h,l;void 0!==n&&n.indexOf("market")>=0?h=this.safeString(t,"field-cash-amount"):(l=this.safeString2(t,"volume","amount"),h=this.safeStringN(t,["filled-cash-amount","field-cash-amount","trade_turnover"]));const u=this.safeStringN(t,["filled-amount","field-amount","trade_volume"]),p=this.safeString2(t,"price","order_price");let f,m=this.safeString2(t,"filled-fees","field-fees");if(m=this.safeString(t,"fee",m),void 0!==m){let i;const s=this.safeString(t,"fee_asset");i=void 0!==s?this.safeCurrencyCode(s):"sell"===a?e.quote:e.base,f={cost:m,currency:i}}const g=this.safeString(t,"trade_avg_price"),y=this.safeValue(t,"trades"),v=this.safeInteger(t,"reduce_only");let b;return void 0!==v&&(b=0!==v),this.safeOrder({info:t,id:r,clientOrderId:c,timestamp:d,datetime:this.iso8601(d),lastTradeTimestamp:void 0,symbol:e.symbol,type:n,timeInForce:void 0,postOnly:void 0,side:a,price:p,triggerPrice:this.safeString2(t,"stop-price","trigger_price"),average:g,cost:h,amount:l,filled:u,remaining:void 0,status:s,reduceOnly:b,fee:f,trades:y},e)}async createMarketBuyOrderWithCost(t,e,i={}){await this.loadMarkets();if(!this.market(t).spot)throw new r.NotSupported(this.id+" createMarketBuyOrderWithCost() supports spot orders only");return i.createMarketBuyOrderRequiresPrice=!1,await this.createOrder(t,"market","buy",e,void 0,i)}async createTrailingPercentOrder(t,e,i,s,a=void 0,n=void 0,o=void 0,d={}){if(void 0===n)throw new r.ArgumentsRequired(this.id+" createTrailingPercentOrder() requires a trailingPercent argument");if(void 0===o)throw new r.ArgumentsRequired(this.id+" createTrailingPercentOrder() requires a trailingTriggerPrice argument");return d.trailingPercent=n,d.trailingTriggerPrice=o,await this.createOrder(t,e,i,s,a,d)}async createSpotOrderRequest(t,e,i,s,n=void 0,o={}){await this.loadMarkets(),await this.loadAccounts();const d=this.market(t);let c;[c,o]=this.handleMarginModeAndParams("createOrder",o);const h={"account-id":await this.fetchAccountIdByType(d.type,c,t),symbol:d.id};let l=e.replace("buy-","");l=l.replace("sell-","");const u=this.safeValue(this.options,d.type,{}),p=this.safeStringN(o,["triggerPrice","stopPrice","stop-price"]);if(void 0===p){if(l in this.safeValue(u,"stopOrderTypes",{}))throw new r.ArgumentsRequired(this.id+" createOrder() requires a triggerPrice for a trigger order")}else{const s="sell"===i?"lte":"gte",a=this.safeString(o,"operator",s);if(h["stop-price"]=this.priceToPrecision(t,p),h.operator=a,"limit"===l||"limit-fok"===l)l="stop-"+l;else if("stop-limit"!==l&&"stop-limit-fok"!==l)throw new r.NotSupported(this.id+" createOrder() does not support "+e+" orders")}let f;[f,o]=this.handlePostOnly("market"===l,"limit-maker"===l,o),f&&(l="limit-maker");const m=this.safeString(o,"timeInForce","GTC");"FOK"===m?l+="-fok":"IOC"===m&&(l="ioc"),h.type=i+"-"+l;const g=this.safeString2(o,"clientOrderId","client-order-id");if(void 0===g){const t=this.safeValue(this.options,"broker",{}),e=this.safeString(t,"id");h["client-order-id"]=e+this.uuid()}else h["client-order-id"]=g;if("cross"===c?h.source="super-margin-api":"isolated"===c?h.source="margin-api":"c2c"===c&&(h.source="c2c-margin-api"),"market"===l&&"buy"===i){let e,i=!0;[i,o]=this.handleOptionAndParams(o,"createOrder","createMarketBuyOrderRequiresPrice",!0);const d=this.safeNumber(o,"cost");if(o=this.omit(o,"cost"),void 0!==d)e=this.amountToPrecision(t,d);else if(i){if(void 0===n)throw new r.InvalidOrder(this.id+" createOrder() requires the price argument for market buy orders to calculate the total cost to spend (amount * price), alternatively set the createMarketBuyOrderRequiresPrice option or param to false and pass the cost to spend in the amount argument");{const i=this.numberToString(s),r=this.numberToString(n);e=this.amountToPrecision(t,a.Y.stringMul(i,r))}}else e=this.amountToPrecision(t,s);h.amount=e}else h.amount=this.amountToPrecision(t,s);return l in this.safeValue(u,"limitOrderTypes",{})&&(h.price=this.priceToPrecision(t,n)),o=this.omit(o,["triggerPrice","stopPrice","stop-price","clientOrderId","client-order-id","operator","timeInForce"]),this.extend(h,o)}createContractOrderRequest(t,e,i,s,r=void 0,n={}){const o={contract_code:this.market(t).id,volume:this.amountToPrecision(t,s),direction:i};let d;[d,n]=this.handlePostOnly("market"===e,"post_only"===e,n),d&&(e="post_only");const c=this.safeString(n,"timeInForce","GTC");"FOK"===c?e="fok":"IOC"===c&&(e="ioc");const h=this.safeNumberN(n,["triggerPrice","stopPrice","trigger_price"]),l=this.safeNumber2(n,"stopLossPrice","sl_trigger_price"),u=this.safeNumber2(n,"takeProfitPrice","tp_trigger_price"),p=this.safeString2(n,"trailingPercent","callback_rate"),f=this.safeNumber(n,"trailingTriggerPrice",r),m=void 0!==p,g=void 0!==l,y=void 0!==u;if(void 0!==h){const e=this.safeString2(n,"triggerType","trigger_type","le");o.trigger_type=e,o.trigger_price=this.priceToPrecision(t,h),void 0!==r&&(o.order_price=this.priceToPrecision(t,r))}else if(g||y)g?(o.sl_order_price_type=e,o.sl_trigger_price=this.priceToPrecision(t,l),void 0!==r&&(o.sl_order_price=this.priceToPrecision(t,r))):(o.tp_order_price_type=e,o.tp_trigger_price=this.priceToPrecision(t,u),void 0!==r&&(o.tp_order_price=this.priceToPrecision(t,r)));else if(m){const t=a.Y.stringDiv(p,"100");o.callback_rate=this.parseToNumeric(t),o.active_price=f,o.order_price_type=this.safeString(n,"order_price_type","formula_price")}else{const i=this.safeInteger2(n,"client_order_id","clientOrderId");void 0!==i&&(o.client_order_id=i,n=this.omit(n,["clientOrderId"])),"limit"!==e&&"ioc"!==e&&"fok"!==e&&"post_only"!==e||void 0!==r&&(o.price=this.priceToPrecision(t,r))}const v=this.safeBool2(n,"reduceOnly","reduce_only",!1);g||y||(v&&(o.reduce_only=1),o.lever_rate=this.safeIntegerN(n,["leverRate","lever_rate","leverage"],1),m||(o.order_price_type=e));this.safeBool(n,"hedged",!1)&&(o.offset=v?"close":"open");const b=this.safeValue(this.options,"broker",{}),w=this.safeString(b,"id");return o.channel_code=w,n=this.omit(n,["reduceOnly","triggerPrice","stopPrice","stopLossPrice","takeProfitPrice","triggerType","leverRate","timeInForce","leverage","trailingPercent","trailingTriggerPrice","hedged"]),this.extend(o,n)}async createOrder(t,e,i,s,a=void 0,n={}){await this.loadMarkets();const o=this.market(t),d=this.safeNumberN(n,["triggerPrice","stopPrice","trigger_price"]),c=this.safeNumber2(n,"stopLossPrice","sl_trigger_price"),h=this.safeNumber2(n,"takeProfitPrice","tp_trigger_price"),l=void 0!==this.safeNumber(n,"trailingPercent"),u=void 0!==d,p=void 0!==c,f=void 0!==h;let m,g,y;if(o.spot){if(l)throw new r.NotSupported(this.id+" createOrder() does not support trailing orders for spot markets");const o=await this.createSpotOrderRequest(t,e,i,s,a,n);m=await this.spotPrivatePostV1OrderOrdersPlace(o)}else{let d=this.createContractOrderRequest(t,e,i,s,a,n);if(o.linear){let t;[t,d]=this.handleMarginModeAndParams("createOrder",d),t=void 0===t?"cross":t,"isolated"===t?m=u?await this.contractPrivatePostLinearSwapApiV1SwapTriggerOrder(d):p||f?await this.contractPrivatePostLinearSwapApiV1SwapTpslOrder(d):l?await this.contractPrivatePostLinearSwapApiV1SwapTrackOrder(d):await this.contractPrivatePostLinearSwapApiV1SwapOrder(d):"cross"===t&&(m=u?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerOrder(d):p||f?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslOrder(d):l?await this.contractPrivatePostLinearSwapApiV1SwapCrossTrackOrder(d):await this.contractPrivatePostLinearSwapApiV1SwapCrossOrder(d))}else if(o.inverse){if(void 0===this.safeString(n,"offset"))throw new r.ArgumentsRequired(this.id+' createOrder () requires an extra parameter params["offset"] to be set to "open" or "close" when placing orders in inverse markets');o.swap?m=u?await this.contractPrivatePostSwapApiV1SwapTriggerOrder(d):p||f?await this.contractPrivatePostSwapApiV1SwapTpslOrder(d):l?await this.contractPrivatePostSwapApiV1SwapTrackOrder(d):await this.contractPrivatePostSwapApiV1SwapOrder(d):o.future&&(m=u?await this.contractPrivatePostApiV1ContractTriggerOrder(d):p||f?await this.contractPrivatePostApiV1ContractTpslOrder(d):l?await this.contractPrivatePostApiV1ContractTrackOrder(d):await this.contractPrivatePostApiV1ContractOrder(d))}}return o.spot?this.safeOrder({info:m,id:this.safeString(m,"data"),timestamp:void 0,datetime:void 0,lastTradeTimestamp:void 0,status:void 0,symbol:void 0,type:e,side:i,price:a,amount:s,filled:void 0,remaining:void 0,cost:void 0,trades:void 0,fee:void 0,clientOrderId:void 0,average:void 0},o):(p?(g=this.safeValue(m,"data",{}),y=this.safeValue(g,"sl_order",{})):f?(g=this.safeValue(m,"data",{}),y=this.safeValue(g,"tp_order",{})):y=this.safeValue(m,"data",{}),this.parseOrder(y,o))}async createOrders(t,e={}){await this.loadMarkets();const i=[];let s,a,n;for(let e=0;e<t.length;e++){const o=t[e],d=this.safeString(o,"symbol");if(void 0===s)s=d;else if(s!==d)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same symbol");const c=this.safeString(o,"type"),h=this.safeString(o,"side"),l=this.safeValue(o,"amount"),u=this.safeValue(o,"price"),p=this.safeValue(o,"params",{}),f=this.handleMarginModeAndParams("createOrders",p)[0];if(void 0!==f)if(void 0===n)n=f;else if(n!==f)throw new r.BadRequest(this.id+" createOrders() requires all orders to have the same margin mode (isolated or cross)");let m;a=this.market(s),m=a.spot?await this.createSpotOrderRequest(d,c,h,l,u,p):this.createContractOrderRequest(d,c,h,l,u,p),m=this.omit(m,"marginMode"),i.push(m)}const o={};let d,c;if(a.spot?d=await this.privatePostOrderBatchOrders(i):(o.orders_data=i,a.linear?(n=void 0===n?"cross":n,"isolated"===n?d=await this.contractPrivatePostLinearSwapApiV1SwapBatchorder(o):"cross"===n&&(d=await this.contractPrivatePostLinearSwapApiV1SwapCrossBatchorder(o))):a.inverse&&(a.swap?d=await this.contractPrivatePostSwapApiV1SwapBatchorder(o):a.future&&(d=await this.contractPrivatePostApiV1ContractBatchorder(o)))),a.spot)c=this.safeValue(d,"data",[]);else{const t=this.safeValue(d,"data",{}),e=this.safeValue(t,"success",[]),i=this.safeValue(t,"errors",[]);c=this.arrayConcat(e,i)}return this.parseOrders(c,a)}async cancelOrder(t,e=void 0,i={}){let s,a;await this.loadMarkets(),void 0!==e&&(s=this.market(e)),[a,i]=this.handleMarketTypeAndParams("cancelOrder",s,i);const n={};let o;if("spot"===a){const e=this.safeString2(i,"client-order-id","clientOrderId");void 0===e?(n["order-id"]=t,o=await this.spotPrivatePostV1OrderOrdersOrderIdSubmitcancel(this.extend(n,i))):(n["client-order-id"]=e,i=this.omit(i,["client-order-id","clientOrderId"]),o=await this.spotPrivatePostV1OrderOrdersSubmitCancelClientOrder(this.extend(n,i)))}else{if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrder() requires a symbol argument");const d=this.safeString2(i,"client_order_id","clientOrderId");void 0===d?n.order_id=t:(n.client_order_id=d,i=this.omit(i,["client_order_id","clientOrderId"])),s.future?n.symbol=s.settleId:n.contract_code=s.id;const c=this.safeBool2(i,"stop","trigger"),h=this.safeValue(i,"stopLossTakeProfit"),l=this.safeBool(i,"trailing",!1);if(i=this.omit(i,["stop","stopLossTakeProfit","trailing","trigger"]),s.linear){let t;[t,i]=this.handleMarginModeAndParams("cancelOrder",i),t=void 0===t?"cross":t,"isolated"===t?o=c?await this.contractPrivatePostLinearSwapApiV1SwapTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostLinearSwapApiV1SwapTpslCancel(this.extend(n,i)):l?await this.contractPrivatePostLinearSwapApiV1SwapTrackCancel(this.extend(n,i)):await this.contractPrivatePostLinearSwapApiV1SwapCancel(this.extend(n,i)):"cross"===t&&(o=c?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslCancel(this.extend(n,i)):l?await this.contractPrivatePostLinearSwapApiV1SwapCrossTrackCancel(this.extend(n,i)):await this.contractPrivatePostLinearSwapApiV1SwapCrossCancel(this.extend(n,i)))}else{if(!s.inverse)throw new r.NotSupported(this.id+" cancelOrder() does not support "+a+" markets");s.swap?o=c?await this.contractPrivatePostSwapApiV1SwapTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostSwapApiV1SwapTpslCancel(this.extend(n,i)):l?await this.contractPrivatePostSwapApiV1SwapTrackCancel(this.extend(n,i)):await this.contractPrivatePostSwapApiV1SwapCancel(this.extend(n,i)):s.future&&(o=c?await this.contractPrivatePostApiV1ContractTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostApiV1ContractTpslCancel(this.extend(n,i)):l?await this.contractPrivatePostApiV1ContractTrackCancel(this.extend(n,i)):await this.contractPrivatePostApiV1ContractCancel(this.extend(n,i)))}}return this.extend(this.parseOrder(o,s),{id:t,status:"canceled"})}async cancelOrders(t,e=void 0,i={}){let s,a;await this.loadMarkets(),void 0!==e&&(s=this.market(e)),[a,i]=this.handleMarketTypeAndParams("cancelOrders",s,i);const n={};let o;if("spot"===a){let e=this.safeValue2(i,"client-order-id","clientOrderId");e=this.safeValue2(i,"client-order-ids","clientOrderIds",e),void 0===e?n["order-ids"]="string"==typeof e?[t]:t:(n["client-order-ids"]="string"==typeof e?[e]:e,i=this.omit(i,["client-order-id","client-order-ids","clientOrderId","clientOrderIds"])),o=await this.spotPrivatePostV1OrderOrdersBatchcancel(this.extend(n,i))}else{if(void 0===e)throw new r.ArgumentsRequired(this.id+" cancelOrders() requires a symbol argument");let d=this.safeString2(i,"client_order_id","clientOrderId");d=this.safeString2(i,"client_order_ids","clientOrderIds",d),void 0===d?n.order_id=t.join(","):(n.client_order_id=d,i=this.omit(i,["client_order_id","client_order_ids","clientOrderId","clientOrderIds"])),s.future?n.symbol=s.settleId:n.contract_code=s.id;const c=this.safeBool2(i,"stop","trigger"),h=this.safeValue(i,"stopLossTakeProfit");if(i=this.omit(i,["stop","stopLossTakeProfit","trigger"]),s.linear){let t;[t,i]=this.handleMarginModeAndParams("cancelOrders",i),t=void 0===t?"cross":t,"isolated"===t?o=c?await this.contractPrivatePostLinearSwapApiV1SwapTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostLinearSwapApiV1SwapTpslCancel(this.extend(n,i)):await this.contractPrivatePostLinearSwapApiV1SwapCancel(this.extend(n,i)):"cross"===t&&(o=c?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslCancel(this.extend(n,i)):await this.contractPrivatePostLinearSwapApiV1SwapCrossCancel(this.extend(n,i)))}else{if(!s.inverse)throw new r.NotSupported(this.id+" cancelOrders() does not support "+a+" markets");s.swap?o=c?await this.contractPrivatePostSwapApiV1SwapTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostSwapApiV1SwapTpslCancel(this.extend(n,i)):await this.contractPrivatePostSwapApiV1SwapCancel(this.extend(n,i)):s.future&&(o=c?await this.contractPrivatePostApiV1ContractTriggerCancel(this.extend(n,i)):h?await this.contractPrivatePostApiV1ContractTpslCancel(this.extend(n,i)):await this.contractPrivatePostApiV1ContractCancel(this.extend(n,i)))}}const d=this.safeDict(o,"data");return this.parseCancelOrders(d)}parseCancelOrders(t){const e=this.safeString(t,"successes");let i;i=void 0!==e?e.split(","):this.safeList(t,"success",[]);const s=this.safeList2(t,"errors","failed",[]),r=[];for(let t=0;t<i.length;t++){const e=i[t];r.push(this.safeOrder({info:e,id:e,status:"canceled"}))}for(let t=0;t<s.length;t++){const e=s[t];r.push(this.safeOrder({info:e,id:this.safeString2(e,"order-id","order_id"),status:"failed",clientOrderId:this.safeString(e,"client-order-id")}))}return r}async cancelAllOrders(t=void 0,e={}){let i,s;await this.loadMarkets(),void 0!==t&&(i=this.market(t)),[s,e]=this.handleMarketTypeAndParams("cancelAllOrders",i,e);const a={};let n;if("spot"===s){void 0!==t&&(a.symbol=i.id),n=await this.spotPrivatePostV1OrderOrdersBatchCancelOpenOrders(this.extend(a,e));const s=this.safeDict(n,"data");return[this.safeOrder({info:s})]}{if(void 0===t)throw new r.ArgumentsRequired(this.id+" cancelAllOrders() requires a symbol argument");i.future&&(a.symbol=i.settleId),a.contract_code=i.id;const o=this.safeBool2(e,"stop","trigger"),d=this.safeValue(e,"stopLossTakeProfit"),c=this.safeBool(e,"trailing",!1);if(e=this.omit(e,["stop","stopLossTakeProfit","trailing","trigger"]),i.linear){let t;[t,e]=this.handleMarginModeAndParams("cancelAllOrders",e),t=void 0===t?"cross":t,"isolated"===t?n=o?await this.contractPrivatePostLinearSwapApiV1SwapTriggerCancelall(this.extend(a,e)):d?await this.contractPrivatePostLinearSwapApiV1SwapTpslCancelall(this.extend(a,e)):c?await this.contractPrivatePostLinearSwapApiV1SwapTrackCancelall(this.extend(a,e)):await this.contractPrivatePostLinearSwapApiV1SwapCancelall(this.extend(a,e)):"cross"===t&&(n=o?await this.contractPrivatePostLinearSwapApiV1SwapCrossTriggerCancelall(this.extend(a,e)):d?await this.contractPrivatePostLinearSwapApiV1SwapCrossTpslCancelall(this.extend(a,e)):c?await this.contractPrivatePostLinearSwapApiV1SwapCrossTrackCancelall(this.extend(a,e)):await this.contractPrivatePostLinearSwapApiV1SwapCrossCancelall(this.extend(a,e)))}else{if(!i.inverse)throw new r.NotSupported(this.id+" cancelAllOrders() does not support "+s+" markets");i.swap?n=o?await this.contractPrivatePostSwapApiV1SwapTriggerCancelall(this.extend(a,e)):d?await this.contractPrivatePostSwapApiV1SwapTpslCancelall(this.extend(a,e)):c?await this.contractPrivatePostSwapApiV1SwapTrackCancelall(this.extend(a,e)):await this.contractPrivatePostSwapApiV1SwapCancelall(this.extend(a,e)):i.future&&(n=o?await this.contractPrivatePostApiV1ContractTriggerCancelall(this.extend(a,e)):d?await this.contractPrivatePostApiV1ContractTpslCancelall(this.extend(a,e)):c?await this.contractPrivatePostApiV1ContractTrackCancelall(this.extend(a,e)):await this.contractPrivatePostApiV1ContractCancelall(this.extend(a,e)))}const h=this.safeDict(n,"data");return this.parseCancelOrders(h)}}async cancelAllOrdersAfter(t,e={}){await this.loadMarkets();const i={timeout:t>0?this.parseToInt(t/1e3):0};return await this.v2PrivatePostAlgoOrdersCancelAllAfter(this.extend(i,e))}parseDepositAddress(t,e=void 0){const i=this.safeString(t,"address"),s=this.safeString(t,"addressTag"),r=this.safeString(t,"currency");e=this.safeCurrency(r,e);const a=this.safeCurrencyCode(r,e),n=this.safeString(t,"note"),o=this.safeString(t,"chain");return this.checkAddress(i),{currency:a,address:i,tag:s,network:this.networkIdToCode(o),note:n,info:t}}async fetchDepositAddressesByNetwork(t,e={}){await this.loadMarkets();const i=this.currency(t),s={currency:i.id},r=await this.spotPrivateGetV2AccountDepositAddress(this.extend(s,e)),a=this.safeValue(r,"data",[]),n=this.parseDepositAddresses(a,[i.code],!1);return this.indexBy(n,"network")}async fetchDepositAddress(t,e={}){await this.loadMarkets();const i=this.currency(t),[s,r]=this.handleNetworkCodeAndParams(e),a=await this.fetchDepositAddressesByNetwork(t,r);return a[this.selectNetworkCodeFromUnifiedNetworks(i.code,s,a)]}async fetchWithdrawAddresses(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.currency(t),a={currency:r.id},n=await this.spotPrivateGetV2AccountWithdrawAddress(this.extend(a,s)),o=this.safeValue(n,"data",[]),d=this.parseDepositAddresses(o,[r.code],!1),c=[];for(let t=0;t<d.length;t++){const s=d[t],r=void 0===e||s.note===e,a=void 0===i||s.network===i;r&&a&&c.push(s)}return c}async fetchDeposits(t=void 0,e=void 0,i=void 0,s={}){let r;(void 0===i||i>100)&&(i=100),await this.loadMarkets(),void 0!==t&&(r=this.currency(t));const a={type:"deposit",direct:"next",from:0};void 0!==r&&(a.currency=r.id),void 0!==i&&(a.size=i);const n=await this.spotPrivateGetV1QueryDepositWithdraw(this.extend(a,s));return this.parseTransactions(n.data,r,e,i)}async fetchWithdrawals(t=void 0,e=void 0,i=void 0,s={}){let r;(void 0===i||i>100)&&(i=100),await this.loadMarkets(),void 0!==t&&(r=this.currency(t));const a={type:"withdraw",direct:"next",from:0};void 0!==r&&(a.currency=r.id),void 0!==i&&(a.size=i);const n=await this.spotPrivateGetV1QueryDepositWithdraw(this.extend(a,s));return this.parseTransactions(n.data,r,e,i)}parseTransaction(t,e=void 0){const i=this.safeInteger(t,"created-at"),s=this.safeCurrencyCode(this.safeString(t,"currency"));let r=this.safeString(t,"type");"withdraw"===r&&(r="withdrawal");let n=this.safeString(t,"fee");void 0!==n&&(n=a.Y.stringAbs(n));const o=this.safeString(t,"chain");let d=this.safeString(t,"tx-hash");"ETH"===o&&d.indexOf("0x")<0&&(d="0x"+d);const c="FAST"===this.safeString(t,"sub-type");return{info:t,id:this.safeString2(t,"id","data"),txid:d,timestamp:i,datetime:this.iso8601(i),network:this.networkIdToCode(o),address:this.safeString(t,"address"),addressTo:void 0,addressFrom:void 0,tag:this.safeString(t,"address-tag"),tagTo:void 0,tagFrom:void 0,type:r,amount:this.safeNumber(t,"amount"),currency:s,status:this.parseTransactionStatus(this.safeString(t,"state")),updated:this.safeInteger(t,"updated-at"),comment:void 0,internal:c,fee:{currency:s,cost:this.parseNumber(n),rate:void 0}}}parseTransactionStatus(t){return this.safeString({unknown:"failed",confirming:"pending",confirmed:"ok",safe:"ok",orphan:"failed",submitted:"pending",canceled:"canceled",reexamine:"pending",reject:"failed",pass:"pending","wallet-reject":"failed","confirm-error":"failed",repealed:"failed","wallet-transfer":"pending","pre-transfer":"pending",verifying:"pending"},t,t)}async withdraw(t,e,i,s=void 0,n={}){[s,n]=this.handleWithdrawTagAndParams(s,n),await this.loadMarkets(),this.checkAddress(i);const o=this.currency(t),d={address:i,currency:o.id.toLowerCase()};let c;void 0!==s&&(d["addr-tag"]=s),[c,n]=this.handleNetworkCodeAndParams(n),void 0!==c&&(d.chain=this.networkCodeToId(c,t)),e=parseFloat(this.currencyToPrecision(t,e,c));const h=this.safeValue(this.options,"withdraw",{});if(this.safeBool(h,"includeFee",!1)){let i=this.safeNumber(n,"fee");if(void 0===i){const t=await this.fetchCurrencies();this.currencies=this.mapToSafeMap(this.deepExtend(this.currencies,t));const e=this.safeValue(o.networks,c,{});if(i=this.safeNumber(e,"fee"),void 0===i)throw new r.ArgumentsRequired(this.id+' withdraw() function can not find withdraw fee for chosen network. You need to re-load markets with "exchange.loadMarkets(true)", or provide the "fee" parameter')}const s=this.currencyToPrecision(t,i,c);n=this.omit(n,"fee");const h=this.numberToString(e),l=a.Y.stringSub(h,s),u=parseFloat(l);d.fee=parseFloat(s),e=parseFloat(this.currencyToPrecision(t,u,c))}d.amount=e;const l=await this.spotPrivatePostV1DwWithdrawApiCreate(this.extend(d,n));return this.parseTransaction(l,o)}parseTransfer(t,e=void 0){return{info:t,id:this.safeString(t,"data"),timestamp:void 0,datetime:void 0,currency:this.safeCurrencyCode(void 0,e),amount:void 0,fromAccount:void 0,toAccount:void 0,status:void 0}}async transfer(t,e,i,s,a={}){await this.loadMarkets();const n=this.currency(t),o={currency:n.id,amount:parseFloat(this.currencyToPrecision(t,e))};let d;[d,a]=this.handleSubTypeAndParams("transfer",void 0,a);let c=this.convertTypeToAccount(i),h=this.convertTypeToAccount(s);const l="cross"===h,u="cross"===c,p=this.inArray(h,this.ids),f=this.inArray(c,this.ids),m="pro"===c,g="pro"===h;if(m&&g)throw new r.BadRequest(this.id+" transfer () cannot make a transfer between "+i+" and "+s);let y;if("futures"===c||"futures"===h){let t=c+"-to-"+h;t=this.safeString(a,"type",t),o.type=t,y=await this.spotPrivatePostV1FuturesTransfer(this.extend(o,a))}else if(m&&l)y=await this.privatePostCrossMarginTransferIn(this.extend(o,a));else if(u&&g)y=await this.privatePostCrossMarginTransferOut(this.extend(o,a));else if(m&&p)o.symbol=h,y=await this.privatePostDwTransferInMargin(this.extend(o,a));else if(f&&g)o.symbol=c,y=await this.privatePostDwTransferOutMargin(this.extend(o,a));else{if("linear"===d){"swap"===c||"linear-swap"===i?c="linear-swap":h="linear-swap";let t=this.safeString(a,"symbol");a=this.omit(a,"symbol"),void 0!==t?(t=this.marketId(t),o["margin-account"]=t):o["margin-account"]="USDT"}o.from=m?"spot":c,o.to=g?"spot":h,y=await this.v2PrivatePostAccountTransfer(this.extend(o,a))}return this.parseTransfer(y,n)}async fetchIsolatedBorrowRates(t={}){await this.loadMarkets();const e=await this.spotPrivateGetV1MarginLoanInfo(t),i=this.safeValue(e,"data",[]);return this.parseIsolatedBorrowRates(i)}parseIsolatedBorrowRate(t,e=void 0){const i=this.safeString(t,"symbol"),s=this.safeSymbol(i,e),r=this.safeValue(t,"currencies",[]),a=this.safeValue(r,0),n=this.safeValue(r,1),o=this.safeString(a,"currency"),d=this.safeString(n,"currency");return{symbol:s,base:this.safeCurrencyCode(o),baseRate:this.safeNumber(a,"actual-rate"),quote:this.safeCurrencyCode(d),quoteRate:this.safeNumber(n,"actual-rate"),period:864e5,timestamp:void 0,datetime:void 0,info:t}}async fetchFundingRateHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchFundingRateHistory() requires a symbol argument");let a=!1;if([a,s]=this.handleOptionAndParams(s,"fetchFundingRateHistory","paginate"),a)return await this.fetchPaginatedCallCursor("fetchFundingRateHistory",t,e,i,s,"current_page","page_index",1,50);await this.loadMarkets();const n=this.market(t),o={contract_code:n.id};let d;if(o.page_size=void 0!==i?i:50,n.inverse)d=await this.contractPublicGetSwapApiV1SwapHistoricalFundingRate(this.extend(o,s));else{if(!n.linear)throw new r.NotSupported(this.id+" fetchFundingRateHistory() supports inverse and linear swaps only");d=await this.contractPublicGetLinearSwapApiV1SwapHistoricalFundingRate(this.extend(o,s))}const c=this.safeValue(d,"data"),h=this.safeValue(c,"current_page"),l=this.safeValue(c,"data",[]),u=[];for(let t=0;t<l.length;t++){const e=l[t];e.current_page=h;const i=this.safeString(e,"contract_code"),s=this.safeSymbol(i),r=this.safeInteger(e,"funding_time");u.push({info:e,symbol:s,fundingRate:this.safeNumber(e,"funding_rate"),timestamp:r,datetime:this.iso8601(r)})}const p=this.sortBy(u,"timestamp");return this.filterBySymbolSinceLimit(p,n.symbol,e,i)}parseFundingRate(t,e=void 0){const i=this.safeNumber(t,"estimated_rate"),s=this.safeInteger(t,"funding_time"),r=this.safeInteger(t,"next_funding_time"),n=this.safeString(t,"funding_time"),o=this.safeString(t,"next_funding_time"),d=a.Y.stringSub(o,n),c=this.safeString(t,"contract_code");return{info:t,symbol:this.safeSymbol(c,e),markPrice:void 0,indexPrice:void 0,interestRate:void 0,estimatedSettlePrice:void 0,timestamp:void 0,datetime:void 0,fundingRate:this.safeNumber(t,"funding_rate"),fundingTimestamp:s,fundingDatetime:this.iso8601(s),nextFundingRate:i,nextFundingTimestamp:r,nextFundingDatetime:this.iso8601(r),previousFundingRate:void 0,previousFundingTimestamp:void 0,previousFundingDatetime:void 0,interval:this.parseFundingInterval(d)}}parseFundingInterval(t){return this.safeString({36e5:"1h",144e5:"4h",288e5:"8h",576e5:"16h",864e5:"24h"},t,t)}async fetchFundingRate(t,e={}){await this.loadMarkets();const i=this.market(t),s={contract_code:i.id};let a;if(i.inverse)a=await this.contractPublicGetSwapApiV1SwapFundingRate(this.extend(s,e));else{if(!i.linear)throw new r.NotSupported(this.id+" fetchFundingRate() supports inverse and linear swaps only");a=await this.contractPublicGetLinearSwapApiV1SwapFundingRate(this.extend(s,e))}const n=this.safeValue(a,"data",{});return this.parseFundingRate(n,i)}async fetchFundingRates(t=void 0,e={}){await this.loadMarkets(),t=this.marketSymbols(t);const i=this.safeString(this.options,"defaultSubType","linear");let s;if([s,e]=this.handleOptionAndParams(e,"fetchFundingRates","subType",i),void 0!==t){const e=this.safeString(t,0);s=this.market(e).linear?"linear":"inverse"}const a={};let n;if("linear"===s)n=await this.contractPublicGetLinearSwapApiV1SwapBatchFundingRate(this.extend(a,e));else{if("inverse"!==s)throw new r.NotSupported(this.id+" fetchFundingRates() not support this market type");n=await this.contractPublicGetSwapApiV1SwapBatchFundingRate(this.extend(a,e))}const o=this.safeValue(n,"data",[]);return this.parseFundingRates(o,t)}async fetchBorrowInterest(t=void 0,e=void 0,i=void 0,s=void 0,r={}){let a;await this.loadMarkets(),[a,r]=this.handleMarginModeAndParams("fetchBorrowInterest",r),a=void 0===a?"cross":a;const n={};let o,d;if(void 0!==i&&(n["start-date"]=this.yyyymmdd(i)),void 0!==s&&(n.size=s),"isolated"===a)void 0!==e&&(o=this.market(e),n.symbol=o.id),d=await this.privateGetMarginLoanOrders(this.extend(n,r));else{if(void 0!==t){const e=this.currency(t);n.currency=e.id}d=await this.privateGetCrossMarginLoanOrders(this.extend(n,r))}const c=this.safeValue(d,"data"),h=this.parseBorrowInterests(c,o);return this.filterByCurrencySinceLimit(h,t,i,s)}parseBorrowInterest(t,e=void 0){const i=this.safeString(t,"symbol"),s=void 0===i?"cross":"isolated";e=this.safeMarket(i);const r=this.safeString(e,"symbol"),a=this.safeInteger(t,"accrued-at");return{info:t,symbol:r,currency:this.safeCurrencyCode(this.safeString(t,"currency")),interest:this.safeNumber(t,"interest-amount"),interestRate:this.safeNumber(t,"interest-rate"),amountBorrowed:this.safeNumber(t,"loan-amount"),marginMode:s,timestamp:a,datetime:this.iso8601(a)}}nonce(){return this.milliseconds()-this.options.timeDifference}sign(t,e="public",i="GET",s={},r=void 0,a=void 0){let n="/";const d=this.omit(s,this.extractParams(t));if("string"==typeof e){if("public"===e||"private"===e?n+=this.version:"v2Public"!==e&&"v2Private"!==e||(n+="v2"),n+="/"+this.implodeParams(t,s),"private"===e||"v2Private"===e){this.checkRequiredCredentials();const t=this.ymdhms(this.nonce(),"T");let e={SignatureMethod:"HmacSHA256",SignatureVersion:"2",AccessKeyId:this.apiKey,Timestamp:t};"POST"!==i&&(e=this.extend(e,d));const s=this.keysort(e);let c=this.urlencode(s,!0);const h=[i,this.hostname,n,c].join("\n"),l=this.hmac(this.encode(h),this.encode(this.secret),o.s,"base64");c+="&"+this.urlencode({Signature:l}),n+="?"+c,"POST"===i?(a=this.json(d),r={"Content-Type":"application/json"}):r={"Content-Type":"application/x-www-form-urlencoded"}}else Object.keys(d).length&&(n+="?"+this.urlencode(d));n=this.implodeParams(this.urls.api[e],{hostname:this.hostname})+n}else{const c=this.safeString(e,0),h=this.safeString(e,1),l=this.safeString(e,2),u=this.safeString(e,3);let p,f=this.safeValue(this.urls.hostnames,c);if("string"!=typeof f&&(f=this.safeValue(f,l),"string"!=typeof f&&void 0!==u&&(f=this.safeValue(f,u))),p=f,n+=this.implodeParams(t,s),"public"===h)Object.keys(d).length&&(n+="?"+this.urlencode(d));else if("private"===h){if(this.checkRequiredCredentials(),"POST"===i){const e=this.safeValue(this.options,"broker",{}),i=this.safeString(e,"id","AA03022abc");if(-1===t.indexOf("cancel")&&t.endsWith("order")){void 0===this.safeString(s,"channel_code")&&(s.channel_code=i)}else if(t.endsWith("orders/place")){void 0===this.safeString(s,"client-order-id")&&(s["client-order-id"]=i+this.uuid())}}const e=this.ymdhms(this.nonce(),"T");let c={SignatureMethod:"HmacSHA256",SignatureVersion:"2",AccessKeyId:this.apiKey,Timestamp:e};if(c=this.keysort(c),"POST"!==i){const t=this.keysort(d);c=this.extend(c,t)}let h=this.urlencode(c,!0).replace("%2c","%2C");const l=[i,p,n,h].join("\n"),u=this.hmac(this.encode(l),this.encode(this.secret),o.s,"base64");h+="&"+this.urlencode({Signature:u}),n+="?"+h,"POST"===i?(2===(a=this.json(d)).length&&(a="{}"),r={"Content-Type":"application/json"}):r={"Content-Type":"application/x-www-form-urlencoded"}}n=this.implodeParams(this.urls.api[c],{hostname:p})+n}return{url:n,method:i,body:a,headers:r}}handleErrors(t,e,i,s,a,n,o,d,c){if(void 0===o)return;if("status"in o){if("error"===this.safeString(o,"status")){const t=this.safeString2(o,"err-code","err_code"),e=this.id+" "+n;this.throwBroadlyMatchedException(this.exceptions.broad,n,e),this.throwExactlyMatchedException(this.exceptions.exact,t,e);const i=this.safeString2(o,"err-msg","err_msg");throw this.throwExactlyMatchedException(this.exceptions.exact,i,e),new r.ExchangeError(e)}}if("code"in o){const t=this.id+" "+n,e=this.safeString(o,"code");this.throwExactlyMatchedException(this.exceptions.exact,e,t)}const h=this.safeDict(o,"data"),l=this.safeList(h,"errors");if(void 0!==l){const t=this.safeDict(l,0),e=this.safeString(t,"err_code"),i=this.safeString(t,"err_msg"),s=this.id+" "+n;this.throwExactlyMatchedException(this.exceptions.exact,e,s),this.throwExactlyMatchedException(this.exceptions.exact,i,s)}}async fetchFundingHistory(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();const r=this.market(t),[a,n]=this.handleMarketTypeAndParams("fetchFundingHistory",r,s),o={type:"30,31"};let d;if(void 0!==e&&(o.start_date=e),"swap"===a)if(o.contract=r.id,r.linear){let t;[t,s]=this.handleMarginModeAndParams("fetchFundingHistory",s),t=void 0===t?"cross":t,o.mar_acct="isolated"===t?r.id:r.quoteId,d=await this.contractPrivatePostLinearSwapApiV3SwapFinancialRecordExact(this.extend(o,n))}else d=await this.contractPrivatePostSwapApiV3SwapFinancialRecordExact(this.extend(o,n));else o.symbol=r.id,d=await this.contractPrivatePostApiV3ContractFinancialRecordExact(this.extend(o,n));const c=this.safeList(d,"data",[]);return this.parseIncomes(c,r,e,i)}async setLeverage(t,e=void 0,i={}){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setLeverage() requires a symbol argument");await this.loadMarkets();const s=this.market(e),[a,n]=this.handleMarketTypeAndParams("setLeverage",s,i),o={lever_rate:t};let d;if("future"===a&&s.inverse?o.symbol=s.settleId:o.contract_code=s.id,s.linear){let t;if([t,i]=this.handleMarginModeAndParams("setLeverage",i),t=void 0===t?"cross":t,"isolated"===t)d=await this.contractPrivatePostLinearSwapApiV1SwapSwitchLeverRate(this.extend(o,n));else{if("cross"!==t)throw new r.NotSupported(this.id+" setLeverage() not support this market type");d=await this.contractPrivatePostLinearSwapApiV1SwapCrossSwitchLeverRate(this.extend(o,n))}}else if("future"===a)d=await this.contractPrivatePostApiV1ContractSwitchLeverRate(this.extend(o,n));else{if("swap"!==a)throw new r.NotSupported(this.id+" setLeverage() not support this market type");d=await this.contractPrivatePostSwapApiV1SwapSwitchLeverRate(this.extend(o,n))}return d}parseIncome(t,e=void 0){const i=this.safeString(t,"contract_code"),s=this.safeSymbol(i,e),r=this.safeNumber(t,"amount"),a=this.safeInteger(t,"ts"),n=this.safeString(t,"id"),o=this.safeString2(t,"symbol","asset");return{info:t,symbol:s,code:this.safeCurrencyCode(o),timestamp:a,datetime:this.iso8601(a),id:n,amount:r}}parsePosition(t,e=void 0){const i=(e=this.safeMarket(this.safeString(t,"contract_code"))).symbol,s=this.safeString(t,"volume"),r=this.safeValue(e,"contractSize"),n=this.numberToString(r),o=this.safeNumber(t,"cost_open"),d=this.safeString(t,"position_margin"),c="buy"===this.safeString(t,"direction")?"long":"short",h=this.safeNumber(t,"profit_unreal");let l=this.safeString(t,"margin_mode");const u=this.safeString(t,"lever_rate"),p=a.Y.stringMul(this.safeString(t,"profit_rate"),"100"),f=this.safeString(t,"last_price"),m=a.Y.stringMul(s,n);let g;e.linear?g=a.Y.stringMul(m,f):(g=a.Y.stringDiv(m,f),l="cross");const y=a.Y.stringDiv(d,g),v=this.safeString(t,"margin_balance"),b=this.safeNumber(t,"liquidation_price"),w=this.safeString(t,"adjust_factor"),S=a.Y.stringDiv(w,u),k=a.Y.stringMul(S,g),O=a.Y.stringDiv(k,v);return this.safePosition({info:t,id:void 0,symbol:i,contracts:this.parseNumber(s),contractSize:r,entryPrice:o,collateral:this.parseNumber(v),side:c,unrealizedPnl:h,leverage:this.parseNumber(u),percentage:this.parseNumber(p),marginMode:l,notional:this.parseNumber(g),markPrice:void 0,lastPrice:void 0,liquidationPrice:b,initialMargin:this.parseNumber(d),initialMarginPercentage:this.parseNumber(y),maintenanceMargin:this.parseNumber(k),maintenanceMarginPercentage:this.parseNumber(S),marginRatio:this.parseNumber(O),timestamp:void 0,datetime:void 0,hedged:void 0,lastUpdateTimestamp:void 0,stopLossPrice:void 0,takeProfitPrice:void 0})}async fetchPositions(t=void 0,e={}){let i,s,a,n,o;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t))){if(t.length>0){const e=this.safeString(t,0);i=this.market(e)}}if([s,e]=this.handleMarginModeAndParams("fetchPositions",e,"cross"),[a,e]=this.handleSubTypeAndParams("fetchPositions",i,e,"linear"),[n,e]=this.handleMarketTypeAndParams("fetchPositions",i,e),"spot"===n&&(n="future"),"linear"===a)if("isolated"===s)o=await this.contractPrivatePostLinearSwapApiV1SwapPositionInfo(e);else{if("cross"!==s)throw new r.NotSupported(this.id+" fetchPositions() not support this market type");o=await this.contractPrivatePostLinearSwapApiV1SwapCrossPositionInfo(e)}else if("future"===n)o=await this.contractPrivatePostApiV1ContractPositionInfo(e);else{if("swap"!==n)throw new r.NotSupported(this.id+" fetchPositions() not support this market type");o=await this.contractPrivatePostSwapApiV1SwapPositionInfo(e)}const d=this.safeValue(o,"data",[]),c=this.safeInteger(o,"ts"),h=[];for(let t=0;t<d.length;t++){const e=d[t],i=this.parsePosition(e);h.push(this.extend(i,{timestamp:c,datetime:this.iso8601(c)}))}return this.filterByArrayPositions(h,"symbol",t,!1)}async fetchPosition(t,e={}){await this.loadMarkets();const i=this.market(t);let s;[s,e]=this.handleMarginModeAndParams("fetchPosition",e),s=void 0===s?"cross":s;const[a,n]=this.handleMarketTypeAndParams("fetchPosition",i,e),o={};let d;if(i.future&&i.inverse?o.symbol=i.settleId:("cross"===s&&(o.margin_account="USDT"),o.contract_code=i.id),i.linear)if("isolated"===s)d=await this.contractPrivatePostLinearSwapApiV1SwapAccountPositionInfo(this.extend(o,n));else{if("cross"!==s)throw new r.NotSupported(this.id+" fetchPosition() not support this market type");d=await this.contractPrivatePostLinearSwapApiV1SwapCrossAccountPositionInfo(this.extend(o,n))}else if("future"===a)d=await this.contractPrivatePostApiV1ContractAccountPositionInfo(this.extend(o,n));else{if("swap"!==a)throw new r.NotSupported(this.id+" setLeverage() not support this market type");d=await this.contractPrivatePostSwapApiV1SwapAccountPositionInfo(this.extend(o,n))}const c=this.safeValue(d,"data");let h;h="cross"===s?c:this.safeValue(c,0);const l=this.omit(h,["positions"]),u=this.safeValue(h,"positions");let p;if(i.future&&i.inverse)for(let t=0;t<u.length;t++){const e=u[t];if(e.contract_code===i.id){p=e;break}}else p=this.safeValue(u,0);const f=this.safeInteger(d,"ts"),m=this.parsePosition(this.extend(p,l));return m.timestamp=f,m.datetime=this.iso8601(f),m}parseLedgerEntryType(t){return this.safeString({trade:"trade",etf:"trade","transact-fee":"fee","fee-deduction":"fee",transfer:"transfer",credit:"credit",liquidation:"trade",interest:"credit",deposit:"deposit",withdraw:"withdrawal","withdraw-fee":"fee",exchange:"exchange","other-types":"transfer",rebate:"rebate"},t,t)}parseLedgerEntry(t,e=void 0){const i=this.safeString(t,"currency"),s=this.safeCurrencyCode(i,e);e=this.safeCurrency(i,e);const r=this.safeString(t,"transactId"),a=this.safeString(t,"transferType"),n=this.safeInteger(t,"transactTime"),o=this.safeString(t,"accountId");return this.safeLedgerEntry({info:t,id:r,direction:this.safeString(t,"direction"),account:o,referenceId:r,referenceAccount:o,type:this.parseLedgerEntryType(a),currency:s,amount:this.safeNumber(t,"transactAmt"),timestamp:n,datetime:this.iso8601(n),before:void 0,after:void 0,status:void 0,fee:void 0},e)}async fetchLedger(t=void 0,e=void 0,i=void 0,s={}){await this.loadMarkets();let r=!1;if([r,s]=this.handleOptionAndParams(s,"fetchLedger","paginate"),r)return await this.fetchPaginatedCallDynamic("fetchLedger",t,e,i,s,500);let a,n={accountId:await this.fetchAccountIdByType("spot",void 0,void 0,s)};void 0!==t&&(a=this.currency(t),n.currency=a.id),void 0!==e&&(n.startTime=e),void 0!==i&&(n.limit=i),[n,s]=this.handleUntilOption("endTime",n,s);const o=await this.spotPrivateGetV2AccountLedger(this.extend(n,s)),d=this.safeValue(o,"data",[]);return this.parseLedger(d,a,e,i)}async fetchLeverageTiers(t=void 0,e={}){await this.loadMarkets();const i=await this.contractPublicGetLinearSwapApiV1SwapAdjustfactor(e),s=this.safeList(i,"data",[]);return this.parseLeverageTiers(s,t,"contract_code")}parseMarketLeverageTiers(t,e=void 0){const i=this.safeString(t,"trade_partition"),s=this.safeString(t,"contract_code"),r=[],n=this.safeList(t,"list",[]);for(let t=0;t<n.length;t++){const o=n[t],d=this.safeString(o,"lever_rate"),c=this.safeList(o,"ladders",[]);for(let t=0;t<c.length;t++){const n=c[t],o=this.safeString(n,"adjust_factor");r.push({tier:this.safeInteger(n,"ladder"),symbol:this.safeSymbol(s,e,void 0,"swap"),currency:this.safeCurrencyCode(i),minNotional:this.safeNumber(n,"min_size"),maxNotional:this.safeNumber(n,"max_size"),maintenanceMarginRate:this.parseNumber(a.Y.stringDiv(o,d)),maxLeverage:this.parseNumber(d),info:n})}}return r}async fetchOpenInterestHistory(t,e="1h",i=void 0,s=void 0,a={}){if("1h"!==e&&"4h"!==e&&"12h"!==e&&"1d"!==e)throw new r.BadRequest(this.id+" fetchOpenInterestHistory cannot only use the 1h, 4h, 12h and 1d timeframe");await this.loadMarkets();const n=this.market(t),o=this.safeInteger2(a,"amount_type","amountType",2),d={period:{"1h":"60min","4h":"4hour","12h":"12hour","1d":"1day"}[e],amount_type:o};let c;void 0!==s&&(d.size=s),n.future?(d.contract_type=this.safeString(n.info,"contract_type"),d.symbol=n.baseId,c=await this.contractPublicGetApiV1ContractHisOpenInterest(this.extend(d,a))):n.linear?(d.contract_type="swap",d.contract_code=n.id,d.contract_code=n.id,c=await this.contractPublicGetLinearSwapApiV1SwapHisOpenInterest(this.extend(d,a))):(d.contract_code=n.id,c=await this.contractPublicGetSwapApiV1SwapHisOpenInterest(this.extend(d,a)));const h=this.safeValue(c,"data"),l=this.safeList(h,"tick");return this.parseOpenInterestsHistory(l,n,i,s)}async fetchOpenInterests(t=void 0,e={}){let i;if(await this.loadMarkets(),void 0!==(t=this.marketSymbols(t))){if(t.length>0){const e=this.safeString(t,0);i=this.market(e)}}const s={};let r,a,n;[r,e]=this.handleSubTypeAndParams("fetchPositions",i,e,"linear"),[a,e]=this.handleMarketTypeAndParams("fetchPositions",i,e),"future"===a?n=await this.contractPublicGetApiV1ContractOpenInterest(this.extend(s,e)):"inverse"===r?n=await this.contractPublicGetSwapApiV1SwapOpenInterest(this.extend(s,e)):(s.contract_type="swap",n=await this.contractPublicGetLinearSwapApiV1SwapOpenInterest(this.extend(s,e)));const o=this.safeList(n,"data",[]);return this.parseOpenInterests(o,t)}async fetchOpenInterest(t,e={}){await this.loadMarkets();const i=this.market(t);if(!i.contract)throw new r.BadRequest(this.id+" fetchOpenInterest() supports contract markets only");if(i.option)throw new r.NotSupported(this.id+" fetchOpenInterest() does not currently support option markets");const s={contract_code:i.id};let a;i.future?(s.contract_type=this.safeString(i.info,"contract_type"),s.symbol=i.baseId,a=await this.contractPublicGetApiV1ContractOpenInterest(this.extend(s,e))):i.linear?(s.contract_type="swap",a=await this.contractPublicGetLinearSwapApiV1SwapOpenInterest(this.extend(s,e))):a=await this.contractPublicGetSwapApiV1SwapOpenInterest(this.extend(s,e));const n=this.safeValue(a,"data",[]),o=this.parseOpenInterest(n[0],i),d=this.safeInteger(a,"ts");return o.timestamp=d,o.datetime=this.iso8601(d),o}parseOpenInterest(t,e=void 0){const i=this.safeInteger(t,"ts"),s=this.safeNumber(t,"volume"),r=this.safeNumber(t,"value"),a=this.safeString(t,"contract_code");return this.safeOpenInterest({symbol:this.safeSymbol(a,e),baseVolume:s,quoteVolume:r,openInterestAmount:s,openInterestValue:r,timestamp:i,datetime:this.iso8601(i),info:t},e)}async borrowIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=this.market(t),n={currency:r.id,amount:this.currencyToPrecision(e,i),symbol:a.id},o=await this.privatePostMarginOrders(this.extend(n,s)),d=this.parseMarginLoan(o,r);return this.extend(d,{amount:i,symbol:t})}async borrowCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r={currency:s.id,amount:this.currencyToPrecision(t,e)},a=await this.privatePostCrossMarginOrders(this.extend(r,i)),n=this.parseMarginLoan(a,s);return this.extend(n,{amount:e})}async repayIsolatedMargin(t,e,i,s={}){await this.loadMarkets();const r=this.currency(e),a=await this.fetchAccountIdByType("spot","isolated",t,s),n={currency:r.id,amount:this.currencyToPrecision(e,i),accountId:a},o=await this.v2PrivatePostAccountRepayment(this.extend(n,s)),d=this.safeValue(o,"Data",[]),c=this.safeValue(d,0),h=this.parseMarginLoan(c,r);return this.extend(h,{amount:i,symbol:t})}async repayCrossMargin(t,e,i={}){await this.loadMarkets();const s=this.currency(t),r=await this.fetchAccountIdByType("spot","cross",void 0,i),a={currency:s.id,amount:this.currencyToPrecision(t,e),accountId:r},n=await this.v2PrivatePostAccountRepayment(this.extend(a,i)),o=this.safeValue(n,"Data",[]),d=this.safeValue(o,0),c=this.parseMarginLoan(d,s);return this.extend(c,{amount:e})}parseMarginLoan(t,e=void 0){const i=this.safeInteger(t,"repayTime");return{id:this.safeString2(t,"repayId","data"),currency:this.safeCurrencyCode(void 0,e),amount:void 0,symbol:void 0,timestamp:i,datetime:this.iso8601(i),info:t}}async fetchSettlementHistory(t=void 0,e=void 0,i=void 0,s={}){if(void 0===t)throw new r.ArgumentsRequired(this.id+" fetchSettlementHistory() requires a symbol argument");const a=this.safeInteger(s,"until");s=this.omit(s,["until"]);const n=this.market(t),o={};let d;n.future?o.symbol=n.baseId:o.contract_code=n.id,void 0!==e&&(o.start_at=e),void 0!==i&&(o.page_size=i),void 0!==a&&(o.end_at=a),d=n.swap?n.linear?await this.contractPublicGetLinearSwapApiV1SwapSettlementRecords(this.extend(o,s)):await this.contractPublicGetSwapApiV1SwapSettlementRecords(this.extend(o,s)):await this.contractPublicGetApiV1ContractSettlementRecords(this.extend(o,s));const c=this.safeValue(d,"data"),h=this.safeValue(c,"settlement_record"),l=this.parseSettlements(h,n);return this.sortBy(l,"timestamp")}async fetchDepositWithdrawFees(t=void 0,e={}){await this.loadMarkets();const i=await this.spotPublicGetV2ReferenceCurrencies(e),s=this.safeList(i,"data");return this.parseDepositWithdrawFees(s,t,"currency")}parseDepositWithdrawFee(t,e=void 0){const i=this.safeValue(t,"chains",[]);let s=this.depositWithdrawFee(t);for(let t=0;t<i.length;t++){const r=i[t],a=this.safeString(r,"chain"),n=this.safeString(r,"withdrawFeeType"),o=this.networkIdToCode(a);let d,c;"fixed"===n?(d=this.safeNumber(r,"transactFeeWithdraw"),c={fee:d,percentage:!1}):(d=this.safeNumber(r,"transactFeeRateWithdraw"),c={fee:d,percentage:!0}),s.networks[o]={withdraw:c,deposit:{fee:void 0,percentage:void 0}},s=this.assignDefaultDepositWithdrawFees(s,e)}return s}parseSettlements(t,e){const i=[];for(let s=0;s<t.length;s++){const r=t[s],a=this.safeValue(r,"list");if(void 0!==a){const t=this.safeInteger(r,"settlement_time"),s={timestamp:t,datetime:this.iso8601(t)};for(let t=0;t<a.length;t++){const r=a[t],n=this.parseSettlement(r,e);i.push(this.extend(n,s))}}else i.push(this.parseSettlement(t[s],e))}return i}parseSettlement(t,e){const i=this.safeInteger(t,"settlement_time"),s=this.safeString(t,"contract_code");return{info:t,symbol:this.safeSymbol(s,e),price:this.safeNumber(t,"settlement_price"),timestamp:i,datetime:this.iso8601(i)}}async fetchLiquidations(t,e=void 0,i=void 0,s={}){await this.loadMarkets();const a=this.market(t);let n,o={trade_type:this.safeInteger(s,"trade_type",0)};if(void 0!==e&&(o.start_time=e),[o,s]=this.handleUntilOption("end_time",o,s),a.swap)o.contract=a.id,n=a.linear?await this.contractPublicGetLinearSwapApiV3SwapLiquidationOrders(this.extend(o,s)):await this.contractPublicGetSwapApiV3SwapLiquidationOrders(this.extend(o,s));else{if(!a.future)throw new r.NotSupported(this.id+" fetchLiquidations() does not support "+a.type+" orders");o.symbol=a.id,n=await this.contractPublicGetApiV3ContractLiquidationOrders(this.extend(o,s))}const d=this.safeList(n,"data",[]);return this.parseLiquidations(d,a,e,i)}parseLiquidation(t,e=void 0){const i=this.safeString(t,"contract_code"),s=this.safeInteger(t,"created_at");return this.safeLiquidation({info:t,symbol:this.safeSymbol(i,e),contracts:this.safeNumber(t,"volume"),contractSize:this.safeNumber(e,"contractSize"),price:this.safeNumber(t,"price"),side:this.safeStringLower(t,"direction"),baseValue:this.safeNumber(t,"amount"),quoteValue:this.safeNumber(t,"trade_turnover"),timestamp:s,datetime:this.iso8601(s)})}async closePosition(t,e=void 0,i={}){await this.loadMarkets();const s=this.market(t),a=this.safeString(i,"clientOrderId");if(!s.contract)throw new r.BadRequest(this.id+" closePosition() symbol supports contract markets only");this.checkRequiredArgument("closePosition",e,"side");const n={contract_code:s.id,direction:e};if(void 0!==a&&(n.client_order_id=a),s.inverse){const e=this.safeString2(i,"volume","amount");if(void 0===e)throw new r.ArgumentsRequired(this.id+' closePosition () requires an extra argument params["amount"] for inverse markets');n.volume=this.amountToPrecision(t,e)}let o;if(i=this.omit(i,["clientOrderId","volume","amount"]),s.inverse)o=s.swap?await this.contractPrivatePostSwapApiV1SwapLightningClosePosition(this.extend(n,i)):await this.contractPrivatePostApiV1LightningClosePosition(this.extend(n,i));else{let t;[t,i]=this.handleMarginModeAndParams("closePosition",i,"cross"),o="cross"===t?await this.contractPrivatePostLinearSwapApiV1SwapCrossLightningClosePosition(this.extend(n,i)):await this.contractPrivatePostLinearSwapApiV1SwapLightningClosePosition(this.extend(n,i))}return this.parseOrder(o,s)}async setPositionMode(t,e=void 0,i={}){await this.loadMarkets();const s=t?"dual_side":"single_side";let a,n;void 0!==e&&(a=this.market(e)),[n,i]=this.handleMarginModeAndParams("setPositionMode",i,"cross");const o={position_mode:s};let d;if(void 0!==a&&a.inverse)throw new r.BadRequest(this.id+" setPositionMode can only be used for linear markets");if("isolated"===n){if(void 0===e)throw new r.ArgumentsRequired(this.id+" setPositionMode requires a symbol argument for isolated margin mode");o.margin_account=a.id,d=await this.contractPrivatePostLinearSwapApiV1SwapSwitchPositionMode(this.extend(o,i))}else o.margin_account="USDT",d=await this.contractPrivatePostLinearSwapApiV1SwapCrossSwitchPositionMode(this.extend(o,i));return d}}},9962(t,e,i){"use strict";i.d(e,{VF:()=>p,kw:()=>m});var s=i(3390),r=i(4852),a=i(7481),n=i(1094),o=i(4710);function d(t){if("string"!=typeof t)throw new TypeError("invalid mnemonic type: "+typeof t);return t.normalize("NFKD")}function c(t){const e=d(t),i=e.split(" ");if(![12,15,18,21,24].includes(i.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:i}}function h(t){if((0,n.DO)(t),![16,20,24,28,32].includes(t.length))throw new Error("invalid entropy length")}const l=t=>{const e=8-t.length/4;return new Uint8Array([(0,r.s)(t)[0]>>e<<e])};function u(t){if(!Array.isArray(t)||2048!==t.length||"string"!=typeof t[0])throw new Error("Wordlist: expected array of 2048 strings");return t.forEach(t=>{if("string"!=typeof t)throw new Error("wordlist: non-string element: "+t)}),o.Wp.chain(o.Wp.checksum(1,l),o.Wp.radix2(11,!0),o.Wp.alphabet(t))}function p(t,e){h(t);return u(e).encode(t).join((t=>""===t[0])(e)?"":" ")}const f=t=>d("mnemonic"+t);function m(t,e=""){return(0,s.A)(a.Zf,c(t).nfkd,f(e),{c:2048,dkLen:64})}},9999(t,e,i){"use strict";i.d(e,{mX:()=>r});var s=i(9806);Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}());i(1291);const r={encode:(t,e=Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}()).create())=>(void 0!==t.subaccountId&&s.D.encode(t.subaccountId,e.uint32(10).fork()).ldelim(),0!==t.perpetualId&&e.uint32(16).uint32(t.perpetualId),e),decode(t,e){const i=t instanceof Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())?t:new Object(function(){var t=new Error("Cannot find module 'protobufjs/minimal.js'");throw t.code="MODULE_NOT_FOUND",t}())(t);let r=void 0===e?i.len:i.pos+e;const a={subaccountId:void 0,perpetualId:0};for(;i.pos<r;){const t=i.uint32();switch(t>>>3){case 1:a.subaccountId=s.D.decode(i,i.uint32());break;case 2:a.perpetualId=i.uint32();break;default:i.skipType(7&t)}}return a},fromPartial(t){const e={subaccountId:void 0,perpetualId:0};return e.subaccountId=void 0!==t.subaccountId&&null!==t.subaccountId?s.D.fromPartial(t.subaccountId):void 0,e.perpetualId=t.perpetualId??0,e}}}},s={};function r(t){var e=s[t];if(void 0!==e)return e.exports;var a=s[t]={exports:{}};return i[t].call(a.exports,a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(i,s){if(1&s&&(i=this(i)),8&s)return i;if("object"==typeof i&&i){if(4&s&&i.__esModule)return i;if(16&s&&"function"==typeof i.then)return i}var a=Object.create(null);r.r(a);var n={};t=t||[null,e({}),e([]),e(e)];for(var o=2&s&&i;("object"==typeof o||"function"==typeof o)&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach(t=>n[t]=()=>i[t]);return n.default=()=>i,r.d(a,n),a},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{"use strict";r.r(a),r.d(a,{AccountNotEnabled:()=>s.AccountNotEnabled,AccountSuspended:()=>s.AccountSuspended,AddressPending:()=>s.AddressPending,ArgumentsRequired:()=>s.ArgumentsRequired,AuthenticationError:()=>s.AuthenticationError,BadRequest:()=>s.BadRequest,BadResponse:()=>s.BadResponse,BadSymbol:()=>s.BadSymbol,BaseError:()=>s.BaseError,CancelPending:()=>s.CancelPending,ChecksumError:()=>s.ChecksumError,ContractUnavailable:()=>s.ContractUnavailable,DDoSProtection:()=>s.DDoSProtection,DuplicateOrderId:()=>s.DuplicateOrderId,Exchange:()=>t.k,ExchangeClosedByUser:()=>s.ExchangeClosedByUser,ExchangeError:()=>s.ExchangeError,ExchangeNotAvailable:()=>s.ExchangeNotAvailable,InsufficientFunds:()=>s.InsufficientFunds,InvalidAddress:()=>s.InvalidAddress,InvalidNonce:()=>s.InvalidNonce,InvalidOrder:()=>s.InvalidOrder,InvalidProxySettings:()=>s.InvalidProxySettings,ManualInteractionNeeded:()=>s.ManualInteractionNeeded,MarginModeAlreadySet:()=>s.MarginModeAlreadySet,MarketClosed:()=>s.MarketClosed,NetworkError:()=>s.NetworkError,NoChange:()=>s.NoChange,NotSupported:()=>s.NotSupported,NullResponse:()=>s.NullResponse,OnMaintenance:()=>s.OnMaintenance,OperationFailed:()=>s.OperationFailed,OperationRejected:()=>s.OperationRejected,OrderImmediatelyFillable:()=>s.OrderImmediatelyFillable,OrderNotCached:()=>s.OrderNotCached,OrderNotFillable:()=>s.OrderNotFillable,OrderNotFound:()=>s.OrderNotFound,PermissionDenied:()=>s.PermissionDenied,Precise:()=>e.Y,RateLimitExceeded:()=>s.RateLimitExceeded,RequestTimeout:()=>s.RequestTimeout,RestrictedLocation:()=>s.RestrictedLocation,UnsubscribeError:()=>s.UnsubscribeError,binance:()=>n.A,bitget:()=>o.A,bybit:()=>d.A,coinbase:()=>c.A,coinex:()=>h.A,default:()=>x,errors:()=>s,exchanges:()=>A,functions:()=>i,gate:()=>l.A,huobi:()=>u.A,kucoin:()=>p.A,mexc:()=>f.A,okx:()=>m.A,pro:()=>I,version:()=>_});var t=r(2961),e=r(5147),i=r(5095),s=r(2079),n=r(3192),o=r(7757),d=r(5462),c=r(7504),h=r(9344),l=r(9403),u=r(63),p=r(1397),f=r(2403),m=r(3660),g=r(9544),y=r(205),v=r(8518),b=r(8160),w=r(9088),S=r(9195),k=r(6335),O=r(4965),T=r(9219),P=r(8588);const _="4.5.29";t.k.ccxtVersion=_;const A={binance:n.A,bitget:o.A,bybit:d.A,coinbase:c.A,coinex:h.A,gate:l.A,huobi:u.A,kucoin:p.A,mexc:f.A,okx:m.A},I={binance:g.A,bitget:y.A,bybit:v.A,coinbase:b.A,coinex:w.A,gate:S.A,huobi:k.A,kucoin:O.A,mexc:T.A,okx:P.A};for(const t in I);I.exchanges=Object.keys(I),I.Exchange=t.k;const x=Object.assign({version:_,Exchange:t.k,Precise:e.Y,exchanges:Object.keys(A),pro:I},A,i,s)})(),self.ccxt=a})();